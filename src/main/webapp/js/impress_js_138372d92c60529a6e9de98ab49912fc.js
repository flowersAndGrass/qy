function ajaxlogin(issynclogin,which,filename,callback,type,url,isopen){var _login={DEPS:["../../common/basic/js/require.js"/*tpa=http://common1.qyerstatic.com/place/common/basic/js/require.js*/,"../../common/basic/js/qyerUtil.js"/*tpa=http://common1.qyerstatic.com/place/common/basic/js/qyerUtil.js*/],init:function(){var _this=this;"function"!=typeof requirejs?$.ajax({url:_this.DEPS[0],dataType:"script",cache:!0,success:function(script){eval(script),_this.getQyerUtil()},error:function(t){alert("加载登录模块时发生错误，请重试。")}}):_this.getQyerUtil()},getQyerUtil:function(){var _this=this;qyerUtil&&"function"==typeof qyerUtil.doLogin?_this.doLogin():$.ajax({url:_this.DEPS[1],dataType:"script",cache:!0,success:function(script){eval(script),_this.doLogin()},error:function(t){alert("加载登录模块时发生错误，请重试。")}})},doLogin:function(){if(qyerUtil.isLogin())return!1;var t="reg"===type?"regist":"login";pageType="",redirectURL=url||window.location.href,callback="function"==typeof callback?callback:function(){},allowClose=!0,qyerUtil.doLogin({page:t,pageType:pageType,redirectURL:redirectURL,callback:callback})}};return _login.init()}function pagereload(){location.reload()}function syncAfterLogin(t,e){QYER.uid=t,e=e||"",jQuery.getJSON("http://user.qyer.com/user_action_logininfo?xxcb="+e+"&callback=?")}function isloginjump(t,e){return QYER.uid>0?(location.href=t,!1):(alert(1),t="http://bbs.qyer.com/"+t,void ajaxlogin(0,"","http://common1.qyerstatic.com/place/js/common/bbsajax.php","","",t))}function getAjaxMsg(t){"object"==typeof t&&1==t.status&&(jQuery("body").append(t.script),setTimeout(function(){window.location.href=t.url},2e3))}function ajaxLogout(){tips.show("退出登录中..."),jQuery.ajax({type:"get",dataType:"jsonp",url:"http://login.qyer.com/login.php?action=ajaxLogout&callback=?"})}function islogin(t,e,n){e=e||ajaxlogin;var i="/public.php?action=islogin&rnd="+ +new Date;if(!n)return void jQuery.getJSON(i,function(n){n||e&&e(),"ok"==n.result?("undefined"!=typeof comment&&comment.setUid(n.data.uid),t&&t(n.data)):e&&e(n.data)});var o=!1;return jQuery.ajax({url:i,dataType:"json",async:!1,success:function(n){n||(e&&e(),o=!1),"ok"==n.result?(t&&t(n.data),o=!0):(e&&e(n.data),o=!1)}}),o}function yjbGetCookie(t){for(var e=document.cookie.split("; "),n=0;n<e.length;n++){var i=e[n].split("=");if(i[0]==t)return unescape(i[1])}}function yjbSetCookie(t,e){var n=1,i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),document.cookie=t+"="+escape(e)+";domain=.qyer.com;expires="+i.toGMTString()}function closeAppPup(){yjbSetCookie("apppopup","1"),jQuery("#apppopup_bg").hide(),pupclose()}function spam_text_filter(){var t=/(http:\/\/)?[\w\.]*\.?(mafengwo\.cn|mafengwo\.com|mafengwo\.net)[a-zA-Z\/0-9&\?\.#\-_]*/gim;jQuery(".qyer_spam_text_filter a").each(function(){(jQuery(this).html()+jQuery(this).attr("href")).indexOf("http://common1.qyerstatic.com/place/js/common/mafengwo.cn")==-1&&(jQuery(this).html()+jQuery(this).attr("href")).indexOf("http://common1.qyerstatic.com/place/js/common/mafengwo.com")==-1&&(jQuery(this).html()+jQuery(this).attr("href")).indexOf("http://common1.qyerstatic.com/place/js/common/mafengwo.net")==-1||jQuery(this).replaceWith(jQuery(this).html())}),jQuery(".qyer_spam_text_filter").each(function(){var e=jQuery(this).html();e=e.replace(/\<script.*?\>document\.write\(AC_FL_RunContent.*?\<\/script\>/gim,"");var n=e.match(/\<img[\s\S]*?\>/gim);if(null!=n)for(var i=0;i<n.length;i++)e=e.replace(n[i],"[imgimg]"+i+"[/imgimg]");if(e=e.replace(t,""),null!=n)for(var i=0;i<n.length;i++)e=e.replace("[imgimg]"+i+"[/imgimg]",n[i]);jQuery(this).html(e)})}function loadjscssfile(t,e){if("js"==e){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",t)}else if("css"==e){var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t)}"undefined"!=typeof n&&document.getElementsByTagName("head")[0].appendChild(n)}function getCookie(t){var e=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=e?unescape(e[2]):null}function setCookie(t,e){document.cookie=t+"="+escape(e)+"; path=/;domain=ask.qyer.com"}function getABFromGuid(){var t=new RegExp("(^| )_guid=([^;]*)(;|$)","i"),e=document.cookie.match(t),n="";if(null!=e&&e.length>1&&(n=e[2]),""==n)return"b";var i=n.substr(n.length-1,1).toLowerCase(),o=parseInt("0x"+i);return o>7?"b":"a"}function amendUrl(t,e){if(""==e)return t;var n="",i=t.indexOf("#");return i!=-1&&(n=t.substr(i),t=t.substr(0,i)),t=t.indexOf("?")==-1?t+"?"+e:t+"&"+e,t+n}function follow(t){function e(t,e,n){e?(qyerUI.message({msg:"成功取消关注",type:"true"}),n.attr("data-bn-ipg","usercenter-follow")):(qyerUI.message({msg:"成功关注",type:"true"}),n.attr("data-bn-ipg","usercenter-unfollow")),n.attr("data-relate",e),"1"==t?n.hasClass("ui_attent_btn_each")?(n.removeClass("ui_attent_btn_each"),n.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").removeClass("ui_attent_btn_each")):(n.addClass("ui_attent_btn_each"),n.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").addClass("ui_attent_btn_each")):n.hasClass("ui_attent_btn_yes")?(n.removeClass("ui_attent_btn_yes"),n.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").removeClass("ui_attent_btn_yes")):(n.addClass("ui_attent_btn_yes"),n.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").addClass("ui_attent_btn_yes"))}if(QYER.uid<=0)return ajaxlogin(),!1;var n=t.attr("data-uid"),i=t.attr("data-relate"),o=t.attr("data-each"),r="";r=1==i?"action=addfriend&fuid="+n:"action=channelfriend&uid="+n;var a="http://common1.qyerstatic.com/public.php";/^http:\/\/bbs\.qyer\.com\//.test(window.location.href)&&(a="http://common1.qyerstatic.com/bbsajax.php"),jQuery.ajax({type:"POST",url:a,data:r,dataType:"json",beforeSend:function(t){},success:function(n){"ok"==n.result?(i=0==i?1:0,e(o,i,t)):e(o,i,t)}})}function weiboshare(t,e,n){var i=e;n=n||"";var o="http://service.weibo.com/share/share.php?appkey=2254065920&title="+encodeURIComponent(t)+"&url="+encodeURIComponent(i)+"&ralateUid=1721449743";n&&(o+="&pic="+encodeURIComponent(n)),window.open(o,"_blank","scrollbars=no,width=600,height=480,left=75,top=20,status=no,resizable=yes,")}function tracker_request(t){var e=encodeURIComponent(window.location.href),n="http://qt.qyer.com/beacon.gif?type=click&category="+encodeURIComponent(t)+"&campaign=inpage&",i=encodeURIComponent(document.referrer),o=jQuery.cookie("_guid")||"",r=jQuery.cookie("_uid")||"",a=jQuery.cookie("_session")||"";if(n+="referer="+e+"&referer_link="+i+"&guid="+o+"&user_id="+r+"&session="+a,"https:"!==document.location.protocol){var s=new Image;s.src=n}}function flash(t,e,n){if(""==t)return"";e=e?e:590,n=n?n:410;var i="";return i+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" width="'+e+'" height="'+n+'">',i+='<param name="movie" value="'+t+'">',i+='<param name="quality" value="high">',i+='<param name="wmode" value="transparent">',i+='<param name="menu" value="false">',i+='<embed src="'+t+'" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="'+e+'" height="'+n+'" wmode="transparent" ></embed>',i+="</object>"}function showFlash(t,e,n,i){n=n?n:590,i=i?i:410;var o="";o+="<style>",o+=".popup_video_bg{background:url(http://common2.qyerstatic.com/place/project/images/old/plan2/popup_video_bg.png);}",o+="</style>",o+=flash(e,n,i),jQuery("#"+t).html(o),qyerUI.popup.show({id:t,width:n}),jQuery(".ui_popup_bg").addClass("popup_video_bg"),jQuery(".ui_popup_close").css({top:-30,right:-30})}function showJnFlash(t){showFlash(t,"http://tv.sohu.com/upload/swf/20130917/PlayerShell.swf?autoplay=true&skinNum=1&api_key=1b047048287fa2a7ca1370e2f19a3f93&id=60435608&topBar=0&showRecommend=0&shareBtn=1&likeBtn=1&topBarFull=1&topBarNor=1&sogouBtn=0&qq-pf-to=pcqq.discussion&isListPlay=0")}function addattenweibo(t,e){e=e||function(){},islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/ajax.php",data:"action=addatten&fuid="+t,dataType:"json",beforeSend:function(t){},success:function(n){if("ok"==n.result){var i='<a href="javascript:void(0);" id="qx_'+n.data.id+'" onmouseover="$(\'#qx_'+n.data.id+"').removeClass().addClass('icon_user_care_cancel').html('取消关注');\" onmouseout=\"$('#qx_"+n.data.id+"').removeClass().addClass('icon_user_care_already').html('已关注');\" onclick=\"channelfriendweibo("+n.data.id+')" class="icon_user_care_already">已关注</a>';return $("#gz_"+t).html(i),tips.show("关注成功"),void(e&&e())}tips.show(n.data.msg)}})})}function addfriends(t){islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/ajax.php",data:"action=addfriends&fuid="+t,dataType:"json",beforeSend:function(t){},success:function(t){if("ok"==t.result){var e="<a href=\"javascript:void(0);\" onmouseover=\"$('.icon_user_care_already').removeClass().addClass('icon_user_care_cancel').html('取消关注');\" onmouseout=\"$('.icon_user_care_cancel').removeClass().addClass('icon_user_care_already').html('已关注');\" class=\"icon_user_care_already\">已关注</a>";$(".ui_follow").html(e),$("#_jsfriends").html("已全部关注"),$("#_jsfriends").removeClass("ui_button_14").addClass("ui_button14_disabled"),tips.show("关注成功"),setTimeout(function(){window.location.href="http://www.qyer.com/"},1e3)}else tips.show(t.data.msg)}})})}function channelfriendweibo(t,e,n){e=e||function(){},islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/ajax.php",data:"action=channelfriend&uid="+t,dataType:"json",beforeSend:function(t){},success:function(t){if("ok"==t.result){var i='<a href="javascript:void(0);" onclick="addattenweibo('+t.data.id+')" class="icon_user_care">关注</a>';$("#gz_"+t.data.id).html(i),tips.show("成功取消关注"),e&&e(),1==n&&location.reload()}else tips.show(t.data.msg)}})})}function addatten(t,e){e=e||function(){},islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/ajax.php",data:"action=addatten&fuid="+t,dataType:"json",beforeSend:function(t){},success:function(t){if("ok"==t.result){var n="<a href=\"javascript:void(0);\" onmouseover=\"$('.icon_user_care_already').removeClass().addClass('icon_user_care_cancel').html('取消关注');\" onmouseout=\"$('.icon_user_care_cancel').removeClass().addClass('icon_user_care_already').html('已关注');\" onclick=\"channelfriend("+t.data.id+')" class="icon_user_care_already">已关注</a>';return $(".ui_follow").html(n),tips.show("关注成功"),void(e&&e())}tips.show(t.data.msg)}})})}function addatten1(t,e){islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/ajax.php",data:"action=addatten&fuid="+t,dataType:"json",beforeSend:function(t){},success:function(t){if("ok"==t.result){var e="<a href=\"javascript:void(0);\" onmouseover=\"$('.icon_user_care_already').removeClass().addClass('icon_user_care_cancel').html('取消关注');\" onmouseout=\"$('.icon_user_care_cancel').removeClass().addClass('icon_user_care_already').html('已关注');\" onclick=\"channelfriend1("+t.data.id+',0,event)" class="icon_user_care_already">已关注</a>';$(".ui_follow").html(e);var n=parseInt($("#idfollow").html())<1?0:parseInt($("#idfollow").html());$("#idfollow").html(n+1);var i='<span class="icon_yesfollow">已关注</span>';return $("#fr_"+t.data.id).html(i),void tips.show("关注成功")}tips.show(t.data.msg)}})})}function user_doing_planto(t){for(var e=0;e<aCountry.length;e++)aCountry[e][0]==t&&(k=e);var n=1-parseInt(aCountry[k][5]);doing.plantocountry(n,t,function(e){"ok"==e.result?(1==n?$("#user_planto_"+t).addClass("current"):$("#user_planto_"+t).removeClass("current"),aCountry[k][5]=n):tips.show(e.data.msg)})}function user_doing_beento(t){for(var e=0;e<aCountry.length;e++)aCountry[e][0]==t&&(k=e);var n=1-parseInt(aCountry[k][6]);doing.beentocountry(n,t,function(e){"ok"==e.result?(1==n?($("#user_beento_"+t).addClass("current"),$("#user_beentoCounts_index").html(parseInt($("#user_beentoCounts_index").html())+1)):($("#user_beento_"+t).removeClass("current"),$("#user_beentoCounts_index").html(parseInt($("#user_beentoCounts_index").html())-1)),aCountry[k][6]=n):tips.show(e.data.msg)})}function user_doing_lived(t){for(var e=0;e<aCountry.length;e++)aCountry[e][0]==t&&(k=e);var n=1-parseInt(aCountry[k][7]);doing.livedcountry(n,t,function(e){"ok"==e.result?(1==n?$("#user_lived_"+t).addClass("current"):$("#user_lived_"+t).removeClass("current"),aCountry[k][7]=n):tips.show(e.data.msg)})}function addfriend(t){islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/public.php",data:"action=addfriend&fuid="+t,dataType:"json",beforeSend:function(t){},success:function(e){"ok"==e.result?($("#gz_"+t).remove(),$("#hx_"+t).show(),tips.show("关注成功")):tips.show(e.data.msg)}})})}function delfriend(t,e){tips.confirm(e,function(){islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/ajax.php",data:"action=delfriend&fuid="+t,dataType:"json",beforeSend:function(t){},success:function(t){"ok"==t.result?(tips.show("移除成功"),setTimeout(function(){location.reload()},2e3)):tips.show(t.data.msg)}})})},"确认移除粉丝吗？")}function channelfriend(t,e,n){e=e||function(){},islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/ajax.php",data:"action=channelfriend&uid="+t,dataType:"json",beforeSend:function(t){},success:function(t){if("ok"==t.result){var i='<a href="javascript:void(0);" onclick="addatten('+t.data.id+')" class="icon_user_care">关注</a>';$(".ui_follow").html(i),tips.show("成功取消关注"),e&&e(),1==n&&location.reload()}else tips.show(t.data.msg)}})})}function channelfriend1(t,e,n){tips.confirm(n,function(){void 0==e&&(e=0),islogin(function(){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/ajax.php",data:"action=channelfriend&uid="+t,dataType:"json",beforeSend:function(t){},success:function(t){if("ok"==t.result){var n='<a href="javascript:void(0);" onclick="addatten1('+t.data.id+')" class="icon_user_care">关注</a>';if($(".ui_follow").html(n),0==e){var i=parseInt($("#idfollow").html())<1?0:parseInt($("#idfollow").html());$("#idfollow").html(i-1)}tips.show("成功取消关注"),1==e&&setTimeout(function(){location.reload()},2e3)}else tips.show(t.data.msg)}})})},"确认取消关注吗？")}function replacediv(){$(function(){$(".user_changeimg_btn").attr("class","user_addimg_btn")})}function errorctro(){$(".user_changeimg_btn").attr("class","user_addimg_btn")}function showcity(){bCountry.splice(0,bCountry.length);for(var t=0;t<12;t++)bCountry[t]=aCountry[start],bCountry[t].id=aCountry[start][0],start++,start>last&&(start=0);for(var e="",t=0;t<12;t++)e+='<div class="sblockclass" v="'+bCountry[t][0]+'">',e+='<div class="sblockcimg">',e+='<a target="_blank" href="'+bCountry[t][4]+'">',e+='<img title="'+bCountry[t][1]+'" alt="'+bCountry[t][1]+'" width="48" onerror="this.src=\'../../../../static.qyer.com/images/place/nothing/nothing_city_48.png\'/*tpa=http://static.qyer.com/images/place/nothing/nothing_city_48.png*/" height="48" src="'+bCountry[t][3]+'" />',e+="<span>",e+="<strong>"+bCountry[t][2]+"</strong>",e+="<strong>"+bCountry[t][1]+"</strong>",e+="</span>",e+="</a>",e+="</div>",e+='<p id="user_doings_'+bCountry[t][0]+'">',e+=0==bCountry[t][5]?"<a href='javascript:void(0);' onclick=\"user_doing_planto('"+bCountry[t][0]+"');\" id='user_planto_"+bCountry[t][0]+"'>想去</a>":"<a class='current' href='javascript:void(0);' v='"+bCountry[t][0]+"' id='user_planto_"+bCountry[t][0]+"'>想去</a>",e+=0==bCountry[t][6]?"<a onclick=\"user_doing_beento('"+bCountry[t][0]+"');\" v='"+bCountry[t][0]+"' href='javascript:void(0);' id='user_beento_"+bCountry[t][0]+"'>去过</a>":"<a class='current' v='"+bCountry[t][0]+"' href='javascript:void(0);' id='user_beento_"+bCountry[t][0]+"'>去过</a>",e+=0==bCountry[t][7]?"<a href='javascript:void(0);' onclick=\"user_doing_lived('"+bCountry[t][0]+"');\" v='"+bCountry[t][0]+"' id='user_lived_"+bCountry[t][0]+"'>生活过</a>":"<a class='current' v='"+bCountry[t][0]+"' href='javascript:void(0);' id='user_lived_"+bCountry[t][0]+"'>生活过</a>",e+="</p>",e+="</div>";$("#showcityspan").html(e)}function showcountry(){bCountry.splice(0,bCountry.length);for(var t=0;t<12;t++)bCountry[t]=aCountry[start],bCountry[t].id=aCountry[start][0],start++,start>last&&(start=0);for(var e="",t=0;t<12;t++)e+='<div class="sblockclass" v="'+bCountry[t][0]+'">',e+='<div class="sblockcimg">',e+='<a target="_blank" href="'+bCountry[t][4]+'">',e+='<img title="'+bCountry[t][1]+'" alt="'+bCountry[t][1]+'" width="48" height="48" src="'+bCountry[t][3]+'" />',e+="<span>",e+="<strong>"+bCountry[t][2]+"</strong>",e+="<strong>"+bCountry[t][1]+"</strong>",e+="</span>",e+="</a>",e+="</div>",e+='<p id="user_doings_'+bCountry[t][0]+'">',e+=0==bCountry[t][5]?"<a href='javascript:void(0);' onclick=\"user_doing_planto('"+bCountry[t][0]+"');\" id='user_planto_"+bCountry[t][0]+"'>想去</a>":"<a class='current' href='javascript:void(0);' v='"+bCountry[t][0]+"' id='user_planto_"+bCountry[t][0]+"'>想去</a>",e+=0==bCountry[t][6]?"<a onclick=\"user_doing_beento('"+bCountry[t][0]+"');\" v='"+bCountry[t][0]+"' href='javascript:void(0);' id='user_beento_"+bCountry[t][0]+"'>去过</a>":"<a class='current' v='"+bCountry[t][0]+"' href='javascript:void(0);' id='user_beento_"+bCountry[t][0]+"'>去过</a>",e+=0==bCountry[t][7]?"<a href='javascript:void(0);' onclick=\"user_doing_lived('"+bCountry[t][0]+"');\" v='"+bCountry[t][0]+"' id='user_lived_"+bCountry[t][0]+"'>生活过</a>":"<a class='current' v='"+bCountry[t][0]+"' href='javascript:void(0);' id='user_lived_"+bCountry[t][0]+"'>生活过</a>",e+="</p>",e+="</div>";$("#showcountryspan").html(e)}function beento(t,e){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/ajax.php",data:"action=beento&page="+t+"&uid="+e,dataType:"text",beforeSend:function(t){},success:function(t){""!=t&&$("#divbeento").html(t)}})}function planto(t,e){$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/ajax.php",data:"action=planto&page="+t+"&uid="+e,dataType:"text",beforeSend:function(t){},success:function(t){""!=t&&$("#divplanto").html(t)}})}function showhelp(t,e,n,i){$(".js_help_more").html("加载中...").removeClass().addClass("ui_reload js_help_more"),$.ajax({type:"POST",url:"http://common1.qyerstatic.com/place/js/common/ajax.php",data:"action=helpd&start="+e+"&uid="+t+"&limit="+n+"&count="+i,dataType:"json",beforeSend:function(t){},success:function(t){1==t.doss?($("#helped").append(t.str),$("#helpedpage").html(t.page)):0==e&&$("#helptotal").remove()}})}function msgdel(t,e,n){tips.confirm(n,function(){location.href=e},"你确认要删除与"+t+"之间的所有私信吗？")}function msgdelone(t,e){tips.confirm(e,function(){location.href=t},"你确认要删除吗？")}function noticedel(t,e){tips.confirm(e,function(){location.href=t},"你确认要删除与"+username+"之间的所有私信吗？")}function userover(t){$(t).find("div").show()}function userout(t){var e=$(t);setTimeout(function(){$(e).find("div").hide()},100)}function batchdoingspopup(t,e,n,i){return"undefined"!=typeof t&&("undefined"==typeof e&&(e="city"),"undefined"==typeof n&&(n="beento"),i="undefined"==typeof i?1:i,place_doings_comment_popupmessage.page=i,"undefined"!=typeof place_doings_comment_popupmessage[i]?(popup.showHtml(place_doings_comment_popupmessage[i],"550"),!1):void jQuery.ajax({type:"POST",url:"http://common1.qyerstatic.com/public.php?action=batchdoingspopup",data:{oper:n,typename:e,id:t,page:i,postid:place_doings_batch_data.join(",")},cache:!1,dataType:"html",success:function(t){""!=t&&(place_doings_comment_popupmessage[i]=t,popup.showHtml(t,"550"))}}))}function html_encode(t){var e="";return 0==t.length?"":(e=t.replace(/&/g,"&amp;"),e=t.replace(/&amp;amp;/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\"/g,"&quot;"))}function html_decode(t){var e="";return 0==t.length?"":(e=t.replace(/&amp;/g,"&"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&nbsp;/g," "),e=e.replace(/&#39;/g,"'"),e=e.replace(/&quot;/g,'"'))}function gologin(){location.href="http://login.qyer.com/login.php"}function loginorjump(){QYER&&QYER.uid||gologin()}function enableCrossDomain(){return"undefined"!=typeof USERCARD_REQ_MODE&&"bbs"==USERCARD_REQ_MODE}function addatten_v1_callback(t){if("ok"==t.result){var e="<a href=\"javascript:void(0);\" onmouseover=\"jQuery('.icon_user_care_already').removeClass().addClass('icon_user_care_cancel').html('取消关注');\" onmouseout=\"jQuery('.icon_user_care_cancel').removeClass().addClass('icon_user_care_already').html('已关注');\" onclick=\"channelfriend_v1("+t.data.id+')" class="icon_user_care_already">已关注</a>';jQuery(".ui_follow").html(e),tipsX.show("关注成功");var n=curUsercardUid,i=jQuery(".flow"+n);i.removeClass("icon_user_care").addClass(__already),i.html("已关注");var o=jQuery(".jsfollowcount"+n).html();return o=parseInt(o),jQuery(".jsfollowcount"+n).html(o+1),void clearUsercardCache(n)}tipsX.show(t.data.msg)}function addatten_v1(t){loginorjump(),curUsercardUid=t;var e="http://user.qyer.com/ajax.php?action=addatten&fuid="+t+"&callback=?&callname=addatten_v1_callback";jQuery.getJSON(e)}function channelfriend_v1_callback(t){if("ok"==t.result){var e='<a href="javascript:void(0);" onclick="addatten_v1('+t.data.id+')" class="icon_user_care">关注</a>',n=curUsercardUid;jQuery(".ui_follow").html(e);var i="flow"+n,o=jQuery("."+i);o.html("关注"),o.unbind("click"),o.removeClass(__cancel).addClass("icon_user_care");var r=jQuery(".jsfollowcount"+n).html();r=parseInt(r),jQuery(".jsfollowcount"+n).html(r-1),tipsX.show("成功取消关注")}else tipsX.show(t.data.msg)}function channelfriend_v1(t){loginorjump(),curUsercardUid=t;var e="http://user.qyer.com/ajax.php?action=channelfriend&uid="+t+"&callback=?&callname=channelfriend_v1_callback";jQuery.getJSON(e)}function fetchUsercardSuccXX(t,e){var n=e?t:t.data.html,i=!e,o=jQuery(".ui_face_layer");o.size()>0?jQuery("#uifacelayer").html(n):(jQuery("body").append("<div id='uifacelayer'>"+n+"</div>"),o=jQuery(".ui_face_layer"));var r=curHoverUsercardDivobj;adjustLayerPosition(r,i),o.show()}function adjustLayerPosition(t,e){var n,i,o,r,a;!function(s){var u=s("#uifacelayer .ui_face_layer").height()+10;n=s(t).offset(),i=n.left,o=n.top,r=s(t).width(),a=s(t).height(),s(".ui_face_layer_arrow").removeClass("arrow_t").css({left:"",right:""});var c=330,l={w24:{x1:279,x2:33},w48:{x1:267,x2:21},w80:{x1:251,x2:5}},p="w"+r;"undefined"==typeof l[p]&&(p="w80"),e&&(p="w80"),o-s(document).scrollTop()<u&&s(document).width()-(i+r)<c?(s(".ui_face_layer").css({left:i-l[p].x1,top:o+a+10}).show(),s(".ui_face_layer_arrow").addClass("arrow_t").css({left:"auto",right:"35px"})):o-s(document).scrollTop()<u?(s(".ui_face_layer").css({left:i-l[p].x2,top:o+a+10}).show(),s(".ui_face_layer_arrow").addClass("arrow_t")):s(document).width()-(i+r)<c?(s(".ui_face_layer").css({left:i-l[p].x1,top:o-u}).show(),s(".ui_face_layer_arrow").css({left:"auto",right:"35px"})):s(".ui_face_layer").css({left:i-l[p].x2,top:o-u}).show()}(jQuery)}(function(){var t=this,e=t._,n={},i=Array.prototype,o=Object.prototype,r=Function.prototype,a=i.push,s=i.slice,u=i.concat,c=o.toString,l=o.hasOwnProperty,p=i.forEach,d=i.map,f=i.reduce,h=i.reduceRight,m=i.filter,g=i.every,v=i.some,y=i.indexOf,_=i.lastIndexOf,b=Array.isArray,x=Object.keys,w=r.bind,j=function(t){return t instanceof j?t:this instanceof j?void(this._wrapped=t):new j(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):t._=j,j.VERSION="1.5.2";var k=j.each=j.forEach=function(t,e,i){if(null!=t)if(p&&t.forEach===p)t.forEach(e,i);else if(t.length===+t.length){for(var o=0,r=t.length;r>o;o++)if(e.call(i,t[o],o,t)===n)return}else for(var a=j.keys(t),o=0,r=a.length;r>o;o++)if(e.call(i,t[a[o]],a[o],t)===n)return};j.map=j.collect=function(t,e,n){var i=[];return null==t?i:d&&t.map===d?t.map(e,n):(k(t,function(t,o,r){i.push(e.call(n,t,o,r))}),i)};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return i&&(e=j.bind(e,i)),o?t.reduce(e,n):t.reduce(e);if(k(t,function(t,r,a){o?n=e.call(i,n,t,r,a):(n=t,o=!0)}),!o)throw new TypeError(E);return n},j.reduceRight=j.foldr=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),h&&t.reduceRight===h)return i&&(e=j.bind(e,i)),o?t.reduceRight(e,n):t.reduceRight(e);var r=t.length;if(r!==+r){var a=j.keys(t);r=a.length}if(k(t,function(s,u,c){u=a?a[--r]:--r,o?n=e.call(i,n,t[u],u,c):(n=t[u],o=!0)}),!o)throw new TypeError(E);return n},j.find=j.detect=function(t,e,n){var i;return C(t,function(t,o,r){return e.call(n,t,o,r)?(i=t,!0):void 0}),i},j.filter=j.select=function(t,e,n){var i=[];return null==t?i:m&&t.filter===m?t.filter(e,n):(k(t,function(t,o,r){e.call(n,t,o,r)&&i.push(t)}),i)},j.reject=function(t,e,n){return j.filter(t,function(t,i,o){return!e.call(n,t,i,o)},n)},j.every=j.all=function(t,e,i){e||(e=j.identity);var o=!0;return null==t?o:g&&t.every===g?t.every(e,i):(k(t,function(t,r,a){return(o=o&&e.call(i,t,r,a))?void 0:n}),!!o)};var C=j.some=j.any=function(t,e,i){e||(e=j.identity);var o=!1;return null==t?o:v&&t.some===v?t.some(e,i):(k(t,function(t,r,a){return o||(o=e.call(i,t,r,a))?n:void 0}),!!o)};j.contains=j.include=function(t,e){return null!=t&&(y&&t.indexOf===y?t.indexOf(e)!=-1:C(t,function(t){return t===e}))},j.invoke=function(t,e){var n=s.call(arguments,2),i=j.isFunction(e);return j.map(t,function(t){return(i?e:t[e]).apply(t,n)})},j.pluck=function(t,e){return j.map(t,function(t){return t[e]})},j.where=function(t,e,n){return j.isEmpty(e)?n?void 0:[]:j[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},j.findWhere=function(t,e){return j.where(t,e,!0)},j.max=function(t,e,n){if(!e&&j.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&j.isEmpty(t))return-1/0;var i={computed:-1/0,value:-1/0};return k(t,function(t,o,r){var a=e?e.call(n,t,o,r):t;a>i.computed&&(i={value:t,computed:a})}),i.value},j.min=function(t,e,n){if(!e&&j.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&j.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return k(t,function(t,o,r){var a=e?e.call(n,t,o,r):t;a<i.computed&&(i={value:t,computed:a})}),i.value},j.shuffle=function(t){var e,n=0,i=[];return k(t,function(t){e=j.random(n++),i[n-1]=i[e],i[e]=t}),i},j.sample=function(t,e,n){return arguments.length<2||n?t[j.random(t.length-1)]:j.shuffle(t).slice(0,Math.max(0,e))};var T=function(t){return j.isFunction(t)?t:function(e){return e[t]}};j.sortBy=function(t,e,n){var i=T(e);return j.pluck(j.map(t,function(t,e,o){return{value:t,index:e,criteria:i.call(n,t,e,o)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var S=function(t){return function(e,n,i){var o={},r=null==n?j.identity:T(n);return k(e,function(n,a){var s=r.call(i,n,a,e);t(o,s,n)}),o}};j.groupBy=S(function(t,e,n){(j.has(t,e)?t[e]:t[e]=[]).push(n)}),j.indexBy=S(function(t,e,n){t[e]=n}),j.countBy=S(function(t,e){j.has(t,e)?t[e]++:t[e]=1}),j.sortedIndex=function(t,e,n,i){n=null==n?j.identity:T(n);for(var o=n.call(i,e),r=0,a=t.length;a>r;){var s=r+a>>>1;n.call(i,t[s])<o?r=s+1:a=s}return r},j.toArray=function(t){return t?j.isArray(t)?s.call(t):t.length===+t.length?j.map(t,j.identity):j.values(t):[]},j.size=function(t){return null==t?0:t.length===+t.length?t.length:j.keys(t).length},j.first=j.head=j.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:s.call(t,0,e)},j.initial=function(t,e,n){return s.call(t,0,t.length-(null==e||n?1:e))},j.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},j.rest=j.tail=j.drop=function(t,e,n){return s.call(t,null==e||n?1:e)},j.compact=function(t){return j.filter(t,j.identity)};var A=function(t,e,n){return e&&j.every(t,j.isArray)?u.apply(n,t):(k(t,function(t){j.isArray(t)||j.isArguments(t)?e?a.apply(n,t):A(t,e,n):n.push(t)}),n)};j.flatten=function(t,e){return A(t,e,[])},j.without=function(t){return j.difference(t,s.call(arguments,1))},j.uniq=j.unique=function(t,e,n,i){j.isFunction(e)&&(i=n,n=e,e=!1);var o=n?j.map(t,n,i):t,r=[],a=[];return k(o,function(n,i){(e?i&&a[a.length-1]===n:j.contains(a,n))||(a.push(n),r.push(t[i]))}),r},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(t){var e=s.call(arguments,1);return j.filter(j.uniq(t),function(t){return j.every(e,function(e){return j.indexOf(e,t)>=0})})},j.difference=function(t){var e=u.apply(i,s.call(arguments,1));return j.filter(t,function(t){return!j.contains(e,t)})},j.zip=function(){for(var t=j.max(j.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=j.pluck(arguments,""+n);return e},j.object=function(t,e){if(null==t)return{};for(var n={},i=0,o=t.length;o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},j.indexOf=function(t,e,n){if(null==t)return-1;var i=0,o=t.length;if(n){if("number"!=typeof n)return i=j.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,o+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;o>i;i++)if(t[i]===e)return i;return-1},j.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(_&&t.lastIndexOf===_)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var o=i?n:t.length;o--;)if(t[o]===e)return o;return-1},j.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=0,r=new Array(i);i>o;)r[o++]=t,t+=n;return r};var $=function(){};j.bind=function(t,e){var n,i;if(w&&t.bind===w)return w.apply(t,s.call(arguments,1));if(!j.isFunction(t))throw new TypeError;return n=s.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(s.call(arguments)));$.prototype=t.prototype;var o=new $;$.prototype=null;var r=t.apply(o,n.concat(s.call(arguments)));return Object(r)===r?r:o}},j.partial=function(t){var e=s.call(arguments,1);return function(){return t.apply(this,e.concat(s.call(arguments)))}},j.bindAll=function(t){var e=s.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return k(e,function(e){t[e]=j.bind(t[e],t)}),t},j.memoize=function(t,e){var n={};return e||(e=j.identity),function(){var i=e.apply(this,arguments);return j.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},j.delay=function(t,e){var n=s.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},j.defer=function(t){return j.delay.apply(j,[t,1].concat(s.call(arguments,1)))},j.throttle=function(t,e,n){var i,o,r,a=null,s=0;n||(n={});var u=function(){s=n.leading===!1?0:new Date,a=null,r=t.apply(i,o)};return function(){var c=new Date;s||n.leading!==!1||(s=c);var l=e-(c-s);return i=this,o=arguments,0>=l?(clearTimeout(a),a=null,s=c,r=t.apply(i,o)):a||n.trailing===!1||(a=setTimeout(u,l)),r}},j.debounce=function(t,e,n){var i,o,r,a,s;return function(){r=this,o=arguments,a=new Date;var u=function(){var c=new Date-a;e>c?i=setTimeout(u,e-c):(i=null,n||(s=t.apply(r,o)))},c=n&&!i;return i||(i=setTimeout(u,e)),c&&(s=t.apply(r,o)),s}},j.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},j.wrap=function(t,e){return function(){var n=[t];return a.apply(n,arguments),e.apply(this,n)}},j.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},j.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},j.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)j.has(t,n)&&e.push(n);return e},j.values=function(t){for(var e=j.keys(t),n=e.length,i=new Array(n),o=0;n>o;o++)i[o]=t[e[o]];return i},j.pairs=function(t){for(var e=j.keys(t),n=e.length,i=new Array(n),o=0;n>o;o++)i[o]=[e[o],t[e[o]]];return i},j.invert=function(t){for(var e={},n=j.keys(t),i=0,o=n.length;o>i;i++)e[t[n[i]]]=n[i];return e},j.functions=j.methods=function(t){var e=[];for(var n in t)j.isFunction(t[n])&&e.push(n);return e.sort()},j.extend=function(t){return k(s.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},j.pick=function(t){var e={},n=u.apply(i,s.call(arguments,1));return k(n,function(n){n in t&&(e[n]=t[n])}),e},j.omit=function(t){var e={},n=u.apply(i,s.call(arguments,1));for(var o in t)j.contains(n,o)||(e[o]=t[o]);return e},j.defaults=function(t){return k(s.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},j.clone=function(t){return j.isObject(t)?j.isArray(t)?t.slice():j.extend({},t):t},j.tap=function(t,e){return e(t),t};var R=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof j&&(t=t._wrapped),e instanceof j&&(e=e._wrapped);var o=c.call(t);if(o!=c.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase;
}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=n.length;r--;)if(n[r]==t)return i[r]==e;var a=t.constructor,s=e.constructor;if(a!==s&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(s)&&s instanceof s))return!1;n.push(t),i.push(e);var u=0,l=!0;if("[object Array]"==o){if(u=t.length,l=u==e.length)for(;u--&&(l=R(t[u],e[u],n,i)););}else{for(var p in t)if(j.has(t,p)&&(u++,!(l=j.has(e,p)&&R(t[p],e[p],n,i))))break;if(l){for(p in e)if(j.has(e,p)&&!u--)break;l=!u}}return n.pop(),i.pop(),l};j.isEqual=function(t,e){return R(t,e,[],[])},j.isEmpty=function(t){if(null==t)return!0;if(j.isArray(t)||j.isString(t))return 0===t.length;for(var e in t)if(j.has(t,e))return!1;return!0},j.isElement=function(t){return!(!t||1!==t.nodeType)},j.isArray=b||function(t){return"[object Array]"==c.call(t)},j.isObject=function(t){return t===Object(t)},k(["Arguments","Function","String","Number","Date","RegExp"],function(t){j["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),j.isArguments(arguments)||(j.isArguments=function(t){return!(!t||!j.has(t,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(t){return"function"==typeof t}),j.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},j.isNaN=function(t){return j.isNumber(t)&&t!=+t},j.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},j.isNull=function(t){return null===t},j.isUndefined=function(t){return void 0===t},j.has=function(t,e){return l.call(t,e)},j.noConflict=function(){return t._=e,this},j.identity=function(t){return t},j.times=function(t,e,n){for(var i=Array(Math.max(0,t)),o=0;t>o;o++)i[o]=e.call(n,o);return i},j.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var O={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};O.unescape=j.invert(O.escape);var I={escape:new RegExp("["+j.keys(O.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(O.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(t){j[t]=function(e){return null==e?"":(""+e).replace(I[t],function(e){return O[t][e]})}}),j.result=function(t,e){if(null!=t){var n=t[e];return j.isFunction(n)?n.call(t):n}},j.mixin=function(t){k(j.functions(t),function(e){var n=j[e]=t[e];j.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),N.call(this,n.apply(j,t))}})};var q=0;j.uniqueId=function(t){var e=++q+"";return t?t+e:e},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","        ":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(t,e,n){var i;n=j.defaults({},n,j.templateSettings);var o=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),r=0,a="__p+='";t.replace(o,function(e,n,i,o,s){return a+=t.slice(r,s).replace(P,function(t){return"\\"+L[t]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(a+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),o&&(a+="';\n"+o+"\n__p+='"),r=s+e.length,e}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(n.variable||"obj","_",a)}catch(s){throw s.source=a,s}if(e)return i(e,j);var u=function(t){return i.call(this,t,j)};return u.source="function("+(n.variable||"obj")+"){\n"+a+"}",u},j.chain=function(t){return j(t).chain()};var N=function(t){return this._chain?j(t).chain():t};j.mixin(j),k(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];j.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],N.call(this,n)}}),k(["concat","join","slice"],function(t){var e=i[t];j.prototype[t]=function(){return N.call(this,e.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);var util={getwordlen:function(){var t=function(t){if("undefined"==typeof t)return 0;var e=t.match(/[^\x00-\x80]/g);return t.length+(e?e.length:0)},e=function(t){return t.replace(/[^\x00-\xff]/g,"*")};return function(n,i){return i&&(n=e(n)),t(jQuery.trim(n))}}()};jQuery.postJSON=function(t,e,n){return jQuery.ajax({type:"POST",url:t,data:e,dataType:"json",success:n})};var qyerUI={version:"0.1"};!function(t){function e(){n||t("input[placeholder], textarea[placeholder]").each(function(){for(var e=!1,n=0;n<i.length;n++)this==i[n]&&(e=!0);if(!e){i.push(this);var o=t(this).attr("placeholder");""==t(this).val()?t(this).val(o).css("color","#959595"):t(this).val()==o&&t(this).css("color","#959595"),t(this).on("focus",function(){t(this).val()==o&&t(this).val("").css("color","")}),t(this).on("blur",function(){""==t(this).val()&&t(this).val(o).css("color","#959595")})}})}var n="placeholder"in document.createElement("input"),i=[];qyerUI.placeholder=e,window.fixPlaceholder=e}(jQuery),jQuery(function(){qyerUI.placeholder()}),function(t){function e(){return t("html").css({overflow:"",height:""}),t("body").css({overflow:"",height:""}),t(".ui_fullpupBox_bg").hide(),o=!1,!1}function n(e){o&&t("body").append(r),o=!1,t("html").css({overflow:"hidden",height:t(window).height()}),t("body").css({overflow:"hidden",height:t(window).height()}),t(".ui_fullpupBox_bg").css({display:"block",height:t(window).height()}),t(".ui_fullpupBox").css({width:e}),t(".ui_fullpupBox_main").text("")}var i={},o=!0,r="<div class='ui_fullpupBox_bg'><div class='ui_fullpupBox'><div class='ui_fullpupBox_main'></div></div></div>";t(document).on("click",".ui_fullpupBox_close",function(){e()}),i.ajax=function(e){var i=e.url,o=e.width;n(o),t.get(i,function(e){t(".ui_fullpupBox_main").html(e),t(".ui_fullpupBox_head").css({width:o})})},i.show=function(e){var i=e.id,o=e.width;n(o);var r=t("#"+i).html();t(".ui_fullpupBox_main").html(r),t(".ui_fullpupBox_head").css({width:o})},qyerUI.fullpup=i}(jQuery),function(t){function e(){t(".ui_popup_bg").fadeOut(300)}function n(n,i){r&&(t("body").append(a),t(".ui_popup_close").on("click",function(){e()})),r=!1,n=parseInt(n,10),t(".ui_popup_bg").css({height:t(document).height()}).stop(!0,!0).fadeIn(300),t(".ui_popup").css({width:n,top:t(document).scrollTop()}),t(".ui_popup_main").text(""),t(".ui_popup_close").hide(),"show"==i&&t(".ui_popup_close").show()}function i(){var e=t(window).height(),n=t(".ui_popup").height(),i=(e-n)/2;i=i<20?20:i,t(".ui_popup").css("margin-top",i)}var o={},r=!0,a='<div class="ui_popup_bg"><div class="ui_popup"><p class="ui_popup_close" title="关闭"></p><div class="ui_popup_main"></div></div></div>';o.pupclose=e,o.start=n,o.ajax=function(e){if("object"==typeof e)var o=e.url,r=e.width||500,a=e.isclose||"show",s=e.callback||!1;n(r,a),t.get(o,function(e){t(".ui_popup_main").html(e),"function"==typeof s&&s(),i()})},o.show=function(e){if("object"==typeof e)var o=e.id,r=e.width||500,a=e.isclose||"show";n(r,a);var s=t("#"+o).html();t(".ui_popup_main").html(s),i()},o.showHtml=function(e){if("object"==typeof e)var o=e.html,r=e.width||500,a=e.isclose||"show";n(r,a),t(".ui_popup_main").html(o),i()},qyerUI.popup=o}(jQuery),function(){function t(){return jQuery(".ui_pupBox_bg").hide(),i=!1,!1}function e(t){i&&jQuery("body").append(o),i=!1,t=parseInt(t,10),jQuery(".ui_pupBox_bg").css({display:"block",height:jQuery(document).height()}),jQuery(".ui_pupBox").css({width:t+2,top:jQuery(document).scrollTop()}),jQuery(".ui_pupBox_main").text(""),jQuery(".ui_pupBox_close").show()}var n={},i=!0,o="<div class='ui_pupBox_bg'><div class='ui_pupBox'><div class='ui_pupBox_close'></div><div class='ui_pupBox_main'></div></div></div>";window.pupclose=t,n.start=e,n.ajax=function(n,i,o){var r="show",a=typeof n;"object"==a?(url=n.url,i=n.width,r=n.closebtn,o=n.cb):url=n,e(i),jQuery.get(url,function(t){if(jQuery(".ui_pupBox_main").html(t),"function"==typeof o)try{o()}catch(e){}}),jQuery(".ui_pupBox_close").bind("click",function(){t()}),"hide"==r&&jQuery(".ui_pupBox_close").hide()},n.show=function(n,i){var o="show",r=typeof n;"object"==r?(id=n.id,i=n.width,o=n.closebtn):id=n,e(i);var a=jQuery("#"+id).html();jQuery(".ui_pupBox_main").html(a),jQuery(".ui_pupBox_close").bind("click",function(){t()}),"hide"==o&&jQuery(".ui_pupBox_close").hide()},n.showHtml=function(n,i){var o="show",r=typeof n;"object"==r?(html=n.html,i=n.width,o=n.closebtn):html=n,e(i),jQuery(".ui_pupBox_main").html(html),jQuery(".ui_pupBox_close").bind("click",function(){t()}),"hide"==o&&jQuery(".ui_pupBox_close").hide()},window.popup=n}(),function(t){function e(e,i){n&&(t("body").append("<textarea id='js_autoheight_clone'></textarea>"),n=!1);var o=t("#js_autoheight_clone");o.width(t(e).width()),o.val(t(e).val()),o.css("font-size",i.fontSize),o.css("line-height",i.lineHeight),setTimeout(function(){var n=o.get(0).scrollHeight;t(e).height(n)},1)}var n=!0;qyerUI.autoheight=e}(jQuery),function(t){function e(e){if("object"==typeof e){var i=e.msg||"操作已成功！",o=e.type||"true",r=e.timeout||2e3;clearTimeout(n);var a=document.getElementById("mod_message"),s=document.getElementById("mod_message_cont");if(!a){var u=document.createElement("div");u.id="mod_message";var c=document.createElement("p");c.id="mod_message_cont",u.appendChild(c),document.body.appendChild(u),a=document.getElementById("mod_message"),s=document.getElementById("mod_message_cont")}s.className=o,s.innerHTML=i,a.style.display="block";var l=a.offsetWidth,p=document.body.offsetWidth,d=(p-l)/2;a.style.left=d+"px","stop"!=r&&(n=setTimeout(function(){t(a).slideUp()},r))}}var n;qyerUI.message=e}(jQuery);var process_submit=function(){var t=function(){this.id=null,this.rmclass=null,this.addclass=null,this.isval=!0,this.before=function(t,e,n,i,o){this.id=t,this.rmclass=e,this.addclass=n,i=i||"提交中...","html"==o&&(this.isval=!1),this.isval?jQuery("#"+t).removeClass(e).addClass(n).val(i):jQuery("#"+t).removeClass(e).addClass(n).html(i)},this.after=function(t){this.isval?jQuery("#"+this.id).removeClass(this.addclass).addClass(this.rmclass).val(t):jQuery("#"+this.id).removeClass(this.addclass).addClass(this.rmclass).html(t)}};return new t}();popup.coast=function(t,e,n,i){function o(){jQuery(".ui_coast").fadeOut(500),jQuery(".ui_coast").remove()}t=t||400,n.text=n.text||"感谢你的分享，让其他穷游er看到了你在这里留下的回忆。";var r='<div class="ui_coast"><p class="ui_coast_cnt"><img src="../../../../common2.qyerstatic.com/place/common/basic/old/images/tpl/icon_true.png"/*tpa=http://common2.qyerstatic.com/place/common/basic/old/images/tpl/icon_true.png*/ width="34" height="34" alt="" class="ui_coast_img" />'+n.text+'</p><ul class="ui_coast_num clearfix">';if(void 0!=n.credits1&&(r=r+"<li>经验值<span>"+n.credits1+"</span></li>"),void 0!=n.credits2&&(r=r+"<li>贡献<span>"+n.credits2+"</span></li>"),"undefined"!=typeof i)switch(i){case"warn":r=r.replace(/icon_true.png/,"icon_warn.png"/*tpa=http://common1.qyerstatic.com/place/js/common/icon_warn.png*/);break;case"error":r=r.replace(/icon_true.png/,"icon_error32.png"/*tpa=http://common1.qyerstatic.com/place/js/common/icon_error32.png*/)}r+="</ul></div>",jQuery("body").append(r);var a=jQuery(window).width(),s=jQuery(window).height(),u=jQuery(".ui_coast").outerHeight(),c=t+42,l=(a-c)/2,p=(s-u)/2+jQuery(document).scrollTop(),d=10;if(e)if(e=jQuery("#"+e),e.size()>0){var f=e.offset(),h=e.outerWidth(),m=e.outerHeight(),g=f.top-u-d,v=f.left-(c-h)/2;a-h-v+d<c?(v=a-c-d,f.top-jQuery(document).scrollTop()<u?(g=f.top+m+d,jQuery(".ui_coast").css({width:t,left:v,top:g}).show()):jQuery(".ui_coast").css({width:t,left:v,top:g}).show()):f.top-jQuery(document).scrollTop()<u?(g=f.top+m+d,v<10&&(v=10),jQuery(".ui_coast").css({width:t,left:v,top:g}).show()):(v<10&&(v=10),jQuery(".ui_coast").css({width:t,left:v,top:g}).show())}else jQuery(".ui_coast").css({width:t,left:l,top:p}).show();else jQuery(".ui_coast").css({width:t,left:l,top:p}).show();window.setTimeout(o,2e3)},jQuery(function(t){window.uitab=function(){t(".ui_tab").each(function(){t(this).children(".ui_tab_trigger").find(".ui_tab_trigger_item").each(function(e){t(this).on("click",function(){0==t(this).hasClass("ui_tab_trigger_item_disabled")&&(t(this).addClass("ui_tab_trigger_item_current").siblings(".ui_tab_trigger_item").removeClass("ui_tab_trigger_item_current"),t(this).parents(".ui_tab_trigger").siblings(".ui_tab_cnt").children(".ui_tab_cnt_item:eq("+e+")").addClass("ui_tab_cnt_item_current").siblings(".ui_tab_cnt_item").removeClass("ui_tab_cnt_item_current"))})})})},window.uitab()});var tips=function(){var t=function(){this.isshow=!1,this.html=["<div class='ui_message __XXtipsXX_' >","","</div>"],this.scroll_show=function(){},this.show=function(t,e){t=t||"",e=e||2e3;var n=this.getobj();return this.isshow?(jQuery(n).css({left:jQuery(document).width()/2-200}),void n.html(t)):(this.html[1]=t,jQuery("body").append(this.html.join("")),n=this.getobj(),jQuery(n).css({left:jQuery(document).width()/2-200}),n.show(),this.isshow=!0,void setTimeout(function(){jQuery(n).slideUp(),tips.isshow=!1},e))},this.hide=function(){this.getobj().fadeOut(),this.isshow=!1},this.getobj=function(){return jQuery(".__XXtipsXX_")}};t.prototype.confirm=function(t,e,n){void 0==n&&(n="您确定要删除吗？");var i=t.clientX,o=t.clientY,r="jsdelconfirm",a=['<div class="ui_delete" id="'+r+'">','<div class="ui_delete_box">','<div><span class="icon_doubt">'+n+"</span></div>",'<div class="ui_delete_btns">','<input type="button" value="取消" class="ui_button_cancel" id="jsconfirmcancel" /><input type="button" id="jsconfirmok" value="确定" class="ui_button" />',"</div>","</div>","</div>"],s=jQuery("#"+r);s.size()<=0?(jQuery("body").append(a.join("")),s=jQuery("#"+r)):jQuery(s).find(".icon_doubt").html(n);var u=91,c=jQuery(document).scrollTop()+o-100;jQuery(s).css("top",c+"px");var l=jQuery(".ui_delete").width(),p=i,d=jQuery(document).scrollLeft();i-d<l||(p=i-l/2);var f=jQuery(document).width();p+l>f&&(p=f-l-20),p<=0&&(p=20),jQuery(s).hide(),jQuery(s).css({left:p,top:c+u}).animate({height:"show",opacity:"show",top:c},200),jQuery("#jsconfirmcancel").unbind("click").click(function(){jQuery(s).animate({height:"hide",opacity:"hide",top:c+u},200)}),jQuery("#jsconfirmok").unbind("click").click(function(t){e(),jQuery(s).animate({height:"hide",opacity:"hide",top:c+u},200)})};var e=new t;return jQuery(document).scroll(function(){e.scroll_show()}),e}(),_ajax={ajaxurl:"http://common1.qyerstatic.com/ajax.php",get:function(t,e,n){var i=+new Date;jQuery.get(_ajax.ajaxurl+"?action="+t+"&rnd="+i,e,n)},getJSON:function(t,e,n){var i=+new Date;jQuery.getJSON(_ajax.ajaxurl+"?action="+t+"&rnd="+i,e,n)},post:function(t,e,n){e=jQuery.merge(e,{type:"POST"}),jQuery.post(_ajax.ajaxurl+"?action="+t,e,n)}};String.prototype.gbtrim=function(t,e){for(var n="",i=e||"",o=0,r=0;r<this.length;r++)this.charCodeAt(r)>127||94==this.charCodeAt(r)?o+=2:o++;if(o<=t)return this;o=0,t=t>i.length?t-i.length:t;for(var r=0;r<this.length;r++){if(this.charCodeAt(r)>127||94==this.charCodeAt(r)?o+=2:o++,o>t){n+=i;break}n+=this.charAt(r)}return n},jQuery(function(){var t=jQuery(".auto_text").size()>0,e=function(){jQuery("body").append("<textarea id='auto_text_shadow' style='display:block;'></textarea>")};t&&e();var n=function(t){jQuery(".auto_text").size()&&e();var n=t||jQuery(".auto_text"),i="auto_text_shadow",o=jQuery("#"+i);if(i!=jQuery(n).attr("id")){jQuery(o).width(jQuery(n).width());var r=jQuery(n).css("font-size"),a=jQuery(n).css("line-height"),s=jQuery(n).css("text-indent"),u=parseInt(jQuery(n).css("min-height").replace(/px/,""));u=a,jQuery(o).css({height:"18px","font-size":r,"text-indent":s});var c=jQuery(n).val()+"穷游";jQuery(o).val(c),setTimeout(function(){var t=jQuery(o).get(0).scrollHeight;t<=u&&(t=u),jQuery(n).height(t)},1)}};jQuery(document).on("change",".auto_text",function(){n(this)}),jQuery(document).on("keydown",".auto_text",function(){n(this)}),jQuery(document).on("keyup",".auto_text",function(){n(this)}),window.resizeTextareaHeight=n});var thiswin=this;jQuery(function(){if(top==thiswin){var t=window.location.href;if(t.indexOf("http://common1.qyerstatic.com/place/js/common/m.qyer.com")==-1&&"1"!=yjbGetCookie("_surveyed")&&"1"!=yjbGetCookie("surveyed")){var e=Math.random();65==parseInt(100*e)&&(jQuery.getJSON("http://feed.qyer.com/index/survey?callback=?",function(t){if(t.show){var e='<div style="width:520px;"><div class="ui_pupBox_head">欢迎参与穷游调查</div><div class="ui_pupBox_content" style="background:url(http://common2.qyerstatic.com/place/common/basic/old/images/wenjuan/qyer_wenjuan_bg.png) no-repeat;padding-left:160px;"><div class="f14 p10 pb20">'+t.survey_content+'</div><div class="ui_pupBox_foot clearfix" style="padding:0;"><a class="ui_button fr" target="_blank" id="to_survey" href="'+t.survey_url+'">参与调查</a><input type="button" onclick="javascript:pupclose();" class="ui_button_cancel fr mr10" value="不参与"></div></div></div>';popup.showHtml(e,520)}}),jQuery(document).on("click","#to_survey",function(){var t=new Date;return t.setTime(t.getTime()+31536e6),document.cookie="surveyed=1;domain=.qyer.com;expires="+t.toGMTString(),pupclose(),!0}))}}}),jQuery(function(){function t(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e);return null!=n?unescape(n[2]):null}var e=t("targetobj");null!=e&&("login"==e&&"reg"==e||(e="reg"),/^http:\/\/bbs\.qyer\.com\//.test(window.location.href)?ajaxlogin(0,"","http://common1.qyerstatic.com/place/js/common/bbsajax.php","reload",e,window.location.href):ajaxlogin(0,"","http://common1.qyerstatic.com/place/js/common/ajax.php","reload",e,window.location.href))}),loadjscssfile(("https:"==document.location.protocol?"//https":"//")+"static.qyer.com/js/common/jquery.cookie.js","js");var jiathis_config={boldNum:0,siteNum:5,showClose:!1,title:"",summary:" ",pic:"",data_track_clickback:!1,appkey:{tsina:"2254065920",tqq:"fae7e432cbfd4ae378f0e501ebb4feed",renren:"d5ecb574cf7e4ef7a3840898aab6fe4f",qzone:"fae7e432cbfd4ae378f0e501ebb4feed",douban:"0239fb1e9a36072606adf15bcea21572"},ralateuid:{tsina:"1721449743"},evt:{}};jQuery(function(){function t(){i.hide()}jQuery("._js_jiathis_style_share a").mouseover(function(){jiathis_config.title="",jiathis_config.summary="",jiathis_config.pic="",jiathis_config.url="";var t=jQuery(this),e=t.attr("data-title"),n=t.attr("data-summary"),i=t.attr("data-pic"),o=t.attr("data-url")||"";e&&(e=e.replace(/&gt;/g,">"),e=e.replace(/&lt;/g,"<")),n&&(n=n.replace(/&gt;/g,">"),n=n.replace(/&lt;/g,"<")),e&&(jiathis_config.title=e),n&&(jiathis_config.summary=n),i&&(jiathis_config.pic=i),o&&(jiathis_config.url=o)}),jQuery("._js_jiathis_style_share").mouseover(function(){var t=jQuery(this),e=t.attr("data-title"),n=t.attr("data-summary"),i=t.attr("data-pic"),o=t.attr("data-url")||"";e&&(e=e.replace(/&gt;/g,">"),e=e.replace(/&lt;/g,"<")),n&&(n=n.replace(/&gt;/g,">"),n=n.replace(/&lt;/g,"<")),jiathis_config.title||(jiathis_config.title=e),jiathis_config.summary||(jiathis_config.summary=n),jiathis_config.pic||(jiathis_config.pic=i),jiathis_config.url||(jiathis_config.url=amendUrl(window.location.href,o))});var e,n=jQuery(".photo_end_share_btn"),i=jQuery(".bbs_tools_sharelay");n.hover(function(){window.clearTimeout(e),i.show()},function(){e=window.setTimeout(function(){t()},200)}),i.hover(function(){window.clearTimeout(e),jQuery(this).show()},function(){e=window.setTimeout(function(){t()},200)}),"https:"!=document.location.protocol&&window.setTimeout(function(){loadjscssfile("http://v3.jiathis.com/code/jia.js?uid=1346345347004722","js")},500)}),jQuery(document).on("click","._js_jiathis_style_share a",function(){var t=jQuery(this).attr("class");if("jiathis_button_tsina"!=t){var e=jQuery(this).attr("data-url");e&&(jiathis_config.url=amendUrl(jiathis_config.url,e))}}),jQuery(function(){function t(){e=0,clearTimeout(i),window.setTimeout(function(){0==e&&jQuery(".ui_usercard").fadeOut(50)},500)}var e=0,n=0;jQuery(document).on("click","._js_follow_func",function(){follow(jQuery(this))}),jQuery(document).on("click","._jsaddmsg",function(){if(QYER.uid<=0)return ajaxlogin(),!1;var t=jQuery(this).attr("data-uid"),e=jQuery(this).attr("data-relate");popup.ajax("/api.php?action=addmsg&oper=form&uid="+t+"&relate="+e,510)});var i=0;jQuery(document).on("mouseover","._js_face_usercard,.ui_headPort",function(t){if(!n){var o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href="../../../../static.qyer.com/css/user2/medal.css"/*tpa=http://static.qyer.com/css/user2/medal.css*/,document.body.appendChild(o),n=1}var r=jQuery(this).attr("data-uid");if(void 0==r&&(r=jQuery(this).attr("alt")),e=1,jQuery(".ui_usercard").remove(),void 0==r)return!1;thiz=this;var a=t.pageX;t.pageX+300>jQuery(window).width()&&(a=jQuery(window).width()-300);var s="http://common1.qyerstatic.com/ajax.php";/^http:\/\/bbs\.qyer\.com\//.test(window.location.href)&&(s="http://common1.qyerstatic.com/bbsajax.php"),clearTimeout(i),i=setTimeout(function(){jQuery.get(s+"?action=usercard&uid="+r,function(e){""!=e&&(jQuery("body").append(e),jQuery(".ui_usercard").css({width:298,height:"auto",position:"absolute",left:a,top:t.pageY+10,zIndex:99}).show())})},300)}),jQuery(document).on("mouseover",".ui_usercard",function(){e=1}),jQuery(document).on("mouseleave",".ui_usercard",function(){t()}),jQuery("._js_face_usercard,.ui_headPort").mouseleave(function(){t()})}),jQuery(document).on("click",".ui_popup_close",function(){jQuery(".ui_popup_bg").removeClass("popup_video_bg")}),!function(t){qyerUI=window.qyerUI||{},qyerUI.SNS=qyerUI.SNS||{},qyerUI.SNS.share={_init:function(){this._bindBtnEvent()},_bindBtnEvent:function(){t(document).on("click","._jsclose",function(){pupclose()}),t(document).on("click","._jsgettoken",function(){var e,n,i;e=t(this),n=e.attr("url")+"&refer="+window.location.href,i=e.attr("notoken"),window.open(n,"newwindow","height=450px,width=600px,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no"),pupclose(),e=n=i=null})},create:function(t){document.write(this.getHTML(t))},getHTML:function(t){var e=[],t=t||{},n=t.weibopublish||{},i=t.qqpublish||{};return e.push('<p class="ui_textboxShare fr '+("min"==t.iconSize?"ui_textboxShareSmall":"")+'">'),e.push('    <em class="title">'+(t.text?t.text:"同时转发到：")+"</em>"),e.push('    <label class="weibo">'),e.push('        <input type="checkbox" name="weibopublish" class="weibopublish" flag="0" weibo="weibo" value="" onclick="qyerUI.SNS.share.onSelect(this)" id="'+(n.id||"weibopublish")+'"  notoken="'+("0"==n.notoken?"0":"1")+'" '),"0"==n.notoken&&n.checked&&e.push(' checked="checked" '),e.push(" />"),e.push('        <span class="icon '+("0"==n.notoken?"":"iconnull")+'"></span>'),e.push("    </label>"),e.push('    <label class="qzone">'),e.push('        <input type="checkbox" name="qqpublish" class="qqpublish" flag="0" value="" weibo="qq"  onclick="qyerUI.SNS.share.onSelect(this)" id="'+(i.id||"qqpublish")+'" notoken="'+("0"==i.notoken?"0":"1")+'"'),"0"==i.notoken&&i.checked&&e.push(' checked="checked" '),e.push(" />"),e.push('        <span class="icon '+("0"==i.notoken?"":"iconnull")+'"></span>'),e.push("    </label>"),e.push("</p>"),e.join("")},onSelect:function(e){if(!QYER.uid)return e.checked=!1,void ajaxlogin();var n=t(e);if(n.is(":checked")){if("1"==n.attr("notoken"))return void this._showpopup(n);if("0"==n.attr("flag")){var i=n.attr("weibo"),o=n.attr("id"),r=n.attr("notoken");t.getJSON("/api.php?action=checkweibo&type="+i,function(t){if("ok"!=t.result){var e='<div style="width:440px;"><div class="ui_pupBox_head">提示</div><div class="ui_pupBox_content">您在我们网站的token已经过期，是否重新授权完成同步？</div><div class="ui_pupBox_foot clearfix"><input notoken="'+r+'" weibo="'+i+'" type="button" url="http://login.qyer.com/login.php?action='+i+'&bind=1&publish=1" class="ui_button fr _jsgettoken" value="确定"><input type="button" class="ui_button_cancel fr mr10 _jsclose" flag="'+o+'" value="取消"></div></div>';popup.showHtml(e,440)}}),n.attr("flag",1)}}},_showpopup:function(t){var e,n,i,o;e=t.attr("weibo"),n=t.attr("id"),i=t.attr("notoken"),o='<div style="width:440px;"><div class="ui_pupBox_head">提示</div><div class="ui_pupBox_content">使用此功能需绑定到穷游，现在就绑定吗？</div><div class="ui_pupBox_foot clearfix"><input notoken="'+i+'" weibo="'+e+'" type="button" url="http://login.qyer.com/login.php?action='+e+'&bind=1&publish=1" class="ui_button fr _jsgettoken" value="确定"><input type="button" class="ui_button_cancel fr mr10 _jsclose" flag="'+n+'" value="取消"></div></div>',t.attr("checked",!1),popup.showHtml(o,440),e=n=i=o=null},refresh:function(e){var n;t.each(e.list,function(){n=t("."+this.className),n.attr({notoken:this.notoken,checked:"0"==this.notoken&&this.checked,flag:"1"}),n.next()["1"==this.notoken?"addClass":"removeClass"]("iconnull")})}},window.qyerUI.SNS.share._init()}(jQuery),function(t){window.qyerUtil||(window.qyerUtil={_head:null,_getHead:function(){return this._head||(this._head=document.getElementsByTagName("head")[0]),this._head},insertStyle:function(t){var e=document.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.innerHTML=t,this._getHead().appendChild(e),e=null},ajaxFillter:function(t,e,n){if("object"==typeof t&&t.extra&&t.extra.code)switch(0|t.extra.code){case 1:window.qyerUtil.showAntiSpam(t.extra.msg)}},_showAntiSpam_isLoadCss_:!1,showAntiSpam:function(e){function n(t){return['<div class="qui-antiSpam">',"<div>",'<div class="qui-antiSpam-dt">','<div class="qui-antiSpam-content">','<img src="../../../../common2.qyerstatic.com/place/common/component/antiSpam/icon.png"/*tpa=http://common2.qyerstatic.com/place/common/component/antiSpam/icon.png*/ />','<p class="antiSpamP1">'+(t||"由于敏感词限制，你刚刚发布的内容需要编辑审核后才能被他人访问")+"</p>",'<p class="antiSpamP2 js_antiSpam_close">我知道了 > </p>',"</div>","</div>","</div>","</div>"].join("")}window.qyerUtil._showAntiSpam_isLoadCss_||(window.qyerUtil.insertStyle([".qui-antiSpam{position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; background-image:url(http://common2.qyerstatic.com/place/common/basic/images/bg_255_255_255_0.7.png); z-index: 110000; overflow-y: auto; }",".qui-antiSpam >div{display: table; height: 100%; margin: 0 auto; }",".qui-antiSpam-dt{display: table-cell; vertical-align:middle; text-align: center; }",".qui-antiSpam-content{border: 1px solid #ccc; width: 575px; background-color: #f5f5f5; box-shadow: 0px 0px 15px #999; }",".qui-antiSpam-content > img{margin:50px 0px 30px 0px; }",".qui-antiSpam-content .antiSpamP1{font-size:20px; width:337px; margin:0 auto; }",".qui-antiSpam-content .antiSpamP2{font-size:14px; margin:20px 0px 35px 0px; color:#0074b1; cursor:pointer; }"].join("")),window.qyerUtil._showAntiSpam_isLoadCss_=!0),t(n(e)).appendTo(document.body).find(".js_antiSpam_close").one("click",function(e){t(e.currentTarget).parent().parent().parent().parent().remove()})}})}(jQuery);var friends=function(){var frie=function(){this.addmsg_form=function(t){t="undefined"==typeof t?0:parseInt(t),popup.ajax("/api.php?action=addmsg&oper=form&uid="+t+"&randomstr="+Math.random(),"580")},this.addmsg_formPost=function(){var ojbForm=this;return $("#xxaddmsgform").get(0).disabled=!0,$(ojbForm).get(0).disabled=!0,$(ojbForm).ajaxSubmit({success:function(txt){var ret;eval("ret="+txt),77==ret.error_code?ajaxlogin():"ok"==ret.result?(pupclose(),tips.show("发送成功。"),"re"http://common1.qyerstatic.com/place/js/common/==ret.data.msg?location.href="notice_action_msgdetail_againuid_"+ret.data.msgto:location.href="notice_m_pms"):tips.show(ret.data.msg),$("#xxaddmsgform").get(0).disabled=!1,$(ojbForm).get(0).disabled=!1}}),!1}};return new frie}(jQuery);$(function(){$(".jsaddmsg").click(function(){var t=$(this).attr("data");islogin(function(){friends.addmsg_form(t)})}),$(document).on("submit","#addmsgform",friends.addmsg_formPost),$(document).on("submit","#addmsgformre",friends.addmsg_formPost)}),$(document).ready(function(){function t(t){for(var n=0;n<e;n++){$(".selectks").get(n).getAttribute("class");if(n==t){$(".selectks").eq(n).addClass("selectksposition");$(".selectksclass").get(n).style.display="",$(".selectksclass").eq(n).addClass("showthis")}else $($(".selectks").get(n)).removeClass("selectksposition")}}var e=0;$(".selectkstitle").each(function(n){$(this).click(function(e){t(n),e.stopPropagation()}),e++}),$(".selectksclass").each(function(t){$(this).click(function(){$(this).hide(),$(this).find("li").each(function(){"current"==$(this).attr("class")&&($(this).parent().parent().parent().parent().find(".selectkstitle em").html($(this).html()),$(this).parent().parent().parent().parent().find("input").val($(this).attr("v")))})})}),$(document).on("click",".js_create_avatar",function(){var t=$("#x").val(),e=$("#y").val(),n=$("#w").val(),i=$("#h").val(),o=$(".jcrop-holder").find("img").width(),r=$(".jcrop-holder").find("img").height();$.ajax({type:"POST",url:"http://common1.qyerstatic.com/profile.php",data:"action=editavatar&x="+t+"&y="+e+"&w="+n+"&h="+i+"&picw="+o+"&pich="+r+"&strr="+Math.random(),dataType:"json",success:function(t){77==t.error_code?ajaxlogin():"ok"==t.result?(pageupdateavatar(),tips.show(t.data.msg),setTimeout(function(){$(".container").hide(),$(".js_button").hide(),scroll(0,0)},2500)):tips.show(t.data.msg)}})})}),$(".selectlist ul").find("li").mouseover(function(){$(this).addClass("current")}),$(".selectlist ul").find("li").mouseout(function(){$(this).removeClass("current")}),$(".infoform ul li").find("input").bind("focus",function(){$(this).nextAll(".ulayouttag").show(),$(this).nextAll(".txttag").hide(),$(this).addClass("txtfocus"),$(this).removeClass("txterror")}).bind("blur",function(){$(this).nextAll(".ulayouttag").hide(),$(this).removeClass("txtfocus")}).bind("keyup",function(){$(this).nextAll(".ulayouttag").show()}).mouseover(function(){$(this).addClass("txthover")}).mouseout(function(){$(this).removeClass("txthover")}),$(".infoform ul li").find("textarea").bind("focus",function(){$(this).nextAll(".ulayouttag").show(),$(this).nextAll(".txttag").hide(),$(this).addClass("txtfocus"),$(this).removeClass("txterror")}).bind("blur",function(){$(this).nextAll(".ulayouttag").hide(),$(this).removeClass("txtfocus")}).bind("keyup",function(){$(this).nextAll(".ulayouttag").show()}).mouseover(function(){$(this).addClass("txthover")}).mouseout(function(){$(this).removeClass("txthover")}),$(".userlxphlist1 span").find("a").click(function(){$(this).hasClass("current")?$(this).removeClass("current"):$(this).addClass("current")}),$(".ufollowcontent").mouseover(function(){$(this).find(".editfollw").show()}),$(".ufollowcontent").mouseout(function(){$(this).find(".editfollw").hide()}),$(".selectksclass").each(function(){$(this).height()>336&&$(this).addClass("selectksclassso")}),$(function(){function t(){$(".qyer_head_crumb .arrow").removeClass("hover"),$(".qyer_head_crumb_pulldown").hide()}var e,n,i,o,r,a;$(".qyer_head_crumb .arrow").hover(function(){a=$(this),e=a.parent(".drop"),o=e.height(),n=e.offset().left,i=e.offset().top;var t=$(this).attr("data");window.clearTimeout(r),$(".qyer_head_crumb .arrow").removeClass("hover"),$(this).addClass("hover"),$(".qyer_head_crumb_pulldown").hide(),$("."+t).css({left:n,top:i+o}).show()},function(){}),$("http://common1.qyerstatic.com/place/js/common/.qyer_head_crumb .drop").hover(function(){},function(){r=window.setTimeout(t,300)}),$(".qyer_head_crumb_pulldown").hover(function(){window.clearTimeout(r),a.addClass("hover"),$(this).show()},function(){r=window.setTimeout(t,300)})}),function(t){"undefined"==typeof t.cookie&&(t.cookie=function(e,n,i){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null===n||void 0===n)){if(i=t.extend({},i),null!==n&&void 0!==n||(i.expires=-1),"number"==typeof i.expires){var o=i.expires,r=i.expires=new Date;r.setDate(r.getDate()+o)}return n=String(n),document.cookie=[encodeURIComponent(e),"=",i.raw?n:encodeURIComponent(n),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}i=n||{};for(var a,s=i.raw?function(t){return t}:decodeURIComponent,u=document.cookie.split("; "),c=0;a=u[c]&&u[c].split("=");c++)if(s(a[0])===e)return s(a[1]||"");return null})}(jQuery),jQuery("<div class='ui_upward_wrapper' id='ui_gotop'><div class='ui_upward_icon'>回页顶</div></div>").prependTo("body"),jQuery(function(t){var e=t("#ui_gotop"),n=e.innerHeight(),i=t(document),o=t(window),r=t(".qyer_footer"),a=r.height(),s=r.length;o.on("scroll",function(){var t=i.width(),r=i.height(),u=(o.width(),o.height()),c=u-n-30,l=(t-980)/2+1010,p=10;if(s){var d=r-a-i.scrollTop();u>d&&(c=d-n-30)}0==i.scrollTop()?e.fadeOut(300):t>1200?e.css({left:l,right:"auto",top:c}).fadeIn(300):e.css({left:"auto",right:p,top:c}).fadeIn(300)}),e.click(function(){t("body,html").animate({scrollTop:0})})});var doing=function(){function t(){this.preurl="http://common1.qyerstatic.com/public.php?action=feeling",
this.TYPE_CITY=1,this.TYPE_POI=2,this.TYPE_CONTINENTS=3,this.TYPE_COUNTRY=4,this.__for__=function(t,e,n){e||(e=function(t){t.result&&alert("操作成功")}),n=n||this.preurl,t._rnd_=+new Date,$.postJSON(n,t,e)},this.getDoings=function(t,e,n,i){this.__for__({pid:t,act:e,d:n},i,"http://common1.qyerstatic.com/api.php?action=getdoings")}}var e=["planto","beento","lived"],n=["city","poi","continents","country"];return $.each(e,function(e,i){$.each(n,function(e,n){t.prototype[i+n]=function(t,e){return function(n,i,o){var r={id:i,oper:t};r[t]=n?1:0,"city"==e?r.type=this.TYPE_CITY:"poi"==e?r.type=this.TYPE_POI:"continents"==e?r.type=this.TYPE_CONTINENTS:"country"==e&&(r.type=this.TYPE_COUNTRY),this.__for__(r,o)}}(i,n)})}),new t}(),place_doings_comment_popupmessage=[],place_doings_batch_data=[];define("project/js/slider",[],function(){function t(t){var e={prev:$(),next:$(),content:$(),item:$(),page:$(),width:0,step:1,amount:0,loop:!0,curIndex:0,autoPlay:!1,showTime:3e3,hoverPause:!0};this.options=$.extend(e,t)}function e(e){var n=new t(e);return n.init(),n}var n=null;return t.prototype.oldAnimate=function(t){this.options.item.eq(this.options.curIndex).stop(!0).animate({left:t},400)},t.prototype.newAnimate=function(t){var e=this,n=this.options.item.eq(this.options.curIndex);e.beforeAnimate(e.options.curIndex,n),n.css({left:t}).stop(!0).animate({left:0},400,function(){e.onAnimate(e.options.curIndex,n)})},t.prototype.beforeAnimate=function(t,e){"function"==typeof this.options.beforeAnimate&&this.options.beforeAnimate(t,e)},t.prototype.onAnimate=function(t,e){"function"==typeof this.options.onAnimate&&this.options.onAnimate(t,e)},t.prototype.autoPlay=function(){var t=this;this.options.autoPlay&&(window.clearTimeout(n),n=window.setTimeout(function(){t.doNext()},t.options.showTime))},t.prototype.doNext=function(){!this.options.loop&&this.options.next.hasClass("disabled")||(this.oldAnimate("-100%"),this.getNext(),this.newAnimate("100%"),1==this.options.page.length&&this.options.page.children().removeClass("current").eq(this.options.curIndex).addClass("current"),this.autoPlay(),this.options.loop||(this.options.curIndex>=this.options.amount-1&&this.options.next.addClass("disabled"),this.options.prev.removeClass("disabled")))},t.prototype.doPrev=function(){!this.options.loop&&this.options.prev.hasClass("disabled")||(this.oldAnimate("100%"),this.getPrev(),this.newAnimate("-100%"),this.options.loop||(this.options.curIndex<=0&&this.options.prev.addClass("disabled"),this.options.next.removeClass("disabled")))},t.prototype.getNext=function(){this.options.curIndex++,this.options.curIndex>this.options.amount-1&&(this.options.curIndex=0)},t.prototype.getPrev=function(){this.options.curIndex--,this.options.curIndex<0&&(this.options.curIndex=this.options.amount-1)},t.prototype.bindEvent=function(){var t=this;this.options.next.on("click",function(){t.doNext()}),this.options.prev.on("click",function(){t.doPrev()}),this.options.autoPlay&&this.options.hoverPause&&(this.options.content.on("mouseenter",function(){window.clearTimeout(n)}),this.options.content.on("mouseleave",function(){t.autoPlay()}))},t.prototype.init=function(){this.options.item=this.options.content.children(),this.options.width=this.options.item.eq(0).outerWidth(),this.options.amount=this.options.item.length,this.options.amount<2||(this.options.item.css({position:"absolute",left:"100%"}).eq(0).css({left:"0"}),this.bindEvent(),this.autoPlay(),this.options.loop||this.options.prev.addClass("disabled"))},e}),define("common/util/util",[],function(){"use strict";return{getInstance:function(t,e){switch(e=e||[],e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);default:for(var n=[],i=0,o=e.length;i<o;i++)n.push("arguments["+i+"]");return new Function("return new this("+n.join(",")+");").apply(t,e)}},extend:function(t,e){$.extend(!0,t,e,t)},getStarHtml:function(t,e,n,i){t=Math.floor(t)/2;for(var o=[],r=1;r<=5;r++)t>=r?o.push(e):t+1>r?o.push(n):o.push(i);return o.join("")}}}),define("common/lang/aop",[],function(){"use strict";var t=function(t,n,i,o){var r,a,s=$.isFunction(t);if(s?(r=t,o=i,i=n):r=t[n],a=r,$.isFunction(i)){a=e(i,a,1);for(var u in r)a[u]=r[u]}if($.isFunction(o)){a=e(a,o,0);for(var u in r)a[u]=r[u]}return s||(t[n]=a),a},e=function(t,e,n){return function(){var i=t.apply(this,arguments),o=e.apply(this,arguments);return 0==n?i:o}},n=function(e,n,i){return t(e,n,i,null)},i=function(e,n,i){return t(e,n,null,i)},o=function(e,n,i,o){return t(e,n,i,o)};return{before:n,after:i,wrapper:o}}),define("common/lang/oo-static",["../util/util"],function(t){"use strict";return function(){t.extend(this,{getStatic:function(t){return t?this[t]:this},setStatic:function(e,n){return 1===arguments.length?t.extend(this,e):this[e]=n,this}}),this.implement({getStatic:function(t){return this.constructor.getStatic.apply(this.constructor,arguments)},setStatic:function(t,e){return this.constructor.setStatic.apply(this.constructor,arguments),this},callStatic:function(t,e){return this.getStatic(t).apply(this.constructor,e)}})}}),define("common/lang/oo",["../util/util","./aop","./oo-static"],function(t,e,n){"use strict";var i=function(t){var e=function(){};return e.prototype=t,new e},o=function(e,n,i){e?"function"!=typeof e&&(i=n,n=e,e=u):e=u;var o=r(e,function(){return this instanceof o?o.superclass.prototype.constructor.apply(this,arguments):t.getInstance(o,arguments)});return a(o,n),t.extend(o,e),t.extend(o,i),o.superclass=e,o},r=function(t,e){return e.prototype=i(t.prototype),e.prototype.constructor=e,e},a=function(t,e){for(var n in e)if(e[n]instanceof Function&&"callSuper"!==n&&"callParent"!==n){var i=s(n,t,e[n]);t.prototype[n]=i}else t.prototype[n]=e[n]},s=function(t,n,i){var o,r=e.wrapper(i,function(){o=this.__caller,this.__caller=r},function(){void 0===o?delete this.__caller:this.__caller=o});return r.__name=t,r.__owner=n,r},u=o(function(){this.init.apply(this,arguments)},{init:function(t){this.lang=t&&t.lang||this.lang},callParent:function(t){var e=Array.prototype.slice.call(arguments);return this.__caller.__owner.superclass.prototype[e.shift(0)].apply(this,e)},callSuper:function(){return this.__caller.__owner.superclass.prototype[this.__caller.__name].apply(this,arguments)},before:function(t,n){return e.before(this,t,s(t,this.constructor,function(){return n.apply(this,arguments)})),this},after:function(t,n){return e.after(this,t,s(t,this.constructor,function(){return n.apply(this,arguments)})),this}},{createClass:function(t,e){return o.apply(this,Array.prototype.concat.apply([this],arguments))},implement:function(t){return a(this,t),this},plugin:function(t,e){return t instanceof Function&&t.apply(this,e),this}}).plugin(n),c={Parent:u,createClass:o};return c}),define("common/lang/oo-event",["./aop"],function(t){"use strict";var e={getEventproxy:function(){return $(this)},bind:function(t,e){var n=this.getEventproxy();return n.bind.apply(n,arguments),this},unbind:function(t,e){var n=this.getEventproxy();return n.unbind.apply(n,arguments),this},on:function(){return this.bind.apply(this,arguments)},off:function(){return this.unbind.apply(this,arguments)},one:function(e,n){var i=arguments[1]=t.before(arguments[1],function(){this.unbind(e,i)});return this.bind.apply(this,arguments),this},trigger:function(t,e){var n=this.getEventproxy();return n.trigger.apply(n,arguments),this}};return e}),define("common/lang/i18n",[],function(){"use strict";var t={lang:"zh",i18n:function(t){return this.callStatic("getI18n",[this.lang,t])}},e={i18n_key:"i18n",lang:"zh",i18n:function(t,e){1===arguments.length&&(e=t,t=this.lang);var n=this.getStatic(this._i18n_key)||{};return n[t]=e,this.setStatic(this._i18n_key,n),this},getI18n:function(t,e){var n=(this.getStatic(this._i18n_key)||{})[t];return e?n[e]:n}};return function(){this.implement(t),this.setStatic(e)}}),define("common/widget/widget",["../lang/oo","../lang/oo-event","../lang/i18n"],function(t,e,n){return t.createClass({$el:null,_event_alias:"__widget",init:function(t){this.callSuper.apply(this,arguments),this.setAttrs(t||{}),this.delegateEvents(this.events),this.delegateEvents(t.events)},setAttrs:function(t,e){1===arguments.length&&(e=t,t=this.getStatic("ATTRS")),this._setAttrs(t,e)},_setAttrs:function(t,e){$.each(t,this.proxy(function(t,n){this.setAttr(t,e[t])}))},setAttr:function(t,e){e="undefined"==typeof e?this.getStatic("ATTRS")[t]:e,e="$"===t.charAt(0)?$(e):e,this[t]=e},$:function(t){return t?$(t,this.$el):this.$el},delegateEvents:function(t){return t&&$.each(t,$.proxy(function(t,e){this.delegateEvent.apply(this,e)},this)),this},delegateEvent:function(t,e,n){return t&&e&&(e="string"==typeof e&&$.isFunction(this[e])?$.proxy(this[e],this):$.proxy(e,this),this.$el.on(t+"."+this._event_alias,$.isFunction(n)?n.call(this):n,e)),this},undelegateEvents:function(){this.$el.off("."+this._event_alias)},proxy:function(t){return Array.prototype.splice.call(arguments,1,0,this),$.proxy.apply($,arguments)},destroy:function(){this.undelegateEvents();for(var t in this)if(this.hasOwnProperty(t)){if(this[t]&&$.isFunction(this[t].destroy))try{this[t].destroy()}catch(e){}delete this[t]}}},{ATTRS:{$el:document.body}}).implement(e).plugin(n)}),define("common/widget/userbehavior/config",[],function(){var t=['<span class="poiRedPoint" id="poiRedPoint"></span>','<div class="poiLikeTip" id="poiLikeTip">','<span class="close"></span>','<a href="javscript:void(0)" class="neverShow">不再提示</a>','<p class="text fontYaHei t1"><em>点击想去</em>，心爱的目的地不再错过！</p>','<p class="text fontYaHei t2">旅途中穷游app还可同步查看！</p>',"</div>",'<div class="poiLikeSmallTip" id="poiLikeSmallTip">',"收藏至“我的想去”，随时查看最新信息","</div>"].join(""),e={addPoiComment:{text:"点评旅行地",link:"javascript:void(0)",classname:"js-poiComment","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-addcomment"}},addMguide:{text:"添加微锦囊",link:"http://place.qyer.com/mguide/add","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-addmguide"}},addTripNote:{text:"写游记",link:function(t){return"http://bbs.qyer.com/thread-new?type=1&fid="+__GLOBAL_DATA__.fid},"data-bn-ipg":function(t){return"place-"+t.type+"-footprint-post"}},canelFootprint:{text:"取消足迹",link:"javascript:void(0)",classname:"js-cancelFootprint","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-cancel"}}},n=function(t,e,n,i){return'<li><a data-bn-ipg="'+i+'" class="'+n+'" href="'+e+'">'+t+"</a></li>"},i=function(t,e){switch(typeof t){case"string":return t;case"function":return t(e);case"undefined":return""}},o={country:["planto","beento","lived"],city:["planto","beento","lived"],poi:["planto","beento","addToPlan"],outerClass:"place-userbehavior",beDoneClass:"selected",planto:{classname:["planto","fontYaHei","plcZIndex"].join(" "),text:"想去",sText:"已想去",exStr:t,"data-bn-ipg":function(t){switch(t.status){case 1:return"place-"+t.type+"-footprint-wishto-add";case 0:return"place-"+t.type+"-footprint-wishto-delete"}}},beento:{classname:["beento","fontYaHei"].join(" "),text:"去过",sText:"已去过",exStr:function(t){"undefined"!=typeof __GLOBAL_DATA__&&"undefined"!=typeof __GLOBAL_DATA__.fid||delete e.addTripNote;var o="<ul>";return $.each(e,function(e,r){o+=n(r.text,i(r.link,t),r.classname,i(r["data-bn-ipg"],t))}),o+="</ul>"},"data-bn-ipg":function(t){return"place-"+t.type+"-top-beenTo"}},lived:{classname:["lived","fontYaHei"].join(" "),text:"生活过",sText:"已生活过","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-lived"}},addToPlan:{classname:["addToPlan","fontYaHei"].join(" "),text:"加入行程",sText:"加入行程",special:!0,getDom:function(t){return'<li class="'+o[t].classname+'" data-type="'+o.type+'" data-addtoplan="true" data-pid="'+o.id+'"><span class="fonts">'+o[t].text+"</span></li>"},"data-bn-ipg":function(){return"place-poi-top-addtoplan"}},getDom:function(t,e,n){o.type=t,o.id=e;var i="undefined"!=typeof n,r={};return r.inner=o[t],r.isLogin=i,n&&(r.userinfo=n),o.createDom(r)},createDom:function(t){var e="",n=t.isLogin,r={type:o.type,id:o.id};return $.each(t.inner,function(a,s){if(o[s].special)e+=o[s].getDom(s);else{var u=n?t.userinfo[s]-0:0;r.status=u,e+='<li class="'+o[s].classname+(n&&u?" selected":"")+'" data-type="'+s+'" data-status="'+(n?u:0)+'" data-bn-ipg="'+i(o[s]["data-bn-ipg"],r)+'"><span class="fonts">'+o[s][n&&u?"sText":"text"]+"</span>"+i(o[s].exStr,r)+"</li>"}}),'<ul class="'+o.outerClass+'">'+e+"</ul>"}};return o}),define("common/service/service",[],function(){return{post:function(t,e,n,i){return qyerUtil.doAjax({url:t,type:"POST",data:e,onSuccess:n,onError:i})},get:function(t,e,n,i){return qyerUtil.doAjax({url:t,type:"GET",data:e,onSuccess:n,onError:i})}}}),define("common/service/userbehavior/urls",[],function(){return{getBehaviorInfo:"http://common1.qyerstatic.com/public.php?action=getfeeling",feeling:"http://common1.qyerstatic.com/public.php?action=feeling"}}),define("common/service/userbehavior/userbehavior-service",["../service","./urls"],function(t,e){"use strict";var n={getBehaviorInfo:function(n,i,o){t.get(e.getBehaviorInfo,n,i,o)},feeling:function(n,i,o){t.post(e.feeling,n,i,o)}};return n}),define("common/widget/userbehavior/liketip",[],function(){function t(t){$.extend(this,t||{$poiRedPoint:$("#poiRedPoint"),$poiLikeTip:$("#poiLikeTip"),$poiLikeSmallTip:$("#poiLikeSmallTip"),$like:$("#poiRedPoint").parent(),$been:$("#poiRedPoint").parents("ul").find(".beento")}),this.init(),window.likeTipHanlder=this}return t.prototype={init:function(){var t=this;if(window.qyerUtil.isLogin()){if(t.checkIsLike()||t.checkIsBeenTo()||t.checkIsLived())return t.hideDom(t.$poiRedPoint),t.hideDom(t.$poiLikeTip),t.hideDom(t.$poiLikeSmallTip),!1;t.showDom(t.$poiRedPoint)}else t.showDom(t.$poiRedPoint);t.hideDom(t.$poiLikeTip),t.hideDom(t.$poiLikeSmallTip),t.checkCookie("_isNeverShowBigTip")?t.hoverShowDom(t.$poiLikeSmallTip):t.checkCookie("_isShowBigTip")>=3&&t.hoverShowDom(t.$poiLikeSmallTip),t.bindEvent()},bindEvent:function(){var t=this;t.$poiLikeTip.find(".close").on("click",function(e){if(t.checkCookie("_isShowBigTip")){var n=new Date;n.setTime(n.getTime()+31104e6),t.setCookie("_isNeverShowBigTip=true;expires="+n.toGMTString()+";path=/")}else t.setCookie("_isShowBigTip=1");return t.hideDom(t.$poiLikeTip),e.stopPropagation(),!1}).addBack().find(".neverShow").on("click",function(e){var n=t.checkCookie("_isShowBigTip")-0+1,i=new Date;return i.setTime(i.getTime()+31104e6),t.setCookie("_isNeverShowBigTip="+n+";expires="+i.toGMTString()+";path=/"),t.hideDom(t.$poiLikeTip),e.stopPropagation(),!1}),t.$like.on("mouseenter",function(){t.checkCookie("_isNeverShowBigTip")||t.checkCookie("_isShowBigTip")>=3||t.checkIsBeenTo()||t.checkIsLike()||t.checkIsLived()||t.showDom(t.$poiLikeTip)})},hideDom:function(t){t.removeClass("poiLikeHoverShow poiLikeShow")},showDom:function(t){t.addClass("poiLikeShow")},hoverShowDom:function(t){t.addClass("poiLikeHoverShow")},checkIsLike:function(){return this.$like.hasClass("selected")},checkIsBeenTo:function(){return this.$been.hasClass("selected")},checkIsLived:function(){return $(".place-userbehavior").length>0&&($(".place-userbehavior").find(".lived").length>0&&$(".place-userbehavior").find(".lived").hasClass("selected"))},setCookie:function(t){document.cookie=t},checkCookie:function(t){for(var e=this.getCookie(),n=e.split(";"),i=0,o=n.length,r=!1;i<o;i++)if($.trim(t)==$.trim(n[i]).split("=")[0]){r=$.trim(n[i]).split("=")[1];break}return r},getCookie:function(){return document.cookie},closeAll:function(){var t=this;t.hideDom(t.$poiRedPoint),t.hideDom(t.$poiLikeTip),t.hideDom(t.$poiLikeSmallTip)}},t}),define("project/js/batch_add_footprint",[],function(){function t(t,e,n,i){var o="";"city"==e||"area"==e?requirejs(["common/component/footprint/js/footprint"],function(e){e.poiShow({city_id:t,show_type:"poi"})}):"poi"==e?qyerUI.popup.ajax({url:"/api.php?action=addpoicomment&from=poi&source_type=11&poiid="+t+"&typeid="+PLACE.CITYID+"&type=city",width:"690",isclose:"show"}):"country"==e&&requirejs(["common/component/footprint/js/footprint"],function(e){e.countryFpShow({country_id:t,show_type:"country"})}),""==o}return t}),define("common/basic/js/normalize",[],function(){function t(t,i,o){if(t.match(s)||t.match(a))return t;t=r(t);var u=o.match(a),c=i.match(a);return!c||u&&u[1]==c[1]&&u[2]==c[2]?n(e(t,i),o):e(t,i)}function e(t,e){if("./"==t.substr(0,2)&&(t=t.substr(2)),t.match(s)||t.match(a))return t;var n=e.split("/"),i=t.split("/");for(n.pop();curPart=i.shift();)".."==curPart?n.pop():n.push(curPart);return n.join("/")}function n(t,e){var n=e.split("/");for(n.pop(),e=n.join("/")+"/",i=0;e.substr(i,1)==t.substr(i,1);)i++;for(;"/"!=e.substr(i,1);)i--;e=e.substr(i+1),t=t.substr(i+1),n=e.split("/");var o=t.split("/");for(out="";n.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var o=/([^:])\/+/g,r=function(t){return t.replace(o,"$1/")},a=/[^\:\/]*:\/\/([^\/])*/,s=/^(\/|data:)/,u=function(e,n,i){n=r(n),i=r(i);for(var o,a,e,s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=s.exec(e);){a=o[3]||o[2]||o[5]||o[6]||o[4];var u;u=t(a,n,i);var c=o[5]||o[6]?1:0;e=e.substr(0,s.lastIndex-a.length-c-1)+u+e.substr(s.lastIndex-c-1),s.lastIndex=s.lastIndex+(u.length-a.length)}return e};return u.convertURIBase=t,u.absoluteURI=e,u.relativeURI=n,u}),define("common/basic/js/require-css",[],function(){if("undefined"==typeof window)return{load:function(t,e,n){n()}};var t=document.getElementsByTagName("head")[0],e=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,n=!1,i=!0;e[1]||e[7]?n=parseInt(e[1])<6||parseInt(e[7])<=9:e[2]||e[8]?i=!1:e[4]&&(n=parseInt(e[4])<18);var o={};o.pluginBuilder="./css-builder";var r,a,s,u=function(){r=document.createElement("style"),t.appendChild(r),a=r.styleSheet||r.sheet},c=0,l=[],p=function(t){a.addImport(t),r.onload=function(){d()},c++,31==c&&(u(),c=0)},d=function(){s();var t=l.shift();return t?(s=t[1],void p(t[0])):void(s=null)},f=function(t,e){if(a&&a.addImport||u(),a&&a.addImport)s?l.push([t,e]):(p(t),s=e);else{r.textContent='@import "'+t+'";';var n=setInterval(function(){try{r.sheet.cssRules,clearInterval(n),e()}catch(t){}},10)}},h=function(e,n){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",i)o.onload=function(){o.onload=function(){},setTimeout(n,7)};else var r=setInterval(function(){for(var t=0;t<document.styleSheets.length;t++){var e=document.styleSheets[t];if(e.href==o.href)return clearInterval(r),n()}},10);o.href=e,t.appendChild(o)};return o.normalize=function(t,e){return".css"==t.substr(t.length-4,4)&&(t=t.substr(0,t.length-4)),e(t)},o.load=function(t,e,i,o){(n?f:h)(e.toUrl(t+".css"),i)},o}),define("common/basic/js/require-css!common/ui/popup/popup",[],function(){}),define("common/ui/popup/popup",["css!common/ui/popup/popup.css"/*tpa=http://common1.qyerstatic.com/place/js/common/css!common/ui/popup/popup.css*/],function(){var t=jQuery,e={$ui:null,$content:null,$box:null,$title:null,$okBtn:null,$cancelBtn:null,$loadBtn:null,$closeIcon:null,_uiState:"normal",defaultWidth:400,init:function(){var e=['<div class="qui-popup" style="display:none">',"<div>",'<div class="qui-popup-dt">','<div class="qui-popup-box">','<div class="qui-popup-closeIcon">&nbsp;</div>','<div class="qui-popup-box-title fontYaHei">title</div>','<div class="qui-popup-box-content">',"</div>",'<div class="qui-popup-box-bottom">',"&nbsp;",'<input class="qui-popup-cancelBtn ui_button_cancel" type="button" value="取消" />  ','<input class="qui-popup-okBtn ui_button" type="button" value="确定" />  ','<input class="qui-popup-loadingBtn  ui_button_load" type="button" value="" />  ',"</div>","</div>","</div>","</div>","</div>"].join("");this.$ui=t(e),this.$content=this.$ui.find(".qui-popup-box-content"),this.$box=this.$ui.find(".qui-popup-box"),this.$title=this.$ui.find(".qui-popup-box-title"),this.$okBtn=this.$ui.find(".qui-popup-okBtn"),this.$cancelBtn=this.$ui.find(".qui-popup-cancelBtn"),this.$loadBtn=this.$ui.find(".qui-popup-loadingBtn"),this.$closeIcon=this.$ui.find(".qui-popup-closeIcon"),this.$ui.appendTo(document.body)},setWidth:function(t){this.$box.animate({width:t},300)},setUIDefault:function(t){this.$ui[0].className="qui-popup",t.exClassName&&this.$ui.addClass(t.exClassName),t.iframeSrc?this.$content.html('<iframe src="'+t.iframeSrc+'"  scrolling="auto" style="height:'+(t.iframeHeight||300)+'px;"  />'):this.$content.html(t.contentHTML||"&nbsp;"),this.$title.html(t.title||"Title"),this.$box.css("width",t.width||this.defaultWidth),this.$title[t.showTitle===!1?"hide":"show"](),this.$okBtn.val(t.okText||"确定"),this.$cancelBtn.val(t.cancelText||"取消"),this.$okBtn[t.showOKBtn===!1?"hide":"show"](),this.$okBtn.removeAttr("data-bn-ipg"),this.$cancelBtn[t.showCancelBtn===!1?"hide":"show"](),this.$cancelBtn.removeAttr("data-bn-ipg"),this.$loadBtn[t.showLoadBtn===!0?"show":"hide"](),this.$loadBtn.removeAttr("data-bn-ipg"),this.$ui.find(".qui-popup-closeIcon").removeAttr("data-bn-ipg"),this.$closeIcon[t.showCloseIcon===!1?"hide":"show"]()},show:function(n){if("hideing"==e._uiState)e.$box.stop(),e.$ui.stop(),this.$ui.css({display:"block",opacity:1}),this.$box.css({top:0,opacity:1}),e._uiState="normal",n.onShow&&n.onShow();else{e._uiState="showing";var i={},o={top:0};t.support.leadingWhitespace&&(i.opacity=1,o.opacity=1),this.$ui.css("display","block").animate(i,200,function(){e.$box.css("top",-30).animate(o,200,function(){e._uiState="normal",n.onShow&&n.onShow()})})}},hide:function(n){if(!n||!n.onBeforeHide||n.onBeforeHide()!==!1){e._uiState="hideing";var i={top:-30},o={};t.support.leadingWhitespace&&(i.opacity=0,o.opacity=0),this.$box.animate(i,200,function(){e.$ui.animate(o,200,function(){e._uiState="normal",e.$ui.css("display","none"),e.$content.html(""),n&&n.onAfterHide&&n.onAfterHide()})})}}};e.init();var n=null,i={show:function(t){return n=t,e.setUIDefault(t),e.$ui.undelegate("click").delegate(".qui-popup-okBtn,.qui-popup-cancelBtn,.qui-popup-closeIcon","click",function(n){if(this.className.indexOf("qui-popup-closeIcon")!=-1||this.className.indexOf("qui-popup-cancelBtn")!=-1){if(t.onBeforeCancel&&!t.onBeforeCancel(n))return;t.onCancel&&t.onCancel()}else if(this.className.indexOf("qui-popup-okBtn")!=-1&&t.onOK&&t.onOK()===!1)return;e.hide(t)}),e.show(t),this},hide:function(t){return e.hide(t),this},setContent:function(t){return e.$content.html(t),this},getContent:function(){return e.$content[0]},getButtons:function(){return{okBtn:e.$okBtn[0],cancelBtn:e.$cancelBtn[0],loadBtn:e.$loadBtn[0],closeIcon:e.$ui.find(".qui-popup-closeIcon")[0]}},setOption:function(i){var o={width:function(){e.setWidth(i.width)},showTitle:function(){i.showTitle===!1?e.$title.hide():e.$title.show()},okText:function(){e.$okBtn.val(i.okText)},cancelText:function(){e.$cancelBtn.val(i.cancelText)},showOKBtn:function(){i.showOKBtn===!1?e.$okBtn.hide():e.$okBtn.show()},showCancelBtn:function(){i.showCancelBtn===!1?e.$cancelBtn.hide():e.$cancelBtn.show()},showLoadBtn:function(){i.showLoadBtn===!1?e.$loadBtn.hide():e.$loadBtn.show()},showCloseIcon:function(){i.showCloseIcon===!1?e.$closeIcon.hide():e.$closeIcon.show()},title:function(){e.$title.html(i.title)},exClassName:function(){e.$ui[0].className="qui-popup "+i.exClassName},contentHTML:function(){i.iframeSrc||e.$content.html(i.contentHTML)},iframeSrc:function(){e.$content.html('<iframe src="'+i.iframeSrc+'"  scrolling="auto" style="height:'+(i.iframeHeight||300)+'px;" />')},iframeHeight:function(){e.$content.children("iframe").css("height",i.iframeHeight)}};for(var r in i)n[r]=i[r],"function"==t.type(o[r])&&o[r]()}};return i}),!function(t,e){"use strict";function n(t,e){for(var n,i=[],r=0;r<t.length;++r){if(n=a[t[r]]||o(t[r]),!n)throw"module definition dependecy not found: "+t[r];i.push(n)}e.apply(null,i)}function i(t,i,o){if("string"!=typeof t)throw"invalid module definition, module id must be defined and be a string";if(i===e)throw"invalid module definition, dependencies must be specified";if(o===e)throw"invalid module definition, definition function must be specified";n(i,function(){a[t]=o.apply(null,arguments)})}function o(e){for(var n=t,i=e.split(/[.\/]/),o=0;o<i.length;++o){if(!n[i[o]])return;n=n[i[o]]}return n}function r(n){for(var i=0;i<n.length;i++){for(var o=t,r=n[i],s=r.split(/[.\/]/),u=0;u<s.length-1;++u)o[s[u]]===e&&(o[s[u]]={}),o=o[s[u]];o[s[s.length-1]]=a[r]}}var a={},s="moxie/core/utils/Basic",u="moxie/core/I18n",c="moxie/core/utils/Mime",l="moxie/core/utils/Env",p="moxie/core/utils/Dom",d="moxie/core/Exceptions",f="moxie/core/EventTarget",h="moxie/core/utils/Encode",m="moxie/runtime/Runtime",g="moxie/runtime/RuntimeClient",v="moxie/file/Blob",y="moxie/file/File",_="moxie/file/FileInput",b="moxie/file/FileDrop",x="moxie/runtime/RuntimeTarget",w="moxie/file/FileReader",j="moxie/core/utils/Url",k="moxie/file/FileReaderSync",E="moxie/xhr/FormData",C="moxie/xhr/XMLHttpRequest",T="moxie/runtime/Transporter",S="moxie/image/Image",A="moxie/runtime/html5/Runtime",$="moxie/runtime/html5/file/Blob",R="moxie/core/utils/Events",O="moxie/runtime/html5/file/FileInput",I="moxie/runtime/html5/file/FileDrop",q="moxie/runtime/html5/file/FileReader",D="moxie/runtime/html5/xhr/XMLHttpRequest",L="moxie/runtime/html5/utils/BinaryReader",P="moxie/runtime/html5/image/JPEGHeaders",N="moxie/runtime/html5/image/ExifParser",U="moxie/runtime/html5/image/JPEG",M="moxie/runtime/html5/image/PNG",F="moxie/runtime/html5/image/ImageInfo",z="moxie/runtime/html5/image/MegaPixel",B="moxie/runtime/html5/image/Image",H="moxie/runtime/flash/Runtime",Q="moxie/runtime/flash/file/Blob",G="moxie/runtime/flash/file/FileInput",X="moxie/runtime/flash/file/FileReader",Y="moxie/runtime/flash/file/FileReaderSync",V="moxie/runtime/flash/xhr/XMLHttpRequest",J="moxie/runtime/flash/runtime/Transporter",W="moxie/runtime/flash/image/Image",K="moxie/runtime/silverlight/Runtime",Z="moxie/runtime/silverlight/file/Blob",tt="moxie/runtime/silverlight/file/FileInput",et="moxie/runtime/silverlight/file/FileDrop",nt="moxie/runtime/silverlight/file/FileReader",it="moxie/runtime/silverlight/file/FileReaderSync",ot="moxie/runtime/silverlight/xhr/XMLHttpRequest",rt="moxie/runtime/silverlight/runtime/Transporter",at="moxie/runtime/silverlight/image/Image",st="moxie/runtime/html4/Runtime",ut="moxie/runtime/html4/file/FileInput",ct="moxie/runtime/html4/file/FileReader",lt="moxie/runtime/html4/xhr/XMLHttpRequest",pt="moxie/runtime/html4/image/Image";i(s,[],function(){var t=function(t){var e;return t===e?"undefined":null===t?"null":t.nodeType?"node":{}.toString.call(t).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},e=function(i){var o;return n(arguments,function(r,s){s>0&&n(r,function(n,r){n!==o&&(t(i[r])===t(n)&&~a(t(n),["array","object"])?e(i[r],n):i[r]=n)})}),i},n=function(t,e){var n,i,o,r;if(t){try{n=t.length}catch(a){n=r}if(n===r){for(i in t)if(t.hasOwnProperty(i)&&e(t[i],i)===!1)return}else for(o=0;n>o;o++)if(e(t[o],o)===!1)return}},i=function(e){var n;if(!e||"object"!==t(e))return!0;for(n in e)return!1;return!0},o=function(e,n){function i(o){"function"===t(e[o])&&e[o](function(t){++o<r&&!t?i(o):n(t)})}var o=0,r=e.length;"function"!==t(n)&&(n=function(){}),e&&e.length||n(),i(o)},r=function(t,e){var i=0,o=t.length,r=new Array(o);n(t,function(t,n){t(function(t){if(t)return e(t);var a=[].slice.call(arguments);a.shift(),r[n]=a,i++,i===o&&(r.unshift(null),e.apply(this,r))})})},a=function(t,e){if(e){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n}return-1},s=function(e,n){var i=[];"array"!==t(e)&&(e=[e]),"array"!==t(n)&&(n=[n]);for(var o in e)-1===a(e[o],n)&&i.push(e[o]);return!!i.length&&i},u=function(t,e){var i=[];return n(t,function(t){-1!==a(t,e)&&i.push(t)}),i.length?i:null},c=function(t){var e,n=[];for(e=0;e<t.length;e++)n[e]=t[e];return n},l=function(){var t=0;return function(e){var n,i=(new Date).getTime().toString(32);for(n=0;5>n;n++)i+=Math.floor(65535*Math.random()).toString(32);return(e||"o_")+i+(t++).toString(32)}}(),p=function(t){return t?String.prototype.trim?String.prototype.trim.call(t):t.toString().replace(/^\s*/,"").replace(/\s*$/,""):t},d=function(t){if("string"!=typeof t)return t;var e,n={t:1099511627776,g:1073741824,m:1048576,k:1024};return t=/^([0-9]+)([mgk]?)$/.exec(t.toLowerCase().replace(/[^0-9mkg]/g,"")),e=t[2],t=+t[1],n.hasOwnProperty(e)&&(t*=n[e]),t};return{guid:l,typeOf:t,extend:e,each:n,isEmptyObj:i,inSeries:o,inParallel:r,inArray:a,arrayDiff:s,arrayIntersect:u,toArray:c,trim:p,parseSizeStr:d}}),i(u,[s],function(t){var e={};return{addI18n:function(n){return t.extend(e,n)},translate:function(t){return e[t]||t},_:function(t){return this.translate(t)},sprintf:function(e){var n=[].slice.call(arguments,1);return e.replace(/%[a-z]/g,function(){var e=n.shift();return"undefined"!==t.typeOf(e)?e:""})}}}),i(c,[s,u],function(t,e){var n="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",i={mimes:{},extensions:{},addMimeType:function(t){var e,n,i,o=t.split(/,/);for(e=0;e<o.length;e+=2){for(i=o[e+1].split(/ /),n=0;n<i.length;n++)this.mimes[i[n]]=o[e];this.extensions[o[e]]=i}},extList2mimes:function(e,n){var i,o,r,a,s=this,u=[];for(o=0;o<e.length;o++)for(i=e[o].extensions.split(/\s*,\s*/),r=0;r<i.length;r++){if("*"===i[r])return[];if(a=s.mimes[i[r]])-1===t.inArray(a,u)&&u.push(a);else{if(!n||!/^\w+$/.test(i[r]))return[];u.push("."+i[r])}}return u},mimes2exts:function(e){var n=this,i=[];return t.each(e,function(e){if("*"===e)return i=[],!1;var o=e.match(/^(\w+)\/(\*|\w+)$/);o&&("*"===o[2]?t.each(n.extensions,function(t,e){new RegExp("^"+o[1]+"/").test(e)&&[].push.apply(i,n.extensions[e])}):n.extensions[e]&&[].push.apply(i,n.extensions[e]))}),i},mimes2extList:function(n){var i=[],o=[];return"string"===t.typeOf(n)&&(n=t.trim(n).split(/\s*,\s*/)),o=this.mimes2exts(n),i.push({title:e.translate("Files"),extensions:o.length?o.join(","):"*"}),i.mimes=n,i},getFileExtension:function(t){var e=t&&t.match(/\.([^.]+)$/);return e?e[1].toLowerCase():""},getFileMime:function(t){return this.mimes[this.getFileExtension(t)]||""}};return i.addMimeType(n),i}),i(l,[s],function(t){function e(t,e,n){var i=0,o=0,r=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(t){return t=(""+t).replace(/[_\-+]/g,"."),t=t.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),t.length?t.split("."):[-8]},u=function(t){return t?isNaN(t)?a[t]||-7:parseInt(t,10):0};for(t=s(t),e=s(e),o=Math.max(t.length,e.length),i=0;o>i;i++)if(t[i]!=e[i]){if(t[i]=u(t[i]),e[i]=u(e[i]),t[i]<e[i]){r=-1;break}if(t[i]>e[i]){r=1;break}}if(!n)return r;switch(n){case">":case"gt":return r>0;case">=":case"ge":return r>=0;case"<=":case"le":return 0>=r;case"==":case"=":case"eq":return 0===r;case"<>":case"!=":case"ne":return 0!==r;
case"":case"<":case"lt":return 0>r;default:return null}}var n=function(t){var e="",n="?",i="function",o="undefined",r="object",a="major",s="name",u="version",c={has:function(t,e){return-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()}},l={rgx:function(){for(var e,n,a,s,u,c,l,p=0,d=arguments;p<d.length;p+=2){var f=d[p],h=d[p+1];if(typeof e===o){e={};for(s in h)u=h[s],typeof u===r?e[u[0]]=t:e[u]=t}for(n=a=0;n<f.length;n++)if(c=f[n].exec(this.getUA())){for(s=0;s<h.length;s++)l=c[++a],u=h[s],typeof u===r&&u.length>0?2==u.length?e[u[0]]=typeof u[1]==i?u[1].call(this,l):u[1]:3==u.length?e[u[0]]=typeof u[1]!==i||u[1].exec&&u[1].test?l?l.replace(u[1],u[2]):t:l?u[1].call(this,l,u[2]):t:4==u.length&&(e[u[0]]=l?u[3].call(this,l.replace(u[1],u[2])):t):e[u]=l?l:t;break}if(c)break}return e},str:function(e,i){for(var o in i)if(typeof i[o]===r&&i[o].length>0){for(var a=0;a<i[o].length;a++)if(c.has(i[o][a],e))return o===n?t:o}else if(c.has(i[o],e))return o===n?t:o;return e}},p={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"http://common1.qyerstatic.com/place/js/common/4.90","http://common1.qyerstatic.com/place/js/common/NT 3.11":"http://common1.qyerstatic.com/place/js/common/NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},d={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[s,u,a],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[s,"Opera"],u,a],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[s,u,a],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[s,"IE"],u,a],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[s,"Yandex"],u,a],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[s,/_/g," "],u,a],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[s,u,a],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[s,"Dolphin"],u,a],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[s,"Chrome"],u,a],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[s,"Android Browser"],u,a],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[u,a,[s,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[u,a,s],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[s,[a,l.str,p.browser.oldsafari.major],[u,l.str,p.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[s,u,a],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[s,"Netscape"],u,a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[s,u,a]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,u],[/rv\:([\w\.]+).*(gecko)/i],[u,s]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[u,l.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[u,l.str,p.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[s,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],u],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],u],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],u],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,u],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[u,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[s,[u,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[s,u]]},f=function(t){var n=t||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:e);this.getBrowser=function(){return l.rgx.apply(this,d.browser)},this.getEngine=function(){return l.rgx.apply(this,d.engine)},this.getOS=function(){return l.rgx.apply(this,d.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return n},this.setUA=function(t){return n=t,this},this.setUA(n)};return(new f).getResult()}(),i=function(){var e={define_property:function(){return!1}(),create_canvas:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}(),return_response_type:function(e){try{if(-1!==t.inArray(e,["","text","document"]))return!0;if(window.XMLHttpRequest){var n=new XMLHttpRequest;if(n.open("get","/"),"responseType"in n)return n.responseType=e,n.responseType===e}}catch(i){}return!1},use_data_uri:function(){var t=new Image;return t.onload=function(){e.use_data_uri=1===t.width&&1===t.height},setTimeout(function(){t.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return e.use_data_uri&&("IE"!==o.browser||o.version>=9)},use_data_uri_of:function(t){return e.use_data_uri&&33e3>t||e.use_data_uri_over32kb()},use_fileinput:function(){var t=document.createElement("input");return t.setAttribute("type","file"),!t.disabled}};return function(n){var i=[].slice.call(arguments);return i.shift(),"function"===t.typeOf(e[n])?e[n].apply(this,i):!!e[n]}}(),o={can:i,browser:n.browser.name,version:parseFloat(n.browser.major),os:n.os.name,osVersion:n.os.version,verComp:e,swf_url:"../flash/Moxie.swf"/*tpa=http://common1.qyerstatic.com/place/js/flash/Moxie.swf*/,xap_url:"http://common1.qyerstatic.com/place/js/silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return o.OS=o.os,o}),i(p,[l],function(t){var e=function(t){return"string"!=typeof t?t:document.getElementById(t)},n=function(t,e){if(!t.className)return!1;var n=new RegExp("(^|\\s+)"+e+"(\\s+|$)");return n.test(t.className)},i=function(t,e){n(t,e)||(t.className=t.className?t.className.replace(/\s+$/,"")+" "+e:e)},o=function(t,e){if(t.className){var n=new RegExp("(^|\\s+)"+e+"(\\s+|$)");t.className=t.className.replace(n,function(t,e,n){return" "===e&&" "===n?" ":""})}},r=function(t,e){return t.currentStyle?t.currentStyle[e]:window.getComputedStyle?window.getComputedStyle(t,null)[e]:void 0},a=function(e,n){function i(t){var e,n,i=0,o=0;return t&&(n=t.getBoundingClientRect(),e="CSS1Compat"===c.compatMode?c.documentElement:c.body,i=n.left+e.scrollLeft,o=n.top+e.scrollTop),{x:i,y:o}}var o,r,a,s=0,u=0,c=document;if(e=e,n=n||c.body,e&&e.getBoundingClientRect&&"IE"===t.browser&&(!c.documentMode||c.documentMode<8))return r=i(e),a=i(n),{x:r.x-a.x,y:r.y-a.y};for(o=e;o&&o!=n&&o.nodeType;)s+=o.offsetLeft||0,u+=o.offsetTop||0,o=o.offsetParent;for(o=e.parentNode;o&&o!=n&&o.nodeType;)s-=o.scrollLeft||0,u-=o.scrollTop||0,o=o.parentNode;return{x:s,y:u}},s=function(t){return{w:t.offsetWidth||t.clientWidth,h:t.offsetHeight||t.clientHeight}};return{get:e,hasClass:n,addClass:i,removeClass:o,getStyle:r,getPos:a,getSize:s}}),i(d,[s],function(t){function e(t,e){var n;for(n in t)if(t[n]===e)return n;return null}return{RuntimeError:function(){function n(t){this.code=t,this.name=e(i,t),this.message=this.name+": RuntimeError "+this.code}var i={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return t.extend(n,i),n.prototype=Error.prototype,n}(),OperationNotAllowedException:function(){function e(t){this.code=t,this.name="OperationNotAllowedException"}return t.extend(e,{NOT_ALLOWED_ERR:1}),e.prototype=Error.prototype,e}(),ImageError:function(){function n(t){this.code=t,this.name=e(i,t),this.message=this.name+": ImageError "+this.code}var i={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return t.extend(n,i),n.prototype=Error.prototype,n}(),FileException:function(){function n(t){this.code=t,this.name=e(i,t),this.message=this.name+": FileException "+this.code}var i={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return t.extend(n,i),n.prototype=Error.prototype,n}(),DOMException:function(){function n(t){this.code=t,this.name=e(i,t),this.message=this.name+": DOMException "+this.code}var i={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return t.extend(n,i),n.prototype=Error.prototype,n}(),EventException:function(){function e(t){this.code=t,this.name="EventException"}return t.extend(e,{UNSPECIFIED_EVENT_TYPE_ERR:0}),e.prototype=Error.prototype,e}()}}),i(f,[d,s],function(t,e){function n(){var n={};e.extend(this,{uid:null,init:function(){this.uid||(this.uid=e.guid("uid_"))},addEventListener:function(t,i,o,r){var a,s=this;return t=e.trim(t),/\s/.test(t)?void e.each(t.split(/\s+/),function(t){s.addEventListener(t,i,o,r)}):(t=t.toLowerCase(),o=parseInt(o,10)||0,a=n[this.uid]&&n[this.uid][t]||[],a.push({fn:i,priority:o,scope:r||this}),n[this.uid]||(n[this.uid]={}),void(n[this.uid][t]=a))},hasEventListener:function(t){return t?!(!n[this.uid]||!n[this.uid][t]):!!n[this.uid]},removeEventListener:function(t,i){t=t.toLowerCase();var o,r=n[this.uid]&&n[this.uid][t];if(r){if(i){for(o=r.length-1;o>=0;o--)if(r[o].fn===i){r.splice(o,1);break}}else r=[];r.length||(delete n[this.uid][t],e.isEmptyObj(n[this.uid])&&delete n[this.uid])}},removeAllEventListeners:function(){n[this.uid]&&delete n[this.uid]},dispatchEvent:function(i){var o,r,a,s,u,c={},l=!0;if("string"!==e.typeOf(i)){if(s=i,"string"!==e.typeOf(s.type))throw new t.EventException(t.EventException.UNSPECIFIED_EVENT_TYPE_ERR);i=s.type,s.total!==u&&s.loaded!==u&&(c.total=s.total,c.loaded=s.loaded),c.async=s.async||!1}if(-1!==i.indexOf("::")?function(t){o=t[0],i=t[1]}(i.split("::")):o=this.uid,i=i.toLowerCase(),r=n[o]&&n[o][i]){r.sort(function(t,e){return e.priority-t.priority}),a=[].slice.call(arguments),a.shift(),c.type=i,a.unshift(c);var p=[];e.each(r,function(t){a[0].target=t.scope,c.async?p.push(function(e){setTimeout(function(){e(t.fn.apply(t.scope,a)===!1)},1)}):p.push(function(e){e(t.fn.apply(t.scope,a)===!1)})}),p.length&&e.inSeries(p,function(t){l=!t})}return l},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(t){var n;"array"!==e.typeOf(t)&&(t=[t]);for(var i=0;i<t.length;i++)n="on"+t[i],"function"===e.typeOf(this[n])?this.addEventListener(t[i],this[n]):"undefined"===e.typeOf(this[n])&&(this[n]=null)}})}return n.instance=new n,n}),i(h,[],function(){var t=function(t){return unescape(encodeURIComponent(t))},e=function(t){return decodeURIComponent(escape(t))},n=function(t,n){if("function"==typeof window.atob)return n?e(window.atob(t)):window.atob(t);var i,o,r,a,s,u,c,l,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,f=0,h="",m=[];if(!t)return t;t+="";do a=p.indexOf(t.charAt(d++)),s=p.indexOf(t.charAt(d++)),u=p.indexOf(t.charAt(d++)),c=p.indexOf(t.charAt(d++)),l=a<<18|s<<12|u<<6|c,i=255&l>>16,o=255&l>>8,r=255&l,m[f++]=64==u?String.fromCharCode(i):64==c?String.fromCharCode(i,o):String.fromCharCode(i,o,r);while(d<t.length);return h=m.join(""),n?e(h):h},i=function(e,n){if(n&&t(e),"function"==typeof window.btoa)return window.btoa(e);var i,o,r,a,s,u,c,l,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,f=0,h="",m=[];if(!e)return e;do i=e.charCodeAt(d++),o=e.charCodeAt(d++),r=e.charCodeAt(d++),l=i<<16|o<<8|r,a=63&l>>18,s=63&l>>12,u=63&l>>6,c=63&l,m[f++]=p.charAt(a)+p.charAt(s)+p.charAt(u)+p.charAt(c);while(d<e.length);h=m.join("");var g=e.length%3;return(g?h.slice(0,g-3):h)+"===".slice(g||3)};return{utf8_encode:t,utf8_decode:e,atob:n,btoa:i}}),i(m,[s,p,f],function(t,e,n){function i(n,o,a,s,u){var c,l=this,p=t.guid(o+"_"),d=u||"browser";n=n||{},r[p]=this,a=t.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},a),n.preferred_caps&&(d=i.getMode(s,n.preferred_caps,d)),c=function(){var e={};return{exec:function(t,n,i,o){return c[n]&&(e[t]||(e[t]={context:this,instance:new c[n]}),e[t].instance[i])?e[t].instance[i].apply(this,o):void 0},removeInstance:function(t){delete e[t]},removeAllInstances:function(){var n=this;t.each(e,function(e,i){"function"===t.typeOf(e.instance.destroy)&&e.instance.destroy.call(e.context),n.removeInstance(i)})}}}(),t.extend(this,{initialized:!1,uid:p,type:o,mode:i.getMode(s,n.required_caps,d),shimid:p+"_container",clients:0,options:n,can:function(e,n){var o=arguments[2]||a;if("string"===t.typeOf(e)&&"undefined"===t.typeOf(n)&&(e=i.parseCaps(e)),"object"===t.typeOf(e)){for(var r in e)if(!this.can(r,e[r],o))return!1;return!0}return"function"===t.typeOf(o[e])?o[e].call(this,n):n===o[e]},getShimContainer:function(){var n,i=e.get(this.shimid);return i||(n=this.options.container?e.get(this.options.container):document.body,i=document.createElement("div"),i.id=this.shimid,i.className="moxie-shim moxie-shim-"+this.type,t.extend(i.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),n.appendChild(i),n=null),i},getShim:function(){return c},shimExec:function(t,e){var n=[].slice.call(arguments,2);return l.getShim().exec.call(this,this.uid,t,e,n)},exec:function(t,e){var n=[].slice.call(arguments,2);return l[t]&&l[t][e]?l[t][e].apply(this,n):l.shimExec.apply(this,arguments)},destroy:function(){if(l){var t=e.get(this.shimid);t&&t.parentNode.removeChild(t),c&&c.removeAllInstances(),this.unbindAll(),delete r[this.uid],this.uid=null,p=l=c=t=null}}}),this.mode&&n.required_caps&&!this.can(n.required_caps)&&(this.mode=!1)}var o={},r={};return i.order="html5,flash,silverlight,html4",i.getRuntime=function(t){return!!r[t]&&r[t]},i.addConstructor=function(t,e){e.prototype=n.instance,o[t]=e},i.getConstructor=function(t){return o[t]||null},i.getInfo=function(t){var e=i.getRuntime(t);return e?{uid:e.uid,type:e.type,mode:e.mode,can:function(){return e.can.apply(e,arguments)}}:null},i.parseCaps=function(e){var n={};return"string"!==t.typeOf(e)?e||{}:(t.each(e.split(","),function(t){n[t]=!0}),n)},i.can=function(t,e){var n,o,r=i.getConstructor(t);return!!r&&(n=new r({required_caps:e}),o=n.mode,n.destroy(),!!o)},i.thatCan=function(t,e){var n=(e||i.order).split(/\s*,\s*/);for(var o in n)if(i.can(n[o],t))return n[o];return null},i.getMode=function(e,n,i){var o=null;if("undefined"===t.typeOf(i)&&(i="browser"),n&&!t.isEmptyObj(e)){if(t.each(n,function(n,i){if(e.hasOwnProperty(i)){var r=e[i](n);if("string"==typeof r&&(r=[r]),o){if(!(o=t.arrayIntersect(o,r)))return o=!1}else o=r}}),o)return-1!==t.inArray(i,o)?i:o[0];if(o===!1)return!1}return i},i.capTrue=function(){return!0},i.capFalse=function(){return!1},i.capTest=function(t){return function(){return!!t}},i}),i(g,[d,s,m],function(t,e,n){return function i(){var i;e.extend(this,{connectRuntime:function(o){function r(e){var a,u;return e.length?(a=e.shift(),(u=n.getConstructor(a))?(i=new u(o),i.bind("Init",function(){i.initialized=!0,setTimeout(function(){i.clients++,s.trigger("RuntimeInit",i)},1)}),i.bind("Error"http://common1.qyerstatic.com/place/js/common/,function(){i.destroy(),r(e)}),i.mode?void i.init():void i.trigger("Error")):void r(e)):(s.trigger("RuntimeError",new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)),void(i=null))}var a,s=this;if("string"===e.typeOf(o)?a=o:"string"===e.typeOf(o.ruid)&&(a=o.ruid),a){if(i=n.getRuntime(a))return i.clients++,i;throw new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)}r((o.runtime_order||n.order).split(/\s*,\s*/))},getRuntime:function(){return i&&i.uid?i:(i=null,null)},disconnectRuntime:function(){i&&--i.clients<=0&&(i.destroy(),i=null)}})}}),i(v,[s,h,g],function(t,e,n){function i(r,a){function s(e,n,r){var a,s=o[this.uid];return"string"===t.typeOf(s)&&s.length?(a=new i(null,{type:r,size:n-e}),a.detach(s.substr(e,a.size)),a):null}n.call(this),r&&this.connectRuntime(r),a?"string"===t.typeOf(a)&&(a={data:a}):a={},t.extend(this,{uid:a.uid||t.guid("uid_"),ruid:r,size:a.size||0,type:a.type||"",slice:function(t,e,n){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,e,n)},getSource:function(){return o[this.uid]?o[this.uid]:null},detach:function(t){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy",o[this.uid]),this.disconnectRuntime(),this.ruid=null),t=t||"";var n=t.match(/^data:([^;]*);base64,/);n&&(this.type=n[1],t=e.atob(t.substring(t.indexOf("base64,")+7))),this.size=t.length,o[this.uid]=t},isDetached:function(){return!this.ruid&&"string"===t.typeOf(o[this.uid])},destroy:function(){this.detach(),delete o[this.uid]}}),a.data?this.detach(a.data):o[this.uid]=a}var o={};return i}),i(y,[s,c,v],function(t,e,n){function i(i,o){var r,a;if(o||(o={}),a=o.type&&""!==o.type?o.type:e.getFileMime(o.name),o.name)r=o.name.replace(/\\/g,"/"),r=r.substr(r.lastIndexOf("/")+1);else{var s=a.split("/")[0];r=t.guid((""!==s?s:"file")+"_"),e.extensions[a]&&(r+="."+e.extensions[a][0])}n.apply(this,arguments),t.extend(this,{type:a||"",name:r||t.guid("file_"),lastModifiedDate:o.lastModifiedDate||(new Date).toLocaleString()})}return i.prototype=n.prototype,i}),i(_,[s,c,p,d,f,u,y,m,g],function(t,e,n,i,o,r,a,s,u){function c(o){var c,p,d,f=this;if(-1!==t.inArray(t.typeOf(o),["string","node"])&&(o={browse_button:o}),p=n.get(o.browse_button),!p)throw new i.DOMException(i.DOMException.NOT_FOUND_ERR);d={accept:[{title:r.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:p.parentNode||document.body},o=t.extend({},d,o),"string"==typeof o.required_caps&&(o.required_caps=s.parseCaps(o.required_caps)),"string"==typeof o.accept&&(o.accept=e.mimes2extList(o.accept)),c=n.get(o.container),c||(c=document.body),"static"===n.getStyle(c,"position")&&(c.style.position="relative"),c=p=null,u.call(f),t.extend(f,{uid:t.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){f.convertEventPropsToHandlers(l),f.bind("RuntimeInit",function(e,i){f.ruid=i.uid,f.shimid=i.shimid,f.bind("Ready",function(){f.trigger("Refresh")},999),f.bind("Change",function(){var e=i.exec.call(f,"FileInput","getFiles");f.files=[],t.each(e,function(t){return 0===t.size||void f.files.push(new a(f.ruid,t))})},999),f.bind("Refresh",function(){var e,r,a,s;a=n.get(o.browse_button),s=n.get(i.shimid),a&&(e=n.getPos(a,n.get(o.container)),r=n.getSize(a),s&&t.extend(s.style,{top:e.y+"px",left:e.x+"px",width:r.w+"px",height:r.h+"px"})),s=a=null}),i.exec.call(f,"FileInput","init",o)}),f.connectRuntime(t.extend({},o,{required_caps:{select_file:!0}}))},disable:function(e){var n=this.getRuntime();n&&n.exec.call(this,"FileInput","disable","undefined"===t.typeOf(e)||e)},refresh:function(){f.trigger("Refresh")},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===t.typeOf(this.files)&&t.each(this.files,function(t){t.destroy()}),this.files=null}})}var l=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return c.prototype=o.instance,c}),i(b,[u,p,d,s,y,g,f,c],function(t,e,n,i,o,r,a,s){function u(n){var a,u=this;"string"==typeof n&&(n={drop_zone:n}),a={accept:[{title:t.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},n="object"==typeof n?i.extend({},a,n):a,n.container=e.get(n.drop_zone)||document.body,"static"===e.getStyle(n.container,"position")&&(n.container.style.position="relative"),"string"==typeof n.accept&&(n.accept=s.mimes2extList(n.accept)),r.call(u),i.extend(u,{uid:i.guid("uid_"),ruid:null,files:null,init:function(){u.convertEventPropsToHandlers(c),u.bind("RuntimeInit",function(t,e){u.ruid=e.uid,u.bind("Drop",function(){var t=e.exec.call(u,"FileDrop","getFiles");u.files=[],i.each(t,function(t){u.files.push(new o(u.ruid,t))})},999),e.exec.call(u,"FileDrop","init",n),u.dispatchEvent("ready")}),u.connectRuntime(n)},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var c=["ready","dragenter","dragleave","drop","error"];return u.prototype=a.instance,u}),i(x,[s,g,f],function(t,e,n){function i(){this.uid=t.guid("uid_"),e.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return i.prototype=n.instance,i}),i(w,[s,h,d,f,v,y,x],function(t,e,n,i,o,r,a){function s(){function i(t,i){function l(t){c.readyState=s.DONE,c.error=t,c.trigger("error"),p()}function p(){r.destroy(),r=null,c.trigger("loadend")}function d(e){r.bind("Error",function(t,e){l(e)}),r.bind("Progress",function(t){c.result=e.exec.call(r,"FileReader","getResult"),c.trigger(t)}),r.bind("Load",function(t){c.readyState=s.DONE,c.result=e.exec.call(r,"FileReader","getResult"),c.trigger(t),p()}),e.exec.call(r,"FileReader","read",t,i)}if(r=new a,this.convertEventPropsToHandlers(u),this.readyState===s.LOADING)return l(new n.DOMException(n.DOMException.INVALID_STATE_ERR));if(this.readyState=s.LOADING,this.trigger("loadstart"),i instanceof o)if(i.isDetached()){var f=i.getSource();switch(t){case"readAsText":case"readAsBinaryString":this.result=f;break;case"readAsDataURL":this.result="data:"+i.type+";base64,"+e.btoa(f)}this.readyState=s.DONE,this.trigger("load"),p()}else d(r.connectRuntime(i.ruid));else l(new n.DOMException(n.DOMException.NOT_FOUND_ERR))}var r,c=this;t.extend(this,{uid:t.guid("uid_"),readyState:s.EMPTY,result:null,error:null,readAsBinaryString:function(t){i.call(this,"readAsBinaryString",t)},readAsDataURL:function(t){i.call(this,"readAsDataURL",t)},readAsText:function(t){i.call(this,"readAsText",t)},abort:function(){this.result=null,-1===t.inArray(this.readyState,[s.EMPTY,s.DONE])&&(this.readyState===s.LOADING&&(this.readyState=s.DONE),r&&r.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),r&&(r.getRuntime().exec.call(this,"FileReader","destroy"),r.disconnectRuntime()),c=r=null}})}var u=["loadstart","progress","load","abort","error","loadend"];return s.EMPTY=0,s.LOADING=1,s.DONE=2,s.prototype=i.instance,s}),i(j,[],function(){var t=function(e,n){for(var i=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],o=i.length,r={http:80,https:443},a={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,u=s.exec(e||"");o--;)u[o]&&(a[i[o]]=u[o]);if(!a.scheme){n&&"string"!=typeof n||(n=t(n||document.location.href)),a.scheme=n.scheme,a.host=n.host,a.port=n.port;var c="";/^[^\/]/.test(a.path)&&(c=n.path,/(\/|\/[^\.]+)$/.test(c)?c+="/":c=c.replace(/\/[^\/]+$/,"/")),a.path=c+(a.path||"")}return a.port||(a.port=r[a.scheme]||80),a.port=parseInt(a.port,10),a.path||(a.path="/"),delete a.source,a},e=function(e){var n={http:80,https:443},i=t(e);return i.scheme+"://"+i.host+(i.port!==n[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},n=function(e){function n(t){return[t.scheme,t.host,t.port].join("/")}return"string"==typeof e&&(e=t(e)),n(t())===n(e)};return{parseUrl:t,resolveUrl:e,hasSameOrigin:n}}),i(k,[s,g,h],function(t,e,n){return function(){function i(t,e){if(!e.isDetached()){var i=this.connectRuntime(e.ruid).exec.call(this,"FileReaderSync","read",t,e);return this.disconnectRuntime(),i}var o=e.getSource();switch(t){case"readAsBinaryString":return o;case"readAsDataURL":return"data:"+e.type+";base64,"+n.btoa(o);case"readAsText":for(var r="",a=0,s=o.length;s>a;a++)r+=String.fromCharCode(o[a]);return r}}e.call(this),t.extend(this,{uid:t.guid("uid_"),readAsBinaryString:function(t){return i.call(this,"readAsBinaryString",t)},readAsDataURL:function(t){return i.call(this,"readAsDataURL",t)},readAsText:function(t){return i.call(this,"readAsText",t)}})}}),i(E,[d,s,v],function(t,e,n){function i(){var t,i=[];e.extend(this,{append:function(o,r){var a=this,s=e.typeOf(r);r instanceof n?t={name:o,value:r}:"array"===s?(o+="[]",e.each(r,function(t){a.append(o,t)})):"object"===s?e.each(r,function(t,e){a.append(o+"["+e+"]",t)}):"null"===s||"undefined"===s||"number"===s&&isNaN(r)?a.append(o,"false"):i.push({name:o,value:r.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return t&&t.value||null},getBlobName:function(){return t&&t.name||null},each:function(n){e.each(i,function(t){n(t.value,t.name)}),t&&n(t.value,t.name)},destroy:function(){t=null,i=[]}})}return i}),i(C,[s,d,f,h,j,m,x,v,k,E,l,c],function(t,e,n,i,o,r,a,s,u,c,l,p){function d(){this.uid=t.guid("uid_")}function f(){function n(t,e){return C.hasOwnProperty(t)?1===arguments.length?l.can("define_property")?C[t]:E[t]:void(l.can("define_property")?C[t]=e:E[t]=e):void 0}function u(e){function i(){j.destroy(),j=null,s.dispatchEvent("loadend"),s=null}function o(o){j.bind("LoadStart",function(t){n("readyState",f.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(t),I&&s.upload.dispatchEvent(t)}),j.bind("Progress",function(t){n("readyState")!==f.LOADING&&(n("readyState",f.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(t)}),j.bind("UploadProgress",function(t){I&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:t.total,loaded:t.loaded})}),j.bind("Load",function(e){n("readyState",f.DONE),n("status",Number(o.exec.call(j,"XMLHttpRequest","getStatus")||0)),n("statusText",h[n("status")]||""),n("response",o.exec.call(j,"XMLHttpRequest","getResponse",n("responseType"))),~t.inArray(n("responseType"),["text",""])?n("responseText",n("response")):"document"===n("responseType")&&n("responseXML",n("response")),M=o.exec.call(j,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),n("status")>0?(I&&s.upload.dispatchEvent(e),s.dispatchEvent(e)):(D=!0,s.dispatchEvent("error")),i()}),j.bind("Abort",function(t){s.dispatchEvent(t),i()}),j.bind("Error",function(t){D=!0,n("readyState",f.DONE),s.dispatchEvent("readystatechange"),q=!0,s.dispatchEvent(t),i()}),o.exec.call(j,"XMLHttpRequest","send",{url:v,method:y,async:T,user:_,password:b,headers:S,mimeType:$,encoding:A,responseType:s.responseType,withCredentials:s.withCredentials,options:U},e)}var s=this;x=(new Date).getTime(),j=new a,"string"==typeof U.required_caps&&(U.required_caps=r.parseCaps(U.required_caps)),U.required_caps=t.extend({},U.required_caps,{return_response_type:s.responseType}),e instanceof c&&(U.required_caps.send_multipart=!0),L||(U.required_caps.do_cors=!0),U.ruid?o(j.connectRuntime(U)):(j.bind("RuntimeInit",function(t,e){o(e)}),j.bind("RuntimeError",function(t,e){s.dispatchEvent("RuntimeError",e)}),j.connectRuntime(U))}function g(){n("responseText",""),n("responseXML",null),n("response",null),n("status",0),n("statusText",""),x=w=null}var v,y,_,b,x,w,j,k,E=this,C={timeout:0,readyState:f.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},T=!0,S={},A=null,$=null,R=!1,O=!1,I=!1,q=!1,D=!1,L=!1,P=null,N=null,U={},M="";t.extend(this,C,{uid:t.guid("uid_"),upload:new d,open:function(r,a,s,u,c){var l;if(!r||!a)throw new e.DOMException(e.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(r)||i.utf8_encode(r)!==r)throw new e.DOMException(e.DOMException.SYNTAX_ERR);if(~t.inArray(r.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(y=r.toUpperCase()),~t.inArray(y,["CONNECT","TRACE","TRACK"]))throw new e.DOMException(e.DOMException.SECURITY_ERR);if(a=i.utf8_encode(a),l=o.parseUrl(a),L=o.hasSameOrigin(l),v=o.resolveUrl(a),(u||c)&&!L)throw new e.DOMException(e.DOMException.INVALID_ACCESS_ERR);if(_=u||l.user,b=c||l.pass,T=s||!0,T===!1&&(n("timeout")||n("withCredentials")||""!==n("responseType")))throw new e.DOMException(e.DOMException.INVALID_ACCESS_ERR);R=!T,O=!1,S={},g.call(this),n("readyState",f.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(o,r){var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(n("readyState")!==f.OPENED||O)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(o)||i.utf8_encode(o)!==o)throw new e.DOMException(e.DOMException.SYNTAX_ERR);return o=t.trim(o).toLowerCase(),!~t.inArray(o,a)&&!/^(proxy\-|sec\-)/.test(o)&&(S[o]?S[o]+=", "+r:S[o]=r,!0)},getAllResponseHeaders:function(){return M||""},getResponseHeader:function(e){return e=e.toLowerCase(),D||~t.inArray(e,["set-cookie","set-cookie2"])?null:M&&""!==M&&(k||(k={},t.each(M.split(/\r\n/),function(e){var n=e.split(/:\s+/);2===n.length&&(n[0]=t.trim(n[0]),k[n[0].toLowerCase()]={header:n[0],value:t.trim(n[1])})})),k.hasOwnProperty(e))?k[e].header+": "+k[e].value:null},overrideMimeType:function(i){var o,r;if(~t.inArray(n("readyState"),[f.LOADING,f.DONE]))throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(i=t.trim(i.toLowerCase()),/;/.test(i)&&(o=i.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(i=o[1],o[2]&&(r=o[2])),!p.mimes[i])throw new e.DOMException(e.DOMException.SYNTAX_ERR);P=i,N=r},send:function(n,o){if(U="string"===t.typeOf(o)?{ruid:o}:o?o:{},this.convertEventPropsToHandlers(m),this.upload.convertEventPropsToHandlers(m),this.readyState!==f.OPENED||O)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(n instanceof s)U.ruid=n.ruid,$=n.type||"application/octet-stream";else if(n instanceof c){if(n.hasBlob()){var r=n.getBlob();U.ruid=r.ruid,$=r.type||"application/octet-stream"}}else"string"==typeof n&&(A="UTF-8",$="text/plain;charset=UTF-8",n=i.utf8_encode(n));this.withCredentials||(this.withCredentials=U.required_caps&&U.required_caps.send_browser_cookies&&!L),I=!R&&this.upload.hasEventListener(),D=!1,q=!n,R||(O=!0),u.call(this,n)},abort:function(){if(D=!0,R=!1,~t.inArray(n("readyState"),[f.UNSENT,f.OPENED,f.DONE]))n("readyState",f.UNSENT);else{if(n("readyState",f.DONE),O=!1,!j)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);j.getRuntime().exec.call(j,"XMLHttpRequest","abort",q),q=!0}},destroy:function(){j&&("function"===t.typeOf(j.destroy)&&j.destroy(),j=null),this.unbindAll(),
this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var h={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};d.prototype=n.instance;var m=["loadstart","progress","abort","error","load","timeout","loadend"];return f.UNSENT=0,f.OPENED=1,f.HEADERS_RECEIVED=2,f.LOADING=3,f.DONE=4,f.prototype=n.instance,f}),i(T,[s,h,g,f],function(t,e,n,i){function o(){function i(){l=p=0,c=this.result=null}function r(e,n){var i=this;u=n,i.bind("TransportingProgress",function(e){p=e.loaded,l>p&&-1===t.inArray(i.state,[o.IDLE,o.DONE])&&a.call(i)},999),i.bind("TransportingComplete",function(){p=l,i.state=o.DONE,c=null,i.result=u.exec.call(i,"Transporter","getAsBlob",e||"")},999),i.state=o.BUSY,i.trigger("TransportingStarted"),a.call(i)}function a(){var t,n=this,i=l-p;d>i&&(d=i),t=e.btoa(c.substr(p,d)),u.exec.call(n,"Transporter","receive",t,l)}var s,u,c,l,p,d;n.call(this),t.extend(this,{uid:t.guid("uid_"),state:o.IDLE,result:null,transport:function(e,n,o){var a=this;if(o=t.extend({chunk_size:204798},o),(s=o.chunk_size%3)&&(o.chunk_size+=3-s),d=o.chunk_size,i.call(this),c=e,l=e.length,"string"===t.typeOf(o)||o.ruid)r.call(a,n,this.connectRuntime(o));else{var u=function(t,e){a.unbind("RuntimeInit",u),r.call(a,n,e)};this.bind("RuntimeInit",u),this.connectRuntime(o)}},abort:function(){var t=this;t.state=o.IDLE,u&&(u.exec.call(t,"Transporter","clear"),t.trigger("TransportingAborted")),i.call(t)},destroy:function(){this.unbindAll(),u=null,this.disconnectRuntime(),i.call(this)}})}return o.IDLE=0,o.BUSY=1,o.DONE=2,o.prototype=i.instance,o}),i(S,[s,p,d,k,C,m,g,T,l,f,v,y,h],function(t,e,n,i,o,r,a,s,u,c,l,p,d){function f(){function i(t){t||(t=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=t.size,this.width=t.width,this.height=t.height,this.type=t.type,this.meta=t.meta,""===this.name&&(this.name=t.name)}function c(e){var i=t.typeOf(e);try{if(e instanceof f){if(!e.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);m.apply(this,arguments)}else if(e instanceof l){if(!~t.inArray(e.type,["image/jpeg","image/png"]))throw new n.ImageError(n.ImageError.WRONG_FORMAT);g.apply(this,arguments)}else if(-1!==t.inArray(i,["blob","file"]))c.call(this,new p(null,e),arguments[1]);else if("string"===i)/^data:[^;]*;base64,/.test(e)?c.call(this,new l(null,{data:e}),arguments[1]):v.apply(this,arguments);else{if("node"!==i||"img"!==e.nodeName.toLowerCase())throw new n.DOMException(n.DOMException.TYPE_MISMATCH_ERR);c.call(this,e.src,arguments[1])}}catch(o){this.trigger("error",o)}}function m(e,n){var i=this.connectRuntime(e.ruid);this.ruid=i.uid,i.exec.call(this,"Image","loadFromImage",e,"undefined"===t.typeOf(n)||n)}function g(e,n){function i(t){o.ruid=t.uid,t.exec.call(o,"Image","loadFromBlob",e)}var o=this;o.name=e.name||"",e.isDetached()?(this.bind("RuntimeInit",function(t,e){i(e)}),n&&"string"==typeof n.required_caps&&(n.required_caps=r.parseCaps(n.required_caps)),this.connectRuntime(t.extend({required_caps:{access_image_binary:!0,resize_image:!0}},n))):i(this.connectRuntime(e.ruid))}function v(t,e){var n,i=this;n=new o,n.open("get",t),n.responseType="blob",n.onprogress=function(t){i.trigger(t)},n.onload=function(){g.call(i,n.response,!0)},n.onerror=function(t){i.trigger(t)},n.onloadend=function(){n.destroy()},n.bind("RuntimeError",function(t,e){i.trigger("RuntimeError",e)}),n.send(null,e)}a.call(this),t.extend(this,{uid:t.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){i.call(this)},999),this.convertEventPropsToHandlers(h),c.apply(this,arguments)},downsize:function(e,i,o,r){try{if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>f.MAX_RESIZE_WIDTH||this.height>f.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);(!e&&!i||"undefined"===t.typeOf(o))&&(o=!1),e=e||this.width,i=i||this.height,r="undefined"===t.typeOf(r)||!!r,this.getRuntime().exec.call(this,"Image","downsize",e,i,o,r)}catch(a){this.trigger("error",a)}},crop:function(t,e,n){this.downsize(t,e,!0,n)},getAsCanvas:function(){if(!u.can("create_canvas"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);var t=this.connectRuntime(this.ruid);return t.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(t,e){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return t||(t="image/jpeg"),"image/jpeg"!==t||e||(e=90),this.getRuntime().exec.call(this,"Image","getAsBlob",t,e)},getAsDataURL:function(t,e){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",t,e)},getAsBinaryString:function(t,e){var n=this.getAsDataURL(t,e);return d.atob(n.substring(n.indexOf("base64,")+7))},embed:function(i){function o(){if(u.can("create_canvas")){var e=r.getAsCanvas();if(e)return i.appendChild(e),e=null,r.destroy(),void h.trigger("embedded")}var o=r.getAsDataURL(a,c);if(!o)throw new n.ImageError(n.ImageError.WRONG_FORMAT);if(u.can("use_data_uri_of",o.length))i.innerHTML='<img src="'+o+'" width="'+r.width+'" height="'+r.height+'" />',r.destroy(),h.trigger("embedded");else{var l=new s;l.bind("TransportingComplete",function(){p=h.connectRuntime(this.result.ruid),h.bind("Embedded",function(){t.extend(p.getShimContainer().style,{top:"0px",left:"0px",width:r.width+"px",height:r.height+"px"}),p=null},999),p.exec.call(h,"ImageView","display",this.result.uid,g,v),r.destroy()}),l.transport(d.atob(o.substring(o.indexOf("base64,")+7)),a,t.extend({},m,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:i}))}}var r,a,c,l,p,h=this,m=arguments[1]||{},g=this.width,v=this.height;try{if(!(i=e.get(i)))throw new n.DOMException(n.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>f.MAX_RESIZE_WIDTH||this.height>f.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);if(a=m.type||this.type||"image/jpeg",c=m.quality||90,l="undefined"!==t.typeOf(m.crop)&&m.crop,m.width)g=m.width,v=m.height||g;else{var y=e.getSize(i);y.w&&y.h&&(g=y.w,v=y.h)}return r=new f,r.bind("Resize",function(){o.call(h)}),r.bind("Load",function(){r.downsize(g,v,l,!1)}),r.clone(this,!1),r}catch(_){this.trigger("error",_)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var h=["progress","load","error","resize","embedded"];return f.MAX_RESIZE_WIDTH=6500,f.MAX_RESIZE_HEIGHT=6500,f.prototype=c.instance,f}),i(A,[s,d,m,l],function(t,e,n,i){function o(e){var o=this,s=n.capTest,u=n.capTrue,c=t.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return o.can("access_binary")&&!!a.Image},display_media:s(i.can("create_canvas")||i.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var t=document.createElement("div");return("draggable"in t||"ondragstart"in t&&"ondrop"in t)&&("IE"!==i.browser||i.version>9)}()),filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),return_response_headers:u,return_response_type:function(t){return!("json"!==t||!window.JSON)||i.can("return_response_type",t)},return_status_code:u,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return o.can("access_binary")&&i.can("create_canvas")},select_file:function(){return i.can("use_fileinput")&&window.File},select_folder:function(){return o.can("select_file")&&"Chrome"===i.browser&&i.version>=21},select_multiple:function(){return!(!o.can("select_file")||"Safari"===i.browser&&"Windows"===i.os||"iOS"===i.os&&i.verComp(i.osVersion,"7.0.4","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||o.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return o.can("slice_blob")&&o.can("send_multipart")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||"IE"===i.browser&&i.version>=10||!!~t.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:u},arguments[2]);n.call(this,e,arguments[1]||r,c),t.extend(this,{init:function(){this.trigger("Init")},destroy:function(t){return function(){t.call(o),t=o=null}}(this.destroy)}),t.extend(this.getShim(),a)}var r="html5",a={};return n.addConstructor(r,o),a}),i($,[A,v],function(t,e){function n(){function t(t,e,n){var i;if(!window.File.prototype.slice)return(i=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?i.call(t,e,n):null;try{return t.slice(),t.slice(e,n)}catch(o){return t.slice(e,n-e)}}this.slice=function(){return new e(this.getRuntime().uid,t.apply(this,arguments))}}return t.Blob=n}),i(R,[s],function(t){function e(){this.returnValue=!1}function n(){this.cancelBubble=!0}var i={},o="moxie_"+t.guid(),r=function(r,a,s,u){var c,l;a=a.toLowerCase(),r.addEventListener?(c=s,r.addEventListener(a,c,!1)):r.attachEvent&&(c=function(){var t=window.event;t.target||(t.target=t.srcElement),t.preventDefault=e,t.stopPropagation=n,s(t)},r.attachEvent("on"+a,c)),r[o]||(r[o]=t.guid()),i.hasOwnProperty(r[o])||(i[r[o]]={}),l=i[r[o]],l.hasOwnProperty(a)||(l[a]=[]),l[a].push({func:c,orig:s,key:u})},a=function(e,n,r){var a,s;if(n=n.toLowerCase(),e[o]&&i[e[o]]&&i[e[o]][n]){a=i[e[o]][n];for(var u=a.length-1;u>=0&&(a[u].orig!==r&&a[u].key!==r||(e.removeEventListener?e.removeEventListener(n,a[u].func,!1):e.detachEvent&&e.detachEvent("on"+n,a[u].func),a[u].orig=null,a[u].func=null,a.splice(u,1),r===s));u--);if(a.length||delete i[e[o]][n],t.isEmptyObj(i[e[o]])){delete i[e[o]];try{delete e[o]}catch(c){e[o]=s}}}},s=function(e,n){e&&e[o]&&t.each(i[e[o]],function(t,i){a(e,i,n)})};return{addEvent:r,removeEvent:a,removeAllEvents:s}}),i(O,[A,s,p,R,c,l],function(t,e,n,i,o,r){function a(){var t,a=[];e.extend(this,{init:function(s){var u,c,l,p,d,f,h=this,m=h.getRuntime();t=s,a=[],l=t.accept.mimes||o.extList2mimes(t.accept,m.can("filter_by_extension")),c=m.getShimContainer(),c.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(t.multiple&&m.can("select_multiple")?"multiple":"")+(t.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(l?' accept="'+l.join(",")+'"':"")+" />",u=n.get(m.uid),e.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),p=n.get(t.browse_button),m.can("summon_file_dialog")&&("static"===n.getStyle(p,"position")&&(p.style.position="relative"),d=parseInt(n.getStyle(p,"z-index"),10)||1,p.style.zIndex=d,c.style.zIndex=d-1,i.addEvent(p,"click",function(t){var e=n.get(m.uid);e&&!e.disabled&&e.click(),t.preventDefault()},h.uid)),f=m.can("summon_file_dialog")?p:c,i.addEvent(f,"mouseover",function(){h.trigger("mouseenter")},h.uid),i.addEvent(f,"mouseout",function(){h.trigger("mouseleave")},h.uid),i.addEvent(f,"mousedown",function(){h.trigger("mousedown")},h.uid),i.addEvent(n.get(t.container),"mouseup",function(){h.trigger("mouseup")},h.uid),u.onchange=function g(){if(a=[],t.directory?e.each(this.files,function(t){"."!==t.name&&a.push(t)}):a=[].slice.call(this.files),"IE"!==r.browser)this.value="";else{var n=this.cloneNode(!0);this.parentNode.replaceChild(n,this),n.onchange=g}h.trigger("change")},h.trigger({type:"ready",async:!0}),c=null},getFiles:function(){return a},disable:function(t){var e,i=this.getRuntime();(e=n.get(i.uid))&&(e.disabled=!!t)},destroy:function(){var e=this.getRuntime(),o=e.getShim(),r=e.getShimContainer();i.removeAllEvents(r,this.uid),i.removeAllEvents(t&&n.get(t.container),this.uid),i.removeAllEvents(t&&n.get(t.browse_button),this.uid),r&&(r.innerHTML=""),o.removeInstance(this.uid),a=t=r=o=null}})}return t.FileInput=a}),i(I,[A,s,p,R,c],function(t,e,n,i,o){function r(){function t(t){for(var n=[],i=0;i<t.length;i++)[].push.apply(n,t[i].extensions.split(/\s*,\s*/));return-1===e.inArray("*",n)?n:[]}function r(t){var n=o.getFileExtension(t.name);return!n||!d.length||-1!==e.inArray(n,d)}function a(t,n){var i=[];e.each(t,function(t){var e=t.webkitGetAsEntry();if(e)if(e.isFile){var n=t.getAsFile();r(n)&&p.push(n)}else i.push(e)}),i.length?s(i,n):n()}function s(t,n){var i=[];e.each(t,function(t){i.push(function(e){u(t,e)})}),e.inSeries(i,function(){n()})}function u(t,e){t.isFile?t.file(function(t){r(t)&&p.push(t),e()},function(){e()}):t.isDirectory?c(t,e):e()}function c(t,e){function n(t){o.readEntries(function(e){e.length?([].push.apply(i,e),n(t)):t()},t)}var i=[],o=t.createReader();n(function(){s(i,e)})}var l,p=[],d=[];e.extend(this,{init:function(n){var o,s=this;l=n,d=t(l.accept),o=l.container,i.addEvent(o,"dragover",function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="copy"},s.uid),i.addEvent(o,"drop",function(t){t.preventDefault(),t.stopPropagation(),p=[],t.dataTransfer.items&&t.dataTransfer.items[0].webkitGetAsEntry?a(t.dataTransfer.items,function(){s.trigger("drop")}):(e.each(t.dataTransfer.files,function(t){r(t)&&p.push(t)}),s.trigger("drop"))},s.uid),i.addEvent(o,"dragenter",function(t){t.preventDefault(),t.stopPropagation(),s.trigger("dragenter")},s.uid),i.addEvent(o,"dragleave",function(t){t.preventDefault(),t.stopPropagation(),s.trigger("dragleave")},s.uid)},getFiles:function(){return p},destroy:function(){i.removeAllEvents(l&&n.get(l.container),this.uid),p=d=l=null}})}return t.FileDrop=r}),i(q,[A,h,s],function(t,e,n){function i(){function t(t){return e.atob(t.substring(t.indexOf("base64,")+7))}var i,o=!1;n.extend(this,{read:function(t,e){var r=this;i=new window.FileReader,i.addEventListener("progress",function(t){r.trigger(t)}),i.addEventListener("load",function(t){r.trigger(t)}),i.addEventListener("error",function(t){r.trigger(t,i.error)}),i.addEventListener("loadend",function(){i=null}),"function"===n.typeOf(i[t])?(o=!1,i[t](e.getSource())):"readAsBinaryString"===t&&(o=!0,i.readAsDataURL(e.getSource()))},getResult:function(){return i&&i.result?o?t(i.result):i.result:null},abort:function(){i&&i.abort()},destroy:function(){i=null}})}return t.FileReader=i}),i(D,[A,s,c,j,y,v,E,d,l],function(t,e,n,i,o,r,a,s,u){function c(){function t(t,e){var n,i,o=this;n=e.getBlob().getSource(),i=new window.FileReader,i.onload=function(){e.append(e.getBlobName(),new r(null,{type:n.type,data:i.result})),h.send.call(o,t,e)},i.readAsBinaryString(n)}function c(){return!window.XMLHttpRequest||"IE"===u.browser&&u.version<8?function(){for(var t=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],e=0;e<t.length;e++)try{return new ActiveXObject(t[e])}catch(n){}}():new window.XMLHttpRequest}function l(t){var e=t.responseXML,n=t.responseText;return"IE"===u.browser&&n&&e&&!e.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(t.getResponseHeader("Content-Type"))&&(e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.validateOnParse=!1,e.loadXML(n)),e&&("IE"===u.browser&&0!==e.parseError||!e.documentElement||"parsererror"===e.documentElement.tagName)?null:e}function p(t){var e="----moxieboundary"+(new Date).getTime(),n="--",i="\r\n",o="",a=this.getRuntime();if(!a.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return d.setRequestHeader("Content-Type","multipart/form-data; boundary="+e),t.each(function(t,a){o+=t instanceof r?n+e+i+'Content-Disposition: form-data; name="'+a+'"; filename="'+unescape(encodeURIComponent(t.name||"blob"))+'"'+i+"Content-Type: "+(t.type||"application/octet-stream")+i+i+t.getSource()+i:n+e+i+'Content-Disposition: form-data; name="'+a+'"'+i+i+unescape(encodeURIComponent(t))+i}),o+=n+e+n+i}var d,f,h=this;e.extend(this,{send:function(n,o){var s=this,l="Mozilla"===u.browser&&u.version>=4&&u.version<7,h="Android Browser"===u.browser,m=!1;if(f=n.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),d=c(),d.open(n.method,n.url,n.async,n.user,n.password),o instanceof r)o.isDetached()&&(m=!0),o=o.getSource();else if(o instanceof a){if(o.hasBlob())if(o.getBlob().isDetached())o=p.call(s,o),m=!0;else if((l||h)&&"blob"===e.typeOf(o.getBlob().getSource())&&window.FileReader)return void t.call(s,n,o);if(o instanceof a){var g=new window.FormData;o.each(function(t,e){t instanceof r?g.append(e,t.getSource()):g.append(e,t)}),o=g}}d.upload?(n.withCredentials&&(d.withCredentials=!0),d.addEventListener("load",function(t){s.trigger(t)}),d.addEventListener("error",function(t){s.trigger(t)}),d.addEventListener("progress",function(t){s.trigger(t)}),d.upload.addEventListener("progress",function(t){s.trigger({type:"UploadProgress",loaded:t.loaded,total:t.total})})):d.onreadystatechange=function(){switch(d.readyState){case 1:break;case 2:break;case 3:var t,e;try{i.hasSameOrigin(n.url)&&(t=d.getResponseHeader("Content-Length")||0),d.responseText&&(e=d.responseText.length)}catch(o){t=e=0}s.trigger({type:"progress",lengthComputable:!!t,total:parseInt(t,10),loaded:e});break;case 4:d.onreadystatechange=function(){},0===d.status?s.trigger("error"):s.trigger("load")}},e.isEmptyObj(n.headers)||e.each(n.headers,function(t,e){d.setRequestHeader(e,t)}),""!==n.responseType&&"responseType"in d&&(d.responseType="json"!==n.responseType||u.can("return_response_type","json")?n.responseType:"text"),m?d.sendAsBinary?d.sendAsBinary(o):function(){for(var t=new Uint8Array(o.length),e=0;e<o.length;e++)t[e]=255&o.charCodeAt(e);d.send(t.buffer)}():d.send(o),s.trigger("loadstart")},getStatus:function(){try{if(d)return d.status}catch(t){}return 0},getResponse:function(t){var e=this.getRuntime();try{switch(t){case"blob":var i=new o(e.uid,d.response),r=d.getResponseHeader("Content-Disposition");if(r){var a=r.match(/filename=([\'\"'])([^\1]+)\1/);a&&(f=a[2])}return i.name=f,i.type||(i.type=n.getFileMime(f)),i;case"json":return u.can("return_response_type","json")?d.response:200===d.status&&window.JSON?JSON.parse(d.responseText):null;case"document":return l(d);default:return""!==d.responseText?d.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return d.getAllResponseHeaders()}catch(t){}return""},abort:function(){d&&d.abort()},destroy:function(){h=f=null}})}return t.XMLHttpRequest=c}),i(L,[],function(){return function(){function t(t,e){var n,i=r?0:-8*(e-1),a=0;for(n=0;e>n;n++)a|=o.charCodeAt(t+n)<<Math.abs(i+8*n);return a}function n(t,e,n){n=3===arguments.length?n:o.length-e-1,o=o.substr(0,e)+t+o.substr(n+e)}function i(t,e,i){var o,a="",s=r?0:-8*(i-1);for(o=0;i>o;o++)a+=String.fromCharCode(255&e>>Math.abs(s+8*o));n(a,t,i)}var o,r=!1;return{II:function(t){return t===e?r:void(r=t)},init:function(t){r=!1,o=t},SEGMENT:function(t,e,i){switch(arguments.length){case 1:return o.substr(t,o.length-t-1);case 2:return o.substr(t,e);case 3:n(i,t,e);break;default:return o}},BYTE:function(e){return t(e,1)},SHORT:function(e){return t(e,2)},LONG:function(n,o){return o===e?t(n,4):void i(n,o,4)},SLONG:function(e){var n=t(e,4);return n>2147483647?n-4294967296:n},STRING:function(e,n){var i="";for(n+=e;n>e;e++)i+=String.fromCharCode(t(e,1));return i}}}}),i(P,[L],function(t){return function e(n){var i,o,r,a=[],s=0;if(i=new t,i.init(n),65496===i.SHORT(0)){for(o=2;o<=n.length;)if(r=i.SHORT(o),r>=65488&&65495>=r)o+=2;else{if(65498===r||65497===r)break;s=i.SHORT(o+2)+2,r>=65505&&65519>=r&&a.push({hex:r,name:"APP"+(15&r),start:o,length:s,segment:i.SEGMENT(o,s)}),o+=s}return i.init(null),{headers:a,restore:function(t){var e,n;for(i.init(t),o=65504==i.SHORT(2)?4+i.SHORT(4):2,n=0,e=a.length;e>n;n++)i.SEGMENT(o,0,a[n].segment),o+=a[n].length;return t=i.SEGMENT(),i.init(null),t},strip:function(t){var n,o,r;for(o=new e(t),n=o.headers,o.purge(),i.init(t),r=n.length;r--;)i.SEGMENT(n[r].start,n[r].length,"");return t=i.SEGMENT(),i.init(null),t},get:function(t){for(var e=[],n=0,i=a.length;i>n;n++)a[n].name===t.toUpperCase()&&e.push(a[n].segment);return e},set:function(t,e){var n,i,o,r=[];for("string"==typeof e?r.push(e):r=e,n=i=0,o=a.length;o>n&&(a[n].name===t.toUpperCase()&&(a[n].segment=r[i],a[n].length=r[i].length,i++),!(i>=r.length));n++);},purge:function(){a=[],i.init(null),i=null}}}}}),i(N,[s,L],function(t,n){return function i(){function i(t,n){var i,o,r,s,u,p,d,f,h=a.SHORT(t),m=[],g={};for(i=0;h>i;i++)if(d=p=t+12*i+2,r=n[a.SHORT(d)],r!==e){switch(s=a.SHORT(d+=2),u=a.LONG(d+=2),d+=4,m=[],s){case 1:case 7:for(u>4&&(d=a.LONG(d)+l.tiffHeader),o=0;u>o;o++)m[o]=a.BYTE(d+o);break;case 2:u>4&&(d=a.LONG(d)+l.tiffHeader),g[r]=a.STRING(d,u-1);continue;case 3:for(u>2&&(d=a.LONG(d)+l.tiffHeader),o=0;u>o;o++)m[o]=a.SHORT(d+2*o);break;case 4:for(u>1&&(d=a.LONG(d)+l.tiffHeader),o=0;u>o;o++)m[o]=a.LONG(d+4*o);break;case 5:for(d=a.LONG(d)+l.tiffHeader,o=0;u>o;o++)m[o]=a.LONG(d+4*o)/a.LONG(d+4*o+4);break;case 9:for(d=a.LONG(d)+l.tiffHeader,o=0;u>o;o++)m[o]=a.SLONG(d+4*o);break;case 10:for(d=a.LONG(d)+l.tiffHeader,o=0;u>o;o++)m[o]=a.SLONG(d+4*o)/a.SLONG(d+4*o+4);break;default:continue}f=1==u?m[0]:m,g[r]=c.hasOwnProperty(r)&&"object"!=typeof f?c[r][f]:f}return g}function o(){var t=l.tiffHeader;return a.II(18761==a.SHORT(t)),42===a.SHORT(t+=2)&&(l.IFD0=l.tiffHeader+a.LONG(t+=2),u=i(l.IFD0,s.tiff),"ExifIFDPointer"in u&&(l.exifIFD=l.tiffHeader+u.ExifIFDPointer,delete u.ExifIFDPointer),"GPSInfoIFDPointer"in u&&(l.gpsIFD=l.tiffHeader+u.GPSInfoIFDPointer,delete u.GPSInfoIFDPointer),!0)}function r(t,e,n){var i,o,r,u=0;if("string"==typeof e){var c=s[t.toLowerCase()];for(var p in c)if(c[p]===e){e=p;break}}i=l[t.toLowerCase()+"IFD"],o=a.SHORT(i);for(var d=0;o>d;d++)if(r=i+12*d+2,a.SHORT(r)==e){u=r+8;break}return!!u&&(a.LONG(u,n),!0)}var a,s,u,c,l={};return a=new n,s={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(t){return l={tiffHeader:10},!(t===e||!t.length)&&(a.init(t),65505===a.SHORT(0)&&"EXIF\0"===a.STRING(4,5).toUpperCase()&&o())},TIFF:function(){return u},EXIF:function(){var e;if(e=i(l.exifIFD,s.exif),e.ExifVersion&&"array"===t.typeOf(e.ExifVersion)){for(var n=0,o="";n<e.ExifVersion.length;n++)o+=String.fromCharCode(e.ExifVersion[n]);e.ExifVersion=o}return e},GPS:function(){var e;return e=i(l.gpsIFD,s.gps),e.GPSVersionID&&"array"===t.typeOf(e.GPSVersionID)&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(t,e){return("PixelXDimension"===t||"PixelYDimension"===t)&&r("exif",t,e)},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null),a=u=null,l={}}}}}),i(U,[s,d,P,L,N],function(t,e,n,i,o){function r(r){function a(){for(var t,e,n=0;n<=u.length;){if(t=c.SHORT(n+=2),t>=65472&&65475>=t)return n+=5,{height:c.SHORT(n),width:c.SHORT(n+=2)};e=c.SHORT(n+=2),n+=e-2}return null}function s(){p&&l&&c&&(p.purge(),l.purge(),c.init(null),u=d=l=p=c=null)}var u,c,l,p,d,f;if(u=r,c=new i,c.init(u),65496!==c.SHORT(0))throw new e.ImageError(e.ImageError.WRONG_FORMAT);l=new n(r),p=new o,f=!!p.init(l.get("app1")[0]),d=a.call(this),t.extend(this,{type:"image/jpeg",size:u.length,width:d&&d.width||0,height:d&&d.height||0,setExif:function(e,n){return!!f&&("object"===t.typeOf(e)?t.each(e,function(t,e){p.setExif(e,t)}):p.setExif(e,n),void l.set("app1",p.getBinary()))},writeHeaders:function(){return arguments.length?l.restore(arguments[0]):u=l.restore(u)},stripHeaders:function(t){return l.strip(t)},purge:function(){s.call(this)}}),f&&(this.meta={tiff:p.TIFF(),exif:p.EXIF(),gps:p.GPS()})}return r}),i(M,[d,s,L],function(t,e,n){function i(i){function o(){var t,e;return t=a.call(this,8),"IHDR"http://common1.qyerstatic.com/place/js/common/==t.type?(e=t.start,{width:u.LONG(e),height:u.LONG(e+=4)}):null}function r(){u&&(u.init(null),s=p=c=l=u=null)}function a(t){var e,n,i,o;return e=u.LONG(t),n=u.STRING(t+=4,4),i=t+=4,o=u.LONG(t+e),{length:e,type:n,start:i,CRC:o}}var s,u,c,l,p;s=i,u=new n,u.init(s),function(){var e=0,n=0,i=[35152,20039,3338,6666];for(n=0;n<i.length;n++,e+=2)if(i[n]!=u.SHORT(e))throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),p=o.call(this),e.extend(this,{type:"image/png",size:s.length,width:p.width,height:p.height,purge:function(){r.call(this)}}),r.call(this)}return i}),i(F,[s,d,U,M],function(t,e,n,i){return function(o){var r,a=[n,i];r=function(){for(var t=0;t<a.length;t++)try{return new a[t](o)}catch(n){}throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),t.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(t){return t},stripHeaders:function(t){return t},purge:function(){}}),t.extend(this,r),this.purge=function(){r.purge(),r=null}}}),i(z,[],function(){function t(t,i,o){var r=t.naturalWidth,a=t.naturalHeight,s=o.width,u=o.height,c=o.x||0,l=o.y||0,p=i.getContext("2d");e(t)&&(r/=2,a/=2);var d=1024,f=document.createElement("canvas");f.width=f.height=d;for(var h=f.getContext("2d"),m=n(t,r,a),g=0;a>g;){for(var v=g+d>a?a-g:d,y=0;r>y;){var _=y+d>r?r-y:d;h.clearRect(0,0,d,d),h.drawImage(t,-y,-g);var b=y*s/r+c<<0,x=Math.ceil(_*s/r),w=g*u/a/m+l<<0,j=Math.ceil(v*u/a/m);p.drawImage(f,0,0,_,v,b,w,x,j),y+=d}g+=d}f=h=null}function e(t){var e=t.naturalWidth,n=t.naturalHeight;if(e*n>1048576){var i=document.createElement("canvas");i.width=i.height=1;var o=i.getContext("2d");return o.drawImage(t,-e+1,0),0===o.getImageData(0,0,1,1).data[3]}return!1}function n(t,e,n){var i=document.createElement("canvas");i.width=1,i.height=n;var o=i.getContext("2d");o.drawImage(t,0,0);for(var r=o.getImageData(0,0,1,n).data,a=0,s=n,u=n;u>a;){var c=r[4*(u-1)+3];0===c?s=u:a=u,u=s+a>>1}i=null;var l=u/n;return 0===l?1:l}return{isSubsampled:e,renderTo:t}}),i(B,[A,s,d,h,y,F,z,c,l],function(t,e,n,i,o,r,a,s,u){function c(){function t(){if(!_&&!v)throw new n.ImageError(n.DOMException.INVALID_STATE_ERR);return _||v}function c(t){return i.atob(t.substring(t.indexOf("base64,")+7))}function l(t,e){return"data:"+(e||"")+";base64,"+i.btoa(t)}function p(t){var e=this;v=new Image,v.onerror=function(){g.call(this),e.trigger("error",new n.ImageError(n.ImageError.WRONG_FORMAT))},v.onload=function(){e.trigger("load")},v.src=/^data:[^;]*;base64,/.test(t)?t:l(t,x.type)}function d(t,e){var i,o=this;return window.FileReader?(i=new FileReader,i.onload=function(){e(this.result)},i.onerror=function(){o.trigger("error",new n.FileException(n.FileException.NOT_READABLE_ERR))},void i.readAsDataURL(t)):e(t.getAsDataURL())}function f(n,i,o,r){var a,s,u,c,l,p,d=this,f=0,g=0;if(k=r,p=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==e.inArray(p,[5,6,7,8])){var v=n;n=i,i=v}return u=t(),s=o?Math.max:Math.min,a=s(n/u.width,i/u.height),a>1&&(!o||r)?void this.trigger("Resize"):(_||(_=document.createElement("canvas")),c=Math.round(u.width*a),l=Math.round(u.height*a),o?(_.width=n,_.height=i,c>n&&(f=Math.round((c-n)/2)),l>i&&(g=Math.round((l-i)/2))):(_.width=c,_.height=l),k||m(_.width,_.height,p),h.call(this,u,_,-f,-g,c,l),this.width=_.width,this.height=_.height,j=!0,void d.trigger("Resize"))}function h(t,e,n,i,o,r){if("iOS"===u.OS)a.renderTo(t,e,{width:o,height:r,x:n,y:i});else{var s=e.getContext("2d");s.drawImage(t,n,i,o,r)}}function m(t,e,n){switch(n){case 5:case 6:case 7:case 8:_.width=e,_.height=t;break;default:_.width=t,_.height=e}var i=_.getContext("2d");switch(n){case 2:i.translate(t,0),i.scale(-1,1);break;case 3:i.translate(t,e),i.rotate(Math.PI);break;case 4:i.translate(0,e),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-e);break;case 7:i.rotate(.5*Math.PI),i.translate(t,-e),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-t,0)}}function g(){y&&(y.purge(),y=null),b=v=_=x=null,j=!1}var v,y,_,b,x,w=this,j=!1,k=!0;e.extend(this,{loadFromBlob:function(t){var e=this,i=e.getRuntime(),o=!(arguments.length>1)||arguments[1];if(!i.can("access_binary"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);return x=t,t.isDetached()?(b=t.getSource(),void p.call(this,b)):void d.call(this,t.getSource(),function(t){o&&(b=c(t)),p.call(e,t)})},loadFromImage:function(t,e){this.meta=t.meta,x=new o(null,{name:t.name,size:t.size,type:t.type}),p.call(this,e?b=t.getAsBinaryString():t.getAsDataURL())},getInfo:function(){var e,n=this.getRuntime();return!y&&b&&n.can("access_image_binary")&&(y=new r(b)),
e={width:t().width||0,height:t().height||0,type:x.type||s.getFileMime(x.name),size:b&&b.length||x.size||0,name:x.name||"",meta:y&&y.meta||this.meta||{}}},downsize:function(){f.apply(this,arguments)},getAsCanvas:function(){return _&&(_.id=this.uid+"_canvas"),_},getAsBlob:function(t,e){return t!==this.type&&f.call(this,this.width,this.height,!1),new o(null,{name:x.name||"",type:t,data:w.getAsBinaryString.call(this,t,e)})},getAsDataURL:function(t){var e=arguments[1]||90;if(!j)return v.src;if("image/jpeg"!==t)return _.toDataURL("image/png");try{return _.toDataURL("image/jpeg",e/100)}catch(n){return _.toDataURL("image/jpeg")}},getAsBinaryString:function(t,e){if(!j)return b||(b=c(w.getAsDataURL(t,e))),b;if("image/jpeg"!==t)b=c(w.getAsDataURL(t,e));else{var n;e||(e=90);try{n=_.toDataURL("image/jpeg",e/100)}catch(i){n=_.toDataURL("image/jpeg")}b=c(n),y&&(b=y.stripHeaders(b),k&&(y.meta&&y.meta.exif&&y.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),b=y.writeHeaders(b)),y.purge(),y=null)}return j=!1,b},destroy:function(){w=null,g.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return t.Image=c}),i(H,[s,l,p,d,m],function(t,e,n,i,o){function r(){var t;try{t=navigator.plugins["Shockwave Flash"],t=t.description}catch(e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(n){t="0.0"}}return t=t.match(/\d+/g),parseFloat(t[0]+"."+t[1])}function a(a){var c,l=this;a=t.extend({swf_url:e.swf_url},a),o.call(this,a,s,{access_binary:function(t){return t&&"browser"===l.mode},access_image_binary:function(t){return t&&"browser"===l.mode},display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===l.mode},resize_image:o.capTrue,return_response_headers:!1,return_response_type:function(e){return!("json"!==e||!window.JSON)||(!t.arrayDiff(e,["","text","document"])||"browser"===l.mode)},return_status_code:function(e){return"browser"===l.mode||!t.arrayDiff(e,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:function(t){return t&&"browser"===l.mode},send_browser_cookies:function(t){return t&&"browser"===l.mode},send_custom_headers:function(t){return t&&"browser"===l.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:function(t){return t&&"browser"===l.mode},summon_file_dialog:!1,upload_filesize:function(e){return t.parseSizeStr(e)<=2097152||"client"===l.mode},use_http_method:function(e){return!t.arrayDiff(e,["GET","POST"])}},{access_binary:function(t){return t?"browser":"client"},access_image_binary:function(t){return t?"browser":"client"},report_upload_progress:function(t){return t?"browser":"client"},return_response_type:function(e){return t.arrayDiff(e,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(e){return t.arrayDiff(e,[200,404])?"browser":["client","browser"]},send_binary_string:function(t){return t?"browser":"client"},send_browser_cookies:function(t){return t?"browser":"client"},send_custom_headers:function(t){return t?"browser":"client"},stream_upload:function(t){return t?"client":"browser"},upload_filesize:function(e){return t.parseSizeStr(e)>=2097152?"client":"browser"}},"client"),r()<10&&(this.mode=!1),t.extend(this,{getShim:function(){return n.get(this.uid)},shimExec:function(t,e){var n=[].slice.call(arguments,2);return l.getShim().exec(this.uid,t,e,n)},init:function(){var n,o,r;r=this.getShimContainer(),t.extend(r.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),n='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+a.swf_url+'" ',"IE"===e.browser&&(n+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),n+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+e.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===e.browser?(o=document.createElement("div"),r.appendChild(o),o.outerHTML=n,o=r=null):r.innerHTML=n,c=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(t){return function(){t.call(l),clearTimeout(c),a=c=t=l=null}}(this.destroy)},u)}var s="flash",u={};return o.addConstructor(s,a),u}),i(Q,[H,v],function(t,e){var n={slice:function(t,n,i,o){var r=this.getRuntime();return 0>n?n=Math.max(t.size+n,0):n>0&&(n=Math.min(n,t.size)),0>i?i=Math.max(t.size+i,0):i>0&&(i=Math.min(i,t.size)),t=r.shimExec.call(this,"Blob","slice",n,i,o||""),t&&(t=new e(r.uid,t)),t}};return t.Blob=n}),i(G,[H],function(t){var e={init:function(t){this.getRuntime().shimExec.call(this,"FileInput","init",{name:t.name,accept:t.accept,multiple:t.multiple}),this.trigger("ready")}};return t.FileInput=e}),i(X,[H,h],function(t,e){function n(t,n){switch(n){case"readAsText":return e.atob(t,"utf8");case"readAsBinaryString":return e.atob(t);case"readAsDataURL":return t}return null}var i="",o={read:function(t,e){var o=this,r=o.getRuntime();return"readAsDataURL"===t&&(i="data:"+(e.type||"")+";base64,"),o.bind("Progress",function(e,o){o&&(i+=n(o,t))}),r.shimExec.call(this,"FileReader","readAsBase64",e.uid)},getResult:function(){return i},destroy:function(){i=null}};return t.FileReader=o}),i(Y,[H,h],function(t,e){function n(t,n){switch(n){case"readAsText":return e.atob(t,"utf8");case"readAsBinaryString":return e.atob(t);case"readAsDataURL":return t}return null}var i={read:function(t,e){var i,o=this.getRuntime();return(i=o.shimExec.call(this,"FileReaderSync","readAsBase64",e.uid))?("readAsDataURL"===t&&(i="data:"+(e.type||"")+";base64,"+i),n(i,t,e.type)):null}};return t.FileReaderSync=i}),i(V,[H,s,v,y,k,E,T],function(t,e,n,i,o,r,a){var s={send:function(t,i){function o(){t.transport=l.mode,l.shimExec.call(c,"XMLHttpRequest","send",t,i)}function s(t,e){l.shimExec.call(c,"XMLHttpRequest","appendBlob",t,e.uid),i=null,o()}function u(t,e){var n=new a;n.bind("TransportingComplete",function(){e(this.result)}),n.transport(t.getSource(),t.type,{ruid:l.uid})}var c=this,l=c.getRuntime();if(e.isEmptyObj(t.headers)||e.each(t.headers,function(t,e){l.shimExec.call(c,"XMLHttpRequest","setRequestHeader",e,t.toString())}),i instanceof r){var p;if(i.each(function(t,e){t instanceof n?p=e:l.shimExec.call(c,"XMLHttpRequest","append",e,t)}),i.hasBlob()){var d=i.getBlob();d.isDetached()?u(d,function(t){d.destroy(),s(p,t)}):s(p,d)}else i=null,o()}else i instanceof n?i.isDetached()?u(i,function(t){i.destroy(),i=t.uid,o()}):(i=i.uid,o()):o()},getResponse:function(t){var n,r,a=this.getRuntime();if(r=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(r=new i(a.uid,r),"blob"===t)return r;try{if(n=new o,~e.inArray(t,["","text"]))return n.readAsText(r);if("json"===t&&window.JSON)return JSON.parse(n.readAsText(r))}finally{r.destroy()}}return null},abort:function(t){var e=this.getRuntime();e.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return t.XMLHttpRequest=s}),i(J,[H,v],function(t,e){var n={getAsBlob:function(t){var n=this.getRuntime(),i=n.shimExec.call(this,"Transporter","getAsBlob",t);return i?new e(n.uid,i):null}};return t.Transporter=n}),i(W,[H,s,T,v,k],function(t,e,n,i,o){var r={loadFromBlob:function(t){function e(t){o.shimExec.call(i,"Image","loadFromBlob",t.uid),i=o=null}var i=this,o=i.getRuntime();if(t.isDetached()){var r=new n;r.bind("TransportingComplete",function(){e(r.result.getSource())}),r.transport(t.getSource(),t.type,{ruid:o.uid})}else e(t.getSource())},loadFromImage:function(t){var e=this.getRuntime();return e.shimExec.call(this,"Image","loadFromImage",t.uid)},getAsBlob:function(t,e){var n=this.getRuntime(),o=n.shimExec.call(this,"Image","getAsBlob",t,e);return o?new i(n.uid,o):null},getAsDataURL:function(){var t,e=this.getRuntime(),n=e.Image.getAsBlob.apply(this,arguments);return n?(t=new o,t.readAsDataURL(n)):null}};return t.Image=r}),i(K,[s,l,p,d,m],function(t,e,n,i,o){function r(t){var e,n,i,o,r,a=!1,s=null,u=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(t)&&(a=!0),s=null}catch(c){var l=navigator.plugins["Silverlight Plug-In"];if(l){for(e=l.description,"1.0.30226.2"===e&&(e="2.0.30226.2"),n=e.split(".");n.length>3;)n.pop();for(;n.length<4;)n.push(0);for(i=t.split(".");i.length>4;)i.pop();do o=parseInt(i[u],10),r=parseInt(n[u],10),u++;while(u<i.length&&o===r);r>=o&&!isNaN(o)&&(a=!0)}}}catch(p){a=!1}return a}function a(a){var c,l=this;a=t.extend({xap_url:e.xap_url},a),o.call(this,a,s,{access_binary:o.capTrue,access_image_binary:o.capTrue,display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:o.capTrue,resize_image:o.capTrue,return_response_headers:function(t){return t&&"client"===l.mode},return_response_type:function(t){return"json"!==t||!!window.JSON},return_status_code:function(e){return"client"===l.mode||!t.arrayDiff(e,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:o.capTrue,send_browser_cookies:function(t){return t&&"browser"===l.mode},send_custom_headers:function(t){return t&&"client"===l.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:o.capTrue,use_http_method:function(e){return"client"===l.mode||!t.arrayDiff(e,["GET","POST"])}},{return_response_headers:function(t){return t?"client":"browser"},return_status_code:function(e){return t.arrayDiff(e,[200,404])?"client":["client","browser"]},send_browser_cookies:function(t){return t?"browser":"client"},send_custom_headers:function(t){return t?"client":"browser"},use_http_method:function(e){return t.arrayDiff(e,["GET","POST"])?"client":["client","browser"]}}),r("2.0.31005.0")&&"Opera"!==e.browser||(this.mode=!1),t.extend(this,{getShim:function(){return n.get(this.uid).content.Moxie},shimExec:function(t,e){var n=[].slice.call(arguments,2);return l.getShim().exec(this.uid,t,e,n)},init:function(){var t;t=this.getShimContainer(),t.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+a.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+e.global_event_dispatcher+'"/></object>',c=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},"Windows"http://common1.qyerstatic.com/place/js/common/!==e.OS?1e4:5e3)},destroy:function(t){return function(){t.call(l),clearTimeout(c),a=c=t=l=null}}(this.destroy)},u)}var s="silverlight",u={};return o.addConstructor(s,a),u}),i(Z,[K,s,Q],function(t,e,n){return t.Blob=e.extend({},n)}),i(tt,[K],function(t){var e={init:function(t){function e(t){for(var e="",n=0;n<t.length;n++)e+=(""!==e?"|":"")+t[n].title+" | *."+t[n].extensions.replace(/,/g,";*.");return e}this.getRuntime().shimExec.call(this,"FileInput","init",e(t.accept),t.name,t.multiple),this.trigger("ready")}};return t.FileInput=e}),i(et,[K,p,R],function(t,e,n){var i={init:function(){var t,i=this,o=i.getRuntime();return t=o.getShimContainer(),n.addEvent(t,"dragover",function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="copy"},i.uid),n.addEvent(t,"dragenter",function(t){t.preventDefault();var n=e.get(o.uid).dragEnter(t);n&&t.stopPropagation()},i.uid),n.addEvent(t,"drop",function(t){t.preventDefault();var n=e.get(o.uid).dragDrop(t);n&&t.stopPropagation()},i.uid),o.shimExec.call(this,"FileDrop","init")}};return t.FileDrop=i}),i(nt,[K,s,X],function(t,e,n){return t.FileReader=e.extend({},n)}),i(it,[K,s,Y],function(t,e,n){return t.FileReaderSync=e.extend({},n)}),i(ot,[K,s,V],function(t,e,n){return t.XMLHttpRequest=e.extend({},n)}),i(rt,[K,s,J],function(t,e,n){return t.Transporter=e.extend({},n)}),i(at,[K,s,W],function(t,e,n){return t.Image=e.extend({},n,{getInfo:function(){var t=this.getRuntime(),n=["tiff","exif","gps"],i={meta:{}},o=t.shimExec.call(this,"Image","getInfo");return o.meta&&e.each(n,function(t){var e,n,r,a,s=o.meta[t];if(s&&s.keys)for(i.meta[t]={},n=0,r=s.keys.length;r>n;n++)e=s.keys[n],a=s[e],a&&(/^(\d|[1-9]\d+)$/.test(a)?a=parseInt(a,10):/^\d*\.\d+$/.test(a)&&(a=parseFloat(a)),i.meta[t][e]=a)}),i.width=parseInt(o.width,10),i.height=parseInt(o.height,10),i.size=parseInt(o.size,10),i.type=o.type,i.name=o.name,i}})}),i(st,[s,d,m,l],function(t,e,n,i){function o(e){var o=this,s=n.capTest,u=n.capTrue;n.call(this,e,r,{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s(a.Image&&(i.can("create_canvas")||i.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),resize_image:function(){return a.Image&&o.can("access_binary")&&i.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(e){return!("json"!==e||!window.JSON)||!!~t.inArray(e,["text","document",""])},return_status_code:function(e){return!t.arrayDiff(e,[200,404])},select_file:function(){return i.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return o.can("select_file")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||!!~t.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:u,use_http_method:function(e){return!t.arrayDiff(e,["GET","POST"])}}),t.extend(this,{init:function(){this.trigger("Init")},destroy:function(t){return function(){t.call(o),t=o=null}}(this.destroy)}),t.extend(this.getShim(),a)}var r="html4",a={};return n.addConstructor(r,o),a}),i(ut,[st,s,p,R,c,l],function(t,e,n,i,o,r){function a(){function t(){var o,l,p,d,f,h,m=this,g=m.getRuntime();h=e.guid("uid_"),o=g.getShimContainer(),a&&(p=n.get(a+"_form"),p&&e.extend(p.style,{top:"100%"})),d=document.createElement("form"),d.setAttribute("id",h+"_form"),d.setAttribute("method","post"),d.setAttribute("enctype","multipart/form-data"),d.setAttribute("encoding","multipart/form-data"),e.extend(d.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),f=document.createElement("input"),f.setAttribute("id",h),f.setAttribute("type","file"),f.setAttribute("name",s.name||"Filedata"),f.setAttribute("accept",c.join(",")),e.extend(f.style,{fontSize:"999px",opacity:0}),d.appendChild(f),o.appendChild(d),e.extend(f.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===r.browser&&r.version<10&&e.extend(f.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),f.onchange=function(){var e;this.value&&(e=this.files?this.files[0]:{name:this.value},u=[e],this.onchange=function(){},t.call(m),m.bind("change",function i(){var t,e=n.get(h),o=n.get(h+"_form");m.unbind("change",i),m.files.length&&e&&o&&(t=m.files[0],e.setAttribute("id",t.uid),o.setAttribute("id",t.uid+"_form"),o.setAttribute("target",t.uid+"_iframe")),e=o=null},998),f=d=null,m.trigger("change"))},g.can("summon_file_dialog")&&(l=n.get(s.browse_button),i.removeEvent(l,"click",m.uid),i.addEvent(l,"click",function(t){f&&!f.disabled&&f.click(),t.preventDefault()},m.uid)),a=h,o=p=l=null}var a,s,u=[],c=[];e.extend(this,{init:function(e){var r,a=this,u=a.getRuntime();s=e,c=e.accept.mimes||o.extList2mimes(e.accept,u.can("filter_by_extension")),r=u.getShimContainer(),function(){var t,o,s;t=n.get(e.browse_button),u.can("summon_file_dialog")&&("static"===n.getStyle(t,"position")&&(t.style.position="relative"),o=parseInt(n.getStyle(t,"z-index"),10)||1,t.style.zIndex=o,r.style.zIndex=o-1),s=u.can("summon_file_dialog")?t:r,i.addEvent(s,"mouseover",function(){a.trigger("mouseenter")},a.uid),i.addEvent(s,"mouseout",function(){a.trigger("mouseleave")},a.uid),i.addEvent(s,"mousedown",function(){a.trigger("mousedown")},a.uid),i.addEvent(n.get(e.container),"mouseup",function(){a.trigger("mouseup")},a.uid),t=null}(),t.call(this),r=null,a.trigger({type:"ready",async:!0})},getFiles:function(){return u},disable:function(t){var e;(e=n.get(a))&&(e.disabled=!!t)},destroy:function(){var t=this.getRuntime(),e=t.getShim(),o=t.getShimContainer();i.removeAllEvents(o,this.uid),i.removeAllEvents(s&&n.get(s.container),this.uid),i.removeAllEvents(s&&n.get(s.browse_button),this.uid),o&&(o.innerHTML=""),e.removeInstance(this.uid),a=u=c=s=o=e=null}})}return t.FileInput=a}),i(ct,[st,q],function(t,e){return t.FileReader=e}),i(lt,[st,s,p,j,d,R,v,E],function(t,e,n,i,o,r,a,s){function u(){function t(t){var e,i,o,a,s=this,u=!1;if(l){if(e=l.id.replace(/_iframe$/,""),i=n.get(e+"_form")){for(o=i.getElementsByTagName("input"),a=o.length;a--;)switch(o[a].getAttribute("type")){case"hidden":o[a].parentNode.removeChild(o[a]);break;case"file":u=!0}o=[],u||i.parentNode.removeChild(i),i=null}setTimeout(function(){r.removeEvent(l,"load",s.uid),l.parentNode&&l.parentNode.removeChild(l);var e=s.getRuntime().getShimContainer();e.children.length||e.parentNode.removeChild(e),e=l=null,t()},1)}}var u,c,l;e.extend(this,{send:function(p,d){function f(){var n=_.getShimContainer()||document.body,o=document.createElement("div");o.innerHTML='<iframe id="'+h+'_iframe" name="'+h+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',l=o.firstChild,n.appendChild(l),r.addEvent(l,"load",function(){var n;try{n=l.contentWindow.document||l.contentDocument||window.frames[l.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(n.title)?u=n.title.replace(/^(\d+).*$/,"$1"):(u=200,c=e.trim(n.body.innerHTML),y.trigger({type:"progress",loaded:c.length,total:c.length}),v&&y.trigger({type:"uploadprogress",loaded:v.size||1025,total:v.size||1025}))}catch(o){if(!i.hasSameOrigin(p.url))return void t.call(y,function(){y.trigger("error")});u=404}t.call(y,function(){y.trigger("load")})},y.uid)}var h,m,g,v,y=this,_=y.getRuntime();if(u=c=null,d instanceof s&&d.hasBlob()){if(v=d.getBlob(),h=v.uid,g=n.get(h),m=n.get(h+"_form"),!m)throw new o.DOMException(o.DOMException.NOT_FOUND_ERR)}else h=e.guid("uid_"),m=document.createElement("form"),m.setAttribute("id",h+"_form"),m.setAttribute("method",p.method),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),m.setAttribute("target",h+"_iframe"),_.getShimContainer().appendChild(m);d instanceof s&&d.each(function(t,n){if(t instanceof a)g&&g.setAttribute("name",n);else{var i=document.createElement("input");e.extend(i,{type:"hidden",name:n,value:t}),g?m.insertBefore(i,g):m.appendChild(i)}}),m.setAttribute("action",p.url),f(),m.submit(),y.trigger("loadstart")},getStatus:function(){return u},getResponse:function(t){if("json"===t&&"string"===e.typeOf(c)&&window.JSON)try{return JSON.parse(c.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(n){return null}return c},abort:function(){var e=this;l&&l.contentWindow&&(l.contentWindow.stop?l.contentWindow.stop():l.contentWindow.document.execCommand?l.contentWindow.document.execCommand("Stop"):l.src="about:blank"),t.call(this,function(){e.dispatchEvent("abort")})}})}return t.XMLHttpRequest=u}),i(pt,[st,B],function(t,e){return t.Image=e}),r([s,u,c,l,p,d,f,h,m,g,v,y,_,b,x,w,j,k,E,C,T,S,R])}(this),function(){"use strict";var t={},e=moxie.core.utils.Basic.inArray;return function n(i){var o,r;for(o in i)r=typeof i[o],"object"!==r||~e(o,["Exceptions","Env","Mime"])?"function"===r&&(t[o]=i[o]):n(i[o])}(window.moxie),t.Env=window.moxie.core.utils.Env,t.Mime=window.moxie.core.utils.Mime,t.Exceptions=window.moxie.core.Exceptions,window.mOxie=t,window.o||(window.o=t),t}(),function(t,e,n){function i(t){function e(t,e,n){var o={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};o[t]?i[o[t]]=e:n||(i[t]=e)}var n=t.required_features,i={};return"string"==typeof n?a.each(n.split(/\s*,\s*/),function(t){e(t,!0)}):"object"==typeof n?a.each(n,function(t,n){e(n,t)}):n===!0&&(t.multipart||(i.send_binary_string=!0),t.chunk_size>0&&(i.slice_blob=!0),t.resize.enabled&&(i.send_binary_string=!0),a.each(t,function(t,n){e(n,!!t,!0)})),i}var o=t.setTimeout,r={},a={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:e.mimes,ua:e.ua,typeOf:e.typeOf,extend:e.extend,guid:e.guid,get:function(t){var n,i=[];"array"!==e.typeOf(t)&&(t=[t]);for(var o=t.length;o--;)n=e.get(t[o]),n&&i.push(n);return i.length?i:null},each:e.each,getPos:e.getPos,getSize:e.getSize,xmlEncode:function(t){var e={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},n=/[<>&\"\']/g;return t?(""+t).replace(n,function(t){return e[t]?"&"+e[t]+";":t}):t},toArray:e.toArray,inArray:e.inArray,addI18n:e.addI18n,translate:e.translate,isEmptyObj:e.isEmptyObj,hasClass:e.hasClass,addClass:e.addClass,removeClass:e.removeClass,getStyle:e.getStyle,addEvent:e.addEvent,removeEvent:e.removeEvent,removeAllEvents:e.removeAllEvents,cleanName:function(t){var e,n;for(n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],e=0;e<n.length;e+=2)t=t.replace(n[e],n[e+1]);return t=t.replace(/\s+/g,"_"),t=t.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(t,e){var n="";return a.each(e,function(t,e){n+=(n?"&":"")+encodeURIComponent(e)+"="+encodeURIComponent(t)}),n&&(t+=(t.indexOf("?")>0?"&":"?")+n),t},formatSize:function(t){function e(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}if(t===n||/\D/.test(t))return a.translate("N/A");var i=Math.pow(1024,4);return t>i?e(t/i,1)+" "+a.translate("tb"):t>(i/=1024)?e(t/i,1)+" "+a.translate("gb"):t>(i/=1024)?e(t/i,1)+" "+a.translate("mb"):t>1024?Math.round(t/1024)+" "+a.translate("kb"):t+" "+a.translate("b")},parseSize:e.parseSizeStr,predictRuntime:function(t,n){var i,o;return i=new a.Uploader(t),o=e.Runtime.thatCan(i.getOption().required_features,n||t.runtimes),i.destroy(),o},addFileFilter:function(t,e){r[t]=e}};a.addFileFilter("mime_types",function(t,e,n){t.length&&!t.regexp.test(e.name)?(this.trigger("Error",{code:a.FILE_EXTENSION_ERROR,message:a.translate("File extension error."),file:e}),n(!1)):n(!0)}),a.addFileFilter("max_file_size",function(t,e,n){var i;t=a.parseSize(t),e.size!==i&&t&&e.size>t?(this.trigger("Error",{code:a.FILE_SIZE_ERROR,message:a.translate("File size error."),file:e}),n(!1)):n(!0)}),a.addFileFilter("prevent_duplicates",function(t,e,n){if(t)for(var i=this.files.length;i--;)if(e.name===this.files[i].name&&e.size===this.files[i].size)return this.trigger("Error",{code:a.FILE_DUPLICATE_ERROR,message:a.translate("Duplicate file error."),file:e}),void n(!1);n(!0)}),a.Uploader=function(t){function s(){var t,e,n=0;if(this.state==a.STARTED){for(e=0;e<$.length;e++)t||$[e].status!=a.QUEUED?n++:(t=$[e],this.trigger("BeforeUpload",t)&&(t.status=a.UPLOADING,this.trigger("UploadFile",t)));n==$.length&&(this.state!==a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",$))}}function u(t){t.percent=t.size>0?Math.ceil(t.loaded/t.size*100):100,c()}function c(){var t,e;for(T.reset(),t=0;t<$.length;t++)e=$[t],e.size!==n?(T.size+=e.origSize,T.loaded+=e.loaded*e.origSize/e.size):T.size=n,e.status==a.DONE?T.uploaded++:e.status==a.FAILED?T.failed++:T.queued++;T.size===n?T.percent=$.length>0?Math.ceil(T.uploaded/$.length*100):0:(T.bytesPerSec=Math.ceil(T.loaded/((+new Date-C||1)/1e3)),T.percent=T.size>0?Math.ceil(T.loaded/T.size*100):0)}function l(){var t=O[0]||I[0];return!!t&&t.getRuntime().uid}function p(t,n){if(t.ruid){var i=e.Runtime.getInfo(t.ruid);if(i)return i.can(n)}return!1}function d(){this.bind("FilesAdded",g),this.bind("CancelUpload",x),this.bind("BeforeUpload",v),this.bind("UploadFile",y),this.bind("UploadProgress",_),this.bind("StateChanged",b),this.bind("QueueChanged",c),this.bind("Error",j),this.bind("FileUploaded",w),this.bind("Destroy",k)}function f(t,n){var i=this,o=0,r=[],s={accept:t.filters.mime_types,runtime_order:t.runtimes,required_caps:t.required_features,preferred_caps:R,swf_url:t.flash_swf_url,xap_url:t.silverlight_xap_url};a.each(t.runtimes.split(/\s*,\s*/),function(e){t[e]&&(s[e]=t[e])}),t.browse_button&&a.each(t.browse_button,function(n){r.push(function(r){var u=new e.FileInput(a.extend({},s,{name:t.file_data_name,multiple:t.multi_selection,container:t.container,browse_button:n}));u.onready=function(){var t=e.Runtime.getInfo(this.ruid);e.extend(i.features,{chunks:t.can("slice_blob"),multipart:t.can("send_multipart"),multi_selection:t.can("select_multiple")}),o++,O.push(this),r()},u.onchange=function(){i.addFile(this.files)},u.bind("mouseenter mouseleave mousedown mouseup",function(i){q||(t.browse_button_hover&&("mouseenter"http://common1.qyerstatic.com/place/js/common/===i.type?e.addClass(n,t.browse_button_hover):"mouseleave"===i.type&&e.removeClass(n,t.browse_button_hover)),t.browse_button_active&&("mousedown"http://common1.qyerstatic.com/place/js/common/===i.type?e.addClass(n,t.browse_button_active):"mouseup"===i.type&&e.removeClass(n,t.browse_button_active)))}),u.bind("error runtimeerror",function(){u=null,r()}),u.init()})}),t.drop_element&&a.each(t.drop_element,function(t){r.push(function(n){var r=new e.FileDrop(a.extend({},s,{drop_zone:t}));r.onready=function(){var t=e.Runtime.getInfo(this.ruid);i.features.dragdrop=t.can("drag_and_drop"),o++,I.push(this),n()},r.ondrop=function(){i.addFile(this.files)},r.bind("error runtimeerror",function(){r=null,n()}),r.init()})}),e.inSeries(r,function(){"function"==typeof n&&n(o)})}function h(t,n,i){var o=new e.Image;try{o.onload=function(){o.downsize(n.width,n.height,n.crop,n.preserve_headers)},o.onresize=function(){i(this.getAsBlob(t.type,n.quality)),this.destroy()},o.onerror=function(){i(t)},o.load(t)}catch(r){i(t)}}function m(t,n,o){function r(t,e,n){var i=E[t];switch(t){case"max_file_size":"max_file_size"===t&&(E.max_file_size=E.filters.max_file_size=e);break;case"chunk_size":(e=a.parseSize(e))&&(E[t]=e);break;case"filters":"array"===a.typeOf(e)&&(e={mime_types:e}),n?a.extend(E.filters,e):E.filters=e,e.mime_types&&(E.filters.mime_types.regexp=function(t){var e=[];return a.each(t,function(t){a.each(t.extensions.split(/,/),function(t){/^\s*\*\s*$/.test(t)?e.push("\\.*"):e.push("\\."+t.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+e.join("|")+")$","i")}(E.filters.mime_types));break;case"resize":n?a.extend(E.resize,e,{enabled:!0}):E.resize=e;break;case"prevent_duplicates":E.prevent_duplicates=E.filters.prevent_duplicates=!!e;break;case"browse_button":case"drop_element":e=a.get(e);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":E[t]=e,n||(u=!0);break;default:E[t]=e}n||s.trigger("OptionChanged",t,e,i)}var s=this,u=!1;"object"==typeof t?a.each(t,function(t,e){r(e,t,o)}):r(t,n,o),o?(E.required_features=i(a.extend({},E)),R=i(a.extend({},E,{required_features:!0}))):u&&(s.trigger("Destroy"),f.call(s,E,function(t){t?(s.runtime=e.Runtime.getInfo(l()).type,s.trigger("Init",{runtime:s.runtime}),s.trigger("PostInit")):s.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}))}function g(t,e){[].push.apply($,e),t.trigger("QueueChanged"),t.refresh()}function v(t,e){if(E.unique_names){var n=e.name.match(/\.([^.]+)$/),i="part";n&&(i=n[1]),e.target_name=e.id+"."+i}}function y(t,n){function i(){l-- >0?o(r,1e3):(n.loaded=f,t.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:n,response:S.responseText,status:S.status,responseHeaders:S.getAllResponseHeaders()}))}function r(){var p,h,m,g;n.status!=a.DONE&&n.status!=a.FAILED&&t.state!=a.STOPPED&&(m={name:n.target_name||n.name},c&&d.chunks&&s.size>c?(g=Math.min(c,s.size-f),p=s.slice(f,f+g)):(g=s.size,p=s),c&&d.chunks&&(t.settings.send_chunk_number?(m.chunk=Math.ceil(f/c),m.chunks=Math.ceil(s.size/c)):(m.offset=f,m.total=s.size)),S=new e.XMLHttpRequest,S.upload&&(S.upload.onprogress=function(e){n.loaded=Math.min(n.size,f+e.loaded),t.trigger("UploadProgress",n)}),S.onload=function(){return S.status>=400?void i():(l=t.settings.max_retries,g<s.size?(p.destroy(),f+=g,n.loaded=Math.min(f,s.size),t.trigger("ChunkUploaded",n,{offset:n.loaded,total:s.size,response:S.responseText,status:S.status,responseHeaders:S.getAllResponseHeaders()}),"Android Browser"===e.Env.browser&&t.trigger("UploadProgress",n)):n.loaded=n.size,p=h=null,!f||f>=s.size?(n.size!=n.origSize&&(s.destroy(),s=null),t.trigger("UploadProgress",n),n.status=a.DONE,t.trigger("FileUploaded",n,{response:S.responseText,status:S.status,responseHeaders:S.getAllResponseHeaders()})):o(r,1),void 0)},S.onerror=function(){i()},S.onloadend=function(){this.destroy(),S=null},t.settings.multipart&&d.multipart?(m.name=n.target_name||n.name,S.open("post",u,!0),a.each(t.settings.headers,function(t,e){S.setRequestHeader(e,t)}),h=new e.FormData,a.each(a.extend(m,t.settings.multipart_params),function(t,e){h.append(e,t)}),h.append(t.settings.file_data_name,p),S.send(h,{runtime_order:t.settings.runtimes,required_caps:t.settings.required_features,preferred_caps:R,swf_url:t.settings.flash_swf_url,xap_url:t.settings.silverlight_xap_url})):(u=a.buildUrl(t.settings.url,a.extend(m,t.settings.multipart_params)),S.open("post",u,!0),S.setRequestHeader("Content-Type","application/octet-stream"),a.each(t.settings.headers,function(t,e){S.setRequestHeader(e,t)}),S.send(p,{runtime_order:t.settings.runtimes,required_caps:t.settings.required_features,preferred_caps:R,swf_url:t.settings.flash_swf_url,xap_url:t.settings.silverlight_xap_url})))}var s,u=t.settings.url,c=t.settings.chunk_size,l=t.settings.max_retries,d=t.features,f=0;n.loaded&&(f=n.loaded=c*Math.floor(n.loaded/c)),s=n.getSource(),t.settings.resize.enabled&&p(s,"send_binary_string")&&~e.inArray(s.type,["image/jpeg","image/png"])?h.call(this,s,t.settings.resize,function(t){s=t,n.size=t.size,r()}):r()}function _(t,e){u(e)}function b(t){if(t.state==a.STARTED)C=+new Date;else if(t.state==a.STOPPED)for(var e=t.files.length-1;e>=0;e--)t.files[e].status==a.UPLOADING&&(t.files[e].status=a.QUEUED,c())}function x(){S&&S.abort()}function w(t){c(),o(function(){s.call(t)},1)}function j(t,e){e.file&&(e.file.status=a.FAILED,u(e.file),t.state==a.STARTED&&(t.trigger("CancelUpload"),o(function(){s.call(t)},1)))}function k(t){t.stop(),a.each($,function(t){t.destroy()}),$=[],O.length&&(a.each(O,function(t){t.destroy()}),O=[]),I.length&&(a.each(I,function(t){t.destroy()}),I=[]),R={},q=!1,C=S=null,T.reset()}var E,C,T,S,A=a.guid(),$=[],R={},O=[],I=[],q=!1;E={runtimes:e.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf"/*tpa=http://common1.qyerstatic.com/place/js/common/js/Moxie.swf*/,silverlight_xap_url:"http://common1.qyerstatic.com/place/js/common/js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_chunk_number:!0},m.call(this,t,null,!0),T=new a.QueueProgress,a.extend(this,{id:A,uid:A,state:a.STOPPED,features:{},runtime:null,files:$,settings:E,total:T,init:function(){var t=this;return"function"==typeof E.preinit?E.preinit(t):a.each(E.preinit,function(e,n){t.bind(n,e)}),E.browse_button&&E.url?(d.call(this),void f.call(this,E,function(n){"function"==typeof E.init?E.init(t):a.each(E.init,function(e,n){t.bind(n,e)}),n?(t.runtime=e.Runtime.getInfo(l()).type,t.trigger("Init",{runtime:t.runtime}),t.trigger("PostInit")):t.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})})):void this.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})},setOption:function(t,e){m.call(this,t,e,!this.runtime);
},getOption:function(t){return t?E[t]:E},refresh:function(){O.length&&a.each(O,function(t){t.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=a.STARTED&&(this.state=a.STARTED,this.trigger("StateChanged"),s.call(this))},stop:function(){this.state!=a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){q=arguments[0]===n||arguments[0],O.length&&a.each(O,function(t){t.disable(q)}),this.trigger("DisableBrowse",q)},getFile:function(t){var e;for(e=$.length-1;e>=0;e--)if($[e].id===t)return $[e]},addFile:function(t,n){function i(t,n){var i=[];e.each(c.settings.filters,function(e,n){r[n]&&i.push(function(i){r[n].call(c,e,t,function(t){i(!t)})})}),e.inSeries(i,n)}function s(t){var r=e.typeOf(t);if(t instanceof e.File){if(!t.ruid&&!t.isDetached()){if(!u)return!1;t.ruid=u,t.connectRuntime(u)}s(new a.File(t))}else t instanceof e.Blob?(s(t.getSource()),t.destroy()):t instanceof a.File?(n&&(t.name=n),p.push(function(e){i(t,function(n){n||(d.push(t),c.trigger("FileFiltered",t)),o(e,1)})})):e.inArray(r,["file","blob"])!==-1?s(new e.File(null,t)):"node"===r&&"filelist"===e.typeOf(t.files)?e.each(t.files,s):"array"===r&&(n=null,e.each(t,s))}var u,c=this,p=[],d=[];u=l(),s(t),p.length&&e.inSeries(p,function(){d.length&&c.trigger("FilesAdded",d)})},removeFile:function(t){for(var e="string"==typeof t?t:t.id,n=$.length-1;n>=0;n--)if($[n].id===e)return this.splice(n,1)[0]},splice:function(t,e){var i=$.splice(t===n?0:t,e===n?$.length:e),o=!1;return this.state==a.STARTED&&(o=!0,this.stop()),this.trigger("FilesRemoved",i),a.each(i,function(t){t.destroy()}),this.trigger("QueueChanged"),this.refresh(),o&&this.start(),i},bind:function(t,e,n){var i=this;a.Uploader.prototype.bind.call(this,t,function(){var t=[].slice.call(arguments);return t.splice(0,1,i),e.apply(this,t)},0,n)},destroy:function(){this.trigger("Destroy"),E=T=null,this.unbindAll()}})},a.Uploader.prototype=e.EventTarget.instance,a.File=function(){function t(t){a.extend(this,{id:a.guid(),name:t.name||t.fileName,type:t.type||"",size:t.size||t.fileSize,origSize:t.size||t.fileSize,loaded:0,percent:0,status:a.QUEUED,lastModifiedDate:t.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var t=this.getSource().getSource();return e.inArray(e.typeOf(t),["blob","file"])!==-1?t:null},getSource:function(){return n[this.id]?n[this.id]:null},destroy:function(){var t=this.getSource();t&&(t.destroy(),delete n[this.id])}}),n[this.id]=t}var n={};return t}(),a.QueueProgress=function(){var t=this;t.size=0,t.loaded=0,t.uploaded=0,t.failed=0,t.queued=0,t.percent=0,t.bytesPerSec=0,t.reset=function(){t.size=t.loaded=t.uploaded=t.failed=t.queued=t.percent=t.bytesPerSec=0}},t.plupload=a}(window,mOxie),define("plupload",function(){}),!function(global){function createCookie(t,e,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="; expires="+i.toGMTString();document.cookie=t+"="+e+o+"; path=/"}function readCookie(t){for(var e=t+"=",n=document.cookie.split(";"),i=0,o=n.length;i<o;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null}function QiniuJsSDK(){function log(t,e){for(var n="[qiniu-js-sdk]["+t+"]",i=n,o=0;o<e.length;o++)i+="string"==typeof e[o]?" "+e[o]:" "+that.stringifyJSON(e[o]);that.detectIEVersion()?console.log(i):(e.unshift(n),console.log.apply(console,e)),document.getElementById("qiniu-js-sdk-log")&&(document.getElementById("qiniu-js-sdk-log").innerHTML+="<p>"+i+"</p>")}function makeLogFunc(t){var e=t.toLowerCase();logger[e]=function(){if(window.console&&window.console.log&&logger.level>=logger[t]){var n=Array.prototype.slice.call(arguments);log(e,n)}}}var that=this;this.detectIEVersion=function(){for(var t=4,e=document.createElement("div"),n=e.getElementsByTagName("i");e.innerHTML="<!--[if gt IE "+t+"]><i></i><![endif]-->",n[0];)t++;return t>4&&t};var logger={MUTE:0,FATA:1,ERROR:2,WARN:3,INFO:4,DEBUG:5,TRACE:6,level:0};for(var property in logger)logger.hasOwnProperty(property)&&"number"==typeof logger[property]&&!logger.hasOwnProperty(property.toLowerCase())&&makeLogFunc(property);var qiniuUploadUrl;qiniuUploadUrl="https:"===window.location.protocol?"https://up.qbox.me":"http://upload.qiniu.com/";var qiniuUploadUrls=["http://upload.qiniu.com/","http://up.qiniu.com/"],qiniuUpHosts={http:["http://upload.qiniu.com/","http://up.qiniu.com/"],https:["https://up.qbox.me"]},changeUrlTimes=0;this.resetUploadUrl=function(){var t="https:"===window.location.protocol?qiniuUpHosts.https:qiniuUpHosts.http,e=changeUrlTimes%t.length;qiniuUploadUrl=t[e],changeUrlTimes++,logger.debug("resetUploadUrl: "+qiniuUploadUrl)},this.isImage=function(t){return t=t.split(/[?#]/)[0],/\.(png|jpg|jpeg|gif|bmp)$/i.test(t)},this.getFileExtension=function(t){var e,n=t.split(".");return e=1===n.length||""===n[0]&&2===n.length?"":n.pop().toLowerCase()},this.utf8_encode=function(t){if(null===t||"undefined"==typeof t)return"";var e,n,i=t+"",o="",r=0;e=n=0,r=i.length;for(var a=0;a<r;a++){var s=i.charCodeAt(a),u=null;if(s<128)n++;else if(s>127&&s<2048)u=String.fromCharCode(s>>6|192,63&s|128);else if(63488&s^!0)u=String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128);else{if(64512&s^!0)throw new RangeError("Unmatched trail surrogate at "+a);var c=i.charCodeAt(++a);if(64512&c^!0)throw new RangeError("Unmatched lead surrogate at "+(a-1));s=((1023&s)<<10)+(1023&c)+65536,u=String.fromCharCode(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}null!==u&&(n>e&&(o+=i.slice(e,n)),o+=u,e=n=a+1)}return n>e&&(o+=i.slice(e,r)),o},this.base64_decode=function(t){var e,n,i,o,r,a,s,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,p=0,d="",f=[];if(!t)return t;t+="";do o=c.indexOf(t.charAt(l++)),r=c.indexOf(t.charAt(l++)),a=c.indexOf(t.charAt(l++)),s=c.indexOf(t.charAt(l++)),u=o<<18|r<<12|a<<6|s,e=u>>16&255,n=u>>8&255,i=255&u,64===a?f[p++]=String.fromCharCode(e):64===s?f[p++]=String.fromCharCode(e,n):f[p++]=String.fromCharCode(e,n,i);while(l<t.length);return d=f.join("")},this.base64_encode=function(t){var e,n,i,o,r,a,s,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,p=0,d="",f=[];if(!t)return t;t=this.utf8_encode(t+"");do e=t.charCodeAt(l++),n=t.charCodeAt(l++),i=t.charCodeAt(l++),u=e<<16|n<<8|i,o=u>>18&63,r=u>>12&63,a=u>>6&63,s=63&u,f[p++]=c.charAt(o)+c.charAt(r)+c.charAt(a)+c.charAt(s);while(l<t.length);switch(d=f.join(""),t.length%3){case 1:d=d.slice(0,-2)+"==";break;case 2:d=d.slice(0,-1)+"="}return d},this.URLSafeBase64Encode=function(t){return t=this.base64_encode(t),t.replace(/\//g,"_").replace(/\+/g,"-")},this.URLSafeBase64Decode=function(t){return t=t.replace(/_/g,"/").replace(/-/g,"+"),this.base64_decode(t)},this.createAjax=function(t){var e={};return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);var rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,text=String(data);return rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),eval("("+text+")")},this.stringifyJSON=function(t){if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(t);switch(typeof t){case"string":return'"'+t.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+t.map(that.stringifyJSON).join(",")+"]";case"object":if(t instanceof Array){for(var e=[],n=t.length,i=0;i<n;i++)e.push(that.stringifyJSON(t[i]));return"["+e.join(",")+"]"}if(null===t)return"null";var o=[];for(var r in t)t.hasOwnProperty(r)&&o.push(that.stringifyJSON(r)+":"+that.stringifyJSON(t[r]));return"{"+o.join(",")+"}";case"number":return t;case!1:return t;case"boolean":return t}},this.trim=function(t){return null===t?"":t.replace(/^\s+|\s+$/g,"")},this.uploader=function(t){var e=function(){var e,n,i,o=that.detectIEVersion(),r="Safari"===mOxie.Env.browser&&mOxie.Env.version<=5&&"Windows"===mOxie.Env.os&&"7"===mOxie.Env.osVersion||"Safari"===mOxie.Env.browser&&"iOS"===mOxie.Env.os&&"7"===mOxie.Env.osVersion;o&&o<9&&t.chunk_size&&t.runtimes.indexOf("flash")>=0?t.chunk_size=0:r?t.chunk_size=0:(e=20,n=4<<e,i=plupload.parseSize(t.chunk_size),i>n&&(t.chunk_size=n))},n=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];0===i.indexOf("-H")?e.push(i.split(" ")[2]):e.push(i)}return e},i=function(t){var e=t.split(":"),n=e[0],i=that.parseJSON(that.URLSafeBase64Decode(e[2]));return i.ak=n,i.scope.indexOf(":")>=0?(i.bucket=i.scope.split(":")[0],i.key=i.scope.split(":")[1]):i.bucket=i.scope,i},o=function(e){var o=i(e),r=window.location.protocol+"//uc.qbox.me/v1/query?ak="+o.ak+"&bucket="+o.bucket;logger.debug("putPolicy: ",o),logger.debug("get uphosts from: ",r);var a,s=that.detectIEVersion();s&&s<=9?(a=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=t.flash_swf_url):a=that.createAjax(),a.open("GET",r,!0);var u=function(){if(logger.debug("ajax.readyState: ",a.readyState),4===a.readyState)if(logger.debug("ajax.status: ",a.status),a.status<400){var t=that.parseJSON(a.responseText);qiniuUpHosts.http=n(t.http.up),qiniuUpHosts.https=n(t.https.up),logger.debug("get new uphosts: ",qiniuUpHosts),that.resetUploadUrl()}else logger.error("get uphosts error: ",a.responseText)};s&&s<=9?a.bind("readystatechange",u):a.onreadystatechange=u,a.send()},r=function(e){return!that.token||t.uptoken_url&&that.tokenInfo.isExpired()?a(e):that.token},a=function(e){if(t.uptoken)that.token=t.uptoken;else if(t.uptoken_url){logger.debug("get uptoken from: ",that.uptoken_url);var n=that.createAjax();if(n.open("GET",that.uptoken_url,!1),n.setRequestHeader("If-Modified-Since","0"),n.send(),200===n.status){var i=that.parseJSON(n.responseText);that.token=i.uptoken;var r=that.token.split(":"),a=that.parseJSON(that.URLSafeBase64Decode(r[2]));that.tokenMap||(that.tokenMap={});var s=function(t){return Math.ceil(t.getTime()/1e3)},u=s(new Date(n.getResponseHeader("date"))),c=s(new Date);that.tokenInfo={serverDelay:c-u,deadline:a.deadline,isExpired:function(){var t=this.deadline-s(new Date)+this.serverDelay;return t<600}},logger.debug("get new uptoken: ",that.token),logger.debug("get token info: ",that.tokenInfo)}else logger.error("get uptoken error: ",n.responseText)}else t.uptoken_func?(logger.debug("get uptoken from uptoken_func"),that.token=t.uptoken_func(e),logger.debug("get new uptoken: ",that.token)):logger.error("one of [uptoken, uptoken_url, uptoken_func] settings in options is required!");return that.token&&o(that.token),that.token},s=function(e,n,i){var o="",r=!1;if(!t.save_key)if(r=e.getOption&&e.getOption("unique_names"),r=r||e.settings&&e.settings.unique_names){var a=that.getFileExtension(n.name);o=a?n.id+"."+a:n.id}else o="function"==typeof i?i(e,n):n.name;return o};if(t.log_level&&(logger.level=t.log_level),!t.domain)throw"domain setting in options is required!";if(!t.browse_button)throw"browse_button setting in options is required!";if(!t.uptoken&&!t.uptoken_url&&!t.uptoken_func)throw"one of [uptoken, uptoken_url, uptoken_func] settings in options is required!";logger.debug("init uploader start"),logger.debug("environment: ",mOxie.Env),logger.debug("userAgent: ",navigator.userAgent);var u={},c=t.init&&t.init.Error,l=t.init&&t.init.FileUploaded;t.init.Error=function(){},t.init.FileUploaded=function(){},that.uptoken_url=t.uptoken_url,that.token="",that.key_handler="function"http://common1.qyerstatic.com/place/js/common/==typeof t.init.Key?t.init.Key:"",this.domain=t.domain;var p="",d={isResumeUpload:!1,resumeFilesize:0,startTime:"",currentTime:""};e(),logger.debug("invoke reset_chunk_size()"),logger.debug("op.chunk_size: ",t.chunk_size);var f={url:qiniuUploadUrl,multipart_params:{token:""}},h=that.detectIEVersion();h&&h<=9&&(f.multipart_params.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),plupload.extend(u,t,f),logger.debug("option: ",u);var m=new plupload.Uploader(u);logger.debug("new plupload.Uploader(option)"),m.bind("Init",function(e,n){logger.debug("Init event activated"),t.get_new_uptoken||a(null)}),logger.debug("bind Init event"),m.bind("FilesAdded",function(t,e){logger.debug("FilesAdded event activated");var n=t.getOption&&t.getOption("auto_start");n=n||t.settings&&t.settings.auto_start,logger.debug("auto_start: ",n),logger.debug("files: ",e);var i=function(){return"ios"===mOxie.Env.OS.toLowerCase()};if(i())for(var o=0;o<e.length;o++){var r=e[o],a=that.getFileExtension(r.name);r.name=r.id+"."+a}n&&setTimeout(function(){t.start(),logger.debug("invoke up.start()")},0),t.refresh()}),logger.debug("bind FilesAdded event"),m.bind("BeforeUpload",function(e,n){logger.debug("BeforeUpload event activated"),n.speed=n.speed||0,p="",t.get_new_uptoken&&a(n);var i=function(e,n,i){d.startTime=(new Date).getTime();var r;r=t.save_key?{token:that.token}:{key:s(e,n,i),token:that.token};var a=that.detectIEVersion();a&&a<=9&&(r.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),logger.debug("directUpload multipart_params_obj: ",r);var u=t.x_vars;if(void 0!==u&&"object"==typeof u)for(var c in u)u.hasOwnProperty(c)&&("function"==typeof u[c]?r["x:"+c]=u[c](e,n):"object"!=typeof u[c]&&(r["x:"+c]=u[c]));e.setOption({url:qiniuUploadUrl,multipart:!0,chunk_size:o()?t.max_file_size:void 0,multipart_params:r})},o=function(){var t=navigator.userAgent.toLowerCase();return!(!t.match(/MicroMessenger/i)&&"QQBrowser"!==mOxie.Env.browser&&!t.match(/V1_AND_SQ/i)||"android"!==mOxie.Env.OS.toLowerCase())},u=e.getOption&&e.getOption("chunk_size");if(u=u||e.settings&&e.settings.chunk_size,logger.debug("uploader.runtime: ",m.runtime),logger.debug("chunk_size: ",u),"html5"!==m.runtime&&"flash"!==m.runtime||!u)logger.debug("directUpload because uploader.runtime !== 'html5' || uploader.runtime !== 'flash' || !chunk_size"),i(e,n,that.key_handler);else if(n.size<u||o())logger.debug("directUpload because file.size < chunk_size || is_android_weixin_or_qq()"),i(e,n,that.key_handler);else{var c=localStorage.getItem(n.name),l=u;if(c){c=that.parseJSON(c);var f=(new Date).getTime(),h=c.time||0,g=864e5;f-h<g&&100!==c.percent&&n.size===c.total?(n.percent=c.percent,n.loaded=c.offset,p=c.ctx,d.isResumeUpload=!0,d.resumeFilesize=c.offset,c.offset+l>n.size&&(l=n.size-c.offset)):localStorage.removeItem(n.name)}d.startTime=(new Date).getTime();var v={},y=that.detectIEVersion();y&&y<=9&&(v.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),e.setOption({url:qiniuUploadUrl+"/mkblk/"+l,multipart:!1,chunk_size:u,required_features:"chunks",headers:{Authorization:"UpToken "+r(n)},multipart_params:v})}}),logger.debug("bind BeforeUpload event"),m.bind("UploadProgress",function(t,e){logger.trace("UploadProgress event activated"),d.currentTime=(new Date).getTime();var n=d.currentTime-d.startTime,i=e.loaded||0;d.isResumeUpload&&(i=e.loaded-d.resumeFilesize),e.speed=(i/n*1e3).toFixed(0)||0}),logger.debug("bind UploadProgress event"),m.bind("ChunkUploaded",function(t,e,n){logger.debug("ChunkUploaded event activated"),logger.debug("file: ",e),logger.debug("info: ",n);var i=that.parseJSON(n.response);logger.debug("res: ",i),p=p?p+","+i.ctx:i.ctx;var o=n.total-n.offset,a=t.getOption&&t.getOption("chunk_size");a=a||t.settings&&t.settings.chunk_size,o<a&&(t.setOption({url:qiniuUploadUrl+"/mkblk/"+o}),logger.debug("up.setOption url: ",qiniuUploadUrl+"/mkblk/"+o)),t.setOption({headers:{Authorization:"UpToken "+r(e)}}),localStorage.setItem(e.name,that.stringifyJSON({ctx:p,percent:e.percent,total:n.total,offset:n.offset,time:(new Date).getTime()}))}),logger.debug("bind ChunkUploaded event");var g=qiniuUploadUrls.length,v=function(t){return g-- >0?(setTimeout(function(){that.resetUploadUrl(),t.status=plupload.QUEUED,m.stop(),m.start()},0),!0):(g=qiniuUploadUrls.length,!1)};return m.bind("Error",function(t){return function(e,n){logger.error("Error event activated"),logger.error("err: ",n);var i="",o=n.file;if(o){switch(n.code){case plupload.FAILED:i="上传失败。请稍后再试。";break;case plupload.FILE_SIZE_ERROR:var r=e.getOption&&e.getOption("max_file_size");r=r||e.settings&&e.settings.max_file_size,i="浏览器最大可上传"+r+"。更大文件请使用命令行工具。";break;case plupload.FILE_EXTENSION_ERROR:i="文件验证失败。请稍后重试。";break;case plupload.HTTP_ERROR:if(""===n.response){if(i=n.message||"未知网络错误。",!v(o))return;break}var a=that.parseJSON(n.response),s=a.error;switch(n.status){case 400:i="请求报文格式错误。";break;case 401:i="客户端认证授权失败。请重试或提交反馈。";break;case 405:i="客户端请求错误。请重试或提交反馈。";break;case 579:i="资源上传成功，但回调失败。";break;case 599:if(i="网络连接异常。请重试或提交反馈。",!v(o))return;break;case 614:i="文件已存在。";try{a=that.parseJSON(a.error),s=a.error||"file exists"}catch(u){s=a.error||"file exists"}break;case 631:i="指定空间不存在。";break;case 701:i="上传数据块校验出错。请重试或提交反馈。";break;default:if(i="未知错误。",!v(o))return}i=i+"("+n.status+"："+s+")";break;case plupload.SECURITY_ERROR:i="安全配置错误。请联系网站管理员。";break;case plupload.GENERIC_ERROR:i="上传失败。请稍后再试。";break;case plupload.IO_ERROR:i="上传失败。请稍后再试。";break;case plupload.INIT_ERROR:i="网站配置错误。请联系网站管理员。",m.destroy();break;default:if(i=n.message+n.details,!v(o))return}t&&t(e,n,i)}e.refresh()}}(c)),logger.debug("bind Error event"),m.bind("FileUploaded",function(e){return function(n,i,o){logger.debug("FileUploaded event activated"),logger.debug("file: ",i),logger.debug("info: ",o);var r=function(n,i,o){if(t.downtoken_url){var r=that.createAjax();r.open("POST",t.downtoken_url,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var t;try{t=that.parseJSON(r.responseText)}catch(a){throw"invalid json format"}var s={};plupload.extend(s,that.parseJSON(o),t),e&&e(n,i,that.stringifyJSON(s))}else m.trigger("Error",{status:r.status,response:r.responseText,file:i,code:plupload.HTTP_ERROR})},r.send("key="+that.parseJSON(o).key+"&domain="+t.domain)}else e&&e(n,i,o)},a=that.parseJSON(o.response);if(p=p?p:a.ctx,logger.debug("ctx: ",p),p){var u="";logger.debug("save_key: ",t.save_key),t.save_key||(u=s(n,i,that.key_handler),u=u?"/key/"+that.URLSafeBase64Encode(u):"");var c="/fname/"+that.URLSafeBase64Encode(i.name);logger.debug("op.x_vars: ",t.x_vars);var l=t.x_vars,d="",f="";if(void 0!==l&&"object"==typeof l)for(var h in l)l.hasOwnProperty(h)&&("function"==typeof l[h]?d=that.URLSafeBase64Encode(l[h](n,i)):"object"!=typeof l[h]&&(d=that.URLSafeBase64Encode(l[h])),f+="/x:"+h+"/"+d);var g,v=qiniuUploadUrl+"/mkfile/"+i.size+u+c+f,y=that.detectIEVersion();y&&y<=9?(g=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=t.flash_swf_url):g=that.createAjax(),g.open("POST",v,!0),g.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),g.setRequestHeader("Authorization","UpToken "+that.token);var _=function(){if(logger.debug("ajax.readyState: ",g.readyState),4===g.readyState){localStorage.removeItem(i.name);var t;200===g.status?(t=g.responseText,logger.debug("mkfile is success: ",t),r(n,i,t)):(t={status:g.status,response:g.responseText,file:i,code:-200},logger.debug("mkfile is error: ",t),m.trigger("Error",t))}};y&&y<=9?g.bind("readystatechange",_):g.onreadystatechange=_,g.send(p),logger.debug("mkfile: ",v)}else r(n,i,o.response)}}(l)),logger.debug("bind FileUploaded event"),m.init(),logger.debug("invoke uploader.init()"),logger.debug("init uploader end"),m},this.getUrl=function(t){if(!t)return!1;t=encodeURI(t);var e=this.domain;return"/"!==e.slice(e.length-1)&&(e+="/"),e+t},this.imageView2=function(t,e){var n=t.mode||"",i=t.w||"",o=t.h||"",r=t.q||"",a=t.format||"";if(!n)return!1;if(!i&&!o)return!1;var s="imageView2/"+n;return s+=i?"/w/"+i:"",s+=o?"/h/"+o:"",s+=r?"/q/"+r:"",s+=a?"/format/"+a:"",e&&(s=this.getUrl(e)+"?"+s),s},this.imageMogr2=function(t,e){var n=t["auto-orient"]||"",i=t.thumbnail||"",o=t.strip||"",r=t.gravity||"",a=t.crop||"",s=t.quality||"",u=t.rotate||"",c=t.format||"",l=t.blur||"",p="imageMogr2";return p+=n?"/auto-orient":"",p+=i?"/thumbnail/"+i:"",p+=o?"/strip":"",p+=r?"/gravity/"+r:"",p+=s?"/quality/"+s:"",p+=a?"/crop/"+a:"",p+=u?"/rotate/"+u:"",p+=c?"/format/"+c:"",p+=l?"/blur/"+l:"",e&&(p=this.getUrl(e)+"?"+p),p},this.watermark=function(t,e){var n=t.mode;if(!n)return!1;var i="watermark/"+n;if(1===n){var o=t.image||"";if(!o)return!1;i+=o?"/image/"+this.URLSafeBase64Encode(o):""}else{if(2!==n)return!1;var r=t.text?t.text:"",a=t.font?t.font:"",s=t.fontsize?t.fontsize:"",u=t.fill?t.fill:"";if(!r)return!1;i+=r?"/text/"+this.URLSafeBase64Encode(r):"",i+=a?"/font/"+this.URLSafeBase64Encode(a):"",i+=s?"/fontsize/"+s:"",i+=u?"/fill/"+this.URLSafeBase64Encode(u):""}var c=t.dissolve||"",l=t.gravity||"",p=t.dx||"",d=t.dy||"";return i+=c?"/dissolve/"+c:"",i+=l?"/gravity/"+l:"",i+=p?"/dx/"+p:"",i+=d?"/dy/"+d:"",e&&(i=this.getUrl(e)+"?"+i),i},this.imageInfo=function(t){if(!t)return!1;var e,n=this.getUrl(t)+"?imageInfo",i=this.createAjax(),o=this;return i.open("GET",n,!1),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(e=o.parseJSON(i.responseText))},i.send(),e},this.exif=function(t){if(!t)return!1;var e,n=this.getUrl(t)+"?exif",i=this.createAjax(),o=this;return i.open("GET",n,!1),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(e=o.parseJSON(i.responseText))},i.send(),e},this.get=function(t,e){return!(!e||!t)&&("exif"===t?this.exif(e):"imageInfo"===t&&this.imageInfo(e))},this.pipeline=function(t,e){var n,i,o="[object Array]"===Object.prototype.toString.call(t),r="";if(o){for(var a=0,s=t.length;a<s;a++){if(n=t[a],!n.fop)return!1;switch(n.fop){case"watermark":r+=this.watermark(n)+"|";break;case"imageView2":r+=this.imageView2(n)+"|";break;case"imageMogr2":r+=this.imageMogr2(n)+"|";break;default:i=!0}if(i)return!1}if(e){r=this.getUrl(e)+"?"+r;var u=r.length;"|"===r.slice(u-1)&&(r=r.slice(0,u-1))}return r}return!1}}window.localStorage||(window.localStorage={setItem:function(t,e){createCookie(t,e,30)},getItem:function(t){return readCookie(t)},removeItem:function(t){createCookie(t,"",-1)}});var Qiniu=new QiniuJsSDK;global.Qiniu=Qiniu,global.QiniuJsSDK=QiniuJsSDK}(window),define("web_qui_quiupload_qiniu",function(){}),define("web_qui_quiupload",["plupload","web_qui_quiupload_qiniu"],function(){"use strict";function t(t){this.upopt={browse_button:"",container:"",dragdrop:!1,drop_element:"",max_file_size:"100mb",runtimes:"html5,flash,html4",flash_swf_url:"../../../qcross/static/models/basic/js/plupload/Moxie.swf"/*tpa=http://common1.qyerstatic.com/qcross/static/models/basic/js/plupload/Moxie.swf*/,multi_selection:!0,chunk_size:"4mb",max_retries:3,qyer_token_url:"http://common1.qyerstatic.com/qcross/www/api.php?action=getAlbumToken",domain:"//pic.qyer.com/",auto_start:!0,token_format:function(t){return t.data.tk=t.data.token,t},init:{FilesAdded:function(t,e){},BeforeUpload:function(t,e){},UploadProgress:function(t,e){},UploadComplete:function(){},FileUploaded:function(t,e,n){},Key:function(t,e){var n,i=[];return i.push(window.QYER.uid),i.push((new Date).getTime()),i.push(parseInt(1e4*Math.random())),n=i.join(""),e.key=n,n},Error:function(t,e,n){var i="";if(e)switch(e.code){case-100:i="Silverlight加载失败";break;case-300:case-400:i="无法打开文件";break;case-600:i="图片必须小于"+t.getOption("max_file_size");break;case-601:i="文件扩展名不正确";break;default:i="未知错误"}t.trigger("UploadError",e,i)}}},this.init(t)}return t.prototype={init:function(t){this.upopt=$.extend(!0,this.upopt,t||{}),this._getUpToken()},_getUpToken:function(){var t=this;$.getJSON(t.upopt.qyer_token_url,function(e){if(0!==e.error_code)throw new Error(e.data);t.upopt.uptoken=e.data.token||e.data.tk,e.data.domain&&t.upopt.domain==e.data.domain,t.uploader=Qiniu.uploader(t.upopt),$(t).trigger("uploadready")})}},t}),define("common/component/footprint/js/sourceType",[],function(){var t={"C-des-leftTopBtn":10,"C-des-beenTo":11,"C-des-bottomInput":12,"C-des-batchComment":{visited:13,unvisited:14,search:16},"C-des-batchCommentSearch":16,"C-profile-cityFootMarkDone":17,"C-profile-allFootmarkRecommend":21,"C-profile-allBeenBatchComment":{visited:22,unvisited:28},"C-profile-allBeenBatchCommentSearch":26,"C-profile-batchComment":{visited:23,unvisited:24,search:26},"C-profile-batchCommentSearch":26,"C-poi-create":20,"C-M-poiDetail":51,"C-M-poiDetailDock":52,"C-M-IWantToComment":53,"C-other-extract":2,"C-other-translate":1};return t}),define("common/ui/textArea/textArea",[],function(){function t(t){this.$obj=t.$obj,this.timer=null,this.option=t.option,this.init()}var e=jQuery,n=[".qui-textArea {zoom: 1; }",".qui-textArea .red { color: red; }",".qui-textArea textarea,",".qui-textArea input { word-break:break-all; transition: height 0.2s; -webkit-transition: height 0.2s; -moz-transition: height 0.2s; -ms-transition: height 0.2s; box-sizing: border-box; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; -ms-box-sizing: border-box; }",".qui-textArea .autoHeight { overflow: hidden; }"].join("");window.qyerUtil.insertStyle(n),t.prototype={$obj:null,$textarea:null,$cloneTextarea:null,initHeight:null,maxHeight:null,timer:null,option:null,init:function(){this.$textarea=this.$obj.find("textarea").size()?this.$obj.find("textarea"):this.$obj.find("input"),this.$obj.attr("data-width")&&(this.$textarea.css("width",this.$obj.attr("data-width")),this.initHeight=this.$obj.attr("data-height")||this.$textarea.outerHeight()),this.$obj.attr("data-height")&&(this.$textarea.css("height",this.$obj.attr("data-height")),this.initWidth=this.$obj.attr("data-width")||this.$textarea.outerWidth()),this.option&&this.option.autoIncreaseHeight===!0&&(this.$cloneTextarea=this.createClone(this.$textarea)),this.$obj.show(),this.updateUI(),this.bindEvent()},createClone:function(t){if(t){var e=this.$textarea.clone(!0);return e.css({position:"absolute",left:"-9999em",overflow:"auto"}),e.insertAfter(t),e}},bindEvent:function(){var t=this;this.$obj.keyup(function(e){t.registEvent()})},registEvent:function(){var t=this;window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){t.updateUI(!0)},100)},updateUI:function(t){var n=this.$textarea,i=this.$cloneTextarea,o=this.$obj.find(".max"),r=this.$obj.find(".min"),a=this.$obj.find(".current"),s=(this.$obj.find(".exceed"),this.option.max),u=this.option.min,c=n.val().length;if(i){var l,p;i[0].value=n.val(),l=parseInt(i[0].scrollHeight,10),p=e.isNumeric(this.$obj.attr("data-max-height"))?this.$obj.attr("data-max-height"):99999,l>this.initHeight?(n.addClass("autoHeight"),l>=p&&(l=p,n.removeClass("autoHeight"))):l=this.initHeight,n.css("height",l),l=p=null}s==-1?c<u?(a.addClass("red"),0==c&&a.removeClass("red")):a.removeClass("red"):c<u||c>s?(a.addClass("red"),0==c&&a.removeClass("red")):a.removeClass("red"),a.html(c),o.html(s),r.html(u),$aTextArea=i=o=a=$left=s=u=c=left=null},isValidate:function(){var t=this.$obj.find("textarea").val().length;return this.option.max==-1?t>=this.option.min:t>=this.option.min&&t<=this.option.max},getContent:function(){return this.$obj.find("textarea")[0]},setValue:function(t){this.$textarea.val(t),this.$cloneTextarea.val(t),this.updateUI(!0)},getTextArea:function(){return this.$obj.find("textarea")[0]},unload:function(){this.$cloneTextarea.remove()},reset:function(){this.$textarea.val(""),this.$cloneTextarea.val(""),this.$obj.find(".current").html(0)}},e.fn.extend({qyerTextArea:function(n){var i,o;if(i={isValidate:function(t){return t.data("_qyerTextArea").isValidate()},getValue:function(t){return t.data("_qyerTextArea").getTextArea().value},unload:function(t){t.data("_qyerTextArea").unload()},reset:function(t){t.data("_qyerTextArea").setValue("")},setValue:function(t,e){t.data("_qyerTextArea").setValue(e)}},o=e.type(n),"object"==o||"undefined"==o)e.each(this,function(i,o){var r,a;r=e(o),a=e.extend({},n),a.max="undefined"http://common1.qyerstatic.com/place/js/common/!=typeof a.max?a.max:-1,a.min="undefined"http://common1.qyerstatic.com/place/js/common/!=typeof a.min?a.min:0,a.width=1==e.isNumeric(r.attr("data-width"))?r.attr("data-width"):null,a.height=1==e.isNumeric(r.attr("data-height"))?r.attr("data-height"):null,r.data("_qyerTextArea")||r.data("_qyerTextArea",new t({$obj:r,option:a})),r=a=null});else if("string"==o){var r,a,s=[];if(a=arguments,e.each(this,function(t,o){if(r=e(o),i[n]){var u=qyerUtil.sliceArguments(a,1);u.unshift(r),s.push(i[n].apply(r,u)),u=null}}),r=a=null,s.length)return 1==s.length?s[0]:s}return i=o=null,this}})}),define("common/basic/js/require-css!common/ui/inputValidation/inputValidation",[],function(){}),define("common/ui/inputValidation/inputValidation",["css!common/ui/inputValidation/inputValidation"],function(){function t(t,n){this.$obj=e(t),this.option=n,this.init()}var e=jQuery;t.prototype={$obj:null,$textDiv:null,option:null,init:function(){var t=this;this.setDefault(),this.option.blurAutoCheck!==!1&&this.$obj.blur(function(){t.check()}),this.$obj.focus(function(){t.clearTip()})},setDefault:function(){switch(this.option.defaultType){case"mail":this.option.exp=/^([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,6}$/,this.option.text=this.option.text||"邮箱地址格式错误";break;case"phone":this.option.exp=/^1[3|4|5|7|8][0-9]\d{4,8}$/,this.option.text=this.option.text||"手机号码格式错误";break;case"identityID":this.option.exp=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,this.option.text=this.option.text||"身份证号码格式错误";break;case"async":var t=this;this.option.exp=function(){return t.$obj.addClass("ui3_input_icon_loading"),t.$obj.removeClass("ui3_input_icon_error ui3_input_icon_ok"),t.option.asyncCheck(t.$obj.val(),function(e){setTimeout(function(){t.$obj.removeClass("ui3_input_icon_loading"),e?(t.option.text=e,t.addTip(),t.$obj.addClass("ui3_input_icon_error")):t.$obj.addClass("ui3_input_icon_ok")},10)}),!0}}},check:function(){var t=!1;switch(e.type(this.option.exp)){case"regexp":this.option.exp.lastIndex=0,t=this.option.exp.test(this.$obj.val());break;case"function":t=this.option.exp(this.$obj.val())}return this[t?"clearTip":"addTip"](),t},clearTip:function(){this.$obj.removeClass("qui-errorip ui3_input_icon_error"),this.$textDiv&&(this.$textDiv.remove(),this.$textDiv=null)},addTip:function(){this.$obj.addClass("qui-errorip"),this.$obj.hasClass("ui3_input")&&this.$obj.addClass("ui3_input_icon_error"),this.$textDiv&&this.$textDiv.remove();var t="qui-errorip-textDiv"+(this.option.style||"");this.$textDiv=e('<div class="'+t+'"><div class="tip"> <p class="a1"></p> <p class="a2"></p> </div> <div class="text">'+this.option.text+"</div> </div>");var n=this.$obj[this.option.parent?"position":"offset"]();if(1==this.option.style){this.$textDiv.appendTo(this.option.parent||document.body);var i=e(this.option.parent||document.body).outerWidth();i-=n.left,i-=this.$obj.outerWidth(),i=i-this.$textDiv.outerWidth()/2+16,this.$textDiv.css({right:i,top:n.top-25})}else this.$textDiv.css({left:n.left+10,top:n.top+this.$obj.outerHeight()-1}),this.$textDiv.appendTo(this.option.parent||document.body)},clear:function(){this.clearTip()}},e.fn.extend({qyerInputValidation:function(n){var i,o=!1,r=this;return e.each(this,function(){i=e(this),i.data("__errorTip__")?"clear"==n?(o=r,i.data("__errorTip__").clear()):o=i.data("__errorTip__").check():i.data("__errorTip__",new t(this,n))}),r=null,n?this:o}})}),define("common/basic/js/require-css!common/component/poiComment/poiComment",[],function(){}),define("common/component/poiComment/poiComment",["common/ui/popup/popup","web_qui_quiupload","common/component/footprint/js/sourceType","common/ui/textArea/textArea","common/ui/inputValidation/inputValidation","css!common/component/poiComment/poiComment.css"/*tpa=http://common1.qyerstatic.com/place/js/common/css!common/component/poiComment/poiComment.css*/],function(t,e,n){var i={settings:{saveDataSetting:{data:{}},onShow:!1,onHide:!1,onSucceed:null,onCancel:null}};return i.inition=function(t){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();$.extend(this.settings,t);return this.settings.ajaxArgu?(this.getData(this.settings,this.createDOM),!1):void(this.settings.data&&this.createDOM(this.settings.data,this.settings))},i.getData=function(t,e){var t=t,n=this;$.ajax(t.ajaxArgu).done(function(i){n.settings.saveDataSetting.data.starLevel&&parseInt(n.settings.saveDataSetting.data.starLevel,10)>0?i.data.starLevel=parseInt(n.settings.saveDataSetting.data.starLevel,10):i.data.starLevel=i.data.starLevel,e.call(n,i.data,t)}).fail(function(t){})},i.createDOM=function(e,n){
var e=e,n=n,o=e.imgUrl||"../../../../common2.qyerstatic.com/place/common/component/poiComment/images/poi_200_133.png"/*tpa=http://common2.qyerstatic.com/place/common/component/poiComment/images/poi_200_133.png*/,r=e.poiLink||"javascript:void(0)",a=e.cnName||e.enName,s=e.enName&&e.cnName?e.enName:"",u=e.starLevel||0,c=e.comment||"",l=$("<div/>",{"class":"qui-siglComment"}),p=$("<a/>",{href:r,"class":"siglComment-title"}).appendTo(l);$("<img/>",{src:o,width:80,height:80}).appendTo(p);var d=$("<div/>",{"class":"siglComment-info"}).appendTo(l);$('<p class="siglComment-cn"><a href="'+r+'">'+a+"</a></p>").appendTo(d),$('<p class="siglComment-en"><a href="'+r+'">'+s+"</a></p>").appendTo(d);for(var f=$("<div/>",{"class":"siglComment-stars",starlevel:u}).appendTo(d),h=0;h<5;h++)$('<span class="star"></span>').appendTo(f);$('<em class="level">点击星星为它评分</em>').appendTo(f);var m=$("<div/>",{"class":"siglComment-detail","data-width":"638","data-height":"104"}).appendTo(l);$("<textarea/>",{"class":"ui3_textarea",placeholder:"这里有哪些亮点？哪些方面还不够好？大家都期待着你的点评"}).val(c).appendTo(m),$('<div class="siglComment-camera" id="swf_upload_container_c"><label id="uploader">分享照片</label>有图有真相的点评最受欢迎！</div>').appendTo(m),$('<ul class="siglComment-photolist" style="display:none" id="siglComment-photolist"><li class="add" id="swf_upload_container1"><span id="siglCommentPhotoUp"></span></li></ul>').appendTo(m),$('<div class="tips"><span class="current"></span> / <span class="min"></span> ~ <span class="max"></span></div>').appendTo(m);var g=t.show({title:" ",contentHTML:l,width:690,okText:"发布",onAfterHide:function(){n.onHide&&n.onHide.call(g)},onCancel:function(){n.onCancel&&n.onCancel.call(g)},onOK:function(){var e=$(g.getContent()),i=e.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation(),o=e.find(".siglComment-stars").attr("starlevel");if(!(o>0))return requirejs(["common/ui/tip/tip"],function(t){t.tip({text:"点击星星为它评分",type:"warning"})}),!1;if(i){t.setOption({showLoadBtn:!0,showOKBtn:!1});({starlevel:o,comment:e.find(".siglComment-detail").find(".ui3_textarea").val()});return n.saveDataSetting.data.starlevel=o,n.saveDataSetting.data.comment=e.find(".siglComment-detail").find(".ui3_textarea").val(),n.saveDataSetting.data.imgs=$.map($("#siglComment-photolist li[tid]"),function(t){return $(t).attr("tid")}).join(","),$.ajax(n.saveDataSetting).done(function(t){n.onSucceed&&n.onSucceed.call(g,t),g.hide()}).fail(function(e){n.onFail&&n.onFail.call(g,e),t.setOption({showLoadBtn:!1,showOKBtn:!0})}),!1}return!1},onBeforeHide:function(){var t=$(g.getContent());t.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation("clear")}});i.popup=g,i.bindEvent.call(g.getContent()),n.onShow&&n.onShow.call(g)},i.bindEvent=function(){var t=$(this);t.find(".siglComment-detail").qyerTextArea({max:2e3,min:30,autoIncreaseHeight:!0}),t.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation({blurAutoCheck:!1,text:"点评不少于30字，不超过2000字",exp:/^(\s|\S){30,2000}$/im});var e=t.find(".siglComment-stars"),n=["很差","差","一般","好","很好"],i=e.attr("starlevel");e.find(".star").removeClass("star-on"),e.find(".level").html("点击星星为它评分"),i>0&&(e.find(".star:lt("+i+")").addClass("star-on"),e.find(".level").html(n[parseInt(i,10)-1])),e.off("mouseleave").on("mouseleave",function(){$(this).find(".star").removeClass("star-on"),e.find(".level").html("点击星星为它评分");var t=e.attr("starlevel");t>0&&($(this).find(".star:lt("+t+")").addClass("star-on"),e.find(".level").html(n[parseInt(t,10)-1]))}),e.find(".star").each(function(t){var i=t;$(this).hover(function(){e.find(".star").addClass("star-on"),e.find(".star:gt("+i+")").removeClass("star-on"),e.find(".level").html(n[i])}).click(function(){e.attr("starlevel",i+1)})}),$("#swf_upload_container_c label,#siglCommentPhotoUp").off("click").on("click",function(){require(["common/component/uploadPopup/uploadPopup"],function(t){var e=new t({max:20,items:[{model:"local",opt:{headOpt:{models:["list","create"]}}},{model:"myphoto",opt:{headOpt:{models:["list"]}}}]});e.show(),$(e).on("fireuploadimage",function(t,n){if(e.hide(),"string"==typeof n)var n=JSON.parse(n);var i=$("#siglComment-photolist"),o=i.css("display","block");$.each(n,function(t,e){var n=$('<li tid="'+e.id+'">\t\t\t\t\t\t\t<img src="'+e.url+'/80"/*tpa=http://common1.qyerstatic.com/place/js/common/'+e.url+'/80*//>\t\t\t\t\t\t\t<span class="close">\t\t\t\t\t\t\t</span>\t\t\t\t\t\t</li>').insertBefore(o.find(".add"));n.find(".close").click(function(t){t.stopPropagation(),$(this).parent().remove()})})})})})},i.show=function(t){i.inition({ajaxArgu:{data:{poiid:t.poiid},url:"http://common1.qyerstatic.com/poi.php?action=popupPoiComment",type:"post",dataType:"json"},flash_swf_url:"../../../qcross/static/models/basic/js/plupload/Moxie.swf"/*tpa=http://common1.qyerstatic.com/qcross/static/models/basic/js/plupload/Moxie.swf*/,saveDataSetting:{url:"http://common1.qyerstatic.com/qcross/place/index.php?action=savePoiComment",type:"post",dataType:"json",data:{poiid:t.poiid,source_type:n[t.source_type],starLevel:t.starLevel}},onShow:t.onShow||t.onshow||!1,onHide:t.onHide||t.onhide||!1,onSucceed:t.onSuccess||t.onsuccess||t.onSucceed||t.onsucceed||!1,onCancel:t.oncancel||t.oncancel||!1})},i.hide=function(){i.settings.onCancel&&i.settings.onCancel.call(i.popup),t.hide()},i}),define("common/basic/js/require-css!common/widget/userbehavior/userbehavior",[],function(){}),define("common/widget/userbehavior/widget-userbehavior",["common/widget/widget","common/widget/userbehavior/config","common/service/userbehavior/userbehavior-service","common/widget/userbehavior/liketip","project/js/batch_add_footprint","common/component/poiComment/poiComment","css!common/widget/userbehavior/userbehavior.css"/*tpa=http://common1.qyerstatic.com/place/js/common/css!common/widget/userbehavior/userbehavior.css*/],function(t,e,n,i,o,r){return t.createClass({init:function(t,e){this.callSuper.apply(this,arguments),this.params=t,"number"http://common1.qyerstatic.com/place/js/common/==typeof t.type?this.type=this.place["name"+t.type]:"string"==typeof t.type?this.type=t.type:this.type=this.place.name1,this.id=t.id,this.getDom()},toggleLoading:function(t){this.$el[t?t:"toggleClass"]("place-ubloading")},events:[["click","handle",">ul>li"],["click","submenu",">ul>li a"]],getDom:function(){this.toggleLoading("addClass"),qyerUtil.isLogin()?this.getBaseData():this.setDom(e.getDom(this.type,this.id))},getBaseData:function(){var t=this;n.getBehaviorInfo({tp:t.type,id:t.id},$.proxy(t.getBaseDataSuccess,t),$.proxy(t.getBaseDataError,t))},getBaseDataSuccess:function(t){var n=this,i=t.data.result;n.setDom(e.getDom(n.type,n.id,{planto:i.planto,beento:i.beento,lived:i.lived}))},getBaseDataError:function(t){this.$el.hide()},setDom:function(t){this.$dom=$(t),this.$el.append(this.$dom),this.toggleLoading("removeClass"),this.params.exClass&&this.$dom.addClass(this.params.exClass),new i},preventUnnecessary:function(t,e){return e===!0?void $(t).attr("data-on","no"):"yes"==$(t).attr("data-on")||($(t).attr("data-on","yes"),!1)},handle:function(t){if(!qyerUtil.isLogin())return qyerUtil.doLogin(),!1;var e=this,i=$(t.currentTarget);switch(i.attr("data-type")){case e.planto:case e.beento:case e.lived:if(e.preventUnnecessary(t.currentTarget))return!1;var o=i.attr("data-type"),r={type:e.reversePlace[e.type],id:e.id,oper:o};r[o]=i.attr("data-status")-0?0:1,n.feeling(r,$.proxy(function(e){this.handleSuccess(t.currentTarget,e)},this),$.proxy(function(e){this.handleError(t.currentTarget,e)},this))}},handleSuccess:function(t,n){var i=$(t),o=this,r=i.attr("data-status")-0,a=i.attr("data-type");switch(i.attr("data-status",r?0:1).attr("data-bn-ipg",e[a]["data-bn-ipg"]({type:o.type,id:o.id,status:r})).toggleClass("selected").find("span.fonts").text(e[a][r?"text":"sText"]),o.preventUnnecessary(t,!0),a){case o.beento:"country"!=o.type&&"city"!=o.type||r?"poi"!=o.type||r||o.writePoiComment():o.execAddToPlan(n.data.poi_not_count,n.data.isaddimpress);break;case o.lived:"country"!=o.type&&"city"!=o.type||r||require(["common/component/shareExp/shareExp"],function(t){t.show({id:o.id,type:o.type})})}},handleError:function(t,e){var n=this;this.preventUnnecessary(t,!0),requirejs(["common/ui/tip/tip"],function(t){t.tip({text:e.data.msg||n.errorTip,type:"warning"})})},execAddToPlan:function(t,e){var n=PLACE.TYPE,i=PLACE.PID;o(i,n,t,e)},writePoiComment:function(){var t=this;return!(!PLACE||!PLACE.CITYID)&&void r.show({poiid:t.id,source_type:"C-des-beento",onsucceed:function(t){requirejs(["common/component/switchRoute/switchRoute"],function(t){t.show({onOKFn:function(){requirejs(["common/component/footprint/js/comment"],function(t){t.commShow({city_id:PLACE.CITYID,source_type:"C-des-leftTopBtn"})})},onCancelFn:function(){window.location.reload()}})})}})},batchPoiComment:function(){requirejs(["common/component/footprint/js/comment"],function(t){t.commShow({city_id:PLACE.PID,source_type:"C-des-batchComment"})})},submenu:function(t){if(!qyerUtil.isLogin())return qyerUtil.doLogin(),!1;var e=$(t.currentTarget),n=this;if(!e.hasClass("js-cancelFootprint")){qyerUtil.doTrackCode(e.attr("data-bn-ipg"));var i=e.attr("href");return e.hasClass("js-poiComment")?"poi"http://common1.qyerstatic.com/place/js/common/==n.type?n.writePoiComment():n.batchPoiComment():"string"==typeof i&&"javascript:void(0)"!=i&&(window.document.location.href=i),t.stopPropagation(),!1}}},{ATTRS:{planto:"planto",beento:"beento",lived:"lived",addToPlan:"addToPlan",place:{name4:"country",name1:"city",name2:"poi"},reversePlace:{poi:2,country:4,city:1},errorTip:"操作失败,请刷新页面重试"}})}),define("project/js/qyguide",[],function(){var t=$("#qyGuide"),e=t.find(".plcQYGuidePage em");require(["project/js/slider"],function(n){n({prev:t.find(".prev"),next:t.find(".next"),content:t.find(".plcQYGuideContent"),beforeAnimate:function(t){e.text(++t)}})}),t.on("click",".download a",function(t){var e=$(this).parents("li").attr("data-id");require(["project/js/qyguide_download"],function(t){t(e)})}),$(".js-guideBatchDown").on("click",function(){requirejs(["common/component/guideBatchdownload/guideBatchdownload"],function(t){t.show({id:PLACE.PID,type:PLACE.TYPE})})})}),define("project/js/slide",[],function(){function t(t){this._prev=t.prev,this._next=t.next,this._content=t.content,this._step=t.step||3,this._currentIndex=0,this._length=0,this._list=$(),this._liWidth=t.liWidth||335}function e(e){var n=new t(e);return n.init(),n}return t.prototype.doPrev=function(){this._currentIndex-this._step<0?this._currentIndex=0:this._currentIndex-=this._step,this._next.removeClass("disabled"),this.animate(this._currentIndex),0==this._currentIndex&&this._prev.addClass("disabled")},t.prototype.doNext=function(){this._currentIndex+this._step+this._step>this._length-1?this._currentIndex=this._length-this._step:this._currentIndex+=this._step;var t=this._currentIndex+this._step,e=this._list.find("li:lt("+t+")");e.each(function(t,e){var n=$(this).find("img[data-original]");n.each(function(t,e){var n=$(this).attr("src"),i=$(this).attr("data-original");n!==i&&$(this).attr("src",i)})}),this._prev.removeClass("disabled"),this.animate(this._currentIndex),this._currentIndex+this._step==this._length&&this._next.addClass("disabled")},t.prototype.animate=function(t){this._list.stop(!0).animate({left:-(t*this._liWidth)},500)},t.prototype.init=function(){var t=this;this._list=this._content.find("ul"),this._length=this._list.find("li").length,this._list.css("width",this._liWidth*this._length),this._length<=this._step||(this._prev.addClass("disabled"),this._prev.on("click",function(e){e.preventDefault(),t.doPrev()}),this._next.on("click",function(e){e.preventDefault(),t.doNext()}))},e}),define("project/js/discuss",[],function(){function t(t,e,n,i){var o="http://common1.qyerstatic.com/city.php?action=ajaxtravel";"recommend"==$("#plcTravelSort").find(".current").attr("data-type")&&(o="http://common1.qyerstatic.com/city.php?action=ajaxrecommendthreads");var n=n||"hot";t.addClass("plcListLoading"),$.getJSON(o,{page:e,type:PLACE.TYPE,pid:PLACE.PID,sort:n},function(e){t.removeClass("plcListLoading");var n=e.data,o=t.siblings(".plcDiscussPage"),r=t.siblings(".plcDiscussContentEmpty");n.list.length>0?r.hide():r.show();var a=$("#travelTmpl").html(),s=juicer(a,n);t.html(s),o.html(n.pagehtml),"function"==typeof i&&i()})}function e(t,e,n){var i="http://common1.qyerstatic.com/city.php?action=ajaxask";t.addClass("plcListLoading"),$.getJSON(i,{page:e,type:PLACE.TYPE,pid:PLACE.PID},function(e){t.removeClass("plcListLoading");var i=e.data,o=t.siblings(".plcDiscussPage"),r=t.siblings(".plcDiscussContentEmpty");i.list.length>0?r.hide():r.show();var a=$("#askTmpl").html(),s=juicer(a,i);t.html(s),o.html(i.pagehtml),"function"==typeof n&&n()})}function n(t,e,n){var i="http://common1.qyerstatic.com/city.php?action=ajaxpartner";t.addClass("plcListLoading"),$.getJSON(i,{page:e,type:PLACE.TYPE,pid:PLACE.PID},function(e){t.removeClass("plcListLoading");var i=e.data,o=t.siblings(".plcDiscussPage"),r=t.siblings(".plcDiscussContentEmpty");i.list.length>0?r.hide():r.show();var a=$("#partnerTmpl").html(),s=juicer(a,i);t.html(s),o.html(i.pagehtml),"function"==typeof n&&n()})}function i(t,e,n,i){var o="http://common1.qyerstatic.com/city.php?action=ajaxcomment";return n=!!n,n&&!qyerUtil.isLogin()?void qyerUtil.doLogin():(t.addClass("plcListLoading"),void $.getJSON(o,{page:e,type:PLACE.TYPE,pid:PLACE.PID,friendFirst:n},function(e){t.removeClass("plcListLoading");var o=e.data,r=t.siblings(".plcDiscussPage"),a=t.siblings(".plcDiscussContentEmpty");a.hide(),0==o.list.length&&(n?a.filter("[data-type=friend]").show():a.filter("[data-type=all]").show());var s=$("#commentTmpl").html(),u=juicer(s,o);t.html(u),r.html(o.pagehtml),"function"==typeof i&&i(),requirejs(["common/ui/textArea/textArea"],function(){t.find(".qui-textArea").qyerTextArea({max:140,min:10})})}))}function o(){var t=$(".plcDiscussMain").offset().top;t-=50,$("body,html").animate({scrollTop:t})}require(["project/js/tab"],function(o){o({tab:$(".plcDiscussTags"),content:$(".plcDiscussContent"),onChanged:function(o,r,a){var s=$(a).children("ul"),u=s.text();if(""==$.trim(u)){var c=$(r).attr("data-type");switch(c){case"ask":e(s,1);break;case"travel":t(s,1);break;case"partner":n(s,1);break;case"comment":$("#commentListFriendPrior")[0].checked=!1,i(s,1)}}}})}),$("#plcTravelLists").on("click",".ui_page a",function(){var e=$(this).attr("data-page"),n=$(".plcTravelList"),i=$("#plcTravelSort .current").attr("data-type");t(n,e,i,function(){o()})}),$("#plcAskLists").on("click",".ui_page a",function(){var t=$(this).attr("data-page"),n=$(".plcAskList");e(n,t,function(){o()})}),$("#plcPartnerLists").on("click",".ui_page a",function(){var t=$(this).attr("data-page"),e=$(".plcPartnerList");n(e,t,function(){o()})}),$("#plcCommentLists").on("click",".ui_page a",function(){var t=$(this).attr("data-page"),e=$(".plcCommentList"),n=$("#commentListFriendPrior").is(":checked");i(e,t,n,function(){o()})}),$("#plcTravelSort").on("click","span",function(){if(!$(this).hasClass("current")){$(this).addClass("current").siblings("span").removeClass("current");var e=$(this).attr("data-type"),n=$(".plcTravelList");t(n,1,e)}}),$("#commentListFriendPrior").on("change",function(){var t=$(this)[0].checked,e=$(".plcCommentList");i(e,1,t)}),$(".plcCommentList").on("click",".praise",function(){var t=this,e="http://common1.qyerstatic.com/poi.php?action=useful",n=$(this).parents("li[data-id]").attr("data-id");return qyerUtil.isLogin()?void $.post(e,{type:2,pid:n},function(e){if(0==e.error_code){var n=$(t).text();n=parseInt(n,10),$(t).text(++n),$(t).removeClass("praise").addClass("praised"),requirejs(["common/ui/tip/tip"],function(t){t.tip({text:e.data.msg_impel})})}else $(t).removeClass("praise").addClass("praised"),requirejs(["common/ui/tip/tip"],function(t){t.tip({text:e.data.msg,type:"warning"})})},"json"):void qyerUtil.doLogin()}),$(".plcCommentList").on("click",".plcCommentUserCnts .replyBtn",function(){var t=$(this).parents(".plcCommentUserCnts").next(".plcCommentUserReplys");t.is(":hidden")?t.slideDown(function(){var t=$(this).parents("li[data-id]"),e=t.find(".title a:eq(0)").text(),n="回复 @"+e+"：";$(this).find("textarea").focus().val(n)}):t.slideUp()}),$(".plcCommentList").on("click",".plcCommentUserReplys .replyBtn",function(){var t=$(this).parent().parent("li[data-id]"),e=t.parents(".plcCommentUserReplys").find("textarea"),n=t.find(".title a:eq(0)").text(),i="回复 @"+n+"：";e.focus().val(i)}),$(".plcCommentList").on("click",".qui-textArea :button",function(){var t=$(this).parents(".qui-textArea"),e=t.children("textarea");if($li=$(this).parents("li[data-id]"),cid=$li.attr("data-id"),$replyList=$li.find(".msglist"),!qyerUtil.isLogin())return void qyerUtil.doLogin();var n=t.qyerTextArea("isValidate");if(!n)return void requirejs(["common/ui/tip/tip"],function(t){t.tip({text:"你输入的字数不符合要求",type:"error"})});var i="http://common1.qyerstatic.com/public.php?action=replycomment";$.post(i,{cid:cid,type:2,reply:e.val()},function(t){if(0!=t.error_code)return void requirejs(["common/ui/tip/tip"],function(t){t.tip({text:"回复错误",type:"error"})});var e=t.data,n=$("#replyTmpl").html(),i=juicer(n,e);$replyList.prepend(i);var o=$li.find(".replyBtn"),r=o.find("span"),a=parseInt(r.text());a++,r.text(a)},"json")})}),define("project/js/comentRankUser",[],function(){function t(t,e){if(!qyerUtil.isLogin())return!1;var n=t.find("li"),i=0,o=[];for(i;i<n.length;i++)o.push(n[i].getAttribute("data-uid"));$.post("http://common1.qyerstatic.com/public.php?action=ckfriend",{fuids:o.join(","),timer:Date.now()},function(t){if(0!==t.error_code)throw new Error("getFollow ajax error");e&&e(t.data)},"json")}var e=$(".plcDiscussRankuser");t(e,function(t){for(o in t)0!==t[o].follow&&e.find('li[data-uid="'+o+'"]').find(".follow").empty().text("已关注")}),e.on("click",".follow a",function(){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();var t=$(this).parent(),e=t.attr("data-id");require(["project/js/followuser"],function(n){n(e,function(){t.empty().text("已关注")})})})}),define("common/basic/js/require-css!common/ui/tip/tip",[],function(){}),define("common/ui/tip/tip",["css!common/ui/tip/tip.css"/*tpa=http://common1.qyerstatic.com/place/js/common/css!common/ui/tip/tip.css*/],function(){function t(t){i.html(t.text||"&nbsp;"),n[0].className="qui-tip-box","error"http://common1.qyerstatic.com/place/js/common/==t.type?n.addClass("qui-tip-box-error"):"warning"==t.type&&n.addClass("qui-tip-box-warning")}var e,n,i,o=jQuery;!function(){var t=['<div class="qui-tip" style="display:none;" >','<div class="qui-tip-box">','<span class="qui-tip-text fontYaHei">这里是提示文本</span>',"</div>","</div>"].join("");e=o(t),i=e.find(".qui-tip-text"),n=e.find(".qui-tip-box"),e.appendTo(document.body)}();var r={_timer:null,tip:function(n){return t(n),e.slideDown(200),window.clearTimeout(this._timer),this._timer=setTimeout(function(){e.slideUp(200)},n.time||3e3),this}};return r}),define("common/component/shareExp/shareExp",["common/ui/popup/popup","common/ui/tip/tip","common/ui/textArea/textArea"],function(t,e){function n(t){this.option={id:0,type:"city",title:"&nbsp;",pText:"一个瞬间？一个贴士？有什么想和大家分享的就说说吧",getExpUrl:"http://common1.qyerstatic.com/country.php?action=showimpress",shareExpUrl:"http://common1.qyerstatic.com/country.php?action=impress",textareaVal:"",onSuccess:function(){},onHide:function(){}},i.extend(this.option,t),this.init()}var i=jQuery;n.prototype={init:function(){this.getMyExp()},getExp:function(t){t.posturl=this.option.getExpUrl,qyerUtil.doAjax(t)},shareExp:function(t){t.posturl=this.option.shareExpUrl,qyerUtil.doAjax(t)},getMyExp:function(){var t=this;this.getExp({data:{id:t.option.id,type:t.option.type},onSuccess:function(e){t.option.textareaVal=e.data.text,"&nbsp;"==t.option.title&&(t.option.title="说说我的"+e.data.placeName),t.showExpPop()},onError:function(t){t.__server_error__?e.tip({text:"服务器连接错误，请稍后再试",type:"error"}):e.tip({text:t.data.msg,type:"error"})}})},showExpPop:function(){var n=this;t.show({title:n.option.title,width:440,contentHTML:['<div style="position:relative;">',"<p>"+n.option.pText+"</p>",'<div id="shareExpUnit" class="qui-textArea" data-width="400" data-height="120" style="margin-top:10px;">','<textarea id="shareExpTextarea" placeholder="不超过120个汉字" class="ui2_textarea" style="width:400px;height:120px;border:1px solid #cccccc;padding:5px;">'+n.option.textareaVal+"</textarea>",'<div class="tips" style="position:absolute;bottom:-20px;">','<span class="current"></span>/<span class="max"></span>',"</div>","</div>","</div>"].join(""),okText:"发表",onShow:function(){i("#shareExpUnit").qyerTextArea({max:120})},onOK:function(){var o=i("#shareExpUnit").qyerTextArea("isValidate");return o?n.shareExp({data:{id:n.option.id,type:n.option.type,text:i("#shareExpTextarea").val()},onSuccess:function(o){e.tip({text:o.data.msg}),t.hide(),i.isFunction(n.option.onSuccess)&&window.setTimeout(function(){n.option.onSuccess.call(n)},300)},onError:function(t){t.__server_error__?e.tip({text:"服务器连接错误，请稍后再试",type:"error"}):e.tip({text:t.data.msg,type:"error"})}}):e.tip({text:"输入文字超出限制",type:"error"}),!1},onCancel:function(){i.isFunction(n.option.onHide)&&n.option.onHide.call(n)}})}};var o={show:function(t){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();new n(t)}};return o}),define("common/basic/js/require-css!common/ui/inputAutocomplete/inputAutocomplete",[],function(){}),define("common/ui/inputAutocomplete/inputAutocomplete",["css!common/ui/inputAutocomplete/inputAutocomplete.css"/*tpa=http://common1.qyerstatic.com/place/js/common/css!common/ui/inputAutocomplete/inputAutocomplete.css*/],function(){function t(t){this.$obj=t.$obj,this.timer=null,this.isSearching=!1,this.autoSelect=!1,this.$contentDiv=null,this.option=t.option,t.option.parent&&(this.$parent=e(t.option.parent)),this.init()}var e=jQuery;t.prototype={$obj:null,timer:null,option:null,isSearching:!1,autoSelect:!1,$contentDiv:null,$parent:null,init:function(){this.createDomNode(),this.bindEvent()},createDomNode:function(){var t=['<div class="qui-inputAutocomplete" style="display:none;">','<ul class="qui-inputAutocomplete-ul" >','<li class="disableDefalut">loading ... </li>',"</ul>","</div>"].join("");this.$contentDiv=e(t);var n={width:this.$obj.outerWidth()};if(!this.$parent){var i=this.$obj.offset();n.top=i.top+this.$obj.outerHeight(),n.left=i.left,i=null}this.$contentDiv.css(n),this.$contentDiv.appendTo(this.$parent||document.body),t=n=null},_blurTimer:null,bindEvent:function(){var t=this;this.$obj.keyup(function(n){if(e.inArray(n.keyCode,[37,39])==-1)return 9==n.keyCode?(t.$contentDiv.hide(),void(t.option.onVoid&&t.option.onVoid(t.$obj[0]))):void(e.inArray(n.keyCode,[38,40,13])!=-1?t.updateUI(n.keyCode):e.trim(t.$obj.val())||t.option.isAllowEmptySeach?t.registSearch():(t.$contentDiv.hide(),t.option.onVoid&&t.option.onVoid(t.$obj[0])))}).blur(function(){t._blurTimer=window.setTimeout(function(){t.$contentDiv.is(":hidden")||t.option.isBlurClose!==!1&&t.$contentDiv.hide()},300)}),this.option.isFocusedSeach&&this.$obj.focus(function(){(e.trim(t.$obj.val())||t.option.isAllowEmptySeach)&&t.registSearch()}),this.$contentDiv.delegate(".qui-inputAutocomplete-ul li","click",function(n){return n.target.className.indexOf("disableDefalut")!=-1?(n.stopPropagation(),void window.clearTimeout(t._blurTimer)):void(this.className.indexOf("disableDefalut")==-1&&(t.$obj.val(e(this).text()),t.$contentDiv.hide(),t.option.onSelect&&(t.option.onSelect.call(t.$obj[0],this),t.$contentDiv.html(""))))})},registSearch:function(){var t=this;this.isSearching=!1,window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){(e.trim(t.$obj.val())||t.option.isAllowEmptySeach)&&(t.isSearching=!0,t.showContentDiv(),t.option.onSearch.call(t.$obj[0]))},300)},showContentDiv:function(){var t=this;this.$contentDiv.is(":hidden")&&(this.$contentDiv.show(),e(document).one("click",function(e){t.option.isBlurClose!==!1&&t.$contentDiv.hide()}))},updateUI:function(t){function n(){var t=o.find("li[data-select=true]"),e=o.find("li").index(t);t.attr("data-select",""),t.length?(t=o.find("li:not(.disableDefalut)").eq(e+1),t.length||(t=o.find("li:eq(0)"))):t=o.find("li:eq(0)"),t.attr("data-select","true"),t=null}function i(){var t=o.find("li[data-select=true]"),e=o.find("li").index(t);t.attr("data-select",""),t.length?(t=o.find("li:not(.disableDefalut)").eq(e-1),t.length||(t=o.find("li:eq("+(r-1)+")"))):t=o.find("li:eq("+(r-1)+")"),t.attr("data-select","true"),t=null}if(!this.$contentDiv.is(":hidden")){var o=this.$contentDiv.find(".qui-inputAutocomplete-ul"),r=o.find("li:not(.disableDefalut)").size();if(r&&(e.inArray(t,[38,40])!=-1&&(40==t?n():i()),this.option.enterSelect!==!1&&13==t)){var a=o.find("li[data-select=true]");a.length?(this.$obj.val(a.text()),this.option.onSelect&&(this.option.onSelect.call(this.$obj[0],a[0],!0),this.$contentDiv.html("")),this.$contentDiv.hide()):this.option.isBlurClose!==!1&&this.$contentDiv.hide()}}},pushHTML:function(t){var e={width:this.$obj.outerWidth()};if(!this.$parent){var n=this.$obj.offset();e.top=n.top+this.$obj.outerHeight(),e.left=n.left,n=null}this.$contentDiv.css(e).html(t).show(),this.isSearching=!1,e=null;var i=this.$contentDiv.find(".qui-inputAutocomplete-ul > li:not(.disableDefalut)");i.length&&this.autoSelect!==!1&&i.eq(0).attr("data-select","true"),i=null},isShow:function(){return!this.$contentDiv.is(":hidden")},hide:function(){return this.$contentDiv.hide()},destroy:function(){this.$contentDiv.remove()}},e.fn.extend({qyerAutocomplete:function(n){var i,o,r=arguments;return e.each(this,function(a,s){i=e(s),"object"==e.type(n)?i.data("_autocomplete",new t({$obj:i,option:n})):"pushHTML"==n?i.data("_autocomplete").pushHTML(r[1]):"getContent"==n?o=i.data("_autocomplete").$contentDiv:"isShow"==n?o=i.data("_autocomplete").isShow():"hide"==n?i.data("_autocomplete").hide():"destroy"==n&&(i.data("_autocomplete").destroy(),i.data("_autocomplete",null))}),i=r=null,"undefined"==typeof o?this:o}})}),define("common/basic/js/require-css!common/component/openAsk/openAsk",[],function(){}),define("common/component/openAsk/openAsk",["common/ui/popup/popup","common/ui/tip/tip","common/ui/textArea/textArea","common/ui/inputAutocomplete/inputAutocomplete","common/ui/inputValidation/inputValidation","css!common/component/openAsk/openAsk.css"/*tpa=http://common1.qyerstatic.com/place/js/common/css!common/component/openAsk/openAsk.css*/],function(t,e){function n(t){i.extend(this.option,this.defaultOption),this.option=t,this.init()}if("undefined"!=typeof jQuery){var i=jQuery,o=function(t){var e=[{from:11,name:"place_profile",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+\/(profile|citytransport|when-to-go|cost|information|advice|ctytransport|ncost|pracinfo|nadvice|whentogo|carrental|ctyprofile|nvisa|transportation)/},{from:12,name:"place_travelnote",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+\/travel-notes/},{from:13,name:"place_city",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+/},{from:14,name:"bbs_forum",reg:/^http(s)?:\/\/bbs\.qyer\.com\/forum-[^\/]+/},{from:15,name:"bbs_index",reg:/^http(s)?:\/\/bbs\.qyer\.com\/?\??/},{from:16,name:"ask_tags",reg:/^http(s)?:\/\/ask\.qyer\.com\/tags/},{from:17,name:"ask_detail",reg:/^http(s)?:\/\/ask\.qyer\.com\/question\/\d+/},{from:18,name:"ask_search",reg:/^http(s)?:\/\/ask\.qyer\.com\/search/},{from:19,name:"ask_index",reg:/^http(s)?:\/\/ask\.qyer\.com\/?\??/},{from:20,name:"search_ask",reg:/^http(s)?:\/\/search\.qyer\.com\/ask/},{from:21,name:"ucenter_ask",reg:/^http(s)?:\/\/www\.qyer\.com\/u\/\d+\/ask/}],n=function(){for(var t,n=window.location.href,i=0,o=e.length;i<o;i+=1){var r=e[i];if(r.reg.test(n)){t=r.from;break}}return t||0};return t||n()};i.ajaxSetup({traditional:!0}),n.prototype={option:null,popup:null,tags:[],forums:{},defaultOption:{fid:0,from:0},getFNameByID:function(t){var e=this.forums,n=[];for(var i in e)n=n.concat(e[i]);for(var o=0;o<n.length;o++)if(n[o].id==t)return n[o].name},API:{baseURL:/^bbs\.qyer\.com/.test(location.host)?"http://common1.qyerstatic.com/qyerajax.php":"http://common1.qyerstatic.com/ajax.php",getTagByString:function(t){t.posturl=this.baseURL+"?action=maketag&ispopup=1&returnjson=1",window.qyerUtil.doAjax(t)},getTagByTag:function(t){t.posturl=this.baseURL+"?action=TopicMenu",window.qyerUtil.doAjax(t)},submitForm_openAsk:function(t){t.posturl="/qcross/ask/json/askpopup",window.qyerUtil.doAjax(t)}},init:function(){this.initFrame()},checkOpenAskForm:function(){var n=i(t.getContent()),r=n.find("input[name='js_question_title']"),a=n.find("input[name='js_ask_fid']"),s={error:!1,data:{}};if(0==r.qyerInputValidation())return s.error=!0,s;if(this.tags.length<1)return e.tip({text:"没有标签的问题，石沉大海，无人回答哦",type:"error"}),s.error=!0,s;if(s.error===!1){s.data={title:n.find("input[name='js_question_title']").val(),content:n.find("textarea[name='js_ask_content']").val(),"tag[]":[],fid:n.find("input[name='js_ask_fid']").val(),from:o()};for(var u=0,c=this.tags.length;u<c;u++)s.data["tag[]"].push(this.tags[u])}return n=r=$tag=a=null,s},_bindEvt:function(){var n=i(t.getContent()),o=n.find(".js-dropmenu"),r=n.find(".js-dropmenu-popup"),a=n.find("input[name='js_ask_fid']"),s=this;n.off("click.popup").on("click.popup",".js-btn-submit-openAsk",function(){var n=s.checkOpenAskForm(),o=i(this);o.hasClass("ui_button_load")||n&&n.error===!1&&(s.setBtnStatus(o,1),opt={data:n.data,onSuccess:function(n){("undefined"==typeof s.option.onSuccess||"function"==typeof s.option.onSuccess&&s.option.onSuccess(n.data)!==!1)&&o.next().attr("target",s.option.target||"_self").attr("href",n.data.jumpurl)[0].click(),s.setBtnStatus(o,0),t.hide(),e.tip({text:"提问成功！经验+1"})},onError:function(t){s.option&&s.option.onError&&"function"==i.type(s.option.onError)&&s.option.onError(),s.setBtnStatus(o,0),e.tip({text:t.__server_error__?"服务器响应失败，请重试":t.data.msg,type:"error"})}},s.API.submitForm_openAsk(opt))}).on("click",".js-btn-cancel-openAsk",function(){t.hide()}).on("click",".js-dropmenu",function(){r.toggleClass("hide"),o.toggleClass("open")}).on("click",".js-dropmenu-popup .item a",function(){var t=i(this);o.toggleClass("open").find("em").text(t.text()),r.toggleClass("hide"),a.val(t.attr("data-id"))}).on("blur",'input[name="js_question_title"]',function(){s.searchTag(i(this).val())}).on("click",".js-btn-tag-close",function(){s.removeATag(i(this).parent())})},setBtnStatus:function(t,e){0===e?t.removeClass("ui_button_load ui_button_disabled").addClass("ui_button"):t.removeClass("ui_button").addClass("ui_button_load")},getForumSublistHTML:function(t,e){var n=18,e=e||1,o=n*(e-1),r=n*e-1,a="";return i.each(this.forums[t],function(t,e){var n="";if(t>=o&&t<=r){var n='<dd class="js-bbs"><a data-id="'+e.id+'" href="javascript:void(0);">'+e.name+"</a></dd>";a+=n}}),a},getTpl:function(){var t=['<h2 class="openAsk-askTitle fontYaHei p20 mt20">提问</h2>','<div class="qui-textArea openAsk-title p20" data-width="720" data-height="32">','<input placeholder="输入完整清晰的问题" class="ui2_textarea bs" name="js_question_title"/>','<div class="tips">','<span class="current"></span>/<span class="max"></span>字',"</div>","</div>",'<h2 class="openAsk-contentTitle fontYaHei p20">详细内容<em class="fz12">(可选)</em></h2>','<div class="qui-textArea openAsk-content clearfix p20" data-width="720"  data-height="128">','<textarea placeholder="在这里添加详细内容" class="ui2_textarea bs" name="js_ask_content"></textarea>','<div class="tips">','<span class="current"></span>/<span class="max"></span>字</div>',"</div>",'<dl class="tags bs p20">','<dt class="tag-title vm">标签：</dt>','<p class="tag-input-ribbon vm">','<input type="text" value="" placeholder="添加标签" class="tag-input js-tag-input" />',"</p>","</dl>",'<div class="ask-bottom-box p20 bs">','<div class="publish-box js-dropmenu">','<em class="publish-title">选择同时发布的论坛版面</em><span class="publish-arrow"></span>',"</div>\t\t\t",'<input type="button" class="ui_button fr js-btn-submit-openAsk" value="提问"/>',"<a></a>",'<input type="button" style="margin-right:10px;" class="ui_button_cancel fr mr10 js-btn-cancel-openAsk" value="取消" />','<div class="js-dropmenu-popup bbs-container hide">','<div class="item">',"<dl>","<dt>穷游兴趣小组</dt>",this.getForumSublistHTML("穷游兴趣小组"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游欧洲</dt>",this.getForumSublistHTML("穷游欧洲"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游亚洲</dt>",this.getForumSublistHTML("穷游亚洲",1),"</dl>","</div>",'<div class="item">',"<dl>",this.getForumSublistHTML("穷游亚洲",2),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游美洲</dt>",this.getForumSublistHTML("穷游美洲"),"</dl>","<dl>","<dt>穷游大洋洲</dt>",this.getForumSublistHTML("穷游大洋洲"),"</dl>","<dl>","<dt>穷游非洲</dt>",this.getForumSublistHTML("穷游非洲"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>线上线下</dt>",this.getForumSublistHTML("线上线下"),"</dl>","<dl>","<dt>后院</dt>",this.getForumSublistHTML("后院"),"</dl>","</div>","</div>","</div>",'<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="js_ask_fid" />','<input type="hidden" name="js_ask_oper" />','<input type="hidden" name="js_ask_from" />'].join("");return t},initFrame:function(){var e=this;t.show({contentHTML:'<div style="padding:100px; text-align:center;">loading</div>',
width:760,title:"提问",exClassName:"qui-openAskContainer",showTitle:!1,showOKBtn:!1,showCancelBtn:!1,onShow:function(){var n="http://common1.qyerstatic.com/qcross/bbs/thread.php?action=getForums";i.get(n,function(n){var i;0==n.error_code?(e.forums=n.data,i=e.getTpl(),t.setContent(i),e._initComponent(),e._bindEvt()):t.hide()},"json")}})},encode:function(t){var e="";return 0==t.length?"":(e=t.replace(/&/g,"&gt;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\n/g,"<br>"))},_initComponent:function(){var e=this,n=i(t.getContent()),o=n.find(".js-tag-input"),r=n.find(".openAsk-title");n.find("input[name='js_ask_fid']").val(e.option.fid),n.find(".publish-title").html(e.getFNameByID(e.option.fid)),n.find("input[name='js_ask_from']").val(e.option.from),n.find("input[name='js_ask_oper']").val(1),n.find(".openAsk-title").qyerTextArea({min:1,max:50}).end().find(".openAsk-content").qyerTextArea({max:1e3}).end().find("input[name='js_question_title']").qyerInputValidation({parent:r[0],text:"至少写够1个字，最多不超过50字",exp:function(t){return/^.{1,50}$/.test(t)}}).end().find(".js-tag-input").qyerAutocomplete({parent:o.parent()[0],onSearch:function(){function t(t){var e,n=[],i=t.data.item,o=i.length;if(o<1)n.push('<div class="qui-inputAutocomplete-noResult">没有找到任何结果</div>');else{for(e=0;e<o;e++)n.push("<li data-tag="+i[e]+"><em>"+i[e]+"</em></li>");n.unshift('<ul class="qui-inputAutocomplete-ul js-inputAutoComplete">'),n.push("</ul>")}return n.join("")}var n=o.val(),r={data:{keyword:n},onSuccess:function(e){if(e&&e.data&&"array"==i.type(e.data.item))try{o.qyerAutocomplete("pushHTML",t(e))}catch(n){}},onError:function(e){o.qyerAutocomplete("pushHTML",t(e))}};e.API.getTagByTag(r)},onSelect:function(t){e.addATag(t.getAttribute("data-tag")),o.val("")}})},searchTag:function(t){if(t){var e=this,n={data:{title:t},onSuccess:function(t){var n,i,o=t.data;if(o)for(i=0,n=t.data.length;i<n;i++)e.addATag(o[i])},onError:function(t){}};this.API.getTagByString(n)}},addATag:function(e){var n=i(t.getContent()).find(".tag-input-ribbon");this.tagIndexOfTags(e,this.tags)<0&&this.tags.length<5&&i.trim(e).length>0&&(i('<dd class="tag-item vm" title="'+e+'"><span class="tag">'+this.encode(e)+'</span><span class="btn-tag-close js-btn-tag-close"></span></dd>').insertBefore(n),this.tags.push(e),5==this.tags.length&&n.hide()),n=null},removeATag:function(t){var e=t.find(".tag").text(),n=this.tagIndexOfTags(e,this.tags);t.animate({marginTop:-40,opacity:0},200,function(){t.siblings(".tag-input-ribbon").show().end().remove()}),this.tags.splice(n,1),e=n=null},tagIndexOfTags:function(t,e){var n,i;for(n=0,i=e.length;n<i;n++)if(t===e[n])return n;return-1}};var r={qyerOpenAsk:function(t){window.qyerUtil.isLogin()?new n(t||{}):window.qyerUtil.doLogin()}};return r}}),define("common/basic/js/require-css!common/component/mguideManagePlatform/mguideManagePlatform",[],function(){}),define("common/component/mguideManagePlatform/mguideManagePlatform",["common/ui/tip/tip","common/ui/popup/popup","css!common/component/mguideManagePlatform/mguideManagePlatform.css"/*tpa=http://common1.qyerstatic.com/place/js/common/css!common/component/mguideManagePlatform/mguideManagePlatform.css*/],function(t,e){function n(t){var e=this;this.defaults={data:{index:1,title:"可以俯瞰巴黎城市的观景点介绍",author:"蝎之传说",id:"123",from:1},exClass:"",tpl:['<li class="mguideManageList fontYaHei" tid="__&id&__">','<span class="index ___&getClass&_">__&index&__</span>','<span class="title ___&getClass&_">__&title&__</span>','<span class="author">__&author&__</span>','<span class="remove"><a href="javascript:void(0)">移除运营位</a></span>',"</li>"].join(""),fnArray:{getClass:function(){var t=e.defaults.data;return t?1==t.from?"":"blue":""}}},this.defaults=$.extend(this.defaults,t||{})}function i(i){var a=function(){var t=window.location.href,e=t.match(/com\/[\w\-]+(\/(\w+)?\/?)?/),n="";return n=e[2]?e[2]:"default"}(),s={type:i&&i.type?i.type:PLACE.TYPE,pid:i&&i.pid?i.pid:PLACE.PID,classname:i&&i.classname?i.classname:a},u={onSuccess:function(o){if(!o.data.list||0==o.data.list.length)return void t.tip({text:"没有数据",type:"warning"});var a='<ul id="mguideManagePlatform">',u=o.data.list;$.each(u,function(t){var e=new n({data:u[t]});a+=e.getDom()}),a+="</ul>",e.show({contentHTML:a,onOK:function(){i&&i.onOK&&$.isFunction(i.onOK)&&i.onOK()},onCancel:function(){i&&i.onOK&&$.isFunction(i.onOK)&&i.onCancel()},title:"管理微锦囊运营位",width:700,showCancelBtn:!1}),$("#mguideManagePlatform").on("click",".remove",function(){var t=$(this),e=$(this).parents("li").attr("tid");r({id:e,type:s.type,pid:s.pid,classname:s.classname,callback:function(){t.parents("li").remove(),$("#mguideManagePlatform").find("li").each(function(t){var e=parseInt(t,10)+1;$(this).find(".index").html(e)})}})})},onError:function(e){t.tip({text:"请求错误",type:"warning"})}},c={data:s,onSuccess:u.onSuccess,onError:u.onError,url:o.getMguideList};i&&i.testData&&(c.testData=i.testData),qyerUtil.doAjax(c)}var o={removemguide:"http://common1.qyerstatic.com/mguide.php?action=removeFromWhite",getMguideList:"http://common1.qyerstatic.com/mguide.php?action=getBusinessList"};n.prototype.getDom=function(){var t=this;if(t.defaults.data){var e=t.defaults.tpl.replace(/___&[\w]{1,15}&_/g,function(e){var n=/___&([\w]{1,})&_/.exec(e)[1];return t.defaults.fnArray[n]?t.defaults.fnArray[n].call(t):""});e=e.replace(/__&[\w]{1,15}&__/g,function(e){var n=/__&([\w]{1,})&__/.exec(e)[1];return t.defaults.data[n]})}return t.dom=e,t.dom},n.prototype.setData=function(t){var e=this;e.defaults.data=t,e.getDom()},n.prototype.getData=function(){return me.defaults.data||""};var r=function(e){if(!e.id)return void t.tip({text:"缺少微锦囊ID",type:"warning"});if(""==$.trim(e.classname)){var n=window.location.href,i=n.match(/com\/[\w\-]+(\/(\w+)?\/?)?/),r="";r=i[2]?i[2]:"default",e.classname=r}qyerUtil.doAjax({data:{id:e.id,pid:e.pid||PLACE.PID,type:e.type||PLACE.TYPE,classname:e.classname},url:o.removemguide,testData:e.testData,onSuccess:function(n){t.tip({text:n.data.msg,type:n.data.icon||""}),$.isFunction(e.callback)&&e.callback.call(this,n)},onError:function(e){t.tip({text:"移除失败",type:"error"})}})},a={show:function(t){return qyerUtil.isLogin()?void i(t):void qyerUtil.doLogin()}};return a}),define("project/js/country/url",[],function(){"use strict";return{getCountryRecommendPlan:"http://common1.qyerstatic.com/country.php?action=get_country_recommend_plan&country_id=<%=id%>"}}),function(t,e){var n=e(t);if("function"==typeof define&&define.amd)define("common/util/template/template",[],function(){return n});else if("object"==typeof exports)module.exports=n;else{var i=t.template;n.noConflict=function(){return t.template===n&&(t.template=i),n},t.template=n}}(this,function(t){"use strict";function e(t){if(null===t)return"null";var e=typeof t;if("object"!==e)return e;var n=_.call(t).slice(8,-1).toLowerCase();return"object"!==n?n:t.constructor==Object?n:"unkonw"}function n(t){return"object"===e(t)}function i(t){return"function"===e(t)}function o(t){return"string"===e(t)}function r(){for(var t=arguments[0]||{},e=b.call(arguments,1),n=e.length,i=0;i<n;i++){var o=e[i];for(var r in o)t[r]=o[r]}return t}function a(){var t=b.call(arguments);return r.apply(null,[{}].concat(t))}function s(t){return t}function u(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"&#92;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(t){return t.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")}function l(t,e){"undefined"!=typeof console&&console[t]&&console[t](e)}function p(t){function e(){return"template.js error"}var n="template.js error\n\n";for(var i in t)n+="<"+i+">\n"+t[i]+"\n\n";return n+="<message>\n"+t.message+"\n\n",l("error",n),g.error(t),e.toString=function(){return'__code__ = "template.js error"'},e}function d(t,e){function n(t){return t=t.replace(/('|")/g,"\\$1").replace(/\n/g," "),';__code__ += ("'+t+'")\n'}function i(t){var e,n,i,r=/^(?:=|:(.*?)=)(.*)$/;return(n=r.exec(t))?(e=n[2],i=o(n[1])?n[1]:u?"h":"",';__code__ += __modifierMap__["'+i+'"](typeof ('+e+') !== "undefined" ? ('+e+') : "")\n'):";"+t+"\n"}for(var r="",a=e.sTag,s=e.eTag,u=e.escape,c=t.split(a),l=0,p=c.length;l<p;l++){var d=c[l].split(s);1===d.length?r+=n(d[0]):(r+=i(d[0],!0),d[1]&&(r+=n(d[1])))}return r}function f(t,e){var n=d(t,e),i='\n    var html = (function (__data__, __modifierMap__) {\n        var __str__ = "", __code__ = "";\n        for(var key in __data__) {\n            __str__+=("var " + key + "=__data__[\'" + key + "\'];");\n        }\n        eval(__str__);\n\n',o="\n        ;return __code__;\n    }(__data__, __modifierMap__));\n    return html;\n",r=i+n+o;r=r.replace(/[\r]/g," ");try{var a=new Function("__data__","__modifierMap__",r);return a.toString=function(){return n},a}catch(s){throw s.temp="function anonymous(__data__, __modifierMap__) {"+r+"}",s}}function h(t,e){function n(n){n=a(v,n);try{var o=i(n,y);return o=e.compress?c(o):o}catch(r){return r.name="RenderError",r.tpl=t,r.render=i.toString(),p(r)()}}e=a(g,e);try{var i=f(t,e)}catch(o){return o.name="CompileError",o.tpl=t,o.render=o.temp,delete o.temp,p(o)}return n.toString=function(){return i.toString()},n}function m(t,e){if("string"!=typeof t)return"";var i=h(t);return n(e)?i(e):i}var g={sTag:"<%",eTag:"%>",compress:!1,escape:!0,error:function(t){}},v={},y={"":function(t){return s(t)},h:function(t){return u(t)},u:function(t){return encodeURI(t)}},_={}.toString,b=[].slice;return m.config=function(t){return n(t)&&(g=r(g,t)),a(g)},m.registerFunction=function(t,e){return o(t)?i(e)?v[t]=e:v[t]:a(v)},m.unregisterFunction=function(t){return!!o(t)&&(delete v[t],!0)},m.registerModifier=function(t,e){return o(t)?i(e)?y[t]=e:y[t]:a(y)},m.unregisterModifier=function(t){return!!o(t)&&(delete y[t],!0)},m.__encodeHTML=u,m.__compress=c,m.__handelError=p,m.__compile=h,m.version="0.7.0",m}),define("common/util/template",["./util","./template/template"],function(t){return template.registerFunction("comm_poi_getstar",function(){return t.getStarHtml.apply(t,arguments)}),{registerFunction:template.registerFunction,render:function(t,e){return template(t,e||{})}}}),define("project/js/country/service",["common/service/service","./url","common/util/template"],function(t,e,n){"use strict";var i={getCountryRecommendPlan:function(i,o,r){return t.get(n.render(e.getCountryRecommendPlan,{id:i||PLACE.PID}),{},o||function(){},r||function(){})}};return i}),define("project/js/country/tpls",[],function(){return{schedule:$("#js-schedule-tpl").html()}}),define("common/component/copyPlan/copyPlan",["common/ui/popup/popup","common/ui/tip/tip"],function(t,e){var n=jQuery,i={copyPlan:function(t){t.posturl="http://common1.qyerstatic.com/public.php?action=copyplan",qyerUtil.doAjax(t)},getToken:function(t){t.posturl="http://common1.qyerstatic.com/public.php?action=getplantoken",qyerUtil.doAjax(t)}},o={show:function(o){function r(){var r=o.planid;t.show({title:"给行程起个名字吧",width:460,contentHTML:'<div><input class="ui3_input js_planname" placeholder="请输入行程名称" style="width:400px;"/></div>',onOK:function(){var s=n(t.getContent()).find(".js_planname").val();return(s=n.trim(s))?s.length>18?(e.tip({text:"标题最多18个汉字",type:"warning"}),!1):(i.copyPlan({data:{planid:r,title:s,token:a},onSuccess:function(n){e.tip({text:"行程复制成功",type:"ok"}),t.hide(),o.isJump===!0&&n.data&&n.data.url&&qyerUtil.openUrl(n.data.url),o.onSuccess&&o.onSuccess(n.data),r=s=null},onError:function(n){e.tip({text:n.data.msg,type:"error"}),t.setOption({showLoadBtn:!1,showOKBtn:!0})}}),t.setOption({showLoadBtn:!0,showOKBtn:!1}),!1):(e.tip({text:"请输入行程名称",type:"warning"}),!1)}})}var a;qyerUtil.isLogin()?r():i.getToken({onSuccess:function(t){a=t.data,r()},onError:function(t){e.tip({text:t.data.msg,type:"error"})}})}};return o}),define("project/js/country/schedule",["./service","./tpls","common/util/template","common/widget/widget","common/component/copyPlan/copyPlan"],function(t,e,n,i,o){var r=i.createClass({init:function(){this.callSuper.apply(this,arguments),this.get()},get:function(){this.service()},service:function(e){return t.getCountryRecommendPlan(e||PLACE.PID,$.proxy(function(t){this._success.apply(this,[].slice.call(arguments))},this),$.proxy(function(t){this._error.apply(this,[].slice.call(arguments))},this))},_success:function(){this.success.apply(this,[].slice.call(arguments))},_error:function(){this.error.apply(this,[].slice.call(arguments))},checkData:function(t){return t&&t.data&&t.data.planlist&&t.data.planlist.length},success:function(t){var e=this.checkData(t);return e?void this.render(t):void this.always(t)},render:function(t){var e=n.render(this.getStatic().tpl,t.data);this.$(".qyWrap").html(e)},error:function(t){this.always(t)},always:function(t){this.$().remove(),this.destroy()},switchTab:function(){this.tab.apply(this,arguments)},tab:function(t){var e=$(t.currentTarget),n=e.parent().index(),i=this.getStatic().CLASSNAME.current;this.$(".plcRouteTags > li").removeClass(i).eq(n).addClass(i),this.$(".plcRouteContent").hide().eq(n).show()},login:function(){return!!qyerUtil.isLogin()||(qyerUtil.doLogin(),!1)},copyPlan:function(t){this.login()&&o.show({planid:$(t.currentTarget).parents(".plcRouteContent").attr("data-id"),isJump:!0})},events:[["mouseover.schedule","switchTab",".plcRouteTags > li > span"],["click.schedule","copyPlan",".copyPlanBtn"]]},{tpl:e.schedule,CLASSNAME:{current:"current"}});return r}),$(function(){function t(){function t(t){var e=$(".plcTopBarStat em").eq(0),n=e.text();n=parseInt(n,10)+t,e.text(n)}require(["common/widget/userbehavior/widget-userbehavior"],function(e){var n=new e({$el:$("#js-plcFootPrint"),type:PLACE.TYPE,id:PLACE.PID,exClass:"place-exClass"}).after("handleSuccess",$.proxy(function(e,n){var i=$(e);"beento"==i.attr("data-type")&&t(1==i.attr("data-status")?1:-1)},n))})}$(".topTrackCode").on("click",function(){var t=$(this),e=t.hasClass("selected");qyerUtil.doTrackCode(t.attr("data-ipg-"+(e?"delete":"add")))}),$(".plcContainer:odd").addClass("odd"),$("http://common1.qyerstatic.com/place/js/common/img.lazy").lazyload({effect:"fadeIn"}),require(["project/js/slider"],function(t){var e=$("#focusPhoto");t({prev:e.find(".prev"),next:e.find(".next"),content:e.find(".plcFocusPhotoList")}),e.find(".photoAdmin").click(function(){requirejs(["common/component/manageCover/manageCover"],function(t){t.show({pid:PLACE.PID,type:PLACE.TYPE})})})}),window.__userStatusCallBack?(window.__userStatusCallBack_old=window.__userStatusCallBack,window.__userStatusCallBack=function(e){window.__userStatusCallBack_old.call(window,e),t.call(window,e)}):window.__userStatusCallBack=function(e){t.call(window,e)},require(["project/js/slider"],function(t){var e=$("#expScrollModule"),n=3e3*e.find(".plcShareExpList li").eq(0).find(".text").length;t({prev:e.find(".prev"),next:e.find(".next"),content:e.find(".plcShareExpList"),autoPlay:!0,showTime:n})}),require(["project/js/qyguide"]),require(["project/js/slider"],function(t){var e=$(".plcHotCityContent");t({prev:e.find(".prev"),next:e.find(".next"),content:e.find(".plcHotCityLists"),loop:!1,onAnimate:function(t,e){if(0!=t){var n=$(e).find("img[data-original]");n.each(function(t,e){var n=$(this).attr("src"),i=$(this).attr("data-original");n!==i&&$(this).attr("src",i)})}}})}),require(["project/js/slide"],function(t){t({content:$("#mguideLists"),prev:$("#mguidePagePrev"),next:$("#mguidePageNext")})}),require(["project/js/discuss"]),requirejs(["project/js/comentRankUser"]),$(".js-shareExpBtn").on("click",function(){var t=PLACE.PID,e=PLACE.TYPE;require(["common/component/shareExp/shareExp"],function(n){n.show({id:t,type:e})})}),$(".js-askBtn").on("click",function(){requirejs(["common/component/openAsk/openAsk"],function(t){t.qyerOpenAsk({onSuccess:function(){return!1}})})}),$("#plcMguideManage").length>0&&$("#plcMguideManage").on("click",function(){require(["common/component/mguideManagePlatform/mguideManagePlatform"],function(t){t.show()})}),require(["project/js/country/schedule"],function(t){var e=new t({$el:$("#js-country-schedule")}).after("success",$.proxy(function(){this.$(".plcRouteContent").hide().eq(0).show()},e)).before("always",$.proxy(function(){this.$().removeClass("place-loading")},e)).after("always",$.proxy(function(){$(".plcContainer").removeClass("odd"),$(".plcContainer:odd").addClass("odd")},e))})}),define("project/js/country",function(){}),function(t){var e=document,n="appendChild",i="styleSheet",o=e.createElement("style");o.type="text/css",e.getElementsByTagName("head")[0][n](o),o[i]?o[i].cssText=t:o[n](e.createTextNode(t))}(".qui-popup{\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    background-image:url(http://common2.qyerstatic.com/place/common/basic/images/bg_255_255_255_0.7.png);\n    z-index: 1000;\n    overflow-y: auto;\n    opacity: 0;\n}\n.qui-popup > div{\n    display: table;\n    height: 100%;\n    margin: 0 auto;\n}\n.qui-popup-dt{\n    display: table-cell;\n    vertical-align:middle;\n}\n.qui-popup-box{\n    margin: 0 auto;\n    background-color: #fff;\n    position: relative;\n    -webkit-box-shadow: 0 0 6px #aaa;\n    -moz-box-shadow: 0 0 6px #aaa;\n    box-shadow: 0 0 6px #aaa;\n    border: solid 1px #ccc;\n    \n    opacity: 0;\n}\n.qui-popup-box-title{\n    height: 60px;\n    line-height: 60px;\n    font-size: 18px;\n    font-weight: bold;\n    padding-left: 20px;\n}\n.qui-popup-box-content{\n    -webkit-box-sizing: border-box; \n    -moz-box-sizing: border-box;  \n    box-sizing: border-box; \n    padding: 0 20px;\n}\n.qui-popup-box-content >iframe{\n    width: 100%;\n    border: none;\n}\n.qui-popup-box-bottom{\n    text-align: right;\n    height: 70px;\n    line-height: 70px;\n    padding-right: 20px;\n}\n.qui-popup-closeIcon{\n    position: absolute;\n    right: 10px;\n    top: 10px;  \n    cursor: pointer;\n    background-image: url(\"../../../../common2.qyerstatic.com/place/common/ui/popup/ico.png\"/*tpa=http://common2.qyerstatic.com/place/common/ui/popup/ico.png*/);\n    height: 32px;\n    width: 32px;\n    background-repeat: no-repeat;\n    background-position:0 0;\n    border-radius: 5px;\n}\n.qui-popup-closeIcon:hover{\n    background-position: 0px -38px;\n}\n.qui-popup-cancelBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-okBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-loadingBtn{\n    vertical-align: middle;\n    display: none;\n    margin-left:10px;\n}.qui-errorip{\n    border: 1px solid #d0312b !important; \n}\n.qui-errorip-textDiv{border:solid 1px #d0312b; background-color: #ffcccd; color:#88777c; position: absolute; z-index: 2000; }\n.qui-errorip-textDiv > .tip{display: block; position: absolute; left: 5px; top: 0; }\n.qui-errorip-textDiv > .tip > p{position:absolute; width:0; height:0; }\n.qui-errorip-textDiv > .tip > .a1{top:-5px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-bottom:5px solid #CB0013; }\n.qui-errorip-textDiv > .tip > .a2{top:-4px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-bottom:5px solid #FFCCCD; }\n.qui-errorip-textDiv > .text{padding: 0 5px; }\n.qui-errorip-textDiv1 {border:solid 1px #ebb75a; background-color: #fff894; color:#222222; position: absolute; z-index: 2000;border-radius: 3px; }\n.qui-errorip-textDiv1 > .tip{display: block; position: absolute; left: 50%; bottom: -5px;margin-left: -5px; }\n.qui-errorip-textDiv1 > .tip > p{position:absolute; width:0; height:0; }\n.qui-errorip-textDiv1 > .tip > .a1{top:-4px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-top:5px solid #ebb75a; }\n.qui-errorip-textDiv1 > .tip > .a2{top:-5px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-top:5px solid #fff894; }\n.qui-errorip-textDiv1 > .text{max-width: 300px; overflow: hidden; padding: 0 8px; text-overflow: ellipsis; white-space: nowrap;}\n.qui-siglComment{clear:both;margin-top:-40px;}\n.siglComment-title{width:80px;height:80px;float:left;}\n.siglComment-title img{width:80px;height:80px;}\n.siglComment-info{margin-left:90px;height:80px;margin-right:50px;}\n.siglComment-cn{font-size:18px;font-family:\"microsoft YAHEI\";display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}\n.siglComment-cn a{color:#636363;}\n.siglComment-en{font-size:14px;display:block;height:20px;padding-bottom:10px;}\n.siglComment-en a{color:#959595;}\n.siglComment-stars{height:22px;}\n.siglComment-stars .star{cursor:pointer;padding-right:5px;width:22px;height:22px;float:left;background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/icon_star.png);background-repeat:no-repeat;background-position:-27px center;}\n.siglComment-stars .level{float:left;margin-left:20px;margin-top:5px;color:#959595;}\n.siglComment-stars .star-on{background-position:left center;}\n.siglComment-detail{overflow:hidden;clear:both;margin-top:15px;}\n.siglComment-detail .ui3_textarea{width:638px;height:104px;min-height:104px;padding:2px 5px 0px;display: block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;z-index: 10;position: relative;overflow: hidden;}\t\n.qui-siglComment .red{color:#f00;}  \n.siglComment-camera{height:30px;color:#959595;border:solid 1px #c0c0c0;margin-top:-1px;line-height:32px;overflow:hidden;}  \n.siglComment-camera input[type=file]{display:none;}\n.siglComment-camera label{background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/camera.png);background-repeat:no-repeat;background-position:left center;padding-left:20px;color:#0072bc;margin:0px 10px;cursor:pointer;}\n.siglComment-camera label:hover{text-decoration:underline;}\n.siglComment-camera~ .tips{margin-top:5px;}\n.siglComment-photolist{overflow: hidden;}\n.siglComment-photolist li{float:left;position: relative;width:80px;height:80px;padding:10px 0 10px 10px;float:left;overflow: hidden;}\n.siglComment-photolist li img{width:80px;height:80px;}\n.siglComment-photolist li .close{cursor:pointer;position:absolute;right:-1px;top:9px;background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/close.png);background-repeat:no-repeat;background-position:left top;width:20px;height:20px;border:solid 1px transparent;}\n.siglComment-photolist li .close:hover{background-position:left bottom;width:20px;height:20px;border:solid 1px transparent;}\n.siglComment-photolist .add{background:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/icon-add.png) no-repeat 10px 10px;cursor: pointer;position: relative;}\n#siglCommentPhotoUp{display: inline-block;width: 100%;height: 100%;}  \n#siglCommentPhotoUp .moxie-shim-html5{left:0px!important;top:0px!important;}\n.uploadpopup .p10{padding: 10px;}\n.uploadpopup .mr10{margin-right: 10px;}@charset \"utf-8\";\n@charset \"utf-8\";\n@font-face {\n    font-family: 'Place';\n    src: url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot*/); \n    src: url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot*/) format('embedded-opentype'), \n    url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_iconfont.woff'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.woff*/) format('woff'), \n    url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_iconfont.ttf'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.ttf*/) format('truetype'),\n    url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_iconfont.svg'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.svg*/) format('svg'); \n}\n@font-face {font-family: \"exPlace\";\n  src: url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot*/);\n  src: url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot*/) format('embedded-opentype'), \n  url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.woff'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.woff*/) format('woff'), \n  url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.ttf'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.ttf*/) format('truetype'),\n  url('../../../../static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.svg'/*tpa=http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.svg*/) format('svg'); \n}\n.place-iconfont, .poi-discount .iconfont{\n  font-family:\"Place\" !important;\n  font-size:16px;\n  font-style:normal;\n  -webkit-font-smoothing: antialiased;\n  -webkit-text-stroke-width: 0.2px;\n  -moz-osx-font-smoothing: grayscale;\n}\n@charset 'utf-8';\n.poiRedPoint{\n\tborder: solid 2px #fff;\n\tbackground: #ff6763;\n\tborder-radius: 50%;\n\twidth: 12px;\n\theight: 12px;\n\tdisplay: none;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 0;\n\tmargin-left: 9px;\n\tz-index: 15;\n}\n.poiLikeTip{\n\twidth: 300px;\n\theight: 122px;\n\tposition: absolute;\n\tleft: 50%;\n\tmargin-left: -150px;\n\ttop: 43px;\n\tz-index: 16;\n\tbackground: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeTip.png) no-repeat left top;\n\tbackground-size: 300px 122px;\n\tcolor: #444!important;\n\tdisplay: none;\n}\n.poiLikeTip .close{\n\tposition: absolute;\n\tz-index:1;\n\tfont-size:20px;\n\tright: 5px;\n\ttop:10px;\n\theight: 26px;\n\tline-height: 24px;\n\twidth: 26px;\n\tcolor: #c0c0c0;\n\tbackground-image: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeClose.png);background-repeat: no-repeat;\n\tbackground-position: 3px 0px; \n\tbackground-size: 50px 25px;\n\tcursor: pointer;\n}\n.poiLikeTip .close:hover{\n\tbackground-position: -25px 0px;\n\tcolor: #fff;\n}\n.poiLikeTip .neverShow{\n\tposition: absolute;\n\tleft: 10px;\n\tbottom: 10px;\n\tcolor: #959595;\n}\n.poiLikeTip .neverShow:hover{\n\tcolor: #3f9f5f;\n}\n.poiLikeTip .text{\n\theight: 18px;\n\tline-height: 18px;\n\tcolor: #636363;\n\ttext-align: left;\n\tfont-size: 14px;\n\tpadding-left: 10px;\n\ttext-indent: 0px;\n}\n.poiLikeTip .t1{\n\tmargin-top: 16px;\n}\n.poiLikeTip em{\n\tfont-style: normal;\n\tfont-size: 16px;\n\tfont-weight: bold;\n}\n.poiLikeSmallTip{\n\twidth: 234px;\n\theight: 32px;\n\tdisplay: none;\n\tbackground: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeSmallTip.png) no-repeat left top;\n\tbackground-size: 234px 32px;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 43px;\n\tmargin-left: -117px;\n\tline-height: 36px;\n\tcolor: #959595!important;\n}\n.place-userbehavior .planto:hover .poiLikeHoverShow{\n\tdisplay: block;\n\tz-index: 5;\n}\n.poiLikeShow{\n\tdisplay: block!important;\n}\n.place-userbehavior .selected .poiLikeShow,\n.place-userbehavior .selected .poiLikeHoverShow{\n\tdisplay: none!important;\n}\n.place-ubloading{\n\tposition: relative;\n\tmin-height: 70px;\n}\n.place-ubloading:before{\n\tcontent: '';\n\tposition: absolute;\n\tleft: 0;\n\twidth: 100%;\n\theight: 70px;\n\ttop: 0;\n\tz-index: 10;\n\tbackground: rgba(255, 255, 255, 0.6) url(http://static.qyer.com/models/common/images/wait_16_2.gif) no-repeat center center;\n}\n.place-userbehavior{\n\theight: 84px;\n\tdisplay: table;\n\twidth: 100%;\n\tbox-sizing: border-box;\n}\n.place-userbehavior > li{\n\tcursor: pointer;\n\tdisplay: table-cell;\n\tposition: relative;\n\ttext-align: center;\n\theight: 84px;\n\tz-index: 1;\n}\n.place-userbehavior > li:before,\n.place-userbehavior > li:after{\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 0;\n\twidth: 40px;\n\theight: 40px;\n\tmargin-left: -20px;\n\tcontent: '';\n}\n.place-userbehavior > li:before{\n\tfont-family: 'Place'!important;\n\tfont-size: 24px;\n\tcolor: #fff;\n\tfont-style:normal;\n  \t-webkit-font-smoothing: antialiased;\n  \t-webkit-text-stroke-width: 0.2px;\n  \t-moz-osx-font-smoothing: grayscale;\n  \ttext-align: center;\n  \tline-height: 40px;\n  \tz-index: 12;\n}\n.place-userbehavior .planto:before{\n\tcontent: '\\e639';\n}\n.place-userbehavior .beento:before{\n\tcontent: '\\e63b';\n}\n.place-userbehavior .lived:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e890';\n}\n.place-userbehavior .addToPlan:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e893';\n}\n.place-userbehavior > li:after{\n\tbackground-color: rgb(67, 158, 97);\n\tborder-radius: 50%;\n\tz-index: 7;\n}\n.place-userbehavior > li:hover{\n\tcolor: rgb(20, 120, 80);\n}\n.place-userbehavior > li:hover:after{\n\tbackground-color: rgb(95, 172, 121);\n}\n.place-userbehavior > li.selected:after{\n\tbackground-color: rgb(236, 236, 236);\n}\n.place-userbehavior > li.selected:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e892';\n\tcolor: rgb(95, 172, 121);\n\tfont-weight: bold;\n}\n.place-userbehavior > li.selected:hover:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e891';\n\tfont-weight: bold;\n}\n.place-userbehavior .fonts{\n\tfont-size:16px;\n\tposition: absolute;\n\twidth: 75px;\n\tmargin-left: -37px;\n\ttop: 50px;\n\tz-index: 4;\n\tleft: 50%;\n}\n.place-userbehavior .beento ul li,\n.place-userbehavior .beento ul{\n\tdisplay: none;\n}\n.place-userbehavior .beento.selected ul{\n\tposition: absolute;\n\tborder: solid 4px #ececec;\n\twidth: 0;\n\theight: 0;\n\tborder-top:solid 4px transparent;\n\tborder-left:solid 4px transparent;\n\ttop:100%;\n\tleft: 100%;\n\tmargin: -15px 0 0 -10px;\n\tdisplay: block;\n}\n.place-userbehavior .beento.selected:hover ul li{\n\tdisplay: block;\n}\n.place-userbehavior .beento.selected:hover ul{\n\twidth: 100px;\n\tleft: 50%;\n\ttop: -7px;\n\tmargin:0 0 0 -50px;\n\tpadding-top: 87px;\n\tdisplay: block;\n\tborder: 1px solid #d7d7d7;\n\tbox-shadow: 0 0 4px rgba(0,0,0,0.15);\n\tbackground-color: #fff;\n\theight: auto;\n}\n.place-userbehavior .beento li{\n\tline-height: 32px;\n\tborder-top: #ececec solid 1px;\n\tmargin: 0 10px;\n\ttext-align: left;\n\ttext-indent: 3px;\n}\n.place-userbehavior .beento li a{\n\tcolor: #959595;\n\tdisplay: block;\n}\n.place-userbehavior .beento li a:hover{\n\tcolor: #0073b6;\n\ttext-decoration: none;\n}\n.place-userbehavior li.addToPlan:hover{\n\tcolor: #0073b6;\n}\n.place-userbehavior li.addToPlan:after{\n\tbackground-color: rgb(37, 150, 218);\n}\n.place-userbehavior li.addToPlan:hover:after{\n\tbackground-color: rgb(65, 166, 244);\n}\n.plcFootprint{\n\tpadding-top: 20px;\n\theight: 84px;\n}\n.plcZIndex{\n\tz-index: 2!important;\n}\n.place-exClass{\n\tposition: relative;\n}\n.place-exClass .beento.selected:hover ul{\n\tpadding-top: 101px!important;\n\ttop: -21px;\n}\n.place-exClass .beento.selected:hover li{\n\tdisplay: block;\n}\n.qui-tip{\n\tposition: fixed;\n\ttop: 100px;\n\tleft: 0;\n\twidth: 100%;\n\ttext-align: center;\n\tdisplay: none;\n\tz-index: 1100;\n}\n.qui-tip-box{\n\tdisplay: inline-block;\n\tmin-width:120px;\n\tmax-width:390px;\n\tpadding:20px 30px;\n\tbackground-color:#fff;\n\tbox-shadow: 0 2px 7px rgba(0,0,0,0.25);\n\tborder: solid 1px #c0c0c0;\n\ttext-align:left;\n\tfont-size: 18px;\n\tline-height: 32px;\n}\n.qui-tip-text { display:block; position:relative; padding-left:34px;}\n.qui-tip-text:before { content:''; position:absolute; left:0; top:4px; width:24px; height:24px; background:#fff url(http://common2.qyerstatic.com/place/common/ui/tip/icons2.png) no-repeat;}\n.qui-tip-box-error .qui-tip-text:before { background-position:0 -80px;}\n.qui-tip-box-warning .qui-tip-text:before { background-position:0 -40px;}.qui-inputAutocomplete{\n\tposition: absolute;\n\tz-index: 1100;\n\tbackground-color: #fff;\n\tborder: solid 1px #eee;\n}\n.qui-inputAutocomplete-ul{\n}\n.qui-inputAutocomplete-ul li{\n\theight: 32px;\n\tline-height: 32px;\n\tborder-bottom: solid 1px #eee;\n    background-color: #fff;\n    cursor: pointer;\n    word-break: keep-all;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n.qui-inputAutocomplete-ul li:hover,\n.qui-inputAutocomplete-ul li[data-select=true]{\n\tbackground-color: #e0f1de;\n}\n.qui-inputAutocomplete-ul li.disableDefalut{\n    background-color: #fff !important;\n    cursor: default;\n}\n.qui-inputAutocomplete-noResult{\n\tcolor:red;\n}\n.qyer_inputAutocomplete_name { padding:0 5px 0 10px;}\n.qyer_inputAutocomplete_name .current { color:#077345;}\n.qyer_inputAutocomplete_en { padding-right:10px; font-family:Tahoma, Geneva, sans-serif;}\n.qyer_inputAutocomplete_found { color:#959595; padding-right:10px;}\n.qyer_inputAutocomplete_creat { padding:10px;}.qui-openAskContainer .fz12{font-size:12px;}\n.qui-openAskContainer .vm{vertical-align: middle;}\n.qui-openAskContainer .bs{box-sizing:border-box; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; -ms-box-sizing:border-box;}\n.qui-openAskContainer .p20{padding:0 20px;}\n.qui-openAskContainer .mt20{margin-top:20px;}\n.qui-openAskContainer .qui-popup-box-content{padding:0px;}\n.qui-openAskContainer .qui-popup-box-bottom{display:none;}\n.qui-openAskContainer .hide{display:none;}\n.qui-openAskContainer .disableDefalut{display:none;}\n.qui-openAskContainer .qui-textArea{display:block; margin-top:10px;}\n.qui-openAskContainer  .qui-textArea  textarea,\n.qui-openAskContainer  .qui-textArea  input{width:100%; height:100%; font-size:14px; }\n.qui-openAskContainer  .qui-textArea  textarea{line-height:1.5;}\n.qui-openAskContainer  .qui-textArea  input{line-height:1;}\n.qui-openAskContainer  .qui-textArea  .tips{margin-top:6px; font-size:12px; color:rgb(149,149,149);}\n.qui-openAskContainer  .openAsk-askTitle{font-size:18px; line-height:20px; }\n.qui-openAskContainer  .openAsk-title { height:32px;}\n.qui-openAskContainer  .openAsk-content {height:128px;}\n.qui-openAskContainer  .openAsk-contentTitle{font-size:14px; line-height:16px; margin-top:40px;}\n.qui-openAskContainer  .tags{height:48px; margin-top:60px; border-top:1px solid rgb(195,195,195); border-bottom:1px solid rgb(195,195,195); background:rgb(224,241,223); position:relative; z-index:101; font-size:0; }\n.qui-openAskContainer  .tags  .tag-title,\n.qui-openAskContainer  .tags  .tag-item,\n.qui-openAskContainer  .tags  .tag,\n.qui-openAskContainer  .tags  .btn-tag-close,\n.qui-openAskContainer  .tags  .tag-input-ribbon{display:inline-block;}\n.qui-openAskContainer  .tags  .tag-title{height:48px; line-height:48px; font-size:12px;}\n.qui-openAskContainer  .tags  .tag-item {float: none; margin-right:10px; font-size:12px;}\n.qui-openAskContainer  .tags  .tag-item  .tag{float:left; padding:0 5px 0 12px; line-height:24px; background:url(http://static.qyer.com/images/bbs/two/tag_bg.png) no-repeat; color:#FFF; max-width:85px; overflow:hidden; text-overflow:ellipsis; white-space: nowrap;}\n.qui-openAskContainer  .tags  .tag-item  .btn-tag-close{float:left; width:22px; height:24px; background:url(http://static.qyer.com/images/bbs/two/tag_bg.png) no-repeat left -30px; cursor:pointer;}\n.qui-openAskContainer  .tags  .tag-item  .btn-tag-close:hover{background-position:left -60px;}\n.qui-openAskContainer  .tags  .tag-input-ribbon em{padding:0 6px; font-size:12px;}\n.qui-openAskContainer  .tags  .tag-input-ribbon input{width:120px; height:22px; padding:0 6px; font-size:12px; box-sizing:border-box; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; -ms-box-sizing:border-box; line-height:1;}\n.qui-openAskContainer  .ask-bottom-box{position:relative; padding:20px; height:70px;}\n.qui-openAskContainer  .ask-bottom-box .publish-box{position:relative; float:left; border:1px solid rgb(192,192,192); padding:0 50px 0 10px; line-height:22px; cursor:pointer;}\n.qui-openAskContainer  .ask-bottom-box .publish-box:hover{border:1px solid #999;}\n.qui-openAskContainer  .ask-bottom-box .publish-box  .publish-arrow{position:absolute; right:10px; top:9px; width:0; height:0; overflow: hidden; border:4px solid rgba(0,0,0,0); border-top-color:rgb(149,149,149); border-bottom-width:0; cursor:pointer;}\n.qui-openAskContainer  .ask-bottom-box .publish-box.open .publish-arrow{border:4px solid rgba(0,0,0,0); border-bottom-color:rgb(149,149,149); border-top-width:0;}\n.qui-openAskContainer .bbs-container{position:absolute; top:-357px; white-space: nowrap; font-size:0; z-index:2001; border:1px solid rgb(192,192,192); background-color:#FFF; padding:10px 30px 10px 10px; overflow:hidden;}\n.qui-openAskContainer .bbs-container .item{display:inline-block; vertical-align:top; padding-left:30px; margin-bottom:-30px; font-size:12px;}\n.qui-openAskContainer .bbs-container .item:first-child{padding-left:0;}\n.qui-openAskContainer .bbs-container dl{margin-bottom:30px;}\n.qui-openAskContainer .bbs-container dt{font-weight:700; margin-bottom:6px; line-height:14px;}\n.qui-openAskContainer .bbs-container a{display:block; line-height:24px; padding:0 6px; color:rgb(99,99,99);}\n.qui-openAskContainer .bbs-container a:hover{background-color:#ececec;color:#0073b6;text-decoration:none;}\n.qui-inputAutocomplete .qui-inputAutocomplete-noResult{padding-left:6px;border:1px solid #d7d7d7;line-height:22px;color:#959595;font-size:12px;}\n@charset \"utf-8\";\n#mguideManagePlatform{overflow: hidden;}\n#mguideManagePlatform .mguideManageList{height: 22px;line-height: 22px;font-size: 14px;overflow: hidden;}\n#mguideManagePlatform .index{font-weight: bold;width: 50px;text-align:center;float: left}\n#mguideManagePlatform .title{float:left;width: 400px;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;}\n#mguideManagePlatform .author{float:left;width:100px;overflow: hidden;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;}\n#mguideManagePlatform .remove{float:left;width: 75px;float: left;}\n#mguideManagePlatform .blue{color:rgb(0,128,0);}"),
$(function(){$("#addGuideComment").submit(function(){var thiz=this,opts={success:function(txt){var ret;if(eval("ret="+txt),"ok"==ret.result){tips.show("评论成功");var u=window.location.href;u=u.replace(/#guide\d+/i,""),u=u.replace(/#cmt$/i,""),u=u.replace(/rnd=\d+/i,""),u=u.replace(/&+$/,""),u=u+"&rnd="+ +new Date,u+="#cmt",window.location.href=u}else 77==ret.error_code?ajaxlogin():tips.show(ret.data.msg)},beforeSubmit:function(){var t=$("#guideipt").val(),e=140-comment.getwordcount(t);return e>=0||(e=Math.abs(e),void tips.show("超出"+Math.floor(e/2)+"字"))}};return islogin(function(){$(thiz).ajaxSubmit(opts)}),!1}),$(".jscomment").toggle(function(){var t=this,e=$(t).attr("alt");$("#iptcomment"+e).show(),$("#replylist"+e).fadeIn();var n="iptcomment"+e;$("#"+n).show(),comment.guideReplyList(e,3)},function(){var t=this,e=$(t).attr("alt");$("#iptcomment"+e).hide(),$("#replylist"+e).fadeOut()}),$(".jspoicomment").toggle(function(){var t=this,e=$(t).attr("alt");$("#iptcomment"+e).show(),$("#replylist"+e).show();var n="iptcomment"+e;$("#"+n).show(),comment.poiReplyList(e,3)},function(){var t=this,e=$(t).attr("alt");$("#iptcomment"+e).hide(),$("#replylist"+e).fadeOut()});var defaultv="添加回复,按回车发表";$(".addreply").click(function(){var t=this,e=$(t).val();e=$.trim(e),islogin(function(){defaultv==e&&$(t).val("")})}).blur(function(){""==$(this).val()&&$(this).val(defaultv)}).bind("keyup",function(t){if(!comment.is_ingore_eventcode(t)){var e=comment.getwordcount($(this).val());if(e>comment.addreplylen){var n=$(this).val().gbtrim(comment.addreplylen);$(this).val(n)}if(13==t.keyCode){var i=this,o=$(this).attr("alt"),r=o.split("|"),a=r[0],s=$(this).val();if(defaultv==s||""==s||void 0==s)return!1;r[1]?comment.dianping(a,s,function(t){var e;2==t.error_code?ajaxlogin():"ok"==t.result?(e=t.data.replyid,tips.show("回复成功"),$(i).val(""),comment.addmsg(a,e),comment.updateReplyNum(a,comment.TYPE_POI)):tips.show(t.data.msg)}):comment.reply(a,s,function(t){var e;2==t.error_code?ajaxlogin():"ok"==t.result?(e=t.data.replyid,tips.show("回复成功"),$(i).val(""),comment.addmsg(a,e),comment.updateReplyNum(a,comment.TYPE_COMMENT)):tips.show(t.data.msg)})}}}),$(document).on("click",".jsdelGuideReply",function(t){var e=this;return islogin(function(){tips.confirm(t,function(){comment.delGuideReply(e,function(t){"ok"==t.result&&comment.updateReplyNum(t.data.cid,t.data.type)})})}),!1}),$(document).on("click",".jsdelPoicommentReply",function(t){var e=this;return islogin(function(){tips.confirm(t,function(){comment.delGuideReply(e,function(t){"ok"==t.result&&comment.poiupdateReplyNum(t.data.cid,t.data.type)})})}),!1}),$(document).on("click",".jsdelcomment",function(t){var e=$(this).attr("alt"),n=$("#commentdiv"+e),i=this;islogin(function(){tips.confirm(t,function(){comment.delcomment(i,function(t){t.result?n.remove():tips.show(t.msg)})})})}),$(document).on("click",".jsjubaocomment",function(){var t=$(this).attr("alt"),e=$(this).attr("ttype");e=e||comment.REPORT_GUIDE,islogin(function(){comment.jubao(e,t)})}),$(document).on("click",".jsjubaoreply",function(){var t=$(this).attr("alt"),e=$(this).attr("ttype");e=e||comment.REPORT_GUIDE_REPLY,islogin(function(){comment.jubaoGuideReply(e,t)})}),$(document).on("submit","#jubaoform",comment.jubaoPost),$(".jscontribute").click(function(){var t=$(this).attr("cateid"),e=$(this).attr("parentid"),n=$(this).attr("parenttypename");comment.contribute(t,0,e,n,function(){zClip&&$("#contri-txt").val(zClip.getClipCookie())})}),$(".jscontributeedit").click(function(){var t=$(this).attr("alt"),e=$(this).attr("articletype"),n=$(this).attr("stype");islogin(function(){2==n?comment.guide_edit(t,e):comment.contribut_eedit(t,e)})}),$(".jscontributedel").click(function(t){var e=this;islogin(function(){tips.confirm(t,function(){var t=$(e).attr("alt"),n=$(e).attr("stype");comment.contribut_del(t,n)})})}),$(".jscontributepoidel").click(function(t){var e=this;islogin(function(){tips.confirm(t,function(){var t=$(e).attr("alt");comment.contribut_poidel(t)})})}),$(".jscanlendarcontribute").click(function(){var t=$(this).attr("alt"),e=$(this).attr("ttype");islogin(function(){comment.contribute(t,1,e)})}),$(document).on("submit","contributeform",comment.contributePost),$(document).on("submit","#contributeeditform",comment.contribute_editPost),$(document).on("submit","#guideeditform",comment.guide_editPost),$(document).on("click","#issave",function(){$("input[name='issave']").val(1),$("#contributeform").submit()}),$(document).on("keyup","#contri-txt",function(){comment.init_contri_txt()}),$("#guideipt").click(function(){islogin(function(){})}).bind("keyup",function(t){if(!comment.is_ingore_eventcode(t)){var e=comment.getwordcount($(this).val());if(e>comment.guidelen){var n=$(this).val().gbtrim(comment.guidelen);$(this).val(n)}}}),$("#guideipt").bind("keyup",function(t){var e=$(this).val(),n=comment.guidelen-comment.getwordcount(e);n>=0?$("#guideipt_wds").html("剩余"+Math.floor(n/2)+"字"):(n=Math.abs(n),$("#guideipt_wds").html("超出"+Math.floor(n/2)+"字"))}),$(document).on("click",".jsGuideReplyMore",function(){var t=$(this).attr("alt"),e=$(this).attr("ttype");comment.replyMore(this,t,e)}),$(".jsimpress").click(function(){var t=$(this).attr("alt"),e=$(this).attr("id");islogin(function(){comment.addImpress(t,e)})}),$(document).on("submit","#cityimpressForm",comment.impressPost),$(document).on("submit","#countryimpressForm",comment.impressPost),$(document).on("keyup","#impress-txt",function(){comment.init_impress_txt()}),$(document).on("click",".jseditimpress",function(){var t=$(this).attr("alt"),e=$(this).attr("id");islogin(function(){comment.editImpress(t,e)})}),$(document).on("click",".jsbatchaddplace",function(t){comment.batchaddplace()}),$(document).on("change",".jsselectcontinents",function(t){var e=$("#input_continents").val();comment.jsselectcontinents(e)}),$(document).on("change",".jsselectcountry",function(t){var e=$("#input_country").val();comment.jsselectcountry(e)}),$(document).on("click",".jsselectcityid",function(t){var e=$(this).attr("cid"),n=$(this).attr("alt"),i=0;if($("#input_city li a").each(function(){select=$(this).attr("alt"),"1"==select&&(i+=1)}),"1"==n)$(this).attr("alt",""),$("#"+e).removeClass("current"),$("#input_beento_error").html("");else{if(i>=10)return $("#input_beento_error").html("抱歉，一次最多只能添加10个城市。"),!1;$(this).attr("alt","1"),$("#"+e).addClass("current")}}),$(document).on("click",".jsbatchaddbeento",function(t){var e,n="",i=0;$("#input_city li a").each(function(){e=$(this).attr("alt"),"1"==e&&("country"==$(this).attr("type")?i=$(this).attr("cid"):n=n+$(this).attr("cid")+",")}),0==i&&(i=$("#input_country").val()),comment.jsbatchaddbeento(n,i)}),$("#place_search_input").keyup(function(){$("#place_search_drop").show()}),$(document).click(function(){$("#place_search_drop").is(":visible")&&$("#place_search_drop").hide()}),$("#place_search_drop").click(function(t){t.stopPropagation()}),$("#place_search_input").click(function(t){$(this).val()!=$(this).attr("placeholder")&&""!=$(this).val()&&$("#place_search_drop").show(),t.stopPropagation()}),$("#place_search_input").bind("keyup",function(t){var e=this,n=$(e).val();comment.ajax_search_place(n,t)}),$("#place_search_input").keydown(function(t){var e=$("#place_search_drop_list dd").length;if($("#place_search_input").is(":visible"))if(38==t.keyCode)comment.NUM_SEARCH>0&&(comment.NUM_SEARCH--,$("#place_search_drop_list dd").removeClass("current").eq(comment.NUM_SEARCH).addClass("current"));else if(40==t.keyCode)comment.NUM_SEARCH<e-1&&(comment.NUM_SEARCH++,$("#place_search_drop_list dd").removeClass("current").eq(comment.NUM_SEARCH).addClass("current"));else if(13==t.keyCode){t.stopPropagation();var n=$("#place_search_drop_list dd").eq(comment.NUM_SEARCH).find("a").attr("href");void 0!=n&&window.open(n)}}),$(document).on("mouseover",".jssearchcontainer",function(){$("#place_search_input")[0].blur()})});var comment=function(jQuery){var comm=function(){this.preurl="http://common1.qyerstatic.com/public.php?action=replycomment",this.TYPE_COMMENT=1,this.TYPE_DIANPING=2,this.TYPE_POI=2,this.NUM_SEARCH=-1,this.guidelen=600,this.addreplylen=140,this.reload=function(){location.reload()},this.uid="",this.setUid=function(t){this.uid=t},this.getUid=function(){return""==this.uid||this.uid<=0?QYER.uid:this.uid},this.__for__=function(t,e){$.post(this.preurl,t,e,"json")},this.is_ingore_eventcode=function(t){return-1!=$.inArray(t.keyCode,[37,39,38,40])},this.init_contri_txt=function(){var t=$("#contri-txt"),e=2e3,n=$("#contri-tip"),i=$(t).val(),o=e-comment.getwordcount(i);o>=0?$(n).html("剩余"+Math.floor(o/2)+"字"):$(t).val(i.gbtrim(e))},this.init_impress_txt=function(t,e){t=t||"impress-tip",e=e||"impress-txt";var n=$("#"+e),i=240,o=$("#"+t),r=$(n).val(),a=comment.getwordcount(r);a>=0?$(o).html(""+Math.floor(a/2)+" / 120 字"):$(n).val(r=r.gbtrim(i))},this.reply=function(t,e,n){var i={cid:t,type:this.TYPE_COMMENT,reply:e};this.__for__(i,n)},this.dianping=function(t,e,n,i){var o={cid:t,type:this.TYPE_DIANPING,reply:e};i=i||{},o=$.extend(o,i),this.__for__(o,n)},this.addImpress=function(t,e){if(""==comment.getUid()||comment.getUid()<0)return ajaxlogin(),!1;var n="impress";if("country"==e)var i="country";else var i="city";popup.ajax("/public.php?action="+n+"&oper=showform&typename="+i+"&id="+t,"440")},this.editImpress=function(t,e){if(""==comment.getUid()||comment.getUid()<0)return ajaxlogin(),!1;var n="impress";if("country"==e)var i="country";else var i="city";popup.ajax("/public.php?action="+n+"&oper=editform&typename="+i+"&id="+t,"440")},this.impressPost=function(objForm){var ojbForm=this;return process_submit.before("cityimpressSubmit","ui_button","ui_button_load"),jQuery.getScript("../../../../static.qyer.com/js/common/jquery.form.js"/*tpa=http://static.qyer.com/js/common/jquery.form.js*/,function(){if(jQuery(ojbForm).find("input[name='cityid']").size())var id=jQuery(ojbForm).find("input[name='cityid']").val(),typename="city";else var id=jQuery(ojbForm).find("input[name='countryid']").val(),typename="country";if(jQuery(ojbForm).find("#showbatchdoings").size())var showbatchdoings=jQuery(ojbForm).find("#showbatchdoings").val();else var showbatchdoings=0;$(ojbForm).ajaxSubmit({success:function(txt){process_submit.after("发表");var ret;if(eval("ret="+txt),77==ret.error_code)ajaxlogin();else if("ok"==ret.result){if("undefined"!=typeof ret.extra&&ret.extra&&"undefined"!=typeof ret.extra.msg&&ret.extra.msg&&window.qyerUtil.showAntiSpam(ret.extra.msg),pupclose(),"1"==ret.data.credits){if($(".userimpressshow").length>0){var html='<p class="user"><a href="'+ret.data.userinfo.url+'" target="_blank"><img src="'+ret.data.userinfo.icon+'" width="30" height="30" alt="'+ret.data.userinfo.username+'" /><span>'+ret.data.userinfo.username+'</span></a></p><p class="text">'+ret.data.comment+"</p>";$(".userimpressshow").html(html),$(".userimpressshowtitle span").html("经验")}"1"http://common1.qyerstatic.com/place/js/common/==ret.data.city?popup.coast(200,"cityimpressSubmit",{text:"点评成功！",credits1:"+1"}):popup.coast(200,"countryimpressSubmit",{text:"点评成功！",credits1:"+1"})}"undefined"!=typeof ret.extra&&ret.extra&&"undefined"http://common1.qyerstatic.com/place/js/common/!=typeof ret.extra.msg&&ret.extra.msg?setTimeout(function(){location.reload()},4e3):location.reload()}else tips.show(ret.data.msg)}})}),!1},this.guideReplyList=function(t,e){var n="replylist"+t;e=e||10;var i="/api.php?action=replylist&count="+e+"&id="+t+"&rnd="+ +new Date;$("#"+n).load(i)},this.poiReplyList=function(t){var e="replylist"+t,n="/api.php?type=2&action=replylist&id="+t+"&rnd="+ +new Date;$("#"+e).load(n),$(".replymore"+t).hide()},this.replyMore=function(t,e,n){var i="/api.php?action=replylist&type="+n+"&rnd="+ +new Date;$.get(i,{flagXX:e},function(e){var n=$(t).parent();$(e).insertBefore(n),$(t).parent().remove()})},this.addmsg=function(t,e){var n="replylist"+t,i=$("#"+n),o=i.html();$.get("http://common1.qyerstatic.com/api.php?action=getonereply",{id:t,replyid:e,rnd:+new Date},function(t){i.html(t+o)})},this.delGuideReply=function(t,e){var n=$(t).attr("alt"),i=n.split("|"),o=i[0],r=(i[1],$(t).attr("ttype"));$.postJSON("http://common1.qyerstatic.com/api.php?action=delreply",{replyid:o,typeid:r},function(t){if("ok"==t.result){var n="#jsreplyitem"+o;$(n).remove(),e(t)}tips.show(t.data.msg)})},this.delcomment=function(t,e){var n=$(t).attr("alt");$.getJSON("http://common1.qyerstatic.com/api.php?action=delcomment",{cid:n},e)},this.updateReplyNum=function(t,e){e=e||this.TYPE_COMMENT,$.getJSON("/api.php?action=replycount&cid="+t+"&type="+e,{rnd:+new Date},function(e){var n,i="#replyNum"+t;"ok"==e.result&&(n=e.data.count?"回复 "+e.data.count:"回复",$(i).html(n))})},this.poiupdateReplyNum=function(t,e){e=e||this.TYPE_COMMENT,$.getJSON("/api.php?action=replycount&cid="+t+"&type="+e,{rnd:+new Date},function(e){var n="#replyNum"+t;if("ok"==e.result){var i="回复 ";e.data.count>0&&(i+=e.data.count),$(n).html(i)}})},this.getwordcount=util.getwordlen,this.REPORT_GUIDE=1,this.REPORT_POI=2,this.REPORT_IMPRESSION=3,this.REPORT_GUIDE_REPLY=11,this.REPORT_POI_REPLY=12,this.REPORT_IMPRESSION_REPLY=13,this.REPORT_ASK_QUESTION=21,this.REPORT_ASK_ANSWER=22,this.REPORT_ASK_COMMENT=23,this.REPORT_JN_COMMENT=31,this.REPORT_COUNTRY_IMPRESSION=4,this.REPORT_ONEDAY_COMMENT=51,this.REPORT_MESSAGE=61,this.jubao=function(t,e){return""==comment.getUid()||comment.getUid()<0?(ajaxlogin(),!1):void popup.ajax("/public.php?action=jubao&oper=showform&id="+e+"&type="+t,"440")},this.jubaoGuideReply=this.jubao,this.jubaoPost=function(){var objform=this;return jQuery(objform).ajaxSubmit({success:function(txt){var ret;eval("ret="+txt),77==ret.error_code?ajaxlogin():"ok"==ret.result?(pupclose(),tips.show("感谢举报！我们会尽快处理！")):tips.show(ret.data.msg)}}),!1},this.contribute=function(t,e,n,i,o){return!(t<=0)&&(""==this.getUid()||this.getUid()<=0?(ajaxlogin(),!1):(e=e||0,""==i&&(i="cityid"),void popup.ajax("/api.php?action=contribute&type="+e+"&oper=showform&cateid="+t+"&parentid="+n+"&parenttypename="+i,"640",o)))},this.contribut_eedit=function(t,e){if(t<=0)return!1;if(""==this.getUid()||this.getUid()<=0)return ajaxlogin(),!1;var n="showform";1==e&&(n="showinfo"),popup.ajax("/api.php?action=contributeedit&type="+e+"&oper="+n+"&id="+t+"&randomstr="+Math.random(),"640")},this.guide_edit=function(t,e){if(t<=0)return!1;if(""==this.getUid()||this.getUid()<=0)return ajaxlogin(),!1;var n="showform";1==e&&(n="showinfo"),popup.ajax("/api.php?action=guideedit&type="+e+"&oper="+n+"&id="+t+"&randomstr="+Math.random(),"640")},this.contribut_del=function(t,e){return!(t<=0)&&(""==this.getUid()||this.getUid()<=0?(ajaxlogin(),!1):void $.ajax({type:"POST",url:"http://common1.qyerstatic.com/api.php",data:"action=contributedel&id="+t+"&type="+e,dataType:"text",beforeSend:function(t){},success:function(t){1==t?(tips.show("删除成功！"),location.reload()):tips.show("删除未成功，请重试！")}}))},this.contribut_poidel=function(t){return!(t<=0)&&(""==this.getUid()||this.getUid()<=0?(ajaxlogin(),!1):void $.ajax({type:"POST",url:"http://common1.qyerstatic.com/api.php",data:"action=contributepoidel&id="+t,dataType:"text",beforeSend:function(t){},success:function(t){1==t?(tips.show("删除成功！"),location.reload()):tips.show("删除未成功，请重试！")}}))},this.contributePost=function(objForm){var ojbForm=this,issave=jQuery(ojbForm).find("input[name='issave']").val();return $(ojbForm).ajaxSubmit({success:function(txt){var ret;eval("ret="+txt),77==ret.error_code?ajaxlogin():"ok"==ret.result?(pupclose(),"1"==issave?popup.coast(330,"issavedsf",{text:"内容保存成功，可以在个人中心查看。"}):popup.coast(330,"issavedsf",{text:"内容提交成功！通过审核后会有经验值奖励。"})):tips.show(ret.data.msg)}}),!1},this.contribute_editPost=function(objForm){var ojbForm=this;return $(ojbForm).ajaxSubmit({success:function(txt){var ret;eval("ret="+txt),77==ret.error_code?ajaxlogin():"ok"==ret.result?(pupclose(),tips.show("投稿信息修改成功。"),location.reload()):tips.show(ret.data.msg)}}),!1},this.guide_editPost=function(objForm){var ojbForm=this;return $(ojbForm).ajaxSubmit({success:function(txt){var ret;eval("ret="+txt),77==ret.error_code?ajaxlogin():"ok"==ret.result?(pupclose(),tips.show("词条投稿信息修改成功。"),location.reload()):tips.show(ret.data.msg)}}),!1},this.batchaddplace=function(){return""==this.getUid()||this.getUid()<=0?(ajaxlogin(),!1):void popup.ajax("/api.php?action=batchaddplace&randomstr="+Math.random(),"440")},this.jsselectcontinents=function(id){return!(id<=0)&&(""==this.getUid()||this.getUid()<=0?(ajaxlogin(),!1):void $.ajax({type:"POST",url:"http://common1.qyerstatic.com/api.php",data:"action=getselectcontinents&id="+id,dataType:"text",beforeSend:function(t){},success:function(txt){var ret;eval("ret="+txt),"ok"==ret.result&&($("#input_country").html(ret.data.html),$(".user_place_item_list").html(""),$("#input_beento").html(""))}}))},this.jsselectcountry=function(id){return!(id<=0)&&(""==this.getUid()||this.getUid()<=0?(ajaxlogin(),!1):void $.ajax({type:"POST",url:"http://common1.qyerstatic.com/api.php",data:"action=getselectcountry&id="+id,dataType:"text",beforeSend:function(t){},success:function(txt){var ret;eval("ret="+txt),"ok"==ret.result&&($("#input_city").html(ret.data.html),$("#input_beento").html(ret.data.ahtml),$(".user_place_item_box").carousel({dispItems:1}))}}))},this.jsbatchaddbeento=function(t,e){return!(t.length<=0&&e<=0)&&(""==this.getUid()||this.getUid()<=0?(ajaxlogin(),!1):(void 0==e&&(e=0),void $.ajax({type:"POST",url:"http://common1.qyerstatic.com/api.php",data:"action=batchaddbeento&cid="+t+"&countryid="+e,dataType:"text",beforeSend:function(t){},success:function(t){1==t?(tips.show("添加成功！"),location.reload()):2==t?tips.show("最少要选中一个！"):3==t?tips.show("一次最多只能添加10个！"):tips.show("添加失败，请重试！")}})))},this.ajax_search_place=function(t,e){if(38!=e.keyCode&&40!=e.keyCode)return""==t?void $("#place_search_list_drop").hide():void $.post("http://common1.qyerstatic.com/index.php",{action:"searchplace",kw:t},function(t,e){"success"==e&&(t=$.parseJSON(t),"ok"==t.result?(comment.NUM_SEARCH=-1,$("#place_search_list_drop").show(),$(".jssearchcontainer").html(t.data.html).show()):tips.show("\t无法获取相应内容！"))})}};return new comm}(jQuery);(function(){function t(e,n,i){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return e===n;if(e._chain&&(e=e._wrapped),n._chain&&(n=n._wrapped),e.isEqual&&x.isFunction(e.isEqual))return e.isEqual(n);if(n.isEqual&&x.isFunction(n.isEqual))return n.isEqual(e);var o=u.call(e);if(o!=u.call(n))return!1;switch(o){case"[object String]":return e==""+n;case"[object Number]":return e!=+e?n!=+n:0==e?1/e==1/n:e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object RegExp]":return e.source==n.source&&e.global==n.global&&e.multiline==n.multiline&&e.ignoreCase==n.ignoreCase}if("object"!=typeof e||"object"!=typeof n)return!1;for(var r=i.length;r--;)if(i[r]==e)return!0;i.push(e);var r=0,a=!0;if("[object Array]"==o){if(r=e.length,a=r==n.length)for(;r--&&(a=r in e==r in n&&t(e[r],n[r],i)););}else{if("constructor"in e!="constructor"in n||e.constructor!=n.constructor)return!1;for(var s in e)if(x.has(e,s)&&(r++,!(a=x.has(n,s)&&t(e[s],n[s],i))))break;if(a){for(s in n)if(x.has(n,s)&&!r--)break;a=!r}}return i.pop(),a}var e=this,n=e._,i={},o=Array.prototype,r=Object.prototype,a=o.slice,s=o.unshift,u=r.toString,c=r.hasOwnProperty,l=o.forEach,p=o.map,d=o.reduce,f=o.reduceRight,h=o.filter,m=o.every,g=o.some,v=o.indexOf,y=o.lastIndexOf,r=Array.isArray,_=Object.keys,b=Function.prototype.bind,x=function(t){return new O(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.3.3";var w=x.each=x.forEach=function(t,e,n){if(null!=t)if(l&&t.forEach===l)t.forEach(e,n);else if(t.length===+t.length)for(var o=0,r=t.length;o<r&&!(o in t&&e.call(n,t[o],o,t)===i);o++);else for(o in t)if(x.has(t,o)&&e.call(n,t[o],o,t)===i)break};x.map=x.collect=function(t,e,n){var i=[];return null==t?i:p&&t.map===p?t.map(e,n):(w(t,function(t,o,r){i[i.length]=e.call(n,t,o,r)}),t.length===+t.length&&(i.length=t.length),i)},x.reduce=x.foldl=x.inject=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return i&&(e=x.bind(e,i)),o?t.reduce(e,n):t.reduce(e);if(w(t,function(t,r,a){o?n=e.call(i,n,t,r,a):(n=t,o=!0)}),!o)throw new TypeError("Reduce of empty array with no initial value");return n},x.reduceRight=x.foldr=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return i&&(e=x.bind(e,i)),o?t.reduceRight(e,n):t.reduceRight(e);var r=x.toArray(t).reverse();return i&&!o&&(e=x.bind(e,i)),o?x.reduce(r,e,n,i):x.reduce(r,e)},x.find=x.detect=function(t,e,n){var i;return j(t,function(t,o,r){if(e.call(n,t,o,r))return i=t,!0}),i},x.filter=x.select=function(t,e,n){var i=[];return null==t?i:h&&t.filter===h?t.filter(e,n):(w(t,function(t,o,r){e.call(n,t,o,r)&&(i[i.length]=t)}),i)},x.reject=function(t,e,n){var i=[];return null==t?i:(w(t,function(t,o,r){e.call(n,t,o,r)||(i[i.length]=t)}),i)},x.every=x.all=function(t,e,n){var o=!0;return null==t?o:m&&t.every===m?t.every(e,n):(w(t,function(t,r,a){if(!(o=o&&e.call(n,t,r,a)))return i}),!!o)};var j=x.some=x.any=function(t,e,n){e||(e=x.identity);var o=!1;return null==t?o:g&&t.some===g?t.some(e,n):(w(t,function(t,r,a){if(o||(o=e.call(n,t,r,a)))return i}),!!o)};x.include=x.contains=function(t,e){var n=!1;return null==t?n:v&&t.indexOf===v?t.indexOf(e)!=-1:n=j(t,function(t){return t===e})},x.invoke=function(t,e){var n=a.call(arguments,2);return x.map(t,function(t){return(x.isFunction(e)?e||t:t[e]).apply(t,n)})},x.pluck=function(t,e){return x.map(t,function(t){return t[e]})},x.max=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0])return Math.max.apply(Math,t);if(!e&&x.isEmpty(t))return-(1/0);var i={computed:-(1/0)};return w(t,function(t,o,r){o=e?e.call(n,t,o,r):t,o>=i.computed&&(i={value:t,computed:o})}),i.value},x.min=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0])return Math.min.apply(Math,t);if(!e&&x.isEmpty(t))return 1/0;var i={computed:1/0};return w(t,function(t,o,r){o=e?e.call(n,t,o,r):t,o<i.computed&&(i={value:t,computed:o})}),i.value},x.shuffle=function(t){var e,n=[];return w(t,function(t,i){e=Math.floor(Math.random()*(i+1)),n[i]=n[e],n[e]=t}),n},x.sortBy=function(t,e,n){var i=x.isFunction(e)?e:function(t){return t[e]};return x.pluck(x.map(t,function(t,e,o){return{value:t,criteria:i.call(n,t,e,o)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;return void 0===n?1:void 0===i?-1:n<i?-1:n>i?1:0}),"value")},x.groupBy=function(t,e){var n={},i=x.isFunction(e)?e:function(t){return t[e]};return w(t,function(t,e){var o=i(t,e);(n[o]||(n[o]=[])).push(t)}),n},x.sortedIndex=function(t,e,n){n||(n=x.identity);for(var i=0,o=t.length;i<o;){var r=i+o>>1;n(t[r])<n(e)?i=r+1:o=r}return i},x.toArray=function(t){return t?x.isArray(t)||x.isArguments(t)?a.call(t):t.toArray&&x.isFunction(t.toArray)?t.toArray():x.values(t):[]},x.size=function(t){return x.isArray(t)?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,e,n){return null==e||n?t[0]:a.call(t,0,e)},x.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},x.last=function(t,e,n){return null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},x.rest=x.tail=function(t,e,n){return a.call(t,null==e||n?1:e)},x.compact=function(t){return x.filter(t,function(t){return!!t})},x.flatten=function(t,e){return x.reduce(t,function(t,n){return x.isArray(n)?t.concat(e?n:x.flatten(n)):(t[t.length]=n,t)},[])},x.without=function(t){return x.difference(t,a.call(arguments,1))},x.uniq=x.unique=function(t,e,n){var n=n?x.map(t,n):t,i=[];return t.length<3&&(e=!0),x.reduce(n,function(n,o,r){return(e?x.last(n)===o&&n.length:x.include(n,o))||(n.push(o),i.push(t[r])),n},[]),i},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(t){var e=a.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.indexOf(e,t)>=0})})},x.difference=function(t){var e=x.flatten(a.call(arguments,1),!0);return x.filter(t,function(t){return!x.include(e,t)})},x.zip=function(){for(var t=a.call(arguments),e=x.max(x.pluck(t,"length")),n=Array(e),i=0;i<e;i++)n[i]=x.pluck(t,""+i);return n},x.indexOf=function(t,e,n){if(null==t)return-1;var i;if(n)return n=x.sortedIndex(t,e),t[n]===e?n:-1;if(v&&t.indexOf===v)return t.indexOf(e);for(n=0,i=t.length;n<i;n++)if(n in t&&t[n]===e)return n;return-1},x.lastIndexOf=function(t,e){if(null==t)return-1;if(y&&t.lastIndexOf===y)return t.lastIndexOf(e);for(var n=t.length;n--;)if(n in t&&t[n]===e)return n;return-1},x.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0);for(var n=arguments[2]||1,i=Math.max(Math.ceil((e-t)/n),0),o=0,r=Array(i);o<i;)r[o++]=t,t+=n;return r};var k=function(){};x.bind=function(t,e){var n,i;if(t.bind===b&&b)return b.apply(t,a.call(arguments,1));if(!x.isFunction(t))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));k.prototype=t.prototype;var o=new k,r=t.apply(o,i.concat(a.call(arguments)));return Object(r)===r?r:o}},x.bindAll=function(t){var e=a.call(arguments,1);return 0==e.length&&(e=x.functions(t)),w(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,e){var n={};return e||(e=x.identity),function(){var i=e.apply(this,arguments);return x.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},x.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(a.call(arguments,1)))},x.throttle=function(t,e){var n,i,o,r,a,s,u=x.debounce(function(){a=r=!1},e);return function(){return n=this,i=arguments,o||(o=setTimeout(function(){o=null,a&&t.apply(n,i),u()},e)),r?a=!0:s=t.apply(n,i),u(),r=!0,s}},x.debounce=function(t,e,n){var i;return function(){var o=this,r=arguments;n&&!i&&t.apply(o,r),clearTimeout(i),i=setTimeout(function(){i=null,n||t.apply(o,r)},e)}},x.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments))}},x.wrap=function(t,e){return function(){var n=[t].concat(a.call(arguments,0));return e.apply(this,n)}},x.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},x.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},x.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e,n=[];for(e in t)x.has(t,e)&&(n[n.length]=e);return n},x.values=function(t){return x.map(t,x.identity)},x.functions=x.methods=function(t){var e,n=[];for(e in t)x.isFunction(t[e])&&n.push(e);return n.sort()},x.extend=function(t){return w(a.call(arguments,1),function(e){for(var n in e)t[n]=e[n]}),t},x.pick=function(t){var e={};return w(x.flatten(a.call(arguments,1)),function(n){n in t&&(e[n]=t[n])}),e},x.defaults=function(t){return w(a.call(arguments,1),function(e){for(var n in e)null==t[n]&&(t[n]=e[n])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t},x.isEqual=function(e,n){return t(e,n,[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!=t.nodeType)},x.isArray=r||function(t){return"[object Array]"==u.call(t)},x.isObject=function(t){return t===Object(t)},x.isArguments=function(t){return"[object Arguments]"==u.call(t)},x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),x.isFunction=function(t){return"[object Function]"==u.call(t)},x.isString=function(t){return"[object String]"==u.call(t)},x.isNumber=function(t){return"[object Number]"==u.call(t)},x.isFinite=function(t){return x.isNumber(t)&&isFinite(t)},x.isNaN=function(t){return t!==t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==u.call(t)},x.isDate=function(t){return"[object Date]"==u.call(t)},x.isRegExp=function(t){return"[object RegExp]"==u.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return c.call(t,e)},x.noConflict=function(){return e._=n,this},x.identity=function(t){return t},x.times=function(t,e,n){for(var i=0;i<t;i++)e.call(n,i)},x.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.result=function(t,e){if(null==t)return null;var n=t[e];return x.isFunction(n)?n.call(t):n},x.mixin=function(t){w(x.functions(t),function(e){q(e,x[e]=t[e])})};var E=0;x.uniqueId=function(t){var e=E++;return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C,T=/.^/,S={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(C in S)S[S[C]]=C;var A=/\\|'|\r|\n|\t|\u2028|\u2029/g,$=/\\(\\|'|r|n|t|u2028|u2029)/g,R=function(t){return t.replace($,function(t,e){return S[e]})};x.template=function(t,e,n){n=x.defaults(n||{},x.templateSettings),t="__p+='"+t.replace(A,function(t){return"\\"+S[t]}).replace(n.escape||T,function(t,e){return"'+\n_.escape("+R(e)+")+\n'"}).replace(n.interpolate||T,function(t,e){return"'+\n("+R(e)+")+\n'"}).replace(n.evaluate||T,function(t,e){return"';\n"+R(e)+"\n;__p+='"})+"';\n",n.variable||(t="with(obj||{}){\n"+t+"}\n");var t="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+t+"return __p;\n",i=new Function(n.variable||"obj","_",t);return e?i(e,x):(e=function(t){return i.call(this,t,x)},e.source="function("+(n.variable||"obj")+"){\n"+t+"}",e)},x.chain=function(t){return x(t).chain()};var O=function(t){this._wrapped=t};x.prototype=O.prototype;var I=function(t,e){return e?x(t).chain():t},q=function(t,e){O.prototype[t]=function(){var t=a.call(arguments);return s.call(t,this._wrapped),I(e.apply(x,t),this._chain)}};x.mixin(x),w("pop,push,reverse,shift,sort,splice,unshift".split(","),function(t){var e=o[t];O.prototype[t]=function(){var n=this._wrapped;e.apply(n,arguments);var i=n.length;return("shift"==t||"splice"==t)&&0===i&&delete n[0],I(n,this._chain)}}),w(["concat","join","slice"],function(t){var e=o[t];O.prototype[t]=function(){return I(e.apply(this._wrapped,arguments),this._chain)}}),O.prototype.chain=function(){return this._chain=!0,this},O.prototype.value=function(){return this._wrapped}}).call(this);var JnCommon=function(){this.init.apply(this,arguments)};JnCommon.prototype.init=function(t){this.conf=$.extend({source:"one",list:null},t||{}),this.bindEvent()},JnCommon.prototype.bindEvent=function(){var t=this;switch($(document).on("click","._jsjndown",function(e){var n=$(this).attr("data-id");return!!n&&(islogin(function(){window.location.href=t.getJnDownUrl(n)}),void e.stopPropagation())}),t.conf.source){case"one":t.bindEventOne();break;case"two":t.bindEventTwo()}},JnCommon.prototype.bindEventOne=function(){},JnCommon.prototype.bindEventTwo=function(){var t=this;this.jnScroll(),$(document).on("click","._jsshowjnpop",function(e){var n=parseInt($(this).attr("data-key")),i=t.getOrderList(n),o=$("#_jscountryjnpop").html(),r=_.template(o,{jnlist:i});$("#_jspopjncontainer").html(r),qyerUI.popup.show({id:"_jsjnpopbox",width:680,isclose:"hide"})}),$(document).on("click","#_jsdownjnlist",function(t){var e=$(this).attr("data-ids");islogin(function(){window.location.href="http://event.qyer.com/detail.php?action=package&code="+e})})},JnCommon.prototype.getJnDownUrl=function(t){return"http://guide.qyer.com/index_action_downguide_id_"+t},JnCommon.prototype.getOrderList=function(t){var e=this.getList(),n=new Array,i=0;for(k in e)n[i]=e[k],i++;if(e.length<2)return n;var o=n[t];return o&&n.splice(t,1),n.unshift(o),n},JnCommon.prototype.getList=function(){return this.conf.list},JnCommon.prototype.jnScroll=function(){function t(){var t;u<0?u=s-1:u>=s&&(u=0),i.text(u+1),t=-u*c,r.animate({left:t})}var e,n=$("#qyguideprev"),i=$("#qyguideidx"),o=$("#qyguidenext"),r=$("#qyguidelist"),a=r.find("li"),s=a.length,u=0,c=270;s>1&&(r.width(c*s),o.click(function(){window.clearInterval(e),u++,t()}),n.click(function(){window.clearInterval(e),u--,t()}),r.hover(function(){window.clearInterval(e)},function(){e=window.setInterval(function(){u++,t()},5e3)}),e=window.setInterval(function(){u++,t()},5e3))},!function(t,e,n,i){var o=t(e);t.fn.lazyload=function(r){function a(){var e=0;u.each(function(){var n=t(this);if(!c.skip_invisible||n.is(":visible"))if(t.abovethetop(this,c)||t.leftofbegin(this,c));else if(t.belowthefold(this,c)||t.rightoffold(this,c)){if(++e>c.failure_limit)return!1;
}else n.trigger("appear"),e=0})}var s,u=this,c={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:e,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return r&&(i!==r.failurelimit&&(r.failure_limit=r.failurelimit,delete r.failurelimit),i!==r.effectspeed&&(r.effect_speed=r.effectspeed,delete r.effectspeed),t.extend(c,r)),s=c.container===i||c.container===e?o:t(c.container),0===c.event.indexOf("scroll")&&s.bind(c.event,function(){return a()}),this.each(function(){var e=this,n=t(e);e.loaded=!1,(n.attr("src")===i||n.attr("src")===!1)&&n.is("img")&&n.attr("src",c.placeholder),n.one("appear",function(){if(!this.loaded){if(c.appear){var i=u.length;c.appear.call(e,i,c)}t("<img />").bind("load",function(){var i=n.attr("data-"+c.data_attribute);n.hide(),n.is("img")?n.attr("src",i):n.css("background-image","url('"+i+"')"),n[c.effect](c.effect_speed),e.loaded=!0;var o=t.grep(u,function(t){return!t.loaded});if(u=t(o),c.load){var r=u.length;c.load.call(e,r,c)}}).attr("src",n.attr("data-"+c.data_attribute))}}),0!==c.event.indexOf("scroll")&&n.bind(c.event,function(){e.loaded||n.trigger("appear")})}),o.bind("resize",function(){a()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&o.bind("pageshow",function(e){e.originalEvent&&e.originalEvent.persisted&&u.each(function(){t(this).trigger("appear")})}),t(n).ready(function(){a()}),this},t.belowthefold=function(n,r){var a;return a=r.container===i||r.container===e?(e.innerHeight?e.innerHeight:o.height())+o.scrollTop():t(r.container).offset().top+t(r.container).height(),a<=t(n).offset().top-r.threshold},t.rightoffold=function(n,r){var a;return a=r.container===i||r.container===e?o.width()+o.scrollLeft():t(r.container).offset().left+t(r.container).width(),a<=t(n).offset().left-r.threshold},t.abovethetop=function(n,r){var a;return a=r.container===i||r.container===e?o.scrollTop():t(r.container).offset().top,a>=t(n).offset().top+r.threshold+t(n).height()},t.leftofbegin=function(n,r){var a;return a=r.container===i||r.container===e?o.scrollLeft():t(r.container).offset().left,a>=t(n).offset().left+r.threshold+t(n).width()},t.inviewport=function(e,n){return!(t.rightoffold(e,n)||t.leftofbegin(e,n)||t.belowthefold(e,n)||t.abovethetop(e,n))},t.extend(t.expr[":"],{"below-the-fold":function(e){return t.belowthefold(e,{threshold:0})},"above-the-top":function(e){return!t.belowthefold(e,{threshold:0})},"right-of-screen":function(e){return t.rightoffold(e,{threshold:0})},"left-of-screen":function(e){return!t.rightoffold(e,{threshold:0})},"in-viewport":function(e){return t.inviewport(e,{threshold:0})},"above-the-fold":function(e){return!t.belowthefold(e,{threshold:0})},"right-of-fold":function(e){return t.rightoffold(e,{threshold:0})},"left-of-fold":function(e){return!t.rightoffold(e,{threshold:0})}})}(jQuery,window,document);var useful=function(t){var e=function(){this.preurl="http://common1.qyerstatic.com/poi.php?action=",this.TYPE_COMMENT=1,this.TYPE_POI=2,this.TYPE_IMPRESS=3,this.TYPE_COUNTRY_IMPRESS=5,this.TYPE_ASK=4,this.__for__=function(e,n,i){n.rnd=+new Date,t.postJSON(this.preurl+e,n,i)},this.type="",this.setType=function(t){this.type=t}};return e.prototype.useful=function(t,e,n){var i={type:t,pid:e};this.__for__("useful",i,n)},e.prototype.powerUseful=function(e,n,i){var o=function(e,n,i){return function(o){if("ok"==o.result){var r="";if(o.data.msg_impel&&(r=o.data.msg_impel),""!=r?tips.show(r):tips.show("英雄所见略同，期待你发现更多的有用！"),4==n)useful.count(n,i,function(n){var o=t("#useful"+i);o.size()>0?t(o).html(n.data.count):"p4"==t(e).attr("data-flag")?t(e).html(n.data.count):t(e).html("有用 "+n.data.count)});else if(4!=n){var a=t(e).html();a=a.replace(/[^0-9]/gi,""),a=parseInt(a),a=isNaN(a)?1:a+1,t(e).html("有用 "+a)}}else 77==o.error_code?ajaxlogin():o.error_code!=-2&&tips.show(o.data.msg)}}(e,n,i);this.useful(n,i,o)},e.prototype.count=function(t,e,n){var i={type:t,pid:e};this.__for__("usefulcount",i,n)},e.prototype.showinput=function(e){var n=t.trim(t(".usertcontent").find("div").html());"和大家说点什么"==n&&(n=""),n=html_decode(n);var i='<div class="usertcontent_form"><div style="display:none;" id="oldtext"></div><input type="ttext" class="fl jsenterdown" value="" style="color:#959595;" /><span class="fl"><a href="javascript:void(0);" class="cWhite jssubmitinput">确定</a></span><span class="fl"><a href="javascript:void(0);" class="cWhite jshideinput">取消</a></span></div>';t(".usertcontent").html(i),t(".usertcontent").find("input").val(n),t("#oldtext").html(n)},e.prototype.hideinput=function(e){var n=t.trim(t("#oldtext").html());""==n&&(n="和大家说点什么"),n=html_encode(n);var i='<table><tbody><tr><td><div class="jsshowinput"></div></td></tr></tbody></table>';t(".usertcontent").html(i),t(".usertcontent").find("div").html(n)},e.prototype.submitinput=function(e){var n=t.trim(t(".usertcontent").find("input").val());n=escape(n);var i='<table><tbody><tr><td><div class="jsshowinput"></div></td></tr></tbody></table>';t.ajax({type:"POST",url:this.preurl+"selfinfo",data:"str="+n,dataType:"text",beforeSend:function(t){},success:function(e){""==e&&(e="和大家说点什么"),e=html_encode(e),t(".usertcontent").html(i),t(".usertcontent").find("div").html(e)}})},e.prototype.useindexreload=function(){t.ajax({type:"POST",url:this.preurl+"useindexreload",data:"",dataType:"text",beforeSend:function(t){},success:function(t){1==t&&location.reload()}})},new e}(jQuery);$(function(){$(".jscommentuseful").click(function(){var t=$(this).attr("alt"),e=this;islogin(function(){useful.powerUseful(e,useful.TYPE_COMMENT,t)})}),$(document).on("click",".jspoicommentuseful",function(){var t=$(this).attr("alt"),e=$(this).attr("data-type");isNaN(e)&&(e=useful.TYPE_POI);var n=this;islogin(function(){useful.powerUseful(n,e,t)})}),$(document).on("click","#jspoicommentusefullist",function(){var t=$(this).attr("alt"),e=$(this).attr("order");_ajax.get("getpoicommentlist",{poiid:t,order:e,_cnt:+new Date},function(t){comtop=t,$("#poicommentlist").html(t)})}),$(document).on("click.jsimpresscommentuseful",".jsimpresscommentuseful",function(){$(document).unbind("jsimpresscommentuseful");var t=$(this).attr("alt"),e=$(this).attr("id");if("country"==e)var n=useful.TYPE_COUNTRY_IMPRESS;else var n=useful.TYPE_IMPRESS;var i=this;islogin(function(){useful.powerUseful(i,n,t)})}),$(document).on("click",".jsshowinput",function(){var t=this;useful.showinput(t)}),$(document).on("click",".jshideinput",function(){var t=this;useful.hideinput(t)}),$(document).on("click",".jssubmitinput",function(){var t=this;useful.submitinput(t)}),$(document).on("keydown",".jsenterdown",function(t){13==t.which&&$(".jssubmitinput").click()}),$(document).on("click",".jsuseindexreload",function(t){useful.useindexreload()})}),jQuery(function(t){var e=(t(".grades .stars"),["很差","差","一般","好","很好"]),n=t(".poicommentdiv"),i=30,o=2e3,r=function(){var e;return""==t("#comment").val()||t("#comment").val()==t("#comment").attr("placeholder")?(t("#poicheckcomment").html('<span class="sum">0</span> / 30 ~ '+o+" 字"),!1):(e=util.getwordlen(t("#comment").val(),1),e>o||e<i?(t("#poicheckcomment").html('<span class="cRed_caution">'+e+"</span> / 30 ~ "+o+" 字"),!1):(t("#poicheckcomment").html("<span>"+e+"</span> / 30 ~ "+o+" 字"),t("#comment").hasClass("ui_input_error")&&t("#comment").removeClass("ui_input_error"),t("#poicommentTips").hide(),!0))};n.on("mouseenter",".grades .stars span",function(){var n=t(this).attr("data-order");n=parseInt(n,10),t(this).siblings("span").removeClass("starhv stared"),t(this).parent(".stars").find("span:lt("+n+")").addClass("starhv"),t(this).parent(".stars").siblings(".starstips").find("em").text(e[n-1])}),n.on("click",".grades .stars span",function(){var e=t(this).attr("data-order");e=parseInt(e,10),t(this).parents(".stars").attr("data-size",e),t("#poistar").val(e),t(this).parents(".item").find(".ui2_textarea").focus()}),n.on("mouseenter",".grades .stars",function(){t(this).siblings(".starerror_layer").hide()}),n.on("mouseleave",".grades .stars",function(){var n=t(this).attr("data-size");n=parseInt(n,10),t(this).find("span:lt("+n+")").addClass("stared"),t(this).find("span").removeClass("starhv"),n>0?t(this).siblings(".starstips").find("em").text(e[n-1]):t(this).siblings(".starstips").find("em").text("点击星星为它评分")}),n.on("focus","#poicommentform .ui2_textarea",function(){t(this).addClass("ui2_focus"),t(this).removeClass("ui2_error"),t("#poicommentform").find(".ui2_error_layer").hide(),qyerUI.autoheight(this,{fontSize:"14px",lineHeight:"24px"})}),n.on("blur","#poicommentform .ui2_textarea",function(){t(this).removeClass("ui2_focus"),t(this).removeClass("ui2_error")}),t(document).on("change","#comment",function(){qyerUI.autoheight(this,{fontSize:"14px",lineHeight:"24px"})}),t(document).on("keydown","#comment",function(){qyerUI.autoheight(this,{fontSize:"14px",lineHeight:"24px"})}),t(document).on("keyup","#comment",function(){qyerUI.autoheight(this,{fontSize:"14px",lineHeight:"24px"}),r()}),n.on("submit","#poicommentform",function(){if(!t("#poistar").val()||t("#poistar").val()<=0)return t("#poistarTips").show(),!1;if(!r())return t("#comment").addClass("ui2_error"),t("#poicommentTips").show(),!1;var e="http://common1.qyerstatic.com/api.php?action=addpoicomment&do=add",n=t("#poiid").val(),i="",o=0;return i=t("#type").val(),o=t("#typeid").val(),t.post(e,t("#poicommentform").serialize(),function(e){var a=e;"error"==a.result?qyerUI.message({msg:a.data.msg,type:"warn",timeout:2e3}):(window.setTimeout(function(){(i||"undefined"!=typeof i)&&qyerUI.popup.ajax({url:"/api.php?action=addpoicomment&from=poi&oper=successfull&poiid="+n+"&typeid="+o+"&type="+i,width:"500",isclose:"show"})},500),qyerUI.message({msg:a.data.msg,type:"true",timeout:2e3}),t.post("http://common1.qyerstatic.com/ajax.php",{action:"ajaxpoiusercomment",id:t("#poiid").val()},function(e){t("#newcommentdiv").remove(),t("#usercommentdiv").html(e),t("a[href=#poicomment]").remove(),t(window).scrollTop(t("#usercommentdiv").offset().top-120),r()}))},"json"),!1}),r()});var __already="icon_user_care_already",__cancel="icon_user_care_cancel",tipsX=function(t){var e=function(){this.isshow=!1,this.html=["<div class='ui_message __XXtipsXX_' >","","</div>"],this.show=function(e,n){e=e||"",n=n||2e3;var i=this.getobj();return this.isshow?(t(i).css({left:t(document).width()/2-200}),t.browser.msie&&"6.0"==t.browser.version&&t(i).css({top:t(document).scrollTop()}),void i.html(e)):(this.html[1]=e,t("body").append(this.html.join("")),i=this.getobj(),t(i).css({left:t(document).width()/2-200}),t.browser.msie&&"6.0"==t.browser.version&&t(i).css({top:t(document).scrollTop()}),i.show(),this.isshow=!0,void setTimeout(function(){t(i).slideUp(),tipsX.isshow=!1},n))},this.hide=function(){this.getobj().fadeOut(),this.isshow=!1},this.getobj=function(){return t(".__XXtipsXX_")}},n=new e;return n}(jQuery),curHoverUsercardDivobj=null,curUsercardUid=null,userHeaderCaches={},clearUsercardCache=function(t){var e="user:"+t;delete userHeaderCaches[e]};!function(t){t(function(){var e=0;t(document).on("hover",".ui_headPort_float, .ui_face_layer",function(n){var i="mouseenter"==n.type,o="mouseleave"==n.type;i&&e&&(clearTimeout(e),e=0),o&&(e=setTimeout(function(){var n=t(".ui_face_layer, .ui_headPort_float");n.hide(),e=0},300))}),t(document).on("hover",".ui_headPort",function(t){return}),t(document).on("mouseout","."+__cancel,function(){t(this).removeClass(__cancel).addClass(__already).html("已关注")}),enableCrossDomain()?(t(document).on("mouseover","."+__already,function(){var e=t(this).attr("alt"),n="flow"+e,i=t("."+n);t(i).removeClass(__already).addClass(__cancel).html("取消关注"),t(i).unbind("click"),t(i).click(function(t){channelfriend_v1(e),clearUsercardCache(e)})}),t(document).on("click",".icon_user_care",function(e){var n=t(this).attr("alt");t(".flow"+n);n>0&&addatten_v1(n)})):(t(document).on("mouseover","."+__already,function(){var e=t(this).attr("alt"),n="flow"+e,i=t("."+n);t(i).removeClass(__already).addClass(__cancel).html("取消关注"),t(i).unbind("click"),t(i).click(function(n){channelfriend(e,function(){i.html("关注"),i.unbind("click"),i.removeClass(__cancel).addClass("icon_user_care");var n=t(".jsfollowcount"+e).html();n=parseInt(n),t(".jsfollowcount"+e).html(n-1)}),clearUsercardCache(e)})}),t(document).on("click",".icon_user_care",function(e){var n=t(this).attr("alt"),i=t(".flow"+n);n>0&&addatten(n,function(){i.removeClass("icon_user_care").addClass(__already),i.html("已关注");var e=t(".jsfollowcount"+n).html();e=parseInt(e),t(".jsfollowcount"+n).html(e+1),clearUsercardCache(n)})}))})}(jQuery),function(t){function e(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}t.fn.ajaxSubmit=function(n){function i(e){for(var i=new FormData,o=0;o<e.length;o++)"file"!=e[o].type&&i.append(e[o].name,e[o].value);if(u.find("input:file:enabled").each(function(){var e=t(this).attr("name"),n=this.files;if(e)for(var o=0;o<n.length;o++)i.append(e,n[o])}),n.extraData)for(var r in n.extraData)i.append(r,n.extraData[r]);n.data=null;var a=t.extend(!0,{},t.ajaxSettings,n,{contentType:!1,processData:!1,cache:!1,type:"POST"});a.data=null;var s=a.beforeSend;a.beforeSend=function(t,e){e.data=i,t.upload&&(t.upload.onprogress=function(t){e.progress(t.position,t.total)}),s&&s.call(e,t,n)},t.ajax(a)}function o(i){function o(t){var e=t.contentWindow?t.contentWindow.document:t.contentDocument?t.contentDocument:t.document;return e}function a(){function n(){try{var t=o(m).readyState;e("state = "+t),"uninitialized"==t.toLowerCase()&&setTimeout(n,50)}catch(i){e("Server abort: ",i," (",i.name,")"),s(k),b&&clearTimeout(b),b=void 0}}var i=u.attr("target"),a=u.attr("action");x.setAttribute("target",f),r||x.setAttribute("method","POST"),a!=p.url&&x.setAttribute("action",p.url),p.skipEncodingOverride||r&&!/post/i.test(r)||u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),p.timeout&&(b=setTimeout(function(){_=!0,s(j)},p.timeout));var c=[];try{if(p.extraData)for(var l in p.extraData)c.push(t('<input type="hidden" name="'+l+'">').attr("value",p.extraData[l]).appendTo(x)[0]);p.iframeTarget||(h.appendTo("body"),m.attachEvent?m.attachEvent("onload",s):m.addEventListener("load",s,!1)),setTimeout(n,15),x.submit()}finally{x.setAttribute("action",a),i?x.setAttribute("target",i):u.removeAttr("target"),t(c).remove()}}function s(n){if(!g.aborted&&!A){try{S=o(m)}catch(i){e("cannot access response document: ",i),n=k}if(n===j&&g)return void g.abort("timeout");if(n==k&&g)return void g.abort("server abort");if(S&&S.location.href!=p.iframeSrc||_){m.detachEvent?m.detachEvent("onload",s):m.removeEventListener("load",s,!1);var r,a="success";try{if(_)throw"timeout";var u="xml"==p.dataType||S.XMLDocument||t.isXMLDoc(S);if(e("isXml="+u),!u&&window.opera&&(null==S.body||""==S.body.innerHTML)&&--$)return e("requeing onLoad callback, DOM not available"),void setTimeout(s,250);var c=S.body?S.body:S.documentElement;g.responseText=c?c.innerHTML:null,g.responseXML=S.XMLDocument?S.XMLDocument:S,u&&(p.dataType="xml"),g.getResponseHeader=function(t){var e={"content-type":p.dataType};return e[t]},c&&(g.status=Number(c.getAttribute("status"))||g.status,g.statusText=c.getAttribute("statusText")||g.statusText);var l=(p.dataType||"").toLowerCase(),f=/(json|script|text)/.test(l);if(f||p.textarea){var v=S.getElementsByTagName("textarea")[0];if(v)g.responseText=v.value,g.status=Number(v.getAttribute("status"))||g.status,g.statusText=v.getAttribute("statusText")||g.statusText;else if(f){var y=S.getElementsByTagName("pre")[0],x=S.getElementsByTagName("body")[0];y?g.responseText=y.textContent?y.textContent:y.innerText:x&&(g.responseText=x.textContent?x.textContent:x.innerText)}}else"xml"!=l||g.responseXML||null==g.responseText||(g.responseXML=R(g.responseText));try{T=I(g,l,p)}catch(n){a="parsererror",g.error=r=n||a}}catch(n){e("error caught: ",n),a="error",g.error=r=n||a}g.aborted&&(e("upload aborted"),a=null),g.status&&(a=g.status>=200&&g.status<300||304===g.status?"success":"error"),"success"===a?(p.success&&p.success.call(p.context,T,"success",g),d&&t.event.trigger("ajaxSuccess",[g,p])):a&&(void 0==r&&(r=g.statusText),p.error&&p.error.call(p.context,g,a,r),d&&t.event.trigger("ajaxError",[g,p,r])),d&&t.event.trigger("ajaxComplete",[g,p]),d&&!--t.active&&t.event.trigger("ajaxStop"),p.complete&&p.complete.call(p.context,g,a),A=!0,p.timeout&&clearTimeout(b),setTimeout(function(){p.iframeTarget||h.remove(),g.responseXML=null},100)}}}var c,l,p,d,f,h,m,g,v,y,_,b,x=u[0],w=!!t.fn.prop;if(i)if(w)for(l=0;l<i.length;l++)c=t(x[i[l].name]),c.prop("disabled",!1);else for(l=0;l<i.length;l++)c=t(x[i[l].name]),c.removeAttr("disabled");if(t(":input[name=submit],:input[id=submit]",x).length)return void alert('Error: Form elements must not have name or id of "submit".');if(p=t.extend(!0,{},t.ajaxSettings,n),p.context=p.context||p,f="jqFormIO"+(new Date).getTime(),p.iframeTarget?(h=t(p.iframeTarget),y=h.attr("name"),null==y?h.attr("name",f):f=y):(h=t('<iframe name="'+f+'" src="'+p.iframeSrc+'" />'),h.css({position:"absolute",top:"-1000px",left:"-1000px"})),m=h[0],g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(n){var i="timeout"===n?"timeout":"aborted";e("aborting upload... "+i),this.aborted=1,h.attr("src",p.iframeSrc),g.error=i,p.error&&p.error.call(p.context,g,i,n),d&&t.event.trigger("ajaxError",[g,p,i]),p.complete&&p.complete.call(p.context,g,i)}},d=p.global,d&&!t.active++&&t.event.trigger("ajaxStart"),d&&t.event.trigger("ajaxSend",[g,p]),p.beforeSend&&p.beforeSend.call(p.context,g,p)===!1)return void(p.global&&t.active--);if(!g.aborted){v=x.clk,v&&(y=v.name,y&&!v.disabled&&(p.extraData=p.extraData||{},p.extraData[y]=v.value,"image"==v.type&&(p.extraData[y+".x"]=x.clk_x,p.extraData[y+".y"]=x.clk_y)));var j=1,k=2,E=t("meta[name=csrf-token]").attr("content"),C=t("meta[name=csrf-param]").attr("content");C&&E&&(p.extraData=p.extraData||{},p.extraData[C]=E),p.forceSync?a():setTimeout(a,10);var T,S,A,$=50,R=t.parseXML||function(t,e){return window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},O=t.parseJSON||function(t){return window.eval("("+t+")")},I=function(e,n,i){var o=e.getResponseHeader("content-type")||"",r="xml"===n||!n&&o.indexOf("xml")>=0,a=r?e.responseXML:e.responseText;return r&&"parsererror"===a.documentElement.nodeName&&t.error&&t.error("parsererror"),i&&i.dataFilter&&(a=i.dataFilter(a,n)),"string"==typeof a&&("json"===n||!n&&o.indexOf("json")>=0?a=O(a):("script"===n||!n&&o.indexOf("javascript")>=0)&&t.globalEval(a)),a}}}if(!this.length)return e("ajaxSubmit: skipping submit process - no element selected"),this;var r,a,s,u=this;"function"==typeof n&&(n={success:n}),r=this.attr("method"),a=this.attr("action"),s="string"==typeof a?t.trim(a):"",s=s||window.location.href||"",s&&(s=(s.match(/^([^#]+)/)||[])[1]),n=t.extend(!0,{url:s,success:t.ajaxSettings.success,type:r||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var c={};if(this.trigger("form-pre-serialize",[this,n,c]),c.veto)return e("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return e("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var l=n.traditional;void 0===l&&(l=t.ajaxSettings.traditional);var p,d=this.formToArray(n.semantic);if(n.data&&(n.extraData=n.data,p=t.param(n.data,l)),n.beforeSubmit&&n.beforeSubmit(d,this,n)===!1)return e("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[d,this,n,c]),c.veto)return e("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var f=t.param(d,l);p&&(f=f?f+"&"+p:p),"GET"==n.type.toUpperCase()?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+f,n.data=null):n.data=f;var h=[];if(n.resetForm&&h.push(function(){u.resetForm()}),n.clearForm&&h.push(function(){u.clearForm(n.includeHidden)}),!n.dataType&&n.target){var m=n.success||function(){};h.push(function(e){var i=n.replaceTarget?"replaceWith":"html";t(n.target)[i](e).each(m,arguments)})}else n.success&&h.push(n.success);n.success=function(t,e,i){for(var o=n.context||n,r=0,a=h.length;r<a;r++)h[r].apply(o,[t,e,i||u,u])};var g=t("input:file:enabled[value]",this),v=g.length>0,y="multipart/form-data",_=u.attr("enctype")==y||u.attr("encoding")==y,b=!!(v&&g.get(0).files&&window.FormData);e("fileAPI :"+b);var x=(v||_)&&!b;return n.iframe!==!1&&(n.iframe||x)?n.closeKeepAlive?t.get(n.closeKeepAlive,function(){o(d)}):o(d):(v||_)&&b?(n.progress=n.progress||t.noop,i(d)):t.ajax(n),this.trigger("form-submit-notify",[this,n]),this},t.fn.ajaxForm=function(n){if(0===this.length){var i={s:this.selector,c:this.context};return!t.isReady&&i.s?(e("DOM not ready, queuing ajaxForm"),t(function(){t(i.s,i.c).ajaxForm(n)}),this):(e("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){e.isDefaultPrevented()||(e.preventDefault(),t(this).ajaxSubmit(n))}).bind("click.form-plugin",function(e){var n=e.target,i=t(n);if(!i.is(":submit,input:image")){var o=i.closest(":submit");if(0==o.length)return;n=o[0]}var r=this;if(r.clk=n,"image"==n.type)if(void 0!=e.offsetX)r.clk_x=e.offsetX,r.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var a=i.offset();r.clk_x=e.pageX-a.left,r.clk_y=e.pageY-a.top}else r.clk_x=e.pageX-n.offsetLeft,r.clk_y=e.pageY-n.offsetTop;setTimeout(function(){r.clk=r.clk_x=r.clk_y=null},100)})},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(e){var n=[];if(0===this.length)return n;var i=this[0],o=e?i.getElementsByTagName("*"):i.elements;if(!o)return n;var r,a,s,u,c,l,p;for(r=0,l=o.length;r<l;r++)if(c=o[r],s=c.name)if(e&&i.clk&&"image"==c.type)c.disabled||i.clk!=c||(n.push({name:s,value:t(c).val(),type:c.type}),n.push({name:s+".x",value:i.clk_x},{name:s+".y",value:i.clk_y}));else if(u=t.fieldValue(c,!0),u&&u.constructor==Array)for(a=0,p=u.length;a<p;a++)n.push({name:s,value:u[a]});else null!==u&&"undefined"!=typeof u&&n.push({name:s,value:u,type:c.type});if(!e&&i.clk){var d=t(i.clk),f=d[0];s=f.name,s&&!f.disabled&&"image"==f.type&&(n.push({name:s,value:d.val()}),n.push({name:s+".x",value:i.clk_x},{name:s+".y",value:i.clk_y}))}return n},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var n=[];return this.each(function(){var i=this.name;if(i){var o=t.fieldValue(this,e);if(o&&o.constructor==Array)for(var r=0,a=o.length;r<a;r++)n.push({name:i,value:o[r]});else null!==o&&"undefined"!=typeof o&&n.push({name:this.name,value:o})}}),t.param(n)},t.fn.fieldValue=function(e){for(var n=[],i=0,o=this.length;i<o;i++){var r=this[i],a=t.fieldValue(r,e);null===a||"undefined"==typeof a||a.constructor==Array&&!a.length||(a.constructor==Array?t.merge(n,a):n.push(a))}return n},t.fieldValue=function(e,n){var i=e.name,o=e.type,r=e.tagName.toLowerCase();if(void 0===n&&(n=!0),n&&(!i||e.disabled||"reset"==o||"button"==o||("checkbox"==o||"radio"==o)&&!e.checked||("submit"==o||"image"==o)&&e.form&&e.form.clk!=e||"select"==r&&e.selectedIndex==-1))return null;if("select"==r){var a=e.selectedIndex;if(a<0)return null;for(var s=[],u=e.options,c="select-one"==o,l=c?a+1:u.length,p=c?a:0;p<l;p++){var d=u[p];if(d.selected){var f=d.value;if(f||(f=d.attributes&&d.attributes.value&&!d.attributes.value.specified?d.text:d.value),c)return f;s.push(f)}}return s}return t(e).val()},t.fn.clearForm=function(e){return this.each(function(){t("input,select,textarea",this).clearFields(e)})},t.fn.clearFields=t.fn.clearInputs=function(t){var e=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var n=this.type,i=this.tagName.toLowerCase();e.test(n)||"textarea"==i||t&&/hidden/.test(n)?this.value="":"checkbox"==n||"radio"==n?this.checked=!1:"select"==i&&(this.selectedIndex=-1)})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var n=this.type;if("checkbox"==n||"radio"==n)this.checked=e;else if("option"==this.tagName.toLowerCase()){var i=t(this).parent("select");e&&i[0]&&"select-one"==i[0].type&&i.find("option").selected(!1),this.selected=e}})},t.fn.ajaxSubmit.debug=!1}(jQuery),$(function(){$(document).on("click",function(t){0===t.button&&"true"==t.target.getAttribute("data-addtoplan")&&require(["common/component/addListToPlan/addListToPlan"],function(e){var n=$(t.target);e.qyerAddToPlan({obj:t.target,type:n.attr("data-type"),pid:n.attr("data-pid"),css:{"z-index":20}})})})});