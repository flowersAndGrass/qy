function createWindow(e){requirejs(["common/component/editPlacePopup/editDestination"],function(t){t.show({poiid:e})})}window.qyerUtil.insertStyle([".qui-feedback { position:fixed; _position:absolute; z-index:99; top:120px; right:-246px; display:none;}",".qui-feedback .icon { float:left; width:24px; height:150px; background:url(http://common2.qyerstatic.com/place/common/component/feedback/icons_feedback.png) 0 0 no-repeat; cursor:pointer;}",".qui-feedback.js-current > .icon { background-position:-29px 0;}",".qui-feedback .cnt { float:left; width:246px; background-color:#e8e4df;}",".qui-feedback .cnt form { padding:0 10px 10px; font-size:0;}",".qui-feedback .cnt textarea { width:214px; height:192px; padding:2px 5px; border:1px solid #ccc; font-size:12px;}",".qui-feedback .cnt input { float:right; margin:10px 0;}",".qui-feedback .help { position:relative; top:-1px; border:1px solid #ccc; border-top:none; background:#fefdc9; height:24px; line-height:22px; text-align:center;font-size:12px;}",".qui-feedback .help a { font-weight:bold; }",".qui-feedback h4 { font-size:14px; font-weight:bold; line-height:3; padding:0 10px; clear:both;}",".qui-feedback .feedback-weixin { padding: 0 10px; }",".qui-feedback .feedback-weixin img { width:76px; float:left; margin-right:10px;}",".qui-feedback .feedback-weixin p b { margin-left:-5px;}"].join("")),setTimeout(function(){!function(){function e(){this.init()}var t;e.prototype={$div:null,init:function(){this.createDom(),this.bindEvt()},tip:function(e){requirejs(["common/ui/tip/tip"],function(t){t.tip(e)})},createDom:function(){var e=['<div class="qui-feedback">','<div class="icon js-btn" title="意见反馈"></div>','<div class="cnt">',"<h4>微信反馈，更快更方便</h4>",'<div class="feedback-weixin">','<img src="../../../../common2.qyerstatic.com/place/common/component/feedback/placeFeedbackQR.jpg"/*tpa=http://common2.qyerstatic.com/place/common/component/feedback/placeFeedbackQR.jpg*/>',"<p>扫码关注<br><b>“穷游出境游助手”</b>微信号<br>发文字、发语音、发图片<br>随时随地提意见</p>","</div>","<h4>直接在站内反馈</h4>",'<form method="post">','<textarea class="js-feedback-cnt" cols="50" rows="10" placeholder="有任何意见或建议请告诉我们"></textarea>','<p class="help">使用遇到问题？请先进入<a href="http://bbs.qyer.com/forum-10-1.html" target="_blank">帮助中心</a></p>','<input class="ui_button js-submitBtn" type="button" value="提交" class="ui_button">',"</form>","</div>","</div>"].join("");$(document.body).append(e),this.$div=$(".qui-feedback").fadeIn(300),$div=null},showLogin:function(){qyerUtil.doLogin()},bindEvt:function(){var e=this;this.$div.on("click",".js-btn",function(t){e[e.$div.hasClass("js-current")?"hideDiv":"showDiv"]()}).on("click","textarea.js-feedback-cnt",function(e){window.QYER&&window.QYER.uid||t.showLogin()}).on("click","input.js-submitBtn",function(n){if(window.QYER&&window.QYER.uid){var i=e.checkForm();i&&e.submitForm(i)}else t.showLogin()}),$(document).on("click",function(t){var n=$(t.target);n.closest(".qui-feedback").size()<1&&e.hideDiv()})},showDiv:function(){var e=this;this.$div.animate({right:0},200,function(){e.$div.addClass("js-current")})},hideDiv:function(){var e=this;this.$div.animate({right:-246},200,function(){e.$div.removeClass("js-current")})},checkValue:{cnt:function(e){var n=$(".js-feedback-cnt").val();if(n=$.trim(n),""==n||"有任何意见或建议请告诉我们"==n)return t.tip({text:"意见或建议不能为空",type:"error"}),!1;var i=window.qyerUtil.getWordLen(n);return i<20?(t.tip({text:"不能少于10个字",type:"error"}),!1):n}},checkForm:function(){var e=this.$div.find(".js-feedback-cnt").val();return this.checkValue.cnt(e)},submitForm:function(e){var n=this,i={data:{cnt:e,url:location.href},onSuccess:function(e){n.$div.find("textarea.js-feedback-cnt").val(""),t.tip({text:e.data.msg})},onError:function(e){console.log(e),77==e.error_code?t.showLogin():t.tip({text:e.data.msg,type:"error"})}};this.postFeedback(i)},postFeedback:function(e){e.posturl="http://common1.qyerstatic.com/public.php?action=feedback",window.qyerUtil.doAjax(e)}},t=new e}()},3e3),$(function(){$(document).on("click",function(e){0===e.button&&"true"==e.target.getAttribute("data-addtoplan")&&require(["common/component/addListToPlan/addListToPlan"],function(t){var n=$(e.target);t.qyerAddToPlan({obj:e.target,type:n.attr("data-type"),pid:n.attr("data-pid"),css:{"z-index":20}})})})}),define("common/basic/js/normalize",[],function(){function e(e,i,o){if(e.match(s)||e.match(a))return e;e=r(e);var l=o.match(a),c=i.match(a);return!c||l&&l[1]==c[1]&&l[2]==c[2]?n(t(e,i),o):t(e,i)}function t(e,t){if("./"==e.substr(0,2)&&(e=e.substr(2)),e.match(s)||e.match(a))return e;var n=t.split("/"),i=e.split("/");for(n.pop();curPart=i.shift();)".."==curPart?n.pop():n.push(curPart);return n.join("/")}function n(e,t){var n=t.split("/");for(n.pop(),t=n.join("/")+"/",i=0;t.substr(i,1)==e.substr(i,1);)i++;for(;"/"!=t.substr(i,1);)i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var o=e.split("/");for(out="";n.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var o=/([^:])\/+/g,r=function(e){return e.replace(o,"$1/")},a=/[^\:\/]*:\/\/([^\/])*/,s=/^(\/|data:)/,l=function(t,n,i){n=r(n),i=r(i);for(var o,a,t,s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=s.exec(t);){a=o[3]||o[2]||o[5]||o[6]||o[4];var l;l=e(a,n,i);var c=o[5]||o[6]?1:0;t=t.substr(0,s.lastIndex-a.length-c-1)+l+t.substr(s.lastIndex-c-1),s.lastIndex=s.lastIndex+(l.length-a.length)}return t};return l.convertURIBase=e,l.absoluteURI=t,l.relativeURI=n,l}),define("common/basic/js/require-css",[],function(){if("undefined"==typeof window)return{load:function(e,t,n){n()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,n=!1,i=!0;t[1]||t[7]?n=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]||t[8]?i=!1:t[4]&&(n=parseInt(t[4])<18);var o={};o.pluginBuilder="./css-builder";var r,a,s,l=function(){r=document.createElement("style"),e.appendChild(r),a=r.styleSheet||r.sheet},c=0,u=[],d=function(e){a.addImport(e),r.onload=function(){p()},c++,31==c&&(l(),c=0)},p=function(){s();var e=u.shift();return e?(s=e[1],void d(e[0])):void(s=null)},h=function(e,t){if(a&&a.addImport||l(),a&&a.addImport)s?u.push([e,t]):(d(e),s=t);else{r.textContent='@import "'+e+'";';var n=setInterval(function(){try{r.sheet.cssRules,clearInterval(n),t()}catch(e){}},10)}},f=function(t,n){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",i)o.onload=function(){o.onload=function(){},setTimeout(n,7)};else var r=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.href==o.href)return clearInterval(r),n()}},10);o.href=t,e.appendChild(o)};return o.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},o.load=function(e,t,i,o){(n?h:f)(t.toUrl(e+".css"),i)},o}),define("common/basic/js/require-css!common/ui/doMask/doMask",[],function(){}),define("common/ui/doMask/doMask",["css!./doMask.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!./doMask.css*/],function(){var e="",t="place-mask",n=function(n,i){e=n,t=i?i:"place-mask",$(n||"body").toggleClass(i?i:"place-mask")};return n.hideMask=function(){$(e||"body").removeClass(t)},n.showMask=function(){$(e||"body").addClass(t)},n}),define("common/util/util",[],function(){"use strict";return{getInstance:function(e,t){switch(t=t||[],t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);default:for(var n=[],i=0,o=t.length;i<o;i++)n.push("arguments["+i+"]");return new Function("return new this("+n.join(",")+");").apply(e,t)}},extend:function(e,t){$.extend(!0,e,t,e)},getStarHtml:function(e,t,n,i){e=Math.floor(e)/2;for(var o=[],r=1;r<=5;r++)e>=r?o.push(t):e+1>r?o.push(n):o.push(i);return o.join("")}}}),define("common/lang/aop",[],function(){"use strict";var e=function(e,n,i,o){var r,a,s=$.isFunction(e);if(s?(r=e,o=i,i=n):r=e[n],a=r,$.isFunction(i)){a=t(i,a,1);for(var l in r)a[l]=r[l]}if($.isFunction(o)){a=t(a,o,0);for(var l in r)a[l]=r[l]}return s||(e[n]=a),a},t=function(e,t,n){return function(){var i=e.apply(this,arguments),o=t.apply(this,arguments);return 0==n?i:o}},n=function(t,n,i){return e(t,n,i,null)},i=function(t,n,i){return e(t,n,null,i)},o=function(t,n,i,o){return e(t,n,i,o)};return{before:n,after:i,wrapper:o}}),define("common/lang/oo-static",["../util/util"],function(e){"use strict";return function(){e.extend(this,{getStatic:function(e){return e?this[e]:this},setStatic:function(t,n){return 1===arguments.length?e.extend(this,t):this[t]=n,this}}),this.implement({getStatic:function(e){return this.constructor.getStatic.apply(this.constructor,arguments)},setStatic:function(e,t){return this.constructor.setStatic.apply(this.constructor,arguments),this},callStatic:function(e,t){return this.getStatic(e).apply(this.constructor,t)}})}}),define("common/lang/oo",["../util/util","./aop","./oo-static"],function(e,t,n){"use strict";var i=function(e){var t=function(){};return t.prototype=e,new t},o=function(t,n,i){t?"function"!=typeof t&&(i=n,n=t,t=l):t=l;var o=r(t,function(){return this instanceof o?o.superclass.prototype.constructor.apply(this,arguments):e.getInstance(o,arguments)});return a(o,n),e.extend(o,t),e.extend(o,i),o.superclass=t,o},r=function(e,t){return t.prototype=i(e.prototype),t.prototype.constructor=t,t},a=function(e,t){for(var n in t)if(t[n]instanceof Function&&"callSuper"!==n&&"callParent"!==n){var i=s(n,e,t[n]);e.prototype[n]=i}else e.prototype[n]=t[n]},s=function(e,n,i){var o,r=t.wrapper(i,function(){o=this.__caller,this.__caller=r},function(){void 0===o?delete this.__caller:this.__caller=o});return r.__name=e,r.__owner=n,r},l=o(function(){this.init.apply(this,arguments)},{init:function(e){this.lang=e&&e.lang||this.lang},callParent:function(e){var t=Array.prototype.slice.call(arguments);return this.__caller.__owner.superclass.prototype[t.shift(0)].apply(this,t)},callSuper:function(){return this.__caller.__owner.superclass.prototype[this.__caller.__name].apply(this,arguments)},before:function(e,n){return t.before(this,e,s(e,this.constructor,function(){return n.apply(this,arguments)})),this},after:function(e,n){return t.after(this,e,s(e,this.constructor,function(){return n.apply(this,arguments)})),this}},{createClass:function(e,t){return o.apply(this,Array.prototype.concat.apply([this],arguments))},implement:function(e){return a(this,e),this},plugin:function(e,t){return e instanceof Function&&e.apply(this,t),this}}).plugin(n),c={Parent:l,createClass:o};return c}),define("common/lang/oo-event",["./aop"],function(e){"use strict";var t={getEventproxy:function(){return $(this)},bind:function(e,t){var n=this.getEventproxy();return n.bind.apply(n,arguments),this},unbind:function(e,t){var n=this.getEventproxy();return n.unbind.apply(n,arguments),this},on:function(){return this.bind.apply(this,arguments)},off:function(){return this.unbind.apply(this,arguments)},one:function(t,n){var i=arguments[1]=e.before(arguments[1],function(){this.unbind(t,i)});return this.bind.apply(this,arguments),this},trigger:function(e,t){var n=this.getEventproxy();return n.trigger.apply(n,arguments),this}};return t}),define("common/lang/i18n",[],function(){"use strict";var e={lang:"zh",i18n:function(e){return this.callStatic("getI18n",[this.lang,e])}},t={i18n_key:"i18n",lang:"zh",i18n:function(e,t){1===arguments.length&&(t=e,e=this.lang);var n=this.getStatic(this._i18n_key)||{};return n[e]=t,this.setStatic(this._i18n_key,n),this},getI18n:function(e,t){var n=(this.getStatic(this._i18n_key)||{})[e];return t?n[t]:n}};return function(){this.implement(e),this.setStatic(t)}}),define("common/widget/widget",["../lang/oo","../lang/oo-event","../lang/i18n"],function(e,t,n){return e.createClass({$el:null,_event_alias:"__widget",init:function(e){this.callSuper.apply(this,arguments),this.setAttrs(e||{}),this.delegateEvents(this.events),this.delegateEvents(e.events)},setAttrs:function(e,t){1===arguments.length&&(t=e,e=this.getStatic("ATTRS")),this._setAttrs(e,t)},_setAttrs:function(e,t){$.each(e,this.proxy(function(e,n){this.setAttr(e,t[e])}))},setAttr:function(e,t){t="undefined"==typeof t?this.getStatic("ATTRS")[e]:t,t="$"===e.charAt(0)?$(t):t,this[e]=t},$:function(e){return e?$(e,this.$el):this.$el},delegateEvents:function(e){return e&&$.each(e,$.proxy(function(e,t){this.delegateEvent.apply(this,t)},this)),this},delegateEvent:function(e,t,n){return e&&t&&(t="string"==typeof t&&$.isFunction(this[t])?$.proxy(this[t],this):$.proxy(t,this),this.$el.on(e+"."+this._event_alias,$.isFunction(n)?n.call(this):n,t)),this},undelegateEvents:function(){this.$el.off("."+this._event_alias)},proxy:function(e){return Array.prototype.splice.call(arguments,1,0,this),$.proxy.apply($,arguments)},destroy:function(){this.undelegateEvents();for(var e in this)if(this.hasOwnProperty(e)){if(this[e]&&$.isFunction(this[e].destroy))try{this[e].destroy()}catch(t){}delete this[e]}}},{ATTRS:{$el:document.body}}).implement(t).plugin(n)}),define("common/widget/userbehavior/config",[],function(){var e=['<span class="poiRedPoint" id="poiRedPoint"></span>','<div class="poiLikeTip" id="poiLikeTip">','<span class="close"></span>','<a href="javscript:void(0)" class="neverShow">不再提示</a>','<p class="text fontYaHei t1"><em>点击想去</em>，心爱的目的地不再错过！</p>','<p class="text fontYaHei t2">旅途中穷游app还可同步查看！</p>',"</div>",'<div class="poiLikeSmallTip" id="poiLikeSmallTip">',"收藏至“我的想去”，随时查看最新信息","</div>"].join(""),t={addPoiComment:{text:"点评旅行地",link:"javascript:void(0)",classname:"js-poiComment","data-bn-ipg":function(e){return"place-"+e.type+"-footprint-addcomment"}},addMguide:{text:"添加微锦囊",link:"http://place.qyer.com/mguide/add","data-bn-ipg":function(e){return"place-"+e.type+"-footprint-addmguide"}},addTripNote:{text:"写游记",link:function(e){return"http://bbs.qyer.com/thread-new?type=1&fid="+__GLOBAL_DATA__.fid},"data-bn-ipg":function(e){return"place-"+e.type+"-footprint-post"}},canelFootprint:{text:"取消足迹",link:"javascript:void(0)",classname:"js-cancelFootprint","data-bn-ipg":function(e){return"place-"+e.type+"-footprint-cancel"}}},n=function(e,t,n,i){return'<li><a data-bn-ipg="'+i+'" class="'+n+'" href="'+t+'">'+e+"</a></li>"},i=function(e,t){switch(typeof e){case"string":return e;case"function":return e(t);case"undefined":return""}},o={country:["planto","beento","lived"],city:["planto","beento","lived"],poi:["planto","beento","addToPlan"],outerClass:"place-userbehavior",beDoneClass:"selected",planto:{classname:["planto","fontYaHei","plcZIndex"].join(" "),text:"想去",sText:"已想去",exStr:e,"data-bn-ipg":function(e){switch(e.status){case 1:return"place-"+e.type+"-footprint-wishto-add";case 0:return"place-"+e.type+"-footprint-wishto-delete"}}},beento:{classname:["beento","fontYaHei"].join(" "),text:"去过",sText:"已去过",exStr:function(e){"undefined"!=typeof __GLOBAL_DATA__&&"undefined"!=typeof __GLOBAL_DATA__.fid||delete t.addTripNote;var o="<ul>";return $.each(t,function(t,r){o+=n(r.text,i(r.link,e),r.classname,i(r["data-bn-ipg"],e))}),o+="</ul>"},"data-bn-ipg":function(e){return"place-"+e.type+"-top-beenTo"}},lived:{classname:["lived","fontYaHei"].join(" "),text:"生活过",sText:"已生活过","data-bn-ipg":function(e){return"place-"+e.type+"-footprint-lived"}},addToPlan:{classname:["addToPlan","fontYaHei"].join(" "),text:"加入行程",sText:"加入行程",special:!0,getDom:function(e){return'<li class="'+o[e].classname+'" data-type="'+o.type+'" data-addtoplan="true" data-pid="'+o.id+'"><span class="fonts">'+o[e].text+"</span></li>"},"data-bn-ipg":function(){return"place-poi-top-addtoplan"}},getDom:function(e,t,n){o.type=e,o.id=t;var i="undefined"!=typeof n,r={};return r.inner=o[e],r.isLogin=i,n&&(r.userinfo=n),o.createDom(r)},createDom:function(e){var t="",n=e.isLogin,r={type:o.type,id:o.id};return $.each(e.inner,function(a,s){if(o[s].special)t+=o[s].getDom(s);else{var l=n?e.userinfo[s]-0:0;r.status=l,t+='<li class="'+o[s].classname+(n&&l?" selected":"")+'" data-type="'+s+'" data-status="'+(n?l:0)+'" data-bn-ipg="'+i(o[s]["data-bn-ipg"],r)+'"><span class="fonts">'+o[s][n&&l?"sText":"text"]+"</span>"+i(o[s].exStr,r)+"</li>"}}),'<ul class="'+o.outerClass+'">'+t+"</ul>"}};return o}),define("common/service/service",[],function(){return{post:function(e,t,n,i){return qyerUtil.doAjax({url:e,type:"POST",data:t,onSuccess:n,onError:i})},get:function(e,t,n,i){return qyerUtil.doAjax({url:e,type:"GET",data:t,onSuccess:n,onError:i})}}}),define("common/service/userbehavior/urls",[],function(){return{getBehaviorInfo:"http://common1.qyerstatic.com/public.php?action=getfeeling",feeling:"http://common1.qyerstatic.com/public.php?action=feeling"}}),define("common/service/userbehavior/userbehavior-service",["../service","./urls"],function(e,t){"use strict";var n={getBehaviorInfo:function(n,i,o){e.get(t.getBehaviorInfo,n,i,o)},feeling:function(n,i,o){e.post(t.feeling,n,i,o)}};return n}),define("common/widget/userbehavior/liketip",[],function(){function e(e){$.extend(this,e||{$poiRedPoint:$("#poiRedPoint"),$poiLikeTip:$("#poiLikeTip"),$poiLikeSmallTip:$("#poiLikeSmallTip"),$like:$("#poiRedPoint").parent(),$been:$("#poiRedPoint").parents("ul").find(".beento")}),this.init(),window.likeTipHanlder=this}return e.prototype={init:function(){var e=this;if(window.qyerUtil.isLogin()){if(e.checkIsLike()||e.checkIsBeenTo()||e.checkIsLived())return e.hideDom(e.$poiRedPoint),e.hideDom(e.$poiLikeTip),e.hideDom(e.$poiLikeSmallTip),!1;e.showDom(e.$poiRedPoint)}else e.showDom(e.$poiRedPoint);e.hideDom(e.$poiLikeTip),e.hideDom(e.$poiLikeSmallTip),e.checkCookie("_isNeverShowBigTip")?e.hoverShowDom(e.$poiLikeSmallTip):e.checkCookie("_isShowBigTip")>=3&&e.hoverShowDom(e.$poiLikeSmallTip),e.bindEvent()},bindEvent:function(){var e=this;e.$poiLikeTip.find(".close").on("click",function(t){if(e.checkCookie("_isShowBigTip")){var n=new Date;n.setTime(n.getTime()+31104e6),e.setCookie("_isNeverShowBigTip=true;expires="+n.toGMTString()+";path=/")}else e.setCookie("_isShowBigTip=1");return e.hideDom(e.$poiLikeTip),t.stopPropagation(),!1}).addBack().find(".neverShow").on("click",function(t){var n=e.checkCookie("_isShowBigTip")-0+1,i=new Date;return i.setTime(i.getTime()+31104e6),e.setCookie("_isNeverShowBigTip="+n+";expires="+i.toGMTString()+";path=/"),e.hideDom(e.$poiLikeTip),t.stopPropagation(),!1}),e.$like.on("mouseenter",function(){e.checkCookie("_isNeverShowBigTip")||e.checkCookie("_isShowBigTip")>=3||e.checkIsBeenTo()||e.checkIsLike()||e.checkIsLived()||e.showDom(e.$poiLikeTip)})},hideDom:function(e){e.removeClass("poiLikeHoverShow poiLikeShow")},showDom:function(e){e.addClass("poiLikeShow")},hoverShowDom:function(e){e.addClass("poiLikeHoverShow")},checkIsLike:function(){return this.$like.hasClass("selected")},checkIsBeenTo:function(){return this.$been.hasClass("selected")},checkIsLived:function(){return $(".place-userbehavior").length>0&&($(".place-userbehavior").find(".lived").length>0&&$(".place-userbehavior").find(".lived").hasClass("selected"))},setCookie:function(e){document.cookie=e},checkCookie:function(e){for(var t=this.getCookie(),n=t.split(";"),i=0,o=n.length,r=!1;i<o;i++)if($.trim(e)==$.trim(n[i]).split("=")[0]){r=$.trim(n[i]).split("=")[1];break}return r},getCookie:function(){return document.cookie},closeAll:function(){var e=this;e.hideDom(e.$poiRedPoint),e.hideDom(e.$poiLikeTip),e.hideDom(e.$poiLikeSmallTip)}},e}),define("project/js/batch_add_footprint",[],function(){function e(e,t,n,i){var o="";"city"==t||"area"==t?requirejs(["common/component/footprint/js/footprint"],function(t){t.poiShow({city_id:e,show_type:"poi"})}):"poi"==t?qyerUI.popup.ajax({url:"/api.php?action=addpoicomment&from=poi&source_type=11&poiid="+e+"&typeid="+PLACE.CITYID+"&type=city",width:"690",isclose:"show"}):"country"==t&&requirejs(["common/component/footprint/js/footprint"],function(t){t.countryFpShow({country_id:e,show_type:"country"})}),""==o}return e}),define("common/basic/js/require-css!common/ui/popup/popup",[],function(){}),define("common/ui/popup/popup",["css!common/ui/popup/popup.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/ui/popup/popup.css*/],function(){var e=jQuery,t={$ui:null,$content:null,$box:null,$title:null,$okBtn:null,$cancelBtn:null,$loadBtn:null,$closeIcon:null,_uiState:"normal",defaultWidth:400,init:function(){var t=['<div class="qui-popup" style="display:none">',"<div>",'<div class="qui-popup-dt">','<div class="qui-popup-box">','<div class="qui-popup-closeIcon">&nbsp;</div>','<div class="qui-popup-box-title fontYaHei">title</div>','<div class="qui-popup-box-content">',"</div>",'<div class="qui-popup-box-bottom">',"&nbsp;",'<input class="qui-popup-cancelBtn ui_button_cancel" type="button" value="取消" />  ','<input class="qui-popup-okBtn ui_button" type="button" value="确定" />  ','<input class="qui-popup-loadingBtn  ui_button_load" type="button" value="" />  ',"</div>","</div>","</div>","</div>","</div>"].join("");this.$ui=e(t),this.$content=this.$ui.find(".qui-popup-box-content"),this.$box=this.$ui.find(".qui-popup-box"),this.$title=this.$ui.find(".qui-popup-box-title"),this.$okBtn=this.$ui.find(".qui-popup-okBtn"),this.$cancelBtn=this.$ui.find(".qui-popup-cancelBtn"),this.$loadBtn=this.$ui.find(".qui-popup-loadingBtn"),this.$closeIcon=this.$ui.find(".qui-popup-closeIcon"),this.$ui.appendTo(document.body)},setWidth:function(e){this.$box.animate({width:e},300)},setUIDefault:function(e){this.$ui[0].className="qui-popup",e.exClassName&&this.$ui.addClass(e.exClassName),e.iframeSrc?this.$content.html('<iframe src="'+e.iframeSrc+'"  scrolling="auto" style="height:'+(e.iframeHeight||300)+'px;"  />'):this.$content.html(e.contentHTML||"&nbsp;"),this.$title.html(e.title||"Title"),this.$box.css("width",e.width||this.defaultWidth),this.$title[e.showTitle===!1?"hide":"show"](),this.$okBtn.val(e.okText||"确定"),this.$cancelBtn.val(e.cancelText||"取消"),this.$okBtn[e.showOKBtn===!1?"hide":"show"](),this.$okBtn.removeAttr("data-bn-ipg"),this.$cancelBtn[e.showCancelBtn===!1?"hide":"show"](),this.$cancelBtn.removeAttr("data-bn-ipg"),this.$loadBtn[e.showLoadBtn===!0?"show":"hide"](),this.$loadBtn.removeAttr("data-bn-ipg"),this.$ui.find(".qui-popup-closeIcon").removeAttr("data-bn-ipg"),this.$closeIcon[e.showCloseIcon===!1?"hide":"show"]()},show:function(n){if("hideing"==t._uiState)t.$box.stop(),t.$ui.stop(),this.$ui.css({display:"block",opacity:1}),this.$box.css({top:0,opacity:1}),t._uiState="normal",n.onShow&&n.onShow();else{t._uiState="showing";var i={},o={top:0};e.support.leadingWhitespace&&(i.opacity=1,o.opacity=1),this.$ui.css("display","block").animate(i,200,function(){t.$box.css("top",-30).animate(o,200,function(){t._uiState="normal",n.onShow&&n.onShow()})})}},hide:function(n){if(!n||!n.onBeforeHide||n.onBeforeHide()!==!1){t._uiState="hideing";var i={top:-30},o={};e.support.leadingWhitespace&&(i.opacity=0,o.opacity=0),this.$box.animate(i,200,function(){t.$ui.animate(o,200,function(){t._uiState="normal",t.$ui.css("display","none"),t.$content.html(""),n&&n.onAfterHide&&n.onAfterHide()})})}}};t.init();var n=null,i={show:function(e){return n=e,t.setUIDefault(e),t.$ui.undelegate("click").delegate(".qui-popup-okBtn,.qui-popup-cancelBtn,.qui-popup-closeIcon","click",function(n){if(this.className.indexOf("qui-popup-closeIcon")!=-1||this.className.indexOf("qui-popup-cancelBtn")!=-1){if(e.onBeforeCancel&&!e.onBeforeCancel(n))return;e.onCancel&&e.onCancel()}else if(this.className.indexOf("qui-popup-okBtn")!=-1&&e.onOK&&e.onOK()===!1)return;t.hide(e)}),t.show(e),this},hide:function(e){return t.hide(e),this},setContent:function(e){return t.$content.html(e),this},getContent:function(){return t.$content[0]},getButtons:function(){return{okBtn:t.$okBtn[0],cancelBtn:t.$cancelBtn[0],loadBtn:t.$loadBtn[0],closeIcon:t.$ui.find(".qui-popup-closeIcon")[0]}},setOption:function(i){var o={width:function(){t.setWidth(i.width)},showTitle:function(){i.showTitle===!1?t.$title.hide():t.$title.show()},okText:function(){t.$okBtn.val(i.okText)},cancelText:function(){t.$cancelBtn.val(i.cancelText)},showOKBtn:function(){i.showOKBtn===!1?t.$okBtn.hide():t.$okBtn.show()},showCancelBtn:function(){i.showCancelBtn===!1?t.$cancelBtn.hide():t.$cancelBtn.show()},showLoadBtn:function(){i.showLoadBtn===!1?t.$loadBtn.hide():t.$loadBtn.show()},showCloseIcon:function(){i.showCloseIcon===!1?t.$closeIcon.hide():t.$closeIcon.show()},title:function(){t.$title.html(i.title)},exClassName:function(){t.$ui[0].className="qui-popup "+i.exClassName},contentHTML:function(){i.iframeSrc||t.$content.html(i.contentHTML)},iframeSrc:function(){t.$content.html('<iframe src="'+i.iframeSrc+'"  scrolling="auto" style="height:'+(i.iframeHeight||300)+'px;" />')},iframeHeight:function(){t.$content.children("iframe").css("height",i.iframeHeight)}};for(var r in i)n[r]=i[r],"function"==e.type(o[r])&&o[r]()}};return i}),!function(e,t){"use strict";function n(e,t){for(var n,i=[],r=0;r<e.length;++r){if(n=a[e[r]]||o(e[r]),!n)throw"module definition dependecy not found: "+e[r];i.push(n)}t.apply(null,i)}function i(e,i,o){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(i===t)throw"invalid module definition, dependencies must be specified";if(o===t)throw"invalid module definition, definition function must be specified";n(i,function(){a[e]=o.apply(null,arguments)})}function o(t){for(var n=e,i=t.split(/[.\/]/),o=0;o<i.length;++o){if(!n[i[o]])return;n=n[i[o]]}return n}function r(n){for(var i=0;i<n.length;i++){for(var o=e,r=n[i],s=r.split(/[.\/]/),l=0;l<s.length-1;++l)o[s[l]]===t&&(o[s[l]]={}),o=o[s[l]];o[s[s.length-1]]=a[r]}}var a={},s="moxie/core/utils/Basic",l="moxie/core/I18n",c="moxie/core/utils/Mime",u="moxie/core/utils/Env",d="moxie/core/utils/Dom",p="moxie/core/Exceptions",h="moxie/core/EventTarget",f="moxie/core/utils/Encode",m="moxie/runtime/Runtime",g="moxie/runtime/RuntimeClient",v="moxie/file/Blob",b="moxie/file/File",_="moxie/file/FileInput",x="moxie/file/FileDrop",y="moxie/runtime/RuntimeTarget",w="moxie/file/FileReader",E="moxie/core/utils/Url",k="moxie/file/FileReaderSync",$="moxie/xhr/FormData",R="moxie/xhr/XMLHttpRequest",T="moxie/runtime/Transporter",C="moxie/image/Image",S="moxie/runtime/html5/Runtime",q="moxie/runtime/html5/file/Blob",I="moxie/core/utils/Events",A="moxie/runtime/html5/file/FileInput",O="moxie/runtime/html5/file/FileDrop",L="moxie/runtime/html5/file/FileReader",D="moxie/runtime/html5/xhr/XMLHttpRequest",j="moxie/runtime/html5/utils/BinaryReader",N="moxie/runtime/html5/image/JPEGHeaders",P="moxie/runtime/html5/image/ExifParser",B="moxie/runtime/html5/image/JPEG",F="moxie/runtime/html5/image/PNG",U="moxie/runtime/html5/image/ImageInfo",M="moxie/runtime/html5/image/MegaPixel",z="moxie/runtime/html5/image/Image",H="moxie/runtime/flash/Runtime",G="moxie/runtime/flash/file/Blob",V="moxie/runtime/flash/file/FileInput",X="moxie/runtime/flash/file/FileReader",W="moxie/runtime/flash/file/FileReaderSync",Y="moxie/runtime/flash/xhr/XMLHttpRequest",Q="moxie/runtime/flash/runtime/Transporter",J="moxie/runtime/flash/image/Image",K="moxie/runtime/silverlight/Runtime",Z="moxie/runtime/silverlight/file/Blob",ee="moxie/runtime/silverlight/file/FileInput",te="moxie/runtime/silverlight/file/FileDrop",ne="moxie/runtime/silverlight/file/FileReader",ie="moxie/runtime/silverlight/file/FileReaderSync",oe="moxie/runtime/silverlight/xhr/XMLHttpRequest",re="moxie/runtime/silverlight/runtime/Transporter",ae="moxie/runtime/silverlight/image/Image",se="moxie/runtime/html4/Runtime",le="moxie/runtime/html4/file/FileInput",ce="moxie/runtime/html4/file/FileReader",ue="moxie/runtime/html4/xhr/XMLHttpRequest",de="moxie/runtime/html4/image/Image";i(s,[],function(){var e=function(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},t=function(i){var o;return n(arguments,function(r,s){s>0&&n(r,function(n,r){n!==o&&(e(i[r])===e(n)&&~a(e(n),["array","object"])?t(i[r],n):i[r]=n)})}),i},n=function(e,t){var n,i,o,r;if(e){try{n=e.length}catch(a){n=r}if(n===r){for(i in e)if(e.hasOwnProperty(i)&&t(e[i],i)===!1)return}else for(o=0;n>o;o++)if(t(e[o],o)===!1)return}},i=function(t){var n;if(!t||"object"!==e(t))return!0;for(n in t)return!1;return!0},o=function(t,n){function i(o){"function"===e(t[o])&&t[o](function(e){++o<r&&!e?i(o):n(e)})}var o=0,r=t.length;"function"!==e(n)&&(n=function(){}),t&&t.length||n(),i(o)},r=function(e,t){var i=0,o=e.length,r=new Array(o);n(e,function(e,n){e(function(e){if(e)return t(e);var a=[].slice.call(arguments);a.shift(),r[n]=a,i++,i===o&&(r.unshift(null),t.apply(this,r))})})},a=function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n}return-1},s=function(t,n){var i=[];"array"!==e(t)&&(t=[t]),"array"!==e(n)&&(n=[n]);for(var o in t)-1===a(t[o],n)&&i.push(t[o]);return!!i.length&&i},l=function(e,t){var i=[];return n(e,function(e){-1!==a(e,t)&&i.push(e)}),i.length?i:null},c=function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},u=function(){var e=0;return function(t){var n,i=(new Date).getTime().toString(32);for(n=0;5>n;n++)i+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+i+(e++).toString(32)}}(),d=function(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e},p=function(e){if("string"!=typeof e)return e;var t,n={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],n.hasOwnProperty(t)&&(e*=n[t]),e};return{guid:u,typeOf:e,extend:t,each:n,isEmptyObj:i,inSeries:o,inParallel:r,inArray:a,arrayDiff:s,arrayIntersect:l,toArray:c,trim:d,parseSizeStr:p}}),i(l,[s],function(e){var t={};return{addI18n:function(n){return e.extend(t,n)},translate:function(e){return t[e]||e},_:function(e){return this.translate(e)},sprintf:function(t){var n=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=n.shift();return"undefined"!==e.typeOf(t)?t:""})}}}),i(c,[s,l],function(e,t){var n="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",i={mimes:{},extensions:{},addMimeType:function(e){var t,n,i,o=e.split(/,/);for(t=0;t<o.length;t+=2){for(i=o[t+1].split(/ /),n=0;n<i.length;n++)this.mimes[i[n]]=o[t];this.extensions[o[t]]=i}},extList2mimes:function(t,n){var i,o,r,a,s=this,l=[];for(o=0;o<t.length;o++)for(i=t[o].extensions.split(/\s*,\s*/),r=0;r<i.length;r++){if("*"===i[r])return[];if(a=s.mimes[i[r]])-1===e.inArray(a,l)&&l.push(a);else{if(!n||!/^\w+$/.test(i[r]))return[];l.push("."+i[r])}}return l},mimes2exts:function(t){var n=this,i=[];return e.each(t,function(t){if("*"===t)return i=[],!1;var o=t.match(/^(\w+)\/(\*|\w+)$/);o&&("*"===o[2]?e.each(n.extensions,function(e,t){new RegExp("^"+o[1]+"/").test(t)&&[].push.apply(i,n.extensions[t])}):n.extensions[t]&&[].push.apply(i,n.extensions[t]))}),i},mimes2extList:function(n){var i=[],o=[];
return"string"===e.typeOf(n)&&(n=e.trim(n).split(/\s*,\s*/)),o=this.mimes2exts(n),i.push({title:t.translate("Files"),extensions:o.length?o.join(","):"*"}),i.mimes=n,i},getFileExtension:function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""},getFileMime:function(e){return this.mimes[this.getFileExtension(e)]||""}};return i.addMimeType(n),i}),i(u,[s],function(e){function t(e,t,n){var i=0,o=0,r=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(e){return e=(""+e).replace(/[_\-+]/g,"."),e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),e.length?e.split("."):[-8]},l=function(e){return e?isNaN(e)?a[e]||-7:parseInt(e,10):0};for(e=s(e),t=s(t),o=Math.max(e.length,t.length),i=0;o>i;i++)if(e[i]!=t[i]){if(e[i]=l(e[i]),t[i]=l(t[i]),e[i]<t[i]){r=-1;break}if(e[i]>t[i]){r=1;break}}if(!n)return r;switch(n){case">":case"gt":return r>0;case">=":case"ge":return r>=0;case"<=":case"le":return 0>=r;case"==":case"=":case"eq":return 0===r;case"<>":case"!=":case"ne":return 0!==r;case"":case"<":case"lt":return 0>r;default:return null}}var n=function(e){var t="",n="?",i="function",o="undefined",r="object",a="major",s="name",l="version",c={has:function(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()}},u={rgx:function(){for(var t,n,a,s,l,c,u,d=0,p=arguments;d<p.length;d+=2){var h=p[d],f=p[d+1];if(typeof t===o){t={};for(s in f)l=f[s],typeof l===r?t[l[0]]=e:t[l]=e}for(n=a=0;n<h.length;n++)if(c=h[n].exec(this.getUA())){for(s=0;s<f.length;s++)u=c[++a],l=f[s],typeof l===r&&l.length>0?2==l.length?t[l[0]]=typeof l[1]==i?l[1].call(this,u):l[1]:3==l.length?t[l[0]]=typeof l[1]!==i||l[1].exec&&l[1].test?u?u.replace(l[1],l[2]):e:u?l[1].call(this,u,l[2]):e:4==l.length&&(t[l[0]]=u?l[3].call(this,u.replace(l[1],l[2])):e):t[l]=u?u:e;break}if(c)break}return t},str:function(t,i){for(var o in i)if(typeof i[o]===r&&i[o].length>0){for(var a=0;a<i[o].length;a++)if(c.has(i[o][a],t))return o===n?e:o}else if(c.has(i[o],t))return o===n?e:o;return t}},d={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"http://common1.qyerstatic.com/place/js/poi/4.90","http://common1.qyerstatic.com/place/js/poi/NT 3.11":"http://common1.qyerstatic.com/place/js/poi/NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},p={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[s,l,a],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[s,"Opera"],l,a],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[s,l,a],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[s,"IE"],l,a],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[s,"Yandex"],l,a],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[s,/_/g," "],l,a],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[s,l,a],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[s,"Dolphin"],l,a],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[s,"Chrome"],l,a],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[s,"Android Browser"],l,a],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[l,a,[s,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[l,a,s],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[s,[a,u.str,d.browser.oldsafari.major],[l,u.str,d.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[s,l,a],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[s,"Netscape"],l,a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[s,l,a]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,l],[/rv\:([\w\.]+).*(gecko)/i],[l,s]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[l,u.str,d.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[l,u.str,d.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[s,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],l],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],l],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],l],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,l],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[l,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[s,[l,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[s,l]]},h=function(e){var n=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:t);this.getBrowser=function(){return u.rgx.apply(this,p.browser)},this.getEngine=function(){return u.rgx.apply(this,p.engine)},this.getOS=function(){return u.rgx.apply(this,p.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this.setUA(n)};return(new h).getResult()}(),i=function(){var t={define_property:function(){return!1}(),create_canvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),return_response_type:function(t){try{if(-1!==e.inArray(t,["","text","document"]))return!0;if(window.XMLHttpRequest){var n=new XMLHttpRequest;if(n.open("get","/"),"responseType"in n)return n.responseType=t,n.responseType===t}}catch(i){}return!1},use_data_uri:function(){var e=new Image;return e.onload=function(){t.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return t.use_data_uri&&("IE"!==o.browser||o.version>=9)},use_data_uri_of:function(e){return t.use_data_uri&&33e3>e||t.use_data_uri_over32kb()},use_fileinput:function(){var e=document.createElement("input");return e.setAttribute("type","file"),!e.disabled}};return function(n){var i=[].slice.call(arguments);return i.shift(),"function"===e.typeOf(t[n])?t[n].apply(this,i):!!t[n]}}(),o={can:i,browser:n.browser.name,version:parseFloat(n.browser.major),os:n.os.name,osVersion:n.os.version,verComp:t,swf_url:"../flash/Moxie.swf"/*tpa=http://common1.qyerstatic.com/place/js/flash/Moxie.swf*/,xap_url:"http://common1.qyerstatic.com/place/js/silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return o.OS=o.os,o}),i(d,[u],function(e){var t=function(e){return"string"!=typeof e?e:document.getElementById(e)},n=function(e,t){if(!e.className)return!1;var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return n.test(e.className)},i=function(e,t){n(e,t)||(e.className=e.className?e.className.replace(/\s+$/,"")+" "+t:t)},o=function(e,t){if(e.className){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return" "===t&&" "===n?" ":""})}},r=function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},a=function(t,n){function i(e){var t,n,i=0,o=0;return e&&(n=e.getBoundingClientRect(),t="CSS1Compat"===c.compatMode?c.documentElement:c.body,i=n.left+t.scrollLeft,o=n.top+t.scrollTop),{x:i,y:o}}var o,r,a,s=0,l=0,c=document;if(t=t,n=n||c.body,t&&t.getBoundingClientRect&&"IE"===e.browser&&(!c.documentMode||c.documentMode<8))return r=i(t),a=i(n),{x:r.x-a.x,y:r.y-a.y};for(o=t;o&&o!=n&&o.nodeType;)s+=o.offsetLeft||0,l+=o.offsetTop||0,o=o.offsetParent;for(o=t.parentNode;o&&o!=n&&o.nodeType;)s-=o.scrollLeft||0,l-=o.scrollTop||0,o=o.parentNode;return{x:s,y:l}},s=function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}};return{get:t,hasClass:n,addClass:i,removeClass:o,getStyle:r,getPos:a,getSize:s}}),i(p,[s],function(e){function t(e,t){var n;for(n in e)if(e[n]===t)return n;return null}return{RuntimeError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": RuntimeError "+this.code}var i={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(n,i),n.prototype=Error.prototype,n}(),OperationNotAllowedException:function(){function t(e){this.code=e,this.name="OperationNotAllowedException"}return e.extend(t,{NOT_ALLOWED_ERR:1}),t.prototype=Error.prototype,t}(),ImageError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": ImageError "+this.code}var i={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return e.extend(n,i),n.prototype=Error.prototype,n}(),FileException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": FileException "+this.code}var i={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(n,i),n.prototype=Error.prototype,n}(),DOMException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": DOMException "+this.code}var i={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(n,i),n.prototype=Error.prototype,n}(),EventException:function(){function t(e){this.code=e,this.name="EventException"}return e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0}),t.prototype=Error.prototype,t}()}}),i(h,[p,s],function(e,t){function n(){var n={};t.extend(this,{uid:null,init:function(){this.uid||(this.uid=t.guid("uid_"))},addEventListener:function(e,i,o,r){var a,s=this;return e=t.trim(e),/\s/.test(e)?void t.each(e.split(/\s+/),function(e){s.addEventListener(e,i,o,r)}):(e=e.toLowerCase(),o=parseInt(o,10)||0,a=n[this.uid]&&n[this.uid][e]||[],a.push({fn:i,priority:o,scope:r||this}),n[this.uid]||(n[this.uid]={}),void(n[this.uid][e]=a))},hasEventListener:function(e){return e?!(!n[this.uid]||!n[this.uid][e]):!!n[this.uid]},removeEventListener:function(e,i){e=e.toLowerCase();var o,r=n[this.uid]&&n[this.uid][e];if(r){if(i){for(o=r.length-1;o>=0;o--)if(r[o].fn===i){r.splice(o,1);break}}else r=[];r.length||(delete n[this.uid][e],t.isEmptyObj(n[this.uid])&&delete n[this.uid])}},removeAllEventListeners:function(){n[this.uid]&&delete n[this.uid]},dispatchEvent:function(i){var o,r,a,s,l,c={},u=!0;if("string"!==t.typeOf(i)){if(s=i,"string"!==t.typeOf(s.type))throw new e.EventException(e.EventException.UNSPECIFIED_EVENT_TYPE_ERR);i=s.type,s.total!==l&&s.loaded!==l&&(c.total=s.total,c.loaded=s.loaded),c.async=s.async||!1}if(-1!==i.indexOf("::")?function(e){o=e[0],i=e[1]}(i.split("::")):o=this.uid,i=i.toLowerCase(),r=n[o]&&n[o][i]){r.sort(function(e,t){return t.priority-e.priority}),a=[].slice.call(arguments),a.shift(),c.type=i,a.unshift(c);var d=[];t.each(r,function(e){a[0].target=e.scope,c.async?d.push(function(t){setTimeout(function(){t(e.fn.apply(e.scope,a)===!1)},1)}):d.push(function(t){t(e.fn.apply(e.scope,a)===!1)})}),d.length&&t.inSeries(d,function(e){u=!e})}return u},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(e){var n;"array"!==t.typeOf(e)&&(e=[e]);for(var i=0;i<e.length;i++)n="on"+e[i],"function"===t.typeOf(this[n])?this.addEventListener(e[i],this[n]):"undefined"===t.typeOf(this[n])&&(this[n]=null)}})}return n.instance=new n,n}),i(f,[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))},n=function(e,n){if("function"==typeof window.atob)return n?t(window.atob(e)):window.atob(e);var i,o,r,a,s,l,c,u,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,h=0,f="",m=[];if(!e)return e;e+="";do a=d.indexOf(e.charAt(p++)),s=d.indexOf(e.charAt(p++)),l=d.indexOf(e.charAt(p++)),c=d.indexOf(e.charAt(p++)),u=a<<18|s<<12|l<<6|c,i=255&u>>16,o=255&u>>8,r=255&u,m[h++]=64==l?String.fromCharCode(i):64==c?String.fromCharCode(i,o):String.fromCharCode(i,o,r);while(p<e.length);return f=m.join(""),n?t(f):f},i=function(t,n){if(n&&e(t),"function"==typeof window.btoa)return window.btoa(t);var i,o,r,a,s,l,c,u,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,h=0,f="",m=[];if(!t)return t;do i=t.charCodeAt(p++),o=t.charCodeAt(p++),r=t.charCodeAt(p++),u=i<<16|o<<8|r,a=63&u>>18,s=63&u>>12,l=63&u>>6,c=63&u,m[h++]=d.charAt(a)+d.charAt(s)+d.charAt(l)+d.charAt(c);while(p<t.length);f=m.join("");var g=t.length%3;return(g?f.slice(0,g-3):f)+"===".slice(g||3)};return{utf8_encode:e,utf8_decode:t,atob:n,btoa:i}}),i(m,[s,d,h],function(e,t,n){function i(n,o,a,s,l){var c,u=this,d=e.guid(o+"_"),p=l||"browser";n=n||{},r[d]=this,a=e.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},a),n.preferred_caps&&(p=i.getMode(s,n.preferred_caps,p)),c=function(){var t={};return{exec:function(e,n,i,o){return c[n]&&(t[e]||(t[e]={context:this,instance:new c[n]}),t[e].instance[i])?t[e].instance[i].apply(this,o):void 0},removeInstance:function(e){delete t[e]},removeAllInstances:function(){var n=this;e.each(t,function(t,i){"function"===e.typeOf(t.instance.destroy)&&t.instance.destroy.call(t.context),n.removeInstance(i)})}}}(),e.extend(this,{initialized:!1,uid:d,type:o,mode:i.getMode(s,n.required_caps,p),shimid:d+"_container",clients:0,options:n,can:function(t,n){var o=arguments[2]||a;if("string"===e.typeOf(t)&&"undefined"===e.typeOf(n)&&(t=i.parseCaps(t)),"object"===e.typeOf(t)){for(var r in t)if(!this.can(r,t[r],o))return!1;return!0}return"function"===e.typeOf(o[t])?o[t].call(this,n):n===o[t]},getShimContainer:function(){var n,i=t.get(this.shimid);return i||(n=this.options.container?t.get(this.options.container):document.body,i=document.createElement("div"),i.id=this.shimid,i.className="moxie-shim moxie-shim-"+this.type,e.extend(i.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),n.appendChild(i),n=null),i},getShim:function(){return c},shimExec:function(e,t){var n=[].slice.call(arguments,2);return u.getShim().exec.call(this,this.uid,e,t,n)},exec:function(e,t){var n=[].slice.call(arguments,2);return u[e]&&u[e][t]?u[e][t].apply(this,n):u.shimExec.apply(this,arguments)},destroy:function(){if(u){var e=t.get(this.shimid);e&&e.parentNode.removeChild(e),c&&c.removeAllInstances(),this.unbindAll(),delete r[this.uid],this.uid=null,d=u=c=e=null}}}),this.mode&&n.required_caps&&!this.can(n.required_caps)&&(this.mode=!1)}var o={},r={};return i.order="html5,flash,silverlight,html4",i.getRuntime=function(e){return!!r[e]&&r[e]},i.addConstructor=function(e,t){t.prototype=n.instance,o[e]=t},i.getConstructor=function(e){return o[e]||null},i.getInfo=function(e){var t=i.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},i.parseCaps=function(t){var n={};return"string"!==e.typeOf(t)?t||{}:(e.each(t.split(","),function(e){n[e]=!0}),n)},i.can=function(e,t){var n,o,r=i.getConstructor(e);return!!r&&(n=new r({required_caps:t}),o=n.mode,n.destroy(),!!o)},i.thatCan=function(e,t){var n=(t||i.order).split(/\s*,\s*/);for(var o in n)if(i.can(n[o],e))return n[o];return null},i.getMode=function(t,n,i){var o=null;if("undefined"===e.typeOf(i)&&(i="browser"),n&&!e.isEmptyObj(t)){if(e.each(n,function(n,i){if(t.hasOwnProperty(i)){var r=t[i](n);if("string"==typeof r&&(r=[r]),o){if(!(o=e.arrayIntersect(o,r)))return o=!1}else o=r}}),o)return-1!==e.inArray(i,o)?i:o[0];if(o===!1)return!1}return i},i.capTrue=function(){return!0},i.capFalse=function(){return!1},i.capTest=function(e){return function(){return!!e}},i}),i(g,[p,s,m],function(e,t,n){return function i(){var i;t.extend(this,{connectRuntime:function(o){function r(t){var a,l;return t.length?(a=t.shift(),(l=n.getConstructor(a))?(i=new l(o),i.bind("Init",function(){i.initialized=!0,setTimeout(function(){i.clients++,s.trigger("RuntimeInit",i)},1)}),i.bind("Error"http://common1.qyerstatic.com/place/js/poi/,function(){i.destroy(),r(t)}),i.mode?void i.init():void i.trigger("Error")):void r(t)):(s.trigger("RuntimeError",new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)),void(i=null))}var a,s=this;if("string"===t.typeOf(o)?a=o:"string"===t.typeOf(o.ruid)&&(a=o.ruid),a){if(i=n.getRuntime(a))return i.clients++,i;throw new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)}r((o.runtime_order||n.order).split(/\s*,\s*/))},getRuntime:function(){return i&&i.uid?i:(i=null,null)},disconnectRuntime:function(){i&&--i.clients<=0&&(i.destroy(),i=null)}})}}),i(v,[s,f,g],function(e,t,n){function i(r,a){function s(t,n,r){var a,s=o[this.uid];return"string"===e.typeOf(s)&&s.length?(a=new i(null,{type:r,size:n-t}),a.detach(s.substr(t,a.size)),a):null}n.call(this),r&&this.connectRuntime(r),a?"string"===e.typeOf(a)&&(a={data:a}):a={},e.extend(this,{uid:a.uid||e.guid("uid_"),ruid:r,size:a.size||0,type:a.type||"",slice:function(e,t,n){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,n)},getSource:function(){return o[this.uid]?o[this.uid]:null},detach:function(e){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy",o[this.uid]),this.disconnectRuntime(),this.ruid=null),e=e||"";var n=e.match(/^data:([^;]*);base64,/);n&&(this.type=n[1],e=t.atob(e.substring(e.indexOf("base64,")+7))),this.size=e.length,o[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===e.typeOf(o[this.uid])},destroy:function(){this.detach(),delete o[this.uid]}}),a.data?this.detach(a.data):o[this.uid]=a}var o={};return i}),i(b,[s,c,v],function(e,t,n){function i(i,o){var r,a;if(o||(o={}),a=o.type&&""!==o.type?o.type:t.getFileMime(o.name),o.name)r=o.name.replace(/\\/g,"/"),r=r.substr(r.lastIndexOf("/")+1);else{var s=a.split("/")[0];r=e.guid((""!==s?s:"file")+"_"),t.extensions[a]&&(r+="."+t.extensions[a][0])}n.apply(this,arguments),e.extend(this,{type:a||"",name:r||e.guid("file_"),lastModifiedDate:o.lastModifiedDate||(new Date).toLocaleString()})}return i.prototype=n.prototype,i}),i(_,[s,c,d,p,h,l,b,m,g],function(e,t,n,i,o,r,a,s,l){function c(o){var c,d,p,h=this;if(-1!==e.inArray(e.typeOf(o),["string","node"])&&(o={browse_button:o}),d=n.get(o.browse_button),!d)throw new i.DOMException(i.DOMException.NOT_FOUND_ERR);p={accept:[{title:r.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:d.parentNode||document.body},o=e.extend({},p,o),"string"==typeof o.required_caps&&(o.required_caps=s.parseCaps(o.required_caps)),"string"==typeof o.accept&&(o.accept=t.mimes2extList(o.accept)),c=n.get(o.container),c||(c=document.body),"static"===n.getStyle(c,"position")&&(c.style.position="relative"),c=d=null,l.call(h),e.extend(h,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){h.convertEventPropsToHandlers(u),h.bind("RuntimeInit",function(t,i){h.ruid=i.uid,h.shimid=i.shimid,h.bind("Ready",function(){h.trigger("Refresh")},999),h.bind("Change",function(){var t=i.exec.call(h,"FileInput","getFiles");h.files=[],e.each(t,function(e){return 0===e.size||void h.files.push(new a(h.ruid,e))})},999),h.bind("Refresh",function(){var t,r,a,s;a=n.get(o.browse_button),s=n.get(i.shimid),a&&(t=n.getPos(a,n.get(o.container)),r=n.getSize(a),s&&e.extend(s.style,{top:t.y+"px",left:t.x+"px",width:r.w+"px",height:r.h+"px"})),s=a=null}),i.exec.call(h,"FileInput","init",o)}),h.connectRuntime(e.extend({},o,{required_caps:{select_file:!0}}))},disable:function(t){var n=this.getRuntime();n&&n.exec.call(this,"FileInput","disable","undefined"===e.typeOf(t)||t)},refresh:function(){h.trigger("Refresh")},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===e.typeOf(this.files)&&e.each(this.files,function(e){e.destroy()}),this.files=null}})}var u=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return c.prototype=o.instance,c}),i(x,[l,d,p,s,b,g,h,c],function(e,t,n,i,o,r,a,s){function l(n){var a,l=this;"string"==typeof n&&(n={drop_zone:n}),a={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},n="object"==typeof n?i.extend({},a,n):a,n.container=t.get(n.drop_zone)||document.body,"static"===t.getStyle(n.container,"position")&&(n.container.style.position="relative"),"string"==typeof n.accept&&(n.accept=s.mimes2extList(n.accept)),r.call(l),i.extend(l,{uid:i.guid("uid_"),ruid:null,files:null,init:function(){l.convertEventPropsToHandlers(c),l.bind("RuntimeInit",function(e,t){l.ruid=t.uid,l.bind("Drop",function(){var e=t.exec.call(l,"FileDrop","getFiles");l.files=[],i.each(e,function(e){l.files.push(new o(l.ruid,e))})},999),t.exec.call(l,"FileDrop","init",n),l.dispatchEvent("ready")}),l.connectRuntime(n)},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var c=["ready","dragenter","dragleave","drop","error"];return l.prototype=a.instance,l}),i(y,[s,g,h],function(e,t,n){function i(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return i.prototype=n.instance,i}),i(w,[s,f,p,h,v,b,y],function(e,t,n,i,o,r,a){function s(){function i(e,i){function u(e){c.readyState=s.DONE,c.error=e,c.trigger("error"),d()}function d(){r.destroy(),r=null,c.trigger("loadend")}function p(t){r.bind("Error",function(e,t){u(t)}),r.bind("Progress",function(e){c.result=t.exec.call(r,"FileReader","getResult"),c.trigger(e)}),r.bind("Load",function(e){c.readyState=s.DONE,c.result=t.exec.call(r,"FileReader","getResult"),c.trigger(e),d()}),t.exec.call(r,"FileReader","read",e,i)}if(r=new a,this.convertEventPropsToHandlers(l),this.readyState===s.LOADING)return u(new n.DOMException(n.DOMException.INVALID_STATE_ERR));if(this.readyState=s.LOADING,this.trigger("loadstart"),i instanceof o)if(i.isDetached()){var h=i.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=h;break;case"readAsDataURL":this.result="data:"+i.type+";base64,"+t.btoa(h)}this.readyState=s.DONE,this.trigger("load"),d()}else p(r.connectRuntime(i.ruid));else u(new n.DOMException(n.DOMException.NOT_FOUND_ERR))}var r,c=this;e.extend(this,{uid:e.guid("uid_"),readyState:s.EMPTY,result:null,error:null,readAsBinaryString:function(e){i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){i.call(this,"readAsDataURL",e)},readAsText:function(e){i.call(this,"readAsText",e)},abort:function(){this.result=null,-1===e.inArray(this.readyState,[s.EMPTY,s.DONE])&&(this.readyState===s.LOADING&&(this.readyState=s.DONE),r&&r.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),r&&(r.getRuntime().exec.call(this,"FileReader","destroy"),r.disconnectRuntime()),c=r=null}})}var l=["loadstart","progress","load","abort","error","loadend"];return s.EMPTY=0,s.LOADING=1,s.DONE=2,s.prototype=i.instance,s}),i(E,[],function(){var e=function(t,n){for(var i=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],o=i.length,r={http:80,https:443},a={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,l=s.exec(t||"");o--;)l[o]&&(a[i[o]]=l[o]);if(!a.scheme){n&&"string"!=typeof n||(n=e(n||document.location.href)),a.scheme=n.scheme,a.host=n.host,a.port=n.port;var c="";/^[^\/]/.test(a.path)&&(c=n.path,/(\/|\/[^\.]+)$/.test(c)?c+="/":c=c.replace(/\/[^\/]+$/,"/")),a.path=c+(a.path||"")}return a.port||(a.port=r[a.scheme]||80),a.port=parseInt(a.port,10),a.path||(a.path="/"),delete a.source,a},t=function(t){var n={http:80,https:443},i=e(t);return i.scheme+"://"+i.host+(i.port!==n[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},n=function(t){function n(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof t&&(t=e(t)),n(e())===n(t)};return{parseUrl:e,resolveUrl:t,hasSameOrigin:n}}),i(k,[s,g,f],function(e,t,n){return function(){function i(e,t){if(!t.isDetached()){var i=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),i}var o=t.getSource();switch(e){case"readAsBinaryString":return o;case"readAsDataURL":return"data:"+t.type+";base64,"+n.btoa(o);case"readAsText":for(var r="",a=0,s=o.length;s>a;a++)r+=String.fromCharCode(o[a]);return r}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(e){return i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return i.call(this,"readAsDataURL",e)},readAsText:function(e){return i.call(this,"readAsText",e)}})}}),i($,[p,s,v],function(e,t,n){function i(){var e,i=[];t.extend(this,{append:function(o,r){var a=this,s=t.typeOf(r);r instanceof n?e={name:o,value:r}:"array"===s?(o+="[]",t.each(r,function(e){a.append(o,e)})):"object"===s?t.each(r,function(e,t){a.append(o+"["+t+"]",e)}):"null"===s||"undefined"===s||"number"===s&&isNaN(r)?a.append(o,"false"):i.push({name:o,value:r.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(n){t.each(i,function(e){n(e.value,e.name)}),e&&n(e.value,e.name)},destroy:function(){e=null,i=[]}})}return i}),i(R,[s,p,h,f,E,m,y,v,k,$,u,c],function(e,t,n,i,o,r,a,s,l,c,u,d){function p(){this.uid=e.guid("uid_")}function h(){function n(e,t){return R.hasOwnProperty(e)?1===arguments.length?u.can("define_property")?R[e]:$[e]:void(u.can("define_property")?R[e]=t:$[e]=t):void 0}function l(t){function i(){E.destroy(),E=null,s.dispatchEvent("loadend"),s=null}function o(o){E.bind("LoadStart",function(e){n("readyState",h.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(e),O&&s.upload.dispatchEvent(e)}),E.bind("Progress",function(e){n("readyState")!==h.LOADING&&(n("readyState",h.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(e)}),E.bind("UploadProgress",function(e){O&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),E.bind("Load",function(t){n("readyState",h.DONE),n("status",Number(o.exec.call(E,"XMLHttpRequest","getStatus")||0)),n("statusText",f[n("status")]||""),n("response",o.exec.call(E,"XMLHttpRequest","getResponse",n("responseType"))),~e.inArray(n("responseType"),["text",""])?n("responseText",n("response")):"document"===n("responseType")&&n("responseXML",n("response")),F=o.exec.call(E,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),n("status")>0?(O&&s.upload.dispatchEvent(t),s.dispatchEvent(t)):(D=!0,s.dispatchEvent("error")),i()}),E.bind("Abort",function(e){s.dispatchEvent(e),i()}),E.bind("Error",function(e){D=!0,n("readyState",h.DONE),s.dispatchEvent("readystatechange"),L=!0,s.dispatchEvent(e),i()}),o.exec.call(E,"XMLHttpRequest","send",{url:v,method:b,async:T,user:_,password:x,headers:C,mimeType:q,encoding:S,responseType:s.responseType,withCredentials:s.withCredentials,options:B},t)}var s=this;y=(new Date).getTime(),E=new a,"string"==typeof B.required_caps&&(B.required_caps=r.parseCaps(B.required_caps)),B.required_caps=e.extend({},B.required_caps,{return_response_type:s.responseType}),t instanceof c&&(B.required_caps.send_multipart=!0),j||(B.required_caps.do_cors=!0),B.ruid?o(E.connectRuntime(B)):(E.bind("RuntimeInit",function(e,t){o(t)}),E.bind("RuntimeError",function(e,t){s.dispatchEvent("RuntimeError",t)}),E.connectRuntime(B))}function g(){n("responseText",""),n("responseXML",null),n("response",null),n("status",0),n("statusText",""),y=w=null}var v,b,_,x,y,w,E,k,$=this,R={timeout:0,readyState:h.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},T=!0,C={},S=null,q=null,I=!1,A=!1,O=!1,L=!1,D=!1,j=!1,N=null,P=null,B={},F="";e.extend(this,R,{uid:e.guid("uid_"),upload:new p,open:function(r,a,s,l,c){var u;if(!r||!a)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(r)||i.utf8_encode(r)!==r)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(~e.inArray(r.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(b=r.toUpperCase()),~e.inArray(b,["CONNECT","TRACE","TRACK"]))throw new t.DOMException(t.DOMException.SECURITY_ERR);if(a=i.utf8_encode(a),u=o.parseUrl(a),j=o.hasSameOrigin(u),v=o.resolveUrl(a),(l||c)&&!j)throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);if(_=l||u.user,x=c||u.pass,T=s||!0,T===!1&&(n("timeout")||n("withCredentials")||""!==n("responseType")))throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);I=!T,A=!1,C={},g.call(this),n("readyState",h.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(o,r){var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(n("readyState")!==h.OPENED||A)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(o)||i.utf8_encode(o)!==o)throw new t.DOMException(t.DOMException.SYNTAX_ERR);return o=e.trim(o).toLowerCase(),!~e.inArray(o,a)&&!/^(proxy\-|sec\-)/.test(o)&&(C[o]?C[o]+=", "+r:C[o]=r,!0)},getAllResponseHeaders:function(){return F||""},getResponseHeader:function(t){return t=t.toLowerCase(),D||~e.inArray(t,["set-cookie","set-cookie2"])?null:F&&""!==F&&(k||(k={},e.each(F.split(/\r\n/),function(t){var n=t.split(/:\s+/);2===n.length&&(n[0]=e.trim(n[0]),k[n[0].toLowerCase()]={header:n[0],value:e.trim(n[1])})})),k.hasOwnProperty(t))?k[t].header+": "+k[t].value:null},overrideMimeType:function(i){var o,r;if(~e.inArray(n("readyState"),[h.LOADING,h.DONE]))throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(i=e.trim(i.toLowerCase()),/;/.test(i)&&(o=i.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(i=o[1],o[2]&&(r=o[2])),!d.mimes[i])throw new t.DOMException(t.DOMException.SYNTAX_ERR);N=i,P=r},send:function(n,o){
if(B="string"===e.typeOf(o)?{ruid:o}:o?o:{},this.convertEventPropsToHandlers(m),this.upload.convertEventPropsToHandlers(m),this.readyState!==h.OPENED||A)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(n instanceof s)B.ruid=n.ruid,q=n.type||"application/octet-stream";else if(n instanceof c){if(n.hasBlob()){var r=n.getBlob();B.ruid=r.ruid,q=r.type||"application/octet-stream"}}else"string"==typeof n&&(S="UTF-8",q="text/plain;charset=UTF-8",n=i.utf8_encode(n));this.withCredentials||(this.withCredentials=B.required_caps&&B.required_caps.send_browser_cookies&&!j),O=!I&&this.upload.hasEventListener(),D=!1,L=!n,I||(A=!0),l.call(this,n)},abort:function(){if(D=!0,I=!1,~e.inArray(n("readyState"),[h.UNSENT,h.OPENED,h.DONE]))n("readyState",h.UNSENT);else{if(n("readyState",h.DONE),A=!1,!E)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);E.getRuntime().exec.call(E,"XMLHttpRequest","abort",L),L=!0}},destroy:function(){E&&("function"===e.typeOf(E.destroy)&&E.destroy(),E=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var f={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};p.prototype=n.instance;var m=["loadstart","progress","abort","error","load","timeout","loadend"];return h.UNSENT=0,h.OPENED=1,h.HEADERS_RECEIVED=2,h.LOADING=3,h.DONE=4,h.prototype=n.instance,h}),i(T,[s,f,g,h],function(e,t,n,i){function o(){function i(){u=d=0,c=this.result=null}function r(t,n){var i=this;l=n,i.bind("TransportingProgress",function(t){d=t.loaded,u>d&&-1===e.inArray(i.state,[o.IDLE,o.DONE])&&a.call(i)},999),i.bind("TransportingComplete",function(){d=u,i.state=o.DONE,c=null,i.result=l.exec.call(i,"Transporter","getAsBlob",t||"")},999),i.state=o.BUSY,i.trigger("TransportingStarted"),a.call(i)}function a(){var e,n=this,i=u-d;p>i&&(p=i),e=t.btoa(c.substr(d,p)),l.exec.call(n,"Transporter","receive",e,u)}var s,l,c,u,d,p;n.call(this),e.extend(this,{uid:e.guid("uid_"),state:o.IDLE,result:null,transport:function(t,n,o){var a=this;if(o=e.extend({chunk_size:204798},o),(s=o.chunk_size%3)&&(o.chunk_size+=3-s),p=o.chunk_size,i.call(this),c=t,u=t.length,"string"===e.typeOf(o)||o.ruid)r.call(a,n,this.connectRuntime(o));else{var l=function(e,t){a.unbind("RuntimeInit",l),r.call(a,n,t)};this.bind("RuntimeInit",l),this.connectRuntime(o)}},abort:function(){var e=this;e.state=o.IDLE,l&&(l.exec.call(e,"Transporter","clear"),e.trigger("TransportingAborted")),i.call(e)},destroy:function(){this.unbindAll(),l=null,this.disconnectRuntime(),i.call(this)}})}return o.IDLE=0,o.BUSY=1,o.DONE=2,o.prototype=i.instance,o}),i(C,[s,d,p,k,R,m,g,T,u,h,v,b,f],function(e,t,n,i,o,r,a,s,l,c,u,d,p){function h(){function i(e){e||(e=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name)}function c(t){var i=e.typeOf(t);try{if(t instanceof h){if(!t.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);m.apply(this,arguments)}else if(t instanceof u){if(!~e.inArray(t.type,["image/jpeg","image/png"]))throw new n.ImageError(n.ImageError.WRONG_FORMAT);g.apply(this,arguments)}else if(-1!==e.inArray(i,["blob","file"]))c.call(this,new d(null,t),arguments[1]);else if("string"===i)/^data:[^;]*;base64,/.test(t)?c.call(this,new u(null,{data:t}),arguments[1]):v.apply(this,arguments);else{if("node"!==i||"img"!==t.nodeName.toLowerCase())throw new n.DOMException(n.DOMException.TYPE_MISMATCH_ERR);c.call(this,t.src,arguments[1])}}catch(o){this.trigger("error",o)}}function m(t,n){var i=this.connectRuntime(t.ruid);this.ruid=i.uid,i.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(n)||n)}function g(t,n){function i(e){o.ruid=e.uid,e.exec.call(o,"Image","loadFromBlob",t)}var o=this;o.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){i(t)}),n&&"string"==typeof n.required_caps&&(n.required_caps=r.parseCaps(n.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},n))):i(this.connectRuntime(t.ruid))}function v(e,t){var n,i=this;n=new o,n.open("get",e),n.responseType="blob",n.onprogress=function(e){i.trigger(e)},n.onload=function(){g.call(i,n.response,!0)},n.onerror=function(e){i.trigger(e)},n.onloadend=function(){n.destroy()},n.bind("RuntimeError",function(e,t){i.trigger("RuntimeError",t)}),n.send(null,t)}a.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){i.call(this)},999),this.convertEventPropsToHandlers(f),c.apply(this,arguments)},downsize:function(t,i,o,r){try{if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);(!t&&!i||"undefined"===e.typeOf(o))&&(o=!1),t=t||this.width,i=i||this.height,r="undefined"===e.typeOf(r)||!!r,this.getRuntime().exec.call(this,"Image","downsize",t,i,o,r)}catch(a){this.trigger("error",a)}},crop:function(e,t,n){this.downsize(e,t,!0,n)},getAsCanvas:function(){if(!l.can("create_canvas"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);var e=this.connectRuntime(this.ruid);return e.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return e||(e="image/jpeg"),"image/jpeg"!==e||t||(t=90),this.getRuntime().exec.call(this,"Image","getAsBlob",e,t)},getAsDataURL:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",e,t)},getAsBinaryString:function(e,t){var n=this.getAsDataURL(e,t);return p.atob(n.substring(n.indexOf("base64,")+7))},embed:function(i){function o(){if(l.can("create_canvas")){var t=r.getAsCanvas();if(t)return i.appendChild(t),t=null,r.destroy(),void f.trigger("embedded")}var o=r.getAsDataURL(a,c);if(!o)throw new n.ImageError(n.ImageError.WRONG_FORMAT);if(l.can("use_data_uri_of",o.length))i.innerHTML='<img src="'+o+'" width="'+r.width+'" height="'+r.height+'" />',r.destroy(),f.trigger("embedded");else{var u=new s;u.bind("TransportingComplete",function(){d=f.connectRuntime(this.result.ruid),f.bind("Embedded",function(){e.extend(d.getShimContainer().style,{top:"0px",left:"0px",width:r.width+"px",height:r.height+"px"}),d=null},999),d.exec.call(f,"ImageView","display",this.result.uid,g,v),r.destroy()}),u.transport(p.atob(o.substring(o.indexOf("base64,")+7)),a,e.extend({},m,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:i}))}}var r,a,c,u,d,f=this,m=arguments[1]||{},g=this.width,v=this.height;try{if(!(i=t.get(i)))throw new n.DOMException(n.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);if(a=m.type||this.type||"image/jpeg",c=m.quality||90,u="undefined"!==e.typeOf(m.crop)&&m.crop,m.width)g=m.width,v=m.height||g;else{var b=t.getSize(i);b.w&&b.h&&(g=b.w,v=b.h)}return r=new h,r.bind("Resize",function(){o.call(f)}),r.bind("Load",function(){r.downsize(g,v,u,!1)}),r.clone(this,!1),r}catch(_){this.trigger("error",_)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var f=["progress","load","error","resize","embedded"];return h.MAX_RESIZE_WIDTH=6500,h.MAX_RESIZE_HEIGHT=6500,h.prototype=c.instance,h}),i(S,[s,p,m,u],function(e,t,n,i){function o(t){var o=this,s=n.capTest,l=n.capTrue,c=e.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return o.can("access_binary")&&!!a.Image},display_media:s(i.can("create_canvas")||i.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==i.browser||i.version>9)}()),filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),return_response_headers:l,return_response_type:function(e){return!("json"!==e||!window.JSON)||i.can("return_response_type",e)},return_status_code:l,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return o.can("access_binary")&&i.can("create_canvas")},select_file:function(){return i.can("use_fileinput")&&window.File},select_folder:function(){return o.can("select_file")&&"Chrome"===i.browser&&i.version>=21},select_multiple:function(){return!(!o.can("select_file")||"Safari"===i.browser&&"Windows"===i.os||"iOS"===i.os&&i.verComp(i.osVersion,"7.0.4","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||o.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return o.can("slice_blob")&&o.can("send_multipart")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||"IE"===i.browser&&i.version>=10||!!~e.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:l},arguments[2]);n.call(this,t,arguments[1]||r,c),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(o),e=o=null}}(this.destroy)}),e.extend(this.getShim(),a)}var r="html5",a={};return n.addConstructor(r,o),a}),i(q,[S,v],function(e,t){function n(){function e(e,t,n){var i;if(!window.File.prototype.slice)return(i=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?i.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(o){return e.slice(t,n-t)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))}}return e.Blob=n}),i(I,[s],function(e){function t(){this.returnValue=!1}function n(){this.cancelBubble=!0}var i={},o="moxie_"+e.guid(),r=function(r,a,s,l){var c,u;a=a.toLowerCase(),r.addEventListener?(c=s,r.addEventListener(a,c,!1)):r.attachEvent&&(c=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=t,e.stopPropagation=n,s(e)},r.attachEvent("on"+a,c)),r[o]||(r[o]=e.guid()),i.hasOwnProperty(r[o])||(i[r[o]]={}),u=i[r[o]],u.hasOwnProperty(a)||(u[a]=[]),u[a].push({func:c,orig:s,key:l})},a=function(t,n,r){var a,s;if(n=n.toLowerCase(),t[o]&&i[t[o]]&&i[t[o]][n]){a=i[t[o]][n];for(var l=a.length-1;l>=0&&(a[l].orig!==r&&a[l].key!==r||(t.removeEventListener?t.removeEventListener(n,a[l].func,!1):t.detachEvent&&t.detachEvent("on"+n,a[l].func),a[l].orig=null,a[l].func=null,a.splice(l,1),r===s));l--);if(a.length||delete i[t[o]][n],e.isEmptyObj(i[t[o]])){delete i[t[o]];try{delete t[o]}catch(c){t[o]=s}}}},s=function(t,n){t&&t[o]&&e.each(i[t[o]],function(e,i){a(t,i,n)})};return{addEvent:r,removeEvent:a,removeAllEvents:s}}),i(A,[S,s,d,I,c,u],function(e,t,n,i,o,r){function a(){var e,a=[];t.extend(this,{init:function(s){var l,c,u,d,p,h,f=this,m=f.getRuntime();e=s,a=[],u=e.accept.mimes||o.extList2mimes(e.accept,m.can("filter_by_extension")),c=m.getShimContainer(),c.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&m.can("select_multiple")?"multiple":"")+(e.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(u?' accept="'+u.join(",")+'"':"")+" />",l=n.get(m.uid),t.extend(l.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),d=n.get(e.browse_button),m.can("summon_file_dialog")&&("static"===n.getStyle(d,"position")&&(d.style.position="relative"),p=parseInt(n.getStyle(d,"z-index"),10)||1,d.style.zIndex=p,c.style.zIndex=p-1,i.addEvent(d,"click",function(e){var t=n.get(m.uid);t&&!t.disabled&&t.click(),e.preventDefault()},f.uid)),h=m.can("summon_file_dialog")?d:c,i.addEvent(h,"mouseover",function(){f.trigger("mouseenter")},f.uid),i.addEvent(h,"mouseout",function(){f.trigger("mouseleave")},f.uid),i.addEvent(h,"mousedown",function(){f.trigger("mousedown")},f.uid),i.addEvent(n.get(e.container),"mouseup",function(){f.trigger("mouseup")},f.uid),l.onchange=function g(){if(a=[],e.directory?t.each(this.files,function(e){"."!==e.name&&a.push(e)}):a=[].slice.call(this.files),"IE"!==r.browser)this.value="";else{var n=this.cloneNode(!0);this.parentNode.replaceChild(n,this),n.onchange=g}f.trigger("change")},f.trigger({type:"ready",async:!0}),c=null},getFiles:function(){return a},disable:function(e){var t,i=this.getRuntime();(t=n.get(i.uid))&&(t.disabled=!!e)},destroy:function(){var t=this.getRuntime(),o=t.getShim(),r=t.getShimContainer();i.removeAllEvents(r,this.uid),i.removeAllEvents(e&&n.get(e.container),this.uid),i.removeAllEvents(e&&n.get(e.browse_button),this.uid),r&&(r.innerHTML=""),o.removeInstance(this.uid),a=e=r=o=null}})}return e.FileInput=a}),i(O,[S,s,d,I,c],function(e,t,n,i,o){function r(){function e(e){for(var n=[],i=0;i<e.length;i++)[].push.apply(n,e[i].extensions.split(/\s*,\s*/));return-1===t.inArray("*",n)?n:[]}function r(e){var n=o.getFileExtension(e.name);return!n||!p.length||-1!==t.inArray(n,p)}function a(e,n){var i=[];t.each(e,function(e){var t=e.webkitGetAsEntry();if(t)if(t.isFile){var n=e.getAsFile();r(n)&&d.push(n)}else i.push(t)}),i.length?s(i,n):n()}function s(e,n){var i=[];t.each(e,function(e){i.push(function(t){l(e,t)})}),t.inSeries(i,function(){n()})}function l(e,t){e.isFile?e.file(function(e){r(e)&&d.push(e),t()},function(){t()}):e.isDirectory?c(e,t):t()}function c(e,t){function n(e){o.readEntries(function(t){t.length?([].push.apply(i,t),n(e)):e()},e)}var i=[],o=e.createReader();n(function(){s(i,t)})}var u,d=[],p=[];t.extend(this,{init:function(n){var o,s=this;u=n,p=e(u.accept),o=u.container,i.addEvent(o,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},s.uid),i.addEvent(o,"drop",function(e){e.preventDefault(),e.stopPropagation(),d=[],e.dataTransfer.items&&e.dataTransfer.items[0].webkitGetAsEntry?a(e.dataTransfer.items,function(){s.trigger("drop")}):(t.each(e.dataTransfer.files,function(e){r(e)&&d.push(e)}),s.trigger("drop"))},s.uid),i.addEvent(o,"dragenter",function(e){e.preventDefault(),e.stopPropagation(),s.trigger("dragenter")},s.uid),i.addEvent(o,"dragleave",function(e){e.preventDefault(),e.stopPropagation(),s.trigger("dragleave")},s.uid)},getFiles:function(){return d},destroy:function(){i.removeAllEvents(u&&n.get(u.container),this.uid),d=p=u=null}})}return e.FileDrop=r}),i(L,[S,f,s],function(e,t,n){function i(){function e(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var i,o=!1;n.extend(this,{read:function(e,t){var r=this;i=new window.FileReader,i.addEventListener("progress",function(e){r.trigger(e)}),i.addEventListener("load",function(e){r.trigger(e)}),i.addEventListener("error",function(e){r.trigger(e,i.error)}),i.addEventListener("loadend",function(){i=null}),"function"===n.typeOf(i[e])?(o=!1,i[e](t.getSource())):"readAsBinaryString"===e&&(o=!0,i.readAsDataURL(t.getSource()))},getResult:function(){return i&&i.result?o?e(i.result):i.result:null},abort:function(){i&&i.abort()},destroy:function(){i=null}})}return e.FileReader=i}),i(D,[S,s,c,E,b,v,$,p,u],function(e,t,n,i,o,r,a,s,l){function c(){function e(e,t){var n,i,o=this;n=t.getBlob().getSource(),i=new window.FileReader,i.onload=function(){t.append(t.getBlobName(),new r(null,{type:n.type,data:i.result})),f.send.call(o,e,t)},i.readAsBinaryString(n)}function c(){return!window.XMLHttpRequest||"IE"===l.browser&&l.version<8?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(n){}}():new window.XMLHttpRequest}function u(e){var t=e.responseXML,n=e.responseText;return"IE"===l.browser&&n&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(n)),t&&("IE"===l.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t}function d(e){var t="----moxieboundary"+(new Date).getTime(),n="--",i="\r\n",o="",a=this.getRuntime();if(!a.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return p.setRequestHeader("Content-Type","multipart/form-data; boundary="+t),e.each(function(e,a){o+=e instanceof r?n+t+i+'Content-Disposition: form-data; name="'+a+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+i+"Content-Type: "+(e.type||"application/octet-stream")+i+i+e.getSource()+i:n+t+i+'Content-Disposition: form-data; name="'+a+'"'+i+i+unescape(encodeURIComponent(e))+i}),o+=n+t+n+i}var p,h,f=this;t.extend(this,{send:function(n,o){var s=this,u="Mozilla"===l.browser&&l.version>=4&&l.version<7,f="Android Browser"===l.browser,m=!1;if(h=n.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),p=c(),p.open(n.method,n.url,n.async,n.user,n.password),o instanceof r)o.isDetached()&&(m=!0),o=o.getSource();else if(o instanceof a){if(o.hasBlob())if(o.getBlob().isDetached())o=d.call(s,o),m=!0;else if((u||f)&&"blob"===t.typeOf(o.getBlob().getSource())&&window.FileReader)return void e.call(s,n,o);if(o instanceof a){var g=new window.FormData;o.each(function(e,t){e instanceof r?g.append(t,e.getSource()):g.append(t,e)}),o=g}}p.upload?(n.withCredentials&&(p.withCredentials=!0),p.addEventListener("load",function(e){s.trigger(e)}),p.addEventListener("error",function(e){s.trigger(e)}),p.addEventListener("progress",function(e){s.trigger(e)}),p.upload.addEventListener("progress",function(e){s.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):p.onreadystatechange=function(){switch(p.readyState){case 1:break;case 2:break;case 3:var e,t;try{i.hasSameOrigin(n.url)&&(e=p.getResponseHeader("Content-Length")||0),p.responseText&&(t=p.responseText.length)}catch(o){e=t=0}s.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:p.onreadystatechange=function(){},0===p.status?s.trigger("error"):s.trigger("load")}},t.isEmptyObj(n.headers)||t.each(n.headers,function(e,t){p.setRequestHeader(t,e)}),""!==n.responseType&&"responseType"in p&&(p.responseType="json"!==n.responseType||l.can("return_response_type","json")?n.responseType:"text"),m?p.sendAsBinary?p.sendAsBinary(o):function(){for(var e=new Uint8Array(o.length),t=0;t<o.length;t++)e[t]=255&o.charCodeAt(t);p.send(e.buffer)}():p.send(o),s.trigger("loadstart")},getStatus:function(){try{if(p)return p.status}catch(e){}return 0},getResponse:function(e){var t=this.getRuntime();try{switch(e){case"blob":var i=new o(t.uid,p.response),r=p.getResponseHeader("Content-Disposition");if(r){var a=r.match(/filename=([\'\"'])([^\1]+)\1/);a&&(h=a[2])}return i.name=h,i.type||(i.type=n.getFileMime(h)),i;case"json":return l.can("return_response_type","json")?p.response:200===p.status&&window.JSON?JSON.parse(p.responseText):null;case"document":return u(p);default:return""!==p.responseText?p.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return p.getAllResponseHeaders()}catch(e){}return""},abort:function(){p&&p.abort()},destroy:function(){f=h=null}})}return e.XMLHttpRequest=c}),i(j,[],function(){return function(){function e(e,t){var n,i=r?0:-8*(t-1),a=0;for(n=0;t>n;n++)a|=o.charCodeAt(e+n)<<Math.abs(i+8*n);return a}function n(e,t,n){n=3===arguments.length?n:o.length-t-1,o=o.substr(0,t)+e+o.substr(n+t)}function i(e,t,i){var o,a="",s=r?0:-8*(i-1);for(o=0;i>o;o++)a+=String.fromCharCode(255&t>>Math.abs(s+8*o));n(a,e,i)}var o,r=!1;return{II:function(e){return e===t?r:void(r=e)},init:function(e){r=!1,o=e},SEGMENT:function(e,t,i){switch(arguments.length){case 1:return o.substr(e,o.length-e-1);case 2:return o.substr(e,t);case 3:n(i,e,t);break;default:return o}},BYTE:function(t){return e(t,1)},SHORT:function(t){return e(t,2)},LONG:function(n,o){return o===t?e(n,4):void i(n,o,4)},SLONG:function(t){var n=e(t,4);return n>2147483647?n-4294967296:n},STRING:function(t,n){var i="";for(n+=t;n>t;t++)i+=String.fromCharCode(e(t,1));return i}}}}),i(N,[j],function(e){return function t(n){var i,o,r,a=[],s=0;if(i=new e,i.init(n),65496===i.SHORT(0)){for(o=2;o<=n.length;)if(r=i.SHORT(o),r>=65488&&65495>=r)o+=2;else{if(65498===r||65497===r)break;s=i.SHORT(o+2)+2,r>=65505&&65519>=r&&a.push({hex:r,name:"APP"+(15&r),start:o,length:s,segment:i.SEGMENT(o,s)}),o+=s}return i.init(null),{headers:a,restore:function(e){var t,n;for(i.init(e),o=65504==i.SHORT(2)?4+i.SHORT(4):2,n=0,t=a.length;t>n;n++)i.SEGMENT(o,0,a[n].segment),o+=a[n].length;return e=i.SEGMENT(),i.init(null),e},strip:function(e){var n,o,r;for(o=new t(e),n=o.headers,o.purge(),i.init(e),r=n.length;r--;)i.SEGMENT(n[r].start,n[r].length,"");return e=i.SEGMENT(),i.init(null),e},get:function(e){for(var t=[],n=0,i=a.length;i>n;n++)a[n].name===e.toUpperCase()&&t.push(a[n].segment);return t},set:function(e,t){var n,i,o,r=[];for("string"==typeof t?r.push(t):r=t,n=i=0,o=a.length;o>n&&(a[n].name===e.toUpperCase()&&(a[n].segment=r[i],a[n].length=r[i].length,i++),!(i>=r.length));n++);},purge:function(){a=[],i.init(null),i=null}}}}}),i(P,[s,j],function(e,n){return function i(){function i(e,n){var i,o,r,s,l,d,p,h,f=a.SHORT(e),m=[],g={};for(i=0;f>i;i++)if(p=d=e+12*i+2,r=n[a.SHORT(p)],r!==t){switch(s=a.SHORT(p+=2),l=a.LONG(p+=2),p+=4,m=[],s){case 1:case 7:for(l>4&&(p=a.LONG(p)+u.tiffHeader),o=0;l>o;o++)m[o]=a.BYTE(p+o);break;case 2:l>4&&(p=a.LONG(p)+u.tiffHeader),g[r]=a.STRING(p,l-1);continue;case 3:for(l>2&&(p=a.LONG(p)+u.tiffHeader),o=0;l>o;o++)m[o]=a.SHORT(p+2*o);break;case 4:for(l>1&&(p=a.LONG(p)+u.tiffHeader),o=0;l>o;o++)m[o]=a.LONG(p+4*o);break;case 5:for(p=a.LONG(p)+u.tiffHeader,o=0;l>o;o++)m[o]=a.LONG(p+4*o)/a.LONG(p+4*o+4);break;case 9:for(p=a.LONG(p)+u.tiffHeader,o=0;l>o;o++)m[o]=a.SLONG(p+4*o);break;case 10:for(p=a.LONG(p)+u.tiffHeader,o=0;l>o;o++)m[o]=a.SLONG(p+4*o)/a.SLONG(p+4*o+4);break;default:continue}h=1==l?m[0]:m,g[r]=c.hasOwnProperty(r)&&"object"!=typeof h?c[r][h]:h}return g}function o(){var e=u.tiffHeader;return a.II(18761==a.SHORT(e)),42===a.SHORT(e+=2)&&(u.IFD0=u.tiffHeader+a.LONG(e+=2),l=i(u.IFD0,s.tiff),"ExifIFDPointer"in l&&(u.exifIFD=u.tiffHeader+l.ExifIFDPointer,delete l.ExifIFDPointer),"GPSInfoIFDPointer"in l&&(u.gpsIFD=u.tiffHeader+l.GPSInfoIFDPointer,delete l.GPSInfoIFDPointer),!0)}function r(e,t,n){var i,o,r,l=0;if("string"==typeof t){var c=s[e.toLowerCase()];for(var d in c)if(c[d]===t){t=d;break}}i=u[e.toLowerCase()+"IFD"],o=a.SHORT(i);for(var p=0;o>p;p++)if(r=i+12*p+2,a.SHORT(r)==t){l=r+8;break}return!!l&&(a.LONG(l,n),!0)}var a,s,l,c,u={};return a=new n,s={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(e){return u={tiffHeader:10},!(e===t||!e.length)&&(a.init(e),65505===a.SHORT(0)&&"EXIF\0"===a.STRING(4,5).toUpperCase()&&o())},TIFF:function(){return l},EXIF:function(){var t;if(t=i(u.exifIFD,s.exif),t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var n=0,o="";n<t.ExifVersion.length;n++)o+=String.fromCharCode(t.ExifVersion[n]);t.ExifVersion=o}return t},GPS:function(){var t;return t=i(u.gpsIFD,s.gps),t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join(".")),t},setExif:function(e,t){return("PixelXDimension"===e||"PixelYDimension"===e)&&r("exif",e,t)},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null),a=l=null,u={}}}}}),i(B,[s,p,N,j,P],function(e,t,n,i,o){function r(r){function a(){for(var e,t,n=0;n<=l.length;){if(e=c.SHORT(n+=2),e>=65472&&65475>=e)return n+=5,{height:c.SHORT(n),width:c.SHORT(n+=2)};t=c.SHORT(n+=2),n+=t-2}return null}function s(){d&&u&&c&&(d.purge(),u.purge(),c.init(null),l=p=u=d=c=null)}var l,c,u,d,p,h;if(l=r,c=new i,c.init(l),65496!==c.SHORT(0))throw new t.ImageError(t.ImageError.WRONG_FORMAT);u=new n(r),d=new o,h=!!d.init(u.get("app1")[0]),p=a.call(this),e.extend(this,{type:"image/jpeg",size:l.length,width:p&&p.width||0,height:p&&p.height||0,setExif:function(t,n){return!!h&&("object"===e.typeOf(t)?e.each(t,function(e,t){d.setExif(t,e)}):d.setExif(t,n),void u.set("app1",d.getBinary()))},writeHeaders:function(){return arguments.length?u.restore(arguments[0]):l=u.restore(l)},stripHeaders:function(e){return u.strip(e)},purge:function(){s.call(this)}}),h&&(this.meta={tiff:d.TIFF(),exif:d.EXIF(),gps:d.GPS()})}return r}),i(F,[p,s,j],function(e,t,n){function i(i){function o(){var e,t;return e=a.call(this,8),"IHDR"http://common1.qyerstatic.com/place/js/poi/==e.type?(t=e.start,{width:l.LONG(t),height:l.LONG(t+=4)}):null}function r(){l&&(l.init(null),s=d=c=u=l=null)}function a(e){var t,n,i,o;return t=l.LONG(e),n=l.STRING(e+=4,4),i=e+=4,o=l.LONG(e+t),{length:t,type:n,start:i,CRC:o}}var s,l,c,u,d;s=i,l=new n,l.init(s),function(){var t=0,n=0,i=[35152,20039,3338,6666];for(n=0;n<i.length;n++,t+=2)if(i[n]!=l.SHORT(t))throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),d=o.call(this),t.extend(this,{type:"image/png",size:s.length,width:d.width,height:d.height,purge:function(){r.call(this)}}),r.call(this)}return i}),i(U,[s,p,B,F],function(e,t,n,i){return function(o){var r,a=[n,i];r=function(){for(var e=0;e<a.length;e++)try{return new a[e](o)}catch(n){}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},stripHeaders:function(e){return e},purge:function(){}}),e.extend(this,r),this.purge=function(){r.purge(),r=null}}}),i(M,[],function(){function e(e,i,o){var r=e.naturalWidth,a=e.naturalHeight,s=o.width,l=o.height,c=o.x||0,u=o.y||0,d=i.getContext("2d");t(e)&&(r/=2,a/=2);var p=1024,h=document.createElement("canvas");h.width=h.height=p;for(var f=h.getContext("2d"),m=n(e,r,a),g=0;a>g;){for(var v=g+p>a?a-g:p,b=0;r>b;){var _=b+p>r?r-b:p;f.clearRect(0,0,p,p),f.drawImage(e,-b,-g);var x=b*s/r+c<<0,y=Math.ceil(_*s/r),w=g*l/a/m+u<<0,E=Math.ceil(v*l/a/m);d.drawImage(h,0,0,_,v,x,w,y,E),b+=p}g+=p}h=f=null}function t(e){var t=e.naturalWidth,n=e.naturalHeight;if(t*n>1048576){var i=document.createElement("canvas");i.width=i.height=1;var o=i.getContext("2d");return o.drawImage(e,-t+1,0),0===o.getImageData(0,0,1,1).data[3]}return!1}function n(e,t,n){var i=document.createElement("canvas");i.width=1,i.height=n;var o=i.getContext("2d");o.drawImage(e,0,0);for(var r=o.getImageData(0,0,1,n).data,a=0,s=n,l=n;l>a;){var c=r[4*(l-1)+3];0===c?s=l:a=l,l=s+a>>1}i=null;var u=l/n;return 0===u?1:u}return{isSubsampled:t,renderTo:e}}),i(z,[S,s,p,f,b,U,M,c,u],function(e,t,n,i,o,r,a,s,l){function c(){function e(){if(!_&&!v)throw new n.ImageError(n.DOMException.INVALID_STATE_ERR);return _||v}function c(e){return i.atob(e.substring(e.indexOf("base64,")+7))}function u(e,t){return"data:"+(t||"")+";base64,"+i.btoa(e)}function d(e){var t=this;v=new Image,v.onerror=function(){g.call(this),t.trigger("error",new n.ImageError(n.ImageError.WRONG_FORMAT))},v.onload=function(){t.trigger("load")},v.src=/^data:[^;]*;base64,/.test(e)?e:u(e,y.type)}function p(e,t){var i,o=this;return window.FileReader?(i=new FileReader,i.onload=function(){t(this.result)},i.onerror=function(){o.trigger("error",new n.FileException(n.FileException.NOT_READABLE_ERR))},void i.readAsDataURL(e)):t(e.getAsDataURL())}function h(n,i,o,r){var a,s,l,c,u,d,p=this,h=0,g=0;if(k=r,d=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==t.inArray(d,[5,6,7,8])){var v=n;n=i,i=v}return l=e(),s=o?Math.max:Math.min,a=s(n/l.width,i/l.height),a>1&&(!o||r)?void this.trigger("Resize"):(_||(_=document.createElement("canvas")),c=Math.round(l.width*a),u=Math.round(l.height*a),o?(_.width=n,_.height=i,c>n&&(h=Math.round((c-n)/2)),u>i&&(g=Math.round((u-i)/2))):(_.width=c,_.height=u),k||m(_.width,_.height,d),f.call(this,l,_,-h,-g,c,u),this.width=_.width,this.height=_.height,E=!0,void p.trigger("Resize"))}function f(e,t,n,i,o,r){if("iOS"===l.OS)a.renderTo(e,t,{width:o,height:r,x:n,y:i});else{var s=t.getContext("2d");s.drawImage(e,n,i,o,r)}}function m(e,t,n){switch(n){case 5:case 6:case 7:case 8:_.width=t,_.height=e;break;default:_.width=e,
_.height=t}var i=_.getContext("2d");switch(n){case 2:i.translate(e,0),i.scale(-1,1);break;case 3:i.translate(e,t),i.rotate(Math.PI);break;case 4:i.translate(0,t),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-t);break;case 7:i.rotate(.5*Math.PI),i.translate(e,-t),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-e,0)}}function g(){b&&(b.purge(),b=null),x=v=_=y=null,E=!1}var v,b,_,x,y,w=this,E=!1,k=!0;t.extend(this,{loadFromBlob:function(e){var t=this,i=t.getRuntime(),o=!(arguments.length>1)||arguments[1];if(!i.can("access_binary"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);return y=e,e.isDetached()?(x=e.getSource(),void d.call(this,x)):void p.call(this,e.getSource(),function(e){o&&(x=c(e)),d.call(t,e)})},loadFromImage:function(e,t){this.meta=e.meta,y=new o(null,{name:e.name,size:e.size,type:e.type}),d.call(this,t?x=e.getAsBinaryString():e.getAsDataURL())},getInfo:function(){var t,n=this.getRuntime();return!b&&x&&n.can("access_image_binary")&&(b=new r(x)),t={width:e().width||0,height:e().height||0,type:y.type||s.getFileMime(y.name),size:x&&x.length||y.size||0,name:y.name||"",meta:b&&b.meta||this.meta||{}}},downsize:function(){h.apply(this,arguments)},getAsCanvas:function(){return _&&(_.id=this.uid+"_canvas"),_},getAsBlob:function(e,t){return e!==this.type&&h.call(this,this.width,this.height,!1),new o(null,{name:y.name||"",type:e,data:w.getAsBinaryString.call(this,e,t)})},getAsDataURL:function(e){var t=arguments[1]||90;if(!E)return v.src;if("image/jpeg"!==e)return _.toDataURL("image/png");try{return _.toDataURL("image/jpeg",t/100)}catch(n){return _.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!E)return x||(x=c(w.getAsDataURL(e,t))),x;if("image/jpeg"!==e)x=c(w.getAsDataURL(e,t));else{var n;t||(t=90);try{n=_.toDataURL("image/jpeg",t/100)}catch(i){n=_.toDataURL("image/jpeg")}x=c(n),b&&(x=b.stripHeaders(x),k&&(b.meta&&b.meta.exif&&b.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),x=b.writeHeaders(x)),b.purge(),b=null)}return E=!1,x},destroy:function(){w=null,g.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=c}),i(H,[s,u,d,p,m],function(e,t,n,i,o){function r(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function a(a){var c,u=this;a=e.extend({swf_url:t.swf_url},a),o.call(this,a,s,{access_binary:function(e){return e&&"browser"===u.mode},access_image_binary:function(e){return e&&"browser"===u.mode},display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===u.mode},resize_image:o.capTrue,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||(!e.arrayDiff(t,["","text","document"])||"browser"===u.mode)},return_status_code:function(t){return"browser"===u.mode||!e.arrayDiff(t,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:function(e){return e&&"browser"===u.mode},send_browser_cookies:function(e){return e&&"browser"===u.mode},send_custom_headers:function(e){return e&&"browser"===u.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:function(e){return e&&"browser"===u.mode},summon_file_dialog:!1,upload_filesize:function(t){return e.parseSizeStr(t)<=2097152||"client"===u.mode},use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function(e){return e?"browser":"client"},access_image_binary:function(e){return e?"browser":"client"},report_upload_progress:function(e){return e?"browser":"client"},return_response_type:function(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function(e){return e?"browser":"client"},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"browser":"client"},stream_upload:function(e){return e?"client":"browser"},upload_filesize:function(t){return e.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),r()<10&&(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid)},shimExec:function(e,t){var n=[].slice.call(arguments,2);return u.getShim().exec(this.uid,e,t,n)},init:function(){var n,o,r;r=this.getShimContainer(),e.extend(r.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),n='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+a.swf_url+'" ',"IE"===t.browser&&(n+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),n+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+t.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===t.browser?(o=document.createElement("div"),r.appendChild(o),o.outerHTML=n,o=r=null):r.innerHTML=n,c=setTimeout(function(){u&&!u.initialized&&u.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){e.call(u),clearTimeout(c),a=c=e=u=null}}(this.destroy)},l)}var s="flash",l={};return o.addConstructor(s,a),l}),i(G,[H,v],function(e,t){var n={slice:function(e,n,i,o){var r=this.getRuntime();return 0>n?n=Math.max(e.size+n,0):n>0&&(n=Math.min(n,e.size)),0>i?i=Math.max(e.size+i,0):i>0&&(i=Math.min(i,e.size)),e=r.shimExec.call(this,"Blob","slice",n,i,o||""),e&&(e=new t(r.uid,e)),e}};return e.Blob=n}),i(V,[H],function(e){var t={init:function(e){this.getRuntime().shimExec.call(this,"FileInput","init",{name:e.name,accept:e.accept,multiple:e.multiple}),this.trigger("ready")}};return e.FileInput=t}),i(X,[H,f],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i="",o={read:function(e,t){var o=this,r=o.getRuntime();return"readAsDataURL"===e&&(i="data:"+(t.type||"")+";base64,"),o.bind("Progress",function(t,o){o&&(i+=n(o,e))}),r.shimExec.call(this,"FileReader","readAsBase64",t.uid)},getResult:function(){return i},destroy:function(){i=null}};return e.FileReader=o}),i(W,[H,f],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i={read:function(e,t){var i,o=this.getRuntime();return(i=o.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid))?("readAsDataURL"===e&&(i="data:"+(t.type||"")+";base64,"+i),n(i,e,t.type)):null}};return e.FileReaderSync=i}),i(Y,[H,s,v,b,k,$,T],function(e,t,n,i,o,r,a){var s={send:function(e,i){function o(){e.transport=u.mode,u.shimExec.call(c,"XMLHttpRequest","send",e,i)}function s(e,t){u.shimExec.call(c,"XMLHttpRequest","appendBlob",e,t.uid),i=null,o()}function l(e,t){var n=new a;n.bind("TransportingComplete",function(){t(this.result)}),n.transport(e.getSource(),e.type,{ruid:u.uid})}var c=this,u=c.getRuntime();if(t.isEmptyObj(e.headers)||t.each(e.headers,function(e,t){u.shimExec.call(c,"XMLHttpRequest","setRequestHeader",t,e.toString())}),i instanceof r){var d;if(i.each(function(e,t){e instanceof n?d=t:u.shimExec.call(c,"XMLHttpRequest","append",t,e)}),i.hasBlob()){var p=i.getBlob();p.isDetached()?l(p,function(e){p.destroy(),s(d,e)}):s(d,p)}else i=null,o()}else i instanceof n?i.isDetached()?l(i,function(e){i.destroy(),i=e.uid,o()}):(i=i.uid,o()):o()},getResponse:function(e){var n,r,a=this.getRuntime();if(r=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(r=new i(a.uid,r),"blob"===e)return r;try{if(n=new o,~t.inArray(e,["","text"]))return n.readAsText(r);if("json"===e&&window.JSON)return JSON.parse(n.readAsText(r))}finally{r.destroy()}}return null},abort:function(e){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=s}),i(Q,[H,v],function(e,t){var n={getAsBlob:function(e){var n=this.getRuntime(),i=n.shimExec.call(this,"Transporter","getAsBlob",e);return i?new t(n.uid,i):null}};return e.Transporter=n}),i(J,[H,s,T,v,k],function(e,t,n,i,o){var r={loadFromBlob:function(e){function t(e){o.shimExec.call(i,"Image","loadFromBlob",e.uid),i=o=null}var i=this,o=i.getRuntime();if(e.isDetached()){var r=new n;r.bind("TransportingComplete",function(){t(r.result.getSource())}),r.transport(e.getSource(),e.type,{ruid:o.uid})}else t(e.getSource())},loadFromImage:function(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getAsBlob:function(e,t){var n=this.getRuntime(),o=n.shimExec.call(this,"Image","getAsBlob",e,t);return o?new i(n.uid,o):null},getAsDataURL:function(){var e,t=this.getRuntime(),n=t.Image.getAsBlob.apply(this,arguments);return n?(e=new o,e.readAsDataURL(n)):null}};return e.Image=r}),i(K,[s,u,d,p,m],function(e,t,n,i,o){function r(e){var t,n,i,o,r,a=!1,s=null,l=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(e)&&(a=!0),s=null}catch(c){var u=navigator.plugins["Silverlight Plug-In"];if(u){for(t=u.description,"1.0.30226.2"===t&&(t="2.0.30226.2"),n=t.split(".");n.length>3;)n.pop();for(;n.length<4;)n.push(0);for(i=e.split(".");i.length>4;)i.pop();do o=parseInt(i[l],10),r=parseInt(n[l],10),l++;while(l<i.length&&o===r);r>=o&&!isNaN(o)&&(a=!0)}}}catch(d){a=!1}return a}function a(a){var c,u=this;a=e.extend({xap_url:t.xap_url},a),o.call(this,a,s,{access_binary:o.capTrue,access_image_binary:o.capTrue,display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:o.capTrue,resize_image:o.capTrue,return_response_headers:function(e){return e&&"client"===u.mode},return_response_type:function(e){return"json"!==e||!!window.JSON},return_status_code:function(t){return"client"===u.mode||!e.arrayDiff(t,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:o.capTrue,send_browser_cookies:function(e){return e&&"browser"===u.mode},send_custom_headers:function(e){return e&&"client"===u.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:o.capTrue,use_http_method:function(t){return"client"===u.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function(e){return e?"client":"browser"},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"client":"browser"},use_http_method:function(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),r("2.0.31005.0")&&"Opera"!==t.browser||(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid).content.Moxie},shimExec:function(e,t){var n=[].slice.call(arguments,2);return u.getShim().exec(this.uid,e,t,n)},init:function(){var e;e=this.getShimContainer(),e.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+a.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+t.global_event_dispatcher+'"/></object>',c=setTimeout(function(){u&&!u.initialized&&u.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},"Windows"http://common1.qyerstatic.com/place/js/poi/!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(u),clearTimeout(c),a=c=e=u=null}}(this.destroy)},l)}var s="silverlight",l={};return o.addConstructor(s,a),l}),i(Z,[K,s,G],function(e,t,n){return e.Blob=t.extend({},n)}),i(ee,[K],function(e){var t={init:function(e){function t(e){for(var t="",n=0;n<e.length;n++)t+=(""!==t?"|":"")+e[n].title+" | *."+e[n].extensions.replace(/,/g,";*.");return t}this.getRuntime().shimExec.call(this,"FileInput","init",t(e.accept),e.name,e.multiple),this.trigger("ready")}};return e.FileInput=t}),i(te,[K,d,I],function(e,t,n){var i={init:function(){var e,i=this,o=i.getRuntime();return e=o.getShimContainer(),n.addEvent(e,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},i.uid),n.addEvent(e,"dragenter",function(e){e.preventDefault();var n=t.get(o.uid).dragEnter(e);n&&e.stopPropagation()},i.uid),n.addEvent(e,"drop",function(e){e.preventDefault();var n=t.get(o.uid).dragDrop(e);n&&e.stopPropagation()},i.uid),o.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=i}),i(ne,[K,s,X],function(e,t,n){return e.FileReader=t.extend({},n)}),i(ie,[K,s,W],function(e,t,n){return e.FileReaderSync=t.extend({},n)}),i(oe,[K,s,Y],function(e,t,n){return e.XMLHttpRequest=t.extend({},n)}),i(re,[K,s,Q],function(e,t,n){return e.Transporter=t.extend({},n)}),i(ae,[K,s,J],function(e,t,n){return e.Image=t.extend({},n,{getInfo:function(){var e=this.getRuntime(),n=["tiff","exif","gps"],i={meta:{}},o=e.shimExec.call(this,"Image","getInfo");return o.meta&&t.each(n,function(e){var t,n,r,a,s=o.meta[e];if(s&&s.keys)for(i.meta[e]={},n=0,r=s.keys.length;r>n;n++)t=s.keys[n],a=s[t],a&&(/^(\d|[1-9]\d+)$/.test(a)?a=parseInt(a,10):/^\d*\.\d+$/.test(a)&&(a=parseFloat(a)),i.meta[e][t]=a)}),i.width=parseInt(o.width,10),i.height=parseInt(o.height,10),i.size=parseInt(o.size,10),i.type=o.type,i.name=o.name,i}})}),i(se,[s,p,m,u],function(e,t,n,i){function o(t){var o=this,s=n.capTest,l=n.capTrue;n.call(this,t,r,{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s(a.Image&&(i.can("create_canvas")||i.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),resize_image:function(){return a.Image&&o.can("access_binary")&&i.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||!!~e.inArray(t,["text","document",""])},return_status_code:function(t){return!e.arrayDiff(t,[200,404])},select_file:function(){return i.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return o.can("select_file")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||!!~e.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:l,use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}}),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(o),e=o=null}}(this.destroy)}),e.extend(this.getShim(),a)}var r="html4",a={};return n.addConstructor(r,o),a}),i(le,[se,s,d,I,c,u],function(e,t,n,i,o,r){function a(){function e(){var o,u,d,p,h,f,m=this,g=m.getRuntime();f=t.guid("uid_"),o=g.getShimContainer(),a&&(d=n.get(a+"_form"),d&&t.extend(d.style,{top:"100%"})),p=document.createElement("form"),p.setAttribute("id",f+"_form"),p.setAttribute("method","post"),p.setAttribute("enctype","multipart/form-data"),p.setAttribute("encoding","multipart/form-data"),t.extend(p.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),h=document.createElement("input"),h.setAttribute("id",f),h.setAttribute("type","file"),h.setAttribute("name",s.name||"Filedata"),h.setAttribute("accept",c.join(",")),t.extend(h.style,{fontSize:"999px",opacity:0}),p.appendChild(h),o.appendChild(p),t.extend(h.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===r.browser&&r.version<10&&t.extend(h.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),h.onchange=function(){var t;this.value&&(t=this.files?this.files[0]:{name:this.value},l=[t],this.onchange=function(){},e.call(m),m.bind("change",function i(){var e,t=n.get(f),o=n.get(f+"_form");m.unbind("change",i),m.files.length&&t&&o&&(e=m.files[0],t.setAttribute("id",e.uid),o.setAttribute("id",e.uid+"_form"),o.setAttribute("target",e.uid+"_iframe")),t=o=null},998),h=p=null,m.trigger("change"))},g.can("summon_file_dialog")&&(u=n.get(s.browse_button),i.removeEvent(u,"click",m.uid),i.addEvent(u,"click",function(e){h&&!h.disabled&&h.click(),e.preventDefault()},m.uid)),a=f,o=d=u=null}var a,s,l=[],c=[];t.extend(this,{init:function(t){var r,a=this,l=a.getRuntime();s=t,c=t.accept.mimes||o.extList2mimes(t.accept,l.can("filter_by_extension")),r=l.getShimContainer(),function(){var e,o,s;e=n.get(t.browse_button),l.can("summon_file_dialog")&&("static"===n.getStyle(e,"position")&&(e.style.position="relative"),o=parseInt(n.getStyle(e,"z-index"),10)||1,e.style.zIndex=o,r.style.zIndex=o-1),s=l.can("summon_file_dialog")?e:r,i.addEvent(s,"mouseover",function(){a.trigger("mouseenter")},a.uid),i.addEvent(s,"mouseout",function(){a.trigger("mouseleave")},a.uid),i.addEvent(s,"mousedown",function(){a.trigger("mousedown")},a.uid),i.addEvent(n.get(t.container),"mouseup",function(){a.trigger("mouseup")},a.uid),e=null}(),e.call(this),r=null,a.trigger({type:"ready",async:!0})},getFiles:function(){return l},disable:function(e){var t;(t=n.get(a))&&(t.disabled=!!e)},destroy:function(){var e=this.getRuntime(),t=e.getShim(),o=e.getShimContainer();i.removeAllEvents(o,this.uid),i.removeAllEvents(s&&n.get(s.container),this.uid),i.removeAllEvents(s&&n.get(s.browse_button),this.uid),o&&(o.innerHTML=""),t.removeInstance(this.uid),a=l=c=s=o=t=null}})}return e.FileInput=a}),i(ce,[se,L],function(e,t){return e.FileReader=t}),i(ue,[se,s,d,E,p,I,v,$],function(e,t,n,i,o,r,a,s){function l(){function e(e){var t,i,o,a,s=this,l=!1;if(u){if(t=u.id.replace(/_iframe$/,""),i=n.get(t+"_form")){for(o=i.getElementsByTagName("input"),a=o.length;a--;)switch(o[a].getAttribute("type")){case"hidden":o[a].parentNode.removeChild(o[a]);break;case"file":l=!0}o=[],l||i.parentNode.removeChild(i),i=null}setTimeout(function(){r.removeEvent(u,"load",s.uid),u.parentNode&&u.parentNode.removeChild(u);var t=s.getRuntime().getShimContainer();t.children.length||t.parentNode.removeChild(t),t=u=null,e()},1)}}var l,c,u;t.extend(this,{send:function(d,p){function h(){var n=_.getShimContainer()||document.body,o=document.createElement("div");o.innerHTML='<iframe id="'+f+'_iframe" name="'+f+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',u=o.firstChild,n.appendChild(u),r.addEvent(u,"load",function(){var n;try{n=u.contentWindow.document||u.contentDocument||window.frames[u.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(n.title)?l=n.title.replace(/^(\d+).*$/,"$1"):(l=200,c=t.trim(n.body.innerHTML),b.trigger({type:"progress",loaded:c.length,total:c.length}),v&&b.trigger({type:"uploadprogress",loaded:v.size||1025,total:v.size||1025}))}catch(o){if(!i.hasSameOrigin(d.url))return void e.call(b,function(){b.trigger("error")});l=404}e.call(b,function(){b.trigger("load")})},b.uid)}var f,m,g,v,b=this,_=b.getRuntime();if(l=c=null,p instanceof s&&p.hasBlob()){if(v=p.getBlob(),f=v.uid,g=n.get(f),m=n.get(f+"_form"),!m)throw new o.DOMException(o.DOMException.NOT_FOUND_ERR)}else f=t.guid("uid_"),m=document.createElement("form"),m.setAttribute("id",f+"_form"),m.setAttribute("method",d.method),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),m.setAttribute("target",f+"_iframe"),_.getShimContainer().appendChild(m);p instanceof s&&p.each(function(e,n){if(e instanceof a)g&&g.setAttribute("name",n);else{var i=document.createElement("input");t.extend(i,{type:"hidden",name:n,value:e}),g?m.insertBefore(i,g):m.appendChild(i)}}),m.setAttribute("action",d.url),h(),m.submit(),b.trigger("loadstart")},getStatus:function(){return l},getResponse:function(e){if("json"===e&&"string"===t.typeOf(c)&&window.JSON)try{return JSON.parse(c.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(n){return null}return c},abort:function(){var t=this;u&&u.contentWindow&&(u.contentWindow.stop?u.contentWindow.stop():u.contentWindow.document.execCommand?u.contentWindow.document.execCommand("Stop"):u.src="about:blank"),e.call(this,function(){t.dispatchEvent("abort")})}})}return e.XMLHttpRequest=l}),i(de,[se,z],function(e,t){return e.Image=t}),r([s,l,c,u,d,p,h,f,m,g,v,b,_,x,y,w,E,k,$,R,T,C,I])}(this),function(){"use strict";var e={},t=moxie.core.utils.Basic.inArray;return function n(i){var o,r;for(o in i)r=typeof i[o],"object"!==r||~t(o,["Exceptions","Env","Mime"])?"function"===r&&(e[o]=i[o]):n(i[o])}(window.moxie),e.Env=window.moxie.core.utils.Env,e.Mime=window.moxie.core.utils.Mime,e.Exceptions=window.moxie.core.Exceptions,window.mOxie=e,window.o||(window.o=e),e}(),function(e,t,n){function i(e){function t(e,t,n){var o={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};o[e]?i[o[e]]=t:n||(i[e]=t)}var n=e.required_features,i={};return"string"==typeof n?a.each(n.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==typeof n?a.each(n,function(e,n){t(n,e)}):n===!0&&(e.multipart||(i.send_binary_string=!0),e.chunk_size>0&&(i.slice_blob=!0),e.resize.enabled&&(i.send_binary_string=!0),a.each(e,function(e,n){t(n,!!e,!0)})),i}var o=e.setTimeout,r={},a={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,get:function(e){var n,i=[];"array"!==t.typeOf(e)&&(e=[e]);for(var o=e.length;o--;)n=t.get(e[o]),n&&i.push(n);return i.length?i:null},each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},n=/[<>&\"\']/g;return e?(""+e).replace(n,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,n;for(n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var n="";return a.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},formatSize:function(e){function t(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(e===n||/\D/.test(e))return a.translate("N/A");var i=Math.pow(1024,4);return e>i?t(e/i,1)+" "+a.translate("tb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("gb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("mb"):e>1024?Math.round(e/1024)+" "+a.translate("kb"):e+" "+a.translate("b")},parseSize:t.parseSizeStr,predictRuntime:function(e,n){var i,o;return i=new a.Uploader(e),o=t.Runtime.thatCan(i.getOption().required_features,n||e.runtimes),i.destroy(),o},addFileFilter:function(e,t){r[e]=t}};a.addFileFilter("mime_types",function(e,t,n){e.length&&!e.regexp.test(t.name)?(this.trigger("Error",{code:a.FILE_EXTENSION_ERROR,message:a.translate("File extension error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("max_file_size",function(e,t,n){var i;e=a.parseSize(e),t.size!==i&&e&&t.size>e?(this.trigger("Error",{code:a.FILE_SIZE_ERROR,message:a.translate("File size error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("prevent_duplicates",function(e,t,n){if(e)for(var i=this.files.length;i--;)if(t.name===this.files[i].name&&t.size===this.files[i].size)return this.trigger("Error",{code:a.FILE_DUPLICATE_ERROR,message:a.translate("Duplicate file error."),file:t}),void n(!1);n(!0)}),a.Uploader=function(e){function s(){var e,t,n=0;if(this.state==a.STARTED){for(t=0;t<q.length;t++)e||q[t].status!=a.QUEUED?n++:(e=q[t],this.trigger("BeforeUpload",e)&&(e.status=a.UPLOADING,this.trigger("UploadFile",e)));n==q.length&&(this.state!==a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",q))}}function l(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,c()}function c(){var e,t;for(T.reset(),e=0;e<q.length;e++)t=q[e],t.size!==n?(T.size+=t.origSize,T.loaded+=t.loaded*t.origSize/t.size):T.size=n,t.status==a.DONE?T.uploaded++:t.status==a.FAILED?T.failed++:T.queued++;T.size===n?T.percent=q.length>0?Math.ceil(T.uploaded/q.length*100):0:(T.bytesPerSec=Math.ceil(T.loaded/((+new Date-R||1)/1e3)),T.percent=T.size>0?Math.ceil(T.loaded/T.size*100):0)}function u(){var e=A[0]||O[0];return!!e&&e.getRuntime().uid}function d(e,n){if(e.ruid){var i=t.Runtime.getInfo(e.ruid);if(i)return i.can(n)}return!1}function p(){this.bind("FilesAdded",g),this.bind("CancelUpload",y),this.bind("BeforeUpload",v),this.bind("UploadFile",b),this.bind("UploadProgress",_),this.bind("StateChanged",x),this.bind("QueueChanged",c),this.bind("Error",E),this.bind("FileUploaded",w),this.bind("Destroy",k)}function h(e,n){var i=this,o=0,r=[],s={accept:e.filters.mime_types,runtime_order:e.runtimes,required_caps:e.required_features,preferred_caps:I,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url};a.each(e.runtimes.split(/\s*,\s*/),function(t){e[t]&&(s[t]=e[t])}),e.browse_button&&a.each(e.browse_button,function(n){r.push(function(r){var l=new t.FileInput(a.extend({},s,{name:e.file_data_name,multiple:e.multi_selection,container:e.container,browse_button:n}));l.onready=function(){var e=t.Runtime.getInfo(this.ruid);t.extend(i.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),o++,A.push(this),r()},l.onchange=function(){i.addFile(this.files)},l.bind("mouseenter mouseleave mousedown mouseup",function(i){L||(e.browse_button_hover&&("mouseenter"http://common1.qyerstatic.com/place/js/poi/===i.type?t.addClass(n,e.browse_button_hover):"mouseleave"===i.type&&t.removeClass(n,e.browse_button_hover)),e.browse_button_active&&("mousedown"http://common1.qyerstatic.com/place/js/poi/===i.type?t.addClass(n,e.browse_button_active):"mouseup"===i.type&&t.removeClass(n,e.browse_button_active)))}),l.bind("error runtimeerror",function(){l=null,r()}),l.init()})}),e.drop_element&&a.each(e.drop_element,function(e){r.push(function(n){var r=new t.FileDrop(a.extend({},s,{drop_zone:e}));r.onready=function(){var e=t.Runtime.getInfo(this.ruid);i.features.dragdrop=e.can("drag_and_drop"),o++,O.push(this),n()},r.ondrop=function(){i.addFile(this.files)},r.bind("error runtimeerror",function(){r=null,n()}),r.init()})}),t.inSeries(r,function(){"function"==typeof n&&n(o)})}function f(e,n,i){var o=new t.Image;try{o.onload=function(){o.downsize(n.width,n.height,n.crop,n.preserve_headers)},o.onresize=function(){i(this.getAsBlob(e.type,n.quality)),this.destroy()},o.onerror=function(){i(e)},o.load(e)}catch(r){i(e)}}function m(e,n,o){function r(e,t,n){var i=$[e];switch(e){case"max_file_size":"max_file_size"===e&&($.max_file_size=$.filters.max_file_size=t);break;case"chunk_size":(t=a.parseSize(t))&&($[e]=t);break;case"filters":"array"===a.typeOf(t)&&(t={mime_types:t}),n?a.extend($.filters,t):$.filters=t,t.mime_types&&($.filters.mime_types.regexp=function(e){var t=[];return a.each(e,function(e){a.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}($.filters.mime_types));break;case"resize":n?a.extend($.resize,t,{enabled:!0}):$.resize=t;break;case"prevent_duplicates":$.prevent_duplicates=$.filters.prevent_duplicates=!!t;break;case"browse_button":case"drop_element":t=a.get(t);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":$[e]=t,n||(l=!0);break;default:$[e]=t}n||s.trigger("OptionChanged",e,t,i)}var s=this,l=!1;"object"==typeof e?a.each(e,function(e,t){r(t,e,o)}):r(e,n,o),o?($.required_features=i(a.extend({},$)),I=i(a.extend({},$,{required_features:!0}))):l&&(s.trigger("Destroy"),h.call(s,$,function(e){e?(s.runtime=t.Runtime.getInfo(u()).type,s.trigger("Init",{runtime:s.runtime}),s.trigger("PostInit")):s.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}))}function g(e,t){[].push.apply(q,t),e.trigger("QueueChanged"),e.refresh()}function v(e,t){if($.unique_names){var n=t.name.match(/\.([^.]+)$/),i="part";n&&(i=n[1]),t.target_name=t.id+"."+i}}function b(e,n){function i(){u-- >0?o(r,1e3):(n.loaded=h,e.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:n,response:C.responseText,status:C.status,responseHeaders:C.getAllResponseHeaders()}))}function r(){var d,f,m,g;n.status!=a.DONE&&n.status!=a.FAILED&&e.state!=a.STOPPED&&(m={name:n.target_name||n.name},c&&p.chunks&&s.size>c?(g=Math.min(c,s.size-h),d=s.slice(h,h+g)):(g=s.size,d=s),c&&p.chunks&&(e.settings.send_chunk_number?(m.chunk=Math.ceil(h/c),m.chunks=Math.ceil(s.size/c)):(m.offset=h,m.total=s.size)),C=new t.XMLHttpRequest,C.upload&&(C.upload.onprogress=function(t){n.loaded=Math.min(n.size,h+t.loaded),e.trigger("UploadProgress",n)}),C.onload=function(){return C.status>=400?void i():(u=e.settings.max_retries,g<s.size?(d.destroy(),h+=g,n.loaded=Math.min(h,s.size),e.trigger("ChunkUploaded",n,{offset:n.loaded,total:s.size,response:C.responseText,status:C.status,responseHeaders:C.getAllResponseHeaders()}),"Android Browser"===t.Env.browser&&e.trigger("UploadProgress",n)):n.loaded=n.size,d=f=null,!h||h>=s.size?(n.size!=n.origSize&&(s.destroy(),s=null),e.trigger("UploadProgress",n),n.status=a.DONE,e.trigger("FileUploaded",n,{response:C.responseText,status:C.status,responseHeaders:C.getAllResponseHeaders()})):o(r,1),void 0)},C.onerror=function(){i()},C.onloadend=function(){this.destroy(),C=null},e.settings.multipart&&p.multipart?(m.name=n.target_name||n.name,C.open("post",l,!0),a.each(e.settings.headers,function(e,t){C.setRequestHeader(t,e)}),f=new t.FormData,a.each(a.extend(m,e.settings.multipart_params),function(e,t){f.append(t,e)}),f.append(e.settings.file_data_name,d),C.send(f,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:I,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})):(l=a.buildUrl(e.settings.url,a.extend(m,e.settings.multipart_params)),C.open("post",l,!0),C.setRequestHeader("Content-Type","application/octet-stream"),a.each(e.settings.headers,function(e,t){C.setRequestHeader(t,e)}),C.send(d,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:I,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})))}var s,l=e.settings.url,c=e.settings.chunk_size,u=e.settings.max_retries,p=e.features,h=0;n.loaded&&(h=n.loaded=c*Math.floor(n.loaded/c)),s=n.getSource(),e.settings.resize.enabled&&d(s,"send_binary_string")&&~t.inArray(s.type,["image/jpeg","image/png"])?f.call(this,s,e.settings.resize,function(e){s=e,n.size=e.size,r()}):r()}function _(e,t){l(t)}function x(e){if(e.state==a.STARTED)R=+new Date;else if(e.state==a.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==a.UPLOADING&&(e.files[t].status=a.QUEUED,c())}function y(){C&&C.abort()}function w(e){c(),o(function(){s.call(e)},1)}function E(e,t){t.file&&(t.file.status=a.FAILED,l(t.file),e.state==a.STARTED&&(e.trigger("CancelUpload"),o(function(){s.call(e)},1)))}function k(e){e.stop(),a.each(q,function(e){e.destroy()}),q=[],A.length&&(a.each(A,function(e){e.destroy()}),A=[]),O.length&&(a.each(O,function(e){e.destroy()}),O=[]),I={},L=!1,R=C=null,T.reset();
}var $,R,T,C,S=a.guid(),q=[],I={},A=[],O=[],L=!1;$={runtimes:t.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf"/*tpa=http://common1.qyerstatic.com/place/js/poi/js/Moxie.swf*/,silverlight_xap_url:"http://common1.qyerstatic.com/place/js/poi/js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_chunk_number:!0},m.call(this,e,null,!0),T=new a.QueueProgress,a.extend(this,{id:S,uid:S,state:a.STOPPED,features:{},runtime:null,files:q,settings:$,total:T,init:function(){var e=this;return"function"==typeof $.preinit?$.preinit(e):a.each($.preinit,function(t,n){e.bind(n,t)}),$.browse_button&&$.url?(p.call(this),void h.call(this,$,function(n){"function"==typeof $.init?$.init(e):a.each($.init,function(t,n){e.bind(n,t)}),n?(e.runtime=t.Runtime.getInfo(u()).type,e.trigger("Init",{runtime:e.runtime}),e.trigger("PostInit")):e.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})})):void this.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})},setOption:function(e,t){m.call(this,e,t,!this.runtime)},getOption:function(e){return e?$[e]:$},refresh:function(){A.length&&a.each(A,function(e){e.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=a.STARTED&&(this.state=a.STARTED,this.trigger("StateChanged"),s.call(this))},stop:function(){this.state!=a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){L=arguments[0]===n||arguments[0],A.length&&a.each(A,function(e){e.disable(L)}),this.trigger("DisableBrowse",L)},getFile:function(e){var t;for(t=q.length-1;t>=0;t--)if(q[t].id===e)return q[t]},addFile:function(e,n){function i(e,n){var i=[];t.each(c.settings.filters,function(t,n){r[n]&&i.push(function(i){r[n].call(c,t,e,function(e){i(!e)})})}),t.inSeries(i,n)}function s(e){var r=t.typeOf(e);if(e instanceof t.File){if(!e.ruid&&!e.isDetached()){if(!l)return!1;e.ruid=l,e.connectRuntime(l)}s(new a.File(e))}else e instanceof t.Blob?(s(e.getSource()),e.destroy()):e instanceof a.File?(n&&(e.name=n),d.push(function(t){i(e,function(n){n||(p.push(e),c.trigger("FileFiltered",e)),o(t,1)})})):t.inArray(r,["file","blob"])!==-1?s(new t.File(null,e)):"node"===r&&"filelist"===t.typeOf(e.files)?t.each(e.files,s):"array"===r&&(n=null,t.each(e,s))}var l,c=this,d=[],p=[];l=u(),s(e),d.length&&t.inSeries(d,function(){p.length&&c.trigger("FilesAdded",p)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,n=q.length-1;n>=0;n--)if(q[n].id===t)return this.splice(n,1)[0]},splice:function(e,t){var i=q.splice(e===n?0:e,t===n?q.length:t),o=!1;return this.state==a.STARTED&&(o=!0,this.stop()),this.trigger("FilesRemoved",i),a.each(i,function(e){e.destroy()}),this.trigger("QueueChanged"),this.refresh(),o&&this.start(),i},bind:function(e,t,n){var i=this;a.Uploader.prototype.bind.call(this,e,function(){var e=[].slice.call(arguments);return e.splice(0,1,i),t.apply(this,e)},0,n)},destroy:function(){this.trigger("Destroy"),$=T=null,this.unbindAll()}})},a.Uploader.prototype=t.EventTarget.instance,a.File=function(){function e(e){a.extend(this,{id:a.guid(),name:e.name||e.fileName,type:e.type||"",size:e.size||e.fileSize,origSize:e.size||e.fileSize,loaded:0,percent:0,status:a.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var e=this.getSource().getSource();return t.inArray(t.typeOf(e),["blob","file"])!==-1?e:null},getSource:function(){return n[this.id]?n[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete n[this.id])}}),n[this.id]=e}var n={};return e}(),a.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=a}(window,mOxie),define("plupload",function(){}),!function(global){function createCookie(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="; expires="+i.toGMTString();document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t=e+"=",n=document.cookie.split(";"),i=0,o=n.length;i<o;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function QiniuJsSDK(){function log(e,t){for(var n="[qiniu-js-sdk]["+e+"]",i=n,o=0;o<t.length;o++)i+="string"==typeof t[o]?" "+t[o]:" "+that.stringifyJSON(t[o]);that.detectIEVersion()?console.log(i):(t.unshift(n),console.log.apply(console,t)),document.getElementById("qiniu-js-sdk-log")&&(document.getElementById("qiniu-js-sdk-log").innerHTML+="<p>"+i+"</p>")}function makeLogFunc(e){var t=e.toLowerCase();logger[t]=function(){if(window.console&&window.console.log&&logger.level>=logger[e]){var n=Array.prototype.slice.call(arguments);log(t,n)}}}var that=this;this.detectIEVersion=function(){for(var e=4,t=document.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+e+"]><i></i><![endif]-->",n[0];)e++;return e>4&&e};var logger={MUTE:0,FATA:1,ERROR:2,WARN:3,INFO:4,DEBUG:5,TRACE:6,level:0};for(var property in logger)logger.hasOwnProperty(property)&&"number"==typeof logger[property]&&!logger.hasOwnProperty(property.toLowerCase())&&makeLogFunc(property);var qiniuUploadUrl;qiniuUploadUrl="https:"===window.location.protocol?"https://up.qbox.me":"http://upload.qiniu.com/";var qiniuUploadUrls=["http://upload.qiniu.com/","http://up.qiniu.com/"],qiniuUpHosts={http:["http://upload.qiniu.com/","http://up.qiniu.com/"],https:["https://up.qbox.me"]},changeUrlTimes=0;this.resetUploadUrl=function(){var e="https:"===window.location.protocol?qiniuUpHosts.https:qiniuUpHosts.http,t=changeUrlTimes%e.length;qiniuUploadUrl=e[t],changeUrlTimes++,logger.debug("resetUploadUrl: "+qiniuUploadUrl)},this.isImage=function(e){return e=e.split(/[?#]/)[0],/\.(png|jpg|jpeg|gif|bmp)$/i.test(e)},this.getFileExtension=function(e){var t,n=e.split(".");return t=1===n.length||""===n[0]&&2===n.length?"":n.pop().toLowerCase()},this.utf8_encode=function(e){if(null===e||"undefined"==typeof e)return"";var t,n,i=e+"",o="",r=0;t=n=0,r=i.length;for(var a=0;a<r;a++){var s=i.charCodeAt(a),l=null;if(s<128)n++;else if(s>127&&s<2048)l=String.fromCharCode(s>>6|192,63&s|128);else if(63488&s^!0)l=String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128);else{if(64512&s^!0)throw new RangeError("Unmatched trail surrogate at "+a);var c=i.charCodeAt(++a);if(64512&c^!0)throw new RangeError("Unmatched lead surrogate at "+(a-1));s=((1023&s)<<10)+(1023&c)+65536,l=String.fromCharCode(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}null!==l&&(n>t&&(o+=i.slice(t,n)),o+=l,t=n=a+1)}return n>t&&(o+=i.slice(t,r)),o},this.base64_decode=function(e){var t,n,i,o,r,a,s,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,d=0,p="",h=[];if(!e)return e;e+="";do o=c.indexOf(e.charAt(u++)),r=c.indexOf(e.charAt(u++)),a=c.indexOf(e.charAt(u++)),s=c.indexOf(e.charAt(u++)),l=o<<18|r<<12|a<<6|s,t=l>>16&255,n=l>>8&255,i=255&l,64===a?h[d++]=String.fromCharCode(t):64===s?h[d++]=String.fromCharCode(t,n):h[d++]=String.fromCharCode(t,n,i);while(u<e.length);return p=h.join("")},this.base64_encode=function(e){var t,n,i,o,r,a,s,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,d=0,p="",h=[];if(!e)return e;e=this.utf8_encode(e+"");do t=e.charCodeAt(u++),n=e.charCodeAt(u++),i=e.charCodeAt(u++),l=t<<16|n<<8|i,o=l>>18&63,r=l>>12&63,a=l>>6&63,s=63&l,h[d++]=c.charAt(o)+c.charAt(r)+c.charAt(a)+c.charAt(s);while(u<e.length);switch(p=h.join(""),e.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p},this.URLSafeBase64Encode=function(e){return e=this.base64_encode(e),e.replace(/\//g,"_").replace(/\+/g,"-")},this.URLSafeBase64Decode=function(e){return e=e.replace(/_/g,"/").replace(/-/g,"+"),this.base64_decode(e)},this.createAjax=function(e){var t={};return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);var rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,text=String(data);return rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),eval("("+text+")")},this.stringifyJSON=function(e){if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(e);switch(typeof e){case"string":return'"'+e.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+e.map(that.stringifyJSON).join(",")+"]";case"object":if(e instanceof Array){for(var t=[],n=e.length,i=0;i<n;i++)t.push(that.stringifyJSON(e[i]));return"["+t.join(",")+"]"}if(null===e)return"null";var o=[];for(var r in e)e.hasOwnProperty(r)&&o.push(that.stringifyJSON(r)+":"+that.stringifyJSON(e[r]));return"{"+o.join(",")+"}";case"number":return e;case!1:return e;case"boolean":return e}},this.trim=function(e){return null===e?"":e.replace(/^\s+|\s+$/g,"")},this.uploader=function(e){var t=function(){var t,n,i,o=that.detectIEVersion(),r="Safari"===mOxie.Env.browser&&mOxie.Env.version<=5&&"Windows"===mOxie.Env.os&&"7"===mOxie.Env.osVersion||"Safari"===mOxie.Env.browser&&"iOS"===mOxie.Env.os&&"7"===mOxie.Env.osVersion;o&&o<9&&e.chunk_size&&e.runtimes.indexOf("flash")>=0?e.chunk_size=0:r?e.chunk_size=0:(t=20,n=4<<t,i=plupload.parseSize(e.chunk_size),i>n&&(e.chunk_size=n))},n=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];0===i.indexOf("-H")?t.push(i.split(" ")[2]):t.push(i)}return t},i=function(e){var t=e.split(":"),n=t[0],i=that.parseJSON(that.URLSafeBase64Decode(t[2]));return i.ak=n,i.scope.indexOf(":")>=0?(i.bucket=i.scope.split(":")[0],i.key=i.scope.split(":")[1]):i.bucket=i.scope,i},o=function(t){var o=i(t),r=window.location.protocol+"//uc.qbox.me/v1/query?ak="+o.ak+"&bucket="+o.bucket;logger.debug("putPolicy: ",o),logger.debug("get uphosts from: ",r);var a,s=that.detectIEVersion();s&&s<=9?(a=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=e.flash_swf_url):a=that.createAjax(),a.open("GET",r,!0);var l=function(){if(logger.debug("ajax.readyState: ",a.readyState),4===a.readyState)if(logger.debug("ajax.status: ",a.status),a.status<400){var e=that.parseJSON(a.responseText);qiniuUpHosts.http=n(e.http.up),qiniuUpHosts.https=n(e.https.up),logger.debug("get new uphosts: ",qiniuUpHosts),that.resetUploadUrl()}else logger.error("get uphosts error: ",a.responseText)};s&&s<=9?a.bind("readystatechange",l):a.onreadystatechange=l,a.send()},r=function(t){return!that.token||e.uptoken_url&&that.tokenInfo.isExpired()?a(t):that.token},a=function(t){if(e.uptoken)that.token=e.uptoken;else if(e.uptoken_url){logger.debug("get uptoken from: ",that.uptoken_url);var n=that.createAjax();if(n.open("GET",that.uptoken_url,!1),n.setRequestHeader("If-Modified-Since","0"),n.send(),200===n.status){var i=that.parseJSON(n.responseText);that.token=i.uptoken;var r=that.token.split(":"),a=that.parseJSON(that.URLSafeBase64Decode(r[2]));that.tokenMap||(that.tokenMap={});var s=function(e){return Math.ceil(e.getTime()/1e3)},l=s(new Date(n.getResponseHeader("date"))),c=s(new Date);that.tokenInfo={serverDelay:c-l,deadline:a.deadline,isExpired:function(){var e=this.deadline-s(new Date)+this.serverDelay;return e<600}},logger.debug("get new uptoken: ",that.token),logger.debug("get token info: ",that.tokenInfo)}else logger.error("get uptoken error: ",n.responseText)}else e.uptoken_func?(logger.debug("get uptoken from uptoken_func"),that.token=e.uptoken_func(t),logger.debug("get new uptoken: ",that.token)):logger.error("one of [uptoken, uptoken_url, uptoken_func] settings in options is required!");return that.token&&o(that.token),that.token},s=function(t,n,i){var o="",r=!1;if(!e.save_key)if(r=t.getOption&&t.getOption("unique_names"),r=r||t.settings&&t.settings.unique_names){var a=that.getFileExtension(n.name);o=a?n.id+"."+a:n.id}else o="function"==typeof i?i(t,n):n.name;return o};if(e.log_level&&(logger.level=e.log_level),!e.domain)throw"domain setting in options is required!";if(!e.browse_button)throw"browse_button setting in options is required!";if(!e.uptoken&&!e.uptoken_url&&!e.uptoken_func)throw"one of [uptoken, uptoken_url, uptoken_func] settings in options is required!";logger.debug("init uploader start"),logger.debug("environment: ",mOxie.Env),logger.debug("userAgent: ",navigator.userAgent);var l={},c=e.init&&e.init.Error,u=e.init&&e.init.FileUploaded;e.init.Error=function(){},e.init.FileUploaded=function(){},that.uptoken_url=e.uptoken_url,that.token="",that.key_handler="function"http://common1.qyerstatic.com/place/js/poi/==typeof e.init.Key?e.init.Key:"",this.domain=e.domain;var d="",p={isResumeUpload:!1,resumeFilesize:0,startTime:"",currentTime:""};t(),logger.debug("invoke reset_chunk_size()"),logger.debug("op.chunk_size: ",e.chunk_size);var h={url:qiniuUploadUrl,multipart_params:{token:""}},f=that.detectIEVersion();f&&f<=9&&(h.multipart_params.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),plupload.extend(l,e,h),logger.debug("option: ",l);var m=new plupload.Uploader(l);logger.debug("new plupload.Uploader(option)"),m.bind("Init",function(t,n){logger.debug("Init event activated"),e.get_new_uptoken||a(null)}),logger.debug("bind Init event"),m.bind("FilesAdded",function(e,t){logger.debug("FilesAdded event activated");var n=e.getOption&&e.getOption("auto_start");n=n||e.settings&&e.settings.auto_start,logger.debug("auto_start: ",n),logger.debug("files: ",t);var i=function(){return"ios"===mOxie.Env.OS.toLowerCase()};if(i())for(var o=0;o<t.length;o++){var r=t[o],a=that.getFileExtension(r.name);r.name=r.id+"."+a}n&&setTimeout(function(){e.start(),logger.debug("invoke up.start()")},0),e.refresh()}),logger.debug("bind FilesAdded event"),m.bind("BeforeUpload",function(t,n){logger.debug("BeforeUpload event activated"),n.speed=n.speed||0,d="",e.get_new_uptoken&&a(n);var i=function(t,n,i){p.startTime=(new Date).getTime();var r;r=e.save_key?{token:that.token}:{key:s(t,n,i),token:that.token};var a=that.detectIEVersion();a&&a<=9&&(r.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),logger.debug("directUpload multipart_params_obj: ",r);var l=e.x_vars;if(void 0!==l&&"object"==typeof l)for(var c in l)l.hasOwnProperty(c)&&("function"==typeof l[c]?r["x:"+c]=l[c](t,n):"object"!=typeof l[c]&&(r["x:"+c]=l[c]));t.setOption({url:qiniuUploadUrl,multipart:!0,chunk_size:o()?e.max_file_size:void 0,multipart_params:r})},o=function(){var e=navigator.userAgent.toLowerCase();return!(!e.match(/MicroMessenger/i)&&"QQBrowser"!==mOxie.Env.browser&&!e.match(/V1_AND_SQ/i)||"android"!==mOxie.Env.OS.toLowerCase())},l=t.getOption&&t.getOption("chunk_size");if(l=l||t.settings&&t.settings.chunk_size,logger.debug("uploader.runtime: ",m.runtime),logger.debug("chunk_size: ",l),"html5"!==m.runtime&&"flash"!==m.runtime||!l)logger.debug("directUpload because uploader.runtime !== 'html5' || uploader.runtime !== 'flash' || !chunk_size"),i(t,n,that.key_handler);else if(n.size<l||o())logger.debug("directUpload because file.size < chunk_size || is_android_weixin_or_qq()"),i(t,n,that.key_handler);else{var c=localStorage.getItem(n.name),u=l;if(c){c=that.parseJSON(c);var h=(new Date).getTime(),f=c.time||0,g=864e5;h-f<g&&100!==c.percent&&n.size===c.total?(n.percent=c.percent,n.loaded=c.offset,d=c.ctx,p.isResumeUpload=!0,p.resumeFilesize=c.offset,c.offset+u>n.size&&(u=n.size-c.offset)):localStorage.removeItem(n.name)}p.startTime=(new Date).getTime();var v={},b=that.detectIEVersion();b&&b<=9&&(v.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),t.setOption({url:qiniuUploadUrl+"/mkblk/"+u,multipart:!1,chunk_size:l,required_features:"chunks",headers:{Authorization:"UpToken "+r(n)},multipart_params:v})}}),logger.debug("bind BeforeUpload event"),m.bind("UploadProgress",function(e,t){logger.trace("UploadProgress event activated"),p.currentTime=(new Date).getTime();var n=p.currentTime-p.startTime,i=t.loaded||0;p.isResumeUpload&&(i=t.loaded-p.resumeFilesize),t.speed=(i/n*1e3).toFixed(0)||0}),logger.debug("bind UploadProgress event"),m.bind("ChunkUploaded",function(e,t,n){logger.debug("ChunkUploaded event activated"),logger.debug("file: ",t),logger.debug("info: ",n);var i=that.parseJSON(n.response);logger.debug("res: ",i),d=d?d+","+i.ctx:i.ctx;var o=n.total-n.offset,a=e.getOption&&e.getOption("chunk_size");a=a||e.settings&&e.settings.chunk_size,o<a&&(e.setOption({url:qiniuUploadUrl+"/mkblk/"+o}),logger.debug("up.setOption url: ",qiniuUploadUrl+"/mkblk/"+o)),e.setOption({headers:{Authorization:"UpToken "+r(t)}}),localStorage.setItem(t.name,that.stringifyJSON({ctx:d,percent:t.percent,total:n.total,offset:n.offset,time:(new Date).getTime()}))}),logger.debug("bind ChunkUploaded event");var g=qiniuUploadUrls.length,v=function(e){return g-- >0?(setTimeout(function(){that.resetUploadUrl(),e.status=plupload.QUEUED,m.stop(),m.start()},0),!0):(g=qiniuUploadUrls.length,!1)};return m.bind("Error",function(e){return function(t,n){logger.error("Error event activated"),logger.error("err: ",n);var i="",o=n.file;if(o){switch(n.code){case plupload.FAILED:i="上传失败。请稍后再试。";break;case plupload.FILE_SIZE_ERROR:var r=t.getOption&&t.getOption("max_file_size");r=r||t.settings&&t.settings.max_file_size,i="浏览器最大可上传"+r+"。更大文件请使用命令行工具。";break;case plupload.FILE_EXTENSION_ERROR:i="文件验证失败。请稍后重试。";break;case plupload.HTTP_ERROR:if(""===n.response){if(i=n.message||"未知网络错误。",!v(o))return;break}var a=that.parseJSON(n.response),s=a.error;switch(n.status){case 400:i="请求报文格式错误。";break;case 401:i="客户端认证授权失败。请重试或提交反馈。";break;case 405:i="客户端请求错误。请重试或提交反馈。";break;case 579:i="资源上传成功，但回调失败。";break;case 599:if(i="网络连接异常。请重试或提交反馈。",!v(o))return;break;case 614:i="文件已存在。";try{a=that.parseJSON(a.error),s=a.error||"file exists"}catch(l){s=a.error||"file exists"}break;case 631:i="指定空间不存在。";break;case 701:i="上传数据块校验出错。请重试或提交反馈。";break;default:if(i="未知错误。",!v(o))return}i=i+"("+n.status+"："+s+")";break;case plupload.SECURITY_ERROR:i="安全配置错误。请联系网站管理员。";break;case plupload.GENERIC_ERROR:i="上传失败。请稍后再试。";break;case plupload.IO_ERROR:i="上传失败。请稍后再试。";break;case plupload.INIT_ERROR:i="网站配置错误。请联系网站管理员。",m.destroy();break;default:if(i=n.message+n.details,!v(o))return}e&&e(t,n,i)}t.refresh()}}(c)),logger.debug("bind Error event"),m.bind("FileUploaded",function(t){return function(n,i,o){logger.debug("FileUploaded event activated"),logger.debug("file: ",i),logger.debug("info: ",o);var r=function(n,i,o){if(e.downtoken_url){var r=that.createAjax();r.open("POST",e.downtoken_url,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var e;try{e=that.parseJSON(r.responseText)}catch(a){throw"invalid json format"}var s={};plupload.extend(s,that.parseJSON(o),e),t&&t(n,i,that.stringifyJSON(s))}else m.trigger("Error",{status:r.status,response:r.responseText,file:i,code:plupload.HTTP_ERROR})},r.send("key="+that.parseJSON(o).key+"&domain="+e.domain)}else t&&t(n,i,o)},a=that.parseJSON(o.response);if(d=d?d:a.ctx,logger.debug("ctx: ",d),d){var l="";logger.debug("save_key: ",e.save_key),e.save_key||(l=s(n,i,that.key_handler),l=l?"/key/"+that.URLSafeBase64Encode(l):"");var c="/fname/"+that.URLSafeBase64Encode(i.name);logger.debug("op.x_vars: ",e.x_vars);var u=e.x_vars,p="",h="";if(void 0!==u&&"object"==typeof u)for(var f in u)u.hasOwnProperty(f)&&("function"==typeof u[f]?p=that.URLSafeBase64Encode(u[f](n,i)):"object"!=typeof u[f]&&(p=that.URLSafeBase64Encode(u[f])),h+="/x:"+f+"/"+p);var g,v=qiniuUploadUrl+"/mkfile/"+i.size+l+c+h,b=that.detectIEVersion();b&&b<=9?(g=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=e.flash_swf_url):g=that.createAjax(),g.open("POST",v,!0),g.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),g.setRequestHeader("Authorization","UpToken "+that.token);var _=function(){if(logger.debug("ajax.readyState: ",g.readyState),4===g.readyState){localStorage.removeItem(i.name);var e;200===g.status?(e=g.responseText,logger.debug("mkfile is success: ",e),r(n,i,e)):(e={status:g.status,response:g.responseText,file:i,code:-200},logger.debug("mkfile is error: ",e),m.trigger("Error",e))}};b&&b<=9?g.bind("readystatechange",_):g.onreadystatechange=_,g.send(d),logger.debug("mkfile: ",v)}else r(n,i,o.response)}}(u)),logger.debug("bind FileUploaded event"),m.init(),logger.debug("invoke uploader.init()"),logger.debug("init uploader end"),m},this.getUrl=function(e){if(!e)return!1;e=encodeURI(e);var t=this.domain;return"/"!==t.slice(t.length-1)&&(t+="/"),t+e},this.imageView2=function(e,t){var n=e.mode||"",i=e.w||"",o=e.h||"",r=e.q||"",a=e.format||"";if(!n)return!1;if(!i&&!o)return!1;var s="imageView2/"+n;return s+=i?"/w/"+i:"",s+=o?"/h/"+o:"",s+=r?"/q/"+r:"",s+=a?"/format/"+a:"",t&&(s=this.getUrl(t)+"?"+s),s},this.imageMogr2=function(e,t){var n=e["auto-orient"]||"",i=e.thumbnail||"",o=e.strip||"",r=e.gravity||"",a=e.crop||"",s=e.quality||"",l=e.rotate||"",c=e.format||"",u=e.blur||"",d="imageMogr2";return d+=n?"/auto-orient":"",d+=i?"/thumbnail/"+i:"",d+=o?"/strip":"",d+=r?"/gravity/"+r:"",d+=s?"/quality/"+s:"",d+=a?"/crop/"+a:"",d+=l?"/rotate/"+l:"",d+=c?"/format/"+c:"",d+=u?"/blur/"+u:"",t&&(d=this.getUrl(t)+"?"+d),d},this.watermark=function(e,t){var n=e.mode;if(!n)return!1;var i="watermark/"+n;if(1===n){var o=e.image||"";if(!o)return!1;i+=o?"/image/"+this.URLSafeBase64Encode(o):""}else{if(2!==n)return!1;var r=e.text?e.text:"",a=e.font?e.font:"",s=e.fontsize?e.fontsize:"",l=e.fill?e.fill:"";if(!r)return!1;i+=r?"/text/"+this.URLSafeBase64Encode(r):"",i+=a?"/font/"+this.URLSafeBase64Encode(a):"",i+=s?"/fontsize/"+s:"",i+=l?"/fill/"+this.URLSafeBase64Encode(l):""}var c=e.dissolve||"",u=e.gravity||"",d=e.dx||"",p=e.dy||"";return i+=c?"/dissolve/"+c:"",i+=u?"/gravity/"+u:"",i+=d?"/dx/"+d:"",i+=p?"/dy/"+p:"",t&&(i=this.getUrl(t)+"?"+i),i},this.imageInfo=function(e){if(!e)return!1;var t,n=this.getUrl(e)+"?imageInfo",i=this.createAjax(),o=this;return i.open("GET",n,!1),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(t=o.parseJSON(i.responseText))},i.send(),t},this.exif=function(e){if(!e)return!1;var t,n=this.getUrl(e)+"?exif",i=this.createAjax(),o=this;return i.open("GET",n,!1),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(t=o.parseJSON(i.responseText))},i.send(),t},this.get=function(e,t){return!(!t||!e)&&("exif"===e?this.exif(t):"imageInfo"===e&&this.imageInfo(t))},this.pipeline=function(e,t){var n,i,o="[object Array]"===Object.prototype.toString.call(e),r="";if(o){for(var a=0,s=e.length;a<s;a++){if(n=e[a],!n.fop)return!1;switch(n.fop){case"watermark":r+=this.watermark(n)+"|";break;case"imageView2":r+=this.imageView2(n)+"|";break;case"imageMogr2":r+=this.imageMogr2(n)+"|";break;default:i=!0}if(i)return!1}if(t){r=this.getUrl(t)+"?"+r;var l=r.length;"|"===r.slice(l-1)&&(r=r.slice(0,l-1))}return r}return!1}}window.localStorage||(window.localStorage={setItem:function(e,t){createCookie(e,t,30)},getItem:function(e){return readCookie(e)},removeItem:function(e){createCookie(e,"",-1)}});var Qiniu=new QiniuJsSDK;global.Qiniu=Qiniu,global.QiniuJsSDK=QiniuJsSDK}(window),define("web_qui_quiupload_qiniu",function(){}),define("web_qui_quiupload",["plupload","web_qui_quiupload_qiniu"],function(){"use strict";function e(e){this.upopt={browse_button:"",container:"",dragdrop:!1,drop_element:"",max_file_size:"100mb",runtimes:"html5,flash,html4",flash_swf_url:"../../../qcross/static/models/basic/js/plupload/Moxie.swf"/*tpa=http://common1.qyerstatic.com/qcross/static/models/basic/js/plupload/Moxie.swf*/,multi_selection:!0,chunk_size:"4mb",max_retries:3,qyer_token_url:"http://common1.qyerstatic.com/qcross/www/api.php?action=getAlbumToken",domain:"//pic.qyer.com/",auto_start:!0,token_format:function(e){return e.data.tk=e.data.token,e},init:{FilesAdded:function(e,t){},BeforeUpload:function(e,t){},UploadProgress:function(e,t){},UploadComplete:function(){},FileUploaded:function(e,t,n){},Key:function(e,t){var n,i=[];return i.push(window.QYER.uid),i.push((new Date).getTime()),i.push(parseInt(1e4*Math.random())),n=i.join(""),t.key=n,n},Error:function(e,t,n){var i="";if(t)switch(t.code){case-100:i="Silverlight加载失败";break;case-300:case-400:i="无法打开文件";break;case-600:i="图片必须小于"+e.getOption("max_file_size");break;case-601:i="文件扩展名不正确";break;default:i="未知错误"}e.trigger("UploadError",t,i)}}},this.init(e)}return e.prototype={init:function(e){this.upopt=$.extend(!0,this.upopt,e||{}),this._getUpToken()},_getUpToken:function(){var e=this;$.getJSON(e.upopt.qyer_token_url,function(t){if(0!==t.error_code)throw new Error(t.data);e.upopt.uptoken=t.data.token||t.data.tk,t.data.domain&&e.upopt.domain==t.data.domain,e.uploader=Qiniu.uploader(e.upopt),$(e).trigger("uploadready")})}},e}),define("common/component/footprint/js/sourceType",[],function(){var e={"C-des-leftTopBtn":10,"C-des-beenTo":11,"C-des-bottomInput":12,"C-des-batchComment":{visited:13,unvisited:14,search:16},"C-des-batchCommentSearch":16,"C-profile-cityFootMarkDone":17,"C-profile-allFootmarkRecommend":21,"C-profile-allBeenBatchComment":{visited:22,unvisited:28},"C-profile-allBeenBatchCommentSearch":26,"C-profile-batchComment":{visited:23,unvisited:24,search:26},"C-profile-batchCommentSearch":26,"C-poi-create":20,"C-M-poiDetail":51,"C-M-poiDetailDock":52,"C-M-IWantToComment":53,"C-other-extract":2,"C-other-translate":1};return e}),define("common/ui/textArea/textArea",[],function(){function e(e){this.$obj=e.$obj,this.timer=null,this.option=e.option,this.init()}var t=jQuery,n=[".qui-textArea {zoom: 1; }",".qui-textArea .red { color: red; }",".qui-textArea textarea,",".qui-textArea input { word-break:break-all; transition: height 0.2s; -webkit-transition: height 0.2s; -moz-transition: height 0.2s; -ms-transition: height 0.2s; box-sizing: border-box; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; -ms-box-sizing: border-box; }",".qui-textArea .autoHeight { overflow: hidden; }"].join("");window.qyerUtil.insertStyle(n),e.prototype={$obj:null,$textarea:null,$cloneTextarea:null,initHeight:null,maxHeight:null,timer:null,option:null,init:function(){this.$textarea=this.$obj.find("textarea").size()?this.$obj.find("textarea"):this.$obj.find("input"),this.$obj.attr("data-width")&&(this.$textarea.css("width",this.$obj.attr("data-width")),this.initHeight=this.$obj.attr("data-height")||this.$textarea.outerHeight()),this.$obj.attr("data-height")&&(this.$textarea.css("height",this.$obj.attr("data-height")),this.initWidth=this.$obj.attr("data-width")||this.$textarea.outerWidth()),this.option&&this.option.autoIncreaseHeight===!0&&(this.$cloneTextarea=this.createClone(this.$textarea)),this.$obj.show(),this.updateUI(),this.bindEvent()},createClone:function(e){if(e){var t=this.$textarea.clone(!0);return t.css({position:"absolute",left:"-9999em",overflow:"auto"}),t.insertAfter(e),t}},bindEvent:function(){var e=this;this.$obj.keyup(function(t){e.registEvent()})},registEvent:function(){var e=this;window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){e.updateUI(!0)},100)},updateUI:function(e){var n=this.$textarea,i=this.$cloneTextarea,o=this.$obj.find(".max"),r=this.$obj.find(".min"),a=this.$obj.find(".current"),s=(this.$obj.find(".exceed"),this.option.max),l=this.option.min,c=n.val().length;if(i){var u,d;i[0].value=n.val(),u=parseInt(i[0].scrollHeight,10),d=t.isNumeric(this.$obj.attr("data-max-height"))?this.$obj.attr("data-max-height"):99999,u>this.initHeight?(n.addClass("autoHeight"),u>=d&&(u=d,n.removeClass("autoHeight"))):u=this.initHeight,n.css("height",u),u=d=null}s==-1?c<l?(a.addClass("red"),0==c&&a.removeClass("red")):a.removeClass("red"):c<l||c>s?(a.addClass("red"),0==c&&a.removeClass("red")):a.removeClass("red"),a.html(c),o.html(s),r.html(l),$aTextArea=i=o=a=$left=s=l=c=left=null},isValidate:function(){var e=this.$obj.find("textarea").val().length;return this.option.max==-1?e>=this.option.min:e>=this.option.min&&e<=this.option.max},getContent:function(){return this.$obj.find("textarea")[0]},setValue:function(e){this.$textarea.val(e),this.$cloneTextarea.val(e),this.updateUI(!0)},getTextArea:function(){return this.$obj.find("textarea")[0]},unload:function(){this.$cloneTextarea.remove()},reset:function(){this.$textarea.val(""),this.$cloneTextarea.val(""),this.$obj.find(".current").html(0)}},t.fn.extend({qyerTextArea:function(n){var i,o;if(i={isValidate:function(e){return e.data("_qyerTextArea").isValidate()},getValue:function(e){return e.data("_qyerTextArea").getTextArea().value},unload:function(e){e.data("_qyerTextArea").unload()},reset:function(e){e.data("_qyerTextArea").setValue("")},setValue:function(e,t){e.data("_qyerTextArea").setValue(t)}},o=t.type(n),"object"==o||"undefined"==o)t.each(this,function(i,o){var r,a;r=t(o),a=t.extend({},n),a.max="undefined"http://common1.qyerstatic.com/place/js/poi/!=typeof a.max?a.max:-1,a.min="undefined"http://common1.qyerstatic.com/place/js/poi/!=typeof a.min?a.min:0,a.width=1==t.isNumeric(r.attr("data-width"))?r.attr("data-width"):null,a.height=1==t.isNumeric(r.attr("data-height"))?r.attr("data-height"):null,r.data("_qyerTextArea")||r.data("_qyerTextArea",new e({$obj:r,option:a})),r=a=null});else if("string"==o){var r,a,s=[];if(a=arguments,t.each(this,function(e,o){if(r=t(o),i[n]){var l=qyerUtil.sliceArguments(a,1);l.unshift(r),s.push(i[n].apply(r,l)),l=null}}),r=a=null,s.length)return 1==s.length?s[0]:s}return i=o=null,this}})}),define("common/basic/js/require-css!common/ui/inputValidation/inputValidation",[],function(){}),define("common/ui/inputValidation/inputValidation",["css!common/ui/inputValidation/inputValidation"],function(){function e(e,n){this.$obj=t(e),this.option=n,this.init()}var t=jQuery;e.prototype={$obj:null,$textDiv:null,option:null,init:function(){var e=this;this.setDefault(),this.option.blurAutoCheck!==!1&&this.$obj.blur(function(){e.check()}),this.$obj.focus(function(){e.clearTip()})},setDefault:function(){switch(this.option.defaultType){case"mail":this.option.exp=/^([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,6}$/,this.option.text=this.option.text||"邮箱地址格式错误";break;case"phone":this.option.exp=/^1[3|4|5|7|8][0-9]\d{4,8}$/,this.option.text=this.option.text||"手机号码格式错误";break;case"identityID":this.option.exp=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,this.option.text=this.option.text||"身份证号码格式错误";break;case"async":var e=this;this.option.exp=function(){return e.$obj.addClass("ui3_input_icon_loading"),e.$obj.removeClass("ui3_input_icon_error ui3_input_icon_ok"),e.option.asyncCheck(e.$obj.val(),function(t){setTimeout(function(){e.$obj.removeClass("ui3_input_icon_loading"),t?(e.option.text=t,e.addTip(),e.$obj.addClass("ui3_input_icon_error")):e.$obj.addClass("ui3_input_icon_ok")},10)}),!0}}},check:function(){var e=!1;switch(t.type(this.option.exp)){case"regexp":this.option.exp.lastIndex=0,e=this.option.exp.test(this.$obj.val());break;case"function":e=this.option.exp(this.$obj.val())}return this[e?"clearTip":"addTip"](),e},clearTip:function(){this.$obj.removeClass("qui-errorip ui3_input_icon_error"),this.$textDiv&&(this.$textDiv.remove(),this.$textDiv=null)},addTip:function(){this.$obj.addClass("qui-errorip"),this.$obj.hasClass("ui3_input")&&this.$obj.addClass("ui3_input_icon_error"),this.$textDiv&&this.$textDiv.remove();var e="qui-errorip-textDiv"+(this.option.style||"");this.$textDiv=t('<div class="'+e+'"><div class="tip"> <p class="a1"></p> <p class="a2"></p> </div> <div class="text">'+this.option.text+"</div> </div>");var n=this.$obj[this.option.parent?"position":"offset"]();if(1==this.option.style){this.$textDiv.appendTo(this.option.parent||document.body);var i=t(this.option.parent||document.body).outerWidth();i-=n.left,i-=this.$obj.outerWidth(),i=i-this.$textDiv.outerWidth()/2+16,this.$textDiv.css({right:i,top:n.top-25})}else this.$textDiv.css({left:n.left+10,top:n.top+this.$obj.outerHeight()-1}),this.$textDiv.appendTo(this.option.parent||document.body)},clear:function(){this.clearTip()}},t.fn.extend({qyerInputValidation:function(n){var i,o=!1,r=this;return t.each(this,function(){i=t(this),i.data("__errorTip__")?"clear"==n?(o=r,i.data("__errorTip__").clear()):o=i.data("__errorTip__").check():i.data("__errorTip__",new e(this,n))}),r=null,n?this:o;
}})}),define("common/basic/js/require-css!common/component/poiComment/poiComment",[],function(){}),define("common/component/poiComment/poiComment",["common/ui/popup/popup","web_qui_quiupload","common/component/footprint/js/sourceType","common/ui/textArea/textArea","common/ui/inputValidation/inputValidation","css!common/component/poiComment/poiComment.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/component/poiComment/poiComment.css*/],function(e,t,n){var i={settings:{saveDataSetting:{data:{}},onShow:!1,onHide:!1,onSucceed:null,onCancel:null}};return i.inition=function(e){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();$.extend(this.settings,e);return this.settings.ajaxArgu?(this.getData(this.settings,this.createDOM),!1):void(this.settings.data&&this.createDOM(this.settings.data,this.settings))},i.getData=function(e,t){var e=e,n=this;$.ajax(e.ajaxArgu).done(function(i){n.settings.saveDataSetting.data.starLevel&&parseInt(n.settings.saveDataSetting.data.starLevel,10)>0?i.data.starLevel=parseInt(n.settings.saveDataSetting.data.starLevel,10):i.data.starLevel=i.data.starLevel,t.call(n,i.data,e)}).fail(function(e){})},i.createDOM=function(t,n){var t=t,n=n,o=t.imgUrl||"../../../../common2.qyerstatic.com/place/common/component/poiComment/images/poi_200_133.png"/*tpa=http://common2.qyerstatic.com/place/common/component/poiComment/images/poi_200_133.png*/,r=t.poiLink||"javascript:void(0)",a=t.cnName||t.enName,s=t.enName&&t.cnName?t.enName:"",l=t.starLevel||0,c=t.comment||"",u=$("<div/>",{"class":"qui-siglComment"}),d=$("<a/>",{href:r,"class":"siglComment-title"}).appendTo(u);$("<img/>",{src:o,width:80,height:80}).appendTo(d);var p=$("<div/>",{"class":"siglComment-info"}).appendTo(u);$('<p class="siglComment-cn"><a href="'+r+'">'+a+"</a></p>").appendTo(p),$('<p class="siglComment-en"><a href="'+r+'">'+s+"</a></p>").appendTo(p);for(var h=$("<div/>",{"class":"siglComment-stars",starlevel:l}).appendTo(p),f=0;f<5;f++)$('<span class="star"></span>').appendTo(h);$('<em class="level">点击星星为它评分</em>').appendTo(h);var m=$("<div/>",{"class":"siglComment-detail","data-width":"638","data-height":"104"}).appendTo(u);$("<textarea/>",{"class":"ui3_textarea",placeholder:"这里有哪些亮点？哪些方面还不够好？大家都期待着你的点评"}).val(c).appendTo(m),$('<div class="siglComment-camera" id="swf_upload_container_c"><label id="uploader">分享照片</label>有图有真相的点评最受欢迎！</div>').appendTo(m),$('<ul class="siglComment-photolist" style="display:none" id="siglComment-photolist"><li class="add" id="swf_upload_container1"><span id="siglCommentPhotoUp"></span></li></ul>').appendTo(m),$('<div class="tips"><span class="current"></span> / <span class="min"></span> ~ <span class="max"></span></div>').appendTo(m);var g=e.show({title:" ",contentHTML:u,width:690,okText:"发布",onAfterHide:function(){n.onHide&&n.onHide.call(g)},onCancel:function(){n.onCancel&&n.onCancel.call(g)},onOK:function(){var t=$(g.getContent()),i=t.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation(),o=t.find(".siglComment-stars").attr("starlevel");if(!(o>0))return requirejs(["common/ui/tip/tip"],function(e){e.tip({text:"点击星星为它评分",type:"warning"})}),!1;if(i){e.setOption({showLoadBtn:!0,showOKBtn:!1});({starlevel:o,comment:t.find(".siglComment-detail").find(".ui3_textarea").val()});return n.saveDataSetting.data.starlevel=o,n.saveDataSetting.data.comment=t.find(".siglComment-detail").find(".ui3_textarea").val(),n.saveDataSetting.data.imgs=$.map($("#siglComment-photolist li[tid]"),function(e){return $(e).attr("tid")}).join(","),$.ajax(n.saveDataSetting).done(function(e){n.onSucceed&&n.onSucceed.call(g,e),g.hide()}).fail(function(t){n.onFail&&n.onFail.call(g,t),e.setOption({showLoadBtn:!1,showOKBtn:!0})}),!1}return!1},onBeforeHide:function(){var e=$(g.getContent());e.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation("clear")}});i.popup=g,i.bindEvent.call(g.getContent()),n.onShow&&n.onShow.call(g)},i.bindEvent=function(){var e=$(this);e.find(".siglComment-detail").qyerTextArea({max:2e3,min:30,autoIncreaseHeight:!0}),e.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation({blurAutoCheck:!1,text:"点评不少于30字，不超过2000字",exp:/^(\s|\S){30,2000}$/im});var t=e.find(".siglComment-stars"),n=["很差","差","一般","好","很好"],i=t.attr("starlevel");t.find(".star").removeClass("star-on"),t.find(".level").html("点击星星为它评分"),i>0&&(t.find(".star:lt("+i+")").addClass("star-on"),t.find(".level").html(n[parseInt(i,10)-1])),t.off("mouseleave").on("mouseleave",function(){$(this).find(".star").removeClass("star-on"),t.find(".level").html("点击星星为它评分");var e=t.attr("starlevel");e>0&&($(this).find(".star:lt("+e+")").addClass("star-on"),t.find(".level").html(n[parseInt(e,10)-1]))}),t.find(".star").each(function(e){var i=e;$(this).hover(function(){t.find(".star").addClass("star-on"),t.find(".star:gt("+i+")").removeClass("star-on"),t.find(".level").html(n[i])}).click(function(){t.attr("starlevel",i+1)})}),$("#swf_upload_container_c label,#siglCommentPhotoUp").off("click").on("click",function(){require(["common/component/uploadPopup/uploadPopup"],function(e){var t=new e({max:20,items:[{model:"local",opt:{headOpt:{models:["list","create"]}}},{model:"myphoto",opt:{headOpt:{models:["list"]}}}]});t.show(),$(t).on("fireuploadimage",function(e,n){if(t.hide(),"string"==typeof n)var n=JSON.parse(n);var i=$("#siglComment-photolist"),o=i.css("display","block");$.each(n,function(e,t){var n=$('<li tid="'+t.id+'">\t\t\t\t\t\t\t<img src="'+t.url+'/80"/*tpa=http://common1.qyerstatic.com/place/js/poi/'+t.url+'/80*//>\t\t\t\t\t\t\t<span class="close">\t\t\t\t\t\t\t</span>\t\t\t\t\t\t</li>').insertBefore(o.find(".add"));n.find(".close").click(function(e){e.stopPropagation(),$(this).parent().remove()})})})})})},i.show=function(e){i.inition({ajaxArgu:{data:{poiid:e.poiid},url:"http://common1.qyerstatic.com/poi.php?action=popupPoiComment",type:"post",dataType:"json"},flash_swf_url:"../../../qcross/static/models/basic/js/plupload/Moxie.swf"/*tpa=http://common1.qyerstatic.com/qcross/static/models/basic/js/plupload/Moxie.swf*/,saveDataSetting:{url:"http://common1.qyerstatic.com/qcross/place/index.php?action=savePoiComment",type:"post",dataType:"json",data:{poiid:e.poiid,source_type:n[e.source_type],starLevel:e.starLevel}},onShow:e.onShow||e.onshow||!1,onHide:e.onHide||e.onhide||!1,onSucceed:e.onSuccess||e.onsuccess||e.onSucceed||e.onsucceed||!1,onCancel:e.oncancel||e.oncancel||!1})},i.hide=function(){i.settings.onCancel&&i.settings.onCancel.call(i.popup),e.hide()},i}),define("common/basic/js/require-css!common/widget/userbehavior/userbehavior",[],function(){}),define("common/widget/userbehavior/widget-userbehavior",["common/widget/widget","common/widget/userbehavior/config","common/service/userbehavior/userbehavior-service","common/widget/userbehavior/liketip","project/js/batch_add_footprint","common/component/poiComment/poiComment","css!common/widget/userbehavior/userbehavior.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/widget/userbehavior/userbehavior.css*/],function(e,t,n,i,o,r){return e.createClass({init:function(e,t){this.callSuper.apply(this,arguments),this.params=e,"number"http://common1.qyerstatic.com/place/js/poi/==typeof e.type?this.type=this.place["name"+e.type]:"string"==typeof e.type?this.type=e.type:this.type=this.place.name1,this.id=e.id,this.getDom()},toggleLoading:function(e){this.$el[e?e:"toggleClass"]("place-ubloading")},events:[["click","handle",">ul>li"],["click","submenu",">ul>li a"]],getDom:function(){this.toggleLoading("addClass"),qyerUtil.isLogin()?this.getBaseData():this.setDom(t.getDom(this.type,this.id))},getBaseData:function(){var e=this;n.getBehaviorInfo({tp:e.type,id:e.id},$.proxy(e.getBaseDataSuccess,e),$.proxy(e.getBaseDataError,e))},getBaseDataSuccess:function(e){var n=this,i=e.data.result;n.setDom(t.getDom(n.type,n.id,{planto:i.planto,beento:i.beento,lived:i.lived}))},getBaseDataError:function(e){this.$el.hide()},setDom:function(e){this.$dom=$(e),this.$el.append(this.$dom),this.toggleLoading("removeClass"),this.params.exClass&&this.$dom.addClass(this.params.exClass),new i},preventUnnecessary:function(e,t){return t===!0?void $(e).attr("data-on","no"):"yes"==$(e).attr("data-on")||($(e).attr("data-on","yes"),!1)},handle:function(e){if(!qyerUtil.isLogin())return qyerUtil.doLogin(),!1;var t=this,i=$(e.currentTarget);switch(i.attr("data-type")){case t.planto:case t.beento:case t.lived:if(t.preventUnnecessary(e.currentTarget))return!1;var o=i.attr("data-type"),r={type:t.reversePlace[t.type],id:t.id,oper:o};r[o]=i.attr("data-status")-0?0:1,n.feeling(r,$.proxy(function(t){this.handleSuccess(e.currentTarget,t)},this),$.proxy(function(t){this.handleError(e.currentTarget,t)},this))}},handleSuccess:function(e,n){var i=$(e),o=this,r=i.attr("data-status")-0,a=i.attr("data-type");switch(i.attr("data-status",r?0:1).attr("data-bn-ipg",t[a]["data-bn-ipg"]({type:o.type,id:o.id,status:r})).toggleClass("selected").find("span.fonts").text(t[a][r?"text":"sText"]),o.preventUnnecessary(e,!0),a){case o.beento:"country"!=o.type&&"city"!=o.type||r?"poi"!=o.type||r||o.writePoiComment():o.execAddToPlan(n.data.poi_not_count,n.data.isaddimpress);break;case o.lived:"country"!=o.type&&"city"!=o.type||r||require(["common/component/shareExp/shareExp"],function(e){e.show({id:o.id,type:o.type})})}},handleError:function(e,t){var n=this;this.preventUnnecessary(e,!0),requirejs(["common/ui/tip/tip"],function(e){e.tip({text:t.data.msg||n.errorTip,type:"warning"})})},execAddToPlan:function(e,t){var n=PLACE.TYPE,i=PLACE.PID;o(i,n,e,t)},writePoiComment:function(){var e=this;return!(!PLACE||!PLACE.CITYID)&&void r.show({poiid:e.id,source_type:"C-des-beento",onsucceed:function(e){requirejs(["common/component/switchRoute/switchRoute"],function(e){e.show({onOKFn:function(){requirejs(["common/component/footprint/js/comment"],function(e){e.commShow({city_id:PLACE.CITYID,source_type:"C-des-leftTopBtn"})})},onCancelFn:function(){window.location.reload()}})})}})},batchPoiComment:function(){requirejs(["common/component/footprint/js/comment"],function(e){e.commShow({city_id:PLACE.PID,source_type:"C-des-batchComment"})})},submenu:function(e){if(!qyerUtil.isLogin())return qyerUtil.doLogin(),!1;var t=$(e.currentTarget),n=this;if(!t.hasClass("js-cancelFootprint")){qyerUtil.doTrackCode(t.attr("data-bn-ipg"));var i=t.attr("href");return t.hasClass("js-poiComment")?"poi"http://common1.qyerstatic.com/place/js/poi/==n.type?n.writePoiComment():n.batchPoiComment():"string"==typeof i&&"javascript:void(0)"!=i&&(window.document.location.href=i),e.stopPropagation(),!1}}},{ATTRS:{planto:"planto",beento:"beento",lived:"lived",addToPlan:"addToPlan",place:{name4:"country",name1:"city",name2:"poi"},reversePlace:{poi:2,country:4,city:1},errorTip:"操作失败,请刷新页面重试"}})}),define("project/js/poi/histogram",[],function(){var e=function(e){this.$el=e||null,this.data=null,this.height="280px"};return e.prototype={show:function(){var e=this;this.$el.stop().slideDown("fast",function(){e.$el.css({height:e.height})})},hide:function(){var e=this;this.$el.stop().slideUp("fast",function(){e.$el.css({height:"0px"})})},set:function(){var e=this,t=["comment_first_percentage","comment_second_percentage","comment_three_percentage","comment_four_percentage","comment_five_percentage"].reverse();if(!this.data)return this;var n=e.$el.find("ul");$.each(t,function(t,i,o){if("number"==typeof e.data[i]){var r=n.find("li").eq(t);r.find(".number b").text(e.data[i]),r.find(".bar i").width(e.data[i]+"%")}}),e.$el.find(".seefull a").text("查看全部"+e.data.comment_count+"条点评")},init:function(e){$.extend(this,e),this.set()}},e}),function(e,t){var n=t(e);if("function"==typeof define&&define.amd)define("common/util/template/template",[],function(){return n});else if("object"==typeof exports)module.exports=n;else{var i=e.template;n.noConflict=function(){return e.template===n&&(e.template=i),n},e.template=n}}(this,function(e){"use strict";function t(e){if(null===e)return"null";var t=typeof e;if("object"!==t)return t;var n=_.call(e).slice(8,-1).toLowerCase();return"object"!==n?n:e.constructor==Object?n:"unkonw"}function n(e){return"object"===t(e)}function i(e){return"function"===t(e)}function o(e){return"string"===t(e)}function r(){for(var e=arguments[0]||{},t=x.call(arguments,1),n=t.length,i=0;i<n;i++){var o=t[i];for(var r in o)e[r]=o[r]}return e}function a(){var e=x.call(arguments);return r.apply(null,[{}].concat(e))}function s(e){return e}function l(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"&#92;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(e){return e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")}function u(e,t){"undefined"!=typeof console&&console[e]&&console[e](t)}function d(e){function t(){return"template.js error"}var n="template.js error\n\n";for(var i in e)n+="<"+i+">\n"+e[i]+"\n\n";return n+="<message>\n"+e.message+"\n\n",u("error",n),g.error(e),t.toString=function(){return'__code__ = "template.js error"'},t}function p(e,t){function n(e){return e=e.replace(/('|")/g,"\\$1").replace(/\n/g," "),';__code__ += ("'+e+'")\n'}function i(e){var t,n,i,r=/^(?:=|:(.*?)=)(.*)$/;return(n=r.exec(e))?(t=n[2],i=o(n[1])?n[1]:l?"h":"",';__code__ += __modifierMap__["'+i+'"](typeof ('+t+') !== "undefined" ? ('+t+') : "")\n'):";"+e+"\n"}for(var r="",a=t.sTag,s=t.eTag,l=t.escape,c=e.split(a),u=0,d=c.length;u<d;u++){var p=c[u].split(s);1===p.length?r+=n(p[0]):(r+=i(p[0],!0),p[1]&&(r+=n(p[1])))}return r}function h(e,t){var n=p(e,t),i='\n    var html = (function (__data__, __modifierMap__) {\n        var __str__ = "", __code__ = "";\n        for(var key in __data__) {\n            __str__+=("var " + key + "=__data__[\'" + key + "\'];");\n        }\n        eval(__str__);\n\n',o="\n        ;return __code__;\n    }(__data__, __modifierMap__));\n    return html;\n",r=i+n+o;r=r.replace(/[\r]/g," ");try{var a=new Function("__data__","__modifierMap__",r);return a.toString=function(){return n},a}catch(s){throw s.temp="function anonymous(__data__, __modifierMap__) {"+r+"}",s}}function f(e,t){function n(n){n=a(v,n);try{var o=i(n,b);return o=t.compress?c(o):o}catch(r){return r.name="RenderError",r.tpl=e,r.render=i.toString(),d(r)()}}t=a(g,t);try{var i=h(e,t)}catch(o){return o.name="CompileError",o.tpl=e,o.render=o.temp,delete o.temp,d(o)}return n.toString=function(){return i.toString()},n}function m(e,t){if("string"!=typeof e)return"";var i=f(e);return n(t)?i(t):i}var g={sTag:"<%",eTag:"%>",compress:!1,escape:!0,error:function(e){}},v={},b={"":function(e){return s(e)},h:function(e){return l(e)},u:function(e){return encodeURI(e)}},_={}.toString,x=[].slice;return m.config=function(e){return n(e)&&(g=r(g,e)),a(g)},m.registerFunction=function(e,t){return o(e)?i(t)?v[e]=t:v[e]:a(v)},m.unregisterFunction=function(e){return!!o(e)&&(delete v[e],!0)},m.registerModifier=function(e,t){return o(e)?i(t)?b[e]=t:b[e]:a(b)},m.unregisterModifier=function(e){return!!o(e)&&(delete b[e],!0)},m.__encodeHTML=l,m.__compress=c,m.__handelError=d,m.__compile=f,m.version="0.7.0",m}),define("common/util/template",["./util","./template/template"],function(e){return template.registerFunction("comm_poi_getstar",function(){return e.getStarHtml.apply(e,arguments)}),{registerFunction:template.registerFunction,render:function(e,t){return template(e,t||{})}}}),define("project/js/poi/poi-detail-tpl",[],function(){return{edit:['<div class="poi-detail" style="font-size:14px;margin:40px 0 0 0;">',"我点评过这里",'<a href="http://place.qyer.com/review/<%=id%>" target="_blank">查看/编辑</a>',"</div>"].join(""),write:['<div class="buttons">','<input type="button" class="poi-edit" id="addcomment" data-bn-ipg="place-poi-detail-writeReview"/>',"<%if(comment && (comment.comment_count - 0) >= 0 && comment.comment_count < 10){%>",'<div class="poi-reward">',"前10位点评有额外奖励~","</div>","<%}%>","</div>"].join(""),followedBeentoCount:['<li class="other">','<a href="<%=url%>" target="_blank"><%=followedBeentoCount%></a>位我关注的穷游er去过这里',"</li>"].join(""),comment:["<p>","我在<%=dateTime%>点评过这里",'<a href="http://place.qyer.com/review/<%=commentid%>" target="_blank">查看/编辑</a>',"</p>"].join(""),writeComment:["<h3>","点评<%=name%>","</h3>",'<div class="comment">','<input type="hidden" id="type" name="type" value="city"/>','<input type="hidden" id="typeid" name="typeid" value="2"/>','<input type="hidden" id="uid" name="uid" value="<%=uid%>">','<a class="avatar" href="<%=profile%>" target="_blank">','<img src="<%=avatar%>"/>',"</a>",'<div class="infos" id="g_comment">','<p class="poi-stars" starlevel="0">','<span class="single-star">',"</span>",'<span class="single-star">',"</span>",'<span class="single-star">',"</span>",'<span class="single-star">',"</span>",'<span class="single-star">',"</span>",'<span class="normal">',"点击星星为目的地评分","</span>","</p>",'<p class="content">','<textarea placeholder="这里有哪些亮点？哪些方面还不够好？大家都期待着你的点评" class="ui2_textarea autoHeight" style="width: 581px; height: 122px;"></textarea>',"</p>",'<div class="photo" id="upload">','<label id="sharephoto" data-bn-ipg="place-poi-writeReview-addPic">分享照片</label>',"<span>","有图有真相的点评最受欢迎!","</span>","</div>",'<ul class="photolist" id="photolist">','<li class="empty" id="empty"><span id="photoListEmpty"></span></li>',"</ul>",'<div class="tips">','<input type="button" value="发布" class="ui_button"/>','<span class="current">0</span>',"/",'<span class="min">1</span>',"~",'<span class="max">140</span>字',"</div>","</div>","</div>"].join(""),beento:['<h2 class="title">','<a href="<%=url%>" class="seeall" target="_blank">查看全部>></a>','<span class="golden"><%=listCount%></span>位穷游er去过这里',"</h2>",'<div class="avatars">',"<%for(var i = 0, item = null; item = lists[ i++ ]; ){%>",'<a uid="<%=item.user_id%>" href="<%=item.url%>" title="<%=item.user_name%>" data-bn-ipg="place-poi-beenToUser" target="_blank">','<img src="<%=item.pic%>"/>',"</a>","<%}%>","</div>"].join("")}}),define("common/basic/js/require-css!common/ui/popup2/popup",[],function(){}),define("common/ui/popup2/popup",["css!common/ui/popup2/popup.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/ui/popup2/popup.css*/],function(){function e(e){return this.option=e,this.initUI(),this.ui.setUIDefault(this.option),this}var t=jQuery;return e.prototype={option:null,ui:null,initUI:function(){var e=this.ui={$ui:null,$content:null,$box:null,$title:null,$okBtn:null,$cancelBtn:null,$loadBtn:null,$closeIcon:null,defaultWidth:"auto"},n=['<div class="qui-popup2" style="display:none">',"<div>",'<div class="qui-popup2-dt">','<div class="qui-popup2-box">','<div class="qui-popup2-closeIcon">&nbsp;</div>','<div class="qui-popup2-box-title">title</div>','<div class="qui-popup2-box-content">',"</div>",'<div class="qui-popup2-box-bottom">',"&nbsp;",'<input class="qui-popup2-cancelBtn ui_button_cancel" type="button" value="取消" />  ','<input class="qui-popup2-okBtn ui_button" type="button" value="确定" />  ','<input class="qui-popup2-loadingBtn  ui_button_load" type="button" value="" />  ',"</div>","</div>","</div>","</div>","</div>"].join("");return e.$ui=t(n),e.$content=e.$ui.find(".qui-popup2-box-content"),e.$box=e.$ui.find(".qui-popup2-box"),e.$title=e.$ui.find(".qui-popup2-box-title"),e.$okBtn=e.$ui.find(".qui-popup2-okBtn"),e.$cancelBtn=e.$ui.find(".qui-popup2-cancelBtn"),e.$loadBtn=e.$ui.find(".qui-popup2-loadingBtn"),e.$closeIcon=e.$ui.find(".qui-popup2-closeIcon"),e.$bottom=e.$ui.find(".qui-popup2-box-bottom"),e.$ui.appendTo(document.body),e.option=this.option,e=n=null,t.extend(this.ui,{setWidth:function(e){this.$box.animate({width:e},300)},setUIDefault:function(e){this.$ui[0].className="qui-popup2",e.exClassName&&this.$ui.addClass(e.exClassName),e.iframeSrc?this.$content.html('<iframe src="'+e.iframeSrc+'"  scrolling="auto" style="height:'+(e.iframeHeight||300)+'px;"  />'):this.$content.html(e.contentHTML||"&nbsp;"),this.$title.html(e.title||"Title"),this.$box.css("width",e.width||this.defaultWidth),this.$title[e.showTitle===!1?"hide":"show"](),this.$okBtn.val(e.okText||"确定"),this.$cancelBtn.val(e.cancelText||"取消"),this.$okBtn[e.showOKBtn===!1?"hide":"show"](),this.$okBtn.removeAttr("data-bn-ipg"),this.$cancelBtn[e.showCancelBtn===!1?"hide":"show"](),this.$cancelBtn.removeAttr("data-bn-ipg"),this.$loadBtn[e.showLoadBtn===!0?"show":"hide"](),this.$loadBtn.removeAttr("data-bn-ipg"),this.$ui.find(".qui-popup2-closeIcon").removeAttr("data-bn-ipg"),this.$closeIcon[e.showCloseIcon===!1?"hide":"show"](),e.showOKBtn===!1&&e.showCancelBtn===!1&&this.$bottom.hide()},show:function(){var e={},n={top:0},i=this;t.support.leadingWhitespace&&(e.opacity=1,n.opacity=1),this.$ui.css("display","block").animate(e,200,function(){i.$box.css("top",-30).animate(n,200,function(){i.option.onShow&&i.option.onShow(),e=n=i=null})})},hide:function(e){var n={top:-30},i={},o=this;o.option&&o.option.onBeforeHide&&o.option.onBeforeHide()===!1||(t.support.leadingWhitespace&&(n.opacity=0,i.opacity=0),this.$box.animate(n,200,function(){o.$ui.animate(i,200,function(){e?o.$ui.hide():o.$ui.remove(),o.option&&o.option.onAfterHide&&o.option.onAfterHide(),n=i=o=null})}))}}),this},show:function(){var e=this;return this.ui.$ui.undelegate("click").delegate(".qui-popup2-okBtn,.qui-popup2-cancelBtn,.qui-popup2-closeIcon","click",function(t){if(this.className.indexOf("qui-popup2-closeIcon")!=-1||this.className.indexOf("qui-popup2-cancelBtn")!=-1){if(e.option.onBeforeCancel&&!e.option.onBeforeCancel(t))return;e.option.onCancel&&e.option.onCancel()}else if(this.className.indexOf("qui-popup2-okBtn")!=-1&&e.option.onOK&&e.option.onOK()===!1)return;e.ui.hide()}),this.ui.show(),this},hide:function(e){return this.ui.hide(e),this},setContent:function(e){return this.ui.$content.html(e),this},getContent:function(){return this.ui.$content[0]},getButtons:function(){return{okBtn:this.ui.$okBtn[0],cancelBtn:this.ui.$cancelBtn[0],loadBtn:this.ui.$loadBtn[0],closeIcon:this.ui.$ui.find(".qui-popup2-closeIcon")[0]}},setOption:function(e){var n=this.ui,i={width:function(){n.setWidth(e.width)},showTitle:function(){n.$title[e.showTitle===!1?"hide":"show"]()},okText:function(){n.$okBtn.val(e.okText)},cancelText:function(){n.$cancelBtn.val(e.cancelText)},showOKBtn:function(){n.$okBtn[e.showOKBtn===!1?"hide":"show"]()},showCancelBtn:function(){n.$cancelBtn[e.showCancelBtn===!1?"hide":"show"]()},showLoadBtn:function(){n.$loadBtn[e.showLoadBtn===!1?"hide":"show"]()},title:function(){n.$title.html(e.title)},exClassName:function(){n.$ui[0].className="qui-popup2 "+e.exClassName},contentHTML:function(){e.iframeSrc||n.$content.html(e.contentHTML)},iframeSrc:function(){n.$content.html('<iframe src="'+e.iframeSrc+'"  scrolling="auto" style="height:'+(e.iframeHeight||300)+'px;" />')},iframeHeight:function(){n.$content.children("iframe").css("height",e.iframeHeight)},showCloseIcon:function(){n.$closeIcon[e.showCloseIcon===!1?"hide":"show"]()}};for(var o in e)this.option[o]=e[o],"function"==t.type(i[o])&&i[o]();n=i=null}},e}),define("common/basic/js/require-css!common/ui/tip/tip",[],function(){}),define("common/ui/tip/tip",["css!common/ui/tip/tip.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/ui/tip/tip.css*/],function(){function e(e){i.html(e.text||"&nbsp;"),n[0].className="qui-tip-box","error"http://common1.qyerstatic.com/place/js/poi/==e.type?n.addClass("qui-tip-box-error"):"warning"==e.type&&n.addClass("qui-tip-box-warning")}var t,n,i,o=jQuery;!function(){var e=['<div class="qui-tip" style="display:none;" >','<div class="qui-tip-box">','<span class="qui-tip-text fontYaHei">这里是提示文本</span>',"</div>","</div>"].join("");t=o(e),i=t.find(".qui-tip-text"),n=t.find(".qui-tip-box"),t.appendTo(document.body)}();var r={_timer:null,tip:function(n){return e(n),t.slideDown(200),window.clearTimeout(this._timer),this._timer=setTimeout(function(){t.slideUp(200)},n.time||3e3),this}};return r}),define("common/basic/js/require-css!common/component/uploadPopup/uploadPopup",[],function(){}),define("common/component/uploadPopup/uploadPopup",["common/ui/popup2/popup","web_qui_quiupload","common/ui/tip/tip","css!common/component/uploadPopup/uploadPopup.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/component/uploadPopup/uploadPopup.css*/],function(e,t,n){function i(e){this.init(e)}function o(e){this.init(e)}function r(e){this.init(e)}function a(e){this.init(e)}function s(e){this.init(e)}function l(e){this.init(e)}function c(e){this.init(e)}function u(e){this.init(e)}function d(e){this.init(e)}var p;p={getPhotoList:function(e){e.posturl="http://common1.qyerstatic.com/album.php?action=getMyAlbumList",qyerUtil.doAjax(e)},getLocalForKw:function(e){e.posturl="http://common1.qyerstatic.com/album.php?action=searchphotopoi",qyerUtil.doAjax(e)},getPhotos:function(e){e.posturl="http://common1.qyerstatic.com/album.php?action=getAlbumPhotoPage",qyerUtil.doAjax(e)},submitPhoto:function(e){e.posturl="http://common1.qyerstatic.com/album.php?action=popupwebupload",qyerUtil.doAjax(e)},savePhoto:function(e){e.posturl="http://common1.qyerstatic.com/album.php?action=saveUploadAlbumPhoto",qyerUtil.doAjax(e)}},i.prototype={tpl:"",label:"将照片保存到",init:function(e){$.extend(this,e),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){e.render()}),$(document).undelegate(e.node+" .source","change").delegate(e.node+" .source","change",function(){$(e).trigger("fireloaddata")})},getHtml:function(e){var t=this,n=[],i=[];p.getPhotoList({type:"get",onError:function(e){},onSuccess:function(o){if(o.data){i=o.data;for(var r=0;r<i.length;r++)n.push('<option value="'+i[r].id+'">'+i[r].name+"</option>")}t.tpl="<strong>"+t.label+'：</strong><select name="album_list" class="source">'+n.join("")+"</select>",t.dom=$(t.tpl),e&&e()}})},getCurPhoto:function(){return $(this.node).find(".source").val()},render:function(){var e=this;this.getHtml(function(){$(e.node).html(e.dom),$(e).trigger("fireloaddata")})},dispose:function(){$(this.parent).off("aftershow"),$(document).undelegate(this.node+" .source","change")}},o.prototype={init:function(e){$.extend(this,e||{}),this.bindEvent()},bindEvent:function(){},getHtml:function(){return'<strong>新建相册：</strong><div class="qyer_upload_new"><input name="album_new" maxlength="15" type="text" class="albumname" placeholder="输入新相册名，不超过15字"><div class="qyer_upload_new_error" id="swf_albumname_tips"><span></span><div class="icon_warn">相册名不能为空，请输入</div></div></div>'},getPhotoName:function(){var e=$(this.node).find(".albumname").val();return e?($(this.node).find(".qyer_upload_new_error").hide(),e):void $(this.node).find(".qyer_upload_new_error").show()},render:function(){var e=this;$(e.node).html(e.getHtml())}},r.prototype={param:{},init:function(e){$.extend(this,e||{}),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){e.render()}),$(document).undelegate(e.node+" input","input").delegate(e.node+" input","input",function(){var t=$(this).val();t&&e.getData(t)}),$(document).on("click",function(){$(e.node).find(".editphotopoisearch").hide()}),$(document).undelegate(e.node+" .editphotopoisearch .ui_album_poiSelect_search_list","click").delegate(e.node+" .editphotopoisearch .ui_album_poiSelect_search_list","click",function(){e.param.type=$(this).attr("type"),e.param.poiid=$(this).attr("data"),$(e.node).find("input").val($(this).text().trim())})},getData:function(e){var t=this;p.getLocalForKw({type:"get",data:{kw:e,format:"json-html",isnothaveimg:1},onError:function(e){n.tip({text:"获取位置错误",type:"error",time:1e3})},onSuccess:function(e){$(t.node).find(".editphotopoisearch").show().html(e.data)}})},getLocalParm:function(){return this.param},getHtml:function(){var e='<div class="qyer_upload_t_item"><a href="#"><img class="poi_icon" src="../../../../static.qyer.com/images/user/album/album_upload_found_icon.png"/*tpa=http://static.qyer.com/images/user/album/album_upload_found_icon.png*/ alt=""></a><input type="text" class="ui_input js_inputGap fl editpoiinfo" placeholder="为照片批量添加目的地位置" value="" autocomplete="off"><div class="ui_album_poiSelect_div editphotopoisearch tl"></div></div>';return e},render:function(){var e=this;$(e.node).html(e.getHtml())},dispose:function(){$(this.parent).off("aftershow"),$(document).undelegate(this.node+" input","input"),$(document).undelegate(this.node+" .editphotopoisearch .ui_album_poiSelect_search_list","click")}},a.prototype={models:["list","local","create"],status:"list",modelList:[],photolistOpt:{},init:function(e){$.extend(this,e||{}),this.modelList=[],this.initModels(),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){e.render()}),$(document).off("click",e.node+" .create_album").on("click",e.node+" .create_album",function(){"create"==e.status?($(this).html("新建相册"),e.photoList.render(),e.status="list"):(e.photoCreate.render(),$(this).html("选择相册"),e.status="create")})},initModels:function(){for(var e=this,t="",n=0;n<this.models.length;n++)t=this.models[n],"list"==t?(e.photoList=new i($.extend({parent:this,node:this.node+" .qyer_upload_myphoto_list"},e.photolistOpt)),e.modelList.push(e.photoList)):"local"==t?(e.photoLocal=new r({parent:this,node:this.node+" .qyer_upload_t_local"}),e.modelList.push(e.photoLocal)):"create"==t&&(e.photoCreate=new o({node:this.node+" .qyer_upload_myphoto_list"}),e.modelList.push(e.photoCreate))},getHtml:function(){var e='<div class="qyer_upload_myphoto_list"></div><div class="qyer_upload_t_local"></div><span class="fr qyer_upload_create"></span><div class="clear"></div>';return e},getHeadParams:function(){for(var e={},t="",n=0;n<this.models.length;n++)switch(this.models[n]){case"list":"list"==this.status&&(e.isnewalbum=0,e.album_new="",e.album_list=this.photoList.getCurPhoto());break;case"create":"create"==this.status&&(t=this.photoCreate.getPhotoName(),void 0!=t&&(e.isnewalbum=1,e.album_new=t));break;case"local":$.extend(e,this.photoLocal.getLocalParm())}return e},aftershow:function(){if(this.models.length>0)for(var e=0;e<this.models.length;e++)tmpModel=this.models[e],"create"==tmpModel&&$(this.node).find(".qyer_upload_create").html('或 <a class="create_album" href="javascript:void(0);">新建相册</a>');else $(this.node).hide()},render:function(){var e=this;$(e.node).html(e.getHtml()),$(this).trigger("aftershow")},dispose:function(){for(var e=0;e<this.modelList.length;e++)$(this.modelList[e]).trigger("dispose")}},s.prototype={tpl:'<div class="upload_file_item"><span class="filebg" ><em class="percent" style="width:__percent__;"></em></span><strong>__name__</strong><span class="fstatus cLightgray">__status__</span><span class="fr"><a href="javascript:;" class="_jscancelup" data-id="__id__">删除</a></span></div>',init:function(e){$.extend(this,e),this.initDom()},initDom:function(){var e=this.tpl.replace(/__percent__/gi,this.percent).replace(/__name__/,this.name).replace(/__status__/,this.getStatus()).replace(/__id__/,this.id);this.dom=$(e)},setProgress:function(e){this.progress=e},getStatus:function(){var e="";switch(this.status){case 0:e="等待中";break;case 1:e="准备上传";break;case 2:e="上传中";break;case 5:e="上传成功",this.dom.find(".fstatus").addClass("icon_finish")}return e},setStatus:function(e){this.status=e,this.dom.find(".fstatus").html(this.getStatus())},setPercent:function(e){this.percent=e,this.dom.find(".percent").css("width",e+"%")}};var h={list:[],init:function(e){$.extend(this,e||{}),this.list=[],this.dom=$("#"+this.id),this.dom.html=""},addFile:function(e){var t=new s(e);this.list.push(t),this.dom.append(t.dom)},removeFile:function(e){for(var t=0;t<this.list.length;t++)e==this.list[t].id&&this.list.splice(t,1)},getFile:function(e){for(var t=0;t<this.list.length;t++)if(e==this.list[t].id)return this.list[t];return null},dispose:function(){this.list=[]}};return l.prototype={headOpt:{},title:"本地上传",className:"qyer_upload_local",status:"disable",max:-1,init:function(e){$.extend(this,e||{}),this.photoHead=new a($.extend(this.headOpt,{parent:this,node:"."+this.className+" .qyer_upload_item_tit"})),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){$(e).trigger("aftershow")}),$(document).undelegate("._jscancelup","click").delegate("._jscancelup","click",function(){var t=$(this).attr("data-id"),n=$(this).parents(".upload_file_item"),i=e.upload.uploader.getFile(t);h.removeFile(t),e.upload.uploader.removeFile(i),e.upload.uploader.refresh(),n.remove(),e.toggleStatus()}),$(document).undelegate("."+e.className+" .ui_button","click").delegate("."+e.className+" .ui_button","click",function(){e.subUpFile()})},getHtml:function(){return'<div class="qyer_upload_local ui_tab_cnt_item"><div class="qyer_upload_item_tit"></div><!--上传照片 --><div class="qyer_upload_item_con"><!--上传照片按钮 --><div id="swf_upload_container_around"><div id="swf_upload_container" class="qyer_upload_upbtn"><div><a id="swfuploadbut" href="javascript:void(0);">+ 上传照片</a></div><p class="mt15" style="font-size:14px;font-weight:bold;color:#c9c9c9">支持JPG、JPEG、PNG格式，每张小于10M.</p></div><!--照片flash上传中 --><div id="album_submit_div" class="qyer_upload_item_loading" style="display:none;"><div class="qyer_upload_list" id="fsUploadProgress"><!--照片flash上传列表显示 --><div id="UploadResult" class="qyer_upload_list_status"></div></div><div class="p10 clearfix"><input type="button" id="album_submit" value="确定" class="fr ui_button_disabled" disabled="disabled"></div></div></div></div><div id="warn_tips" class="qyer_upload_layout_error"><img src="../../../../static.qyer.com/images/common/tpl/icon_warn.png"/*tpa=http://static.qyer.com/images/common/tpl/icon_warn.png*/ alt="" class="vm mr10"><span class="fontYaHei cLightgray f14">一次上传文件过多</span></div></div>';
},aftershow:function(){var e=this;h.init({id:"UploadResult"}),this.upload=new t({browse_button:"swfuploadbut",container:"swf_upload_container",drop_element:"swf_upload_container_around",filters:[{title:"images files",extensions:"jpg,jpeg,png"}],max_file_size:"20mb",multi_selection:1!=e.max,init:{FilesAdded:function(t,n){plupload.each(n,function(e){h.addFile(e)}),e.toggleStatus()},BeforeUpload:function(e,t){},UploadProgress:function(t,n){var i=h.getFile(n.id);i.setStatus(n.status),i.setPercent(n.percent),e.status="upload",e.toggleSubBtn()},UploadComplete:function(){e.status="ok",e.toggleSubBtn()},FileUploaded:function(e,t,n){var i=h.getFile(t.id);i.setStatus(t.status)},Key:function(e,t){var n=(new Date).getTime(),i=h.getFile(t.id);return n+=parseInt(1e3*Math.random()),n+=window.QYER?""+window.QYER.uid:"",i?i.key=n:t.key=n,n},UploadError:function(e,t,i){n.tip({text:i,type:"error",time:1e3})}}})},toggleStatus:function(){var e=this;h.list.length>0?($("#album_submit_div").show(),$("#swf_upload_container").hide()):(e.status="disable",$("#album_submit_div").hide(),$("#swf_upload_container").show(),e.toggleSubBtn())},toggleSubBtn:function(){var e=$("#album_submit");switch(this.status){case"disable":e.val("确定"),e.attr("disabled",!0),e.removeClass("ui_button").addClass("ui_button_disabled");break;case"upload":e.val("上传中...");break;case"ok":e.val("确定").attr("disabled",!1).removeClass("ui_button_disabled").addClass("ui_button")}},subUpFile:function(){var e,t=this,i=this.photoHead.getHeadParams(),o=h.list,r=[],a=[];void 0!=i.type&&(r=[i.type,i.poiid]);for(var s=0;s<o.length;s++)e={key:o[s].key,description:""},$.isEmptyObject(r)||(e.place=r),a.push(e);i.photo=a,t.status="disable",t.toggleSubBtn(),p.savePhoto({data:i,onSuccess:function(e){var n=e.data.photo,i=[];for(var o in n)i.push({id:o,url:n[o]});$(t).trigger("uploadimage",JSON.stringify(i)),t.parent.hide()},onError:function(e){n.tip({text:e.data.msg||e.data,type:"error",time:1e3})}})},dispose:function(){$(this.photoHead).trigger("dispose"),$(document).undelegate("._jscancelup","click"),$(this.parent).off("aftershow"),$(document).undelegate("."+this.className+" .ui_button","click"),h.dispose()}},c.prototype={headOpt:{},title:"从我的相册选择",className:"qyer_upload_mylist",dataList:[],max:-1,currentPage:1,pageSize:48,loadAjaxFlag:!0,scrollLoadOnly:!0,currentPhotosFlag:!0,init:function(e){$.extend(this,e||{}),this.photoHead=new a($.extend(this.headOpt,{parent:this,node:"."+this.className+" .qyer_upload_item_tit",photolistOpt:{label:"选择相册"}})),this.bindEvent()},bindEvent:function(){var e=this;$(e.photoHead.photoList).on("fireloaddata",function(){e.currentPhotosFlag=!0,e.currentPage=1,e.getData()}),$(this.parent).on("aftershow",function(){$(e).trigger("aftershow")}),$(document).undelegate("."+e.className+" .myPhotoList li","click").delegate("."+e.className+" .myPhotoList li","click",function(){if(e.max>0){var t=$("."+e.className).find("li[class='current']").length;!$(this).hasClass("current")&&t>=e.max?n.tip({text:"最多选择"+e.max+"张",type:"error",time:1e3}):$(this).toggleClass("current")}else $(this).toggleClass("current")}),$(document).undelegate("."+e.className+" #my_photo","click").delegate("."+e.className+" #my_photo","click",function(){e.dataList=[],$("."+e.className).find("li[class='current']").each(function(t,n){e.dataList.push({id:$(n).attr("data-id"),url:$(n).attr("data-url")})}),$(e).trigger("uploadimage",JSON.stringify(e.dataList))}),$(document).undelegate("."+e.className+" #cancel_my_photo","click").delegate("."+e.className+" #cancel_my_photo","click",function(){$(e).trigger("firecancel")})},getData:function(){var e=this,t=e.photoHead.photoList.getCurPhoto();p.getPhotos({type:"get",data:{type:"json",album:t,page:e.currentPage,size:e.pageSize},onSuccess:function(t){e.loadAjaxFlag=!0,e.maxPageCount=Math.ceil(t.data.count/e.pageSize);for(var n=t.data.res,i=(t.data.pager,t.data.count,[]),o=$("."+e.className).find(".myPhotoList"),r=0;r<n.length;r++)i.push('<li data-id="'+n[r].id+'" data-url="'+n[r].url+'"><img src="'+n[r].url+'/80" width="80" height="80" ><div class="icon_current"><span></span></div></li>');o.find(".x-loading-page").remove(),e.currentPhotosFlag&&(e.currentPhotosFlag=!1,o.html("")),o.append('<ul class="clearfix">'+i.join("")+"</ul>"),e.maxPageCount>e.currentPage&&o.append('<div class="x-loading-page"></div>'),e.scrollLoadOnly&&(e.scrollLoadOnly=!1,e.scrollLoad())},onError:function(){}})},scrollLoad:function(){var e=this,t=$("."+e.className).find(".myPhotoList"),n=t.height();t.on("scroll",function(){n+t.scrollTop()>=t[0].scrollHeight&&e.loadAjaxFlag&&e.currentPage<e.maxPageCount&&(e.loadAjaxFlag=!1,e.currentPage=e.currentPage+1,e.getData())})},getHtml:function(){return'<div class="qyer_upload_mylist ui_tab_cnt_item"><form id="selecg" name="upfile_form" action="http://common1.qyerstatic.com/album.php?action=inputupfile" method="post" enctype="multipart/form-data" target="check_file_frame"><div class="qyer_upload_item_tit"></div><!--上传照片 --><div class="qyer_upload_photo_list myPhotoList" ></div><div class="p10 clearfix qyer_upload_btn"><input type="button" value="确定" class="ui_button fr" id="my_photo"><input type="button" value="取消" class="ui_button_cancel mr10 fr" id="cancel_my_photo"></div></form></div>'},dispose:function(){$(this.photoHead.photoList).off("fireloaddata"),$(document).undelegate("."+this.className+" .myPhotoList li","click"),$(document).undelegate("."+this.className+" #my_photo","click"),$(document).undelegate("."+this.className+" #cancel_my_photo","click"),$(this.photoHead).trigger("dispose")}},u.prototype={headOpt:{},title:"网络图片",className:"qyer_upload_network",init:function(e){$.extend(this,e||{}),this.photoHead=new a($.extend(this.headOpt,{parent:this,node:"."+this.className+" .qyer_upload_item_tit"})),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).off("aftershow").on("aftershow",function(){$(e).trigger("aftershow")}),$(document).undelegate("#web_album_submit","click").delegate("#web_album_submit","click",function(){if("upload"!=e.status){var t=$("#web_img_url").val();/^http:\/\/([\w-]+\.)+[\w-]+(\/[\w-.\/?%&amp;=]*)?$/.test(t)?(e.status="upload",$(".qyer_upload_new_error").hide(),$(this).removeClass("ui_button").addClass("ui_button_disabled").val("上传中..."),e.uploadNetPhoto(t)):$(".qyer_upload_new_error").show()}})},getHtml:function(){return'<div class="qyer_upload_network ui_tab_cnt_item"><form id="web_photo_form"><input type="hidden" name="type" id="poitype_data" value=""><input type="hidden" name="isnewalbum" id="web_isnewalbum" value=""><input type="hidden" name="poiid" id="poiid_data" value=""><div class="qyer_upload_item_tit"></div><div class="qyer_upload_network_url"><div class="fl pr"><input type="text" id="web_img_url" name="imgurl" class="ui_input" placeholder="http://" value=""><!--提示有两种状态 切换里面的两个div --><div class="qyer_upload_new_error" id="web_img_url_tips"><span></span><div class="icon_error">请输入有效图片url地址</div></div></div><input type="button" id="web_album_submit" class="ui_button fl ml10" value="确定"><input type="button" class="ui_button_disabled fl ml10" value="上传中..." style="display:none;"></div></form></div>'},uploadNetPhoto:function(e){var t=this,i=this.photoHead.getHeadParams();i.imgurl=e,i.size="*",p.submitPhoto({type:"get",data:i,onError:function(e){n.tip({text:"上传网络图片错误",type:"error",time:1e3})},onSuccess:function(e){$("."+t.className).find("#web_album_submit").val("完成"),$(t).trigger("uploadimage",e.data),$(document).undelegate("#web_album_submit","click"),t.parent.hide()}})},dispose:function(){$(this.photoHead).trigger("dispose"),$(this.parent).off("aftershow")}},d.prototype={items:[],max:-1,modelMap:{local:l,myphoto:c,net:u},modelList:[],tpl:'<div class="qyer_upload">__headtpl____bodytpl__</div>',currentClass:"ui_tab_trigger_item_current",init:function(e){$.extend(this,e||{}),this.initModels(),this.getHtml(),this.bindEvent()},initModels:function(){var e,t=this;this.modelList=[];for(var n=0;n<this.items.length;n++)e=t.modelMap[this.items[n].model],e=new e($.extend(this.items[n].opt,{parent:t,max:this.max})),t.modelList.push(e)},bindEvent:function(){var e,t=this;$(document).undelegate(".qyer_upload_head li","click").delegate(".qyer_upload_head li","click",function(){t.toggleHead(),$(this).addClass(t.currentClass),e=$(this).index(),t.hideContent(),$(".qyer_upload_content .ui_tab_cnt_item").eq(e).addClass("ui_tab_cnt_item_current"),$(t.modelList[$(this).index()]).trigger("fireshow")});for(var n=0;n<this.modelList.length;n++)$(this.modelList[n]).on("uploadimage firecancel",function(e,n){switch(e.type){case"uploadimage":$(t).trigger("fireuploadimage",n);break;case"firecancel":t.hide()}})},toggleHead:function(){var e=this;$(".qyer_upload_head li").each(function(t,n){$(n).removeClass(e.currentClass)})},hideContent:function(){$(".qyer_upload_content .ui_tab_cnt_item").each(function(e,t){$(t).removeClass("ui_tab_cnt_item_current")})},getHtml:function(){var e="",t=this.getHeadTpl(),n=this.getBodyTpl();e=this.tpl.replace(/__headtpl__/gi,t),e=e.replace(/__bodytpl__/gi,n),this.tpl=e},getHeadTpl:function(){for(var e=this,t=[],n=0;n<e.modelList.length;n++)t.push('<li class="ui_tab_trigger_item">'+e.modelList[n].title+"</li>");return'<div class="qyer_upload_head"><ul class="fl fb f14 ml10 fontYaHei cGray">'+t.join("")+"</ul></div>"},getBodyTpl:function(){for(var e=this,t=[],n=0;n<e.modelList.length;n++)t.push(e.modelList[n].getHtml());return'<div class="qyer_upload_content ui_tab_cnt">'+t.join("")+"</div>"},aftershow:function(){var e=$(".qyer_upload_head li").eq(0);$(e).trigger("click")},show:function(){var t=this;return qyerUtil.isLogin()?(this.popup=new e({contentHTML:t.tpl,showTitle:!1,showCloseIcon:!0,exClassName:"uploadpopup",showOKBtn:!1,showCancelBtn:!1,onCancel:function(){t.dispose()}}),this.popup.show(),void $(this).trigger("aftershow")):void qyerUtil.doLogin()},hide:function(){this.popup.hide(),this.dispose()},dispose:function(){for(var e=0;e<this.modelList.length;e++)$(this.modelList[e]).trigger("dispose")}},d}),define("project/js/poi/comment-urls",[],function(){"use strict";return{comment:"http://common1.qyerstatic.com/poi.php?action=comment",delCommentByType:"http://common1.qyerstatic.com/public.php?action=delCommentByType",doComment:"http://common1.qyerstatic.com/qcross/place/index.php?action=savePoiComment",starLevel:"http://common1.qyerstatic.com/poi.php?action=starlevel",praised:"http://common1.qyerstatic.com/poi.php?action=useful",report:"http://common1.qyerstatic.com/public.php?action=jubao",question:"http://common1.qyerstatic.com/poi.php?action=question",answer:"http://common1.qyerstatic.com/poi.php?action=answer",secondComment:"http://common1.qyerstatic.com/poi.php?action=commentreply",markQuestion:"http://common1.qyerstatic.com/ajax.php?action=addqustionatten",doSecondComment:"http://common1.qyerstatic.com/public.php?action=replycomment",unMarkQuestion:"http://common1.qyerstatic.com/api/route.php?action=saveplan",visitor:"http://common1.qyerstatic.com/poi.php?action=visitorList",follow:"http://common1.qyerstatic.com/api/route.php?action=saveplan",getCurrentUserComment:"http://common1.qyerstatic.com/poi.php?action=get_poi_detail_dynamic_data&poi_id="}}),define("project/js/poi/comment-service",["common/service/service","project/js/poi/comment-urls"],function(e,t){"use strict";return{comment:function(n,i,o){return e.get(t.comment,$.extend({page:1,order:5,poiid:PLACE&&PLACE.PID,starLevel:"all"},n),i,o)},praised:function(n,i,o,r){return e.post(t.praised,{num:n,pid:i,type:2},o,r)},delCommentByType:function(n,i,o){return e.post(t.delCommentByType,{id:n,type:"poi"},i,o)},secondComment:function(n,i,o){return e.post(t.secondComment,{id:n},i,o)},starLevel:function(n,i,o){return e.post(t.starLevel,{poiid:n},i,o)},markQuestion:function(n,i,o){return e.post(t.markQuestion,{qid:n},i,o)},question:function(n,i,o,r){return e.post(t.question,{id:n,page:i},o,r)},answer:function(n,i,o,r){return e.post(t.answer,{id:n,page:i},o,r)},doComment:function(n,i,o){return e.post(t.doComment,$.extend({starlevel:5,comment:"",imgs:"",showback:1,source_type:12},n||{}),i,o)},doSecondComment:function(n,i,o,r){return e.post(t.doSecondComment,{reply:n,cid:i,type:2},o,r)},visitor:function(n,i,o,r){return e.post(t.visitor,{id:n,page:i||1},o,r)},follow:function(n,i,o,r){return e.post(t.follow,{id:n,value:i},o,r)},report:function(n,i,o){return e.post(t.report,n,i,o)},getCurrentUserComment:function(n,i,o){return e.get(t.getCurrentUserComment+n,{},i,o)}}}),define("project/js/poi/comment-tpl",[],function(){"use strict";var e={normal:["<%$.each(lists, function(index, item){%>",'<li class="clearfix" tid="<%=item.id%>">','<a class="largeavatar" href="<%=item.userinfo.link%>" data-bn-ipg="place-poi-poiReview-revDetail-reviewerProfile">','<img src="<%=item.userinfo.avatar%>">',"<span><%=item.userinfo.name%></span>","</a>",'<div class="comment clearfix">','<h5 class="title">','<span class="poi-stars">',"<%:=getStar(item.starlevel)%>","</span>","<%:=getSource(item)%>",'<a class="date" href="<%=item.link%>" target="_blank">',"<%=item.date%>","</a>","</h5>",'<p class="content"><%:=item.content%></p>','<div class="album">',"<%:=getPhotoList(item.album)%>","</div>",'<div class="praise">','<p class="hand">',"<%:=getHandle({isMine: item.isMine})%>","<%:=getReply(item.reply)%>","</p>","<%:=getPraised(item)%>","</div>",'<div class="review">','<ul class="clearfix"></ul>','<div class="reply">',"<p>",'<textarea class="ui2_textarea" placeholder="说说你的看法..."></textarea>',"</p>",'<div class="tips clearfix">','<input type="button" class="ui_button" value="回复"/>','<span class="current">0</span>',"/",'<span class="min">1</span>',"&nbsp;~&nbsp;",'<span class="max">140</span>&nbsp;字',"</div>","</div>","</div>","</div>","</li>","<%})%>"].join(""),source:'<p><em><%=from%></em><a href="<%=noteslink%>"><%=title%></a></p>',useful:'<%=!parseInt(useful, 10)? "有用": ("有用 " + useful)%>',praised:'<span class="useful <%=praised? "disabled": ""%>" data-bn-ipg="place-poi-poiReview-revDetail-useful" data-useful="<%=useful%>"><%=getUseful({useful: useful})%></span>',handle:'<%if(!isMine){%> <a href="javascript:void(0)" class="complaint">举报</a> <%}else{%> <a href="javascript:void(0)" class="delete">删除</a><a href="javascript:void(0)" class="edit">编辑</a> <%}%>',nodata:'<li class="clearfix"><p><%=msg%></p></li>',reply:["<%$.each(lists, function(index, item){%>",'<li stid="<%=item.replyid%>" style="display: <%if(item.display =="none"){%>none<%}else{%> inherit<%}%>">','<a class="smallavatar" href="<%=item.userLink%>">','<img src="<%=item.userPhoto%>">',"</a>",'<div class="morecomment">','<p class="row1">','<a href="<%=item.userLink%>">',"<%=item.author%>","</a>","<%:=towhom(item)%>",'<span class="times">',"<%=item.datetime%>","</span>","</p>",'<p class="row2"><%=item.reply_full%></p>','<p class="row3"><a class="js-reply" href="javascript:void(0)">回复</a></p>',"</div>","</li>","<%})%>"].join(""),moreReply:'<div class="more">还有 <%=more%> 条回复，<a class="js-more-reply" href="javascript:void(0)">点击查看>></a></div>',quesion:["<%$.each(lists, function(index, item){%>",'<dl tid="<%=item.id%>">',"<dt>",'<a class="Q-title" href="<%=item.questionLink%>" target="_blank" data-bn-ipg="place-poi-ask-question">',"<%=item.title%>","</a>","</dt>","<dd>",'<div class="see">','<%if(item.attention == "1"){%><a href="javascript:void(0)" class="followedQ">已关注</a><%}else{%><a href="javascript:void(0)" class="followQ" data-bn-ipg="place-poi-ask-followQuestion">关注问题</a><%}%>',"|",'<%if(parseInt(item.answer, 10) == 0){%><a href="javascript:void(0)" class="getA">暂无回答</a><%}else{%><a href="javascript:void(0)" class="getA yes" data-bn-ipg="place-poi-ask-answers" data-answer="<%=item.answer%>"><%=item.answer%>个回答</a><%}%>',"</div>",'<ul class="answer" data-page="1"></ul>',"</dd>","</dl>","<%})%>"].join(""),answer:["<%$.each(lists, function(index, item){%>","<li>",'<a class="avatar" data-bn-ipg="place-poi-ask-replierProfile" target="_blank" href="<%=item.userLink%>">','<img src="<%=item.avatar%>" width="32" height="32"/>',"</a>",'<div class="info">',"<p>",'<a href="<%=item.userLink%>" class="name">',"<%=item.name%>","</a>",'<span class="text">',"回答了该问题","</span>",'<span class="text">',"<%=item.date%>","</span>","</p>",'<p class="comment">',"<%:=item.answer%>","</p>","</div>","</li>","<%})%>"].join("")};return e}),define("project/js/poi/comment-tpl-register",["common/util/template","project/js/poi/comment-tpl"],function(e,t){"use strict";var n={getStar:function(e){return new Array(+e+1).join('<em class="singlestar full"></em>')+new Array(6-e).join('<em class="singlestar"></em>')},getSource:function(n){return n.title?e.render(t.source,n):""},getUseful:function(n){return e.render(t.useful,n)},getPraised:function(n){return e.render(t.praised,n)},getHandle:function(n){return e.render(t.handle,n)},getReply:function(e){return'<span class="js-reply-number number '+(e-0?"":"seedisable")+'">'+e+"条回复</span>"},towhom:function(e){return e.to?'<span class="separate">回复</span><a href="'+e.tolink+'">'+e.to+"</a>":""},getPhotoList:function(e,t){if(!e||!e.length)return"";var n="",i="../../../../common2.qyerstatic.com/place/project/images/space.png"/*tpa=http://common2.qyerstatic.com/place/project/images/space.png*/;return $.each(e,function(e,t){5==e&&(n+='<span class="all js-see-all">查看所有</span>');var o=t.thumb,r={link:t.link,photo:t.photo};e>=5?(r.thumb=i,r.thumb_origin=o,r.style='style="display:none"'):(r.thumb_origin="",r.style='style="display:inline-block"',r.thumb=o),n+="<span "+r.style+'><a target="_blank" href="'+r.link+'"><img class="js-photo-thumb" data-large="'+r.photo+'" src="'+r.thumb+'" data-thumb_origin="'+r.thumb_origin+'"/></a></span>'}),n}};return e.registerFunction("getStar",n.getStar),e.registerFunction("getSource",n.getSource),e.registerFunction("getUseful",n.getUseful),e.registerFunction("getPraised",n.getPraised),e.registerFunction("getHandle",n.getHandle),e.registerFunction("getReply",n.getReply),e.registerFunction("towhom",n.towhom),e.registerFunction("getPhotoList",n.getPhotoList),t}),define("common/basic/js/require-css!common/component/switchRoute/switchRoute",[],function(){}),define("common/component/switchRoute/switchRoute",["common/ui/popup/popup","css!common/component/switchRoute/switchRoute"],function(e){function t(e){this.$dom=$(n),$.extend(this,e||{})}var n=['<div class="switchRoute" id="switchRoute">','<div class="switchRoute-title">','<h4 class="_title">','<span class="text">','<em class="icon">','<img src="../../../../common2.qyerstatic.com/place/common/basic/old/images/tpl/icon_true.png"/*tpa=http://common2.qyerstatic.com/place/common/basic/old/images/tpl/icon_true.png*/ alt="">',"</em>","点评成功","</span>","</h4>","</div>",'<div class="switchRoute-main">','<p class="_content fontYaHei">',"继续点评那些你走过的足迹？","</p>","</div>","</div>"].join("");t.prototype={show:function(){var t=this;e.show({showTitle:!1,contentHTML:this.$dom,width:620,exClassName:"switchRouteBox",okText:"继续点评",cancelText:"下次再说",onShow:function(){t.onShowFn&&t.onShowFn.call(t)},onOK:function(){t.onOKFn&&t.onOKFn.call(t)},onCancel:function(){t.onCancelFn&&t.onCancelFn.call(t)}})}};var i={show:function(e){this.sr=new t(e),this.sr.show()},hide:function(){this.sr.hide()}};return i}),define("common/basic/js/require-css!common/ui/confirm/confirm",[],function(){}),define("common/ui/confirm/confirm",["css!common/ui/confirm/confirm.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/ui/confirm/confirm.css*/],function(){var e=jQuery,t={$ui:null,$box:null,$icon:null,$title:null,$text:null,init:function(){var n=['<div class="qui-confirm">',"<div>",'<div class="qui-confirm-box">','<div class="qui-confirm-box-title">',"title","</div>",'<div class="qui-confirm-box-content">','<div class="qui-confirm-box-content-icon"></div>','<div class="qui-confirm-box-content-text">',"提示文字","</div>",'<div class="qui-confirm-box-clearFloat">&nbsp;</div>',"</div>",'<div class="qui-confirm-box-bottom">','<input class="qui-confirm-okBtn ui_btn_small" type="button" value="确定" />  ','<input class="qui-confirm-cancelBtn ui_btn_small_cancel" type="button" value="取消" />  ',"</div>",'<div class="qui-confirm-closeIcon">&nbsp;</div>',"</div>","</div>","</div>"].join("");this.$ui=e(n),this.$box=t.$ui.find(".qui-confirm-box"),this.$title=t.$ui.find(".qui-confirm-box-title"),this.$icon=t.$ui.find(".qui-confirm-box-content-icon"),this.$text=t.$ui.find(".qui-confirm-box-content-text"),this.$ui.appendTo(document.body)},setUI:function(e){this.$text.html(e.text||""),this.$title.html(e.title||"提示"),this.$icon[0].className="qui-confirm-box-content-icon","ok"http://common1.qyerstatic.com/place/js/poi/==e.type?this.$icon.addClass("qui-confirm-box-content-iconOK"):"error"http://common1.qyerstatic.com/place/js/poi/==e.type?this.$icon.addClass("qui-confirm-box-content-iconError"):"warning"http://common1.qyerstatic.com/place/js/poi/==e.type?this.$icon.addClass("qui-confirm-box-content-iconWarning"):this.$icon.addClass("qui-confirm-box-content-iconWarning")},show:function(){var n={},i={top:0};e.support.leadingWhitespace&&(n.opacity=1,i.opacity=1),this.$ui.css("display","table").animate(n,300,function(){t.$box.animate(i,200)})},hide:function(){var n={top:-30},i={};e.support.leadingWhitespace&&(n.opacity=0,i.opacity=0),this.$box.animate(n,200,function(){t.$ui.animate(i,300,function(){t.$ui.css("display","none")})})}};t.init();var n={confirm:function(e){return t.setUI(e),t.$ui.undelegate("click").delegate(".qui-confirm-okBtn,.qui-confirm-cancelBtn,.qui-confirm-closeIcon","click",function(n){this.className.indexOf("qui-confirm-closeIcon")!=-1||this.className.indexOf("qui-confirm-cancelBtn")!=-1?e.onCancel&&e.onCancel(n):this.className.indexOf("qui-confirm-okBtn")!=-1&&e.onOK&&e.onOK(n),t.hide()}),t.show(),this}};return n}),define("project/js/poi/comment-reply",["common/widget/widget","project/js/poi/comment-service","project/js/poi/comment-tpl-register","common/util/template"],function(e,t,n,i){"use strict";return e.createClass({service:t,loading:function(e){return this.$el[e?"removeClass":"addClass"](this.getStatic().classes.loading),this},get:function(e,t){this.loading().service.secondComment(t||this.id).done(this.proxy(function(e){this.checkData(e)?this.success(e):this.error(e)})).fail(this.proxy(function(e){this.error(e)}))},html:function(e){var t="",o=e.data.lists;if(o.length>5){var r=o.slice(0,4),a=o.slice(5).map(function(e,t,n){return e.display="none",e});t+=this.renderData({lists:r}),t+=this.renderData({lists:a}),this.$el.after(i.render(n.moreReply,{more:a.length}))}else t+=this.renderData(e.data);this.$el[this.append?"append":"html"](t)},checkData:function(e){return e&&e.data&&e.data.lists&&e.data.lists.length},renderData:function(e){return i.render(n.reply,e)},success:function(e){this.html(e),this.loading(!0)},error:function(e){this.loading(!0)}},{classes:{loading:"place-loading"},ATTRS:{id:null}})}),define("project/js/poi/poi-comment",["common/widget/widget","project/js/poi/comment-service","project/js/poi/comment-tpl-register","common/ui/tip/tip","common/util/template","common/ui/confirm/confirm","common/component/poiComment/poiComment","project/js/poi/comment-reply","common/ui/textArea/textArea"],function(e,t,n,i,o,r,a,s){"use strict";var l=e.createClass({tpls:n,service:t,events:[["click","support",".useful:not(.disabled)"],["click","report",".complaint:not(.disable)"],["click","deleteComment",".delete:not(.disable)"],["click","editComment",".edit"],["click","openReview",".js-reply-number"],["click","reply",".tips .ui_button:not(.disable)"],["click","focus",".js-reply"],["click","seeMore",".js-more-reply"],["mouseenter","seeLarge",".js-photo-thumb"],["mouseleave","hideLarge",".js-photo-thumb"],["click","seeAllPhoto",".js-see-all"]],get:function(e,t,n,i){this.addClass(this.$el,"loading"),this.XHR&&this.XHR.abort&&this.XHR.abort(),this.XHR=this.service.comment({page:e||1,order:t||this.order||5,poiid:i||this.poiid||PLACE&&PLACE.PID,starLevel:n||this.starLevel},this.proxy(function(e){this.checkData(e)===!1?this.getDataFail(e):this.getDataSuccess(this.checkData(e)),this.removeClass(this.$el,"loading")}),this.proxy(function(e){this.getDataFail(e),this.removeClass(this.$el,"loading")}))},checkData:function(e){return e&&e.data&&e.data.lists&&e.data.lists.length?e:!!(e&&e.data&&e.data.lists&&0===e.data.lists.length)&&$.extend(e,{length:"ZERO"})},getDataFail:function(e){this.msg(e&&e.data&&e.data.msg||this.i18n("ERROR2"),"error")},getDataSuccess:function(e){"ZERO"===e.length?this.$el[this.append||"html"](o.render(n.nodata,{msg:this.i18n("ERROR3")})):this.$el[this.append||"html"](o.render(n.normal,e.data))},support:function(e){if(!this.checkLogin())return!1;var t=$(e.currentTarget),n=t.attr("data-useful"),i=n-0+1;t.text("有用 "+i),this.addClass(t,"disabled").service.praised(i,t.parents("li[tid]").attr("tid"),this.proxy(function(e){t.attr("data-useful",i),this.msg(e.data.msg_impel||e.data.msg)}),this.proxy(function(e){this.msg(e&&e.data&&e.data.msg||this.i18n("ERROR1"),"error").removeClass(t,"disabled"),t.text(n>0?"有用 "+n:"有用")}))},report:function(e){var t=$(e.currentTarget);t.addClass("disable"),require(["project/js/poi/report"],function(e){e.inition({id:t.parents("li").attr("tid")})}),$(window).on("event-report-error",function(){t.removeClass("disable")})},deleteReload:!0,deleteComment:function(e){if(this.checkLogin()){var t=$(e.currentTarget),n=t.parents("li").attr("tid");r.confirm({title:this.i18n("CONFIRM1"),text:this.i18n("CONFIRM2"),type:"warning",onOK:this.proxy(function(){this.addClass(t,"disable").service.delCommentByType(n).done(this.proxy(function(e){0==e.error_code?($(this).trigger("deleteComment",e),this.msg(this.i18n("MSG1")),this.deleteReload&&this.deleteSuccess()):this.msg(e&&e.data&&e.data.msg||this.i18n("MSG2"),"error").removeClass(t,"disable")})).fail(this.proxy(function(e){this.msg(e.data.msg||this.i18n("MSG2"),"error").removeClass(t,"disable")}))})})}},deleteSuccess:function(){setTimeout(function(){location.reload()},2e3)},editComment:function(e){this.checkLogin()&&a.show({poiid:this.poiid||PLACE.PID,onsucceed:function(e){window.location.reload()}})},checkLogin:function(){return!!qyerUtil.isLogin()||(qyerUtil.doLogin(),!1)},openReview:function(e){var t=$(e.currentTarget),n=t.parents("li"),i=(t.find("ul"),n.find(".review").toggle()),o=i.find("textarea").eq(0);if(i.length){if("none"!=i.css("display")&&(this.setName(o.get(0),n.find(".largeavatar span").text()),o.focus()),"been"==t.attr("data-status"))return this;t.attr("data-status","been"),i.qyerTextArea({max:140,min:1,autoIncreaseHeight:!0}),n.find(".js-reply-number").hasClass("seedisable")||(this.replying=new s({$el:i.find("ul"),id:n.attr("tid")}),this.replying.get.call(this.replying))}},focus:function(e){var t=$(e.currentTarget),n=t.parents(".review"),i=n.find("textarea").eq(0),o=t.parents("li[stid]"),r=$.trim(o.find(".row1 a").text());this.setName(i.get(0),r),i.focus()},reply:function(e){if(this.checkLogin()){var i=$(e.currentTarget),r=i.parents("li"),a=r.find(".review"),s=a.find("textarea").eq(0);s.val();return this.addClass(i,"disable"),this.checkReply(a.get(0))?void t.doSecondComment(s.val(),r.attr("tid")).done(this.proxy(function(e){this.removeClass(i,"disable"),0==e.error_code?a.find("ul").append(o.render(n.reply,{lists:[e.data]})):this.msg(e&&e.data&&e.data.msg||"操作失败","warning")})).fail(this.proxy(function(e){this.removeClass(i,"disable"),this.msg(e&&e.data&&e.data.msg||this.i18n("ERROR1"),"error")})):(this.msg(this.i18n("MSG3"),"warning"),void this.removeClass(i,"disable"))}},checkReply:function(e){var t=$(e);if(t&&t.qyerTextArea)return!!t.qyerTextArea("isValidate");if(t&&t.find("textarea").length){var n=t.find("textarea").val();return n.length>=1&&n.length<=140}return!1},setName:function(e,t){return $(e).val("回复 @"+$.trim(t)+"："),this},addClass:function(e,t){return e.addClass(this.getStatic().classes[t]),this},removeClass:function(e,t){return e.removeClass(this.getStatic().classes[t]),this},msg:function(e,t){var n=$.extend({text:e},{type:t||"default"});return i.tip(n),this},seeMore:function(e){var t=$(e.currentTarget);t.parents(".review").find("li").show(),t.parent().remove()},seeLarge:function(e){var t=$(e.currentTarget),n=t.offset(),i=n.left,o=n.top,r=$(window).width(),a=$(window).height(),s=$(window).scrollTop();i=300+i>parseInt(r,10)?i-220:i,o=280+o>parseInt(a+s,10)?o-200:o+85,$('<div class="poi-largePic"><img src="'+t.attr("data-large")+'"/></div>').css({"z-index":99999,left:i,top:o}).appendTo("body")},hideLarge:function(){$(".poi-largePic").remove()},seeAllPhoto:function(e){var t=$(e.currentTarget);t.hide().nextAll("span").each(function(e,t){var n=$(t).show(),i=n.find(".js-photo-thumb");i.attr("src",i.attr("data-thumb_origin"))})}},{classes:{disabled:"disabled",disable:"disable",loading:"place-loading"},events:{deleteComment:"event-delete-comment",editComment:"event-edit-comment"},ATTRS:{order:5,starLevel:"all"}}).i18n({ERROR1:"操作失败",ERROR2:"取得点评失败",ERROR3:"暂无数据",CONFIRM1:"删除点评",CONFIRM2:"确定要删除您的点评吗？",MSG1:"删除成功",MSG2:"删除失败",MSG3:"输入内容不符合要求"});return l}),define("project/js/poi/comment-filter",["project/js/poi/comment-service","common/util/template"],function(e,t){"use strict";var n={star:'<span data-type="<%=type%>" class="<%=classname%>" data-bn-ipg="<%=dataBnIpg%>"><%=name%><i>(<%=amount%>)</i></span>',nodata:"<span>暂无数据</span>",nocomment:"<span>暂还没有穷游er点评过这里</span>",follow:'<span>|</span><span data-type="follow" class="<%=(follow == 0? "disable": "")%>" data-bn-ipg="place-poi-poiReview-filter-myFollowing">我关注的人<i>(<%=follow%>)</i></span>'},i={data:[{type:"all",key:"all",dataBnIpg:"place-poi-poiReview-filter-allReviews",name:"全部",classname:"selected"},{type:"5",key:"five",dataBnIpg:"place-poi-poiReview-filter-allReviews",name:"五星",classname:""},{type:"4",key:"four",dataBnIpg:"place-poi-poiReview-filter-allReviews",name:"四星",classname:""},{type:"3",key:"three",dataBnIpg:"place-poi-poiReview-filter-allReviews",name:"三星",classname:""},{type:"2",key:"two",dataBnIpg:"place-poi-poiReview-filter-allReviews",name:"二星",classname:""},{type:"1",key:"one",dataBnIpg:"place-poi-poiReview-filter-allReviews",name:"一星",classname:""}],service:e.starLevel,get:function(){this.service(this.id,$.proxy(this.success,this),$.proxy(this.error,this))},id:PLACE&&PLACE.PID,success:function(e){var e=e.data;if("string"==typeof e)return void this.html(n.nodata);if(0==e.all)return void this.html(n.nocomment);var i="";$.each(this.data,function(o,r){var a=$.extend(r,{amount:e[r.key],classname:0==e[r.key]?"disable":""});"all"==r.key&&(a.classname="selected"),i+=t.render(n.star,r)}),i+=t.render(n.follow,{follow:"undefined"==typeof e.follow?0:e.follow}),this.html(i)},error:function(e){},html:function(e){this.$el[this.append?"append":"html"](e)},bindEvent:function(){this.$el.off(".__filter").on("click.__filter","span:not(.disable, .selected)",$.proxy(function(e){this.$el.find(".selected").removeClass("selected"),$(e.currentTarget).addClass("selected"),$(this).trigger("event-filter-click",e.currentTarget)},this))},init:function(e){return $.extend(this,e||{}),this.bindEvent(),this}};return i}),define("common/basic/js/require-css!common/ui/select/select",[],function(){}),define("common/ui/select/select",["css!common/ui/select/select.css"/*tpa=http://common1.qyerstatic.com/place/js/poi/css!common/ui/select/select.css*/],function(){function e(e){this.$obj=e.$obj,this.$title=this.$obj.find(".titles > .title-text"),this.$content=this.$obj.find(".contents"),this.option=e.option,this.selectIndex=0,this.setUI(),this.bindEvent(),this.setDefaultValue()}var t=jQuery;e.prototype={$obj:null,$title:null,$content:null,option:null,selectIndex:null,_disable:!1,setUI:function(){var e=this.$obj.find(".titles"),t=this.$obj.attr("data-ui-width");t=t?t:e.outerWidth(),t=parseInt(t,10),t<=0&&(t=100),t-=2,e.css("width",t),this.$obj.css("width",e.outerWidth());var n=this.$obj.attr("data-ui-height");n&&(this.$obj.css("height",n),this.$obj.find(".titles").css("line-height",n),this.$content.css("top",n)),t=this.$obj.attr("data-ui-menuWidth"),t=t?t:e.outerWidth(),t=parseInt(t,10),t-=2,this.$content.css("width",t),t=n=e=null},bindEvent:function(){var e=this,n=200;this.$obj.delegate(".titles","click",function(i){e._disable||(window.__currentSelect__&&window.__currentSelect__!=e&&window.__currentSelect__.$content.slideUp(n),window.__currentSelect__=e,i.stopPropagation(),e.$content.is(":hidden")?(e.$content.slideDown(n),t(document).one("click",function(){e.$content.slideUp(n)})):e.$content.slideUp(n))}),this.$obj.delegate(".contents > ul > li ","click",function(){e.$content.slideUp(n);var i=t(this);if(e.option&&e.option.onBeforeChange){var o=e.option.onBeforeChange.call(e.$obj[0],i[0]);if(o===!1)return}e.selectIndex=i.index();var r=i.attr("data-value");e.$obj.attr("data-value",r),e.$title.html(i.find("a").html()),e.option&&e.option.onChange&&e.option.onChange.call(e.$obj[0],i[0]),i=r=null})},setDefaultValue:function(){var e=t.trim(this.$obj.attr("data-dafaultValue"));
if(e){var n=this.$content.find('ul > li[data-value="'+e+'"] ');n.length&&(this.selectIndex=n.index(),this.$title.html(n.text())),n=null}e=null},getSelectItem:function(){return this.$content.find("ul > li:eq("+this.selectIndex+") ")[0]},setSelectIndex:function(e){this.selectIndex=e;var t=this.$content.find("ul > li:eq("+e+") > a ").html();this.$title.html(t),t=null},getSelectIndex:function(){return this.selectIndex},setOption:function(e,t){this.option[e]=t},setValue:function(e){var t=this.$content.find('ul > li[data-value="'+e+'"]');this.selectIndex=t.index(),this.$title.html(t.children("a").html()),t=null},disable:function(){this._disable=!0,this.$obj.addClass("qui-select-disable")},enable:function(){this._disable=!1,this.$obj.removeClass("qui-select-disable")},setTitle:function(e){this.$title.html(e)}},t.fn.extend({qyerSelect:function(n){var i={getSelectItem:function(e){return e.data("_qyerSelect").getSelectItem()},getValue:function(e){return e.data("_qyerSelect").getSelectItem().getAttribute("data-value")},setValue:function(e,t){return e.data("_qyerSelect").setValue(t)},setSelectIndex:function(e,t){return e.data("_qyerSelect").setSelectIndex(t),e},setOption:function(e,t,n){return e.data("_qyerSelect").setOption(t,n),e},getSelectIndex:function(e){return e.data("_qyerSelect").getSelectIndex()},disable:function(e){return e.data("_qyerSelect").disable()},enable:function(e){return e.data("_qyerSelect").enable()},setTitle:function(e,t){return e.data("_qyerSelect").setTitle(t)}},o=t.type(n);if("object"==o||"undefined"==o){var r;return t.each(this,function(i,o){r=t(o),r.data("_qyerSelect")||r.data("_qyerSelect",new e({$obj:r,option:n?n:{}}))}),r=null,this}if("string"==o){var r,a=arguments,s=[];return t.each(this,function(e,o){if(r=t(o),i[n]){var l=qyerUtil.sliceArguments(a,1);l.unshift(r),s.push(i[n].apply(i,l)),l=null}}),r=a=null,s.length?1==s.length?s[0]:s:this}}})}),$(function(){"use strict";var e={},t={};window.__userStatusCallBack?(window.__userStatusCallBack_old=window.__userStatusCallBack,window.__userStatusCallBack=function(t){window.__userStatusCallBack_old.call(window,t),$(e).trigger("loginCheck",t)}):window.__userStatusCallBack=function(t){$(e).trigger("loginCheck",t)},$("#js-shopping").html("&#xe64c;"),$(".poi-discount.shopping").on("click","http://common1.qyerstatic.com/place/js/poi/dt.wrap",function(e){var t=$("#js-shopping"),n=$(e.currentTarget);"none"==n.next().css("display")?(n.next().show(),t.html("&#xe64a;")):(n.next().hide(),t.html("&#xe64c;"))}),require(["common/ui/doMask/doMask"],function(e){var t='<div class="qdfs-box">            <a class="close iconfont" href="javascript:void(0)">&#xe636;</a>            <h4 class="title">                <span>                    绑定手机号接收穷游专属优惠码                </span>            </h4>            <div class="inner clearfix">                <div class="row">                    已绑定手机号：<span class="js-phoneNumber">****</span><a href="http://www.qyer.com/u/bind" class="edit">修改</a>                </div>                <div class="row-2">                    <span class="verify">                        <input type="text" placeholder="输入验证码" value=""/>                    </span>                    <span class="verify-img"><img id="js-varify-img" onclick="this.src=\'/qcross/login/ajax.php?action=captcha&timer\'+(+(new Date))" src="../../../qcross/login/ajax.php-action=captcha&timer=1462265038555"/*tpa=http://common1.qyerstatic.com/qcross/login/ajax.php?action=captcha&timer=1462265038555*//></span>                    <span class="verify-getcode">                        <input type="button" value="获取优惠码">                    </span>                </div>            </div>            <div class="inner clearfix" style="display:none;">                <div class="tip">                    <span class="left iconfont">                        &#xe63c;                    </span>                    <div class="main">                        优惠码短信已发送至<span class="js-phoneNumber">****</span>，请注意查收<br/>没有收到？<a href="javascript:void(0)" class="js-backToUp" style="padding-left:10px">重新获取优惠码短信</a>                    </div>                </div>            </div>        </div>',n={init:function(){this.bindEvent()},$el:$(t),bindEvent:function(){var e=this;$("body").on("click",".js-dfs-getcode",function(){return qyerUtil.isLogin()?void e.getUserInfo():void qyerUtil.doLogin()})},bindPopupEvent:function(){var e=this;e.$el.off("click").on("click",".verify-getcode",function(){e.$el.find("div.row-2").hasClass("disable")||e.checkVarifyCode()&&e.sendVarifyCode()}).on("click",".close",function(){e.cf&&e.cf.hide&&e.cf.hide()}).on("click",".js-backToUp",function(){e.$el.find(".inner").eq(1).hide(),e.$el.find(".inner").eq(0).show()})},checkVarifyCode:function(){return!!$.trim(this.$el.find(".verify input").val())||(requirejs(["common/ui/tip/tip"],function(e){e.tip({text:"验证码不能为空",type:"error"})}),!1)},sendVarifyCode:function(){e.showMask();var t=this.$el.find(".verify input").val(),n=$("#js-varify-img").attr("src").split("timer=")[1];this.doAjax("http://common1.qyerstatic.com/qcross/login/auth.php?action=captchacheck",$.proxy(this.varifyCodeOK,this),$.proxy(this.varifyCodeError,this),{valid_code:t,timer:n})},varifyCodeOK:function(e){var t=this.$el.find(".verify input").val();this.doAjax("http://common1.qyerstatic.com/discountactivity.php?action=sendDfsDiscountCode",$.proxy(this.success,this),$.proxy(this.error,this),{captcha:t})},success:function(){e.hideMask(),this.$el.find(".inner").eq(0).hide(),this.$el.find(".inner").eq(1).show()},error:function(t){e.hideMask(),requirejs(["common/ui/tip/tip"],function(e){e.tip({text:t.data.msg||"错误,请重试",type:"error"})})},varifyCodeError:function(t){e.hideMask(),requirejs(["common/ui/tip/tip"],function(e){e.tip({text:t.data.msg||"验证码不正确",type:"error"})})},getUserInfo:function(){e.showMask(),this.doAjax("http://common1.qyerstatic.com/discountactivity.php?action=getuserinfo",$.proxy(this.getUserInfoSuccess,this),$.proxy(this.getUerInfoError,this))},getUserInfoSuccess:function(t){e.hideMask(),t.data&&t.data.phone?this.$el.find(".js-phoneNumber").text(this.maskNumber(t.data.phone)):this.$el.find("div.row-2").addClass("disable").addBack().find("#js-varify-img").hide().addBack().find(".verify input").val("输入验证码").attr("disabled","true").addBack().find(".row").html('手机号：暂未绑定<a target="_blank" style="padding-left:10px" href="http://www.qyer.com/u/bind">立即绑定手机号</a>'),this.showPopup(this.$el)},maskNumber:function(e){var t=e,e=t.split("-")[1],n=t.split("-")[0];return n+"-"+e.substr(0,3)+"***"+e.substr(-4)},getUerInfoError:function(t){e.hideMask()},doAjax:function(e,t,n,i){qyerUtil.doAjax({url:e,onSuccess:t||function(){},onError:n||function(){},data:i||{}})},showPopup:function(e,t,n){var i=this;requirejs(["common/ui/popup/popup"],function(o){o.show({contentHTML:e,onOK:function(){$.isFunction(t)&&t()},onCancel:function(){$.isFunction(n)&&n()},exClassName:"qdfs-popup"}),i.cf=o,i.bindPopupEvent()})}};n.init()}),$("#doings_planto_button").on("click",function(){var e=$(this),t=e.find(".icons").hasClass("selected");qyerUtil.doTrackCode(e.attr("data-ipg-"+(t?"delete":"add")))});var n={init:function(){require(["common/widget/userbehavior/widget-userbehavior"],function(e){var t=new e({$el:$("#js-topside"),type:PLACE.TYPE,id:PLACE.PID}).after("handleSuccess",$.proxy(function(e,t){var n=$(e);"beento"==n.attr("data-type")&&(1==n.attr("data-status")?$('<a id="js-newuser" href="'+t.data.user.link+'" title="'+t.data.user.username+'" uid="'+t.data.user.uid+'" data-bn-ipg="place-poi-beenToUser" target="_blank"><img src="'+t.data.user.avatar+'"></a>').prependTo($(".poi-rightfix .avatars")):$("#js-newuser").remove())},t))})}},i={init:function(e){this.data=e,this.bindEvent(),this.setScore()},$el:$("#js-infobox"),setScore:function(){var e=this.$el.find(".summery");this.data.comment_count>0?e.html('<a href="'+location.pathname+'review" target="_blank" data-bn-ipg="place-poi-detail-viewAllReviews">'+this.data.comment_count+"条点评</a>"):e.html("暂无评分")},bindEvent:function(){var e=this;require(["project/js/poi/histogram"],function(t){var n=new t(e.$el.find(".view")),i=null,o=null;$("#graph").on("mouseover",function(){i&&(clearTimeout(i),i=null),o&&(clearTimeout(o),o=null),n.show()}).on("mouseout",function(){i=setTimeout(function(){n.hide()},300)}),e.$el.on("mousemove",".view",function(){i&&(clearTimeout(i),i=null),o&&(clearTimeout(o),o=null)}).on("mouseleave",".view",function(){o=setTimeout(function(){n.hide()},300)}),n.init({data:e.data})})}},o={$el:$("#js-infobox"),bindEvent:function(){var e=this;return this.$el.on("click","#addcomment",function(){e.showPop()}).find(".js-inner-box").addClass(e.loading),e},showPop:function(){require(["common/component/poiComment/poiComment"],function(e){e.show({poiid:$("#poiid").val(),source_type:"C-des-leftTopBtn",onsucceed:function(e){requirejs(["common/component/switchRoute/switchRoute"],function(e){e.show({onOKFn:function(){requirejs(["common/component/footprint/js/comment"],function(e){e.commShow({city_id:PLACE.CITYID,source_type:"C-des-leftTopBtn"})})},onCancelFn:function(){window.location.reload()}})}),$(window).off("event-footprint-hide.alias").on("event-footprint-hide.alias",function(){window.location.reload()})}})})},render:function(e,t,n){var i=this;return requirejs(["common/util/template"],function(o){n?n(o.render(e,t)):i.$el.find(".js-inner-box").append(o.render(e,t))}),i},unlogin:function(){var e=this;requirejs(["project/js/poi/poi-detail-tpl"],function(t){e.data.data?e.data.data&&!e.data.data.comment?e.data.data.comment={comment_count:0}:e.data.data&&e.data.data.comment&&"undefined"==typeof e.data.data.comment.comment_count&&(e.data.data.comment.comment_count=0):e.data.data={comment:{comment_count:0}},e.bindEvent().render(t.write,e.data.data).$el.find(".js-inner-box").removeClass(e.loading)})},loginedSuccess:function(){var e=this;requirejs(["project/js/poi/poi-detail-tpl"],function(t){if(e.data.data.uidcomment)e.render(t.edit,e.data.data.uidcomment);else{var n={comment:{comment_count:0}};e.data&&e.data&&e.data.data.comment&&(n=$.extend(n,e.data.data)),e.render(t.write,n)}e.data.data.followedBeentoCount&&e.render(t.followedBeentoCount,{url:location.pathname+"beento",followedBeentoCount:e.data.data.followedBeentoCount},function(t){e.$el.find("ul > .rank").after(t)}),e.bindEvent().$el.find(".js-inner-box").removeClass(e.loading)})},loginedError:function(e){var t=this;t.$el.append("<span>获取数据失败</span>").removeClass(t.loading)},init:function(e){var t=this;t.data=e,qyerUtil.isLogin()?t.loginedSuccess():t.unlogin()},loading:"place-loading"},r={init:function(){var e=$(".poi-showtar"),t=$(".poi-showall");t.on("click",function(t){e.css("display","block"),$(this).remove()})}};r.init();var a={$el:$(".poi-tab"),bindEvent:function(){var e=this;return this.$el.on("click","li",function(t){e._reset()._select($(this).index())}),this},init:function(){return this._reset()._select(0).showTar(0).bindEvent()},_select:function(e){return this.$el.find("li").eq(e).addClass("selected"),$(this).trigger("event-tab-change",e),this},_reset:function(){return this.$el.find("li").removeClass("selected"),this},showTar:function(e){return $(".poi-tars").find(".tar").removeClass("show").eq(e).addClass("show"),$(".poi-comment").removeClass("show").eq(e).addClass("show"),this}};a.init(),$(a).on("event-tab-change",function(e,t){a.showTar(t)});var s={init:function(e){var n=this,i={uid:0,profile:"javascript:void(0)",avatar:"../../../../static.qyer.com/images/user2/avatar/big6.png"/*tpa=http://static.qyer.com/images/user2/avatar/big6.png*/,name:POINAME},o={commentid:0,dataTime:"2016-12-12"};n.data=e||{data:{}},requirejs(["project/js/poi/poi-detail-tpl","common/util/template"],function(e,r){qyerUtil.isLogin()?!qyerUtil.isLogin()||n.data.data&&n.data.data.uidcomment?(o.commentid=n.data.data.uidcomment.id,o.dateTime=n.data.data.uidcomment.inserttime.split(/\s/)[0],$("#commentTar").html(r.render(e.comment,o))):(i.uid=t.uid,i.avatar=t.userinfo.avatar,i.profile="//www.qyer.com/u/"+t.uid,$("#commentTar").html(r.render(e.writeComment,i))):$("#commentTar").html(r.render(e.writeComment,i)),n.$el=$("#g_comment"),n.bindEvent().fileupload().starLevel().submitInfo()})},bindEvent:function(){var e=this,t=this.$el.find(".ui2_textarea").eq(0);return t.on("focus",function(){!e.checkLogin()}),requirejs(["common/ui/textArea/textArea","common/ui/inputValidation/inputValidation"],function(){e.$el.qyerTextArea({max:2e3,min:30,autoIncreaseHeight:!0}),t.qyerInputValidation({text:"点评不少于30字，不超过2000字",blurAutoCheck:!1,exp:function(e){return/^(\s|\S){30,2000}$/.test(e)}})}),this},fileupload:function(){return $("#sharephoto, #photoListEmpty").on("click",function(){require(["common/component/uploadPopup/uploadPopup"],function(e){var t=new e({max:20,items:[{model:"local",opt:{headOpt:{models:["list","create"]}}},{model:"myphoto",opt:{headOpt:{models:["list"]}}}]});t.show(),$(t).on("fireuploadimage",function(e,n){if(t.hide(),"string"==typeof n)var n=JSON.parse(n);var i=$("#photolist").css("display","block");$.each(n,function(e,t){var t=$('<li>                                     <img src="'+t.url+'/80" data-id="'+t.id+'">                                    <span class="close">                                    </span>                                    </li>').prependTo(i);t.find(".close").click(function(){var e=$(this);e.parent().remove()})})})})}),this},starLevel:function(){var e=this,t=e.$el.find(".poi-stars"),n=["很差","差","一般","好","很好"],i=t.attr("starlevel");return t.find(".single-star").removeClass("full").addBack().find(".normal").html("点击星星为它评分"),i>0&&t.find(".single-star:lt("+i+")").addClass("full").addBack().find(".normal").html(n[parseInt(i,10)-1]),t.off("mouseleave").on("mouseleave",function(){$(this).find(".single-star").removeClass("full").addBack().find(".normal").html("点击星星为它评分");var e=t.attr("starlevel");e>0&&($(this).find(".single-star:lt("+e+")").addClass("full"),t.find(".normal").html(n[parseInt(e,10)-1]))}).find(".single-star").each(function(i){var o=i;$(this).hover(function(){t.find(".single-star").addClass("full").addBack().find(".single-star:gt("+o+")").removeClass("full").addBack().find(".normal").html(n[o])}).click(function(){return!!e.checkLogin()&&void t.attr("starlevel",o+1)})}),this},submitInfo:function(){var e=this,t=e.$el.find(".ui_button");return t.on("click",function(){if(e.checkLogin()&&!$(this).hasClass("ui_button_disabled")){var n=e.$el.find(".poi-stars"),i=e.$el.find(".ui2_textarea").eq(0),o=$("#photolist"),r=o.find("li");if(!parseInt(n.attr("starlevel"),10))return requirejs(["common/ui/tip/tip"],function(e){e.tip({text:"请选择点评星级",type:"warning"})}),!1;if(i.qyerInputValidation()){var a=[];r.each(function(){a.push($(this).find("img").attr("data-id"))}),t.addClass("ui_button_disabled").removeClass("ui_button"),requirejs(["project/js/poi/comment-service","project/js/poi/comment-tpl-register","common/util/template","common/component/switchRoute/switchRoute"],function(o,r,s,l){o.doComment({poiid:PLACE.PID,starlevel:n.attr("starlevel"),comment:i.val(),imgs:a.join(","),showback:1,source_type:12}).done(function(e){var e=e.data;e.lists[0].isMine=!0,e.lists[0].link="http://place.qyer.com/review/"+e.lists[0].id,$("#commentlist").append(s.render(r.normal,e));var t=$(".infos"),n=e.lists[0].id,i=$("#commentTar");t.find(".buttons").remove().addBack().append('<div class="poi-detail" style="font-size:14px;margin:40px 0 0 0;">我点评过这里<a href="http://place.qyer.com/review/'+n+'" target="_blank">查看/编辑</a></div>'),i.html("<p>我在"+e.lists[0].date+'点评过这里<a href="http://place.qyer.com/review/'+n+'" target="_blank">查看/编辑</a></p>'),l.show({onOKFn:function(){require(["common/component/footprint/js/comment"],function(e){e.commShow({city_id:PLACE.CITYID,source_type:"C-des-leftTopBtn"})})},onCancelFn:function(){window.location.reload()}}),$(window).off("event-footprint-hide.alias").on("event-footprint-hide.alias",function(){window.location.reload()})}).fail(function(n){t.removeClass("ui_button_disabled").addClass("ui_button"),e.tip(n&&n.data&&n.data.mst||"点评失败","error")})})}}}),this},tip:function(e,t){requirejs(["common/ui/tip/tip"],function(n){n.tip({text:e,type:t||"warning"})})},checkLogin:function(){return!!qyerUtil.isLogin()||(qyerUtil.doLogin(),!1)}};require(["project/js/poi/comment-service","project/js/poi/comment-tpl-register","common/util/template"],function(e,t,n){var i={$el:$("#question"),bindEvent:function(){var i=this;this.$el.on("click",".followQ",function(t){if(!i.checkLogin())return!1;var n=$(t.currentTarget);e.markQuestion(n.parents("dl").attr("tid")).done(function(e){0==e.error_code?n.removeClass("followQ").addClass("followedQ").text("已关注"):i.tip(e&&e.data&&e.data.msg||"关注失败")}).fail(function(e){i.tip(e&&e.data&&e.data.msg||"关注失败")})}).on("click","http://common1.qyerstatic.com/place/js/poi/.yes, .more",function(e){var o=$(e.currentTarget),r=o.parents("dl"),a=(r.find(".more"),r.find(".yes")),s=r.find(".answer"),l=(s.find("li"),a.attr("data-answer"));s.attr("data-page")&&i.answer(r.attr("tid"),s.attr("data-page")||1).done(function(e){e&&e.data&&e.data.lists&&e.data.lists.length>0&&(s.append(n.render(t.answer,e.data)),s.attr("data-page",s.attr("data-page")-0+1),l>s.find("> li").length&&0==r.find(".more").length?$('<div class="more">查看更多</div>').insertAfter(s):l<=s.find("> li").length&&r.find(".more").remove())})}).on("click",".ui_page a",function(e){$(window).scrollTop($(".poi-question").offset().top-50),i.getQuestion($(e.currentTarget).attr("data-page"))})},getQuestion:function(i){var o=this;e.question(PLACE.PID,i).done(function(e){return e&&e.data&&"string"http://common1.qyerstatic.com/place/js/poi/==typeof e.data?void o.$el.html('<p class="poi-question-noData">'+e.data+"</p>"):(o.$el.html(n.render(t.quesion,e.data)),void(e.page&&o.$el.append(e.data.pagehtml)))}).fail(function(){o.$el.html('<p class="poi-question-noData">获取数据失败。</p>')})},answer:function(t,n){return e.answer(t,n)},checkLogin:function(){return!!qyerUtil.isLogin()||(qyerUtil.doLogin(),!1)},tip:function(e,t){requirejs(["common/ui/tip/tip"],function(n){n.tip({text:e,type:t||"warning"})})},init:function(){this.bindEvent(),this.getQuestion(1)}};i.init()}),require(["project/js/poi/poi-comment","project/js/poi/comment-filter","common/ui/select/select"],function(e,t){var n=!0,i=new e({$el:$("#commentlist"),order:5,starLevel:"all"});i.after("getDataSuccess",function(e){e&&e.data&&e.data.pagehtml&&this.$el.nextAll(".ui_page").remove().addBack().after(e.data.pagehtml),n||$(window).scrollTop(this.$el.offset().top-200),n=!1,"ZERO"==e.length&&i.$el.find("li").remove()}).before("get",function(){this.$el.html("").nextAll(".ui_page").remove()}),$(".poi-MT").on("click",".ui_page a",function(e){var t=$(e.currentTarget);i.get(t.attr("data-page"),$("#ordertype").attr("data-value"),$("#starLevelClass").find("span.selected").data("type")),t.parent().remove(),e.preventDefault()}),t.init({$el:$("#starLevelClass")}),t.init().get(),$(t).on("event-filter-click",function(e,t){i.get(1,$("#ordertype").attr("data-value"),$(t).attr("data-type"))}),$("#ordertype").qyerSelect({onChange:function(e){$(this).qyerSelect("setTitle",$(e).text()),i.get(1,$("#ordertype").attr("data-value"),$("#starLevelClass").find("span.selected").data("type"))}}),i.get(1,$("#ordertype").attr("data-value"),"all")});var l={$el:$("#js-beento-user"),init:function(e){var t=this;return t.data=e,!(!t.data.data.poi_beento_user_lists||!t.data.data.poi_beento_user_lists.count)&&void requirejs(["project/js/poi/poi-detail-tpl","common/util/template"],function(e,n){t.$el.html(n.render(e.beento,{url:t.data.data.poi_beento_user_lists.url,listCount:t.data.data.poi_beento_user_lists.count,lists:t.data.data.poi_beento_user_lists.lists})).show()})}};$(e).on("loginCheck",function(i,o){n.init(),t=o,requirejs(["project/js/poi/comment-service"],function(t){t.getCurrentUserComment(PLACE.PID,function(t){$(e).trigger("event-datainfo",t)},function(t){$(e).trigger("event-datainfo-error",t)})})}).on("event-datainfo",function(e,t){var n={comment_count:0,comment_first_percentage:0,comment_five_percentage:0,comment_four_percentage:0,comment_second_percentage:0,comment_three_percentage:0};t.data&&t.data.comment&&(n=$.extend(n,t.data.comment)),t.data&&t.data.uidcomment&&(n=$.extend(n,t.data.uidcomment)),i.init(n),o.init(t),s.init(t),l.init(t)}).on("event-datainfo-error",function(e,t){$("body").find("place-loading").removeClass("place-loading").text("请求数据失败，请刷新重试")})}),define("project/js/poi/poiDetail",function(){}),function(e){var t=document,n="appendChild",i="styleSheet",o=t.createElement("style");o.type="text/css",t.getElementsByTagName("head")[0][n](o),o[i]?o[i].cssText=e:o[n](t.createTextNode(e))}("@charset \"utf-8\";\n.place-mask{position: relative;}\n.place-mask:before{position: absolute;left: 0;top:0;height:100%;width: 100%;line-height: 22px;\ncolor: #fff;z-index:9999;content: \"操作中...\";background-color: rgba(0,0,0,0.4);text-align: center;\noverflow: hidden;box-sizing:border-box;padding-top: 40px;}\n.qui-popup{\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    background-image:url(http://common2.qyerstatic.com/place/common/basic/images/bg_255_255_255_0.7.png);\n    z-index: 1000;\n    overflow-y: auto;\n    opacity: 0;\n}\n.qui-popup > div{\n    display: table;\n    height: 100%;\n    margin: 0 auto;\n}\n.qui-popup-dt{\n    display: table-cell;\n    vertical-align:middle;\n}\n.qui-popup-box{\n    margin: 0 auto;\n    background-color: #fff;\n    position: relative;\n    -webkit-box-shadow: 0 0 6px #aaa;\n    -moz-box-shadow: 0 0 6px #aaa;\n    box-shadow: 0 0 6px #aaa;\n    border: solid 1px #ccc;\n    \n    opacity: 0;\n}\n.qui-popup-box-title{\n    height: 60px;\n    line-height: 60px;\n    font-size: 18px;\n    font-weight: bold;\n    padding-left: 20px;\n}\n.qui-popup-box-content{\n    -webkit-box-sizing: border-box; \n    -moz-box-sizing: border-box;  \n    box-sizing: border-box; \n    padding: 0 20px;\n}\n.qui-popup-box-content >iframe{\n    width: 100%;\n    border: none;\n}\n.qui-popup-box-bottom{\n    text-align: right;\n    height: 70px;\n    line-height: 70px;\n    padding-right: 20px;\n}\n.qui-popup-closeIcon{\n    position: absolute;\n    right: 10px;\n    top: 10px;  \n    cursor: pointer;\n    background-image: url(\"../../../../common2.qyerstatic.com/place/common/ui/popup/ico.png\"/*tpa=http://common2.qyerstatic.com/place/common/ui/popup/ico.png*/);\n    height: 32px;\n    width: 32px;\n    background-repeat: no-repeat;\n    background-position:0 0;\n    border-radius: 5px;\n}\n.qui-popup-closeIcon:hover{\n    background-position: 0px -38px;\n}\n.qui-popup-cancelBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-okBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-loadingBtn{\n    vertical-align: middle;\n    display: none;\n    margin-left:10px;\n}.qui-errorip{\n    border: 1px solid #d0312b !important; \n}\n.qui-errorip-textDiv{border:solid 1px #d0312b; background-color: #ffcccd; color:#88777c; position: absolute; z-index: 2000; }\n.qui-errorip-textDiv > .tip{display: block; position: absolute; left: 5px; top: 0; }\n.qui-errorip-textDiv > .tip > p{position:absolute; width:0; height:0; }\n.qui-errorip-textDiv > .tip > .a1{top:-5px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-bottom:5px solid #CB0013; }\n.qui-errorip-textDiv > .tip > .a2{top:-4px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-bottom:5px solid #FFCCCD; }\n.qui-errorip-textDiv > .text{padding: 0 5px; }\n.qui-errorip-textDiv1 {border:solid 1px #ebb75a; background-color: #fff894; color:#222222; position: absolute; z-index: 2000;border-radius: 3px; }\n.qui-errorip-textDiv1 > .tip{display: block; position: absolute; left: 50%; bottom: -5px;margin-left: -5px; }\n.qui-errorip-textDiv1 > .tip > p{position:absolute; width:0; height:0; }\n.qui-errorip-textDiv1 > .tip > .a1{top:-4px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-top:5px solid #ebb75a; }\n.qui-errorip-textDiv1 > .tip > .a2{top:-5px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-top:5px solid #fff894; }\n.qui-errorip-textDiv1 > .text{max-width: 300px; overflow: hidden; padding: 0 8px; text-overflow: ellipsis; white-space: nowrap;}\n.qui-siglComment{clear:both;margin-top:-40px;}\n.siglComment-title{width:80px;height:80px;float:left;}\n.siglComment-title img{width:80px;height:80px;}\n.siglComment-info{margin-left:90px;height:80px;margin-right:50px;}\n.siglComment-cn{font-size:18px;font-family:\"microsoft YAHEI\";display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}\n.siglComment-cn a{color:#636363;}\n.siglComment-en{font-size:14px;display:block;height:20px;padding-bottom:10px;}\n.siglComment-en a{color:#959595;}\n.siglComment-stars{height:22px;}\n.siglComment-stars .star{cursor:pointer;padding-right:5px;width:22px;height:22px;float:left;background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/icon_star.png);background-repeat:no-repeat;background-position:-27px center;}\n.siglComment-stars .level{float:left;margin-left:20px;margin-top:5px;color:#959595;}\n.siglComment-stars .star-on{background-position:left center;}\n.siglComment-detail{overflow:hidden;clear:both;margin-top:15px;}\n.siglComment-detail .ui3_textarea{width:638px;height:104px;min-height:104px;padding:2px 5px 0px;display: block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;z-index: 10;position: relative;overflow: hidden;}\t\n.qui-siglComment .red{color:#f00;}  \n.siglComment-camera{height:30px;color:#959595;border:solid 1px #c0c0c0;margin-top:-1px;line-height:32px;overflow:hidden;}  \n.siglComment-camera input[type=file]{display:none;}\n.siglComment-camera label{background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/camera.png);background-repeat:no-repeat;background-position:left center;padding-left:20px;color:#0072bc;margin:0px 10px;cursor:pointer;}\n.siglComment-camera label:hover{text-decoration:underline;}\n.siglComment-camera~ .tips{margin-top:5px;}\n.siglComment-photolist{overflow: hidden;}\n.siglComment-photolist li{float:left;position: relative;width:80px;height:80px;padding:10px 0 10px 10px;float:left;overflow: hidden;}\n.siglComment-photolist li img{width:80px;height:80px;}\n.siglComment-photolist li .close{cursor:pointer;position:absolute;right:-1px;top:9px;background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/close.png);background-repeat:no-repeat;background-position:left top;width:20px;height:20px;border:solid 1px transparent;}\n.siglComment-photolist li .close:hover{background-position:left bottom;width:20px;height:20px;border:solid 1px transparent;}\n.siglComment-photolist .add{background:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/icon-add.png) no-repeat 10px 10px;cursor: pointer;position: relative;}\n#siglCommentPhotoUp{display: inline-block;width: 100%;height: 100%;}  \n#siglCommentPhotoUp .moxie-shim-html5{left:0px!important;top:0px!important;}\n.uploadpopup .p10{padding: 10px;}\n.uploadpopup .mr10{margin-right: 10px;}@charset \"utf-8\";\n@charset \"utf-8\";\n@font-face {\n    font-family: 'Place';\n    src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot'); \n    src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot') format('embedded-opentype'), \n    url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.woff') format('woff'), \n    url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.ttf') format('truetype'),\n    url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.svg') format('svg'); \n}\n@font-face {font-family: \"exPlace\";\n  src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot');\n  src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot') format('embedded-opentype'), \n  url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.woff') format('woff'), \n  url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.ttf') format('truetype'),\n  url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.svg') format('svg'); \n}\n.place-iconfont, .poi-discount .iconfont{\n  font-family:\"Place\" !important;\n  font-size:16px;\n  font-style:normal;\n  -webkit-font-smoothing: antialiased;\n  -webkit-text-stroke-width: 0.2px;\n  -moz-osx-font-smoothing: grayscale;\n}\n@charset 'utf-8';\n.poiRedPoint{\n\tborder: solid 2px #fff;\n\tbackground: #ff6763;\n\tborder-radius: 50%;\n\twidth: 12px;\n\theight: 12px;\n\tdisplay: none;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 0;\n\tmargin-left: 9px;\n\tz-index: 15;\n}\n.poiLikeTip{\n\twidth: 300px;\n\theight: 122px;\n\tposition: absolute;\n\tleft: 50%;\n\tmargin-left: -150px;\n\ttop: 43px;\n\tz-index: 16;\n\tbackground: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeTip.png) no-repeat left top;\n\tbackground-size: 300px 122px;\n\tcolor: #444!important;\n\tdisplay: none;\n}\n.poiLikeTip .close{\n\tposition: absolute;\n\tz-index:1;\n\tfont-size:20px;\n\tright: 5px;\n\ttop:10px;\n\theight: 26px;\n\tline-height: 24px;\n\twidth: 26px;\n\tcolor: #c0c0c0;\n\tbackground-image: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeClose.png);background-repeat: no-repeat;\n\tbackground-position: 3px 0px; \n\tbackground-size: 50px 25px;\n\tcursor: pointer;\n}\n.poiLikeTip .close:hover{\n\tbackground-position: -25px 0px;\n\tcolor: #fff;\n}\n.poiLikeTip .neverShow{\n\tposition: absolute;\n\tleft: 10px;\n\tbottom: 10px;\n\tcolor: #959595;\n}\n.poiLikeTip .neverShow:hover{\n\tcolor: #3f9f5f;\n}\n.poiLikeTip .text{\n\theight: 18px;\n\tline-height: 18px;\n\tcolor: #636363;\n\ttext-align: left;\n\tfont-size: 14px;\n\tpadding-left: 10px;\n\ttext-indent: 0px;\n}\n.poiLikeTip .t1{\n\tmargin-top: 16px;\n}\n.poiLikeTip em{\n\tfont-style: normal;\n\tfont-size: 16px;\n\tfont-weight: bold;\n}\n.poiLikeSmallTip{\n\twidth: 234px;\n\theight: 32px;\n\tdisplay: none;\n\tbackground: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeSmallTip.png) no-repeat left top;\n\tbackground-size: 234px 32px;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 43px;\n\tmargin-left: -117px;\n\tline-height: 36px;\n\tcolor: #959595!important;\n}\n.place-userbehavior .planto:hover .poiLikeHoverShow{\n\tdisplay: block;\n\tz-index: 5;\n}\n.poiLikeShow{\n\tdisplay: block!important;\n}\n.place-userbehavior .selected .poiLikeShow,\n.place-userbehavior .selected .poiLikeHoverShow{\n\tdisplay: none!important;\n}\n.place-ubloading{\n\tposition: relative;\n\tmin-height: 70px;\n}\n.place-ubloading:before{\n\tcontent: '';\n\tposition: absolute;\n\tleft: 0;\n\twidth: 100%;\n\theight: 70px;\n\ttop: 0;\n\tz-index: 10;\n\tbackground: rgba(255, 255, 255, 0.6) url(http://static.qyer.com/models/common/images/wait_16_2.gif) no-repeat center center;\n}\n.place-userbehavior{\n\theight: 84px;\n\tdisplay: table;\n\twidth: 100%;\n\tbox-sizing: border-box;\n}\n.place-userbehavior > li{\n\tcursor: pointer;\n\tdisplay: table-cell;\n\tposition: relative;\n\ttext-align: center;\n\theight: 84px;\n\tz-index: 1;\n}\n.place-userbehavior > li:before,\n.place-userbehavior > li:after{\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 0;\n\twidth: 40px;\n\theight: 40px;\n\tmargin-left: -20px;\n\tcontent: '';\n}\n.place-userbehavior > li:before{\n\tfont-family: 'Place'!important;\n\tfont-size: 24px;\n\tcolor: #fff;\n\tfont-style:normal;\n  \t-webkit-font-smoothing: antialiased;\n  \t-webkit-text-stroke-width: 0.2px;\n  \t-moz-osx-font-smoothing: grayscale;\n  \ttext-align: center;\n  \tline-height: 40px;\n  \tz-index: 12;\n}\n.place-userbehavior .planto:before{\n\tcontent: '\\e639';\n}\n.place-userbehavior .beento:before{\n\tcontent: '\\e63b';\n}\n.place-userbehavior .lived:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e890';\n}\n.place-userbehavior .addToPlan:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e893';\n}\n.place-userbehavior > li:after{\n\tbackground-color: rgb(67, 158, 97);\n\tborder-radius: 50%;\n\tz-index: 7;\n}\n.place-userbehavior > li:hover{\n\tcolor: rgb(20, 120, 80);\n}\n.place-userbehavior > li:hover:after{\n\tbackground-color: rgb(95, 172, 121);\n}\n.place-userbehavior > li.selected:after{\n\tbackground-color: rgb(236, 236, 236);\n}\n.place-userbehavior > li.selected:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e892';\n\tcolor: rgb(95, 172, 121);\n\tfont-weight: bold;\n}\n.place-userbehavior > li.selected:hover:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e891';\n\tfont-weight: bold;\n}\n.place-userbehavior .fonts{\n\tfont-size:16px;\n\tposition: absolute;\n\twidth: 75px;\n\tmargin-left: -37px;\n\ttop: 50px;\n\tz-index: 4;\n\tleft: 50%;\n}\n.place-userbehavior .beento ul li,\n.place-userbehavior .beento ul{\n\tdisplay: none;\n}\n.place-userbehavior .beento.selected ul{\n\tposition: absolute;\n\tborder: solid 4px #ececec;\n\twidth: 0;\n\theight: 0;\n\tborder-top:solid 4px transparent;\n\tborder-left:solid 4px transparent;\n\ttop:100%;\n\tleft: 100%;\n\tmargin: -15px 0 0 -10px;\n\tdisplay: block;\n}\n.place-userbehavior .beento.selected:hover ul li{\n\tdisplay: block;\n}\n.place-userbehavior .beento.selected:hover ul{\n\twidth: 100px;\n\tleft: 50%;\n\ttop: -7px;\n\tmargin:0 0 0 -50px;\n\tpadding-top: 87px;\n\tdisplay: block;\n\tborder: 1px solid #d7d7d7;\n\tbox-shadow: 0 0 4px rgba(0,0,0,0.15);\n\tbackground-color: #fff;\n\theight: auto;\n}\n.place-userbehavior .beento li{\n\tline-height: 32px;\n\tborder-top: #ececec solid 1px;\n\tmargin: 0 10px;\n\ttext-align: left;\n\ttext-indent: 3px;\n}\n.place-userbehavior .beento li a{\n\tcolor: #959595;\n\tdisplay: block;\n}\n.place-userbehavior .beento li a:hover{\n\tcolor: #0073b6;\n\ttext-decoration: none;\n}\n.place-userbehavior li.addToPlan:hover{\n\tcolor: #0073b6;\n}\n.place-userbehavior li.addToPlan:after{\n\tbackground-color: rgb(37, 150, 218);\n}\n.place-userbehavior li.addToPlan:hover:after{\n\tbackground-color: rgb(65, 166, 244);\n}\n.plcFootprint{\n\tpadding-top: 20px;\n\theight: 84px;\n}\n.plcZIndex{\n\tz-index: 2!important;\n}\n.place-exClass{\n\tposition: relative;\n}\n.place-exClass .beento.selected:hover ul{\n\tpadding-top: 101px!important;\n\ttop: -21px;\n}\n.place-exClass .beento.selected:hover li{\n\tdisplay: block;\n}\n.qui-popup2{\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    background-image:url(http://common2.qyerstatic.com/place/common/basic/images/bg_255_255_255_0.7.png);\n    z-index: 1000;\n    overflow-y: auto;\n    opacity: 0;\n}\n.qui-popup2 > div{\n    display: table;\n    height: 100%;\n    margin: 0 auto;\n}\n.qui-popup2-dt{\n    display: table-cell;\n    vertical-align:middle;\n}\n.qui-popup2-box{\n    margin: 0 auto;\n    background-color: #fff;\n    position: relative;\n    -webkit-box-shadow: 0 0 6px #aaa;\n    -moz-box-shadow: 0 0 6px #aaa;\n    box-shadow: 0 0 6px #aaa;\n    border: solid 1px #ccc;\n    \n    opacity: 0;\n}\n.qui-popup2-box-title{\n    height: 70px;\n    line-height: 70px;\n    font-size: 20px;\n    font-weight: bold;\n    padding-left: 30px;\n}\n.qui-popup2-box-content{\n    -webkit-box-sizing: border-box; \n    -moz-box-sizing: border-box;  \n    box-sizing: border-box; \n    padding: 0 30px;\n}\n.qui-popup2-box-content >iframe{\n    width: 100%;\n    border: none;\n}\n.qui-popup2-box-bottom{\n    text-align: right;\n    height: 70px;\n    line-height: 70px;\n    padding-right: 30px;\n}\n.qui-popup2-closeIcon{\n    position: absolute;\n    right: 10px;\n    top: 10px;  \n    cursor: pointer;\n    background-image: url(\"../../../../common2.qyerstatic.com/place/common/ui/popup2/icons.png\"/*tpa=http://common2.qyerstatic.com/place/common/ui/popup2/icons.png*/);\n    height: 32px;\n    width: 32px;\n    background-repeat: no-repeat;\n    background-position:0px -18px;\n    border-radius: 5px;\n}\n.qui-popup2-closeIcon:hover{\n    background-position: 0px -65px;\n}\n.qui-popup2-cancelBtn{\n    vertical-align: middle;\n}\n.qui-popup2-okBtn{\n    vertical-align: middle;\n    margin-left: 16px;\n}\n.qui-popup2-loadingBtn{\n    vertical-align: middle;\n    display: none;\n    margin-left: 16px;\n}.qui-tip{\n\tposition: fixed;\n\ttop: 100px;\n\tleft: 0;\n\twidth: 100%;\n\ttext-align: center;\n\tdisplay: none;\n\tz-index: 1100;\n}\n.qui-tip-box{\n\tdisplay: inline-block;\n\tmin-width:120px;\n\tmax-width:390px;\n\tpadding:20px 30px;\n\tbackground-color:#fff;\n\tbox-shadow: 0 2px 7px rgba(0,0,0,0.25);\n\tborder: solid 1px #c0c0c0;\n\ttext-align:left;\n\tfont-size: 18px;\n\tline-height: 32px;\n}\n.qui-tip-text { display:block; position:relative; padding-left:34px;}\n.qui-tip-text:before { content:''; position:absolute; left:0; top:4px; width:24px; height:24px; background:#fff url(http://common2.qyerstatic.com/place/common/ui/tip/icons2.png) no-repeat;}\n.qui-tip-box-error .qui-tip-text:before { background-position:0 -80px;}\n.qui-tip-box-warning .qui-tip-text:before { background-position:0 -40px;}\n.qyer_upload{width:580px;border:1px solid #7e7e7e;position:relative;background:#fff;margin:0 auto;}\n.qyer_upload_head{height:29px;padding-top:8px;background:url(http://static.qyer.com/images/common/upload/qyer_upload_head_bg.png) repeat-x;}\n.qyer_upload_head ul{border-left:1px solid #e8e8e8;}\n.qyer_upload_head ul li{float:left;border-right:1px solid #e8e8e8;padding:2px 10px 0;height:25px;line-height:24px;border-top:1px solid #e8e8e8;cursor:pointer;background:#fff;}\n.qyer_upload_head ul .ui_tab_trigger_item_current{color:#077345;padding:0 10px;border-top:3px solid #0ca46c;height:26px;}\n.qyer_upload_item_tit{color:#636363;border-bottom:1px solid #e8e5df;padding:10px;position:relative;z-index:16;height:22px;}\n.qyer_upload_item_tit strong{line-height:22px;float:left;}\n.qyer_upload_item_tit span{line-height:22px;padding-left:10px;}\n.qyer_upload_item_tit span a{color:#006aad;}\n.qyer_upload_item_tit select{float:left;height:22px;border:1px solid #ccc;width:148px;}\n.qyer_upload_t_item{float:left;width:173px;border:1px solid #e8e5e0;height:20px;margin-left:10px;display:inline;position:relative;}\n.qyer_upload_t_item a{margin:4px 4px 4px 4px;float:left;}\n.qyer_upload_t_item a img{float:left;}\n.qyer_upload_t_item input{width:150px;border:0;height:18px;line-height:18px;padding:0 5px 0 1px;}\n.ui_album_poiSelect_div{position:absolute;left:-1px;top:20px;width:316px;border:1px solid #e8e5e0;background:#fff;display:none;}\n.ui_album_poiSelect_search{overflow:hidden;zoom:1;}\n.ui_album_poiSelect_search_title{float:left;width:60px;text-align:center;line-height:28px;padding:0 0;}\n.ui_album_poiSelect_search_item{width:255px;float:right;color:#323232;border-left:1px solid #ebebeb;border-top:1px solid #ebebeb;line-height:28px;}\n.ui_album_poiSelect_search_list{display:block;float:none;padding:0 10px;cursor:pointer;}\n.ui_album_poiSelect_search_list:hover{background:#e6f4d9;}\n.qyer_upload_item_tit .ui_album_poiSelect_search_list span{line-height:28px;padding:0;}\n.ui_album_poiSelect_search_item_none{border-top:0;}\n.qyer_upload_new{float:left;position:relative;}\n.qyer_upload_new input{width:160px;height:20px;border:1px solid #e8e5e0;padding:0 5px;color:#636363;}\n.qyer_upload_new_error{border:1px solid #ffd088;background:#ffffe5;position:absolute;left:0;top:27px;width:152px;padding:4px 9px;color:#323232;display:none;box-shadow:1px 1px 2px #ccc;}\n.qyer_upload_new_error span{background:url(http://common2.qyerstatic.com/place/common/basic/old/images/upload/qyer_upload_new_error_bg.png) no-repeat;width:9px;height:5px;display:block;position:absolute;left:60px;top:-5px;}\n.qyer_upload_item_con{height:300px;position:relative;z-index:15;}\n.qyer_upload_upbtn{padding-top:100px;text-align:center;}\n.qyer_upload_upbtn_hide{padding:0;height:0;overflow:hidden;}\n.qyer_upload_upbtn div{position:relative;height:38px;}\n.qyer_upload_upbtn object{position:absolute;left:226px;top:0;width:126px;height:38px;z-index:18;cursor:pointer;}\n.qyer_upload_upbtn a{position:absolute;left:226px;top:0;width:124px;height:38px;z-index:17;display:inline-block;text-align:center; border:1px solid #4f7c1a; border-radius:3px; overflow:hidden; background:#087346; font:bold 20px/38px arial,\"Microsoft YaHei\",\\5b8b\\4f53,sans-serif; color:#fff; cursor:pointer; overflow:visible; text-shadow:0 -1px 0 #00395b; border-color:#0073b6; background-color:#0073b6;}\n.qyer_upload_upbtn_hide object{left:-9999px;}\n.qyer_upload_upbtn_hide a{left:-9999px;}\n.qyer_upload_list{height:236px;padding:15px 0 0 15px;border-bottom:1px solid #dbdbdb;overflow:hidden;overflow-y:auto;}\n.qyer_upload_list_status{padding-bottom:15px;width:100%;float:left;}\n.qyer_upload_list_status div{height:22px;margin-right:10px;position: relative;margin-bottom: 15px;}\n.qyer_upload_list_status div .filebg{border:1px solid #ccc;display:inline-block;width:330px;height:20px;float: none;}\n.qyer_upload_list_status div em{background:#02734a;display:block;margin:0;height:20px;}\n.qyer_upload_list_status div strong{color:#fff;padding-left:10px;display:block;height:22px;line-height:22px;position: absolute;top: 0;z-index: 2;}\n.qyer_upload_list_status span{vertical-align: middle;}\n.qyer_upload_list_status span.fr{width:90px;float:right;line-height:22px;margin-top:0}\n.qyer_upload_list_status .fstatus{margin-left: 10px;}\n.qyer_upload_list_status .icon_finish{color:#323232;}\n.qyer_upload_list_file{width:100%;float:left;margin-bottom:15px;}\n.qyer_upload_list_file .fl{line-height:22px;margin-right:10px;}\n.qyer_upload_list_file input{float:left;height:22px;}\n.qyer_upload_list_file .fr{width:240px;}\n.qyer_upload_list_file .fr span{float:left;}\n.qyer_upload_list_file .fr .qcz{width:130px;float:right;}\n.qyer_upload_network_url{padding:70px 0 0 35px;height:230px;}\n.qyer_upload_network_url .fl .ui_input{width:438px;height:26px;line-height:26px;font-size:14px;}\n.qyer_upload_network_url .qyer_upload_new_error{top:33px;}\n.qyer_upload_layout_error{border:5px solid #e6e6e6; border-color:rgba(102,102,102,0.4); border-radius:5px;background:#fff;width:350px;padding:10px;position:absolute;left:100px;top:150px;z-index:40;display:none;}\n.qyer_upload_layout_form{border:5px solid #e6e6e6; border-color:rgba(102,102,102,0.4); border-radius:5px;background:#fff;width:220px;text-align:center;position:absolute;left:170px;top:120px;z-index:41;padding:15px 0;display:none;}\n.qyer_upload_layout_form input{margin:0 5px;}\n.qyer_upload_mylist .qyer_upload_photo_list {height: 216px; margin: 15px 0 20px 5px; overflow: hidden; overflow-y: auto; }\n.qyer_upload_mylist .qyer_upload_photo_list li {float: left; margin: 5px 0 0 5px; display: inline; height: 80px; width: 80px; overflow: hidden; cursor: pointer; }\n.qyer_upload_photo_list li .icon_current {margin-top: -80px; display: none; width: 100%; height: 100%; background: url(http://static.qyer.com/images/common/upload/icon_current.png) repeat; float: left; }\n.qyer_upload_photo_list .current .icon_current {display: block; }\n.qyer_upload_photo_list li img {float: left; }\n.qyer_upload_photo_list li .icon_current span {display: block; height: 100%; width: 100%; background: url(http://static.qyer.com/images/common/upload/icon_current_draw.png) no-repeat center center; }\n.qyer_upload_mylist .qyer_upload_btn {border-top: 1px solid #e8e5df; }\n.uploadpopup .qui-popup2-box-content{padding: 0;}\n.uploadpopup .qui-popup2-box-bottom{display: none;}\n.uploadpopup .qui-popup2-closeIcon{position: absolute; z-index: 1; top: 5px; right: 5px; width: 26px; height: 26px; background: url(http://static.qyer.com/images/common/tpl/pup_close.png) no-repeat 0 0; cursor: pointer;border-radius: 0;}\n.uploadpopup .qui-popup2-closeIcon:hover{background-position: 0 -26px;}\n.uploadpopup .qui-popup2-box{border: 5px solid #aeadad; border-color: rgba(0,0,0,0.3); border-radius: 8px;}\n.x-loading-page{\n\tmargin-top:16px;\n\theight:32px;\n\tclear:both;\n\tbackground:url(http://static.qyer.com/images/common/londing32.gif) no-repeat center;\n}\n.uploadpopup .p10{padding: 10px;}\n.uploadpopup .mr10{margin-right: 10px;}.switchRoute{position: relative;}\n.switchRoute-title ._title{height: 63px;background:#e0f1dd; \n\ttext-align: center;border-bottom: 1px solid #c0c0c0;\n\tline-height: 63px;font-size: 18px;}\n.switchRoute-title ._title img{vertical-align: middle;margin-right: 10px;}\n.switchRoute-main,\n.switchRoute-footer{background: #fff;}\n.switchRoute-main ._content{padding: 30px 0;text-align: center;font-size: 18px;}\n.switchRouteBox .qui-popup-box-content{padding: 0;}\n.switchRouteBox .qui-popup-closeIcon{z-index: 1;}\n.switchRouteBox .qui-popup-box-bottom{text-align: center;}.qui-confirm{\n\tposition: fixed;\n\ttop: 0px;\n\tleft: 0px;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-image:url(http://static.qyer.com/models/common/images/bg_255_255_255_0.7.png);\n\tdisplay: table;\n\tz-index: 1200;\n\tdisplay: none;\n\topacity: 0;\n}\n.qui-confirm > div{\n\tdisplay: table-cell;\n\tvertical-align:middle;\n}\n.qui-confirm-box{\n\tmargin: 0 auto;\n\twidth: 300px;\n\tposition: relative;\n\ttop:-50px;\n\topacity: 0;\n\toverflow: hidden;\n\tbox-shadow: 0px 0px 6px #aaa;\n    border: solid 1px #ccc;\n    background-color: #fff;\n}\n.qui-confirm-box-title{\n    height: 30px;\n    color: #666;\n    line-height: 30px;\n    margin-bottom: 20px;\n    padding-left: 20px;\n    font-weight: bold;\n}\n.qui-confirm-box-content{\n\tposition: relative;\n}\n.qui-confirm-box-content-icon{\n\tfloat: left;\n\tbackground-image: url(\"../../../../static.qyer.com/models/common/ui/confirm/icons.png\"/*tpa=http://static.qyer.com/models/common/ui/confirm/icons.png*/);\n\tbackground-repeat: no-repeat;\n    height: 32px;\n    margin: -16px 0 0 10px;\n    position: absolute;\n    top: 50%;\n    vertical-align: middle;\n    width: 32px;\n}\n.qui-confirm-box-content-iconOK{\n\tbackground-position: 0px -67px;\n}\n.qui-confirm-box-content-iconError{\n\tbackground-position: 0px -12px;\n}\n.qui-confirm-box-content-iconWarning{\n\tbackground-position: 0px -121px;\n}\n.qui-confirm-box-content-text{\n\tcolor: #666;\n\theight: 100%;\n\tmargin: 0 20px 0 60px;\n}\n.qui-confirm-box-bottom{\n\tbackground-color: #fff;\n\ttext-align: right;\n\theight: 50px;\n\tline-height: 50px;\n\tpadding-right: 20px;\n}\n.qui-confirm-okBtn{}\n.qui-confirm-cancelBtn{}\n.qui-confirm-closeIcon{\n\tposition: absolute;\n\tright: 10px;\n\ttop: 10px;\t\n\tcursor: pointer;\n\tbackground-image: url(\"../../../../static.qyer.com/models/common/ui/confirm/icons.png\"/*tpa=http://static.qyer.com/models/common/ui/confirm/icons.png*/);\n\theight: 32px;\n\twidth: 32px;\n\tbackground-repeat: no-repeat;\n\tbackground-position:0px -192px;\n\tborder-radius: 5px;\n}\n.qui-confirm-closeIcon:hover{\n\tbackground-position: 0px -230px;\n}\n.qui-confirm-box-clearFloat{\n\tclear: both;\n\theight:0px;\n\toverflow: hidden;\n}\n.qui-select {\n    position: relative;\n    display: inline-block;\n    width: 100px;\n    height: 30px;\n    overflow: visible;\n}\n.qui-select-disable > .titles{\n    background-color: #eee  !important;\n    cursor: default  !important;\n}\n.qui-select .titles {\n    background: url(\"../../../../common2.qyerstatic.com/place/common/ui/select/icons.png\"/*tpa=http://common2.qyerstatic.com/place/common/ui/select/icons.png*/) ;\n    background-repeat: no-repeat;\n    background-position: center right;\n    background-color: #fff;\n    border: 1px solid #C0C0C0;\n    color: #636363;\n    cursor: pointer;\n    display: block;\n    font-size: 14px;\n    line-height: 30px;\n    padding: 0 10px 0 5px;\n    width: 100%;\n    height: 100%;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n.qui-select .titles .title-text {\n    background-position: 0 -4px;\n    margin-left: 5px;\n    white-space: nowrap;\n}\n.qui-select .contents {\n    background-color: #FFFFFF;\n    border: 1px solid #C0C0C0;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n    display: none;\n    line-height: 38px;\n    position: absolute;\n    top: 31px;\n    width: 180px;\n    max-height: 235px;\n    overflow: auto;\n    z-index: 10;\n}\n.qui-select .contents ul li:first-child {\n    border-top: 0 none;\n}\n.qui-select .contents ul li {\n    border-top: 1px solid #EBEBEB;\n    font-size: 14px;\n    line-height: 38px;\n    cursor: pointer;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n.qui-select .contents ul li:hover {\n    background-color: #d9eed7;\n}\n.qui-select .contents ul li a{\n    padding-left: 10px;\n    color: #636363;\n    text-decoration: none;\n}\n \n"),
$(document).ready(function(){function e(e){var t=document.cookie;return"string"==typeof e?(document.cookie=e,document.cookie):"string"==typeof t&&t}function t(){if($(".qui-popup-logindialog").length>0)return!1;var t=e();if(t){for(var n=t.split(";"),i=n.length,o=0,r=!0;o<i;o++)if("isDoLogin"==$.trim(n[o].split("=")[0])){r=!1;break}if(r){qyerUtil.doLogin({databnipg:"autopopup"});var a=new Date;a.setTime(a.getTime()+864e5),e("isDoLogin=828;expires="+a.toGMTString()+";path=/")}}else qyerUtil.doLogin({databnipg:"autopopup"})}$("<style>.qyer_layer_fix{display:none!important}</style>").appendTo("body"),setTimeout(t,1e4)}),$(function(){function e(){$(".qyer_head_crumb .arrow").removeClass("hover"),$(".qyer_head_crumb_pulldown").hide()}var t,n,i,o,r,a;$(".qyer_head_crumb .arrow").hover(function(){a=$(this),t=a.parent(".drop"),o=t.height(),n=t.offset().left,i=t.offset().top;var e=$(this).attr("data");window.clearTimeout(r),$(".qyer_head_crumb .arrow").removeClass("hover"),$(this).addClass("hover"),$(".qyer_head_crumb_pulldown").hide(),$("."+e).css({left:n,top:i+o}).show()},function(){}),$("http://common1.qyerstatic.com/place/js/poi/.qyer_head_crumb .drop").hover(function(){},function(){r=window.setTimeout(e,300)}),$(".qyer_head_crumb_pulldown").hover(function(){window.clearTimeout(r),a.addClass("hover"),$(this).show()},function(){r=window.setTimeout(e,300)})}),$("body").off("click","._addToLikeList").on("click","._addToLikeList",function(e){function t(e,t,n){var i=$.extend({oper:"planto",type:2,id:null,status:1},e);i[i.oper]=i.status,delete i.status,qyerUtil.doAjax({url:"http://common1.qyerstatic.com/public.php?action=feeling",data:i,onSuccess:function(e){$.isFunction(t)&&t.call(this,e)},onError:function(e){n(),requirejs(["common/ui/tip/tip"],function(t){t.tip({text:e.data.msg,type:"error"})})}})}function n(){var e={liking:"plcAddToLikeList",liked:"plcCancelToLikeList"},n=["liked","liking"],o=i.attr("data-status")-0;t({id:i.attr("data-pid"),type:i.attr("data-type"),status:o},function(t){if(i.removeClass("_disabled"),0==t.error_code&&1==t.data.result){i.removeClass(e[n[o]]).addClass(e[n[1-o]]),i.attr("data-status",1-o);var r=$("table");$("table").length>0&&r.find("a[data-id="+i.attr("data-pid")+"]").attr("data-status",1-o).text(o?"取消想去":"加入想去"),$("body").trigger("addToLikeListEvent")}else requirejs(["common/ui/tip/tip"],function(e){e.tip({text:"操作失败"})})},function(){i.removeClass("_disabled")})}if(e.stopPropagation(),e.preventDefault(),!qyerUtil.isLogin())return!($(".qui-popup-logindialog").length>0&&"block"==$(".qui-popup-logindialog").css("display"))&&void qyerUtil.doLogin();var i=$(this);return!i.hasClass("_disabled")&&(i.addClass("_disabled"),qyerUtil.doTrackCode(i.attr("data-ipg-"+(1==i.attr("data-status")?"add":"delete"))),n(),!1)}),$(function(){function e(e){this.str=['<div id="plcHotelBox">','<ul id="plcHotelTips">','<li class="fontYaHei">','<span class="round"><img src="../../../../static.qyer.com/models/project/place/images/icon-hotelList1.png"/*tpa=http://static.qyer.com/models/project/place/images/icon-hotelList1.png*//></span>',"<em>多数订单可免费取消</em>","</li>",'<li class="fontYaHei">','<span class="round"><img src="../../../../static.qyer.com/models/project/place/images/icon-hotelList2.png"/*tpa=http://static.qyer.com/models/project/place/images/icon-hotelList2.png*//></span>',"<em>预订无需注册，下单即时确认</em>","</li>",'<li class="fontYaHei">','<span class="round"><img src="../../../../static.qyer.com/models/project/place/images/icon-hotelList3.png"/*tpa=http://static.qyer.com/models/project/place/images/icon-hotelList3.png*//></span>',"<em>保证无手续费  保证最优惠房价</em>","</li>",'<li class="fontYaHei">','<span class="round"><img src="../../../../static.qyer.com/models/project/place/images/icon-hotelList4.png"/*tpa=http://static.qyer.com/models/project/place/images/icon-hotelList4.png*//></span>',"<em>24/7全天中文客服支持</em>","</li>","</ul>","</div>"].join(""),this["class"]="ct",$.extend(this,e||{})}e.prototype={hideBox:function(){this.$dom.hide()},showBox:function(e,t){this.$dom.css(e).removeClass("ct cb").addClass(t).show()},init:function(){this.$dom=$(this.str),0!=this.tar.length&&(this.hideBox(),$(this.$dom).appendTo("body"))}};var t=new e({tar:$("#plcHotelTar")});t.init(),t.timer=!1,$("#plcHotelTar").on({mouseenter:function(){t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){var e=$(window).scrollTop(),n=$("#plcHotelTar");if(0!=n.length){var i=n.offset(),o=n.width(),r=n.height(),a=322,s=280;t.showBox({top:e-0+$(window).height()>=i.top-0+r+s+20?i.top-0+r+20:i.top-0-s-10,left:i.left-a/2+o/2},e-0+$(window).height()>=i.top-0+r+s+20?"ct":"cb")}},400)},mouseleave:function(){t.timer&&clearTimeout(t.timer),t.hideBox()}})});