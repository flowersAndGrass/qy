function getListener(e,t,n){var i;return t=t.toLowerCase(),(i=e.__allListeners||n&&(e.__allListeners={}))&&(i[t]||n&&(i[t]=[]))}function getDomNode(e,t,n,i,o,r){var a,s=i&&e[t];for(!s&&(s=e[n]);!s&&(a=(a||e).parentNode);){if("BODY"==a.tagName||r&&!r(a))return null;s=a[n]}return s&&o&&!o(s)?getDomNode(s,t,n,!1,o):s}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(e,t){function n(e){var t=e.length,n=ce.type(e);return!ce.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)))}function i(e){var t=Ee[e]={};return ce.each(e.match(pe)||[],function(e,n){t[n]=!0}),t}function o(e,n,i,o){if(ce.acceptData(e)){var r,a,s=ce.expando,l=e.nodeType,d=l?ce.cache:e,c=l?e[s]:e[s]&&s;if(c&&d[c]&&(o||d[c].data)||i!==t||"string"!=typeof n)return c||(c=l?e[s]=te.pop()||ce.guid++:s),d[c]||(d[c]=l?{}:{toJSON:ce.noop}),"object"!=typeof n&&"function"!=typeof n||(o?d[c]=ce.extend(d[c],n):d[c].data=ce.extend(d[c].data,n)),a=d[c],o||(a.data||(a.data={}),a=a.data),i!==t&&(a[ce.camelCase(n)]=i),"string"==typeof n?(r=a[n],null==r&&(r=a[ce.camelCase(n)])):r=a,r}}function r(e,t,n){if(ce.acceptData(e)){var i,o,r=e.nodeType,a=r?ce.cache:e,l=r?e[ce.expando]:ce.expando;if(a[l]){if(t&&(i=n?a[l]:a[l].data)){ce.isArray(t)?t=t.concat(ce.map(t,ce.camelCase)):t in i?t=[t]:(t=ce.camelCase(t),t=t in i?[t]:t.split(" ")),o=t.length;for(;o--;)delete i[t[o]];if(n?!s(i):!ce.isEmptyObject(i))return}(n||(delete a[l].data,s(a[l])))&&(r?ce.cleanData([e],!0):ce.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function a(e,n,i){if(i===t&&1===e.nodeType){var o="data-"+n.replace(Se,"-$1").toLowerCase();if(i=e.getAttribute(o),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:Te.test(i)?ce.parseJSON(i):i)}catch(r){}ce.data(e,n,i)}else i=t}return i}function s(e){var t;for(t in e)if(("data"!==t||!ce.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function d(){return!1}function c(){try{return K.activeElement}catch(e){}}function u(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function p(e,t,n){if(ce.isFunction(t))return ce.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return ce.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(Me.test(t))return ce.filter(t,e,n);t=ce.filter(t,e)}return ce.grep(e,function(e){return ce.inArray(e,t)>=0!==n})}function h(e){var t=Ve.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function f(e,t){return ce.nodeName(e,"table")&&ce.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function m(e){return e.type=(null!==ce.find.attr(e,"type"))+"/"+e.type,e}function g(e){var t=ot.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function b(e,t){for(var n,i=0;null!=(n=e[i]);i++)ce._data(n,"globalEval",!t||ce._data(t[i],"globalEval"))}function v(e,t){if(1===t.nodeType&&ce.hasData(e)){var n,i,o,r=ce._data(e),a=ce._data(t,r),s=r.events;if(s){delete a.handle,a.events={};for(n in s)for(i=0,o=s[n].length;i<o;i++)ce.event.add(t,n,s[n][i])}a.data&&(a.data=ce.extend({},a.data))}}function y(e,t){var n,i,o;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!ce.support.noCloneEvent&&t[ce.expando]){o=ce._data(t);for(i in o.events)ce.removeEvent(t,i,o.handle);t.removeAttribute(ce.expando)}"script"===n&&t.text!==e.text?(m(t).text=e.text,g(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),ce.support.html5Clone&&e.innerHTML&&!ce.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&tt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}}function x(e,n){var i,o,r=0,a=typeof e.getElementsByTagName!==G?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==G?e.querySelectorAll(n||"*"):t;if(!a)for(a=[],i=e.childNodes||e;null!=(o=i[r]);r++)!n||ce.nodeName(o,n)?a.push(o):ce.merge(a,x(o,n));return n===t||n&&ce.nodeName(e,n)?ce.merge([e],a):a}function _(e){tt.test(e.type)&&(e.defaultChecked=e.checked)}function w(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,o=Ct.length;o--;)if(t=Ct[o]+n,t in e)return t;return i}function k(e,t){return e=t||e,"none"===ce.css(e,"display")||!ce.contains(e.ownerDocument,e)}function C(e,t){for(var n,i,o,r=[],a=0,s=e.length;a<s;a++)i=e[a],i.style&&(r[a]=ce._data(i,"olddisplay"),n=i.style.display,t?(r[a]||"none"!==n||(i.style.display=""),""===i.style.display&&k(i)&&(r[a]=ce._data(i,"olddisplay",N(i.nodeName)))):r[a]||(o=k(i),(n&&"none"!==n||!o)&&ce._data(i,"olddisplay",o?n:ce.css(i,"display"))));for(a=0;a<s;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?r[a]||"":"none"));return e}function E(e,t,n){var i=bt.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function T(e,t,n,i,o){for(var r=n===(i?"border":"content")?4:"width"===t?1:0,a=0;r<4;r+=2)"margin"===n&&(a+=ce.css(e,n+kt[r],!0,o)),i?("content"===n&&(a-=ce.css(e,"padding"+kt[r],!0,o)),"margin"!==n&&(a-=ce.css(e,"border"+kt[r]+"Width",!0,o))):(a+=ce.css(e,"padding"+kt[r],!0,o),"padding"!==n&&(a+=ce.css(e,"border"+kt[r]+"Width",!0,o)));return a}function S(e,t,n){var i=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=ct(e),a=ce.support.boxSizing&&"border-box"===ce.css(e,"boxSizing",!1,r);if(o<=0||null==o){if(o=ut(e,t,r),(o<0||null==o)&&(o=e.style[t]),vt.test(o))return o;i=a&&(ce.support.boxSizingReliable||o===e.style[t]),o=parseFloat(o)||0}return o+T(e,t,n||(a?"border":"content"),i,r)+"px"}function N(e){var t=K,n=xt[e];return n||(n=$(e,t),"none"!==n&&n||(dt=(dt||ce("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(dt[0].contentWindow||dt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=$(e,t),dt.detach()),xt[e]=n),n}function $(e,t){var n=ce(t.createElement(e)).appendTo(t.body),i=ce.css(n[0],"display");return n.remove(),i}function q(e,t,n,i){var o;if(ce.isArray(t))ce.each(t,function(t,o){n||Tt.test(e)?i(e,o):q(e+"["+("object"==typeof o?t:"")+"]",o,n,i)});else if(n||"object"!==ce.type(t))i(e,t);else for(o in t)q(e+"["+o+"]",t[o],n,i)}function A(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o=0,r=t.toLowerCase().match(pe)||[];if(ce.isFunction(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function I(e,t,n,i){function o(s){var l;return r[s]=!0,ce.each(e[s]||[],function(e,s){var d=s(t,n,i);return"string"!=typeof d||a||r[d]?a?!(l=d):void 0:(t.dataTypes.unshift(d),o(d),!1)}),l}var r={},a=e===zt;return o(t.dataTypes[0])||!r["*"]&&o("*")}function D(e,n){var i,o,r=ce.ajaxSettings.flatOptions||{};for(o in n)n[o]!==t&&((r[o]?e:i||(i={}))[o]=n[o]);return i&&ce.extend(!0,e,i),e}function R(e,n,i){for(var o,r,a,s,l=e.contents,d=e.dataTypes;"*"===d[0];)d.shift(),r===t&&(r=e.mimeType||n.getResponseHeader("Content-Type"));if(r)for(s in l)if(l[s]&&l[s].test(r)){d.unshift(s);break}if(d[0]in i)a=d[0];else{for(s in i){if(!d[0]||e.converters[s+" "+d[0]]){a=s;break}o||(o=s)}a=a||o}if(a)return a!==d[0]&&d.unshift(a),i[a]}function U(e,t,n,i){var o,r,a,s,l,d={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)d[a.toLowerCase()]=e.converters[a];for(r=c.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=c.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(a=d[l+" "+r]||d["* "+r],!a)for(o in d)if(s=o.split(" "),s[1]===r&&(a=d[l+" "+s[0]]||d["* "+s[0]])){a===!0?a=d[o]:d[o]!==!0&&(r=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}function O(){try{return new e.XMLHttpRequest}catch(t){}}function B(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function L(){return setTimeout(function(){Qt=t}),Qt=ce.now()}function j(e,t,n){for(var i,o=(rn[t]||[]).concat(rn["*"]),r=0,a=o.length;r<a;r++)if(i=o[r].call(n,t,e))return i}function P(e,t,n){var i,o,r=0,a=on.length,s=ce.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=Qt||L(),n=Math.max(0,d.startTime+d.duration-t),i=n/d.duration||0,r=1-i,a=0,l=d.tweens.length;a<l;a++)d.tweens[a].run(r);return s.notifyWith(e,[d,r,n]),r<1&&l?n:(s.resolveWith(e,[d]),!1)},d=s.promise({elem:e,props:ce.extend({},t),opts:ce.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Qt||L(),duration:n.duration,tweens:[],createTween:function(t,n){var i=ce.Tween(e,d.opts,t,n,d.opts.specialEasing[t]||d.opts.easing);return d.tweens.push(i),i},stop:function(t){var n=0,i=t?d.tweens.length:0;if(o)return this;for(o=!0;n<i;n++)d.tweens[n].run(1);return t?s.resolveWith(e,[d,t]):s.rejectWith(e,[d,t]),this}}),c=d.props;for(H(c,d.opts.specialEasing);r<a;r++)if(i=on[r].call(d,e,c,d.opts))return i;return ce.map(c,j,d),ce.isFunction(d.opts.start)&&d.opts.start.call(e,d),ce.fx.timer(ce.extend(l,{elem:e,anim:d,queue:d.opts.queue})),d.progress(d.opts.progress).done(d.opts.done,d.opts.complete).fail(d.opts.fail).always(d.opts.always)}function H(e,t){var n,i,o,r,a;for(n in e)if(i=ce.camelCase(n),o=t[i],r=e[n],ce.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),a=ce.cssHooks[i],a&&"expand"in a){r=a.expand(r),delete e[i];for(n in r)n in e||(e[n]=r[n],t[n]=o)}else t[i]=o}function M(e,t,n){var i,o,r,a,s,l,d=this,c={},u=e.style,p=e.nodeType&&k(e),h=ce._data(e,"fxshow");n.queue||(s=ce._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,ce.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===ce.css(e,"display")&&"none"===ce.css(e,"float")&&(ce.support.inlineBlockNeedsLayout&&"inline"!==N(e.nodeName)?u.zoom=1:u.display="inline-block")),n.overflow&&(u.overflow="hidden",ce.support.shrinkWrapBlocks||d.always(function(){u.overflow=n.overflow[0],u.overflowX=n.overflow[1],u.overflowY=n.overflow[2]}));for(i in t)if(o=t[i],en.exec(o)){if(delete t[i],r=r||"toggle"===o,o===(p?"hide":"show"))continue;c[i]=h&&h[i]||ce.style(e,i)}if(!ce.isEmptyObject(c)){h?"hidden"in h&&(p=h.hidden):h=ce._data(e,"fxshow",{}),r&&(h.hidden=!p),p?ce(e).show():d.done(function(){ce(e).hide()}),d.done(function(){var t;ce._removeData(e,"fxshow");for(t in c)ce.style(e,t,c[t])});for(i in c)a=j(p?h[i]:0,i,d),i in h||(h[i]=a.start,p&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function z(e,t,n,i,o){return new z.prototype.init(e,t,n,i,o)}function F(e,t){var n,i={height:e},o=0;for(t=t?1:0;o<4;o+=2-t)n=kt[o],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function W(e){return ce.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var V,X,G=typeof t,Y=e.location,K=e.document,J=K.documentElement,Q=e.jQuery,Z=e.$,ee={},te=[],ne="1.10.2",ie=te.concat,oe=te.push,re=te.slice,ae=te.indexOf,se=ee.toString,le=ee.hasOwnProperty,de=ne.trim,ce=function(e,t){return new ce.fn.init(e,t,X)},ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,pe=/\S+/g,he=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,fe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,me=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ge=/^[\],:{}\s]*$/,be=/(?:^|:|,)(?:\s*\[)+/g,ve=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ye=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,xe=/^-ms-/,_e=/-([\da-z])/gi,we=function(e,t){return t.toUpperCase()},ke=function(e){(K.addEventListener||"load"===e.type||"complete"===K.readyState)&&(Ce(),ce.ready())},Ce=function(){K.addEventListener?(K.removeEventListener("DOMContentLoaded",ke,!1),e.removeEventListener("load",ke,!1)):(K.detachEvent("onreadystatechange",ke),e.detachEvent("onload",ke))};ce.fn=ce.prototype={jquery:ne,constructor:ce,init:function(e,n,i){var o,r;if(!e)return this;if("string"==typeof e){if(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:fe.exec(e),!o||!o[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(o[1]){if(n=n instanceof ce?n[0]:n,ce.merge(this,ce.parseHTML(o[1],n&&n.nodeType?n.ownerDocument||n:K,!0)),me.test(o[1])&&ce.isPlainObject(n))for(o in n)ce.isFunction(this[o])?this[o](n[o]):this.attr(o,n[o]);return this}if(r=K.getElementById(o[2]),r&&r.parentNode){if(r.id!==o[2])return i.find(e);this.length=1,this[0]=r}return this.context=K,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ce.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ce.makeArray(e,this))},selector:"",length:0,toArray:function(){return re.call(this)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=ce.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ce.each(this,e,t)},ready:function(e){return ce.ready.promise().done(e),this},slice:function(){return this.pushStack(re.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},map:function(e){return this.pushStack(ce.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:oe,sort:[].sort,splice:[].splice},ce.fn.init.prototype=ce.fn,ce.extend=ce.fn.extend=function(){var e,n,i,o,r,a,s=arguments[0]||{},l=1,d=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||ce.isFunction(s)||(s={}),d===l&&(s=this,--l);l<d;l++)if(null!=(r=arguments[l]))for(o in r)e=s[o],i=r[o],s!==i&&(c&&i&&(ce.isPlainObject(i)||(n=ce.isArray(i)))?(n?(n=!1,a=e&&ce.isArray(e)?e:[]):a=e&&ce.isPlainObject(e)?e:{},s[o]=ce.extend(c,a,i)):i!==t&&(s[o]=i));return s},ce.extend({expando:"jQuery"+(ne+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ce&&(e.$=Z),t&&e.jQuery===ce&&(e.jQuery=Q),ce},isReady:!1,readyWait:1,holdReady:function(e){e?ce.readyWait++:ce.ready(!0)},ready:function(e){if(e===!0?!--ce.readyWait:!ce.isReady){if(!K.body)return setTimeout(ce.ready);ce.isReady=!0,e!==!0&&--ce.readyWait>0||(V.resolveWith(K,[ce]),ce.fn.trigger&&ce(K).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ce.type(e)},isArray:Array.isArray||function(e){return"array"===ce.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?ee[se.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==ce.type(e)||e.nodeType||ce.isWindow(e))return!1;try{if(e.constructor&&!le.call(e,"constructor")&&!le.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ce.support.ownLast)for(n in e)return le.call(e,n);for(n in e);return n===t||le.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||K;var i=me.exec(e),o=!n&&[];return i?[t.createElement(i[1])]:(i=ce.buildFragment([e],t,o),o&&ce(o).remove(),ce.merge([],i.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=ce.trim(t),t&&ge.test(t.replace(ve,"@").replace(ye,"]").replace(be,"")))?new Function("return "+t)():void ce.error("Invalid JSON: "+t)},parseXML:function(n){var i,o;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(o=new DOMParser,i=o.parseFromString(n,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(n))}catch(r){i=t}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||ce.error("Invalid XML: "+n),i},noop:function(){},globalEval:function(t){t&&ce.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(xe,"ms-").replace(_e,we)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var o,r=0,a=e.length,s=n(e);if(i){if(s)for(;r<a&&(o=t.apply(e[r],i),o!==!1);r++);else for(r in e)if(o=t.apply(e[r],i),o===!1)break}else if(s)for(;r<a&&(o=t.call(e[r],r,e[r]),o!==!1);r++);else for(r in e)if(o=t.call(e[r],r,e[r]),o===!1)break;return e},trim:de&&!de.call("\ufeff ")?function(e){return null==e?"":de.call(e)}:function(e){return null==e?"":(e+"").replace(he,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?ce.merge(i,"string"==typeof e?[e]:e):oe.call(i,e)),i},inArray:function(e,t,n){var i;if(t){if(ae)return ae.call(t,e,n);for(i=t.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var i=n.length,o=e.length,r=0;if("number"==typeof i)for(;r<i;r++)e[o++]=n[r];else for(;n[r]!==t;)e[o++]=n[r++];return e.length=o,e},grep:function(e,t,n){var i,o=[],r=0,a=e.length;for(n=!!n;r<a;r++)i=!!t(e[r],r),n!==i&&o.push(e[r]);return o},map:function(e,t,i){var o,r=0,a=e.length,s=n(e),l=[];if(s)for(;r<a;r++)o=t(e[r],r,i),null!=o&&(l[l.length]=o);else for(r in e)o=t(e[r],r,i),null!=o&&(l[l.length]=o);return ie.apply([],l)},guid:1,proxy:function(e,n){var i,o,r;return"string"==typeof n&&(r=e[n],n=e,e=r),ce.isFunction(e)?(i=re.call(arguments,2),o=function(){return e.apply(n||this,i.concat(re.call(arguments)))},o.guid=e.guid=e.guid||ce.guid++,o):t},access:function(e,n,i,o,r,a,s){var l=0,d=e.length,c=null==i;if("object"===ce.type(i)){r=!0;for(l in i)ce.access(e,n,l,i[l],!0,a,s)}else if(o!==t&&(r=!0,ce.isFunction(o)||(s=!0),c&&(s?(n.call(e,o),n=null):(c=n,n=function(e,t,n){return c.call(ce(e),n)})),n))for(;l<d;l++)n(e[l],i,s?o:o.call(e[l],l,n(e[l],i)));return r?e:c?n.call(e):d?n(e[0],i):a},now:function(){return(new Date).getTime()},swap:function(e,t,n,i){var o,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];o=n.apply(e,i||[]);for(r in t)e.style[r]=a[r];return o}}),ce.ready.promise=function(t){if(!V)if(V=ce.Deferred(),"complete"===K.readyState)setTimeout(ce.ready);else if(K.addEventListener)K.addEventListener("DOMContentLoaded",ke,!1),e.addEventListener("load",ke,!1);else{K.attachEvent("onreadystatechange",ke),e.attachEvent("onload",ke);var n=!1;try{n=null==e.frameElement&&K.documentElement}catch(i){}n&&n.doScroll&&!function o(){if(!ce.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}Ce(),ce.ready()}}()}return V.promise(t)},ce.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){ee["[object "+t+"]"]=t.toLowerCase()}),X=ce(K),function(e,t){function n(e,t,n,i){var o,r,a,s,l,d,c,u,f,m;if((t?t.ownerDocument||t:P)!==I&&A(t),t=t||I,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(R&&!i){if(o=ye.exec(e))if(a=o[1]){if(9===s){if(r=t.getElementById(a),!r||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&L(t,r)&&r.id===a)return n.push(r),n}else{if(o[2])return ee.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&k.getElementsByClassName&&t.getElementsByClassName)return ee.apply(n,t.getElementsByClassName(a)),n}if(k.qsa&&(!U||!U.test(e))){if(u=c=j,f=t,m=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(d=p(e),(c=t.getAttribute("id"))?u=c.replace(we,"\\$&"):t.setAttribute("id",u),u="[id='"+u+"'] ",l=d.length;l--;)d[l]=u+h(d[l]);f=he.test(e)&&t.parentNode||t,m=d.join(",")}if(m)try{return ee.apply(n,f.querySelectorAll(m)),n}catch(g){}finally{c||t.removeAttribute("id")}}}return _(e.replace(de,"$1"),t,n,i)}function i(){function e(n,i){return t.push(n+=" ")>E.cacheLength&&delete e[t.shift()],e[n]=i}var t=[];return e}function o(e){return e[j]=!0,e}function r(e){var t=I.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var n=e.split("|"),i=e.length;i--;)E.attrHandle[n[i]]=t}function s(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function l(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function d(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return o(function(t){return t=+t,o(function(n,i){for(var o,r=e([],n.length,t),a=r.length;a--;)n[o=r[a]]&&(n[o]=!(i[o]=n[o]))})})}function u(){}function p(e,t){var i,o,r,a,s,l,d,c=F[e+" "];if(c)return t?0:c.slice(0);for(s=e,l=[],d=E.preFilter;s;){i&&!(o=ue.exec(s))||(o&&(s=s.slice(o[0].length)||s),l.push(r=[])),i=!1,(o=pe.exec(s))&&(i=o.shift(),r.push({value:i,type:o[0].replace(de," ")}),s=s.slice(i.length));for(a in E.filter)!(o=be[a].exec(s))||d[a]&&!(o=d[a](o))||(i=o.shift(),r.push({value:i,type:a,matches:o}),s=s.slice(i.length));if(!i)break}return t?s.length:s?n.error(e):F(e,l).slice(0)}function h(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function f(e,t,n){var i=t.dir,o=n&&"parentNode"===i,r=M++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var s,l,d,c=H+" "+r;if(a){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||o)if(d=t[j]||(t[j]={}),(l=d[i])&&l[0]===c){if((s=l[1])===!0||s===C)return s===!0}else if(l=d[i]=[c],l[1]=e(t,n,a)||C,l[1]===!0)return!0}}function m(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function g(e,t,n,i,o){for(var r,a=[],s=0,l=e.length,d=null!=t;s<l;s++)(r=e[s])&&(n&&!n(r,i,o)||(a.push(r),d&&t.push(s)));return a}function b(e,t,n,i,r,a){return i&&!i[j]&&(i=b(i)),r&&!r[j]&&(r=b(r,a)),o(function(o,a,s,l){var d,c,u,p=[],h=[],f=a.length,m=o||x(t||"*",s.nodeType?[s]:s,[]),b=!e||!o&&t?m:g(m,p,e,s,l),v=n?r||(o?e:f||i)?[]:a:b;if(n&&n(b,v,s,l),i)for(d=g(v,h),i(d,[],s,l),c=d.length;c--;)(u=d[c])&&(v[h[c]]=!(b[h[c]]=u));if(o){if(r||e){if(r){for(d=[],c=v.length;c--;)(u=v[c])&&d.push(b[c]=u);r(null,v=[],d,l)}for(c=v.length;c--;)(u=v[c])&&(d=r?ne.call(o,u):p[c])>-1&&(o[d]=!(a[d]=u))}}else v=g(v===a?v.splice(f,v.length):v),r?r(null,a,v,l):ee.apply(a,v)})}function v(e){for(var t,n,i,o=e.length,r=E.relative[e[0].type],a=r||E.relative[" "],s=r?1:0,l=f(function(e){return e===t},a,!0),d=f(function(e){return ne.call(t,e)>-1},a,!0),c=[function(e,n,i){return!r&&(i||n!==$)||((t=n).nodeType?l(e,n,i):d(e,n,i))}];s<o;s++)if(n=E.relative[e[s].type])c=[f(m(c),n)];else{if(n=E.filter[e[s].type].apply(null,e[s].matches),n[j]){for(i=++s;i<o&&!E.relative[e[i].type];i++);return b(s>1&&m(c),s>1&&h(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(de,"$1"),n,s<i&&v(e.slice(s,i)),i<o&&v(e=e.slice(i)),i<o&&h(e))}c.push(n)}return m(c)}function y(e,t){var i=0,r=t.length>0,a=e.length>0,s=function(o,s,l,d,c){var u,p,h,f=[],m=0,b="0",v=o&&[],y=null!=c,x=$,_=o||a&&E.find.TAG("*",c&&s.parentNode||s),w=H+=null==x?1:Math.random()||.1;for(y&&($=s!==I&&s,C=i);null!=(u=_[b]);b++){if(a&&u){for(p=0;h=e[p++];)if(h(u,s,l)){d.push(u);break}y&&(H=w,C=++i)}r&&((u=!h&&u)&&m--,o&&v.push(u))}if(m+=b,r&&b!==m){for(p=0;h=t[p++];)h(v,f,s,l);if(o){if(m>0)for(;b--;)v[b]||f[b]||(f[b]=Q.call(d));f=g(f)}ee.apply(d,f),y&&!o&&f.length>0&&m+t.length>1&&n.uniqueSort(d)}return y&&(H=w,$=x),v};return r?o(s):s}function x(e,t,i){for(var o=0,r=t.length;o<r;o++)n(e,t[o],i);return i}function _(e,t,n,i){var o,r,a,s,l,d=p(e);if(!i&&1===d.length){if(r=d[0]=d[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&k.getById&&9===t.nodeType&&R&&E.relative[r[1].type]){if(t=(E.find.ID(a.matches[0].replace(ke,Ce),t)||[])[0],!t)return n;e=e.slice(r.shift().value.length)}for(o=be.needsContext.test(e)?0:r.length;o--&&(a=r[o],!E.relative[s=a.type]);)if((l=E.find[s])&&(i=l(a.matches[0].replace(ke,Ce),he.test(r[0].type)&&t.parentNode||t))){if(r.splice(o,1),e=i.length&&h(r),!e)return ee.apply(n,i),n;break}}return N(e,d)(i,t,!R,n,he.test(e)),n}var w,k,C,E,T,S,N,$,q,A,I,D,R,U,O,B,L,j="sizzle"+-new Date,P=e.document,H=0,M=0,z=i(),F=i(),W=i(),V=!1,X=function(e,t){return e===t?(V=!0,0):0},G=typeof t,Y=1<<31,K={}.hasOwnProperty,J=[],Q=J.pop,Z=J.push,ee=J.push,te=J.slice,ne=J.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},ie="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",oe="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ae=re.replace("w","w#"),se="\\["+oe+"*("+re+")"+oe+"*(?:([*^$|!~]?=)"+oe+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ae+")|)|)"+oe+"*\\]",le=":("+re+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+se.replace(3,8)+")*)|.*)\\)|)",de=new RegExp("^"+oe+"+|((?:^|[^\\\\])(?:\\\\.)*)"+oe+"+$","g"),ue=new RegExp("^"+oe+"*,"+oe+"*"),pe=new RegExp("^"+oe+"*([>+~]|"+oe+")"+oe+"*"),he=new RegExp(oe+"*[+~]"),fe=new RegExp("="+oe+"*([^\\]'\"]*)"+oe+"*\\]","g"),me=new RegExp(le),ge=new RegExp("^"+ae+"$"),be={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re.replace("w","w*")+")"),ATTR:new RegExp("^"+se),PSEUDO:new RegExp("^"+le),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+oe+"*(even|odd|(([+-]|)(\\d*)n|)"+oe+"*(?:([+-]|)"+oe+"*(\\d+)|))"+oe+"*\\)|)","i"),bool:new RegExp("^(?:"+ie+")$","i"),needsContext:new RegExp("^"+oe+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+oe+"*((?:-\\d)?\\d*)"+oe+"*\\)|)(?=[^-]|$)","i")},ve=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,xe=/^(?:input|select|textarea|button)$/i,_e=/^h\d$/i,we=/'|\\/g,ke=new RegExp("\\\\([\\da-f]{1,6}"+oe+"?|("+oe+")|.)","ig"),Ce=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{ee.apply(J=te.call(P.childNodes),P.childNodes),J[P.childNodes.length].nodeType}catch(Ee){ee={apply:J.length?function(e,t){Z.apply(e,te.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}S=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},k=n.support={},A=n.setDocument=function(e){var t=e?e.ownerDocument||e:P,n=t.defaultView;return t!==I&&9===t.nodeType&&t.documentElement?(I=t,D=t.documentElement,R=!S(t),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){A()}),k.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),k.getElementsByTagName=r(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),k.getElementsByClassName=r(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),k.getById=r(function(e){return D.appendChild(e).id=j,!t.getElementsByName||!t.getElementsByName(j).length}),k.getById?(E.find.ID=function(e,t){if(typeof t.getElementById!==G&&R){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},E.filter.ID=function(e){var t=e.replace(ke,Ce);return function(e){return e.getAttribute("id")===t}}):(delete E.find.ID,E.filter.ID=function(e){var t=e.replace(ke,Ce);return function(e){var n=typeof e.getAttributeNode!==G&&e.getAttributeNode("id");return n&&n.value===t}}),E.find.TAG=k.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==G)return t.getElementsByTagName(e)}:function(e,t){var n,i=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},E.find.CLASS=k.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==G&&R)return t.getElementsByClassName(e)},O=[],U=[],(k.qsa=ve.test(t.querySelectorAll))&&(r(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||U.push("\\["+oe+"*(?:value|"+ie+")"),e.querySelectorAll(":checked").length||U.push(":checked")}),r(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&U.push("[*^$]="+oe+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||U.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),U.push(",.*:")})),(k.matchesSelector=ve.test(B=D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&r(function(e){k.disconnectedMatch=B.call(e,"div"),B.call(e,"[s!='']:x"),O.push("!=",le)}),U=U.length&&new RegExp(U.join("|")),O=O.length&&new RegExp(O.join("|")),L=ve.test(D.contains)||D.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},X=D.compareDocumentPosition?function(e,n){if(e===n)return V=!0,0;var i=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);return i?1&i||!k.sortDetached&&n.compareDocumentPosition(e)===i?e===t||L(P,e)?-1:n===t||L(P,n)?1:q?ne.call(q,e)-ne.call(q,n):0:4&i?-1:1:e.compareDocumentPosition?-1:1;
}:function(e,n){var i,o=0,r=e.parentNode,a=n.parentNode,l=[e],d=[n];if(e===n)return V=!0,0;if(!r||!a)return e===t?-1:n===t?1:r?-1:a?1:q?ne.call(q,e)-ne.call(q,n):0;if(r===a)return s(e,n);for(i=e;i=i.parentNode;)l.unshift(i);for(i=n;i=i.parentNode;)d.unshift(i);for(;l[o]===d[o];)o++;return o?s(l[o],d[o]):l[o]===P?-1:d[o]===P?1:0},t):I},n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){if((e.ownerDocument||e)!==I&&A(e),t=t.replace(fe,"='$1']"),k.matchesSelector&&R&&(!O||!O.test(t))&&(!U||!U.test(t)))try{var i=B.call(e,t);if(i||k.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(o){}return n(t,I,null,[e]).length>0},n.contains=function(e,t){return(e.ownerDocument||e)!==I&&A(e),L(e,t)},n.attr=function(e,n){(e.ownerDocument||e)!==I&&A(e);var i=E.attrHandle[n.toLowerCase()],o=i&&K.call(E.attrHandle,n.toLowerCase())?i(e,n,!R):t;return o===t?k.attributes||!R?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var t,n=[],i=0,o=0;if(V=!k.detectDuplicates,q=!k.sortStable&&e.slice(0),e.sort(X),V){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)e.splice(n[i],1)}return e},T=n.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=T(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i];i++)n+=T(t);return n},E=n.selectors={cacheLength:50,createPseudo:o,match:be,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ke,Ce),e[3]=(e[4]||e[5]||"").replace(ke,Ce),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||n.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&n.error(e[0]),e},PSEUDO:function(e){var n,i=!e[5]&&e[2];return be.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:i&&me.test(i)&&(n=p(i,!0))&&(n=i.indexOf(")",i.length-n)-i.length)&&(e[0]=e[0].slice(0,n),e[2]=i.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ke,Ce).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=z[e+" "];return t||(t=new RegExp("(^|"+oe+")"+e+"("+oe+"|$)"))&&z(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==G&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(o){var r=n.attr(o,e);return null==r?"!="===t:!t||(r+="","="===t?r===i:"!="===t?r!==i:"^="===t?i&&0===r.indexOf(i):"*="===t?i&&r.indexOf(i)>-1:"$="===t?i&&r.slice(-i.length)===i:"~="===t?(" "+r+" ").indexOf(i)>-1:"|="===t&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,n,i,o){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var d,c,u,p,h,f,m=r!==a?"nextSibling":"previousSibling",g=t.parentNode,b=s&&t.nodeName.toLowerCase(),v=!l&&!s;if(g){if(r){for(;m;){for(u=t;u=u[m];)if(s?u.nodeName.toLowerCase()===b:1===u.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&v){for(c=g[j]||(g[j]={}),d=c[e]||[],h=d[0]===H&&d[1],p=d[0]===H&&d[2],u=h&&g.childNodes[h];u=++h&&u&&u[m]||(p=h=0)||f.pop();)if(1===u.nodeType&&++p&&u===t){c[e]=[H,h,p];break}}else if(v&&(d=(t[j]||(t[j]={}))[e])&&d[0]===H)p=d[1];else for(;(u=++h&&u&&u[m]||(p=h=0)||f.pop())&&((s?u.nodeName.toLowerCase()!==b:1!==u.nodeType)||!++p||(v&&((u[j]||(u[j]={}))[e]=[H,p]),u!==t)););return p-=o,p===i||p%i===0&&p/i>=0}}},PSEUDO:function(e,t){var i,r=E.pseudos[e]||E.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return r[j]?r(t):r.length>1?(i=[e,e,"",t],E.setFilters.hasOwnProperty(e.toLowerCase())?o(function(e,n){for(var i,o=r(e,t),a=o.length;a--;)i=ne.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,i)}):r}},pseudos:{not:o(function(e){var t=[],n=[],i=N(e.replace(de,"$1"));return i[j]?o(function(e,t,n,o){for(var r,a=i(e,null,o,[]),s=e.length;s--;)(r=a[s])&&(e[s]=!(t[s]=r))}):function(e,o,r){return t[0]=e,i(t,null,r,n),!n.pop()}}),has:o(function(e){return function(t){return n(e,t).length>0}}),contains:o(function(e){return function(t){return(t.textContent||t.innerText||T(t)).indexOf(e)>-1}}),lang:o(function(e){return ge.test(e||"")||n.error("unsupported lang: "+e),e=e.replace(ke,Ce).toLowerCase(),function(t){var n;do if(n=R?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===D},focus:function(e){return e===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!E.pseudos.empty(e)},header:function(e){return _e.test(e.nodeName)},input:function(e){return xe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[n<0?n+t:n]}),even:c(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i);return e}),gt:c(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}},E.pseudos.nth=E.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[w]=l(w);for(w in{submit:!0,reset:!0})E.pseudos[w]=d(w);u.prototype=E.filters=E.pseudos,E.setFilters=new u,N=n.compile=function(e,t){var n,i=[],o=[],r=W[e+" "];if(!r){for(t||(t=p(e)),n=t.length;n--;)r=v(t[n]),r[j]?i.push(r):o.push(r);r=W(e,y(o,i))}return r},k.sortStable=j.split("").sort(X).join("")===j,k.detectDuplicates=V,A(),k.sortDetached=r(function(e){return 1&e.compareDocumentPosition(I.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),k.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||a(ie,function(e,t,n){var i;if(!n)return(i=e.getAttributeNode(t))&&i.specified?i.value:e[t]===!0?t.toLowerCase():null}),ce.find=n,ce.expr=n.selectors,ce.expr[":"]=ce.expr.pseudos,ce.unique=n.uniqueSort,ce.text=n.getText,ce.isXMLDoc=n.isXML,ce.contains=n.contains}(e);var Ee={};ce.Callbacks=function(e){e="string"==typeof e?Ee[e]||i(e):ce.extend({},e);var n,o,r,a,s,l,d=[],c=!e.once&&[],u=function(t){for(o=e.memory&&t,r=!0,s=l||0,l=0,a=d.length,n=!0;d&&s<a;s++)if(d[s].apply(t[0],t[1])===!1&&e.stopOnFalse){o=!1;break}n=!1,d&&(c?c.length&&u(c.shift()):o?d=[]:p.disable())},p={add:function(){if(d){var t=d.length;!function i(t){ce.each(t,function(t,n){var o=ce.type(n);"function"===o?e.unique&&p.has(n)||d.push(n):n&&n.length&&"string"!==o&&i(n)})}(arguments),n?a=d.length:o&&(l=t,u(o))}return this},remove:function(){return d&&ce.each(arguments,function(e,t){for(var i;(i=ce.inArray(t,d,i))>-1;)d.splice(i,1),n&&(i<=a&&a--,i<=s&&s--)}),this},has:function(e){return e?ce.inArray(e,d)>-1:!(!d||!d.length)},empty:function(){return d=[],a=0,this},disable:function(){return d=c=o=t,this},disabled:function(){return!d},lock:function(){return c=t,o||p.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!d||r&&!c||(t=t||[],t=[e,t.slice?t.slice():t],n?c.push(t):u(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!r}};return p},ce.extend({Deferred:function(e){var t=[["resolve","done",ce.Callbacks("once memory"),"resolved"],["reject","fail",ce.Callbacks("once memory"),"rejected"],["notify","progress",ce.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ce.Deferred(function(n){ce.each(t,function(t,r){var a=r[0],s=ce.isFunction(e[t])&&e[t];o[r[1]](function(){var e=s&&s.apply(this,arguments);e&&ce.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===i?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ce.extend(e,i):i}},o={};return i.pipe=i.then,ce.each(t,function(e,r){var a=r[2],s=r[3];i[r[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?i:this,arguments),this},o[r[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,i,o=0,r=re.call(arguments),a=r.length,s=1!==a||e&&ce.isFunction(e.promise)?a:0,l=1===s?e:ce.Deferred(),d=function(e,n,i){return function(o){n[e]=this,i[e]=arguments.length>1?re.call(arguments):o,i===t?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);o<a;o++)r[o]&&ce.isFunction(r[o].promise)?r[o].promise().done(d(o,i,r)).fail(l.reject).progress(d(o,n,t)):--s;return s||l.resolveWith(i,r),l.promise()}}),ce.support=function(t){var n,i,o,r,a,s,l,d,c,u=K.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=u.getElementsByTagName("*")||[],i=u.getElementsByTagName("a")[0],!i||!i.style||!n.length)return t;r=K.createElement("select"),s=r.appendChild(K.createElement("option")),o=u.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==u.className,t.leadingWhitespace=3===u.firstChild.nodeType,t.tbody=!u.getElementsByTagName("tbody").length,t.htmlSerialize=!!u.getElementsByTagName("link").length,t.style=/top/.test(i.getAttribute("style")),t.hrefNormalized="/a"===i.getAttribute("href"),t.opacity=/^0.5/.test(i.style.opacity),t.cssFloat=!!i.style.cssFloat,t.checkOn=!!o.value,t.optSelected=s.selected,t.enctype=!!K.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==K.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,r.disabled=!0,t.optDisabled=!s.disabled;try{delete u.test}catch(p){t.deleteExpando=!1}o=K.createElement("input"),o.setAttribute("value",""),t.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),a=K.createDocumentFragment(),a.appendChild(o),t.appendChecked=o.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){t.noCloneEvent=!1}),u.cloneNode(!0).click());for(c in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+c,"t"),t[c+"Bubbles"]=l in e||u.attributes[l].expando===!1;u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===u.style.backgroundClip;for(c in ce(t))break;return t.ownLast="0"!==c,ce(function(){var n,i,o,r="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=K.getElementsByTagName("body")[0];a&&(n=K.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=u.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",d=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=d&&0===o[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",ce.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===u.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(u,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(u,null)||{width:"4px"}).width,i=u.appendChild(K.createElement("div")),i.style.cssText=u.style.cssText=r,i.style.marginRight=i.style.width="0",u.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(i,null)||{}).marginRight)),typeof u.style.zoom!==G&&(u.innerHTML="",u.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==u.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=u=o=i=null)}),n=r=a=s=i=o=null,t}({});var Te=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Se=/([A-Z])/g;ce.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?ce.cache[e[ce.expando]]:e[ce.expando],!!e&&!s(e)},data:function(e,t,n){return o(e,t,n)},removeData:function(e,t){return r(e,t)},_data:function(e,t,n){return o(e,t,n,!0)},_removeData:function(e,t){return r(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&ce.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),ce.fn.extend({data:function(e,n){var i,o,r=null,s=0,l=this[0];if(e===t){if(this.length&&(r=ce.data(l),1===l.nodeType&&!ce._data(l,"parsedAttrs"))){for(i=l.attributes;s<i.length;s++)o=i[s].name,0===o.indexOf("data-")&&(o=ce.camelCase(o.slice(5)),a(l,o,r[o]));ce._data(l,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){ce.data(this,e)}):arguments.length>1?this.each(function(){ce.data(this,e,n)}):l?a(l,e,ce.data(l,e)):null},removeData:function(e){return this.each(function(){ce.removeData(this,e)})}}),ce.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=ce._data(e,t),n&&(!i||ce.isArray(n)?i=ce._data(e,t,ce.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=ce.queue(e,t),i=n.length,o=n.shift(),r=ce._queueHooks(e,t),a=function(){ce.dequeue(e,t)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,a,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ce._data(e,n)||ce._data(e,n,{empty:ce.Callbacks("once memory").add(function(){ce._removeData(e,t+"queue"),ce._removeData(e,n)})})}}),ce.fn.extend({queue:function(e,n){var i=2;return"string"!=typeof e&&(n=e,e="fx",i--),arguments.length<i?ce.queue(this[0],e):n===t?this:this.each(function(){var t=ce.queue(this,e,n);ce._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ce.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ce.dequeue(this,e)})},delay:function(e,t){return e=ce.fx?ce.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var i,o=1,r=ce.Deferred(),a=this,s=this.length,l=function(){--o||r.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";s--;)i=ce._data(a[s],e+"queueHooks"),i&&i.empty&&(o++,i.empty.add(l));return l(),r.promise(n)}});var Ne,$e,qe=/[\t\r\n\f]/g,Ae=/\r/g,Ie=/^(?:input|select|textarea|button|object)$/i,De=/^(?:a|area)$/i,Re=/^(?:checked|selected)$/i,Ue=ce.support.getSetAttribute,Oe=ce.support.input;ce.fn.extend({attr:function(e,t){return ce.access(this,ce.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ce.removeAttr(this,e)})},prop:function(e,t){return ce.access(this,ce.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ce.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,i,o,r,a=0,s=this.length,l="string"==typeof e&&e;if(ce.isFunction(e))return this.each(function(t){ce(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(pe)||[];a<s;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(qe," "):" ")){for(r=0;o=t[r++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");n.className=ce.trim(i)}return this},removeClass:function(e){var t,n,i,o,r,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(ce.isFunction(e))return this.each(function(t){ce(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(pe)||[];a<s;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(qe," "):"")){for(r=0;o=t[r++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");n.className=e?ce.trim(i):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):ce.isFunction(e)?this.each(function(n){ce(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,i=0,o=ce(this),r=e.match(pe)||[];t=r[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else n!==G&&"boolean"!==n||(this.className&&ce._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ce._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;n<i;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(qe," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,i,o,r=this[0];{if(arguments.length)return o=ce.isFunction(e),this.each(function(n){var r;1===this.nodeType&&(r=o?e.call(this,n,ce(this).val()):e,null==r?r="":"number"==typeof r?r+="":ce.isArray(r)&&(r=ce.map(r,function(e){return null==e?"":e+""})),i=ce.valHooks[this.type]||ce.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,r,"value")!==t||(this.value=r))});if(r)return i=ce.valHooks[r.type]||ce.valHooks[r.nodeName.toLowerCase()],i&&"get"in i&&(n=i.get(r,"value"))!==t?n:(n=r.value,"string"==typeof n?n.replace(Ae,""):null==n?"":n)}}}),ce.extend({valHooks:{option:{get:function(e){var t=ce.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,n,i=e.options,o=e.selectedIndex,r="select-one"===e.type||o<0,a=r?null:[],s=r?o+1:i.length,l=o<0?s:r?o:0;l<s;l++)if(n=i[l],(n.selected||l===o)&&(ce.support.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!ce.nodeName(n.parentNode,"optgroup"))){if(t=ce(n).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var n,i,o=e.options,r=ce.makeArray(t),a=o.length;a--;)i=o[a],(i.selected=ce.inArray(ce(i).val(),r)>=0)&&(n=!0);return n||(e.selectedIndex=-1),r}}},attr:function(e,n,i){var o,r,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===G?ce.prop(e,n,i):(1===a&&ce.isXMLDoc(e)||(n=n.toLowerCase(),o=ce.attrHooks[n]||(ce.expr.match.bool.test(n)?$e:Ne)),i===t?o&&"get"in o&&null!==(r=o.get(e,n))?r:(r=ce.find.attr(e,n),null==r?t:r):null!==i?o&&"set"in o&&(r=o.set(e,i,n))!==t?r:(e.setAttribute(n,i+""),i):void ce.removeAttr(e,n))},removeAttr:function(e,t){var n,i,o=0,r=t&&t.match(pe);if(r&&1===e.nodeType)for(;n=r[o++];)i=ce.propFix[n]||n,ce.expr.match.bool.test(n)?Oe&&Ue||!Re.test(n)?e[i]=!1:e[ce.camelCase("default-"+n)]=e[i]=!1:ce.attr(e,n,""),e.removeAttribute(Ue?n:i)},attrHooks:{type:{set:function(e,t){if(!ce.support.radioValue&&"radio"===t&&ce.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,i){var o,r,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!ce.isXMLDoc(e),a&&(n=ce.propFix[n]||n,r=ce.propHooks[n]),i!==t?r&&"set"in r&&(o=r.set(e,i,n))!==t?o:e[n]=i:r&&"get"in r&&null!==(o=r.get(e,n))?o:e[n]},propHooks:{tabIndex:{get:function(e){var t=ce.find.attr(e,"tabindex");return t?parseInt(t,10):Ie.test(e.nodeName)||De.test(e.nodeName)&&e.href?0:-1}}}}),$e={set:function(e,t,n){return t===!1?ce.removeAttr(e,n):Oe&&Ue||!Re.test(n)?e.setAttribute(!Ue&&ce.propFix[n]||n,n):e[ce.camelCase("default-"+n)]=e[n]=!0,n}},ce.each(ce.expr.match.bool.source.match(/\w+/g),function(e,n){var i=ce.expr.attrHandle[n]||ce.find.attr;ce.expr.attrHandle[n]=Oe&&Ue||!Re.test(n)?function(e,n,o){var r=ce.expr.attrHandle[n],a=o?t:(ce.expr.attrHandle[n]=t)!=i(e,n,o)?n.toLowerCase():null;return ce.expr.attrHandle[n]=r,a}:function(e,n,i){return i?t:e[ce.camelCase("default-"+n)]?n.toLowerCase():null}}),Oe&&Ue||(ce.attrHooks.value={set:function(e,t,n){return ce.nodeName(e,"input")?void(e.defaultValue=t):Ne&&Ne.set(e,t,n)}}),Ue||(Ne={set:function(e,n,i){var o=e.getAttributeNode(i);return o||e.setAttributeNode(o=e.ownerDocument.createAttribute(i)),o.value=n+="","value"===i||n===e.getAttribute(i)?n:t}},ce.expr.attrHandle.id=ce.expr.attrHandle.name=ce.expr.attrHandle.coords=function(e,n,i){var o;return i?t:(o=e.getAttributeNode(n))&&""!==o.value?o.value:null},ce.valHooks.button={get:function(e,n){var i=e.getAttributeNode(n);return i&&i.specified?i.value:t},set:Ne.set},ce.attrHooks.contenteditable={set:function(e,t,n){Ne.set(e,""!==t&&t,n)}},ce.each(["width","height"],function(e,t){ce.attrHooks[t]={set:function(e,n){if(""===n)return e.setAttribute(t,"auto"),n}}})),ce.support.hrefNormalized||ce.each(["href","src"],function(e,t){ce.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ce.support.style||(ce.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),ce.support.optSelected||(ce.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),ce.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ce.propFix[this.toLowerCase()]=this}),ce.support.enctype||(ce.propFix.enctype="encoding"),ce.each(["radio","checkbox"],function(){ce.valHooks[this]={set:function(e,t){if(ce.isArray(t))return e.checked=ce.inArray(ce(e).val(),t)>=0}},ce.support.checkOn||(ce.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Be=/^(?:input|select|textarea)$/i,Le=/^key/,je=/^(?:mouse|contextmenu)|click/,Pe=/^(?:focusinfocus|focusoutblur)$/,He=/^([^.]*)(?:\.(.+)|)$/;ce.event={global:{},add:function(e,n,i,o,r){var a,s,l,d,c,u,p,h,f,m,g,b=ce._data(e);if(b){for(i.handler&&(d=i,i=d.handler,r=d.selector),i.guid||(i.guid=ce.guid++),(s=b.events)||(s=b.events={}),(u=b.handle)||(u=b.handle=function(e){return typeof ce===G||e&&ce.event.triggered===e.type?t:ce.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=(n||"").match(pe)||[""],l=n.length;l--;)a=He.exec(n[l])||[],f=g=a[1],m=(a[2]||"").split(".").sort(),f&&(c=ce.event.special[f]||{},f=(r?c.delegateType:c.bindType)||f,c=ce.event.special[f]||{},p=ce.extend({type:f,origType:g,data:o,handler:i,guid:i.guid,selector:r,needsContext:r&&ce.expr.match.needsContext.test(r),namespace:m.join(".")},d),(h=s[f])||(h=s[f]=[],h.delegateCount=0,c.setup&&c.setup.call(e,o,m,u)!==!1||(e.addEventListener?e.addEventListener(f,u,!1):e.attachEvent&&e.attachEvent("on"+f,u))),c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=i.guid)),r?h.splice(h.delegateCount++,0,p):h.push(p),ce.event.global[f]=!0);e=null}},remove:function(e,t,n,i,o){var r,a,s,l,d,c,u,p,h,f,m,g=ce.hasData(e)&&ce._data(e);if(g&&(c=g.events)){for(t=(t||"").match(pe)||[""],d=t.length;d--;)if(s=He.exec(t[d])||[],h=m=s[1],f=(s[2]||"").split(".").sort(),h){for(u=ce.event.special[h]||{},h=(i?u.delegateType:u.bindType)||h,p=c[h]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=p.length;r--;)a=p[r],!o&&m!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(p.splice(r,1),a.selector&&p.delegateCount--,u.remove&&u.remove.call(e,a));l&&!p.length&&(u.teardown&&u.teardown.call(e,f,g.handle)!==!1||ce.removeEvent(e,h,g.handle),delete c[h])}else for(h in c)ce.event.remove(e,h+t[d],n,i,!0);ce.isEmptyObject(c)&&(delete g.handle,ce._removeData(e,"events"))}},trigger:function(n,i,o,r){var a,s,l,d,c,u,p,h=[o||K],f=le.call(n,"type")?n.type:n,m=le.call(n,"namespace")?n.namespace.split("."):[];if(l=u=o=o||K,3!==o.nodeType&&8!==o.nodeType&&!Pe.test(f+ce.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),s=f.indexOf(":")<0&&"on"+f,n=n[ce.expando]?n:new ce.Event(f,"object"==typeof n&&n),n.isTrigger=r?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=o),i=null==i?[n]:ce.makeArray(i,[n]),c=ce.event.special[f]||{},r||!c.trigger||c.trigger.apply(o,i)!==!1)){if(!r&&!c.noBubble&&!ce.isWindow(o)){for(d=c.delegateType||f,Pe.test(d+f)||(l=l.parentNode);l;l=l.parentNode)h.push(l),u=l;u===(o.ownerDocument||K)&&h.push(u.defaultView||u.parentWindow||e)}for(p=0;(l=h[p++])&&!n.isPropagationStopped();)n.type=p>1?d:c.bindType||f,a=(ce._data(l,"events")||{})[n.type]&&ce._data(l,"handle"),a&&a.apply(l,i),a=s&&l[s],a&&ce.acceptData(l)&&a.apply&&a.apply(l,i)===!1&&n.preventDefault();if(n.type=f,!r&&!n.isDefaultPrevented()&&(!c._default||c._default.apply(h.pop(),i)===!1)&&ce.acceptData(o)&&s&&o[f]&&!ce.isWindow(o)){u=o[s],u&&(o[s]=null),ce.event.triggered=f;try{o[f]()}catch(g){}ce.event.triggered=t,u&&(o[s]=u)}return n.result}},dispatch:function(e){e=ce.event.fix(e);var n,i,o,r,a,s=[],l=re.call(arguments),d=(ce._data(this,"events")||{})[e.type]||[],c=ce.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(s=ce.event.handlers.call(this,e,d),n=0;(r=s[n++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,a=0;(o=r.handlers[a++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(o.namespace)||(e.handleObj=o,e.data=o.data,i=((ce.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l),i!==t&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var i,o,r,a,s=[],l=n.delegateCount,d=e.target;if(l&&d.nodeType&&(!e.button||"click"!==e.type))for(;d!=this;d=d.parentNode||this)if(1===d.nodeType&&(d.disabled!==!0||"click"!==e.type)){for(r=[],a=0;a<l;a++)o=n[a],i=o.selector+" ",r[i]===t&&(r[i]=o.needsContext?ce(i,this).index(d)>=0:ce.find(i,this,null,[d]).length),r[i]&&r.push(o);r.length&&s.push({elem:d,handlers:r})}return l<n.length&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(e){if(e[ce.expando])return e;var t,n,i,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=je.test(o)?this.mouseHooks:Le.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new ce.Event(r),t=i.length;t--;)n=i[t],e[n]=r[n];return e.target||(e.target=r.srcElement||K),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,o,r,a=n.button,s=n.fromElement;return null==e.pageX&&null!=n.clientX&&(o=e.target.ownerDocument||K,r=o.documentElement,i=o.body,e.pageX=n.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=n.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?n.toElement:s),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==c()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===c()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(ce.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return ce.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var o=ce.extend(new ce.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?ce.event.trigger(o,null,t):ce.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},ce.removeEvent=K.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var i="on"+t;e.detachEvent&&(typeof e[i]===G&&(e[i]=null),e.detachEvent(i,n))},ce.Event=function(e,t){return this instanceof ce.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:d):this.type=e,t&&ce.extend(this,t),this.timeStamp=e&&e.timeStamp||ce.now(),void(this[ce.expando]=!0)):new ce.Event(e,t)},ce.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ce.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ce.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,o=e.relatedTarget,r=e.handleObj;return o&&(o===i||ce.contains(i,o))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),ce.support.submitBubbles||(ce.event.special.submit={setup:function(){return!ce.nodeName(this,"form")&&void ce.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,i=ce.nodeName(n,"input")||ce.nodeName(n,"button")?n.form:t;i&&!ce._data(i,"submitBubbles")&&(ce.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),ce._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ce.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return!ce.nodeName(this,"form")&&void ce.event.remove(this,"._submit")}}),ce.support.changeBubbles||(ce.event.special.change={setup:function(){return Be.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(ce.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ce.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ce.event.simulate("change",this,e,!0)})),!1):void ce.event.add(this,"beforeactivate._change",function(e){var t=e.target;Be.test(t.nodeName)&&!ce._data(t,"changeBubbles")&&(ce.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ce.event.simulate("change",this.parentNode,e,!0)}),ce._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments);
},teardown:function(){return ce.event.remove(this,"._change"),!Be.test(this.nodeName)}}),ce.support.focusinBubbles||ce.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){ce.event.simulate(t,e.target,ce.event.fix(e),!0)};ce.event.special[t]={setup:function(){0===n++&&K.addEventListener(e,i,!0)},teardown:function(){0===--n&&K.removeEventListener(e,i,!0)}}}),ce.fn.extend({on:function(e,n,i,o,r){var a,s;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=t);for(a in e)this.on(a,n,i,e[a],r);return this}if(null==i&&null==o?(o=n,i=n=t):null==o&&("string"==typeof n?(o=i,i=t):(o=i,i=n,n=t)),o===!1)o=d;else if(!o)return this;return 1===r&&(s=o,o=function(e){return ce().off(e),s.apply(this,arguments)},o.guid=s.guid||(s.guid=ce.guid++)),this.each(function(){ce.event.add(this,e,o,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){var o,r;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,ce(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof e){for(r in e)this.off(r,n,e[r]);return this}return n!==!1&&"function"!=typeof n||(i=n,n=t),i===!1&&(i=d),this.each(function(){ce.event.remove(this,e,i,n)})},trigger:function(e,t){return this.each(function(){ce.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return ce.event.trigger(e,t,n,!0)}});var Me=/^.[^:#\[\.,]*$/,ze=/^(?:parents|prev(?:Until|All))/,Fe=ce.expr.match.needsContext,We={children:!0,contents:!0,next:!0,prev:!0};ce.fn.extend({find:function(e){var t,n=[],i=this,o=i.length;if("string"!=typeof e)return this.pushStack(ce(e).filter(function(){for(t=0;t<o;t++)if(ce.contains(i[t],this))return!0}));for(t=0;t<o;t++)ce.find(e,i[t],n);return n=this.pushStack(o>1?ce.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=ce(e,this),i=n.length;return this.filter(function(){for(t=0;t<i;t++)if(ce.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(p(this,e||[],!0))},filter:function(e){return this.pushStack(p(this,e||[],!1))},is:function(e){return!!p(this,"string"==typeof e&&Fe.test(e)?ce(e):e||[],!1).length},closest:function(e,t){for(var n,i=0,o=this.length,r=[],a=Fe.test(e)||"string"!=typeof e?ce(e,t||this.context):0;i<o;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ce.find.matchesSelector(n,e))){n=r.push(n);break}return this.pushStack(r.length>1?ce.unique(r):r)},index:function(e){return e?"string"==typeof e?ce.inArray(this[0],ce(e)):ce.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?ce(e,t):ce.makeArray(e&&e.nodeType?[e]:e),i=ce.merge(this.get(),n);return this.pushStack(ce.unique(i))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ce.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ce.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ce.dir(e,"parentNode",n)},next:function(e){return u(e,"nextSibling")},prev:function(e){return u(e,"previousSibling")},nextAll:function(e){return ce.dir(e,"nextSibling")},prevAll:function(e){return ce.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ce.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ce.dir(e,"previousSibling",n)},siblings:function(e){return ce.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ce.sibling(e.firstChild)},contents:function(e){return ce.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ce.merge([],e.childNodes)}},function(e,t){ce.fn[e]=function(n,i){var o=ce.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=ce.filter(i,o)),this.length>1&&(We[e]||(o=ce.unique(o)),ze.test(e)&&(o=o.reverse())),this.pushStack(o)}}),ce.extend({filter:function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?ce.find.matchesSelector(i,e)?[i]:[]:ce.find.matches(e,ce.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,i){for(var o=[],r=e[n];r&&9!==r.nodeType&&(i===t||1!==r.nodeType||!ce(r).is(i));)1===r.nodeType&&o.push(r),r=r[n];return o},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Ve="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Xe=/ jQuery\d+="(?:null|\d+)"/g,Ge=new RegExp("<(?:"+Ve+")[\\s/>]","i"),Ye=/^\s+/,Ke=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Je=/<([\w:]+)/,Qe=/<tbody/i,Ze=/<|&#?\w+;/,et=/<(?:script|style|link)/i,tt=/^(?:checkbox|radio)$/i,nt=/checked\s*(?:[^=]|=\s*.checked.)/i,it=/^$|\/(?:java|ecma)script/i,ot=/^true\/(.*)/,rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,at={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ce.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},st=h(K),lt=st.appendChild(K.createElement("div"));at.optgroup=at.option,at.tbody=at.tfoot=at.colgroup=at.caption=at.thead,at.th=at.td,ce.fn.extend({text:function(e){return ce.access(this,function(e){return e===t?ce.text(this):this.empty().append((this[0]&&this[0].ownerDocument||K).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?ce.filter(e,this):this,o=0;null!=(n=i[o]);o++)t||1!==n.nodeType||ce.cleanData(x(n)),n.parentNode&&(t&&ce.contains(n.ownerDocument,n)&&b(x(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ce.cleanData(x(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ce.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ce.clone(this,e,t)})},html:function(e){return ce.access(this,function(e){var n=this[0]||{},i=0,o=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(Xe,""):t;if("string"==typeof e&&!et.test(e)&&(ce.support.htmlSerialize||!Ge.test(e))&&(ce.support.leadingWhitespace||!Ye.test(e))&&!at[(Je.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ke,"<$1></$2>");try{for(;i<o;i++)n=this[i]||{},1===n.nodeType&&(ce.cleanData(x(n,!1)),n.innerHTML=e);n=0}catch(r){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ce.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var i=e[t++],o=e[t++];o&&(i&&i.parentNode!==o&&(i=this.nextSibling),ce(this).remove(),o.insertBefore(n,i))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=ie.apply([],e);var i,o,r,a,s,l,d=0,c=this.length,u=this,p=c-1,h=e[0],f=ce.isFunction(h);if(f||!(c<=1||"string"!=typeof h||ce.support.checkClone)&&nt.test(h))return this.each(function(i){var o=u.eq(i);f&&(e[0]=h.call(this,i,o.html())),o.domManip(e,t,n)});if(c&&(l=ce.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(a=ce.map(x(l,"script"),m),r=a.length;d<c;d++)o=l,d!==p&&(o=ce.clone(o,!0,!0),r&&ce.merge(a,x(o,"script"))),t.call(this[d],o,d);if(r)for(s=a[a.length-1].ownerDocument,ce.map(a,g),d=0;d<r;d++)o=a[d],it.test(o.type||"")&&!ce._data(o,"globalEval")&&ce.contains(s,o)&&(o.src?ce._evalUrl(o.src):ce.globalEval((o.text||o.textContent||o.innerHTML||"").replace(rt,"")));l=i=null}return this}}),ce.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ce.fn[e]=function(e){for(var n,i=0,o=[],r=ce(e),a=r.length-1;i<=a;i++)n=i===a?this:this.clone(!0),ce(r[i])[t](n),oe.apply(o,n.get());return this.pushStack(o)}}),ce.extend({clone:function(e,t,n){var i,o,r,a,s,l=ce.contains(e.ownerDocument,e);if(ce.support.html5Clone||ce.isXMLDoc(e)||!Ge.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(lt.innerHTML=e.outerHTML,lt.removeChild(r=lt.firstChild)),!(ce.support.noCloneEvent&&ce.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ce.isXMLDoc(e)))for(i=x(r),s=x(e),a=0;null!=(o=s[a]);++a)i[a]&&y(o,i[a]);if(t)if(n)for(s=s||x(e),i=i||x(r),a=0;null!=(o=s[a]);a++)v(o,i[a]);else v(e,r);return i=x(r,"script"),i.length>0&&b(i,!l&&x(e,"script")),i=s=o=null,r},buildFragment:function(e,t,n,i){for(var o,r,a,s,l,d,c,u=e.length,p=h(t),f=[],m=0;m<u;m++)if(r=e[m],r||0===r)if("object"===ce.type(r))ce.merge(f,r.nodeType?[r]:r);else if(Ze.test(r)){for(s=s||p.appendChild(t.createElement("div")),l=(Je.exec(r)||["",""])[1].toLowerCase(),c=at[l]||at._default,s.innerHTML=c[1]+r.replace(Ke,"<$1></$2>")+c[2],o=c[0];o--;)s=s.lastChild;if(!ce.support.leadingWhitespace&&Ye.test(r)&&f.push(t.createTextNode(Ye.exec(r)[0])),!ce.support.tbody)for(r="table"!==l||Qe.test(r)?"<table>"!==c[1]||Qe.test(r)?0:s:s.firstChild,o=r&&r.childNodes.length;o--;)ce.nodeName(d=r.childNodes[o],"tbody")&&!d.childNodes.length&&r.removeChild(d);for(ce.merge(f,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=p.lastChild}else f.push(t.createTextNode(r));for(s&&p.removeChild(s),ce.support.appendChecked||ce.grep(x(f,"input"),_),m=0;r=f[m++];)if((!i||ce.inArray(r,i)===-1)&&(a=ce.contains(r.ownerDocument,r),s=x(p.appendChild(r),"script"),a&&b(s),n))for(o=0;r=s[o++];)it.test(r.type||"")&&n.push(r);return s=null,p},cleanData:function(e,t){for(var n,i,o,r,a=0,s=ce.expando,l=ce.cache,d=ce.support.deleteExpando,c=ce.event.special;null!=(n=e[a]);a++)if((t||ce.acceptData(n))&&(o=n[s],r=o&&l[o])){if(r.events)for(i in r.events)c[i]?ce.event.remove(n,i):ce.removeEvent(n,i,r.handle);l[o]&&(delete l[o],d?delete n[s]:typeof n.removeAttribute!==G?n.removeAttribute(s):n[s]=null,te.push(o))}},_evalUrl:function(e){return ce.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ce.fn.extend({wrapAll:function(e){if(ce.isFunction(e))return this.each(function(t){ce(this).wrapAll(e.call(this,t))});if(this[0]){var t=ce(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return ce.isFunction(e)?this.each(function(t){ce(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ce(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ce.isFunction(e);return this.each(function(n){ce(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){ce.nodeName(this,"body")||ce(this).replaceWith(this.childNodes)}).end()}});var dt,ct,ut,pt=/alpha\([^)]*\)/i,ht=/opacity\s*=\s*([^)]*)/,ft=/^(top|right|bottom|left)$/,mt=/^(none|table(?!-c[ea]).+)/,gt=/^margin/,bt=new RegExp("^("+ue+")(.*)$","i"),vt=new RegExp("^("+ue+")(?!px)[a-z%]+$","i"),yt=new RegExp("^([+-])=("+ue+")","i"),xt={BODY:"block"},_t={position:"absolute",visibility:"hidden",display:"block"},wt={letterSpacing:0,fontWeight:400},kt=["Top","Right","Bottom","Left"],Ct=["Webkit","O","Moz","ms"];ce.fn.extend({css:function(e,n){return ce.access(this,function(e,n,i){var o,r,a={},s=0;if(ce.isArray(n)){for(r=ct(e),o=n.length;s<o;s++)a[n[s]]=ce.css(e,n[s],!1,r);return a}return i!==t?ce.style(e,n,i):ce.css(e,n)},e,n,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){k(this)?ce(this).show():ce(this).hide()})}}),ce.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=ut(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ce.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,i,o){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,a,s,l=ce.camelCase(n),d=e.style;if(n=ce.cssProps[l]||(ce.cssProps[l]=w(d,l)),s=ce.cssHooks[n]||ce.cssHooks[l],i===t)return s&&"get"in s&&(r=s.get(e,!1,o))!==t?r:d[n];if(a=typeof i,"string"===a&&(r=yt.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(ce.css(e,n)),a="number"),!(null==i||"number"===a&&isNaN(i)||("number"!==a||ce.cssNumber[l]||(i+="px"),ce.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(d[n]="inherit"),s&&"set"in s&&(i=s.set(e,i,o))===t)))try{d[n]=i}catch(c){}}},css:function(e,n,i,o){var r,a,s,l=ce.camelCase(n);return n=ce.cssProps[l]||(ce.cssProps[l]=w(e.style,l)),s=ce.cssHooks[n]||ce.cssHooks[l],s&&"get"in s&&(a=s.get(e,!0,i)),a===t&&(a=ut(e,n,o)),"normal"===a&&n in wt&&(a=wt[n]),""===i||i?(r=parseFloat(a),i===!0||ce.isNumeric(r)?r||0:a):a}}),e.getComputedStyle?(ct=function(t){return e.getComputedStyle(t,null)},ut=function(e,n,i){var o,r,a,s=i||ct(e),l=s?s.getPropertyValue(n)||s[n]:t,d=e.style;return s&&(""!==l||ce.contains(e.ownerDocument,e)||(l=ce.style(e,n)),vt.test(l)&&gt.test(n)&&(o=d.width,r=d.minWidth,a=d.maxWidth,d.minWidth=d.maxWidth=d.width=l,l=s.width,d.width=o,d.minWidth=r,d.maxWidth=a)),l}):K.documentElement.currentStyle&&(ct=function(e){return e.currentStyle},ut=function(e,n,i){var o,r,a,s=i||ct(e),l=s?s[n]:t,d=e.style;return null==l&&d&&d[n]&&(l=d[n]),vt.test(l)&&!ft.test(n)&&(o=d.left,r=e.runtimeStyle,a=r&&r.left,a&&(r.left=e.currentStyle.left),d.left="fontSize"===n?"1em":l,l=d.pixelLeft+"px",d.left=o,a&&(r.left=a)),""===l?"auto":l}),ce.each(["height","width"],function(e,t){ce.cssHooks[t]={get:function(e,n,i){if(n)return 0===e.offsetWidth&&mt.test(ce.css(e,"display"))?ce.swap(e,_t,function(){return S(e,t,i)}):S(e,t,i)},set:function(e,n,i){var o=i&&ct(e);return E(e,n,i?T(e,t,i,ce.support.boxSizing&&"border-box"===ce.css(e,"boxSizing",!1,o),o):0)}}}),ce.support.opacity||(ce.cssHooks.opacity={get:function(e,t){return ht.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,o=ce.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===ce.trim(r.replace(pt,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=pt.test(r)?r.replace(pt,o):r+" "+o)}}),ce(function(){ce.support.reliableMarginRight||(ce.cssHooks.marginRight={get:function(e,t){if(t)return ce.swap(e,{display:"inline-block"},ut,[e,"marginRight"])}}),!ce.support.pixelPosition&&ce.fn.position&&ce.each(["top","left"],function(e,t){ce.cssHooks[t]={get:function(e,n){if(n)return n=ut(e,t),vt.test(n)?ce(e).position()[t]+"px":n}}})}),ce.expr&&ce.expr.filters&&(ce.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!ce.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ce.css(e,"display"))},ce.expr.filters.visible=function(e){return!ce.expr.filters.hidden(e)}),ce.each({margin:"",padding:"",border:"Width"},function(e,t){ce.cssHooks[e+t]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];i<4;i++)o[e+kt[i]+t]=r[i]||r[i-2]||r[0];return o}},gt.test(e)||(ce.cssHooks[e+t].set=E)});var Et=/%20/g,Tt=/\[\]$/,St=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,$t=/^(?:input|select|textarea|keygen)/i;ce.fn.extend({serialize:function(){return ce.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ce.prop(this,"elements");return e?ce.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ce(this).is(":disabled")&&$t.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!tt.test(e))}).map(function(e,t){var n=ce(this).val();return null==n?null:ce.isArray(n)?ce.map(n,function(e){return{name:t.name,value:e.replace(St,"\r\n")}}):{name:t.name,value:n.replace(St,"\r\n")}}).get()}}),ce.param=function(e,n){var i,o=[],r=function(e,t){t=ce.isFunction(t)?t():null==t?"":t,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=ce.ajaxSettings&&ce.ajaxSettings.traditional),ce.isArray(e)||e.jquery&&!ce.isPlainObject(e))ce.each(e,function(){r(this.name,this.value)});else for(i in e)q(i,e[i],n,r);return o.join("&").replace(Et,"+")},ce.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ce.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),ce.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var qt,At,It=ce.now(),Dt=/\?/,Rt=/#.*$/,Ut=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Bt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Lt=/^(?:GET|HEAD)$/,jt=/^\/\//,Pt=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ht=ce.fn.load,Mt={},zt={},Ft="*/".concat("*");try{At=Y.href}catch(Wt){At=K.createElement("a"),At.href="",At=At.href}qt=Pt.exec(At.toLowerCase())||[],ce.fn.load=function(e,n,i){if("string"!=typeof e&&Ht)return Ht.apply(this,arguments);var o,r,a,s=this,l=e.indexOf(" ");return l>=0&&(o=e.slice(l,e.length),e=e.slice(0,l)),ce.isFunction(n)?(i=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&ce.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){r=arguments,s.html(o?ce("<div>").append(ce.parseHTML(e)).find(o):e)}).complete(i&&function(e,t){s.each(i,r||[e.responseText,t,e])}),this},ce.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ce.fn[t]=function(e){return this.on(t,e)}}),ce.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:At,type:"GET",isLocal:Bt.test(qt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ft,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ce.parseJSON,"text xml":ce.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?D(D(e,ce.ajaxSettings),t):D(ce.ajaxSettings,e)},ajaxPrefilter:A(Mt),ajaxTransport:A(zt),ajax:function(n,i){function o(n,i,o,r){var a,p,y,x,w,C=i;2!==_&&(_=2,d&&clearTimeout(d),u=t,l=r||"",k.readyState=n>0?4:0,a=n>=200&&n<300||304===n,o&&(x=R(h,k,o)),x=U(h,x,k,a),a?(h.ifModified&&(w=k.getResponseHeader("Last-Modified"),w&&(ce.lastModified[s]=w),w=k.getResponseHeader("etag"),w&&(ce.etag[s]=w)),204===n||"HEAD"===h.type?C="nocontent":304===n?C="notmodified":(C=x.state,p=x.data,y=x.error,a=!y)):(y=C,!n&&C||(C="error",n<0&&(n=0))),k.status=n,k.statusText=(i||C)+"",a?(e.qyerUtil&&"function"==typeof e.qyerUtil.ajaxFillter&&e.qyerUtil.ajaxFillter(p,C,k),g.resolveWith(f,[p,C,k])):g.rejectWith(f,[k,C,y]),k.statusCode(v),v=t,c&&m.trigger(a?"ajaxSuccess":"ajaxError",[k,h,a?p:y]),b.fireWith(f,[k,C]),c&&(m.trigger("ajaxComplete",[k,h]),--ce.active||ce.event.trigger("ajaxStop")))}"object"==typeof n&&(i=n,n=t),i=i||{};var r,a,s,l,d,c,u,p,h=ce.ajaxSetup({},i),f=h.context||h,m=h.context&&(f.nodeType||f.jquery)?ce(f):ce.event,g=ce.Deferred(),b=ce.Callbacks("once memory"),v=h.statusCode||{},y={},x={},_=0,w="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(2===_){if(!p)for(p={};t=Ot.exec(l);)p[t[1].toLowerCase()]=t[2];t=p[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===_?l:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return _||(e=x[n]=x[n]||e,y[e]=t),this},overrideMimeType:function(e){return _||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(_<2)for(t in e)v[t]=[v[t],e[t]];else k.always(e[k.status]);return this},abort:function(e){var t=e||w;return u&&u.abort(t),o(0,t),this}};if(g.promise(k).complete=b.add,k.success=k.done,k.error=k.fail,h.url=((n||h.url||At)+"").replace(Rt,"").replace(jt,qt[1]+"//"),h.type=i.method||i.type||h.method||h.type,h.dataTypes=ce.trim(h.dataType||"*").toLowerCase().match(pe)||[""],null==h.crossDomain&&(r=Pt.exec(h.url.toLowerCase()),h.crossDomain=!(!r||r[1]===qt[1]&&r[2]===qt[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(qt[3]||("http:"===qt[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=ce.param(h.data,h.traditional)),I(Mt,h,i,k),2===_)return k;c=h.global,c&&0===ce.active++&&ce.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Lt.test(h.type),s=h.url,h.hasContent||(h.data&&(s=h.url+=(Dt.test(s)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=Ut.test(s)?s.replace(Ut,"$1_="+It++):s+(Dt.test(s)?"&":"?")+"_="+It++)),h.ifModified&&(ce.lastModified[s]&&k.setRequestHeader("If-Modified-Since",ce.lastModified[s]),ce.etag[s]&&k.setRequestHeader("If-None-Match",ce.etag[s])),(h.data&&h.hasContent&&h.contentType!==!1||i.contentType)&&k.setRequestHeader("Content-Type",h.contentType),k.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Ft+"; q=0.01":""):h.accepts["*"]);for(a in h.headers)k.setRequestHeader(a,h.headers[a]);if(h.beforeSend&&(h.beforeSend.call(f,k,h)===!1||2===_))return k.abort();w="abort";for(a in{success:1,error:1,complete:1})k[a](h[a]);if(u=I(zt,h,i,k)){k.readyState=1,c&&m.trigger("ajaxSend",[k,h]),h.async&&h.timeout>0&&(d=setTimeout(function(){k.abort("timeout")},h.timeout));try{_=1,u.send(y,o)}catch(C){if(!(_<2))throw C;o(-1,C)}}else o(-1,"No Transport");return k},getJSON:function(e,t,n){return ce.get(e,t,n,"json")},getScript:function(e,n){return ce.get(e,t,n,"script")}}),ce.each(["get","post"],function(e,n){ce[n]=function(e,i,o,r){return ce.isFunction(i)&&(r=r||o,o=i,i=t),ce.ajax({url:e,type:n,dataType:r,data:i,success:o})}}),ce.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ce.globalEval(e),e}}}),ce.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ce.ajaxTransport("script",function(e){if(e.crossDomain){var n,i=K.head||ce("head")[0]||K.documentElement;return{send:function(t,o){n=K.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||o(200,"success"))},i.insertBefore(n,i.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Vt=[],Xt=/(=)\?(?=&|$)|\?\?/;ce.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Vt.pop()||ce.expando+"_"+It++;return this[e]=!0,e}}),ce.ajaxPrefilter("json jsonp",function(n,i,o){var r,a,s,l=n.jsonp!==!1&&(Xt.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xt.test(n.data)&&"data");if(l||"jsonp"===n.dataTypes[0])return r=n.jsonpCallback=ce.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Xt,"$1"+r):n.jsonp!==!1&&(n.url+=(Dt.test(n.url)?"&":"?")+n.jsonp+"="+r),n.converters["script json"]=function(){return s||ce.error(r+" was not called"),s[0]},n.dataTypes[0]="json",a=e[r],e[r]=function(){s=arguments},o.always(function(){e[r]=a,n[r]&&(n.jsonpCallback=i.jsonpCallback,Vt.push(r)),s&&ce.isFunction(a)&&a(s[0]),s=a=t}),"script"});var Gt,Yt,Kt=0,Jt=e.ActiveXObject&&function(){var e;for(e in Gt)Gt[e](t,!0)};ce.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&O()||B()}:O,Yt=ce.ajaxSettings.xhr(),ce.support.cors=!!Yt&&"withCredentials"in Yt,Yt=ce.support.ajax=!!Yt,Yt&&ce.ajaxTransport(function(n){if(!n.crossDomain||ce.support.cors){var i;return{send:function(o,r){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");try{for(s in o)l.setRequestHeader(s,o[s])}catch(d){}l.send(n.hasContent&&n.data||null),i=function(e,o){var s,d,c,u;try{if(i&&(o||4===l.readyState))if(i=t,a&&(l.onreadystatechange=ce.noop,Jt&&delete Gt[a]),o)4!==l.readyState&&l.abort();else{u={},s=l.status,d=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{c=l.statusText}catch(p){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=u.text?200:404}}catch(h){o||r(-1,h)}u&&r(s,c,u,d)},n.async?4===l.readyState?setTimeout(i):(a=++Kt,Jt&&(Gt||(Gt={},ce(e).unload(Jt)),Gt[a]=i),l.onreadystatechange=i):i()},abort:function(){i&&i(t,!0)}}}});var Qt,Zt,en=/^(?:toggle|show|hide)$/,tn=new RegExp("^(?:([+-])=|)("+ue+")([a-z%]*)$","i"),nn=/queueHooks$/,on=[M],rn={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),o=tn.exec(t),r=o&&o[3]||(ce.cssNumber[e]?"":"px"),a=(ce.cssNumber[e]||"px"!==r&&+i)&&tn.exec(ce.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==r){r=r||a[3],o=o||[],a=+i||1;do s=s||".5",a/=s,ce.style(n.elem,e,a+r);while(s!==(s=n.cur()/i)&&1!==s&&--l)}return o&&(a=n.start=+a||+i||0,n.unit=r,n.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),n}]};ce.Animation=ce.extend(P,{tweener:function(e,t){ce.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,o=e.length;i<o;i++)n=e[i],rn[n]=rn[n]||[],rn[n].unshift(t)},prefilter:function(e,t){t?on.unshift(e):on.push(e)}}),ce.Tween=z,z.prototype={constructor:z,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(ce.cssNumber[n]?"":"px")},cur:function(){var e=z.propHooks[this.prop];return e&&e.get?e.get(this):z.propHooks._default.get(this)},run:function(e){var t,n=z.propHooks[this.prop];return this.options.duration?this.pos=t=ce.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):z.propHooks._default.set(this),this}},z.prototype.init.prototype=z.prototype,z.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ce.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ce.fx.step[e.prop]?ce.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ce.cssProps[e.prop]]||ce.cssHooks[e.prop])?ce.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},z.propHooks.scrollTop=z.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ce.each(["toggle","show","hide"],function(e,t){var n=ce.fn[t];ce.fn[t]=function(e,i,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(F(t,!0),e,i,o)}}),ce.fn.extend({fadeTo:function(e,t,n,i){return this.filter(k).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=ce.isEmptyObject(e),r=ce.speed(t,n,i),a=function(){var t=P(this,ce.extend({},e),r);(o||ce._data(this,"finish"))&&t.stop(!0)};return a.finish=a,o||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,n,i){var o=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",r=ce.timers,a=ce._data(this);if(n)a[n]&&a[n].stop&&o(a[n]);else for(n in a)a[n]&&a[n].stop&&nn.test(n)&&o(a[n]);for(n=r.length;n--;)r[n].elem!==this||null!=e&&r[n].queue!==e||(r[n].anim.stop(i),t=!1,r.splice(n,1));!t&&i||ce.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=ce._data(this),i=n[e+"queue"],o=n[e+"queueHooks"],r=ce.timers,a=i?i.length:0;for(n.finish=!0,ce.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<a;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),ce.each({slideDown:F("show"),slideUp:F("hide"),slideToggle:F("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ce.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),ce.speed=function(e,t,n){var i=e&&"object"==typeof e?ce.extend({},e):{complete:n||!n&&t||ce.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ce.isFunction(t)&&t};return i.duration=ce.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in ce.fx.speeds?ce.fx.speeds[i.duration]:ce.fx.speeds._default,null!=i.queue&&i.queue!==!0||(i.queue="fx"),i.old=i.complete,i.complete=function(){ce.isFunction(i.old)&&i.old.call(this),i.queue&&ce.dequeue(this,i.queue)},i},ce.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ce.timers=[],ce.fx=z.prototype.init,ce.fx.tick=function(){var e,n=ce.timers,i=0;for(Qt=ce.now();i<n.length;i++)e=n[i],e()||n[i]!==e||n.splice(i--,1);n.length||ce.fx.stop(),Qt=t},ce.fx.timer=function(e){e()&&ce.timers.push(e)&&ce.fx.start()},ce.fx.interval=13,ce.fx.start=function(){Zt||(Zt=setInterval(ce.fx.tick,ce.fx.interval))},ce.fx.stop=function(){clearInterval(Zt),Zt=null},ce.fx.speeds={slow:600,fast:200,_default:400},ce.fx.step={},ce.expr&&ce.expr.filters&&(ce.expr.filters.animated=function(e){return ce.grep(ce.timers,function(t){return e===t.elem}).length}),ce.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ce.offset.setOffset(this,e,t)});var n,i,o={top:0,left:0},r=this[0],a=r&&r.ownerDocument;if(a)return n=a.documentElement,ce.contains(n,r)?(typeof r.getBoundingClientRect!==G&&(o=r.getBoundingClientRect()),i=W(a),{top:o.top+(i.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(i.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},ce.offset={setOffset:function(e,t,n){var i=ce.css(e,"position");"static"===i&&(e.style.position="relative");var o,r,a=ce(e),s=a.offset(),l=ce.css(e,"top"),d=ce.css(e,"left"),c=("absolute"===i||"fixed"===i)&&ce.inArray("auto",[l,d])>-1,u={},p={};c?(p=a.position(),o=p.top,r=p.left):(o=parseFloat(l)||0,r=parseFloat(d)||0),ce.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(u.top=t.top-s.top+o),null!=t.left&&(u.left=t.left-s.left+r),"using"in t?t.using.call(e,u):a.css(u)}},ce.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===ce.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ce.nodeName(e[0],"html")||(n=e.offset()),n.top+=ce.css(e[0],"borderTopWidth",!0),n.left+=ce.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-ce.css(i,"marginTop",!0),left:t.left-n.left-ce.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||J;e&&!ce.nodeName(e,"html")&&"static"===ce.css(e,"position");)e=e.offsetParent;return e||J})}}),ce.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i=/Y/.test(n);ce.fn[e]=function(o){return ce.access(this,function(e,o,r){var a=W(e);return r===t?a?n in a?a[n]:a.document.documentElement[o]:e[o]:void(a?a.scrollTo(i?ce(a).scrollLeft():r,i?r:ce(a).scrollTop()):e[o]=r);
},e,o,arguments.length,null)}}),ce.each({Height:"height",Width:"width"},function(e,n){ce.each({padding:"inner"+e,content:n,"":"outer"+e},function(i,o){ce.fn[o]=function(o,r){var a=arguments.length&&(i||"boolean"!=typeof o),s=i||(o===!0||r===!0?"margin":"border");return ce.access(this,function(n,i,o){var r;return ce.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(r=n.documentElement,Math.max(n.body["scroll"+e],r["scroll"+e],n.body["offset"+e],r["offset"+e],r["client"+e])):o===t?ce.css(n,i,s):ce.style(n,i,o,s)},n,a?o:t,a,null)}})}),ce.fn.size=function(){return this.length},ce.fn.andSelf=ce.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ce:(e.jQuery=e.$=ce,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ce}))}(window),function(){function e(e,i){return n(e||self.document.URL||self.location.href,i||t())}function t(){var e=document.getElementsByTagName("script");return e[e.length-1].src}function n(e,t){var n=t;return/^(\/|\\\\)/.test(t)?n=/^.+?\w(\/|\\\\)/.exec(e)[0]+t.replace(/^(\/|\\\\)/,""):/^[a-z]+:/i.test(t)||(e=e.split("#")[0].split("?")[0].replace(/[^\\\/]+$/,""),n=e+""+t),i(n)}function i(e){var t=/^[a-z]+:\/\//.exec(e)[0],n=null,i=[];for(e=e.replace(t,"").split("?")[0].split("#")[0],e=e.replace(/\\/g,"/").split(/\//),e[e.length-1]="";e.length;)".."===(n=e.shift())?i.pop():"."!==n&&i.push(n);return t+i.join("/")}window.UEDITOR_HOME_URL="//common1.qyerstatic.com/bbs/old/js/utf8-php/";var o=window.UEDITOR_HOME_URL||e();window.UEDITOR_CONFIG={UEDITOR_HOME_URL:o,serverUrl:o+"php/controller.php",imageScaleEnabled:!1,pasteplain:!0,filterTxtRules:function(){function e(e){e.tagName="p",e.attrs={}}function t(e){e.parentNode.removeChild(e,!0)}function n(e){var t=e.parentNode.children;1!=t.length&&(e.tagName="p",e.attrs={})}return{"-":"script style object iframe embed input select",p:{$:{}},img:function(e){return"emotion"==e.attrs["data-id"]?e:void t(e)},a:function(e){for(var t in e.attrs)"href"!=t&&delete e.attrs[t];e.attrs.target="_blank"},br:n,div:function(e){for(var t,n=UE.uNode.createElement("p");t=e.firstChild();)"text"!=t.type&&UE.dom.dtd.$block[t.tagName]?n.firstChild()?(e.parentNode.insertBefore(n,e),n=UE.uNode.createElement("p")):e.parentNode.insertBefore(t,e):n.appendChild(t);n.firstChild()&&e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:e,th:e,tr:e,h3:e,h4:e,h5:e,h6:e,td:function(e){var t=!!e.innerText();t&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e),e.parentNode.removeChild(e,e.innerText())}}}(),elementPathEnabled:!1,wordCount:!1},window.UE={getUEBasePath:e}}(),UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu,window.UE=baidu.editor={plugins:{},commands:{},instants:{},I18N:{},_customizeUI:{},version:"1.5.0"};var dom=UE.dom={},browser=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/i.test(e),opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera&&!n.ie;var i=0;if(n.ie){var o=e.match(/(?:msie\s([\w.]+))/),r=e.match(/(?:trident.*rv:([\w.]+))/);i=o&&r&&o[1]&&r[1]?Math.max(1*o[1],1*r[1]):o&&o[1]?1*o[1]:r&&r[1]?1*r[1]:0,n.ie11Compat=11==document.documentMode,n.ie9Compat=9==document.documentMode,n.ie8=!!document.documentMode,n.ie8Compat=8==document.documentMode,n.ie7Compat=7==i&&!document.documentMode||7==document.documentMode,n.ie6Compat=i<7||n.quirks,n.ie9above=i>8,n.ie9below=i<9,n.ie11above=i>10,n.ie11below=i<11}if(n.gecko){var a=e.match(/rv:([\d\.]+)/);a&&(a=a[1].split("."),i=1e4*a[0]+100*(a[1]||0)+1*(a[2]||0))}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(i=parseFloat(t.version())),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!n.mobile&&(n.ie&&i>=6||n.gecko&&i>=10801||n.opera&&i>=9.5||n.air&&i>=1||n.webkit&&i>=522||!1),n}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera,utils=UE.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var i=0,o=e.length;i<o;i++)if(t.call(n,e[i],i,e)===!1)return!1}else for(var r in e)if(e.hasOwnProperty(r)&&t.call(n,e[r],r,e)===!1)return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var i in t)n&&e.hasOwnProperty(i)||(e[i]=t[i]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var i=t[n];for(var o in i)e.hasOwnProperty(o)||(e[o]=i[o])}return e},inherits:function(e,t){var n=e.prototype,i=utils.makeInstance(t.prototype);return utils.extend(i,n,!0),e.prototype=i,i.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var i;return function(){n&&clearTimeout(i),i=setTimeout(e,t)}},indexOf:function(e,t,n){var i=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,o){if(o>=n&&e===t)return i=o,!1}),i},removeItem:function(e,t){for(var n=0,i=e.length;n<i;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t,n=0,i={};t=e[n++];)i[t.toUpperCase()]=i[t]=1;return i},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":void 0!=e.cssFloat?"cssFloat":void 0!=e.styleFloat?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function e(e,n){try{for(var i,o=0;i=t[o++];)if(i.doc===e&&i.url==(n.src||n.href))return i}catch(r){return null}}var t=[];return function(n,i,o){var r=e(n,i);if(r)return void(r.ready?o&&o():r.funs.push(o));if(t.push({doc:n,url:i.src||i.href,funs:[o]}),!n.body){var a=[];for(var s in i)"tag"!=s&&a.push(s+'="'+i[s]+'"');return void n.write("<"+i.tag+" "+a.join(" ")+" ></"+i.tag+">")}if(!i.id||!n.getElementById(i.id)){var l=n.createElement(i.tag);delete i.tag;for(var s in i)l.setAttribute(s,i[s]);l.onload=l.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(r=e(n,i),r.funs.length>0){r.ready=1;for(var t;t=r.funs.pop();)t()}l.onload=l.onreadystatechange=null}},l.onerror=function(){throw Error("The load "+(i.href||i.src)+" fails,check the url settings of file ueditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(l)}}}(),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var i,o=0;i=n[o++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=1==i.length?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(e){function t(e,t){if(!e)return"";var n=e.top,i=e.bottom,o=e.left,r=e.right,a="";if(n&&o&&i&&r)a+=";"+t+":"+(n==i&&i==o&&o==r?n:n==i&&o==r?n+" "+o:o==r?n+" "+o+" "+i:n+" "+r+" "+i+" "+o)+";";else for(var s in e)a+=";"+t+"-"+s+":"+e[s]+";";return a}var n,i;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,o,r){if(1==r.split(" ").length)switch(t){case"padding":return!n&&(n={}),n[o]=r,"";case"margin":return!i&&(i={}),i[o]=r,"";case"border":return"initial"==r?"":e}return e}),e+=t(n,"padding")+t(i,"margin"),e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n;t=t||{};for(var i in e)e.hasOwnProperty(i)&&(n=e[i],"object"==typeof n?(t[i]=utils.isArray(n)?[]:{},utils.clone(e[i],t[i])):t[i]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;switch(e.replace(/([\d.]+)(\w+)/,function(n,i,o){e=i,t=o}),t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},domReady:function(){function e(e){e.isReady=!0;for(var n;n=t.pop();n());}var t=[];return function(n,i){i=i||window;var o=i.document;n&&t.push(n),"complete"===o.readyState?e(o):(o.isReady&&e(o),browser.ie&&11!=browser.version?(!function(){if(!o.isReady){try{o.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e(o)}}(),i.attachEvent("onload",function(){e(o)})):(o.addEventListener("DOMContentLoaded",function(){o.removeEventListener("DOMContentLoaded",arguments.callee,!1),e(o)},!1),i.addEventListener("load",function(){e(o)},!1)))}}(),cssRule:browser.ie&&11!=browser.version?function(e,t,n){var i,o;if(void 0===t||t&&t.nodeType&&9==t.nodeType){if(n=t&&t.nodeType&&9==t.nodeType?t:n||document,i=n.indexList||(n.indexList={}),o=i[e],void 0!==o)return n.styleSheets[o].cssText}else{if(n=n||document,i=n.indexList||(n.indexList={}),o=i[e],""===t)return void 0!==o&&(n.styleSheets[o].cssText="",delete i[e],!0);void 0!==o?sheetStyle=n.styleSheets[o]:(sheetStyle=n.createStyleSheet("",o=n.styleSheets.length),i[e]=o),sheetStyle.cssText=t}}:function(e,t,n){var i;return void 0===t||t&&t.nodeType&&9==t.nodeType?(n=t&&t.nodeType&&9==t.nodeType?t:n||document,i=n.getElementById(e),i?i.innerHTML:void 0):(n=n||document,i=n.getElementById(e),""===t?!!i&&(i.parentNode.removeChild(i),!0):void(i?i.innerHTML=t:(i=n.createElement("style"),i.id=e,i.innerHTML=t,n.getElementsByTagName("head")[0].appendChild(i))))},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var n=0,i=e.length;n<i;n++)for(var o=n,r=e.length;o<r;o++)if(t(e[n],e[o])>0){var a=e[n];e[n]=e[o],e[o]=a}return e},serializeParam:function(e){var t=[];for(var n in e)if("method"!=n&&"timeout"!=n&&"async"!=n)if("function"!=(typeof e[n]).toLowerCase()&&"object"!=(typeof e[n]).toLowerCase())t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));else if(utils.isArray(e[n]))for(var i=0;i<e[n].length;i++)t.push(encodeURIComponent(n)+"[]="+encodeURIComponent(e[n][i]));return t.join("&")},formatUrl:function(e){var t=e.replace(/&&/g,"&");return t=t.replace(/\?&/g,"?"),t=t.replace(/&$/g,""),t=t.replace(/&#/g,"#"),t=t.replace(/&+/g,"&")},isCrossDomainUrl:function(e){var t=document.createElement("a");return t.href=e,browser.ie&&(t.href=t.href),!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||"80"==t.port&&""==location.port||""==t.port&&"80"==location.port))},clearEmptyAttrs:function(e){for(var t in e)""===e[t]&&delete e[t];return e},str2json:function(e){return utils.isString(e)?window.JSON?JSON.parse(e):new Function("return "+utils.trim(e||""))():null},json2str:function(){function e(e){return/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/["\\\x00-\x1f]/g,function(e){var t=o[e];return t?t:(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})),'"'+e+'"'}function t(e){var t,n,i,o=["["],r=e.length;for(n=0;n<r;n++)switch(i=e[n],typeof i){case"undefined":case"function":case"unknown":break;default:t&&o.push(","),o.push(utils.json2str(i)),t=1}return o.push("]"),o.join("")}function n(e){return e<10?"0"+e:e}function i(e){return'"'+e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())+'"'}if(window.JSON)return JSON.stringify;var o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(n){switch(typeof n){case"undefined":return"undefined";case"number":return isFinite(n)?String(n):"null";case"string":return e(n);case"boolean":return String(n);default:if(null===n)return"null";if(utils.isArray(n))return t(n);if(utils.isDate(n))return i(n);var o,r,a=["{"],s=utils.json2str;for(var l in n)if(Object.prototype.hasOwnProperty.call(n,l))switch(r=n[l],typeof r){case"undefined":case"unknown":case"function":break;default:o&&a.push(","),o=1,a.push(s(l)+":"+s(r))}return a.push("}"),a.join("")}}}()};utils.each(["String","Function","Array","Number","RegExp","Object","Date"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(e,t){e=utils.trim(e).split(/\s+/);for(var n,i=0;n=e[i++];)getListener(this,n,!0).push(t)},on:function(e,t){return this.addListener(e,t)},off:function(e,t){return this.removeListener(e,t)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(e,t){e=utils.trim(e).split(/\s+/);for(var n,i=0;n=e[i++];)utils.removeItem(getListener(this,n)||[],t)},fireEvent:function(){var e=arguments[0];e=utils.trim(e).split(" ");for(var t,n=0;t=e[n++];){var i,o,r,a=getListener(this,t);if(a)for(r=a.length;r--;)if(a[r]){if(o=a[r].apply(this,arguments),o===!0)return o;void 0!==o&&(i=o)}(o=this["on"+t.toLowerCase()])&&(i=o.apply(this,arguments))}return i}};var dtd=dom.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}var t=utils.extend2,n=e({isindex:1,fieldset:1}),i=e({input:1,button:1,select:1,textarea:1,label:1}),o=t(e({a:1}),i),r=t({iframe:1},o),a=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),s=e({ins:1,del:1,script:1,style:1}),l=t(e({mark:1,b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),s),d=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),l),c=t(e({p:1}),d),u=t(e({iframe:1}),d,i),p=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),h=t(e({a:0}),u),f=e({tr:1}),m=e({"#":1}),g=t(e({param:1}),p),b=t(e({form:1}),n,r,a,c),v=e({li:1,ol:1,ul:1}),y=e({style:1,script:1}),x=e({base:1,link:1,meta:1,title:1}),_=t(x,y),w=e({head:1,body:1}),k=e({html:1}),C=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),E=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(k,w,x),$block:C,$inline:h,$inlineWithA:t(e({a:1}),h),$body:t(e({script:1,style:1}),C),$cdata:e({script:1,style:1}),$empty:E,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:w,head:_,style:m,script:m,body:b,base:{},link:{},meta:{},title:m,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:b,td:b,br:{},th:b,center:b,kbd:h,button:t(c,a),basefont:{},h5:h,h4:h,samp:h,h6:h,ol:v,h1:h,h3:h,option:m,h2:h,form:t(n,r,a,c),select:e({optgroup:1,option:1}),font:h,ins:h,menu:v,abbr:h,label:h,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:h,tfoot:f,cite:h,li:b,input:{},iframe:b,strong:h,textarea:m,noframes:b,big:h,small:h,span:e({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:h,dt:h,sub:h,optgroup:e({option:1}),param:{},bdo:h,"var":h,div:b,object:g,sup:h,dd:b,strike:h,area:{},dir:v,map:t(e({area:1,form:1,p:1}),n,s,a),applet:g,dl:e({dt:1,dd:1}),del:h,isindex:{},fieldset:t(e({legend:1}),p),thead:f,ul:v,acronym:h,b:h,a:t(e({a:1}),u),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),b),caption:h,i:h,u:h,tbody:f,s:h,address:t(r,c),tt:h,legend:h,q:h,pre:t(l,o),p:t(e({a:1}),h),em:h,dfn:h,mark:h})}(),attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&"6"==browser.version?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;var n,i=[e],o=[t];for(n=e;n=n.parentNode;){if(n===t)return 10;i.push(n)}for(n=t;n=n.parentNode;){if(n===e)return 20;o.push(n)}if(i.reverse(),o.reverse(),i[0]!==o[0])return 1;for(var r=-1;r++,i[r]===o[r];);for(e=i[r],t=o[r];e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var n=e,i=0;n=n.previousSibling;)t&&3==n.nodeType?n.nodeType!=n.nextSibling.nodeType&&i++:i++;return i},inDoc:function(e,t){return 10==domUtils.getPosition(e,t)},findParent:function(e,t,n){if(e&&!domUtils.isBody(e))for(e=n?e:e.parentNode;e;){if(!t||t(e)||domUtils.isBody(e))return t&&!t(e)&&domUtils.isBody(e)?null:e;e=e.parentNode}return null},findParentByTagName:function(e,t,n,i){return t=utils.listToMap(utils.isArray(t)?t:[t]),domUtils.findParent(e,function(e){return t[e.tagName]&&!(i&&i(e))},n)},findParents:function(e,t,n,i){for(var o=t&&(n&&n(e)||!n)?[e]:[];e=domUtils.findParent(e,n);)o.push(e);return i?o:o.reverse()},insertAfter:function(e,t){return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},remove:function(e,t){var n,i=e.parentNode;if(i){if(t&&e.hasChildNodes())for(;n=e.firstChild;)i.insertBefore(n,e);i.removeChild(e)}return e},getNextDomNode:function(e,t,n,i){return getDomNode(e,"firstChild","nextSibling",t,n,i)},getPreDomNode:function(e,t,n,i){return getDomNode(e,"lastChild","previousSibling",t,n,i)},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;for(var n=[e],i=[t],o=e,r=-1;o=o.parentNode;){if(o===t)return o;n.push(o)}for(o=t;o=o.parentNode;){if(o===e)return o;i.push(o)}for(n.reverse(),i.reverse();r++,n[r]===i[r];);return 0==r?null:n[r-1]},clearEmptySibling:function(e,t,n){function i(e,t){for(var n;e&&!domUtils.isBookmarkNode(e)&&(domUtils.isEmptyInlineElement(e)||!new RegExp("[^\t\n\r"+domUtils.fillChar+"]").test(e.nodeValue));)n=e[t],domUtils.remove(e),e=n}!t&&i(e.nextSibling,"nextSibling"),!n&&i(e.previousSibling,"previousSibling")},split:function(e,t){var n=e.ownerDocument;if(browser.ie&&t==e.nodeValue.length){var i=n.createTextNode("");return domUtils.insertAfter(e,i)}var o=e.splitText(t);if(browser.ie8){var r=n.createTextNode("");domUtils.insertAfter(o,r),domUtils.remove(r)}return o},isWhitespace:function(e){return!new RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,n=0;e.offsetParent;)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},on:function(e,t,n){var i=utils.isArray(t)?t:utils.trim(t).split(/\s+/),o=i.length;if(o)for(;o--;)if(t=i[o],e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={els:[]});var r=t+n.toString(),a=utils.indexOf(n._d.els,e);n._d[r]&&a!=-1||(a==-1&&n._d.els.push(e),n._d[r]||(n._d[r]=function(e){return n.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,n._d[r]))}e=null},un:function(e,t,n){var i=utils.isArray(t)?t:utils.trim(t).split(/\s+/),o=i.length;if(o)for(;o--;)if(t=i[o],e.removeEventListener)e.removeEventListener(t,n,!1);else{var r=t+n.toString();try{e.detachEvent("on"+t,n._d?n._d[r]:n)}catch(a){}if(n._d&&n._d[r]){var s=utils.indexOf(n._d.els,e);s!=-1&&n._d.els.splice(s,1),0==n._d.els.length&&delete n._d[r]}}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return!1;var n=e.attributes,i=t.attributes;if(!ie&&n.length!=i.length)return!1;for(var o,r,a=0,s=0,l=0;o=n[l++];){if("style"==o.nodeName){if(o.specified&&a++,domUtils.isSameStyle(e,t))continue;return!1}if(ie){if(!o.specified)continue;a++,r=i.getNamedItem(o.nodeName)}else r=t.attributes[o.nodeName];if(!r.specified||o.nodeValue!=r.nodeValue)return!1}if(ie){for(l=0;r=i[l++];)r.specified&&s++;if(a!=s)return!1}return!0},isSameStyle:function(e,t){var n=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),i=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){if(n=e.style,i=t.style,n.length!=i.length)return!1;for(var o in n)if(!/^(\d+|csstext)$/i.test(o)&&n[o]!=i[o])return!1;return!0}if(!n||!i)return n==i;if(n=n.split(";"),i=i.split(";"),n.length!=i.length)return!1;for(var r,a=0;r=n[a++];)if(utils.indexOf(i,r)==-1)return!1;return!0},isBlockElm:function(e){return 1==e.nodeType&&(dtd.$block[e.tagName]||styleBlock[domUtils.getComputedStyle(e,"display")])&&!dtd.$nonChild[e.tagName]},isBody:function(e){return e&&1==e.nodeType&&"body"==e.tagName.toLowerCase()},breakParent:function(e,t){var n,i,o,r=e,a=e;do{for(r=r.parentNode,i?(n=r.cloneNode(!1),n.appendChild(i),i=n,n=r.cloneNode(!1),n.appendChild(o),o=n):(i=r.cloneNode(!1),o=i.cloneNode(!1));n=a.previousSibling;)i.insertBefore(n,i.firstChild);for(;n=a.nextSibling;)o.appendChild(n);a=r}while(t!==r);return n=t.parentNode,n.insertBefore(i,t),n.insertBefore(o,t),n.insertBefore(e,o),domUtils.remove(t),e},isEmptyInlineElement:function(e){if(1!=e.nodeType||!dtd.$removeEmpty[e.tagName])return 0;for(e=e.firstChild;e;){if(domUtils.isBookmarkNode(e))return 0;if(1==e.nodeType&&!domUtils.isEmptyInlineElement(e)||3==e.nodeType&&!domUtils.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){for(var n;(n=e[t])&&3==n.nodeType&&domUtils.isWhitespace(n);)e.removeChild(n)}t("firstChild"),t("lastChild")},mergeChild:function(e,t,n){for(var i,o=domUtils.getElementsByTagName(e,e.tagName.toLowerCase()),r=0;i=o[r++];)if(i.parentNode&&!domUtils.isBookmarkNode(i))if("span"!=i.tagName.toLowerCase())domUtils.isSameElement(e,i)&&domUtils.remove(i,!0);else{if(e===i.parentNode&&(domUtils.trimWhiteTextNode(e),1==e.childNodes.length)){e.style.cssText=i.style.cssText+";"+e.style.cssText,domUtils.remove(i,!0);continue}if(i.style.cssText=e.style.cssText+";"+i.style.cssText,n){var a=n.style;if(a){a=a.split(";");for(var s,l=0;s=a[l++];)i.style[utils.cssStyleToDomStyle(s.split(":")[0])]=s.split(":")[1]}}domUtils.isSameStyle(i,e)&&domUtils.remove(i,!0)}},getElementsByTagName:function(e,t,n){var i=[];if(e&&e.length){if(n&&utils.isString(n)){var o=n;n=function(e){return domUtils.hasClass(e,o)}}t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var r,a=0;r=t[a++];)if(e.getElementsByTagName)for(var s,l=e.getElementsByTagName(r),d=0;s=l[d++];)n&&!n(s)||i.push(s)}return i},mergeToParent:function(e){for(var t=e.parentNode;t&&dtd.$removeEmpty[t.tagName];){if(t.tagName==e.tagName||"A"==t.tagName){if(domUtils.trimWhiteTextNode(t),"SPAN"==t.tagName&&!domUtils.isSameStyle(t,e)||"A"==t.tagName&&"SPAN"==e.tagName){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText,t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText,"A"==t.tagName&&(t.style.textDecoration="underline")}if("A"!=t.tagName){t===e.parentNode&&domUtils.remove(e,!0);break}}t=t.parentNode}},mergeSibling:function(e,t,n){function i(e,t,n){var i;if((i=n[e])&&!domUtils.isBookmarkNode(i)&&1==i.nodeType&&domUtils.isSameElement(n,i)){for(;i.firstChild;)"firstChild"==t?n.insertBefore(i.lastChild,n.firstChild):n.appendChild(i.firstChild);domUtils.remove(i)}}!t&&i("previousSibling","firstChild",e),!n&&i("nextSibling","lastChild",e)},unSelectable:ie&&browser.ie9below||browser.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t,n=0;t=e.all[n++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0;n=t[i++];){switch(n=attrFix[n]||n){case"className":e[n]="";break;case"style":e.style.cssText="";var o=e.getAttributeNode("style");!browser.ie&&o&&e.removeAttributeNode(o)}e.removeAttribute(n)}},createElement:function(e,t,n){return domUtils.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];switch(n){case"class":e.className=i;break;case"style":e.style.cssText=e.style.cssText+";"+i;break;case"innerHTML":e[n]=i;break;case"value":e.value=i;break;default:e.setAttribute(attrFix[n]||n,i)}}return e},getComputedStyle:function(e,t){var n="width height top left";if(n.indexOf(t)>-1)return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";if(3==e.nodeType&&(e=e.parentNode),browser.ie&&browser.version<9&&"font-size"==t&&!e.style.fontSize&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]){var i=e.ownerDocument.createElement("span");i.style.cssText="padding:0;border:0;font-family:simsun;",i.innerHTML=".",e.appendChild(i);var o=i.offsetHeight;return e.removeChild(i),i=null,o+"px"}try{var r=domUtils.getStyle(e,t)||(window.getComputedStyle?domUtils.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[utils.cssStyleToDomStyle(t)])}catch(a){return""}return utils.transUnitToPx(utils.fixColor(t,r))},removeClasses:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)o=o.replace(new RegExp("\\b"+n+"\\b"),"");o=utils.trim(o).replace(/[ ]{2,}/g," "),o?e.className=o:domUtils.removeAttributes(e,["class"])},addClass:function(e,t){if(e){t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)new RegExp("\\b"+n+"\\b").test(o)||(o+=" "+n);e.className=utils.trim(o)}},hasClass:function(e,t){if(utils.isRegExp(t))return t.test(e.className);t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)if(!new RegExp("\\b"+n+"\\b","i").test(o))return!1;return i-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){browser.ie?("color"==t&&(t="(^|;)"+t),e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),"")):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(utils.cssStyleToDomStyle(t)),e.style.cssText||domUtils.removeAttributes(e,["style"])},getStyle:function(e,t){var n=e.style[utils.cssStyleToDomStyle(t)];return utils.fixColor(t,n)},setStyle:function(e,t,n){e.style[utils.cssStyleToDomStyle(t)]=n,utils.trim(e.style.cssText)||this.removeAttributes(e,"style")},setStyles:function(e,t){for(var n in t)t.hasOwnProperty(n)&&domUtils.setStyle(e,n,t[n])},removeDirtyAttr:function(e){for(var t,n=0,i=e.getElementsByTagName("*");t=i[n++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,i=e.firstChild;for(t=t||function(){return 1};i;)t(i)&&n++,i=i.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||0==domUtils.getChildCount(e,function(e){return!domUtils.isBr(e)&&!domUtils.isBookmarkNode(e)&&!domUtils.isWhitespace(e)})},clearSelectedArr:function(e){for(var t;t=e.pop();)domUtils.removeAttributes(t,["class"])},scrollToView:function(e,t,n){var i=function(){var e=t.document,n="CSS1Compat"==e.compatMode;return{width:(n?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(n?e.documentElement.clientHeight:e.body.clientHeight)||0}},o=function(e){if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},r=i().height,a=r*-1+n||0;a+=e.offsetHeight||0;var s=domUtils.getXY(e);a+=s.y;var l=o(t).y;(a>l||a<l-r)&&t.scrollTo(0,a+(a<0?-20:20))},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){if(3!=e.nodeType)return!1;var n=e.nodeValue;return t?new RegExp("^"+domUtils.fillChar).test(n):!n.replace(new RegExp(domUtils.fillChar,"g"),"").length},isStartInblock:function(e){var t,n=e.cloneRange(),i=0,o=n.startContainer;if(1==o.nodeType&&o.childNodes[n.startOffset]){o=o.childNodes[n.startOffset];for(var r=o.previousSibling;r&&domUtils.isFillChar(r);)o=r,r=r.previousSibling}for(this.isFillChar(o,!0)&&1==n.startOffset&&(n.setStartBefore(o),o=n.startContainer);o&&domUtils.isFillChar(o);)t=o,o=o.previousSibling;for(t&&(n.setStartBefore(t),o=n.startContainer),1==o.nodeType&&domUtils.isEmptyNode(o)&&1==n.startOffset&&n.setStart(o,0).collapse(!0);!n.startOffset;){if(o=n.startContainer,domUtils.isBlockElm(o)||domUtils.isBody(o)){i=1;break}var a,r=n.startContainer.previousSibling;if(r){for(;r&&domUtils.isFillChar(r);)a=r,r=r.previousSibling;a?n.setStartBefore(a):n.setStartBefore(n.startContainer)}else n.setStartBefore(n.startContainer)}return i&&!domUtils.isBody(n.startContainer)?1:0},isEmptyBlock:function(e,t){if(1!=e.nodeType)return 0;if(t=t||new RegExp("[  \t\r\n"+domUtils.fillChar+"]","g"),e[browser.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var n in dtd.$isNotEmpty)if(e.getElementsByTagName(n).length)return 0;return 1},setViewportOffset:function(e,t){var n=0|parseInt(e.style.left),i=0|parseInt(e.style.top),o=e.getBoundingClientRect(),r=t.left-o.left,a=t.top-o.top;r&&(e.style.left=n+r+"px"),a&&(e.style.top=i+a+"px")},fillNode:function(e,t){var n=browser.ie?e.createTextNode(domUtils.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(n)},moveChild:function(e,t,n){for(;e.firstChild;)n&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return browser.ie?/^<\w+\s*?>/.test(e.outerHTML):0==e.attributes.length},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return 1==e.nodeType&&new RegExp("\\b"+e.tagName+"\\b","i").test(t)},filterNodeList:function(e,t,n){var i=[];if(!utils.isFunction(t)){var o=t;t=function(e){return utils.indexOf(utils.isArray(o)?o:o.split(" "),e.tagName.toLowerCase())!=-1}}return utils.each(e,function(e){t(e)&&i.push(e)}),0==i.length?null:1!=i.length&&n?i:i[0]},isInNodeEndBoundary:function(e,t){var n=e.startContainer;if(3==n.nodeType&&e.startOffset!=n.nodeValue.length)return 0;if(1==n.nodeType&&e.startOffset!=n.childNodes.length)return 0;for(;n!==t;){if(n.nextSibling)return 0;n=n.parentNode}return 1},isBoundaryNode:function(e,t){for(var n;!domUtils.isBody(e);)if(n=e,e=e.parentNode,n!==e[t])return!1;return!0},fillHtml:browser.ie11below?"&nbsp;":"<br/>"},fillCharReg=new RegExp(domUtils.fillChar,"g");
!function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function t(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function n(t,n,i,o){return 1==n.nodeType&&(dtd.$empty[n.tagName]||dtd.$nonChild[n.tagName])&&(i=domUtils.getNodeIndex(n)+(t?0:1),n=n.parentNode),t?(o.startContainer=n,o.startOffset=i,o.endContainer||o.collapse(!0)):(o.endContainer=n,o.endOffset=i,o.startContainer||o.collapse(!1)),e(o),o}function i(e,t){var n,i,o=e.startContainer,r=e.endContainer,a=e.startOffset,s=e.endOffset,l=e.document,d=l.createDocumentFragment();if(1==o.nodeType&&(o=o.childNodes[a]||(n=o.appendChild(l.createTextNode("")))),1==r.nodeType&&(r=r.childNodes[s]||(i=r.appendChild(l.createTextNode("")))),o===r&&3==o.nodeType)return d.appendChild(l.createTextNode(o.substringData(a,s-a))),t&&(o.deleteData(a,s-a),e.collapse(!0)),d;for(var c,u,p=d,h=domUtils.findParents(o,!0),f=domUtils.findParents(r,!0),m=0;h[m]==f[m];)m++;for(var g,b=m;g=h[b];b++){for(c=g.nextSibling,g==o?n||(3==e.startContainer.nodeType?(p.appendChild(l.createTextNode(o.nodeValue.slice(a))),t&&o.deleteData(a,o.nodeValue.length-a)):p.appendChild(t?o:o.cloneNode(!0))):(u=g.cloneNode(!1),p.appendChild(u));c&&c!==r&&c!==f[b];)g=c.nextSibling,p.appendChild(t?c:c.cloneNode(!0)),c=g;p=u}p=d,h[m]||(p.appendChild(h[m-1].cloneNode(!1)),p=p.firstChild);for(var v,b=m;v=f[b];b++){if(c=v.previousSibling,v==r?i||3!=e.endContainer.nodeType||(p.appendChild(l.createTextNode(r.substringData(0,s))),t&&r.deleteData(0,s)):(u=v.cloneNode(!1),p.appendChild(u)),b!=m||!h[m])for(;c&&c!==o;)v=c.previousSibling,p.insertBefore(t?c:c.cloneNode(!0),p.firstChild),c=v;p=u}return t&&e.setStartBefore(f[m]?h[m]?f[m]:h[m-1]:f[m-1]).collapse(!0),n&&domUtils.remove(n),i&&domUtils.remove(i),d}function o(e,t){try{if(a&&domUtils.inDoc(a,e))if(a.nodeValue.replace(fillCharReg,"").length)a.nodeValue=a.nodeValue.replace(fillCharReg,"");else{var n=a.parentNode;for(domUtils.remove(a);n&&domUtils.isEmptyInlineElement(n)&&(browser.safari?!(domUtils.getPosition(n,t)&domUtils.POSITION_CONTAINS):!n.contains(t));)a=n.parentNode,domUtils.remove(n),n=a}}catch(i){}}function r(e,t){var n;for(e=e[t];e&&domUtils.isFillChar(e);)n=e[t],domUtils.remove(e),e=n}var a,s=0,l=domUtils.fillChar,d=dom.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=e,t.collapsed=!0};d.prototype={cloneContents:function(){return this.collapsed?null:i(this,0)},deleteContents:function(){var e;return this.collapsed||i(this,1),browser.webkit&&(e=this.startContainer,3!=e.nodeType||e.nodeValue.length||(this.setStartBefore(e).collapse(!0),domUtils.remove(e))),this},extractContents:function(){return this.collapsed?null:i(this,2)},setStart:function(e,t){return n(!0,e,t,this)},setEnd:function(e,t){return n(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new d(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!domUtils.isBookmarkNode(e)&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]}for(var n,i=this,o=i.collapsed;1==i.startContainer.nodeType&&(n=i.startContainer.childNodes[i.startOffset])&&t(n);)i.setStart(n,0);if(o)return i.collapse(!0);if(!e)for(;1==i.endContainer.nodeType&&i.endOffset>0&&(n=i.endContainer.childNodes[i.endOffset-1])&&t(n);)i.setEnd(n,n.childNodes.length);return i},getCommonAncestor:function(e,n){var i=this,o=i.startContainer,r=i.endContainer;return o===r?e&&t(this)&&(o=o.childNodes[i.startOffset],1==o.nodeType)?o:n&&3==o.nodeType?o.parentNode:o:domUtils.getCommonAncestor(o,r)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,i=this.collapsed,o=this.endContainer;if(3==t.nodeType){if(0==n)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var r=domUtils.split(t,n);t===o?this.setEnd(r,this.endOffset-n):t.parentNode===o&&(this.endOffset+=1),this.setStartBefore(r)}if(i)return this.collapse(!0)}return e||(n=this.endOffset,o=this.endContainer,3==o.nodeType&&(0==n?this.setEndBefore(o):(n<o.nodeValue.length&&domUtils.split(o,n),this.setEndAfter(o)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],i=e[t+"Offset"];3==n.nodeType&&(i?i>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return!e&&this.collapsed||(t(this,"start"),t(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var i=this.startContainer,o=this.startOffset,r=i.childNodes[o];return r?i.insertBefore(e,r):i.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,i=this.document.createElement("span");return i.style.cssText="display:inline-block;line-height:0px;",i.appendChild(this.document.createTextNode("‍")),i.id="_baidu_bookmark_start_"+(t?"":s++),this.collapsed||(n=i.cloneNode(!0),n.id="_baidu_bookmark_end_"+(t?"":s++)),this.insertNode(i),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(i),{start:e?i.id:i,end:n?e?n.id:n:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),domUtils.remove(t),n?(this.setEndBefore(n),domUtils.remove(n)):this.collapse(!0),this},enlarge:function(e,t){var n,i,o=domUtils.isBody,r=this.document.createTextNode("");if(e){for(i=this.startContainer,1==i.nodeType?i.childNodes[this.startOffset]?n=i=i.childNodes[this.startOffset]:(i.appendChild(r),n=i=r):n=i;;){if(domUtils.isBlockElm(i)){for(i=n;(n=i.previousSibling)&&!domUtils.isBlockElm(n);)i=n;this.setStartBefore(i);break}n=i,i=i.parentNode}for(i=this.endContainer,1==i.nodeType?((n=i.childNodes[this.endOffset])?i.insertBefore(r,n):i.appendChild(r),n=i=r):n=i;;){if(domUtils.isBlockElm(i)){for(i=n;(n=i.nextSibling)&&!domUtils.isBlockElm(n);)i=n;this.setEndAfter(i);break}n=i,i=i.parentNode}r.parentNode===this.endContainer&&this.endOffset--,domUtils.remove(r)}if(!this.collapsed){for(;!(0!=this.startOffset||t&&t(this.startContainer)||o(this.startContainer));)this.setStartBefore(this.startContainer);for(;!(this.endOffset!=(1==this.endContainer.nodeType?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)||t&&t(this.endContainer)||o(this.endContainer));)this.setEndAfter(this.endContainer)}return this},enlargeToBlockElm:function(e){for(;!domUtils.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!e)for(;!domUtils.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return 1==e.nodeType&&domUtils.isBlockElm(e)}).adjustmentBoundary();for(var i,o,r=this.createBookmark(),a=r.end,s=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!domUtils.isWhitespace(e)},l=domUtils.getNextDomNode(r.start,!1,s),d=this.cloneRange();l&&domUtils.getPosition(l,a)&domUtils.POSITION_PRECEDING;)if(/qyer_block/gi.test(l.className))l=domUtils.getNextDomNode(l,!1,s);else if(3==l.nodeType||dtd[e][l.tagName]){for(d.setStartBefore(l),i=l;i&&(3==i.nodeType||dtd[e][i.tagName])&&i!==a;)o=i,i=domUtils.getNextDomNode(i,1==i.nodeType,null,function(t){return dtd[e][t.tagName]});var c,u=d.setEndAfter(o).extractContents();if(n&&n.length>0){var p,h;h=p=n[0].cloneNode(!1);for(var f,m=1;f=n[m++];)p.appendChild(f.cloneNode(!1)),p=p.firstChild;c=p}else c=d.document.createElement(e);t&&domUtils.setAttributes(c,t),c.appendChild(u),"SPAN"==c.tagName&&t&&t.style&&utils.each(c.getElementsByTagName("span"),function(e){e.style.cssText=e.style.cssText+";"+t.style}),d.insertNode(n?h:c);var g;if("span"==e&&t.style&&/text\-decoration/.test(t.style)&&(g=domUtils.findParentByTagName(c,"a",!0))?(domUtils.setAttributes(g,t),domUtils.remove(c,!0),c=g):(domUtils.mergeSibling(c),domUtils.clearEmptySibling(c)),domUtils.mergeChild(c,t),l=domUtils.getNextDomNode(c,!1,s),domUtils.mergeToParent(c),i===a)break}else l=domUtils.getNextDomNode(l,!0,s);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=utils.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();for(var t=this.startContainer,n=this.endContainer;;){if(1==t.nodeType){if(utils.indexOf(e,t.tagName.toLowerCase())>-1)break;if("body"==t.tagName.toLowerCase()){t=null;break}}t=t.parentNode}for(;;){if(1==n.nodeType){if(utils.indexOf(e,n.tagName.toLowerCase())>-1)break;if("body"==n.tagName.toLowerCase()){n=null;break}}n=n.parentNode}var i,o,r=this.createBookmark();t&&(o=this.cloneRange().setEndBefore(r.start).setStartBefore(t),i=o.extractContents(),o.insertNode(i),domUtils.clearEmptySibling(t,!0),t.parentNode.insertBefore(r.start,t)),n&&(o=this.cloneRange().setStartAfter(r.end).setEndAfter(n),i=o.extractContents(),o.insertNode(i),domUtils.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(r.end,n.nextSibling));for(var a,s=domUtils.getNextDomNode(r.start,!1,function(e){return 1==e.nodeType});s&&s!==r.end;)a=domUtils.getNextDomNode(s,!0,function(e){var t=domUtils.findParent(e,function(e){if(/qyer_block/gi.test(e.className))return e},!0);if(!t)return 1==e.nodeType}),utils.indexOf(e,s.tagName.toLowerCase())>-1&&domUtils.remove(s,!0),s=a;return this.moveToBookmark(r)},getClosedNode:function(){var e;if(!this.collapsed){var n=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(t(n)){var i=n.startContainer.childNodes[n.startOffset];i&&1==i.nodeType&&(dtd.$empty[i.tagName]||dtd.$nonChild[i.tagName])&&(e=i)}}return e},select:browser.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var i=this.getClosedNode();if(i&&!t){try{n=this.document.body.createControlRange(),n.addElement(i),n.select()}catch(s){}return this}var d,c=this.createBookmark(),u=c.start;if(n=this.document.body.createTextRange(),n.moveToElementText(u),n.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var p=this.document.createTextNode(l),h=this.document.createElement("span");h.appendChild(this.document.createTextNode(l)),u.parentNode.insertBefore(h,u),u.parentNode.insertBefore(p,u),o(this.document,p),a=p,r(h,"previousSibling"),r(u,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}}else{var f=this.document.body.createTextRange();d=c.end,f.moveToElementText(d),n.setEndPoint("EndToEnd",f)}this.moveToBookmark(c),h&&domUtils.remove(h);try{n.select()}catch(s){}return this}:function(e){function t(e){function t(t,n,i){3==t.nodeType&&t.nodeValue.length<n&&(e[i+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}var n,i=domUtils.getWindow(this.document),s=i.getSelection();if(browser.gecko?this.document.body.focus():i.focus(),s){if(s.removeAllRanges(),this.collapsed&&!e){var d=this.startContainer,c=d;1==d.nodeType&&(c=d.childNodes[this.startOffset]),3==d.nodeType&&this.startOffset||(c?c.previousSibling&&3==c.previousSibling.nodeType:d.lastChild&&3==d.lastChild.nodeType)||(n=this.document.createTextNode(l),this.insertNode(n),o(this.document,n),r(n,"previousSibling"),r(n,"nextSibling"),a=n,this.setStart(n,browser.webkit?1:0).collapse(!0))}var u=this.document.createRange();if(this.collapsed&&browser.opera&&1==this.startContainer.nodeType){var c=this.startContainer.childNodes[this.startOffset];if(c){for(;c&&domUtils.isBlockElm(c)&&1==c.nodeType&&c.childNodes[0];)c=c.childNodes[0];c&&this.setStartBefore(c).collapse(!0)}else c=this.startContainer.lastChild,c&&domUtils.isBr(c)&&this.setStartBefore(c).collapse(!0)}t(this),u.setStart(this.startContainer,this.startOffset),u.setEnd(this.endContainer,this.endOffset),s.addRange(u)}return this},scrollToView:function(e,t){e=e?window:domUtils.getWindow(this.document);var n=this,i=n.document.createElement("span");return i.innerHTML="&nbsp;",n.cloneRange().insertNode(i),domUtils.scrollToView(i,e,t),domUtils.remove(i),n},inFillChar:function(){var e=this.startContainer;return!(!this.collapsed||3!=e.nodeType||e.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1!=e.nodeValue.length)},createAddress:function(e,t){function n(e){for(var n,i=e?o.startContainer:o.endContainer,r=domUtils.findParents(i,!0,function(e){return!domUtils.isBody(e)}),a=[],s=0;n=r[s++];)a.push(domUtils.getNodeIndex(n,t));var l=0;if(t)if(3==i.nodeType){for(var d=i.previousSibling;d&&3==d.nodeType;)l+=d.nodeValue.replace(fillCharReg,"").length,d=d.previousSibling;l+=e?o.startOffset:o.endOffset}else if(i=i.childNodes[e?o.startOffset:o.endOffset])l=domUtils.getNodeIndex(i,t);else{i=e?o.startContainer:o.endContainer;for(var c=i.firstChild;c;)if(domUtils.isFillChar(c))c=c.nextSibling;else if(l++,3==c.nodeType)for(;c&&3==c.nodeType;)c=c.nextSibling;else c=c.nextSibling}else l=e?domUtils.isFillChar(i)?0:o.startOffset:o.endOffset;return l<0&&(l=0),a.push(l),a}var i={},o=this;return i.startAddress=n(!0),e||(i.endAddress=o.collapsed?[].concat(i.startAddress):n()),i},moveToAddress:function(e,t){function n(e,t){for(var n,o,r,a=i.document.body,s=0,l=e.length;s<l;s++)if(r=e[s],n=a,a=a.childNodes[r],!a){o=r;break}t?a?i.setStartBefore(a):i.setStart(n,o):a?i.setEndBefore(a):i.setEnd(n,o)}var i=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),i},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),i=n.end,o=domUtils.getNextDomNode(n.start,!1,t);o&&o!==i&&domUtils.getPosition(o,i)&domUtils.POSITION_PRECEDING;){var r=domUtils.getNextDomNode(o,!1,t);e(o),o=r}return this.moveToBookmark(n)}}}(),function(){function e(e,t){var n=domUtils.getNodeIndex;e=e.duplicate(),e.collapse(t);var i=e.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var o,r,a=i.children,s=e.duplicate(),l=0,d=a.length-1,c=-1;l<=d;){c=Math.floor((l+d)/2),o=a[c],s.moveToElementText(o);var u=s.compareEndPoints("StartToStart",e);if(u>0)d=c-1;else{if(!(u<0))return{container:i,offset:n(o)};l=c+1}}if(c==-1){if(s.moveToElementText(i),s.setEndPoint("StartToStart",e),r=s.text.replace(/(\r\n|\r)/g,"\n").length,a=i.childNodes,!r)return o=a[a.length-1],{container:o,offset:o.nodeValue.length};for(var p=a.length;r>0;)r-=a[--p].nodeValue.length;return{container:a[p],offset:-r}}if(s.collapse(u>0),s.setEndPoint(u>0?"StartToStart":"EndToStart",e),r=s.text.replace(/(\r\n|\r)/g,"\n").length,!r)return dtd.$empty[o.tagName]||dtd.$nonChild[o.tagName]?{container:i,offset:n(o)+(u>0?0:1)}:{container:o,offset:u>0?0:o.childNodes.length};for(;r>0;)try{var h=o;o=o[u>0?"previousSibling":"nextSibling"],r-=o.nodeValue.length}catch(f){return{container:i,offset:n(h)}}return{container:o,offset:u>0?-r:o.nodeValue.length+r}}function t(t,n){if(t.item)n.selectNode(t.item(0));else{var i=e(t,!0);n.setStart(i.container,i.offset),0!=t.compareEndPoints("StartToEnd",t)&&(i=e(t,!1),n.setEnd(i.container,i.offset))}return n}function n(e){var t;try{t=e.getNative().createRange()}catch(n){return null}var i=t.item?t.item(0):t.parentElement();return(i.ownerDocument||i)===e.document?t:null}var i=dom.Selection=function(e){var t,i=this;i.document=e,browser.ie9below&&(t=domUtils.getWindow(e).frameElement,domUtils.on(t,"beforedeactivate",function(){i._bakIERange=i.getIERange()}),domUtils.on(t,"activate",function(){try{!n(i)&&i._bakIERange&&i._bakIERange.select()}catch(e){}i._bakIERange=null})),t=e=null};i.prototype={rangeInBody:function(e,t){var n=browser.ie9below||t?e.item?e.item():e.parentElement():e.startContainer;return n===this.document.body||domUtils.inDoc(n,this.document)},getNative:function(){var e=this.document;try{return e?browser.ie9below?e.selection:domUtils.getWindow(e).getSelection():null}catch(t){return null}},getIERange:function(){var e=n(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?domUtils.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(browser.ie9below){var e=n(this);return!(!e||!this.rangeInBody(e))}return!!this.getNative().rangeCount}catch(t){return!1}},getRange:function(){function e(e){for(var t=n.document.body.firstChild,i=e.collapsed;t&&t.firstChild;)e.setStart(t,0),t=t.firstChild;e.startContainer||e.setStart(n.document.body,0),i&&e.collapse(!0)}var n=this;if(null!=n._cachedRange)return this._cachedRange;var i=new baidu.editor.dom.Range(n.document);if(browser.ie9below){var o=n.getIERange();if(o)try{t(o,i)}catch(r){e(i)}else e(i)}else{var a=n.getNative();if(a&&a.rangeCount){var s=a.getRangeAt(0),l=a.getRangeAt(a.rangeCount-1);i.setStart(s.startContainer,s.startOffset).setEnd(l.endContainer,l.endOffset),i.collapsed&&domUtils.isBody(i.startContainer)&&!i.startOffset&&e(i)}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;e(i)}}return this._bakRange=i},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e,t,n,i,o=browser.ie9below?this.getIERange():this.getRange();if(browser.ie9below){if(!o)return this.document.body.firstChild;if(o.item)return o.item(0);for(e=o.duplicate(),e.text.length>0&&e.moveStart("character",1),e.collapse(1),t=e.parentElement(),i=n=o.parentElement();n=n.parentNode;)if(n==t){t=i;break}}else if(o.shrinkBoundary(),t=o.startContainer,1==t.nodeType&&t.hasChildNodes()&&(t=t.childNodes[Math.min(t.childNodes.length-1,o.startOffset)]),3==t.nodeType)return t.parentNode;return t},getText:function(){var e,t;return this.isFocus()&&(e=this.getNative())?(t=browser.ie9below?e.createRange():e.getRangeAt(0),browser.ie9below?t.text:t.toString()):""},clearRange:function(){this.getNative()[browser.ie9below?"empty":"removeAllRanges"]()}}}(),function(){function e(e,t){var n;if(t.textarea)if(utils.isString(t.textarea)){for(var i,o=0,r=domUtils.getElementsByTagName(e,"textarea");i=r[o++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=domUtils.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),!n.getAttribute("name")&&n.setAttribute("name",t.options.textarea),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function t(e){for(var t in e)return t}function n(e){e.langIsReady=!0,e.fireEvent("langReady")}var i,o=0,r=UE.Editor=function(e){var i=this;i.uid=o++,EventBase.call(i),i.commands={},i.options=utils.extend(utils.clone(e||{}),UEDITOR_CONFIG,!0),i.shortcutkeys={},i.inputRules=[],i.outputRules=[],i.setOpt(r.defaultOptions(i)),utils.isEmptyObject(UE.I18N)?utils.loadFile(document,{src:i.options.langPath+i.options.lang+"/"+i.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(i),n(i)}):(i.options.lang=t(UE.I18N),UE.plugin.load(i),n(i)),UE.instants["ueditorInstant"+i.uid]=i};r.prototype={registerCommand:function(e,t){this.commands[e]=t},ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};utils.isString(e)?n[e]=t:n=e,utils.extend(this.options,n,!0)},getOpt:function(e){return this.options[e]},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode,n=e.textarea;n?n.style.display="":(n=document.createElement("textarea"),t.parentNode.insertBefore(n,t)),n.style.width=e.iframe.offsetWidth+"px",n.style.height=e.iframe.offsetHeight+"px",n.value=e.getContent(),n.id=e.key,t.innerHTML="",domUtils.remove(t);var i=e.key;for(var o in e)e.hasOwnProperty(o)&&delete this[o];UE.delEditor(i)},render:function(e){var t=this,n=t.options,i=function(t){return parseInt(domUtils.getComputedStyle(e,t))};if(utils.isString(e)&&(e=document.getElementById(e)),e){n.initialFrameWidth?n.minFrameWidth=n.initialFrameWidth:n.minFrameWidth=n.initialFrameWidth=e.offsetWidth,n.initialFrameHeight?n.minFrameHeight=n.initialFrameHeight:n.initialFrameHeight=n.minFrameHeight=e.offsetHeight,e.style.width=/%$/.test(n.initialFrameWidth)?"100%":n.initialFrameWidth-i("padding-left")-i("padding-right")+"px",e.style.height=/%$/.test(n.initialFrameHeight)?"100%":n.initialFrameHeight-i("padding-top")-i("padding-bottom")+"px",e.style.zIndex=n.zIndex;var o=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:0;font-family:sans-serif;font-size:16px;}p{margin:0;}</style>"+(n.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(n.iframeCssUrl)+"'/>":"")+(n.initialStyle?"<style>"+n.initialStyle+"</style>":"")+"</head><body class='view' ></body><script type='text/javascript' "+(ie?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+t.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);</script>"+(n.iframeJsUrl?"<script type='text/javascript' src='"+utils.unhtml(n.iframeJsUrl)+"'></script>":"")+"</html>";e.appendChild(domUtils.createElement(document,"iframe",{id:"ueditor_"+t.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(n.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+o+'");document.close();}())'})),e.style.overflow="hidden",setTimeout(function(){/%$/.test(n.initialFrameWidth)&&(n.minFrameWidth=n.initialFrameWidth=e.offsetWidth),/%$/.test(n.initialFrameHeight)&&(n.minFrameHeight=n.initialFrameHeight=e.offsetHeight,e.style.height=n.initialFrameHeight+"px")})}},_setup:function(t){var n=this,i=n.options;ie?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):t.body.contentEditable=!0,t.body.spellcheck=!1,n.document=t,n.window=t.defaultView||t.parentWindow,n.iframe=n.window.frameElement,n.body=t.body,n.selection=new dom.Selection(t);var o;browser.gecko&&(o=this.selection.getNative())&&o.removeAllRanges(),this._initEvents();for(var r=this.iframe.parentNode;!domUtils.isBody(r);r=r.parentNode)if("FORM"==r.tagName){n.form=r,n.options.autoSyncData?domUtils.on(n.window,"blur",function(){e(r,n)}):domUtils.on(r,"submit",function(){e(this,n)});break}if(i.initialContent)if(i.autoClearinitialContent){var a=n.execCommand;n.execCommand=function(){return n.fireEvent("firstBeforeExecCommand"),a.apply(n,arguments)},this._setDefaultContent(i.initialContent)}else this.setContent(i.initialContent,!1,!0);domUtils.isEmptyNode(n.body)&&(n.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"),i.focus&&setTimeout(function(){n.focus(n.options.focusInEnd),!n.options.autoClearinitialContent&&n._selectionChange()},0),n.container||(n.container=this.iframe.parentNode),i.fullscreen&&n.ui&&n.ui.setFullScreen(!0);try{n.document.execCommand("2D-position",!1,!1)}catch(s){}try{n.document.execCommand("enableInlineTableEditing",!1,!1)}catch(s){}try{n.document.execCommand("enableObjectResizing",!1,!1)}catch(s){}n._bindshortcutKeys(),n.isReady=1,n.fireEvent("ready"),i.onready&&i.onready.call(n),browser.ie9below||domUtils.on(n.window,["blur","focus"],function(e){if("blur"==e.type){n._bakRange=n.selection.getRange();try{n._bakNativeRange=n.selection.getNative().getRangeAt(0),n.selection.getNative().removeAllRanges()}catch(e){n._bakNativeRange=null}}else try{n._bakRange&&n._bakRange.select()}catch(e){}}),browser.gecko&&browser.version<=10902&&(n.body.contentEditable=!1,setTimeout(function(){n.body.contentEditable=!0},100),setInterval(function(){n.body.style.height=n.iframe.offsetHeight-20+"px"},100)),!i.isShow&&n.setHide(),i.readonly&&n.setDisabled()},sync:function(t){var n=this,i=t?document.getElementById(t):domUtils.findParent(n.iframe.parentNode,function(e){return"FORM"==e.tagName},!0);i&&e(i,n)},setHeight:function(e,t){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px"),!t&&(this.options.minFrameHeight=this.options.initialFrameHeight=e),this.body.style.height=e+"px",!t&&this.trigger("setHeight")},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,utils.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,i){var o=i.keyCode||i.which;for(var r in t)for(var a,s=t[r].split(","),l=0;a=s[l++];){a=a.split(":");var d=a[0],c=a[1];(/^(ctrl)(\+shift)?\+(\d+)$/.test(d.toLowerCase())||/^(\d+)$/.test(d))&&(("ctrl"==RegExp.$1?i.ctrlKey||i.metaKey:0)&&(""!=RegExp.$2?i[RegExp.$2.slice(1)+"Key"]:1)&&o==RegExp.$3||o==RegExp.$1)&&(e.queryCommandState(r,c)!=-1&&e.execCommand(r,c),domUtils.preventDefault(i))}})},getContent:function(e,t,n,i,o){var r=this;if(e&&utils.isFunction(e)&&(t=e,e=""),t?!t():!this.hasContents())return"";r.fireEvent("beforegetcontent");var a=UE.htmlparser(r.body.innerHTML,i);return r.filterOutputRule(a),r.fireEvent("aftergetcontent",e,a),a.toHtml(o)},getAllHtml:function(){var e=this,t=[];if(e.fireEvent("getAllHtml",t),browser.ie&&browser.version>8){var n="";utils.each(e.document.styleSheets,function(e){n+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),utils.each(e.document.getElementsByTagName("script"),function(e){n+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(n||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head><body "+(ie&&browser.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(domUtils.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>\/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return dtd.$block[n]?"\n":t?t:""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(t,n,i){function o(e){return"DIV"==e.tagName&&e.getAttribute("cdata_tag")}var r=this;r.fireEvent("beforesetcontent",t);var a=UE.htmlparser(t);if(r.filterInputRule(a),t=a.toHtml(),r.body.innerHTML=(n?r.body.innerHTML:"")+t,"p"==r.options.enterTag){var s,l=this.body.firstChild;if(!l||1==l.nodeType&&(dtd.$cdata[l.tagName]||o(l)||domUtils.isCustomeNode(l))&&l===this.body.lastChild)this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var d=r.document.createElement("p");l;){for(;l&&(3==l.nodeType||1==l.nodeType&&dtd.p[l.tagName]&&!dtd.$cdata[l.tagName]);)s=l.nextSibling,d.appendChild(l),l=s;if(d.firstChild){if(!l){r.body.appendChild(d);break}l.parentNode.insertBefore(d,l),d=r.document.createElement("p")}l=l.nextSibling}}r.fireEvent("aftersetcontent"),r.fireEvent("contentchange"),!i&&r._selectionChange(),r._bakRange=r._bakIERange=r._bakNativeRange=null;var c;browser.gecko&&(c=this.selection.getNative())&&c.removeAllRanges(),r.options.autoSyncData&&r.form&&e(r.form,r)},focus:function(e){try{var t=this,n=t.selection.getRange();if(e){var i=t.body.lastChild;i&&1==i.nodeType&&!dtd.$empty[i.tagName]&&(domUtils.isEmptyBlock(i)?n.setStartAtFirst(i):n.setStartAtLast(i),n.collapse(!0)),n.setCursor(!0)}else{if(!n.collapsed&&domUtils.isBody(n.startContainer)&&0==n.startOffset){var i=t.body.firstChild;i&&1==i.nodeType&&!dtd.$empty[i.tagName]&&n.setStartAtFirst(i).collapse(!0)}n.select(!0)}this.fireEvent("focus selectionchange")}catch(o){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var e=this.selection.getNative();if(e.empty&&browser.ie){var t=document.body.createTextRange();t.moveToElementText(document.body),t.collapse(!0),t.select(),e.empty()}else e.removeAllRanges()},_initEvents:function(){var e=this,t=e.document,n=e.window;e._proxyDomEvent=utils.bind(e._proxyDomEvent,e),domUtils.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent),domUtils.on(n,["focus","blur"],e._proxyDomEvent),domUtils.on(e.body,"drop",function(t){browser.gecko&&t.stopPropagation&&t.stopPropagation(),e.fireEvent("contentchange")}),domUtils.on(t,["mouseup","keydown"],function(t){"keydown"==t.type&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)||2!=t.button&&e._selectionChange(250,t)})},_proxyDomEvent:function(e){return this.fireEvent("before"+e.type.replace(/^on/,"").toLowerCase())!==!1&&this.fireEvent(e.type.replace(/^on/,""),e)!==!1&&this.fireEvent("after"+e.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(e,t){var n,o,r=this,a=!1;if(browser.ie&&browser.version<9&&t&&"mouseup"==t.type){var s=this.selection.getRange();s.collapsed||(a=!0,n=t.clientX,o=t.clientY)}clearTimeout(i),i=setTimeout(function(){if(r.selection&&r.selection.getNative()){var e;if(a&&"None"==r.selection.getNative().type){e=r.document.body.createTextRange();try{e.moveToPoint(n,o)}catch(i){e=null}}var s;e&&(s=r.selection.getIERange,r.selection.getIERange=function(){return e}),r.selection.cache(),s&&(r.selection.getIERange=s),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!t),r.fireEvent("afterselectionchange"),r.selection.clear())}},e||50)},_callCmdFn:function(e,t){var n,i,o=t[0].toLowerCase();return n=this.commands[o]||UE.commands[o],i=n&&n[e],n&&i||"queryCommandState"!=e?i?i.apply(this,t):void 0:0},execCommand:function(e){e=e.toLowerCase();var t,n=this,i=n.commands[e]||UE.commands[e];return i&&i.execCommand?(i.notNeedUndo||n.__hasEnterExecCommand?(t=this._callCmdFn("execCommand",arguments),!n.__hasEnterExecCommand&&!i.ignoreContentChange&&!n._ignoreContentChange&&n.fireEvent("contentchange")):(n.__hasEnterExecCommand=!0,n.queryCommandState.apply(n,arguments)!=-1&&(n.fireEvent("saveScene"),
n.fireEvent.apply(n,["beforeexeccommand",e].concat(arguments)),t=this._callCmdFn("execCommand",arguments),n.fireEvent.apply(n,["afterexeccommand",e].concat(arguments)),n.fireEvent("saveScene")),n.__hasEnterExecCommand=!1),!n.__hasEnterExecCommand&&!i.ignoreContentChange&&!n._ignoreContentChange&&n._selectionChange(),t):null},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t,n=0;t=e[n++];)if(this.document.getElementsByTagName(t).length>0)return!0;if(!domUtils.isEmptyBlock(this.body))return!0;for(e=["div"],n=0;t=e[n++];)for(var i,o=domUtils.getElementsByTagName(this.document,t),r=0;i=o[r++];)if(domUtils.isCustomeNode(i))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e,t=this;if("false"==t.body.contentEditable){t.body.contentEditable=!0,e=t.selection.getRange();try{e.moveToBookmark(t.lastBk),delete t.lastBk}catch(n){e.setStartAtFirst(t.body).collapse(!0)}e.select(!0),t.bkqueryCommandState&&(t.queryCommandState=t.bkqueryCommandState,delete t.bkqueryCommandState),t.bkqueryCommandValue&&(t.queryCommandValue=t.bkqueryCommandValue,delete t.bkqueryCommandValue),t.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?utils.isArray(e)?e:[e]:[],"true"==t.body.contentEditable&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.bkqueryCommandValue=t.queryCommandValue,t.queryCommandState=function(n){return utils.indexOf(e,n)!=-1?t.bkqueryCommandState.apply(t,arguments):-1},t.queryCommandValue=function(n){return utils.indexOf(e,n)!=-1?t.bkqueryCommandValue.apply(t,arguments):null},t.fireEvent("selectionchange"))},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",e),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var n=this;n.body.innerHTML='<p id="initContent">'+t+"</p>",n.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if("none"==e.container.style.display){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,i=0;(n=e[i++])&&(t=t[n]););return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]),n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var i,o=0;i=t[o++];)n+=this.document.getElementsByTagName(i).length}return n},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t,n=0;t=this.inputRules[n++];)t.call(this,e)},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t,n=0;t=this.outputRules[n++];)t.call(this,e)},getActionUrl:function(e){var t=this.getOpt(e)||e,n=this.getOpt("imageUrl"),i=this.getOpt("serverUrl");return!i&&n&&(i=n.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")),i?(i=i+(i.indexOf("?")==-1?"?":"&")+"action="+(t||""),utils.formatUrl(i)):""}},utils.inherits(r,EventBase)}(),UE.Editor.defaultOptions=function(e){var t=e.options.UEDITOR_HOME_URL;return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:t+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t+"lang/",theme:"default",themePath:t+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}},function(){UE.Editor.prototype.loadServerConfig=function(){function showErrorMsg(e){console&&console.error(e)}var me=this;setTimeout(function(){try{me.options.imageUrl&&me.setOpt("serverUrl",me.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var configUrl=me.getActionUrl("config"),isJsonp=utils.isCrossDomainUrl(configUrl);me._serverConfigLoaded=!1,configUrl&&UE.ajax.request(configUrl,{method:"GET",dataType:isJsonp?"jsonp":"",onsuccess:function(r){try{var config=isJsonp?r:eval("("+r.responseText+")");utils.extend(me.options,config),me.fireEvent("serverConfigLoaded"),me._serverConfigLoaded=!0}catch(e){showErrorMsg(me.getLang("loadconfigFormatError"))}},onerror:function(){showErrorMsg(me.getLang("loadconfigHttpError"))}})}catch(e){showErrorMsg(me.getLang("loadconfigError"))}})},UE.Editor.prototype.isServerConfigLoaded=function(){var e=this;return e._serverConfigLoaded||!1},UE.Editor.prototype.afterConfigReady=function(e){if(e&&utils.isFunction(e)){var t=this,n=function(){e.apply(t,arguments),t.removeListener("serverConfigLoaded",n)};t.isServerConfigLoaded()?e.call(t,"serverConfigLoaded"):t.addListener("serverConfigLoaded",n)}}}(),UE.ajax=function(){function e(e){var t=[];for(var n in e)if("method"!=n&&"timeout"!=n&&"async"!=n&&"dataType"!=n&&"callback"!=n&&void 0!=e[n]&&null!=e[n])if("function"!=(typeof e[n]).toLowerCase()&&"object"!=(typeof e[n]).toLowerCase())t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));else if(utils.isArray(e[n]))for(var i=0;i<e[n].length;i++)t.push(encodeURIComponent(n)+"[]="+encodeURIComponent(e[n][i]));return t.join("&")}function t(t,n){var i=r(),o=!1,a={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};if("object"==typeof t&&(n=t,t=n.url),i&&t){var s=n?utils.extend(a,n):a,l=e(s);utils.isEmptyObject(s.data)||(l+=(l?"&":"")+e(s.data));var d=setTimeout(function(){4!=i.readyState&&(o=!0,i.abort(),clearTimeout(d))},s.timeout),c=s.method.toUpperCase(),u=t+(t.indexOf("?")==-1?"?":"&")+("POST"==c?"":l+"&noCache="+ +new Date);i.open(c,u,s.async),i.onreadystatechange=function(){4==i.readyState&&(o||200!=i.status?s.onerror(i):s.onsuccess(i))},"POST"==c?(i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(l)):i.send(null)}}function n(t,n){function i(e,t,n){e.setAttribute("type","text/javascript"),e.setAttribute("defer","defer"),n&&e.setAttribute("charset",n),e.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(e)}function o(e){return function(){try{if(e)c.onerror&&c.onerror();else try{clearTimeout(a),l.apply(window,arguments)}catch(t){}}catch(n){c.onerror&&c.onerror.call(window,n)}finally{c.oncomplete&&c.oncomplete.apply(window,arguments),d.parentNode&&d.parentNode.removeChild(d),window[r]=null;try{delete window[r]}catch(t){}}}}var r,a,s,l=n.onsuccess||function(){},d=document.createElement("SCRIPT"),c=n||{},u=c.charset,p=c.jsonp||"callback",h=c.timeOut||0,f=new RegExp("(\\?|&)"+p+"=([^&]*)");utils.isFunction(l)?(r="bd__editor__"+Math.floor(2147483648*Math.random()).toString(36),window[r]=o(0)):utils.isString(l)?r=l:(s=f.exec(t))&&(r=s[2]),t=t.replace(f,"$1"+p+"="+r),t.search(f)<0&&(t+=(t.indexOf("?")<0?"?":"&")+p+"="+r);var m=e(n);utils.isEmptyObject(n.data)||(m+=(m?"&":"")+e(n.data)),m&&(t=t.replace(/\?/,"?"+m+"&")),d.onerror=o(1),h&&(a=setTimeout(o(1),h)),i(d,t,u)}var i="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP"),i="ActiveXObject('Msxml2.XMLHTTP')"}catch(o){try{new ActiveXObject("Microsoft.XMLHTTP"),i="ActiveXObject('Microsoft.XMLHTTP')"}catch(o){}}var r=new Function("return new "+i);return{request:function(e,i){i&&"jsonp"==i.dataType?n(e,i):t(e,i)},getJSONP:function(e,t,i){var o={data:t,oncomplete:i};n(e,o)}}}();var filterWord=UE.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/gi.test(e)}function t(e){return e=e.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)})}function n(e){return e.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(browser.opera)return"";try{if(/Bitmap/i.test(e))return"";var n=e.match(/width:([ \d.]*p[tx])/i)[1],i=e.match(/height:([ \d.]*p[tx])/i)[1],o=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(n)+'" height="'+t(i)+'" src="'+o+'" />'}catch(r){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,n,i){return"class"==t&&"MsoListParagraph"==i?e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,n){return n.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,i,o){for(var r,a=[],s=o.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)}).split(/;\s*/g),l=0;r=s[l];l++){var d,c,u=r.split(":");if(2==u.length){if(d=u[0].toLowerCase(),c=u[1].toLowerCase(),/^(background)\w*/.test(d)&&0==c.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(d)&&/^0\w+$/.test(c))continue;switch(d){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(a[l]=d.replace(/^mso-|-alt$/g,"")+":"+t(c));continue;case"horiz-align":a[l]="text-align:"+c;continue;case"vert-align":a[l]="vertical-align:"+c;continue;case"font-color":case"mso-foreground":a[l]="color:"+c;continue;case"mso-background":case"mso-highlight":a[l]="background:"+c;continue;case"mso-default-height":a[l]="min-height:"+t(c);continue;case"mso-default-width":a[l]="min-width:"+t(c);continue;case"mso-padding-between-alt":a[l]="border-collapse:separate;border-spacing:"+t(c);continue;case"text-line-through":"single"!=c&&"double"!=c||(a[l]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==c&&(a[l]="display:none");continue;case"margin":if(!/[1-9]/.test(c))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d)||/text\-indent|padding|margin/.test(d)&&/\-[\d.]+/.test(c))continue;a[l]=d+":"+u[1]}}return n+(a.length?' style="'+a.join(";").replace(/;{2,}/g,";")+'"':"")})}return function(t){return e(t)?n(t):t}}();!function(){function e(e,t,n){return e.push(h),t+(n?1:-1)}function t(e,t){for(var n=0;n<t;n++)e.push(p)}function n(a,s,l,d){switch(a.type){case"root":for(var c,u=0;c=a.children[u++];)l&&"element"==c.type&&!dtd.$inlineWithA[c.tagName]&&u>1&&(e(s,d,!0),t(s,d)),n(c,s,l,d);break;case"text":i(a,s);break;case"element":o(a,s,l,d);break;case"comment":r(a,s,l)}return s}function i(e,t){"pre"==e.parentNode.tagName?t.push(e.data):t.push(u[e.parentNode.tagName]?utils.html(e.data):e.data.replace(/[ ]{2}/g," &nbsp;"))}function o(i,o,r,a){var s="";if(i.attrs){s=[];var l=i.attrs;for(var d in l)s.push(d+(void 0!==l[d]?'="'+(c[d]?utils.html(l[d]).replace(/["]/g,function(e){return"&quot;"}):utils.unhtml(l[d]))+'"':""));s=s.join(" ")}if(o.push("<"+i.tagName+(s?" "+s:"")+(dtd.$empty[i.tagName]?"/":"")+">"),r&&!dtd.$inlineWithA[i.tagName]&&"pre"!=i.tagName&&i.children&&i.children.length&&(a=e(o,a,!0),t(o,a)),i.children&&i.children.length)for(var u,p=0;u=i.children[p++];)r&&"element"==u.type&&!dtd.$inlineWithA[u.tagName]&&p>1&&(e(o,a),t(o,a)),n(u,o,r,a);dtd.$empty[i.tagName]||(r&&!dtd.$inlineWithA[i.tagName]&&"pre"!=i.tagName&&i.children&&i.children.length&&(a=e(o,a),t(o,a)),o.push("</"+i.tagName+">"))}function r(e,t){t.push("<!--"+e.data+"-->")}function a(e,t){var n;if("element"==e.type&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(var i,o=0;i=e.children[o++];)if(n=a(i,t))return n}function s(e,t,n){if("element"==e.type&&e.tagName==t&&n.push(e),e.children&&e.children.length)for(var i,o=0;i=e.children[o++];)s(i,t,n)}function l(e,t){if(e.children&&e.children.length)for(var n,i=0;n=e.children[i];)l(n,t),n.parentNode&&(n.children&&n.children.length&&t(n),n.parentNode&&i++);else t(e)}var d=UE.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},c={href:1,src:1,_src:1,_href:1,cdata_data:1},u={style:1,script:1},p="    ",h="\n";d.createElement=function(e){return/[<>]/.test(e)?UE.htmlparser(e).children[0]:new d({type:"element",children:[],tagName:e})},d.createText=function(e,t){return new UE.uNode({type:"text",data:t?e:utils.unhtml(e||"")})},d.prototype={toHtml:function(e){var t=[];return n(this,t,e,0),t.join("")},innerHTML:function(e){if("element"!=this.type||dtd.$empty[this.tagName])return this;if(utils.isString(e)){if(this.children)for(var t,n=0;t=this.children[n++];)t.parentNode=null;this.children=[];for(var t,i=UE.htmlparser(e),n=0;t=i.children[n++];)this.children.push(t),t.parentNode=this;return this}var i=new UE.uNode({type:"root",children:this.children});return i.toHtml()},innerText:function(e,t){if("element"!=this.type||dtd.$empty[this.tagName])return this;if(e){if(this.children)for(var n,i=0;n=this.children[i++];)n.parentNode=null;return this.children=[],this.appendChild(d.createText(e,t)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return 0==n?null:t.children[n-1]},nextSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n++];)if(e===this)return t.children[n]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if("root"==this.type||"element"==this.type&&!dtd.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var t,n=0;t=this.children[n];n++)if(t===e){this.children.splice(n,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n,i=0;n=this.children[i];i++)if(n===e){if(this.children.splice(i,1),n.parentNode=null,t&&n.children&&n.children.length)for(var o,r=0;o=n.children[r];r++)this.children.splice(i+r,0,o),o.parentNode=this;return n}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(!e)return void delete this.attrs;if(this.attrs||(this.attrs={}),utils.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e]},getIndex:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return n;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n,i=0;n=this.children[i++];)if(t=a(n,e))return t},getNodesByTagName:function(e){e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],n=this;return utils.each(e,function(e){if(n.children&&n.children.length)for(var i,o=0;i=n.children[o++];)s(i,e,t)}),t},getStyle:function(e){var t=this.getAttr("style");if(!t)return"";var n=new RegExp("(^|;)\\s*"+e+":([^;]+)","i"),i=t.match(n);return i&&i[0]?i[2]:""},setStyle:function(e,t){function n(e,t){var n=new RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi");i=i.replace(n,"$1"),t&&(i=e+":"+utils.unhtml(t)+";"+i)}var i=this.getAttr("style");if(i||(i=""),utils.isObject(e))for(var o in e)n(o,e[o]);else n(e,t);this.setAttr("style",utils.trim(i))},traversal:function(e){return this.children&&this.children.length&&l(this,e),this}}}();var htmlparser=UE.htmlparser=function(e,t){function n(e,t){if(p[e.tagName]){var n=c.createElement(p[e.tagName]);e.appendChild(n),n.appendChild(c.createText(t)),e=n}else e.appendChild(c.createText(t))}function i(e,t,n){var o;if(o=u[t]){for(var r,s=e;"root"!=s.type;){if(utils.isArray(o)?utils.indexOf(o,s.tagName)!=-1:o==s.tagName){e=s,r=!0;break}s=s.parentNode}r||(e=i(e,utils.isArray(o)?o[0]:o))}var l=new c({parentNode:e,type:"element",tagName:t.toLowerCase(),children:dtd.$empty[t]?null:[]});if(n){for(var p,h={};p=a.exec(n);)h[p[1].toLowerCase()]=d[p[1].toLowerCase()]?p[2]||p[3]||p[4]:utils.unhtml(p[2]||p[3]||p[4]);l.attrs=h}return e.children.push(l),dtd.$empty[t]?e:l}function o(e,t){e.children.push(new c({type:"comment",data:t,parentNode:e}))}var r=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,a=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,s={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(domUtils.fillChar,"g"),""),t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,n){return n&&s[n.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));for(var l,d={href:1,src:1},c=UE.uNode,u={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},p={ol:"li",ul:"li"},h=0,f=0,m=new c({type:"root",children:[]}),g=m;l=r.exec(e);){h=l.index;try{if(h>f&&n(g,e.slice(f,h)),l[3])dtd.$cdata[g.tagName]?n(g,l[0]):g=i(g,l[3].toLowerCase(),l[4]);else if(l[1]){if("root"!=g.type)if(dtd.$cdata[g.tagName]&&!dtd.$cdata[l[1]])n(g,l[0]);else{for(var b=g;"element"==g.type&&g.tagName!=l[1].toLowerCase();)if(g=g.parentNode,"root"==g.type)throw g=b,"break";g=g.parentNode}}else l[2]&&o(g,l[2])}catch(v){}f=r.lastIndex}return f<e.length&&n(g,e.slice(f)),m},filterNode=UE.filterNode=function(){function e(t,n){switch(t.type){case"text":break;case"element":var i;if(i=n[t.tagName])if("-"===i)t.parentNode.removeChild(t);else if(utils.isFunction(i)){var o=t.parentNode,r=t.getIndex();if(i(t),t.parentNode){if(t.children)for(var a,s=0;a=t.children[s];)e(a,n),a.parentNode&&s++}else for(var a,s=r;a=o.children[s];)e(a,n),a.parentNode&&s++}else{var l=i.$;if(l&&t.attrs){var d,c={};for(var u in l){if(d=t.getAttr(u),"style"==u&&utils.isArray(l[u])){var p=[];utils.each(l[u],function(e){var n;(n=t.getStyle(e))&&p.push(e+":"+n)}),d=p.join(";")}d&&(c[u]=d)}t.attrs=c}if(t.children)for(var a,s=0;a=t.children[s];)e(a,n),a.parentNode&&s++}else if(dtd.$cdata[t.tagName])t.parentNode.removeChild(t);else{var o=t.parentNode,r=t.getIndex();t.parentNode.removeChild(t,!0);for(var a,s=r;a=o.children[s];)e(a,n),a.parentNode&&s++}break;case"comment":t.parentNode.removeChild(t)}}return function(t,n){if(utils.isEmptyObject(n))return t;var i;(i=n["-"])&&utils.each(i.split(" "),function(e){n[e]="-"});for(var o,r=0;o=t.children[r];)e(o,n),o.parentNode&&r++;return t}}();UE.plugin=function(){var e={};return{register:function(t,n,i,o){i&&utils.isFunction(i)&&(o=i,i=null),e[t]={optionName:i||t,execFn:n,afterDisabled:o}},load:function(t){utils.each(e,function(e){var n=e.execFn.call(t);t.options[e.optionName]!==!1?n&&utils.each(n,function(e,n){switch(n.toLowerCase()){case"shortcutkey":t.addshortcutkey(e);break;case"bindevents":utils.each(e,function(e,n){t.addListener(n,e)});break;case"bindmultievents":utils.each(utils.isArray(e)?e:[e],function(e){var n=utils.trim(e.type).split(/\s+/);utils.each(n,function(n){t.addListener(n,e.handler)})});break;case"commands":utils.each(e,function(e,n){t.commands[n]=e});break;case"outputrule":t.addOutputRule(e);break;case"inputrule":t.addInputRule(e);break;case"defaultoptions":t.setOpt(e)}}):e.afterDisabled&&e.afterDisabled.call(t)}),utils.each(UE.plugins,function(e){e.call(t)})},run:function(t,n){var i=e[t];i&&i.exeFn.call(n)}}}();var keymap=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78},LocalStorage=UE.LocalStorage=function(){function e(){var e=document.createElement("div");return e.style.display="none",e.addBehavior?(e.addBehavior("#default#userdata"),{getItem:function(t){var i=null;try{document.body.appendChild(e),e.load(n),i=e.getAttribute(t),document.body.removeChild(e)}catch(o){}return i},setItem:function(t,i){document.body.appendChild(e),e.setAttribute(t,i),e.save(n),document.body.removeChild(e)},removeItem:function(t){document.body.appendChild(e),e.removeAttribute(t),e.save(n),document.body.removeChild(e)}}):null}var t=window.localStorage||e()||null,n="localStorage";return{saveLocalData:function(e,n){return!(!t||!n||(t.setItem(e,n),0))},getLocalData:function(e){return t?t.getItem(e):null},removeItem:function(e){t&&t.removeItem(e)}}}();!function(){var e="ueditor_preference";UE.Editor.prototype.setPreferences=function(t,n){var i={};utils.isString(t)?i[t]=n:i=t;var o=LocalStorage.getLocalData(e);o&&(o=utils.str2json(o))?utils.extend(o,i):o=i,o&&LocalStorage.saveLocalData(e,utils.json2str(o))},UE.Editor.prototype.getPreferences=function(t){var n=LocalStorage.getLocalData(e);return n&&(n=utils.str2json(n))?t?n[t]:n:null},UE.Editor.prototype.removePreferences=function(t){var n=LocalStorage.getLocalData(e);n&&(n=utils.str2json(n))&&(n[t]=void 0,delete n[t]),n&&LocalStorage.saveLocalData(e,utils.json2str(n))}}(),UE.plugin.register("autolink",function(){var e=0;return browser.ie?{}:{bindEvents:{reset:function(){e=0},keydown:function(e,t){var n=this,i=t.keyCode||t.which;if(32==i||13==i){for(var o,r,a=n.selection.getNative(),s=a.getRangeAt(0).cloneRange(),l=s.startContainer;1==l.nodeType&&s.startOffset>0&&(l=s.startContainer.childNodes[s.startOffset-1]);)s.setStart(l,1==l.nodeType?l.childNodes.length:l.nodeValue.length),s.collapse(!0),l=s.startContainer;do{if(0==s.startOffset){for(l=s.startContainer.previousSibling;l&&1==l.nodeType;)l=l.lastChild;if(!l||domUtils.isFillChar(l))break;o=l.nodeValue.length}else l=s.startContainer,o=s.startOffset;s.setStart(l,o-1),r=s.toString().charCodeAt(0)}while(160!=r&&32!=r);if(s.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;s.toString().length&&!/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(s.toString());)try{s.setStart(s.startContainer,s.startOffset+1)}catch(d){for(var l=s.startContainer;!(next=l.nextSibling);){if(domUtils.isBody(l))return;l=l.parentNode}s.setStart(next,0)}if(domUtils.findParentByTagName(s.startContainer,"a",!0))return;var c,u=n.document.createElement("a"),p=n.document.createTextNode(" ");n.undoManger&&n.undoManger.save(),u.appendChild(s.extractContents()),u.href=u.innerHTML=u.innerHTML.replace(/<[^>]+>/g,""),c=u.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),""),c=/^(?:https?:\/\/)/gi.test(c)?c:"http://"+c,u.setAttribute("_src",utils.html(c)),u.href=utils.html(c),s.insertNode(u),u.parentNode.insertBefore(p,u.nextSibling),s.setStart(p,0),s.collapse(!0),a.removeAllRanges(),a.addRange(s),n.undoManger&&n.undoManger.save()}}}}}},function(){function e(e){if(3==e.nodeType)return null;if("A"==e.nodeName)return e;for(var t=e.lastChild;t;){if("A"==t.nodeName)return t;if(3==t.nodeType){if(domUtils.isWhitespace(t)){t=t.previousSibling;continue}return null}t=t.lastChild}}var t={37:1,38:1,39:1,40:1,13:1,32:1};browser.ie&&this.addListener("keyup",function(n,i){var o=this,r=i.keyCode;if(t[r]){var a=o.selection.getRange(),s=a.startContainer;if(13==r){for(;s&&!domUtils.isBody(s)&&!domUtils.isBlockElm(s);)s=s.parentNode;if(s&&!domUtils.isBody(s)&&"P"==s.nodeName){var l=s.previousSibling;if(l&&1==l.nodeType){var l=e(l);l&&!l.getAttribute("_href")&&domUtils.remove(l,!0)}}}else if(32==r)3==s.nodeType&&/^\s$/.test(s.nodeValue)&&(s=s.previousSibling,s&&"A"==s.nodeName&&!s.getAttribute("_href")&&domUtils.remove(s,!0));else if(s=domUtils.findParentByTagName(s,"a",!0),s&&!s.getAttribute("_href")){var d=a.createBookmark();domUtils.remove(s,!0),a.moveToBookmark(d).select(!0)}}})}),UE.plugins.defaultfilter=function(){var e=this;e.setOpt({allowDivTransToP:!0,disabledTableInTable:!0,rgb2Hex:!0}),e.addInputRule(function(t){function n(e){for(;e&&"element"==e.type;){if("td"==e.tagName)return!0;e=e.parentNode}return!1}var i,o=this.options.allowDivTransToP;t.traversal(function(t){if("element"==t.type){if(!dtd.$cdata[t.tagName]&&e.options.autoClearEmptyNode&&dtd.$inline[t.tagName]&&!dtd.$empty[t.tagName]&&(!t.attrs||utils.isEmptyObject(t.attrs)))return void(t.firstChild()?"span"!=t.tagName||t.attrs&&!utils.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t));switch(t.tagName){case"style":case"script":t.setAttr({cdata_tag:t.tagName,cdata_data:t.innerHTML()||"",_ue_custom_node_:"true"}),t.tagName="div",t.innerHTML("");break;case"a":(i=t.getAttr("href"))&&t.setAttr("_href",i);break;case"img":if((i=t.getAttr("src"))&&/^data:/.test(i)){t.parentNode.removeChild(t);break}t.setAttr("_src",t.getAttr("src"));break;case"span":browser.webkit&&(i=t.getStyle("white-space"))&&/nowrap|normal/.test(i)&&(t.setStyle("white-space",""),e.options.autoClearEmptyNode&&utils.isEmptyObject(t.attrs)&&t.parentNode.removeChild(t,!0)),i=t.getAttr("id"),i&&/^_baidu_bookmark_/i.test(i)&&t.parentNode.removeChild(t);break;case"p":(i=t.getAttr("align"))&&(t.setAttr("align"),t.setStyle("text-align",i)),utils.each(t.children,function(e){if("element"==e.type&&"p"==e.tagName){var n=e.nextSibling();t.parentNode.insertAfter(e,t);for(var i=e;n;){var o=n.nextSibling();t.parentNode.insertAfter(n,i),i=n,n=o}return!1}}),t.firstChild()||t.innerHTML(browser.ie?"&nbsp;":"<br/>");break;case"div":if(t.getAttr("cdata_tag"))break;if(i=t.getAttr("class"),i&&/^line number\d+/.test(i))break;if(!o)break;for(var r,a=UE.uNode.createElement("p");r=t.firstChild();)"text"!=r.type&&UE.dom.dtd.$block[r.tagName]?a.firstChild()?(t.parentNode.insertBefore(a,t),a=UE.uNode.createElement("p")):t.parentNode.insertBefore(r,t):a.appendChild(r);a.firstChild()&&t.parentNode.insertBefore(a,t),t.parentNode.removeChild(t);break;case"dl":t.tagName="ul";break;case"dt":case"dd":t.tagName="li";break;case"li":var s=t.getAttr("class");s&&/list\-/.test(s)||t.setAttr();var l=t.getNodesByTagName("ol ul");UE.utils.each(l,function(e){t.parentNode.insertAfter(e,t)});break;case"td":case"th":case"caption":t.children&&t.children.length||t.appendChild(browser.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case"table":e.options.disabledTableInTable&&n(t)&&(t.parentNode.insertBefore(UE.uNode.createText(t.innerText()),t),t.parentNode.removeChild(t))}}})}),e.addOutputRule(function(t){var n;t.traversal(function(t){if("element"==t.type){if(e.options.autoClearEmptyNode&&dtd.$inline[t.tagName]&&!dtd.$empty[t.tagName]&&(!t.attrs||utils.isEmptyObject(t.attrs)))return void(t.firstChild()?"span"!=t.tagName||t.attrs&&!utils.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t));switch(t.tagName){case"div":(n=t.getAttr("cdata_tag"))&&(t.tagName=n,t.appendChild(UE.uNode.createText(t.getAttr("cdata_data"))),t.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""}));break;case"a":(n=t.getAttr("_href"))&&t.setAttr({href:utils.html(n),_href:""});break;case"span":if(n=t.getAttr("id"),n&&/^_baidu_bookmark_/i.test(n)&&t.parentNode.removeChild(t),e.getOpt("rgb2Hex")){var i=t.getAttr("style");i&&t.setAttr("style",i.replace(/rgba?\(([\d,\s]+)\)/g,function(e,t){var n=t.split(",");if(n.length>3)return"";t="#";for(var i,o=0;i=n[o++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=1==i.length?"0"+i:i;return t.toUpperCase()}))}break;case"img":(n=t.getAttr("_src"))&&t.setAttr({src:t.getAttr("_src"),_src:""})}}})})},UE.commands.inserthtml={execCommand:function(e,t,n){var i,o,r=this;if(t&&r.fireEvent("beforeinserthtml",t)!==!0){if(i=r.selection.getRange(),o=i.document.createElement("div"),o.style.display="inline",!n){var a=UE.htmlparser(t);r.options.filterRules&&UE.filterNode(a,r.options.filterRules),r.filterInputRule(a),t=a.toHtml()}if(o.innerHTML=utils.trim(t),!i.collapsed){var s=i.startContainer;if(domUtils.isFillChar(s)&&i.setStartBefore(s),s=i.endContainer,domUtils.isFillChar(s)&&i.setEndAfter(s),i.txtToElmBoundary(),i.endContainer&&1==i.endContainer.nodeType&&(s=i.endContainer.childNodes[i.endOffset],s&&domUtils.isBr(s)&&i.setEndAfter(s)),0==i.startOffset&&(s=i.startContainer,domUtils.isBoundaryNode(s,"firstChild")&&(s=i.endContainer,i.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&domUtils.isBoundaryNode(s,"lastChild")&&(r.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",i.setStart(r.body.firstChild,0).collapse(!0)))),!i.collapsed&&i.deleteContents(),1==i.startContainer.nodeType){var l,d=i.startContainer.childNodes[i.startOffset];if(d&&domUtils.isBlockElm(d)&&(l=d.previousSibling)&&domUtils.isBlockElm(l)){for(i.setEnd(l,l.childNodes.length).collapse();d.firstChild;)l.appendChild(d.firstChild);domUtils.remove(d)}}}var d,c,l,u,p,h=0;i.inFillChar()&&(d=i.startContainer,domUtils.isFillChar(d)?(i.setStartBefore(d).collapse(!0),domUtils.remove(d)):domUtils.isFillChar(d,!0)&&(d.nodeValue=d.nodeValue.replace(fillCharReg,""),i.startOffset--,i.collapsed&&i.collapse(!0)));var f=domUtils.findParentByTagName(i.startContainer,"li",!0);if(f){for(var m,g;d=o.firstChild;){for(;d&&(3==d.nodeType||!domUtils.isBlockElm(d)||"HR"==d.tagName);)m=d.nextSibling,i.insertNode(d).collapse(),g=d,d=m;if(d)if(/^(ol|ul)$/i.test(d.tagName)){for(;d.firstChild;)g=d.firstChild,domUtils.insertAfter(f,d.firstChild),f=f.nextSibling;domUtils.remove(d)}else{var b;m=d.nextSibling,b=r.document.createElement("li"),domUtils.insertAfter(f,b),b.appendChild(d),g=d,d=m,f=b}}f=domUtils.findParentByTagName(i.startContainer,"li",!0),domUtils.isEmptyBlock(f)&&domUtils.remove(f),g&&i.setStartAfter(g).collapse(!0).select(!0)}else{for(;d=o.firstChild;){if(h){for(var v=r.document.createElement("p");d&&(3==d.nodeType||!dtd.$block[d.tagName]);)p=d.nextSibling,v.appendChild(d),d=p;v.firstChild&&(d=v)}if(i.insertNode(d),p=d.nextSibling,!h&&d.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(d)&&(c=domUtils.findParent(d,function(e){return domUtils.isBlockElm(e)}),c&&"body"!=c.tagName.toLowerCase()&&(!dtd[c.tagName][d.nodeName]||d.parentNode!==c))){if(dtd[c.tagName][d.nodeName])for(u=d.parentNode;u!==c;)l=u,u=u.parentNode;else l=c;domUtils.breakParent(d,l||u);var l=d.previousSibling;domUtils.trimWhiteTextNode(l),l.childNodes.length||domUtils.remove(l),!browser.ie&&(m=d.nextSibling)&&domUtils.isBlockElm(m)&&m.lastChild&&!domUtils.isBr(m.lastChild)&&m.appendChild(r.document.createElement("br")),h=1}var m=d.nextSibling;if(!o.firstChild&&m&&domUtils.isBlockElm(m)){i.setStart(m,0).collapse(!0);break}i.setEndAfter(d).collapse()}if(d=i.startContainer,p&&domUtils.isBr(p)&&domUtils.remove(p),domUtils.isBlockElm(d)&&domUtils.isEmptyNode(d))if(p=d.nextSibling)domUtils.remove(d),1==p.nodeType&&dtd.$block[p.tagName]&&i.setStart(p,0).collapse(!0).shrinkBoundary();else try{
d.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}catch(y){i.setStartBefore(d),domUtils.remove(d)}try{i.select(!0)}catch(y){}}setTimeout(function(){i=r.selection.getRange(),i.scrollToView(r.autoHeightEnabled,r.autoHeightEnabled?domUtils.getXY(r.iframe).y:0),r.fireEvent("afterinserthtml",t)},200)}}},UE.plugins.link=function(){function e(e){var t=e.startContainer,n=e.endContainer;(t=domUtils.findParentByTagName(t,"a",!0))&&e.setStartBefore(t),(n=domUtils.findParentByTagName(n,"a",!0))&&e.setEndAfter(n)}function t(t,n,i){var o=t.cloneRange(),r=i.queryCommandValue("link");e(t=t.adjustmentBoundary());var a=t.startContainer;if(1==a.nodeType&&r&&(a=a.childNodes[t.startOffset],a&&1==a.nodeType&&"A"==a.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(a[browser.ie?"innerText":"textContent"])&&(a[browser.ie?"innerText":"textContent"]=utils.html(n.textValue||n.href))),o.collapsed&&!r||(t.removeInlineStyle("a"),o=t.cloneRange()),o.collapsed){var s=t.document.createElement("a"),l="";n.textValue?(l=utils.html(n.textValue),delete n.textValue):l=utils.html(n.href),domUtils.setAttributes(s,n),a=domUtils.findParentByTagName(o.startContainer,"a",!0),a&&domUtils.isInNodeEndBoundary(o,a)&&t.setStartAfter(a).collapse(!0),s[browser.ie?"innerText":"textContent"]=l,t.insertNode(s).selectNode(s)}else t.applyInlineStyle("a",n)}UE.commands.unlink={execCommand:function(){var t,n=this.selection.getRange();n.collapsed&&!domUtils.findParentByTagName(n.startContainer,"a",!0)||(t=n.createBookmark(),e(n),n.removeInlineStyle("a").moveToBookmark(t).select())},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={execCommand:function(e,n){var i;n._href&&(n._href=utils.unhtml(n._href,/[<">]/g)),n.href&&(n.href=utils.unhtml(n.href,/[<">]/g)),n.textValue&&(n.textValue=utils.unhtml(n.textValue,/[<">]/g)),t(i=this.selection.getRange(),n,this),i.collapse().select(!0)},queryCommandValue:function(){var e,t=this.selection.getRange();if(!t.collapsed){t.shrinkBoundary();var n=3!=t.startContainer.nodeType&&t.startContainer.childNodes[t.startOffset]?t.startContainer.childNodes[t.startOffset]:t.startContainer,i=3==t.endContainer.nodeType||0==t.endOffset?t.endContainer:t.endContainer.childNodes[t.endOffset-1],o=t.getCommonAncestor();if(e=domUtils.findParentByTagName(o,"a",!0),!e&&1==o.nodeType)for(var r,a,s,l=o.getElementsByTagName("a"),d=0;s=l[d++];)if(r=domUtils.getPosition(s,n),a=domUtils.getPosition(s,i),(r&domUtils.POSITION_FOLLOWING||r&domUtils.POSITION_CONTAINS)&&(a&domUtils.POSITION_PRECEDING||a&domUtils.POSITION_CONTAINS)){e=s;break}return e}if(e=t.startContainer,e=1==e.nodeType?e:e.parentNode,e&&(e=domUtils.findParentByTagName(e,"a",!0))&&!domUtils.isInNodeEndBoundary(t,e))return e},queryCommandState:function(){var e=this.selection.getRange().getClosedNode(),t=e&&("edui-faked-video"==e.className||e.className.indexOf("edui-upload-video")!=-1);return t?-1:0}}},UE.plugins.paragraph=function(){var e=this,t=domUtils.isBlockElm,n=["TD","LI","PRE"],i=function(i,o,r,a){var s,l=i.createBookmark(),d=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)};i.enlarge(!0);for(var c,u=i.createBookmark(),p=domUtils.getNextDomNode(u.start,!1,d),h=i.cloneRange();p&&!(domUtils.getPosition(p,u.end)&domUtils.POSITION_FOLLOWING);)if(/qyer_block/gi.test(p.className))p=domUtils.getNextDomNode(p,!1,d);else if(3!=p.nodeType&&t(p))p=domUtils.getNextDomNode(p,!0,d);else{for(h.setStartBefore(p);p&&p!==u.end&&!t(p);)c=p,p=domUtils.getNextDomNode(p,!1,null,function(e){return!t(e)});h.setEndAfter(c),s=i.document.createElement(o),r&&(domUtils.setAttributes(s,r),a&&"customstyle"==a&&r.style&&(s.style.cssText=r.style)),s.appendChild(h.extractContents()),domUtils.isEmptyNode(s)&&domUtils.fillChar(i.document,s),h.insertNode(s);var f=s.parentNode;t(f)&&!domUtils.isBody(s.parentNode)&&utils.indexOf(n,f.tagName)==-1&&(a&&"customstyle"==a||(f.getAttribute("dir")&&s.setAttribute("dir",f.getAttribute("dir")),f.style.cssText&&(s.style.cssText=f.style.cssText+";"+s.style.cssText),f.style.textAlign&&!s.style.textAlign&&(s.style.textAlign=f.style.textAlign),f.style.textIndent&&!s.style.textIndent&&(s.style.textIndent=f.style.textIndent),f.style.padding&&!s.style.padding&&(s.style.padding=f.style.padding)),r&&/h\d/i.test(f.tagName)&&!/h\d/i.test(s.tagName)?(domUtils.setAttributes(f,r),a&&"customstyle"==a&&r.style&&(f.style.cssText=r.style),domUtils.remove(s.parentNode,!0),s=f):domUtils.remove(s.parentNode,!0)),p=utils.indexOf(n,f.tagName)!=-1?f:s,p=domUtils.getNextDomNode(p,!1,d)}return domUtils.insertAfter(u.end,e.document.createTextNode("")),i.moveToBookmark(u).moveToBookmark(l)};e.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),e.commands.paragraph={execCommand:function(e,t,n,o){var r=this.selection.getRange();if(r.collapsed){var a=this.document.createTextNode("p");if(r.insertNode(a),browser.ie){var s=a.previousSibling;s&&domUtils.isWhitespace(s)&&domUtils.remove(s),s=a.nextSibling,s&&domUtils.isWhitespace(s)&&domUtils.remove(s)}}if(r=i(r,t,n,o),a&&(r.setStartBefore(a).collapse(!0),pN=a.parentNode,domUtils.remove(a),domUtils.isBlockElm(pN)&&domUtils.isEmptyNode(pN)&&domUtils.fillNode(this.document,pN)),browser.gecko&&r.collapsed&&1==r.startContainer.nodeType){var l=r.startContainer.childNodes[r.startOffset];l&&1==l.nodeType&&l.tagName.toLowerCase()==t&&r.setStart(l,0).collapse(!0)}return r.select(),!0},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""}}},UE.commands.cleardoc={execCommand:function(e){var t=this,n=t.options.enterTag,i=t.selection.getRange();"br"==n?(t.body.innerHTML="<br/>",i.setStart(t.body,0).setCursor()):(t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",i.setStart(t.body.firstChild,0).setCursor(!1,!0)),setTimeout(function(){t.fireEvent("clearDoc")},0)}},UE.plugins.wordcount=function(){var e=this;e.setOpt("wordCount",!0),e.addListener("contentchange",function(){e.fireEvent("wordcount")});var t;e.addListener("ready",function(){var e=this;domUtils.on(e.body,"keyup",function(n){var i=n.keyCode||n.which,o={16:1,18:1,20:1,37:1,38:1,39:1,40:1};i in o||(clearTimeout(t),t=setTimeout(function(){e.fireEvent("wordcount")},200))})})},UE.plugins.undo=function(){function e(e,t){if(e.length!=t.length)return 0;for(var n=0,i=e.length;n<i;n++)if(e[n]!=t[n])return 0;return 1}function t(t,n){return t.collapsed!=n.collapsed?0:e(t.startAddress,n.startAddress)&&e(t.endAddress,n.endAddress)?1:0}function n(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();for(;this.list[this.index].content==this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var e=this.editor,t=this.list[this.index],n=UE.htmlparser(t.content.replace(s,""));e.options.autoClearEmptyNode=!1,e.filterInputRule(n),e.options.autoClearEmptyNode=d,e.document.body.innerHTML=n.toHtml(),e.fireEvent("afterscencerestore"),browser.ie&&utils.each(domUtils.getElementsByTagName(e.document,"td th caption p"),function(t){domUtils.isEmptyNode(t)&&domUtils.fillNode(e.document,t)});try{var i=new dom.Range(e.document).moveToAddress(t.address);i.select(l[i.startContainer.nodeName.toLowerCase()])}catch(o){}this.update(),this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange(),n=t.createAddress(!1,!0);e.fireEvent("beforegetscene");var i=UE.htmlparser(e.body.innerHTML);e.options.autoClearEmptyNode=!1,e.filterOutputRule(i),e.options.autoClearEmptyNode=d;var o=i.toHtml();return e.fireEvent("aftergetscene"),{address:n,content:o}},this.save=function(e,n){clearTimeout(i);var a=this.getScene(n),s=this.list[this.index];s&&s.content!=a.content&&o.trigger("contentchange"),s&&s.content==a.content&&(e?1:t(s.address,a.address))||(this.list=this.list.slice(0,this.index+1),this.list.push(a),this.list.length>r&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){p=0,c=null}}var i,o=this,r=o.options.maxUndoCount||20,a=o.options.maxInputCount||20,s=new RegExp(domUtils.fillChar+"|</hr>","gi"),l={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},d=o.options.autoClearEmptyNode;o.undoManger=new n,o.undoManger.editor=o,o.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),o.addListener("reset",function(e,t){t||this.undoManger.reset()}),o.commands.redo=o.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+("undo"==e.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var c,u={16:1,17:1,18:1,37:1,38:1,39:1,40:1},p=0,h=!1;o.addListener("ready",function(){domUtils.on(this.body,"compositionstart",function(){h=!0}),domUtils.on(this.body,"compositionend",function(){h=!1})}),o.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var f=!0;o.addListener("keydown",function(e,t){function n(e){e.undoManger.save(!1,!0),e.fireEvent("selectionchange")}var o=this,r=t.keyCode||t.which;if(!(u[r]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(h)return;if(!o.selection.getRange().collapsed)return o.undoManger.save(!1,!0),void(f=!1);0==o.undoManger.list.length&&o.undoManger.save(!0),clearTimeout(i),i=setTimeout(function(){if(h)var e=setInterval(function(){h||(n(o),clearInterval(e))},300);else n(o)},200),c=r,p++,p>=a&&n(o)}}),o.addListener("keyup",function(e,t){var n=t.keyCode||t.which;if(!(u[n]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(h)return;f||(this.undoManger.save(!1,!0),f=!0)}}),o.stopCmdUndo=function(){o.__hasEnterExecCommand=!0},o.startCmdUndo=function(){o.__hasEnterExecCommand=!1}},UE.plugin.register("copy",function(){function e(){ZeroClipboard.config({debug:!1,swfPath:t.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var e=t.zeroclipboard=new ZeroClipboard;e.on("copy",function(e){var n=e.client,i=t.selection.getRange(),o=document.createElement("div");o.appendChild(i.cloneContents()),n.setText(o.innerText||o.textContent),n.setHtml(o.innerHTML),i.select()}),e.on("mouseover mouseout",function(e){var t=e.target;t&&("mouseover"==e.type?domUtils.addClass(t,"edui-state-hover"):"mouseout"==e.type&&domUtils.removeClasses(t,"edui-state-hover"))}),e.on("wrongflash noflash",function(){ZeroClipboard.destroy()}),t.fireEvent("zeroclipboardready",e)}var t=this;return{bindEvents:{ready:function(){browser.ie||(window.ZeroClipboard?e():utils.loadFile(document,{src:t.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){e()}))}},commands:{copy:{execCommand:function(e){t.document.execCommand("copy")||alert(t.getLang("copymsg"))}}}}}),UE.plugins.paste=function(){function e(e){var t=this.document;if(!t.getElementById("baidu_pastebin")){var n=this.selection.getRange(),i=n.createBookmark(),o=t.createElement("div");o.id="baidu_pastebin",browser.webkit&&o.appendChild(t.createTextNode(domUtils.fillChar+domUtils.fillChar)),t.body.appendChild(o),i.start.style.display="",o.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(i.start).y+"px",n.selectNodeContents(o).select(!0),setTimeout(function(){if(browser.webkit)for(var r,a=0,s=t.querySelectorAll("#baidu_pastebin");r=s[a++];){if(!domUtils.isEmptyNode(r)){o=r;break}domUtils.remove(r)}try{o.parentNode.removeChild(o)}catch(l){}n.moveToBookmark(i).select(!0),e(o)},0)}}function t(e){return e.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,n,i){return n=n.toLowerCase(),{img:1}[n]?e:(i=i.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,n){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+n+" ":""}),{span:1,div:1}[n]?"":"<"+t+n+" "+utils.trim(i)+">")})}function n(e){var n;if(e.firstChild){for(var s,l=domUtils.getElementsByTagName(e,"span"),d=0;s=l[d++];)"_baidu_cut_start"!=s.id&&"_baidu_cut_end"!=s.id||domUtils.remove(s);if(browser.webkit){for(var c,u=e.querySelectorAll("div br"),d=0;c=u[d++];){var p=c.parentNode;"DIV"==p.tagName&&1==p.childNodes.length&&(p.innerHTML="<p><br/></p>",domUtils.remove(p))}for(var h,f=e.querySelectorAll("#baidu_pastebin"),d=0;h=f[d++];){var m=i.document.createElement("p");for(h.parentNode.insertBefore(m,h);h.firstChild;)m.appendChild(h.firstChild);domUtils.remove(h)}for(var g,b=e.querySelectorAll("meta"),d=0;g=b[d++];)domUtils.remove(g);var u=e.querySelectorAll("br");for(d=0;g=u[d++];)/^apple-/i.test(g.className)&&domUtils.remove(g)}if(browser.gecko){var v=e.querySelectorAll("[_moz_dirty]");for(d=0;g=v[d++];)g.removeAttribute("_moz_dirty")}if(!browser.ie)for(var g,y=e.querySelectorAll("span.Apple-style-span"),d=0;g=y[d++];)domUtils.remove(g,!0);n=e.innerHTML,n=UE.filterWord(n);var x=UE.htmlparser(n);if(i.options.filterRules&&UE.filterNode(x,i.options.filterRules),i.filterInputRule(x),browser.webkit){var _=x.lastChild();_&&"element"==_.type&&"br"==_.tagName&&x.removeChild(_),utils.each(i.body.querySelectorAll("div"),function(e){domUtils.isEmptyBlock(e)&&domUtils.remove(e,!0)})}if(n={html:x.toHtml()},i.fireEvent("beforepaste",n,x),!n.html)return;x=UE.htmlparser(n.html,!0),1===i.queryCommandState("pasteplain")?i.execCommand("insertHtml",UE.filterNode(x,i.options.filterTxtRules).toHtml(),!0):(UE.filterNode(x,i.options.filterTxtRules),o=x.toHtml(),r=n.html,a=i.selection.getRange().createAddress(!0),i.execCommand("insertHtml",i.getOpt("retainOnlyLabelPasted")===!0?t(r):r,!0)),i.fireEvent("afterpaste",n)}}var i=this;i.setOpt({retainOnlyLabelPasted:!1});var o,r,a;i.addListener("pasteTransfer",function(e,n){if(a&&o&&r&&o!=r){var s=i.selection.getRange();if(s.moveToAddress(a,!0),!s.collapsed){for(;!domUtils.isBody(s.startContainer);){var l=s.startContainer;if(1==l.nodeType){if(l=l.childNodes[s.startOffset],!l){s.setStartBefore(s.startContainer);continue}var d=l.previousSibling;d&&3==d.nodeType&&new RegExp("^[\n\r\t "+domUtils.fillChar+"]*$").test(d.nodeValue)&&s.setStartBefore(d)}if(0!=s.startOffset)break;s.setStartBefore(s.startContainer)}for(;!domUtils.isBody(s.endContainer);){var c=s.endContainer;if(1==c.nodeType){if(c=c.childNodes[s.endOffset],!c){s.setEndAfter(s.endContainer);continue}var u=c.nextSibling;u&&3==u.nodeType&&new RegExp("^[\n\r\t"+domUtils.fillChar+"]*$").test(u.nodeValue)&&s.setEndAfter(u)}if(s.endOffset!=s.endContainer[3==s.endContainer.nodeType?"nodeValue":"childNodes"].length)break;s.setEndAfter(s.endContainer)}}s.deleteContents(),s.select(!0),i.__hasEnterExecCommand=!0;var p=r;2===n?p=t(p):n&&(p=o),i.execCommand("inserthtml",p,!0),i.__hasEnterExecCommand=!1;for(var h=i.selection.getRange();!domUtils.isBody(h.startContainer)&&!h.startOffset&&h.startContainer[3==h.startContainer.nodeType?"nodeValue":"childNodes"].length;)h.setStartBefore(h.startContainer);var f=h.createAddress(!0);a.endAddress=f.startAddress}}),i.addListener("ready",function(){domUtils.on(i.body,"cut",function(){var e=i.selection.getRange();!e.collapsed&&i.undoManger&&i.undoManger.save()}),domUtils.on(i.body,browser.ie||browser.opera?"keydown":"paste",function(t){(!browser.ie&&!browser.opera||(t.ctrlKey||t.metaKey)&&"86"==t.keyCode)&&e.call(i,function(e){n(e)})})}),i.commands.paste={execCommand:function(t){browser.ie?(e.call(i,function(e){n(e)}),i.document.execCommand("paste")):alert(i.getLang("pastemsg"))}}},UE.plugins.pasteplain=function(){var e=this;e.setOpt({pasteplain:!1,filterTxtRules:function(){function e(e){e.tagName="p",e.setStyle()}function t(e){e.parentNode.removeChild(e,!0)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(e){for(var t,n=UE.uNode.createElement("p");t=e.firstChild();)"text"!=t.type&&UE.dom.dtd.$block[t.tagName]?n.firstChild()?(e.parentNode.insertBefore(n,e),n=UE.uNode.createElement("p")):e.parentNode.insertBefore(t,e):n.appendChild(t);n.firstChild()&&e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){var t=!!e.innerText();t&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e),e.parentNode.removeChild(e,e.innerText())}}}()});var t=e.options.pasteplain;e.commands.pasteplain={queryCommandState:function(){return t?1:0},execCommand:function(){t=0|!t},notNeedUndo:1}},UE.plugins.enterkey=function(){var e,t=this,n=t.options.enterTag;t.addListener("keyup",function(n,i){var o=i.keyCode||i.which;if(13==o){var r,a=t.selection.getRange(),s=a.startContainer;if(browser.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(e)){if(browser.gecko){var l=domUtils.findParentByTagName(s,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);l||(t.document.execCommand("formatBlock",!1,"<p>"),r=1)}else if(1==s.nodeType){var d,c=t.document.createTextNode("");if(a.insertNode(c),d=domUtils.findParentByTagName(c,"div",!0)){for(var u=t.document.createElement("p");d.firstChild;)u.appendChild(d.firstChild);d.parentNode.insertBefore(u,d),domUtils.remove(d),a.setStartBefore(c).setCursor(),r=1}domUtils.remove(c)}t.undoManger&&r&&t.undoManger.save()}browser.opera&&a.select()}}}),t.addListener("keydown",function(i,o){var r=o.keyCode||o.which;if(13==r){if(t.fireEvent("beforeenterkeydown"))return void domUtils.preventDefault(o);t.fireEvent("saveScene",!0,!0),e="";var a=t.selection.getRange();if(!a.collapsed){var s=a.startContainer,l=a.endContainer,d=domUtils.findParentByTagName(s,"td",!0),c=domUtils.findParentByTagName(l,"td",!0);if(d&&c&&d!==c||!d&&c||d&&!c)return void(o.preventDefault?o.preventDefault():o.returnValue=!1)}if("p"==n)browser.ie||(s=domUtils.findParentByTagName(a.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),s||browser.opera?(e=s.tagName,"p"==s.tagName.toLowerCase()&&browser.gecko&&domUtils.removeDirtyAttr(s)):(t.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(a=t.selection.getRange(),s=domUtils.findParentByTagName(a.startContainer,"p",!0),s&&domUtils.removeDirtyAttr(s))));else if(o.preventDefault?o.preventDefault():o.returnValue=!1,a.collapsed){p=a.document.createElement("br"),a.insertNode(p);var u=p.parentNode;u.lastChild===p?(p.parentNode.insertBefore(p.cloneNode(!0),p),a.setStartBefore(p)):a.setStartAfter(p),a.setCursor()}else if(a.deleteContents(),s=a.startContainer,1==s.nodeType&&(s=s.childNodes[a.startOffset])){for(;1==s.nodeType;){if(dtd.$empty[s.tagName])return a.setStartBefore(s).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!s.firstChild){var p=a.document.createElement("br");return s.appendChild(p),a.setStart(s,0).setCursor(),t.undoManger&&t.undoManger.save(),!1}s=s.firstChild}s===a.startContainer.childNodes[a.startOffset]?(p=a.document.createElement("br"),a.insertNode(p).setCursor()):a.setStart(s,0).setCursor()}else p=a.document.createElement("br"),a.insertNode(p).setStartAfter(p).setCursor()}})},UE.plugins.keystrokes=function(){var e=this,t=!0;e.addListener("keydown",function(n,i){var o=i.keyCode||i.which,r=e.selection.getRange();if(!r.collapsed&&!(i.ctrlKey||i.shiftKey||i.altKey||i.metaKey)&&(o>=65&&o<=90||o>=48&&o<=57||o>=96&&o<=111||{13:1,8:1,46:1}[o])){var a=r.startContainer;if(domUtils.isFillChar(a)&&r.setStartBefore(a),a=r.endContainer,domUtils.isFillChar(a)&&r.setEndAfter(a),r.txtToElmBoundary(),r.endContainer&&1==r.endContainer.nodeType&&(a=r.endContainer.childNodes[r.endOffset],a&&domUtils.isBr(a)&&r.setEndAfter(a)),0==r.startOffset&&(a=r.startContainer,domUtils.isBoundaryNode(a,"firstChild")&&(a=r.endContainer,r.endOffset==(3==a.nodeType?a.nodeValue.length:a.childNodes.length)&&domUtils.isBoundaryNode(a,"lastChild"))))return e.fireEvent("saveScene"),e.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",r.setStart(e.body.firstChild,0).setCursor(!1,!0),void e._selectionChange()}if(o==keymap.Backspace){if(r=e.selection.getRange(),t=r.collapsed,e.fireEvent("delkeydown",i))return;var s,l;if(r.collapsed&&r.inFillChar()&&(s=r.startContainer,domUtils.isFillChar(s)?(r.setStartBefore(s).shrinkBoundary(!0).collapse(!0),domUtils.remove(s)):(s.nodeValue=s.nodeValue.replace(new RegExp("^"+domUtils.fillChar),""),r.startOffset--,r.collapse(!0).select(!0))),s=r.getClosedNode())return e.fireEvent("saveScene"),r.setStartBefore(s),domUtils.remove(s),r.setCursor(),e.fireEvent("saveScene"),void domUtils.preventDefault(i);if(!browser.ie&&(s=domUtils.findParentByTagName(r.startContainer,"table",!0),l=domUtils.findParentByTagName(r.endContainer,"table",!0),s&&!l||!s&&l||s!==l))return void i.preventDefault()}if(o==keymap.Tab){var d={ol:1,ul:1,table:1};if(e.fireEvent("tabkeydown",i))return void domUtils.preventDefault(i);var c=e.selection.getRange();e.fireEvent("saveScene");for(var u=0,p="",h=e.options.tabSize||4,f=e.options.tabNode||"&nbsp;";u<h;u++)p+=f;var m=e.document.createElement("span");if(m.innerHTML=p+domUtils.fillChar,c.collapsed)c.insertNode(m.cloneNode(!0).firstChild).setCursor(!0);else{var g=function(e){return domUtils.isBlockElm(e)&&!d[e.tagName.toLowerCase()]};if(s=domUtils.findParent(c.startContainer,g,!0),l=domUtils.findParent(c.endContainer,g,!0),s&&l&&s===l)c.deleteContents(),c.insertNode(m.cloneNode(!0).firstChild).setCursor(!0);else{var b=c.createBookmark();c.enlarge(!0);for(var v=c.createBookmark(),y=domUtils.getNextDomNode(v.start,!1,g);y&&!(domUtils.getPosition(y,v.end)&domUtils.POSITION_FOLLOWING);)y.insertBefore(m.cloneNode(!0).firstChild,y.firstChild),y=domUtils.getNextDomNode(y,!1,g);c.moveToBookmark(v).moveToBookmark(b).select()}}domUtils.preventDefault(i)}if(browser.gecko&&46==o&&(c=e.selection.getRange(),c.collapsed&&(s=c.startContainer,domUtils.isEmptyBlock(s)))){for(var x=s.parentNode;1==domUtils.getChildCount(x)&&!domUtils.isBody(x);)s=x,x=x.parentNode;return void(s===x.lastChild&&i.preventDefault())}browser.chrome&&e.on("keydown",function(e,t){var n=t.keyCode||t.which;if((t.metaKey&&t.altKey||t.ctrlKey&&t.shiftKey)&&73==n)return!0})}),e.addListener("keyup",function(e,n){var i,o=n.keyCode||n.which,r=this;if(o==keymap.Backspace){if(r.fireEvent("delkeyup"))return;if(i=r.selection.getRange(),i.collapsed){var a,s=["h1","h2","h3","h4","h5","h6"];if((a=domUtils.findParentByTagName(i.startContainer,s,!0))&&domUtils.isEmptyBlock(a)){var l=a.previousSibling;if(l&&"TABLE"!=l.nodeName)return domUtils.remove(a),void i.setStartAtLast(l).setCursor(!1,!0);var d=a.nextSibling;if(d&&"TABLE"!=d.nodeName)return domUtils.remove(a),void i.setStartAtFirst(d).setCursor(!1,!0)}if(domUtils.isBody(i.startContainer)){var a=domUtils.createElement(r.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});i.insertNode(a).setStart(a,0).setCursor(!1,!0)}}if(!t&&(3==i.startContainer.nodeType||1==i.startContainer.nodeType&&domUtils.isEmptyBlock(i.startContainer)))if(browser.ie){var c=i.document.createElement("span");i.insertNode(c).setStartBefore(c).collapse(!0),i.select(),domUtils.remove(c)}else i.select()}})},UE.plugins.fiximgclick=function(){function e(){this.editor=null,this.resizer=null,this.cover=null,this.doc=document,this.prePos={x:0,y:0},this.startPos={x:0,y:0}}var t=!1;return function(){var n=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];e.prototype={init:function(e){var t=this;t.editor=e,t.startPos=this.prePos={x:0,y:0},t.dragId=-1;var n=[],o=t.cover=document.createElement("div"),r=t.resizer=document.createElement("div");for(o.id=t.editor.ui.id+"_imagescale_cover",o.style.cssText="position:absolute;display:none;z-index:"+t.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;",domUtils.on(o,"mousedown click",function(){t.hide()}),i=0;i<8;i++)n.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');r.id=t.editor.ui.id+"_imagescale",r.className="edui-editor-imagescale",r.innerHTML=n.join(""),r.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+t.editor.options.zIndex+";",t.editor.ui.getDom().appendChild(o),t.editor.ui.getDom().appendChild(r),t.initStyle(),t.initEvents()},initStyle:function(){utils.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var e=this;e.startPos.x=e.startPos.y=0,e.isDraging=!1},_eventHandler:function(e){var n=this;switch(e.type){case"mousedown":var i,i=e.target||e.srcElement;i.className.indexOf("edui-editor-imagescale-hand")!=-1&&n.dragId==-1&&(n.dragId=i.className.slice(-1),n.startPos.x=n.prePos.x=e.clientX,n.startPos.y=n.prePos.y=e.clientY,domUtils.on(n.doc,"mousemove",n.proxy(n._eventHandler,n)));break;case"mousemove":n.dragId!=-1&&(n.updateContainerStyle(n.dragId,{x:e.clientX-n.prePos.x,y:e.clientY-n.prePos.y}),n.prePos.x=e.clientX,n.prePos.y=e.clientY,t=!0,n.updateTargetElement());break;case"mouseup":n.dragId!=-1&&(n.updateContainerStyle(n.dragId,{x:e.clientX-n.prePos.x,y:e.clientY-n.prePos.y}),n.updateTargetElement(),n.target.parentNode&&n.attachTo(n.target),n.dragId=-1),domUtils.un(n.doc,"mousemove",n.proxy(n._eventHandler,n)),t&&(t=!1,n.editor.fireEvent("contentchange"))}},updateTargetElement:function(){var e=this;domUtils.setStyles(e.target,{width:e.resizer.style.width,height:e.resizer.style.height}),e.target.width=parseInt(e.resizer.style.width),e.target.height=parseInt(e.resizer.style.height),e.attachTo(e.target)},updateContainerStyle:function(e,t){var i,o=this,r=o.resizer;0!=n[e][0]&&(i=parseInt(r.style.left)+t.x,r.style.left=o._validScaledProp("left",i)+"px"),0!=n[e][1]&&(i=parseInt(r.style.top)+t.y,r.style.top=o._validScaledProp("top",i)+"px"),0!=n[e][2]&&(i=r.clientWidth+n[e][2]*t.x,r.style.width=o._validScaledProp("width",i)+"px"),0!=n[e][3]&&(i=r.clientHeight+n[e][3]*t.y,r.style.height=o._validScaledProp("height",i)+"px")},_validScaledProp:function(e,t){var n=this.resizer,i=document;switch(t=isNaN(t)?0:t,e){case"left":return t<0?0:t+n.clientWidth>i.clientWidth?i.clientWidth-n.clientWidth:t;case"top":return t<0?0:t+n.clientHeight>i.clientHeight?i.clientHeight-n.clientHeight:t;case"width":return t<=0?1:t+n.offsetLeft>i.clientWidth?i.clientWidth-n.offsetLeft:t;case"height":return t<=0?1:t+n.offsetTop>i.clientHeight?i.clientHeight-n.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var e=this,t=domUtils.getXY(e.editor.ui.getDom()),n=domUtils.getXY(e.editor.iframe);domUtils.setStyles(e.cover,{width:e.editor.iframe.offsetWidth+"px",height:e.editor.iframe.offsetHeight+"px",top:n.y-t.y+"px",left:n.x-t.x+"px",position:"absolute",display:""})},show:function(e){var t=this;t.resizer.style.display="block",e&&t.attachTo(e),domUtils.on(this.resizer,"mousedown",t.proxy(t._eventHandler,t)),domUtils.on(t.doc,"mouseup",t.proxy(t._eventHandler,t)),t.showCover(),t.editor.fireEvent("afterscaleshow",t),t.editor.fireEvent("saveScene")},hide:function(){var e=this;e.hideCover(),e.resizer.style.display="none",domUtils.un(e.resizer,"mousedown",e.proxy(e._eventHandler,e)),domUtils.un(e.doc,"mouseup",e.proxy(e._eventHandler,e)),e.editor.fireEvent("afterscalehide",e)},proxy:function(e,t){return function(n){return e.apply(t||this,arguments)}},attachTo:function(e){var t=this,n=t.target=e,i=this.resizer,o=domUtils.getXY(n),r=domUtils.getXY(t.editor.iframe),a=domUtils.getXY(i.parentNode);domUtils.setStyles(i,{width:n.width+"px",height:n.height+"px",left:r.x+o.x-t.editor.document.body.scrollLeft-a.x-parseInt(i.style.borderLeftWidth)+"px",top:r.y+o.y-t.editor.document.body.scrollTop-a.y-parseInt(i.style.borderTopWidth)+"px"})}}}(),function(){var t,n=this;n.setOpt("imageScaleEnabled",!0),!browser.ie&&n.options.imageScaleEnabled&&n.addListener("click",function(i,o){var r=n.selection.getRange(),a=r.getClosedNode();if(a&&"IMG"==a.tagName&&"false"!=n.body.contentEditable){if(a.className.indexOf("edui-faked-music")!=-1||a.getAttribute("anchorname")||domUtils.hasClass(a,"loadingclass")||domUtils.hasClass(a,"loaderrorclass"))return;if(!t){t=new e,t.init(n),n.ui.getDom().appendChild(t.resizer);var s,l=function(e){t.hide(),t.target&&n.selection.getRange().selectNode(t.target).select()},d=function(e){var t=e.target||e.srcElement;!t||void 0!==t.className&&t.className.indexOf("edui-editor-imagescale")!=-1||l(e)};n.addListener("afterscaleshow",function(e){n.addListener("beforekeydown",l),n.addListener("beforemousedown",d),domUtils.on(document,"keydown",l),domUtils.on(document,"mousedown",d),n.selection.getNative().removeAllRanges()}),n.addListener("afterscalehide",function(e){n.removeListener("beforekeydown",l),n.removeListener("beforemousedown",d),domUtils.un(document,"keydown",l),domUtils.un(document,"mousedown",d);var i=t.target;i.parentNode&&n.selection.getRange().selectNode(i).select()}),domUtils.on(t.resizer,"mousedown",function(e){n.selection.getNative().removeAllRanges();var i=e.target||e.srcElement;i&&i.className.indexOf("edui-editor-imagescale-hand")==-1&&(s=setTimeout(function(){t.hide(),t.target&&n.selection.getRange().selectNode(i).select()},200))}),domUtils.on(t.resizer,"mouseup",function(e){var t=e.target||e.srcElement;t&&t.className.indexOf("edui-editor-imagescale-hand")==-1&&clearTimeout(s)})}t.show(a)}else t&&"none"!=t.resizer.style.display&&t.hide()}),browser.webkit&&n.addListener("click",function(e,t){if("IMG"==t.target.tagName&&"false"!=n.body.contentEditable){var i=new dom.Range(n.document);i.selectNode(t.target).select()}})}}(),UE.plugins.autoheight=function(){function e(){var e=this;clearTimeout(o),r||(!e.queryCommandState||e.queryCommandState&&1!=e.queryCommandState("source"))&&(o=setTimeout(function(){for(var t=e.body.lastChild;t&&1!=t.nodeType;)t=t.previousSibling;t&&1==t.nodeType&&(t.style.clear="both",i=Math.max(domUtils.getXY(t).y+t.offsetHeight+25,Math.max(s.minFrameHeight,s.initialFrameHeight)),i!=a&&(i!==parseInt(e.iframe.parentNode.style.height)&&(e.iframe.parentNode.style.height=i+"px"),e.body.style.height=i+"px",a=i),domUtils.removeStyle(t,"clear"))},50))}var t=this;if(t.autoHeightEnabled=t.options.autoHeightEnabled!==!1,t.autoHeightEnabled){var n,i,o,r,a=0,s=t.options;t.addListener("fullscreenchanged",function(e,t){r=t}),t.addListener("destroy",function(){t.removeListener("contentchange afterinserthtml keyup mouseup",e)}),t.enableAutoHeight=function(){var t=this;if(t.autoHeightEnabled){var i=t.document;t.autoHeightEnabled=!0,n=i.body.style.overflowY,i.body.style.overflowY="hidden",t.addListener("contentchange afterinserthtml keyup mouseup",e),
setTimeout(function(){e.call(t)},browser.gecko?100:0),t.fireEvent("autoheightchanged",t.autoHeightEnabled)}},t.disableAutoHeight=function(){t.body.style.overflowY=n||"",t.removeListener("contentchange",e),t.removeListener("keyup",e),t.removeListener("mouseup",e),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.on("setHeight",function(){t.disableAutoHeight()}),t.addListener("ready",function(){t.enableAutoHeight();var n;domUtils.on(browser.ie?t.body:t.document,browser.webkit?"dragover":"drop",function(){clearTimeout(n),n=setTimeout(function(){e.call(t)},100)});var i;window.onscroll=function(){null===i?i=this.scrollY:0==this.scrollY&&0!=i&&(t.window.scrollTo(0,0),i=null)}})}},UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=function(e,t){return domUtils.filterNodeList(e.selection.getStartElementPath(),t)},n=this;n.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),n.addInputRule(function(e){utils.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})});for(var i in e)!function(e,i){n.commands[e]={execCommand:function(e){var o=n.selection.getRange(),r=t(this,i);if(o.collapsed){if(r){var a=n.document.createTextNode("");o.insertNode(a).removeInlineStyle(i),o.setStartBefore(a),domUtils.remove(a)}else{var s=o.document.createElement(i[0]);"superscript"!=e&&"subscript"!=e||(a=n.document.createTextNode(""),o.insertNode(a).removeInlineStyle(["sub","sup"]).setStartBefore(a).collapse(!0)),o.insertNode(s).setStart(s,0)}o.collapse(!0)}else"superscript"!=e&&"subscript"!=e||r&&r.tagName.toLowerCase()==e||o.removeInlineStyle(["sub","sup"]),r?o.removeInlineStyle(i):o.applyInlineStyle(i[0]);o.select()},queryCommandState:function(){return t(this,i)?1:0}}}(i,e[i])},UE.plugins.elementpath=function(){var e,t,n=this;n.setOpt("elementPathEnabled",!0),n.options.elementPathEnabled&&(n.commands.elementpath={execCommand:function(i,o){var r=t[o],a=n.selection.getRange();e=1*o,a.selectNode(r).select()},queryCommandValue:function(){var n=[].concat(this.selection.getStartElementPath()).reverse(),i=[];t=n;for(var o,r=0;o=n[r];r++)if(3!=o.nodeType){var a=o.tagName.toLowerCase();if("img"==a&&o.getAttribute("anchorname")&&(a="anchor"),i[r]=a,e==r){e=-1;break}}return i}})},UE.plugin.register("autosave",function(){function e(e){var r;if(!(new Date-n<i)){if(!e.hasContents())return void(o&&t.removePreferences(o));n=new Date,e._saveFlag=null,r=t.body.innerHTML,e.fireEvent("beforeautosave",{content:r})!==!1&&(t.setPreferences(o,r),e.fireEvent("afterautosave",{content:r}))}}var t=this,n=new Date,i=20,o=null;return{defaultOptions:{saveInterval:500,enableAutoSave:!0},bindEvents:{ready:function(){var e="-drafts-data",n=null;n=t.key?t.key+e:(t.container.parentNode.id||"ue-common")+e,o=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+n},contentchange:function(){t.getOpt("enableAutoSave")&&o&&(t._saveFlag&&window.clearTimeout(t._saveFlag),t.options.saveInterval>0?t._saveFlag=window.setTimeout(function(){e(t)},t.options.saveInterval):e(t))}},commands:{clearlocaldata:{execCommand:function(e,n){o&&t.getPreferences(o)&&t.removePreferences(o)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(e,n){return o?t.getPreferences(o)||"":""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(e,n){o&&(t.body.innerHTML=t.getPreferences(o)||"<p>"+domUtils.fillHtml+"</p>",t.focus(!0))},queryCommandState:function(){return o?null===t.getPreferences(o)?-1:0:-1},notNeedUndo:!0,ignoreContentChange:!0}}}}),UE.plugin.register("insertfile",function(){function e(e){var t=e.substr(e.lastIndexOf(".")+1).toLowerCase(),n={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return n[t]?n[t]:n.txt}var t=this;return{commands:{insertfile:{execCommand:function(n,i){if(i=utils.isArray(i)?i:[i],t.fireEvent("beforeinsertfile",i)!==!0){var o,r,a,s,l="",d=t.getOpt("UEDITOR_HOME_URL"),c=d+("/"==d.substr(d.length-1)?"":"/")+"dialogs/attachment/fileTypeImages/";for(o=0;o<i.length;o++)r=i[o],a=c+e(r.url),s=r.title||r.url.substr(r.url.lastIndexOf("/")+1),l+='<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+a+'" _src="'+a+'" /><a style="font-size:12px; color:#0066cc;" href="'+r.url+'" title="'+s+'">'+s+"</a></p>";t.execCommand("insertHtml",l),t.fireEvent("afterinsertfile",i)}}}}}}),UE.plugins.font=function(){function e(e){for(var t;(t=e.parentNode)&&"SPAN"==t.tagName&&1==domUtils.getChildCount(t,function(e){return!domUtils.isBookmarkNode(e)&&!domUtils.isBr(e)});)t.style.cssText+=e.style.cssText,domUtils.remove(e,!0),e=t}function t(e,t,n){if(a[t]&&(e.adjustmentBoundary(),!e.collapsed&&1==e.startContainer.nodeType)){var i=e.startContainer.childNodes[e.startOffset];if(i&&domUtils.isTagNode(i,"span")){var o=e.createBookmark();utils.each(domUtils.getElementsByTagName(i,"span"),function(e){e.parentNode&&!domUtils.isBookmarkNode(e)&&("backcolor"==t&&domUtils.getComputedStyle(e,"background-color").toLowerCase()===n||(domUtils.removeStyle(e,a[t]),0==e.style.cssText.replace(/^\s+$/,"").length&&domUtils.remove(e,!0)))}),e.moveToBookmark(o)}}}function n(n,i,o){var r,a=n.collapsed,s=n.createBookmark();if(a)for(r=s.start.parentNode;dtd.$inline[r.tagName];)r=r.parentNode;else r=domUtils.getCommonAncestor(s.start,s.end);utils.each(domUtils.getElementsByTagName(r,"span"),function(t){if(t.parentNode&&!domUtils.isBookmarkNode(t)){if(/\s*border\s*:\s*none;?\s*/i.test(t.style.cssText))return void(/^\s*border\s*:\s*none;?\s*$/.test(t.style.cssText)?domUtils.remove(t,!0):domUtils.removeStyle(t,"border"));if(/border/i.test(t.style.cssText)&&"SPAN"==t.parentNode.tagName&&/border/i.test(t.parentNode.style.cssText)&&(t.style.cssText=t.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),"fontborder"!=i||"none"!=o)for(var n=t.nextSibling;n&&1==n.nodeType&&"SPAN"==n.tagName;)if(domUtils.isBookmarkNode(n)&&"fontborder"==i)t.appendChild(n),n=t.nextSibling;else{if(n.style.cssText==t.style.cssText&&(domUtils.moveChild(n,t),domUtils.remove(n)),t.nextSibling===n)break;n=t.nextSibling}if(e(t),browser.ie&&browser.version>8){var r=domUtils.findParent(t,function(e){return"SPAN"==e.tagName&&/background-color/.test(e.style.cssText)});r&&!/background-color/.test(t.style.cssText)&&(t.style.backgroundColor=r.style.backgroundColor)}}}),n.moveToBookmark(s),t(n,i,o)}var i=this,o={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},r={underline:1,strikethrough:1,fontborder:1},a={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};i.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),i.addInputRule(function(e){utils.each(e.getNodesByTagName("u s del font strike"),function(e){if("font"==e.tagName){var t=[];for(var n in e.attrs)switch(n){case"size":t.push("font-size:"+({1:"16",2:"16",3:"18",4:"24",5:"24",6:"24",7:"24"}[e.attrs[n]]||e.attrs[n])+"px");break;case"color":t.push("color:"+e.attrs[n]);break;case"face":t.push("font-family:"+e.attrs[n]);break;case"style":t.push(e.attrs[n])}e.attrs={style:t.join(";")}}else{var i="u"==e.tagName?"underline":"line-through";e.attrs={style:(e.getAttr("style")||"")+"text-decoration:"+i+";"}}e.tagName="span"})});for(var s in o)!function(e,t){UE.commands[e]={execCommand:function(i,o){o=o||(this.queryCommandState(i)?"none":"underline"==i?"underline":"fontborder"==i?"1px solid #000":"line-through");var a,s=this,l=this.selection.getRange();if("default"==o)l.collapsed&&(a=s.document.createTextNode("font"),l.insertNode(a).select()),s.execCommand("removeFormat","span,a",t),a&&(l.setStartBefore(a).collapse(!0),domUtils.remove(a)),n(l,i,o),l.select();else if(l.collapsed){var d=domUtils.findParentByTagName(l.startContainer,"span",!0);if(a=s.document.createTextNode("font"),!d||d.children.length||d[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){if(l.insertNode(a),l.selectNode(a).select(),d=l.document.createElement("span"),r[e]){if(domUtils.findParentByTagName(a,"a",!0))return l.setStartBefore(a).setCursor(),void domUtils.remove(a);s.execCommand("removeFormat","span,a",t)}if(d.style.cssText=t+":"+o,a.parentNode.insertBefore(d,a),!browser.ie||browser.ie&&9==browser.version)for(var c=d.parentNode;!domUtils.isBlockElm(c);)"SPAN"==c.tagName&&(d.style.cssText=c.style.cssText+";"+d.style.cssText),c=c.parentNode;opera?setTimeout(function(){l.setStart(d,0).collapse(!0),n(l,i,o),l.select()}):(l.setStart(d,0).collapse(!0),n(l,i,o),l.select())}else l.insertNode(a),r[e]&&(l.selectNode(a).select(),s.execCommand("removeFormat","span,a",t,null),d=domUtils.findParentByTagName(a,"span",!0),l.setStartBefore(a)),d&&(d.style.cssText+=";"+t+":"+o),l.collapse(!0).select();domUtils.remove(a)}else r[e]&&s.queryCommandValue(e)&&s.execCommand("removeFormat","span,a",t),l=s.selection.getRange(),l.applyInlineStyle("span",{style:t+":"+o}),n(l,i,o),l.select();return!0},queryCommandValue:function(e){var n=this.selection.getStart();if("underline"==e||"strikethrough"==e){for(var i,o=n;o&&!domUtils.isBlockElm(o)&&!domUtils.isBody(o);){if(1==o.nodeType&&(i=domUtils.getComputedStyle(o,t),"none"!=i))return i;o=o.parentNode}return"none"}if("fontborder"==e){for(var r,a=n;a&&dtd.$inline[a.tagName];){if((r=domUtils.getComputedStyle(a,"border"))&&/1px/.test(r)&&/solid/.test(r))return r;a=a.parentNode}return""}if("FontSize"==e){var s=domUtils.getComputedStyle(n,t),a=/^([\d\.]+)(\w+)$/.exec(s);return a?Math.floor(a[1])+a[2]:s}return domUtils.getComputedStyle(n,t)},queryCommandState:function(e){if(!r[e])return 0;var t=this.queryCommandValue(e);return"fontborder"==e?/1px/.test(t)&&/solid/.test(t):"underline"==e?/underline/.test(t):/line\-through/.test(t)}}}(s,o[s])},UE.commands.imagefloat={execCommand:function(e,t){var n=this,i=n.selection.getRange();if(!i.collapsed){var o=i.getClosedNode();if(o&&"IMG"==o.tagName)switch(t){case"left":case"right":case"none":for(var r,a,s,l=o.parentNode;dtd.$inline[l.tagName]||"A"==l.tagName;)l=l.parentNode;if(r=l,"P"==r.tagName&&"center"==domUtils.getStyle(r,"text-align")){if(!domUtils.isBody(r)&&1==domUtils.getChildCount(r,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)}))if(a=r.previousSibling,s=r.nextSibling,a&&s&&1==a.nodeType&&1==s.nodeType&&a.tagName==s.tagName&&domUtils.isBlockElm(a)){for(a.appendChild(r.firstChild);s.firstChild;)a.appendChild(s.firstChild);domUtils.remove(r),domUtils.remove(s)}else domUtils.setStyle(r,"text-align","");i.selectNode(o).select()}domUtils.setStyle(o,"float","none"==t?"":t),"none"==t&&domUtils.removeAttributes(o,"align");break;case"center":if("center"!=n.queryCommandValue("imagefloat")){for(l=o.parentNode,domUtils.setStyle(o,"float",""),domUtils.removeAttributes(o,"align"),r=o;l&&1==domUtils.getChildCount(l,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})&&(dtd.$inline[l.tagName]||"A"==l.tagName);)r=l,l=l.parentNode;i.setStartBefore(r).setCursor(!1),l=n.document.createElement("div"),l.appendChild(r),domUtils.setStyle(r,"float",""),n.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+l.innerHTML+"</p>"),r=n.document.getElementById("_img_parent_tmp"),r.removeAttribute("id"),r=r.firstChild,i.selectNode(r).select(),s=r.parentNode.nextSibling,s&&domUtils.isEmptyNode(s)&&domUtils.remove(s)}}}},queryCommandValue:function(){var e,t,n=this.selection.getRange();return n.collapsed?"none":(e=n.getClosedNode(),e&&1==e.nodeType&&"IMG"==e.tagName?(t=domUtils.getComputedStyle(e,"float")||e.getAttribute("align"),"none"==t&&(t="center"==domUtils.getComputedStyle(e.parentNode,"text-align")?"center":t),{left:1,right:1,center:1}[t]?t:"none"):"none")},queryCommandState:function(){var e,t=this.selection.getRange();return t.collapsed?-1:(e=t.getClosedNode(),e&&1==e.nodeType&&"IMG"==e.tagName?0:-1)}},UE.plugins.qyer_image=function(){var e=this;e.addInputRule(function(e){utils.each(e.getNodesByTagName("img"),function(e){var t=e.getAttr("data-type");if(t&&t.indexOf("photo")!=-1){var n='<img class="qyer_image" src="'+e.getAttr("data-original")+'" _src="'+e.getAttr("data-original")+'" data-id="'+e.getAttr("data-id")+'">';e.parentNode.replaceChild(UE.uNode.createElement(n),e)}})}),UE.commands.insertimage={execCommand:function(e,t){if(t=utils.isArray(t)?t:[t],t.curScrollTop=document.body.scrollTop||document.documentElement.scrollTop,t.length){var n=this,i=n.selection.getRange(),o=i.getClosedNode();if(n.fireEvent("beforeinsertimage",t)!==!0){if(!o||!/img/i.test(o.tagName)||"edui-faked-video"==o.className&&o.className.indexOf("edui-upload-video")==-1||o.getAttribute("word_img")){var r,a=[],s="";if(r=t[0],1==t.length)s='<img src="'+r.src+'" '+(r._src?' _src="'+r._src+'" ':"")+(r.floatStyle?'class="qyer_image" ':"")+(r.id?'data-id="'+r.id+'" ':"")+(r.width?'width="'+r.width+'" ':"")+(r.height?' height="'+r.height+'" ':"")+("left"==r.floatStyle||"right"==r.floatStyle?' style="float:'+r.floatStyle+';"':"")+(r.title&&""!=r.title?' title="'+r.title+'"':"")+(r.border&&"0"!=r.border?' border="'+r.border+'"':"")+(r.alt&&""!=r.alt?' alt="'+r.alt+'"':"")+(r.hspace&&"0"!=r.hspace?' hspace = "'+r.hspace+'"':"")+(r.vspace&&"0"!=r.vspace?' vspace = "'+r.vspace+'"':"")+("emotion"==r.type?"":"style='display:none;'  onload='imageLoad(this,"+r.id+",1)' onerror='imageLoad(this,"+r.id+",0)'")+"/>","center"==r.floatStyle&&(s='<p style="text-align: center">'+s+"</p>"),a.push(s);else for(var l=0;r=t[l++];)s="<p "+("center"==r.floatStyle?'style="text-align: center" ':"")+'><img src="'+r.src+'" '+(r.width?'width="'+r.width+'" ':"")+(r._src?' _src="'+r._src+'" ':"")+(r.height?' height="'+r.height+'" ':"")+' style="'+(r.floatStyle&&"center"!=r.floatStyle?"float:"+r.floatStyle+";":"")+(r.border||"")+'" '+(r.title?' title="'+r.title+'"':"")+" /></p>",a.push(s);n.execCommand("insertHtml",a.join(""))}else{var d=t.shift(),c=d.floatStyle;delete d.floatStyle,domUtils.setAttributes(o,d),n.execCommand("imagefloat",c),t.length>0&&(i.setStartAfter(o).setCursor(!1,!0),n.execCommand("insertimage",t))}n.fireEvent("afterinsertimage",t)}}}}},UE.plugins.insertimage_ext=function(){var e=this,t=(baidu.editor.dom.domUtils,baidu.editor.ui.uiUtils,null),n=function(e){e!==!0&&t.data("is_hover")||t.css({display:"none"})},i=function(e){var t=document.createElement("b");return t.innerHTML="<!--[if IE "+e+"]><i></i><![endif]-->",1===t.getElementsByTagName("i").length},o=i(9);e.addListener("beforeinsertimage",function(t,n){var i=n.length>0?n[0]:{},r=!1;if(!i.type||"emotion"!=i.type)return"noload"==i.type||o||e.execCommand("inserthtml",'<img class="phimage" id="'+i.id+'" data-pkey="'+i.id+'" src="//static.qyer.com/models/project/bbs/images/loading.gif" _src="'+i.src+'">'),$.ajax({url:BBS_Url.addAttach2ssdb,async:!1,data:{photoid:i.id,type:1},success:function(e){var e=JSON.parse(e);0!=e.error_code&&(r=!0)}}),r}),e.addListener("ready",function(){e.window.imageLoad=function(t,n,i){var o=$(e.document).find(".phimage[data-pkey="+n+"]");1==i?"emotion"==$(t).attr("data-id")?$(t).css("display","inline"):$(t).css("display",""):requirejs(["web_old_tip"],function(e){e.tip({text:"加载图片失败",type:"error"})}),0!=o.length&&o.remove(),e.fireEvent("contentchange")}}),e.addListener("keyup",function(e,t){var i=this,o=i.selection.getRange(),r=o.getClosedNode();8==t.keyCode&&r&&/img/i.test(r.tagName)&&n(!0)}),e.addListener("fullscreenchanged",function(){var t=$(".qyer_rotate_img_loading",e.document),n=$(e.document.body).css("padding");e.ui._fullscreen?t.css("left",parseInt(t.css("left"))+parseInt(n.split(" ")[1])-4):t.css("left",8)})},UE.plugin.register("qyerimgpopup",function(){var e=(baidu.editor.dom.domUtils,baidu.editor.utils),t=baidu.editor.ui.uiUtils,n=(baidu.editor.ui,baidu.editor.ui.Popup),i=baidu.editor.ui.QyerImgPopup=function(e){this.initOptions(e),this.initImgPopup()},o=0;i.prototype={uiName:"bbs_img_popup",upStatus:"",initImgPopup:function(){this.initPopup(),this.bindTargetDom(),this.initSelPhoto()},bindTargetDom:function(){var e=this;$(this.targetDom).on("click",function(){var n=t.getClientRect(this);e.showAt({left:n.left-40,top:n.top-80})})},initSelPhoto:function(){var e=this;requirejs(["old/js/bbs_selimage"],function(t){var n={showTitle:!1,showCancelBtn:!1,showOKBtn:!1,showCloseIcon:!1,editor:e.editor};e.selPhoto=new t(n)})},getContentHtmlTpl:function(){return'<ul><li><div id="imguploadwrap" class="imguploadWrapcla" style="position:relative;"><a href="javascript:;" id="uploadbtn" class="imgupload" onclick="$$._onClick(\'localupload\')">本地上传</a></div></li><li><a href="javascript:;" class="selphoto" onclick="$$._onClick(\'selphoto\')">相册选择</a></li></ul><div class="arrowDown"><span class="arrow1"></span><span class="arrow2"></span></div>'},initUpload:function(){var e=this;requirejs(["web_qui_quiupload","web_old_tip"],function(t,n){var i=[],r={},a="/photo.php?action=getUploadPhotoId&count=<%= count %>&album_id=<%= album_id %>",s=function(e){var t=r[e.id]||{};return t},l=function(e,t){var n=_.template(a)({count:e,album_id:t});return $.getJSON(n).then(function(e){return i=e.data})};e.upload=new t({browse_button:$(e.getDom()).find(".imgupload").get(0),container:$(e.getDom()).find(".imguploadWrapcla").get(0),multi_selection:!1,filters:[{extensions:"jpg,jpeg,png"}],max_file_size:"20mb",auto_start:!1,qyer_token_url:"/photo.php?action=token",token_format:function(e){return e.data.tk=e.data.token,e.data.domain="//pic.qyer.com",e},x_vars:{photo_id:function(e,t){return s(t).id.toString()},credit_jy:function(e,t){return((s(t).credit||{}).credit_jy||0).toString()},credit_qb:function(e,t){return((s(t).credit||{}).credit_qb||0).toString()},style:function(e,t){return""}},init:{FilesAdded:function(t,n){l(n.length,0).then(function(t){_.each(t,function(t,i){r[n[i].id]=t,n[i].key=t.key,n[i].photo_id=t.id,n[i].url=t.url,e.insertPlaceHolder(t.id)})}).then(function(){t.start()})},BeforeUpload:function(e,t){t.timer=+new Date;var n={source:"bbs",label:"photoUploadStart",uid:window.QYER.uid,fileId:t.photo_id,fileSize:t.origSize,url:encodeURIComponent(t.url),time:t.timer,uploadTime:0};$.get("/qcross/photo/trace/tc",n)},UploadProgress:function(e,t){},FileUploaded:function(t,n,i){var r=JSON.parse(i),a={source:"bbs",label:"photoUploadEnd",uid:window.QYER.uid,fileId:n.photo_id,fileSize:n.origSize,url:encodeURIComponent(n.url),time:+new Date,uploadTime:new Date-n.timer};$.get("/qcross/photo/trace/tc",a),e.editor.execCommand("insertimage",{src:r.data.photo.url,_src:r.data.photo.url,floatStyle:"left",id:r.data.photo.id,type:"noload"}),$(document).trigger("x-editDomInsert",o)},UploadError:function(e,t,i){n.tip({text:i,type:"error"})},Key:function(e,t){return s(t).key}}})})},onshow:function(){this.upload||this.initUpload()},insertPlaceHolder:function(e){this.editor.execCommand("inserthtml",'<img class="phimage" id="'+e+'" data-pkey="'+e+'" src="//static.qyer.com/models/project/bbs/images/loading.gif">')},_onClick:function(e){switch(e){case"localupload":o=document.body.scrollTop||document.documentElement.scrollTop,this.hide();break;case"selphoto":this.selPhoto.loadAlbumList(),this.selPhoto.show(),this.hide()}}},e.inherits(i,n)}),UE.plugins.qyer_video=function(){function e(e){var t=e.videoTitle.length>10?e.videoTitle.substring(0,10)+"...":e.videoTitle;return t=t.replace(/\"/g,"'").replace(/\</g,"&lt;").replace(/\>/g,"&gt;"),'<span class="qyer_block qyer_video" data-live="'+e.live+'" data-poster="'+e.poster+'"  data-title="'+e.videoTitle+'" data-videofrom="'+e.title+'"  contenteditable="false" data-url="'+e.url+'" data-videotitle="'+t+'" data-osrc="'+(e.src||"")+'"><a class="title fontSong"><span>'+t+"</span>&nbsp;&nbsp;-&nbsp;&nbsp;"+e.title+"视频</a></span>"}function t(t,n){utils.each(t.getNodesByTagName("span"),function(t){var n=(t.getAttr("class"),t.getAttr("data-type")),o=t.getAttr("data-src"),r=t.getAttr("data-poster"),a=t.getAttr("data-osrc"),s=t.getAttr("data-live"),l=t.getAttr("data-title")||t.getAttr("data-videotitle");if(n&&n.indexOf("video")!=-1){var d=o.match("([a-z1-9]*).com"),c=e({url:o,src:a,title:i[d[1]]||"",poster:r,live:s,videoTitle:l});t.parentNode.replaceChild(UE.uNode.createElement(c),t)}})}var n=this,i={youku:"优酷",youtube:"youtube",sina:"新浪",56:"我乐",pps:"PPS影音",letv:"乐视网",tudou:"土豆",qq:"腾讯",ku6:"酷6",sohu:"搜狐"};n.addInputRule(function(e){t(e)}),n.commands.insertvideo={execCommand:function(t,i){var o="";o=e(i),n.fireEvent("beforeinsertvideo"),n.execCommand("inserthtml",o),n.fireEvent("afterinsertvideo")}}},UE.plugin.register("insertfile",function(){function e(e){var t,e=e||0;return t=e<1048576?(e/1024).toFixed(2)+"KB":(e/1024/1024).toFixed(2)+"MB"}function t(t){var n=0===+e(t.size).replace(/[a-z]+/gi,"")?"":'<a class="size">'+e(t.size)+"</a>";return'<span class="qyer_block qyer_attach" contenteditable="false" data-key="'+t.key+'"><a class="name" data-bn-ipg="bbs-thread-attachment">'+t.name+"</a>"+n+"</span>"}var n=this;return baidu.editor.dom.domUtils,{commands:{insertfile:{execCommand:function(e,i){if(i=utils.isArray(i)?i:[i],n.fireEvent("beforeinsertfile",i)!==!0){var o,r,a="",s=n.getOpt("UEDITOR_HOME_URL");for(s+("/"==s.substr(s.length-1)?"":"/")+"dialogs/attachment/fileTypeImages/",o=0;o<i.length;o++)r=i[o],a=t(r);n.fireEvent("beforeinsertfile",i),n.execCommand("insertHtml",a),n.fireEvent("afterinsertfile",i)}}}}}}),UE.plugin.register("qyeremotion",function(){var e=(baidu.editor.dom.domUtils,baidu.editor.utils),t=(baidu.editor.ui.uiUtils,baidu.editor.ui.Popup),n=baidu.editor.ui.QyerEmotion=function(e){this.initOptions(e),this.initQyerEmotion()};n.prototype={uiName:"bbs_emotion",maxNum:30,baseUrl:"//static.qyer.com/models/project/bbs/css/images/face/",initQyerEmotion:function(){this.initPopup()},getContentHtmlTpl:function(){return'<div class="arrowUp"><span class="arrow1"></span><span class="arrow2"></span></div>'+this.getEmotionHtml()},getEmotionHtml:function(){for(var e,t=[],n=0;n<this.maxNum;n++)e=-26*n+"px",t.push("<a href='javascript:;' style='background-position:0 "+e+";' onclick=$$._onClick("+n+")></a>");return t.join("")},_onClick:function(e){var t={src:this.baseUrl+"face"+e+".png"};t._src=t.src,t.type="emotion",this.editor.execCommand("insertimage",t),this.hide()}},e.inherits(n,t)}),UE.plugin.register("stylecontrol",function(){function e(e){setTimeout(function(){if(browser.ie){var t=e.createTextRange();t.collapse(!1),t.select()}else e.focus()},0)}function t(e,t){if(n.getOpt("bbs_font")){var a,s,l,d,c,u="",p=n.selection.getRange();if(n.ui._dialogs,p.collapsed===!0)return void r.hide();a=p.startContainer,s=p.endContainer;var h=i.findParent(a,function(e){if(/qyer_block/gi.test(e.className))return e},!0),f=p.getClosedNode();if(!(h||f&&/qyer_image/gi.test(f.className))){var m=p.createBookmark(),g=o.getClientRect(m.start),b=o.getClientRect(m.end),v={};if(l=i.findParent(a,function(e){if(i.isBody(e.parentNode))return e},!0),d=i.findParent(s,function(e){if(i.isBody(e.parentNode))return e},!0),!l||!d)return void p.moveToBookmark(m);if(!u&&r._setContentHtml(),c=o.getClientRect(l),r.getDom().style.visibility="hidden",r.w=$(r.getDom()).width(),l===d)v={left:g.left+(b.left-g.left)/2-r.w/2-10,top:g.top-r.h-22};else{var y=o.getClientRect(this.document.body);v={left:y.left+y.width/2-r.w/2,top:g.top-r.h-22}}r.showAt(v),p.moveToBookmark(m)}}}var n=this,i=baidu.editor.dom.domUtils,o=(baidu.editor.utils,baidu.editor.ui.uiUtils),r=new baidu.editor.ui.Popup({editor:n,content:"",className:"edui-fontstyle",h:52,_bold:function(){n.execCommand("bold"),this.hide(),n.selection.getRange().select()},_paragraph:function(e){var t=n.queryCommandValue("Paragraph");switch(t){case"p":break;case"h1":case"h2":e==t&&(e="p")}var i=n.selection.getRange(),o=i.getCommonAncestor(!0,!0),r=$(o).find(".qyer_image");r.css("display","inline"),n.execCommand("Paragraph",e),r.css("display","block"),this.hide(),i.select()},_execColor:function(e){n.execCommand("forecolor",e),this.hide(),n.selection.getRange().select()},_color:function(){a.showColor()},_link:function(){a.showLink()},_setContentHtml:function(){this.getDom("content").innerHTML=a.getHtml(),a.dom=$(this.getDom("fontcontrol")),setTimeout(function(){a.queryStyle()},0)},queryAutoHide:function(e){return e&&e.ownerDocument==n.document&&("img"==e.tagName.toLowerCase()||i.findParentByTagName(e,"a",!0))?e!==r.anchorEl:baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});r.render();var a={className:"edit_font_box",modelList:{},sort:["Bold","Color","|","Title1","Title2","Text","|","Link"],popup:r};a.models={},a.Base={status:0,getHtml:function(){return'<a href="javascript:;" class="'+this.className+'" title="'+this.label+'" onclick="'+this.command+'">'+this.label+"</a>"},queryStatus:function(){var e=i.filterNodeList(n.selection.getStartElementPath(),this.commandName),t=a.dom.find("."+this.className);e?t.addClass(this.activeClass):t.removeClass(this.activeClass)}},a.models.Bold=function(){this.label="加粗",this.className="weight",this.command="$$._bold()",this.commandName="bold",this.activeClass="weight_active",$.extend(this,a.Base),this.queryStatus=function(){var e=n.queryCommandState(this.commandName);if(e!=this.status){this.status=e;var t=a.dom.find("."+this.className);1==this.status?t.addClass(this.activeClass):t.removeClass(this.activeClass)}}},a.models.Color=function(){this.label="颜色",this.className="color",this.command="$$._color()",this.commandName="forecolor",this.colorList=["#323232","#636363","#ff0f00","#ff8d00","#818100","#308b50","#038081","#3d67e9","#000086","#7f0085","#4a0088","#8b0400"],this.defColor="#636363",this.noColor=["#636363","#323232"],$.extend(this,a.Base),this.getHtml=function(){return'<a href="javascript:;" class="'+this.className+'" title="'+this.label+'" onclick="'+this.command+'"><span class="default">'+this.label+"</span></a>"},this.getInputHtml=function(){for(var e,t=['<div class="text_color clearfix">'],n=new RegExp(this.defColor,"ig"),i=0;e=this.colorList[i++];)t.push('<a href="javascript:;" '+(null!=n.exec(e)?"class='active'":"")+' title="" style="background:'+e+'" onclick="$$._execColor(\''+e+"')\"></a>");return t.push("</div>"),t.join("")},this.queryStatus=function(){var e=a.dom.find("."+this.className),t=n.queryCommandValue(this.commandName);this.inArray(t,this.colorList)!=-1&&(this.defColor=t,e.find("span").css({"border-bottom-color":t}))},this.inArray=function(e,t){for(var n,i=-1,o=new RegExp(e,"ig"),r=0;n=t[r++];)null!=o.exec(n)&&(i=r);return i}},a.models.Link=function(){this.label="超链接",this.className="link",this.command="$$._link()",this.commandName="link",$.extend(this,a.Base),this.queryStatus=function(){},this.getInputHtml=function(){return'<div class="linkInput"><input type="text" class="ipt_link" value="" placeholder="粘贴超链接地址"><div class="icon_tips"><span class="enter" title=""></span></div></div>'}},a.models.Title1=function(){this.label="标题1",this.className="title1",this.command="$$._paragraph('h1')",this.commandName="h1",this.activeClass="title1_active",$.extend(this,a.Base)},a.models.Title2=function(){this.label="标题2",this.className="title2",this.command="$$._paragraph('h2')",this.commandName="h2",this.activeClass="title2_active",$.extend(this,a.Base)},a.models.Text=function(){this.label="正文",this.className="text",this.command="$$._paragraph('p')",this.commandName="p",this.activeClass="text_active",$.extend(this,a.Base)},a.models.Separate=function(){this.label="&nbsp;",this.className="line",$.extend(this,a.Base),this.command="",this.queryStyle=function(){},this.queryStatus=function(){}},a.showColor=function(){var e=$(this.dom).find("p"),t=this.modelList.Color.getInputHtml();t=this.popup.formatHtml(t),$(t).insertBefore(e),r.fitSize(),e.hide()},a.showLink=function(){function t(e){function t(e,t){e=e.replace(/^\s+|\s+$/g,"");for(var n,i=0;n=t[i++];)if(0==e.indexOf(n))return!0;return!1}var i=["http:","https:","#","/","ftp:","mailto:","tel:"],o="^((https|http|ftp|rtsp|mms)://)?[a-z0-9A-Z]{3}.[a-z0-9A-Z][a-z0-9A-Z]{0,61}?[a-z0-9A-Z].com|net|cn|cc (:s[0-9]{1-4})?/$",a=(new RegExp(o),e.replace(/^\s+|\s+$/g,""));if(l.select(),a){t(a,i)||(a="http://"+a);var s={href:a,target:"_blank",title:a,_href:a};n.execCommand("link",s),r.hide()}else n.execCommand("unlink"),r.hide()}var o,r=this,a=$(this.dom).find("p"),s=this.modelList.Link.getInputHtml();s=this.popup.formatHtml(s);var l=n.selection.getRange(),d=l.collapsed?n.queryCommandValue("link"):n.selection.getStart();d=i.findParentByTagName(d,"a",!0),$(s).insertBefore(a),o=$(this.dom).find("input"),o.val(d?$(d).attr("href")||$(d).attr("_href"):""),""!=o.val()&&o.siblings().find("span").removeClass("enter").addClass("delete"),e(o.get(0)),this.dom.undelegate().delegate(".icon_tips span","click",function(){var e=$(this);"delete"==$.trim(e.attr("class"))?(o.val(""),this.className="enter",n.execCommand("unlink")):t(o.val())}),o.unbind().on("keydown",function(e){13==e.keyCode?t($(this).val()):r.dom.find(".icon_tips span").get(0).className="enter"}),a.hide()},a.getHtml=function(){var e,t=['<div class="'+this.className+' edit_font_box_down" id="##_fontcontrol">'];t.push('<p class="enable clearfix">'),r="";var o=i.filterNodeList(n.selection.getStartElementPath(),"h1 h2"),r="";o&&/(h1|h2)/.test(o.tagName)!=-1&&(r="Bold");for(var a,s=0;a=this.sort[s++];)a!=r&&("|"==a?(a="Separate",e=new this.models.Separate):e=new this.models[a],t.push(e.getHtml()),this.modelList[a]=e);return t.push('</p><span class="arrow"></span></div>'),this.popup.formatHtml(t.join(""))},a.hide=function(){this.popup.hide()},a.queryStyle=function(){for(var e in this.modelList)"|"==e&&(e="Separate"),this.modelList[e].queryStatus()},n.addListener("keyup",t),n.addListener("selectionchange",t)}),UE.plugins.bbs_common=function(){var e=this,t=baidu.editor.dom.domUtils;e.addListener("click",function(e,n){var i,o=n.target||n.srcElement;1==/close/gi.test(o.className)&&(i=t.findParent(o,function(e){if(1==/phimage/gi.test(e.className))return e}),i&&t.remove(i))}),e.addListener("afterinsertvideo afterinsertfile",function(){var n,i=e.selection.getRange(),o=e.document,r=o.createElement("p");n=t.findParent(i.startContainer,function(e){if(t.isBody(e.parentNode))return e},!0),t.insertAfter(n,r),t.fillNode(o,r),i.selectNode(r).shrinkBoundary().setCursor().select()}),e.addListener("beforeinsertvideo beforeinsertfile",function(){var n,i=e.selection.getRange(),o=e.document,r=o.createElement("p");n=t.findParent(i.startContainer,function(e){if(t.isBody(e.parentNode))return e},!0),0==t.isEmptyNode(n)&&(t.insertAfter(n,r),i.selectNode(r).shrinkBoundary().setCursor().select())}),e.addListener("selectionchange",function(){var n,i,o=e.selection.getRange(),r=o.startContainer;n=t.findParent(r,function(e){if(t.isBody(e.parentNode))return e},!0),t.getElementsByTagName(n,"span",function(r){if(/qyer_video|qyer_attach/gi.test(r.className))return i=n.nextSibling,i||(i=e.document.createElement("p"),t.insertAfter(n,i)),void o.selectNode(i).shrinkBoundary().setCursor().select()})}),e.addListener("keydown",function(n,i){var o=i.keyCode||i.which,r=e.selection.getRange();if((46==o||browser.mac&&8==o)&&1==r.collapsed){var a,s=r.startContainer,l=/qyer_video|qyer_attach/gi,d=t.findParent(s,function(e){
if(t.isBody(e.parentNode))return e},!0);a=d.previousSibling,!a||s.previousSibling&&!/p/gi.test(s.tagName)||0!=r.startOffset||a.firstChild&&l.test(a.firstChild.className)&&(e.fireEvent("saveScene"),t.remove(a))}i.metaKey&&83==o&&(t.preventDefault(i),e.fireEvent("saveScene"))}),e.addListener("aftergetcontent",function(n,i,o){e.getOpt("isSubmit")&&(utils.each(o.getNodesByTagName("img"),function(e){var n=e.getAttr("class");if(n&&n.indexOf("qyer_image")!=-1){var i='<span data-type="photo" data-id="'+e.getAttr("data-id")+'"></span>';t.insertAfter(e,UE.uNode.createElement("<br/>")),e.parentNode.replaceChild(UE.uNode.createElement(i),e)}n&&n.indexOf("phimage")!=-1&&(t.insertAfter(e,UE.uNode.createElement("<br/>")),t.remove(e))}),utils.each(o.getNodesByTagName("span"),function(e){var n=e.getAttr("class");if(n&&n.indexOf("qyer_video")!=-1){var i=e.getAttr("data-videotitle"),o=e.getAttr("data-title"),r=e.getAttr("data-videofrom"),a=e.getAttr("data-poster")||"",s=e.getAttr("data-live")||"",l='<span data-type="video" data-live="'+s+'"  data-title="'+o+'" data-videofrom="'+r+'" data-poster="'+a+'" data-src="'+e.getAttr("data-url")+'" data-videotitle="'+i+'" data-osrc="'+e.getAttr("data-osrc")+'"></span>';t.insertAfter(e,UE.uNode.createElement("<br/>")),e.parentNode.replaceChild(UE.uNode.createElement(l),e)}}),utils.each(o.getNodesByTagName("span"),function(e){var t=e.getAttr("class"),n=e.getAttr("data-key"),i=e.getAttr("data-id");if(t&&t.indexOf("qyer_attach")!=-1){var o=n?"data-key="+n:i?"data-id="+i:"",r='<span data-type="attach" '+o+"></span>";e.parentNode.replaceChild(UE.uNode.createElement(r),e)}}))}),e.addInputRule(function(e){utils.each(e.getNodesByTagName("br"),function(e){var t=e.parentNode.children;1!=t.length&&(e.tagName="p",e.attrs={})})}),e.addInputRule(function(e){var t=/(color:.*?)(?:;|$)/i,n=/(font-weight:.*?)(?:;|$)/i;utils.each("span strong".split(" "),function(i){utils.each(e.getNodesByTagName(i),function(e){var i=e.getAttr("style")||"",o=i.match(t)||[],r=i.match(n)||[],a=o[1]||"",s=r[1]||"",l=[a,s].join("; ");e.setAttr("style",l)})})})};var baidu=baidu||{};baidu.editor=baidu.editor||{},UE.ui=baidu.editor.ui={},function(){function e(){var e=document.getElementById("edui_fixedlayer");l.setViewportOffset(e,{left:0,top:0})}function t(t){i.on(window,"scroll",e),i.on(window,"resize",baidu.editor.utils.defer(e,0,!0))}var n=baidu.editor.browser,i=baidu.editor.dom.domUtils,o="$EDITORUI",r=window[o]={},a="ID"+o,s=0,l=baidu.editor.ui.uiUtils={uid:function(e){return e?e[a]||(e[a]=++s):++s},hook:function(e,t){var n;return e&&e._callbacks?n=e:(n=function(){var t;e&&(t=e.apply(this,arguments));for(var i=n._callbacks,o=i.length;o--;){var r=i[o].apply(this,arguments);void 0===t&&(t=r)}return t},n._callbacks=[]),n._callbacks.push(t),n},createElementByHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return n.ie&&n.quirks?document.body:document.documentElement},getClientRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(n){t={left:0,top:0,height:0,width:0}}for(var o,r={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(o=e.ownerDocument)!==document&&(e=i.getWindow(o).frameElement);)t=e.getBoundingClientRect(),r.left+=t.left,r.top+=t.top;return r.bottom=r.top+r.height,r.right=r.left+r.width,r},getViewportRect:function(){var e=l.getViewportElement(),t=0|(window.innerWidth||e.clientWidth),n=0|(window.innerHeight||e.clientHeight);return{left:0,top:0,height:n,width:t,bottom:n,right:t}},setViewportOffset:function(e,t){var n=l.getFixedLayer();e.parentNode===n?(e.style.left=t.left+"px",e.style.top=t.top+"px"):i.setViewportOffset(e,t)},getEventOffset:function(e){var t=e.target||e.srcElement,n=l.getClientRect(t),i=l.getViewportOffsetByEvent(e);return{left:i.left-n.left,top:i.top-n.top}},getViewportOffsetByEvent:function(e){var t=e.target||e.srcElement,n=i.getWindow(t).frameElement,o={left:e.clientX,top:e.clientY};if(n&&t.ownerDocument!==document){var r=l.getClientRect(n);o.left+=r.left,o.top+=r.top}return o},setGlobal:function(e,t){return r[e]=t,o+'["'+e+'"]'},unsetGlobal:function(e){delete r[e]},copyAttributes:function(e,t){for(var o=t.attributes,r=o.length;r--;){var a=o[r];"style"==a.nodeName||"class"==a.nodeName||n.ie&&!a.specified||e.setAttribute(a.nodeName,a.nodeValue)}t.className&&i.addClass(e,t.className),t.style.cssText&&(e.style.cssText+=";"+t.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&e!==t&&(e.contains?e.contains(t):16&e.compareDocumentPosition(t))},startDrag:function(e,t,n){function i(e){var n=e.clientX-a,i=e.clientY-s;t.ondragmove(n,i,e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function o(e){n.removeEventListener("mousemove",i,!0),n.removeEventListener("mouseup",o,!0),window.removeEventListener("mouseup",o,!0),t.ondragstop()}function r(){l.releaseCapture(),l.detachEvent("onmousemove",i),l.detachEvent("onmouseup",r),l.detachEvent("onlosecaptrue",r),t.ondragstop()}var n=n||document,a=e.clientX,s=e.clientY;if(n.addEventListener)n.addEventListener("mousemove",i,!0),n.addEventListener("mouseup",o,!0),window.addEventListener("mouseup",o,!0),e.preventDefault();else{var l=e.srcElement;l.setCapture(),l.attachEvent("onmousemove",i),l.attachEvent("onmouseup",r),l.attachEvent("onlosecaptrue",r),e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var i=document.getElementById("edui_fixedlayer");return null==i&&(i=document.createElement("div"),i.id="edui_fixedlayer",document.body.appendChild(i),n.ie&&n.version<=8?(i.style.position="absolute",t(),setTimeout(e)):i.style.position="fixed",i.style.left="0",i.style.top="0",i.style.width="0",i.style.height="0"),i},makeUnselectable:function(e){if(n.opera||n.ie&&n.version<9){if(e.unselectable="on",e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)1==e.childNodes[t].nodeType&&l.makeUnselectable(e.childNodes[t])}else void 0!==e.style.MozUserSelect?e.style.MozUserSelect="none":void 0!==e.style.WebkitUserSelect?e.style.WebkitUserSelect="none":void 0!==e.style.KhtmlUserSelect&&(e.style.KhtmlUserSelect="none")}}}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.EventBase,i=baidu.editor.ui.UIBase=function(){};i.prototype={className:"",uiName:"",initOptions:function(e){var n=this;for(var i in e)n[i]=e[i];this.id=this.id||"edui"+t.uid()},initUIBase:function(){this._globalKey=e.unhtml(t.setGlobal(this.id,this))},render:function(e){for(var n,i=this.renderHtml(),o=t.createElementByHtml(i),r=domUtils.getElementsByTagName(o,"*"),a="edui-"+(this.theme||this.editor.options.theme),s=document.getElementById("edui_fixedlayer"),l=0;n=r[l++];)domUtils.addClass(n,a);domUtils.addClass(o,a),s&&(s.className="",domUtils.addClass(s,a));var d=this.getDom();null!=d?(d.parentNode.replaceChild(o,d),t.copyAttributes(o,d)):("string"==typeof e&&(e=document.getElementById(e)),e=e||t.getFixedLayer(),domUtils.addClass(e,a),e.appendChild(o)),this.postRender()},getDom:function(e){return e?document.getElementById(this.id+"_"+e):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();e&&baidu.editor.dom.domUtils.remove(e),t.unsetGlobal(this.id)}},e.inherits(i,n)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Separator=function(e){this.initOptions(e),this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},e.inherits(n,t)}(),function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.UIBase,i=baidu.editor.ui.uiUtils,o=baidu.editor.ui.Mask=function(e){this.initOptions(e),this.initUIBase()};o.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;t.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_onClick:function(e,t){this.fireEvent("click",e,t)},_fill:function(){var e=this.getDom(),t=i.getViewportRect();e.style.width=t.width+"px",e.style.height=t.height+"px"}},e.inherits(o,n)}(),function(){function e(e,t){for(var n=0;n<a.length;n++){var i=a[n];if(!i.isHidden()&&i.queryAutoHide(t)!==!1){if(e&&/scroll/gi.test(e.type)&&"edui-wordpastepop"==i.className)return;i.hide()}}a.length&&i.editor.fireEvent("afterhidepop")}var t=baidu.editor.utils,n=baidu.editor.ui.uiUtils,i=baidu.editor.dom.domUtils,o=baidu.editor.ui.UIBase,r=baidu.editor.ui.Popup=function(e){this.initOptions(e),this.initPopup()},a=[];r.postHide=e;var s=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];r.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),a.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" > <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?"string"==typeof this.content?this.content:this.content.renderHtml():""},_UIBase_postRender:o.prototype.postRender,postRender:function(){if(this.content instanceof o&&this.content.postRender(),this.captureWheel&&!this.captured){this.captured=!0;var e=(document.documentElement.clientHeight||document.body.clientHeight)-80,t=this.getDom().offsetHeight,r=n.getClientRect(this.combox.getDom()).top,a=this.getDom("content"),s=this.getDom("body").getElementsByTagName("iframe"),l=this;for(s.length&&(s=s[0]);r+t>e;)t-=30;a.style.height=t+"px",s&&(s.style.height=t+"px"),window.XMLHttpRequest?i.on(a,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,e.wheelDelta?a.scrollTop-=e.wheelDelta/120*60:a.scrollTop-=e.detail/-3*60}):i.on(this.getDom(),"mousewheel",function(e){e.returnValue=!1,l.getDom("content").scrollTop-=e.wheelDelta/120*60})}this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return n.getClientRect(e)},fitSize:function(){if(this.captureWheel&&this.sized)return this.__size;this.sized=!0;var e=this.getDom("body");e.style.width="",e.style.height="";var t=this.mesureSize();if(this.captureWheel){e.style.width=-(-20-t.width)+"px";var n=parseInt(this.getDom("content").style.height,10);!window.isNaN(n)&&(t.height=n)}else e.style.width=t.width+"px";return e.style.height=t.height+"px",this.__size=t,this.captureWheel&&(this.getDom("content").style.overflow="auto"),t},showAnchor:function(e,t){this.showAnchorRect(n.getClientRect(e),t)},showAnchorRect:function(e,t,o){this._doAutoRender();var r=n.getViewportRect();this.getDom().style.visibility="hidden",this._show();var a,l,d,c,u=this.fitSize();t?(a=this.canSideLeft&&e.right+u.width>r.right&&e.left>u.width,l=this.canSideUp&&e.top+u.height>r.bottom&&e.bottom>u.height,d=a?e.left-u.width:e.right,c=l?e.bottom-u.height:e.top):(a=this.canSideLeft&&e.right+u.width>r.right&&e.left>u.width,l=this.canSideUp&&e.top+u.height>r.bottom&&e.bottom>u.height,d=a?e.right-u.width:e.left,c=l?e.top-u.height:e.bottom);var p=this.getDom();n.setViewportOffset(p,{left:d,top:c}),i.removeClasses(p,s),p.className+=" "+s[2*(l?1:0)+(a?1:0)],this.editor&&(p.style.zIndex=1*this.editor.container.style.zIndex+10,baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=p.style.zIndex-1),this.getDom().style.visibility="visible"},showAt:function(e){var t=e.left,n=e.top,i={left:t,top:n,right:t,bottom:n,height:0,width:0};this.showAnchorRect(i,!1,!0)},_show:function(){if(this._hidden){var e=this.getDom();e.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(e){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,e||this.fireEvent("hide"))},queryAutoHide:function(e){return!e||!n.contains(this.getDom(),e)}},t.inherits(r,o),i.on(document,"mousedown",function(t){var n=t.target||t.srcElement;e(t,n)}),i.on(window,"scroll",function(t,n){e(t,n)})}(),function(){var e=baidu.editor.browser,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,i='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(e.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return i})},Stateful_onMouseEnter:function(e,t){this.target=t,this.isDisabled()&&!this.alwalysHoverable||(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(e,t){this.isDisabled()&&!this.alwalysHoverable||(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(e,t){var i=e.relatedTarget;n.contains(t,i)||t===i||this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var i=e.relatedTarget;n.contains(t,i)||t===i||this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(e,t){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(e,t){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return t.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&t.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){e?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Stateful,i=baidu.editor.ui.Button=function(e){if(e.name){var t=e.name,n=e.cssRules;e.className||(e.className="edui-for-"+t),e.cssRules=".edui-"+(e.theme||"default")+" .edui-toolbar .edui-button.edui-for-"+t+" .edui-icon {"+n+"}"}this.initOptions(e),this.initButton()};i.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase(),this.Stateful_init(),this.cssRules&&e.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onMouseDown:function(e){var t=e.target||e.srcElement,n=t&&t.tagName&&t.tagName.toLowerCase();if("input"==n||"object"==n||"object"==n)return!1},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(e){var t=this.getDom("label");t.innerHTML=e}},e.inherits(i,t),e.extend(i.prototype,n)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,i=baidu.editor.ui.Toolbar=function(e){this.initOptions(e),this.initToolbar()};i.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(e,t){void 0===t?this.items.push(e):this.items.splice(t,0,e)},getHtmlTpl:function(){for(var e=[],t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){for(var e=this.getDom(),n=0;n<this.items.length;n++)this.items[n].postRender();t.makeUnselectable(e)},_onMouseDown:function(e){var t=e.target||e.srcElement,n=t&&t.tagName&&t.tagName.toLowerCase();if("input"==n||"object"==n||"object"==n)return!1}},e.inherits(i,n)}(),function(){var e,t,n,i=baidu.editor.utils,o=baidu.editor.dom.domUtils,r=baidu.editor.ui.uiUtils,a=baidu.editor.ui.Mask,s=baidu.editor.ui.UIBase,l=baidu.editor.ui.Button,d=baidu.editor.ui.Dialog=function(e){if(e.name){var t=e.name,n=e.cssRules;e.className||(e.className="edui-for-"+t),n&&(e.cssRules=".edui-default .edui-for-"+t+" .edui-dialog-content  {"+n+"}")}this.initOptions(i.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(e,t){return t?this.onok():this.oncancel()},holdScroll:!1},e)),this.initDialog()};d.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var o=this,r=this.editor.options.theme;if(this.cssRules&&i.cssRule("edui-customize-"+this.name+"-style",this.cssRules),this.initUIBase(),this.modalMask=e||(e=new a({className:"edui-dialog-modalmask",theme:r,onclick:function(){n&&n.close(!1)}})),this.dragMask=t||(t=new a({className:"edui-dialog-dragmask",theme:r})),this.closeButton=new l({className:"edui-dialog-closebutton",title:o.closeDialog,theme:r,onclick:function(){o.close(!1)}}),this.fullscreen&&this.initResizeEvent(),this.buttons)for(var s=0;s<this.buttons.length;s++)this.buttons[s]instanceof l||(this.buttons[s]=new l(i.extend(this.buttons[s],{editor:this.editor},!0)))},initResizeEvent:function(){var e=this;o.on(window,"resize",function(){e._hidden||void 0===e._hidden||(e.__resizeTimer&&window.clearTimeout(e.__resizeTimer),e.__resizeTimer=window.setTimeout(function(){e.__resizeTimer=null;var t=e.getDom(),n=e.getDom("content"),i=UE.ui.uiUtils.getClientRect(t),o=UE.ui.uiUtils.getClientRect(n),a=r.getViewportRect();n.style.width=a.width-i.width+o.width+"px",n.style.height=a.height-i.height+o.height+"px",t.style.width=a.width+"px",t.style.height=a.height+"px",e.fireEvent("resize")},100))})},fitSize:function(){var e=this.getDom("body"),t=this.mesureSize();return e.style.width=t.width+"px",e.style.height=t.height+"px",t},safeSetOffset:function(e){var t=this,n=t.getDom(),i=r.getViewportRect(),o=r.getClientRect(n),a=e.left;a+o.width>i.right&&(a=i.right-o.width);var s=e.top;s+o.height>i.bottom&&(s=i.bottom-o.height),n.style.left=Math.max(a,0)+"px",n.style.top=Math.max(s,0)+"px"},showAtCenter:function(){var e=r.getViewportRect();if(this.fullscreen){var t=this.getDom(),n=this.getDom("content");t.style.display="block";var i=UE.ui.uiUtils.getClientRect(t),a=UE.ui.uiUtils.getClientRect(n);t.style.left="-100000px",n.style.width=e.width-i.width+a.width+"px",n.style.height=e.height-i.height+a.height+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.left=0,this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}},document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden"}else{this.getDom().style.display="";var s=this.fitSize(),l=0|this.getDom("titlebar").offsetHeight,d=e.width/2-s.width/2,c=e.height/2-(s.height-l)/2-l,u=this.getDom();this.safeSetOffset({left:Math.max(0|d,0),top:Math.max(0|c,0)}),o.hasClass(u,"edui-state-centered")||(u.className+=" edui-state-centered")}this._show()},getContentHtml:function(){var e="";return"string"==typeof this.content?e=this.content:this.iframeUrl&&(e='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),e},getHtmlTpl:function(){var e="";if(this.buttons){for(var t=[],n=0;n<this.buttons.length;n++)t[n]=this.buttons[n].renderHtml();e='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+t.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+e+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var e=this;if(this.addListener("show",function(){e.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){e.modalMask.hide()}),this.buttons)for(var t=0;t<this.buttons.length;t++)this.buttons[t].postRender();o.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e.safeSetOffset(r.getClientRect(e.getDom()))})}),this._hide()},mesureSize:function(){var e=this.getDom("body"),t=r.getClientRect(this.getDom("content")).width,n=e.style;return n.width=t,r.getClientRect(e)},_onTitlebarMouseDown:function(e,t){if(this.draggable){var n,i=(r.getViewportRect(),this);r.startDrag(e,{ondragstart:function(){n=r.getClientRect(i.getDom()),i.getDom("contmask").style.visibility="visible",i.dragMask.show(i.getDom().style.zIndex-1)},ondragmove:function(e,t){var o=n.left+e,r=n.top+t;i.safeSetOffset({left:o,top:r})},ondragstop:function(){i.getDom("contmask").style.visibility="hidden",o.removeClasses(i.getDom(),["edui-state-centered"]),i.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var e=this.getDom();e.style.display="none",e.style.zIndex="",e.style.width="",e.style.height="",this._hidden=!0,this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(e){this.render(),this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(t){}n=this},_onCloseButtonClick:function(e,t){this.close(!1)},close:function(e){if(this.fireEvent("close",e)!==!1){this.fullscreen&&(document.documentElement.style.overflowX=this._originalContext.html.overflowX,document.documentElement.style.overflowY=this._originalContext.html.overflowY,document.body.style.overflowX=this._originalContext.body.overflowX,document.body.style.overflowY=this._originalContext.body.overflowY,delete this._originalContext),this._hide();var t=this.getDom("content"),n=this.getDom("iframe");if(t&&n){var i=n.contentDocument||n.contentWindow.document;i&&(i.body.innerHTML=""),o.remove(t)}}}},i.inherits(d,s)}(),function(){function e(e){var t=e.target||e.srcElement,n=a.findParent(t,function(e){return a.hasClass(e,"edui-shortcutmenu")||a.hasClass(e,"edui-popup")},!0);if(!n)for(var i,o=0;i=s[o++];)i.hide()}var t,n=baidu.editor.ui,i=n.UIBase,o=n.uiUtils,r=baidu.editor.utils,a=baidu.editor.dom.domUtils,s=[],l=!1,d=n.ShortCutMenu=function(e){this.initOptions(e),this.initShortCutMenu()};d.postHide=e,d.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[],this.initUIBase(),this.initItems(),this.initEvent(),s.push(this)},initEvent:function(){var e=this,n=e.editor.document;a.on(n,"mousemove",function(n){if(e.isHidden===!1){if(e.getSubMenuMark()||"contextmenu"==e.eventType)return;var i=!0,o=e.getDom(),r=o.offsetWidth,a=o.offsetHeight,s=r/2+e.SPACE,l=a/2,d=Math.abs(n.screenX-e.left),c=Math.abs(n.screenY-e.top);clearTimeout(t),t=setTimeout(function(){c>0&&c<l?e.setOpacity(o,"1"):c>l&&c<l+70?(e.setOpacity(o,"0.5"),i=!1):c>l+70&&c<l+140&&e.hide(),i&&d>0&&d<s?e.setOpacity(o,"1"):d>s&&d<s+70?e.setOpacity(o,"0.5"):d>s+70&&d<s+140&&e.hide()})}}),browser.chrome&&a.on(n,"mouseout",function(t){var n=t.relatedTarget||t.toElement;null!=n&&"HTML"!=n.tagName||e.hide()}),e.editor.addListener("afterhidepop",function(){e.isHidden||(l=!0)})},initItems:function(){if(r.isArray(this.items))for(var e=0,t=this.items.length;e<t;e++){var i=this.items[e].toLowerCase();n[i]&&(this.items[e]=new n[i](this.editor),this.items[e].className+=" edui-shortcutsubmenu ")}},setOpacity:function(e,t){browser.ie&&browser.version<9?e.style.filter="alpha(opacity = "+100*parseFloat(t)+");":e.style.opacity=t},getSubMenuMark:function(){l=!1;for(var e,t=o.getFixedLayer(),n=a.getElementsByTagName(t,"div",function(e){return a.hasClass(e,"edui-shortcutsubmenu edui-popup")}),i=0;e=n[i++];)"none"!=e.style.display&&(l=!0);return l},show:function(e,t){function n(e){e.left<0&&(e.left=0),e.top<0&&(e.top=0),l.style.cssText="position:absolute;left:"+e.left+"px;top:"+e.top+"px;"}function i(e){e.tagName||(e=e.getDom()),s.left=parseInt(e.style.left),s.top=parseInt(e.style.top),s.top-=l.offsetHeight+15,n(s)}var r=this,s={},l=this.getDom(),d=o.getFixedLayer();if(r.eventType=e.type,l.style.cssText="display:block;left:-9999px","contextmenu"==e.type&&t){var c=a.getElementsByTagName(d,"div","edui-contextmenu")[0];c?i(c):r.editor.addListener("aftershowcontextmenu",function(e,t){i(t)})}else s=o.getViewportOffsetByEvent(e),s.top-=l.offsetHeight+r.SPACE,s.left+=r.SPACE+20,n(s),r.setOpacity(l,.2);r.isHidden=!1,r.left=e.screenX+l.offsetWidth/2-r.SPACE,r.top=e.screenY-l.offsetHeight/2-r.SPACE,r.editor&&(l.style.zIndex=1*r.editor.container.style.zIndex+10,d.style.zIndex=l.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none"),this.isHidden=!0},postRender:function(){if(r.isArray(this.items))for(var e,t=0;e=this.items[t++];)e.postRender()},getHtmlTpl:function(){var e;if(r.isArray(this.items)){e=[];for(var t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();e=e.join("")}else e=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+e+"</div>"}},r.inherits(d,i),a.on(document,"mousedown",function(t){e(t)}),a.on(window,"scroll",function(t){e(t)})}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui,n=t.Dialog;t.buttons={},t.Dialog=function(e){var t=new n(e);return t.addListener("hide",function(){if(t.editor){var e=t.editor;try{if(browser.gecko){var n=e.window.scrollY,i=e.window.scrollX;e.body.focus(),e.window.scrollTo(i,n)}else e.focus()}catch(o){}}}),t};for(var i,o={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},r=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],a=0;i=r[a++];)i=i.toLowerCase(),t[i]=function(e){return function(n){var i=new t.Button({className:"edui-for-"+e,title:n.options.labelMap[e]||n.getLang("labelMap."+e)||"",onclick:function(){n.execCommand(e)},theme:n.options.theme,showText:!1});return t.buttons[e]=i,n.addListener("selectionchange",function(t,o,r){var a=n.queryCommandState(e);a==-1?(i.setDisabled(!0),i.setChecked(!1)):r||(i.setDisabled(!1),i.setChecked(a))}),i}}(i);t.cleardoc=function(e){var n=new t.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});return t.buttons.cleardoc=n,e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("cleardoc")==-1)}),n};var s={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var l in s)!function(e,n){for(var i,o=0;i=n[o++];)!function(n){t[e.replace("float","")+n]=function(i){var o=new t.Button({className:"edui-for-"+e.replace("float","")+n,title:i.options.labelMap[e.replace("float","")+n]||i.getLang("labelMap."+e.replace("float","")+n)||"",theme:i.options.theme,onclick:function(){i.execCommand(e,n)}});return t.buttons[e]=o,i.addListener("selectionchange",function(t,r,a){o.setDisabled(i.queryCommandState(e)==-1),o.setChecked(i.queryCommandValue(e)==n&&!a)}),o}}(i)}(l,s[l]);for(var i,a=0;i=["backcolor","forecolor"][a++];)t[i]=function(e){return function(n){var i=new t.ColorButton({className:"edui-for-"+e,color:"default",title:n.options.labelMap[e]||n.getLang("labelMap."+e)||"",editor:n,onpickcolor:function(t,i){n.execCommand(e,i)},onpicknocolor:function(){n.execCommand(e,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){n.execCommand(e,this.color)}});return t.buttons[e]=i,n.addListener("selectionchange",function(){i.setDisabled(n.queryCommandState(e)==-1)}),i}}(i);var d={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(var l in d)!function(n,i){for(var r,a=0;r=i[a++];)browser.opera&&"searchreplace"===r||!function(i){
t[i]=function(r,a,s){a=a||(r.options.iframeUrlMap||{})[i]||o[i],s=r.options.labelMap[i]||r.getLang("labelMap."+i)||"";var l;a&&(l=new t.Dialog(e.extend({iframeUrl:r.ui.mapUrl(a),editor:r,className:"edui-for-"+i,title:s,holdScroll:"insertimage"===i,fullscreen:/charts|preview/.test(i),closeDialog:r.getLang("closeDialog")},"ok"==n?{buttons:[{className:"edui-okbutton",label:r.getLang("ok"),editor:r,onclick:function(){l.close(!0)}},{className:"edui-cancelbutton",label:r.getLang("cancel"),editor:r,onclick:function(){l.close(!1)}}]}:{})),r.ui._dialogs[i+"Dialog"]=l);var d=new t.Button({className:"edui-for-"+i,title:s,onclick:function(){if(l)switch(i){case"wordimage":var e=r.execCommand("wordimage");e&&e.length&&(l.render(),l.open());break;case"scrawl":r.queryCommandState("scrawl")!=-1&&(l.render(),l.open());break;default:l.render(),l.open()}},theme:r.options.theme,disabled:"scrawl"==i&&r.queryCommandState("scrawl")==-1||"charts"==i});return t.buttons[i]=d,r.addListener("selectionchange",function(){var e={edittable:1};if(!(i in e)){var t=r.queryCommandState(i);d.getDom()&&(d.setDisabled(t==-1),d.setChecked(t))}}),d}}(r.toLowerCase())}(l,d[l]);t.snapscreen=function(e,n,i){i=e.options.labelMap.snapscreen||e.getLang("labelMap.snapscreen")||"";var r=new t.Button({className:"edui-for-snapscreen",title:i,onclick:function(){e.execCommand("snapscreen")},theme:e.options.theme});if(t.buttons.snapscreen=r,n=n||(e.options.iframeUrlMap||{}).snapscreen||o.snapscreen){var a=new t.Dialog({iframeUrl:e.ui.mapUrl(n),editor:e,className:"edui-for-snapscreen",title:i,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),editor:e,onclick:function(){a.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),editor:e,onclick:function(){a.close(!1)}}]});a.render(),e.ui._dialogs.snapscreenDialog=a}return e.addListener("selectionchange",function(){r.setDisabled(e.queryCommandState("snapscreen")==-1)}),r},t.insertcode=function(n,i,o){i=n.options.insertcode||[],o=n.options.labelMap.insertcode||n.getLang("labelMap.insertcode")||"";var r=[];e.each(i,function(e,t){r.push({label:e,value:t,theme:n.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});var a=new t.Combox({editor:n,items:r,onselect:function(e,t){n.execCommand("insertcode",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:o,initValue:o,className:"edui-for-insertcode",indexByValue:function(e){if(e)for(var t,n=0;t=this.items[n];n++)if(t.value.indexOf(e)!=-1)return n;return-1}});return t.buttons.insertcode=a,n.addListener("selectionchange",function(e,t,i){if(!i){var r=n.queryCommandState("insertcode");if(r==-1)a.setDisabled(!0);else{a.setDisabled(!1);var s=n.queryCommandValue("insertcode");if(!s)return void a.setValue(o);s&&(s=s.replace(/['"]/g,"").split(",")[0]),a.setValue(s)}}}),a},t.fontfamily=function(n,i,o){if(i=n.options.fontfamily||[],o=n.options.labelMap.fontfamily||n.getLang("labelMap.fontfamily")||"",i.length){for(var r,a=0,s=[];r=i[a];a++){var l=n.getLang("fontfamily")[r.name]||"";!function(t,i){s.push({label:t,value:i,theme:n.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+e.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}(r.label||l,r.val)}var d=new t.Combox({editor:n,items:s,onselect:function(e,t){n.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:o,initValue:o,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t,n=0;t=this.items[n];n++)if(t.value.indexOf(e)!=-1)return n;return-1}});return t.buttons.fontfamily=d,n.addListener("selectionchange",function(e,t,i){if(!i){var o=n.queryCommandState("FontFamily");if(o==-1)d.setDisabled(!0);else{d.setDisabled(!1);var r=n.queryCommandValue("FontFamily");r&&(r=r.replace(/['"]/g,"").split(",")[0]),d.setValue(r)}}}),d}},t.fontsize=function(e,n,i){if(i=e.options.labelMap.fontsize||e.getLang("labelMap.fontsize")||"",n=n||e.options.fontsize||[],n.length){for(var o=[],r=0;r<n.length;r++){var a=n[r]+"px";o.push({label:a,value:a,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var s=new t.Combox({editor:e,items:o,title:i,initValue:i,onselect:function(t,n){e.execCommand("FontSize",this.items[n].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return t.buttons.fontsize=s,e.addListener("selectionchange",function(t,n,i){if(!i){var o=e.queryCommandState("FontSize");o==-1?s.setDisabled(!0):(s.setDisabled(!1),s.setValue(e.queryCommandValue("FontSize")))}}),s}},t.paragraph=function(n,i,o){if(o=n.options.labelMap.paragraph||n.getLang("labelMap.paragraph")||"",i=n.options.paragraph||[],!e.isEmptyObject(i)){var r=[];for(var a in i)r.push({value:a,label:i[a]||n.getLang("paragraph")[a],theme:n.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var s=new t.Combox({editor:n,items:r,title:o,initValue:o,className:"edui-for-paragraph",onselect:function(e,t){n.execCommand("Paragraph",this.items[t].value)},onbuttonclick:function(){this.showPopup()}});return t.buttons.paragraph=s,n.addListener("selectionchange",function(e,t,i){if(!i){var o=n.queryCommandState("Paragraph");if(o==-1)s.setDisabled(!0);else{s.setDisabled(!1);var r=n.queryCommandValue("Paragraph"),a=s.indexByValue(r);a!=-1?s.setValue(r):s.setValue(s.initValue)}}}),s}},t.customstyle=function(e){var n=e.options.customstyle||[],i=e.options.labelMap.customstyle||e.getLang("labelMap.customstyle")||"";if(n.length){for(var o,r=e.getLang("customstyle"),a=0,s=[];o=n[a++];)!function(t){var n={};n.label=t.label?t.label:r[t.name],n.style=t.style,n.className=t.className,n.tag=t.tag,s.push({label:n.label,value:n,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+n.tag+" "+(n.className?' class="'+n.className+'"':"")+(n.style?' style="'+n.style+'"':"")+">"+n.label+"</"+n.tag+"></div>"}})}(o);var l=new t.Combox({editor:e,items:s,title:i,initValue:i,className:"edui-for-customstyle",onselect:function(t,n){e.execCommand("customstyle",this.items[n].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t,n=0;t=this.items[n++];)if(t.label==e)return n-1;return-1}});return t.buttons.customstyle=l,e.addListener("selectionchange",function(t,n,i){if(!i){var o=e.queryCommandState("customstyle");if(o==-1)l.setDisabled(!0);else{l.setDisabled(!1);var r=e.queryCommandValue("customstyle"),a=l.indexByValue(r);a!=-1?l.setValue(r):l.setValue(l.initValue)}}}),l}},t.inserttable=function(e,n,i){i=e.options.labelMap.inserttable||e.getLang("labelMap.inserttable")||"";var o=new t.TableButton({editor:e,title:i,className:"edui-for-inserttable",onpicktable:function(t,n,i){e.execCommand("InsertTable",{numRows:i,numCols:n,border:1})},onbuttonclick:function(){this.showPopup()}});return t.buttons.inserttable=o,e.addListener("selectionchange",function(){o.setDisabled(e.queryCommandState("inserttable")==-1)}),o},t.lineheight=function(e){var n=e.options.lineheight||[];if(n.length){for(var i,o=0,r=[];i=n[o++];)r.push({label:i,value:i,theme:e.options.theme,onclick:function(){e.execCommand("lineheight",this.value)}});var a=new t.MenuButton({editor:e,className:"edui-for-lineheight",title:e.options.labelMap.lineheight||e.getLang("labelMap.lineheight")||"",items:r,onbuttonclick:function(){var t=e.queryCommandValue("LineHeight")||this.value;e.execCommand("LineHeight",t)}});return t.buttons.lineheight=a,e.addListener("selectionchange",function(){var t=e.queryCommandState("LineHeight");if(t==-1)a.setDisabled(!0);else{a.setDisabled(!1);var n=e.queryCommandValue("LineHeight");n&&a.setValue((n+"").replace(/cm/,"")),a.setChecked(t)}}),a}};for(var c,u=["top","bottom"],p=0;c=u[p++];)!function(e){t["rowspacing"+e]=function(n){var i=n.options["rowspacing"+e]||[];if(!i.length)return null;for(var o,r=0,a=[];o=i[r++];)a.push({label:o,value:o,theme:n.options.theme,onclick:function(){n.execCommand("rowspacing",this.value,e)}});var s=new t.MenuButton({editor:n,className:"edui-for-rowspacing"+e,title:n.options.labelMap["rowspacing"+e]||n.getLang("labelMap.rowspacing"+e)||"",items:a,onbuttonclick:function(){var t=n.queryCommandValue("rowspacing",e)||this.value;n.execCommand("rowspacing",t,e)}});return t.buttons[e]=s,n.addListener("selectionchange",function(){var t=n.queryCommandState("rowspacing",e);if(t==-1)s.setDisabled(!0);else{s.setDisabled(!1);var i=n.queryCommandValue("rowspacing",e);i&&s.setValue((i+"").replace(/%/,"")),s.setChecked(t)}}),s}}(c);for(var h,f=["insertorderedlist","insertunorderedlist"],m=0;h=f[m++];)!function(e){t[e]=function(n){var i=n.options[e],o=function(){n.execCommand(e,this.value)},r=[];for(var a in i)r.push({label:i[a]||n.getLang()[e][a]||"",value:a,theme:n.options.theme,onclick:o});var s=new t.MenuButton({editor:n,className:"edui-for-"+e,title:n.getLang("labelMap."+e)||"",items:r,onbuttonclick:function(){var t=n.queryCommandValue(e)||this.value;n.execCommand(e,t)}});return t.buttons[e]=s,n.addListener("selectionchange",function(){var t=n.queryCommandState(e);if(t==-1)s.setDisabled(!0);else{s.setDisabled(!1);var i=n.queryCommandValue(e);s.setValue(i),s.setChecked(t)}}),s}}(h);t.fullscreen=function(e,n){n=e.options.labelMap.fullscreen||e.getLang("labelMap.fullscreen")||"";var i=new t.Button({className:"edui-for-fullscreen",title:n,theme:e.options.theme,onclick:function(){e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen()),this.setChecked(e.ui.isFullScreen())}});return t.buttons.fullscreen=i,e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");i.setDisabled(t==-1),i.setChecked(e.ui.isFullScreen())}),i},t.emotion=function(e,n){var i="emotion",r=new t.MultiMenuPop({title:e.options.labelMap[i]||e.getLang("labelMap."+i)||"",editor:e,className:"edui-for-"+i,iframeUrl:e.ui.mapUrl(n||(e.options.iframeUrlMap||{})[i]||o[i])});return t.buttons[i]=r,e.addListener("selectionchange",function(){r.setDisabled(e.queryCommandState(i)==-1)}),r},t.autotypeset=function(e){var n=new t.AutoTypeSetButton({editor:e,title:e.options.labelMap.autotypeset||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});return t.buttons.autotypeset=n,e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("autotypeset")==-1)}),n},t.simpleupload=function(e){var n="simpleupload",i=new t.Button({className:"edui-for-"+n,title:e.options.labelMap[n]||e.getLang("labelMap."+n)||"",onclick:function(){},theme:e.options.theme,showText:!1});return t.buttons[n]=i,e.addListener("ready",function(){var t=i.getDom("body"),n=t.children[0];e.fireEvent("simpleuploadbtnready",n)}),e.addListener("selectionchange",function(t,o,r){var a=e.queryCommandState(n);a==-1?(i.setDisabled(!0),i.setChecked(!1)):r||(i.setDisabled(!1),i.setChecked(a))}),i}}(),function(){function e(e){this.initOptions(e),this.initEditorUI()}var t=baidu.editor.utils,n=baidu.editor.ui.uiUtils,i=baidu.editor.ui.UIBase,o=baidu.editor.dom.domUtils,r=[];e.prototype={uiName:"editor",initEditorUI:function(){function e(e,t){e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var n=e.options,i=n.maximumWords,o=n.wordCountMsg,r=n.wordOverFlowMsg,a=t.getDom("wordcount");if(n.wordCount){var s=e.getContentLength(!0);s>i?(a.innerHTML=r,e.fireEvent("wordcountoverflow")):a.innerHTML=o.replace("{#leave}",i-s).replace("{#count}",s)}}this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars();var t=this.editor,n=this;t.addListener("ready",function(){function i(){e(t,n),o.un(t.document,"click",arguments.callee)}t.getDialog=function(e){return t.ui._dialogs[e+"Dialog"]},o.on(t.window,"scroll",function(e){baidu.editor.ui.Popup.postHide(e)}),t.ui._actualFrameWidth=t.options.initialFrameWidth,UE.browser.ie&&6===UE.browser.version&&t.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0),t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":</div>"),t.options.wordCount&&(o.on(t.document,"click",i),t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")),t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),n.enableScale()):n.disableScale(),t.options.elementPathEnabled||t.options.wordCount||t.options.scaleEnabled||(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none"),t.selection.isFocus()&&t.fireEvent("selectionchange",!1,!0)}),t.addListener("mousedown",function(e,t){var n=t.target||t.srcElement;baidu.editor.ui.Popup.postHide(t,n),baidu.editor.ui.ShortCutMenu.postHide(t)}),t.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(t),t.getDialog("edittip").open()});var i,r,a=!1;t.addListener("afterpaste",function(){t.queryCommandState("pasteplain")||(baidu.editor.ui.PastePicker&&(i=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),i.render()),a=!0)}),t.addListener("afterinserthtml",function(){clearTimeout(r),r=setTimeout(function(){if(i&&(a||t.ui._isTransfer)){if(i.isHidden()){var e=o.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),n=t.selection.getRange();n.insertNode(e);var r=getDomNode(e,"firstChild","previousSibling");r&&i.showAnchor(3==r.nodeType?r.parentNode:r),o.remove(e)}else i.show();delete t.ui._isTransfer,a=!1}},200)}),t.addListener("contextmenu",function(e,t){baidu.editor.ui.Popup.postHide(t)}),t.addListener("keydown",function(e,t){i&&i.dispose(t);var n=t.keyCode||t.which;t.altKey&&90==n&&UE.ui.buttons.fullscreen.onclick()}),t.addListener("wordcount",function(t){e(this,n)}),t.addListener("selectionchange",function(){t.options.elementPathEnabled&&n[(t.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"](),t.options.scaleEnabled&&n[(t.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()});var s=new baidu.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(e){this.hide(),t.ui._dialogs[e]&&t.ui._dialogs[e].open()},_onImgSetFloat:function(e){this.hide(),t.execCommand("imagefloat",e)},_setIframeAlign:function(e){var t=s.anchorEl,n=t.cloneNode(!0);switch(e){case-2:n.setAttribute("align","");break;case-1:n.setAttribute("align","left");break;case 1:n.setAttribute("align","right")}t.parentNode.insertBefore(n,t),o.remove(t),s.anchorEl=n,s.showAnchor(s.anchorEl)},_updateIframe:function(){var e=t._iframe=s.anchorEl;o.hasClass(e,"ueditor_baidumap")?(t.selection.getRange().selectNode(e).select(),t.ui._dialogs.mapDialog.open(),s.hide()):(t.ui._dialogs.insertframeDialog.open(),s.hide())},_onRemoveButtonClick:function(e){t.execCommand(e),this.hide()},queryAutoHide:function(e){return e&&e.ownerDocument==t.document&&("img"==e.tagName.toLowerCase()||o.findParentByTagName(e,"a",!0))?e!==s.anchorEl:baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});s.render(),t.options.imagePopup&&(t.addListener("mouseover",function(e,n){n=n||window.event;var i=n.target||n.srcElement;if(t.ui._dialogs.insertframeDialog&&/iframe/gi.test(i.tagName)){var o=s.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>");o?(s.getDom("content").innerHTML=o,s.anchorEl=i,s.showAnchor(s.anchorEl)):s.hide()}}),t.addListener("selectionchange",function(e,n){if(n){var i="",r="",a=t.selection.getRange().getClosedNode(),l=t.ui._dialogs;if(a&&"IMG"==a.tagName){var d="insertimageDialog";if(a.className.indexOf("edui-faked-video")==-1&&a.className.indexOf("edui-upload-video")==-1||(d="insertvideoDialog"),a.className.indexOf("edui-faked-webapp")!=-1&&(d="webappDialog"),a.src.indexOf("http://api.map.baidu.com")!=-1&&(d="mapDialog"),a.className.indexOf("edui-faked-music")!=-1&&(d="musicDialog"),a.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1&&(d="gmapDialog"),a.getAttribute("anchorname")&&(d="anchorDialog",i=s.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"</span></nobr>")),a.getAttribute("word_img")&&(t.word_img=[a.getAttribute("word_img")],d="wordimageDialog"),(o.hasClass(a,"loadingclass")||o.hasClass(a,"loaderrorclass"))&&(d=""),!l[d])return;r="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+d+'\');" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>",!i&&(i=s.formatHtml(r))}if(t.ui._dialogs.linkDialog){var c,u=t.queryCommandValue("link");if(u&&(c=u.getAttribute("_href")||u.getAttribute("href",2))){var p=c;c.length>30&&(p=c.substring(0,20)+"..."),i&&(i+='<div style="height:5px;"></div>'),i+=s.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+c+'" title="'+c+'" >'+p+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"</span></nobr>"),s.showAnchor(u)}}i?(s.getDom("content").innerHTML=i,s.anchorEl=a||u,s.showAnchor(s.anchorEl)):s.hide()}}))},_initToolbars:function(){for(var e=this.editor,n=this.toolbars||[],i=[],o=[],r=0;r<n.length;r++){for(var a=n[r],s=new baidu.editor.ui.Toolbar({theme:e.options.theme}),l=0;l<a.length;l++){var d=a[l],c=null;if("string"==typeof d){d=d.toLowerCase(),"|"==d&&(d="Separator"),"||"==d&&(d="Breakline");var u=baidu.editor.ui[d];if(u)if(t.isFunction(u))c=new baidu.editor.ui[d](e);else{if(u.id&&u.id!=e.key)continue;var p=u.execFn.call(e,e,d);if(p){if(void 0===u.index){s.add(p);continue}o.push({index:u.index,itemUI:p})}}if("fullscreen"==d){i&&i[0]?i[0].items.splice(0,0,c):c&&s.items.splice(0,0,c);continue}}else c=d;c&&c.id&&s.add(c)}i[r]=s}t.each(o,function(e){s.add(e.itemUI,e.index)}),this.toolbars=i},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var e=[],t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},setFullScreen:function(e){var t=this.editor,n=t.container.parentNode.parentNode;if(this._fullscreen!=e){if(this._fullscreen=e,this.editor.fireEvent("beforefullscreenchange",e),baidu.editor.browser.gecko)var i=t.selection.getRange().createBookmark();if(e){for(;"BODY"!=n.tagName;){var o=baidu.editor.dom.domUtils.getComputedStyle(n,"position");r.push(o),n.style.position="static",n=n.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",window.scrollTo(0,window.scrollY),this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,t.iframe.parentNode.style.width="",this._updateFullScreen()}else{for(;"BODY"!=n.tagName;)n.style.position=r.shift(),n=n.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,t.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px",window.scrollTo(0,this._bakScrollTop)}if(browser.gecko&&"true"===t.body.contentEditable){var a=document.createElement("input");document.body.appendChild(a),t.body.contentEditable=!1,setTimeout(function(){a.focus(),setTimeout(function(){t.body.contentEditable=!0,t.fireEvent("fullscreenchanged",e),t.selection.getRange().moveToBookmark(i).select(!0),baidu.editor.dom.domUtils.remove(a),e&&window.scroll(0,0)},0)},0)}"true"===t.body.contentEditable&&(this.editor.fireEvent("fullscreenchanged",e),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var e=n.getViewportRect();if(this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(1*this.getDom().style.zIndex+100),browser.gecko||n.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),!0),browser.gecko)try{window.onresize()}catch(t){}}},_updateElementPath:function(){var e,t=this.getDom("elementpath");if(this.elementPathEnabled&&(e=this.editor.queryCommandValue("elementpath"))){for(var n,i=[],o=0;n=e[o];o++)i[o]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+o+'&quot;);">'+n+"</span>");t.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+i.join(" &gt; ")+"</div>"}else t.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="",e.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){function e(){f=o.getXY(s),m||(m=a.options.minFrameHeight+d.offsetHeight+c.offsetHeight),p.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+s.offsetWidth+"px;height:"+s.offsetHeight+"px;z-index:"+(a.options.zIndex+1),o.on(r,"mousemove",t),o.on(l,"mouseup",n),o.on(r,"mouseup",n)}function t(e){i();var t=e||window.event;b=t.pageX||r.documentElement.scrollLeft+t.clientX,v=t.pageY||r.documentElement.scrollTop+t.clientY,y=b-f.x,x=v-f.y,y>=g&&(h=!0,p.style.width=y+"px"),x>=m&&(h=!0,p.style.height=x+"px")}function n(){h&&(h=!1,a.ui._actualFrameWidth=p.offsetWidth-2,s.style.width=a.ui._actualFrameWidth+"px",a.setHeight(p.offsetHeight-c.offsetHeight-d.offsetHeight-2,!0)),p&&(p.style.display="none"),i(),o.un(r,"mousemove",t),o.un(l,"mouseup",n),o.un(r,"mouseup",n)}function i(){browser.ie?r.selection.clear():window.getSelection().removeAllRanges()}var r=document,a=this.editor,s=a.container,l=a.document,d=this.getDom("toolbarbox"),c=this.getDom("bottombar"),u=this.getDom("scale"),p=this.getDom("scalelayer"),h=!1,f=null,m=0,g=a.options.minFrameWidth,b=0,v=0,y=0,x=0,_=this;this.editor.addListener("fullscreenchanged",function(e,t){if(t)_.disableScale();else if(_.editor.options.scaleEnabled){_.enableScale();var n=_.editor.document.createElement("span");_.editor.body.appendChild(n),_.editor.body.style.height=Math.max(o.getXY(n).y,_.editor.iframe.offsetHeight-20)+"px",o.remove(n)}}),this.enableScale=function(){1!=a.queryCommandState("source")&&(u.style.display="",this.scaleEnabled=!0,o.on(u,"mousedown",e))},this.disableScale=function(){u.style.display="none",this.scaleEnabled=!1,o.un(u,"mousedown",e)}},isFullScreen:function(){return this._fullscreen},postRender:function(){i.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();var t,n=this,o=baidu.editor.dom.domUtils,r=function(){clearTimeout(t),t=setTimeout(function(){n._updateFullScreen()})};o.on(window,"resize",r),n.addListener("destroy",function(){o.un(window,"resize",r),clearTimeout(t)})},showToolbarMsg:function(e,t){if(this.getDom("toolbarmsg_label").innerHTML=e,this.getDom("toolbarmsg").style.display="",!t){var n=this.getDom("upload_dialog");n.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();"1"==e.style.zoom?e.style.zoom="100%":e.style.zoom="1"}},t.inherits(e,baidu.editor.ui.UIBase);var a={};UE.ui.Editor=function(n){var i=new UE.Editor(n);i.options.editor=i,t.loadFile(document,{href:i.options.themePath+i.options.theme+"/_css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var r=i.render;return i.render=function(t){t.constructor===String&&(i.key=t,a[t]=i),jQuery(document).ready(function(){function n(){if(i.setOpt({labelMap:i.options.labelMap||i.getLang("labelMap")}),new e(i.options),t&&(t.constructor===String&&(t=document.getElementById(t)),t&&t.getAttribute("name")&&(i.options.textarea=t.getAttribute("name")),t&&/script|textarea/gi.test(t.tagName))){var n=document.createElement("div");t.parentNode.insertBefore(n,t);var a=t.value||t.innerHTML;i.options.initialContent=/^[\t\r\n ]*$/.test(a)?i.options.initialContent:a.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),t.className&&(n.className=t.className),t.style.cssText&&(n.style.cssText=t.style.cssText),/textarea/i.test(t.tagName)?(i.textarea=t,i.textarea.style.display="none"):t.parentNode.removeChild(t),t.id&&(n.id=t.id,o.removeAttributes(t,"id")),t=n,t.innerHTML=""}o.addClass(t,"edui-"+i.options.theme),i.ui.render(t);var s=i.options;i.container=i.ui.getDom();for(var l,d=o.findParents(t,!0),c=[],u=0;l=d[u];u++)c[u]=l.style.display,l.style.display="block";if(s.initialFrameWidth)s.minFrameWidth=s.initialFrameWidth;else{s.minFrameWidth=s.initialFrameWidth=t.offsetWidth;var p=t.style.width;/%$/.test(p)&&(s.initialFrameWidth=p)}s.initialFrameHeight?s.minFrameHeight=s.initialFrameHeight:s.initialFrameHeight=s.minFrameHeight=t.offsetHeight;for(var l,u=0;l=d[u];u++)l.style.display=c[u];t.style.height&&(t.style.height=""),i.container.style.width=s.initialFrameWidth+(/%$/.test(s.initialFrameWidth)?"":"px"),i.container.style.zIndex=s.zIndex,r.call(i,i.ui.getDom("iframeholder")),i.fireEvent("afteruiready")}i.langIsReady?n():i.addListener("langReady",n)})},i},UE.getEditor=function(e,t){var n=a[e];return n||(n=a[e]=new UE.ui.Editor(t),n.render(e)),n},UE.delEditor=function(e){var t;(t=a[e])&&(t.key&&t.destroy(),delete a[e])},UE.registerUI=function(e,n,i,o){t.each(e.split(/\s+/),function(e){baidu.editor.ui[e]={id:o,execFn:n,index:i}})}}(),UE.registerUI("message",function(e){function t(){if(n&&a.ui){var e=a.ui.getDom("toolbarbox");e&&(n.style.top=e.offsetHeight+3+"px"),n.style.zIndex=Math.max(a.options.zIndex,a.iframe.style.zIndex)+1}}var n,i=baidu.editor.ui,o=i.Message,r=[],a=e;a.setOpt("enableMessageShow",!0),a.getOpt("enableMessageShow")!==!1&&(a.addListener("ready",function(){n=document.getElementById(a.ui.id+"_message_holder"),t(),setTimeout(function(){t()},500)}),a.addListener("showmessage",function(e,i){i=utils.isString(i)?{content:i}:i;var s=new o({timeout:i.timeout,type:i.type,content:i.content,keepshow:i.keepshow,editor:a}),l=i.id||"msg_"+(+new Date).toString(36);return s.render(n),r[l]=s,s.reset(i),t(),l}),a.addListener("updatemessage",function(e,t,i){i=utils.isString(i)?{content:i}:i;var o=r[t];o.render(n),o&&o.reset(i)}),a.addListener("hidemessage",function(e,t){var n=r[t];n&&n.hide()}))}),UE.registerUI("autosave",function(e){var t=null,n=null;e.on("afterautosave",function(){clearTimeout(t),t=setTimeout(function(){n&&e.trigger("hidemessage",n),n=e.trigger("showmessage",{content:e.getLang("autosave.success"),timeout:2e3})},2e3)})}),UE.I18N["zh-cn"]={labelMap:{anchor:"锚点",undo:"撤销",redo:"重做",bold:"加粗",indent:"首行缩进",snapscreen:"截图",italic:"斜体",underline:"下划线",strikethrough:"删除线",subscript:"下标",fontborder:"字符边框",superscript:"上标",formatmatch:"格式刷",source:"源代码",blockquote:"引用",pasteplain:"纯文本粘贴模式",selectall:"全选",print:"打印",preview:"预览",horizontal:"分隔线",removeformat:"清除格式",time:"时间",date:"日期",unlink:"取消链接",insertrow:"前插入行",insertcol:"前插入列",mergeright:"右合并单元格",mergedown:"下合并单元格",deleterow:"删除行",deletecol:"删除列",splittorows:"拆分成行",splittocols:"拆分成列",splittocells:"完全拆分单元格",deletecaption:"删除表格标题",inserttitle:"插入标题",mergecells:"合并多个单元格",deletetable:"删除表格",cleardoc:"清空文档",insertparagraphbeforetable:"表格前插入行",insertcode:"代码语言",fontfamily:"字体",fontsize:"字号",paragraph:"段落格式",simpleupload:"单图上传",insertimage:"多图上传",edittable:"表格属性",edittd:"单元格属性",link:"超链接",emotion:"表情",spechars:"特殊字符",searchreplace:"查询替换",map:"Baidu地图",gmap:"Google地图",insertvideo:"视频",help:"帮助",justifyleft:"居左对齐",justifyright:"居右对齐",justifycenter:"居中对齐",justifyjustify:"两端对齐",forecolor:"字体颜色",backcolor:"背景色",insertorderedlist:"有序列表",insertunorderedlist:"无序列表",fullscreen:"全屏",directionalityltr:"从左向右输入",directionalityrtl:"从右向左输入",rowspacingtop:"段前距",rowspacingbottom:"段后距",pagebreak:"分页",insertframe:"插入Iframe",imagenone:"默认",imageleft:"左浮动",imageright:"右浮动",attachment:"附件",imagecenter:"居中",wordimage:"图片转存",lineheight:"行间距",edittip:"编辑提示",customstyle:"自定义标题",autotypeset:"自动排版",webapp:"百度应用",touppercase:"字母大写",tolowercase:"字母小写",background:"背景",template:"模板",scrawl:"涂鸦",music:"音乐",inserttable:"插入表格",drafts:"从草稿箱加载",charts:"图表"},insertorderedlist:{num:"1,2,3...",num1:"1),2),3)...",num2:"(1),(2),(3)...",cn:"一,二,三....",cn1:"一),二),三)....",cn2:"(一),(二),(三)....",decimal:"1,2,3...","lower-alpha":"a,b,c...","lower-roman":"i,ii,iii...","upper-alpha":"A,B,C...","upper-roman":"I,II,III..."},insertunorderedlist:{circle:"○ 大圆圈",disc:"● 小黑点",square:"■ 小方块 ",dash:"— 破折号",dot:" 。 小圆圈"},paragraph:{p:"段落",h1:"标题 1",h2:"标题 2",h3:"标题 3",h4:"标题 4",h5:"标题 5",h6:"标题 6"},fontfamily:{songti:"宋体",kaiti:"楷体",heiti:"黑体",lishu:"隶书",yahei:"微软雅黑",andaleMono:"andale mono",arial:"arial",arialBlack:"arial black",comicSansMs:"comic sans ms",impact:"impact",timesNewRoman:"times new roman"},customstyle:{tc:"标题居中",tl:"标题居左",im:"强调",hi:"明显强调"},autoupload:{exceedSizeError:"文件大小超出限制",exceedTypeError:"文件格式不允许",jsonEncodeError:"服务器返回格式错误",loading:"正在上传...",loadError:"上传错误",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！"
},simpleupload:{exceedSizeError:"文件大小超出限制",exceedTypeError:"文件格式不允许",jsonEncodeError:"服务器返回格式错误",loading:"正在上传...",loadError:"上传错误",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！"},elementPathTip:"元素路径",wordCountTip:"字数统计",wordCountMsg:"当前已输入{#count}个字符, 您还可以输入{#leave}个字符。 ",wordOverFlowMsg:'<span style="color:red;">字数超出最大允许值，服务器可能拒绝保存！</span>',ok:"确认",cancel:"取消",closeDialog:"关闭对话框",tableDrag:"表格拖动必须引入uiUtils.js文件！",autofloatMsg:"工具栏浮动依赖编辑器UI，您首先需要引入UI文件!",loadconfigError:"获取后台配置项请求出错，上传功能将不能正常使用！",loadconfigFormatError:"后台配置项返回格式出错，上传功能将不能正常使用！",loadconfigHttpError:"请求后台配置项http错误，上传功能将不能正常使用！",snapScreen_plugin:{browserMsg:"仅支持IE浏览器！",callBackErrorMsg:"服务器返回数据有误，请检查配置项之后重试。",uploadErrorMsg:"截图上传失败，请检查服务器端环境! "},insertcode:{as3:"ActionScript 3",bash:"Bash/Shell",cpp:"C/C++",css:"CSS",cf:"ColdFusion","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"HTML",java:"Java",jfx:"JavaFX",js:"JavaScript",pl:"Perl",php:"PHP",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"SQL",vb:"Visual Basic",xml:"XML"},confirmClear:"确定清空当前文档么？",contextMenu:{"delete":"删除",selectall:"全选",deletecode:"删除代码",cleardoc:"清空文档",confirmclear:"确定清空当前文档么？",unlink:"删除超链接",paragraph:"段落格式",edittable:"表格属性",aligntd:"单元格对齐方式",aligntable:"表格对齐方式",tableleft:"左浮动",tablecenter:"居中显示",tableright:"右浮动",edittd:"单元格属性",setbordervisible:"设置表格边线可见",justifyleft:"左对齐",justifyright:"右对齐",justifycenter:"居中对齐",justifyjustify:"两端对齐",table:"表格",inserttable:"插入表格",deletetable:"删除表格",insertparagraphbefore:"前插入段落",insertparagraphafter:"后插入段落",deleterow:"删除当前行",deletecol:"删除当前列",insertrow:"前插入行",insertcol:"左插入列",insertrownext:"后插入行",insertcolnext:"右插入列",insertcaption:"插入表格名称",deletecaption:"删除表格名称",inserttitle:"插入表格标题行",deletetitle:"删除表格标题行",inserttitlecol:"插入表格标题列",deletetitlecol:"删除表格标题列",averageDiseRow:"平均分布各行",averageDisCol:"平均分布各列",mergeright:"向右合并",mergeleft:"向左合并",mergedown:"向下合并",mergecells:"合并单元格",splittocells:"完全拆分单元格",splittocols:"拆分成列",splittorows:"拆分成行",tablesort:"表格排序",enablesort:"设置表格可排序",disablesort:"取消表格可排序",reversecurrent:"逆序当前",orderbyasc:"按ASCII字符升序",reversebyasc:"按ASCII字符降序",orderbynum:"按数值大小升序",reversebynum:"按数值大小降序",borderbk:"边框底纹",setcolor:"表格隔行变色",unsetcolor:"取消表格隔行变色",setbackground:"选区背景隔行",unsetbackground:"取消选区背景",redandblue:"红蓝相间",threecolorgradient:"三色渐变",copy:"复制(Ctrl + c)",copymsg:"浏览器不支持,请使用 'Ctrl + c'",paste:"粘贴(Ctrl + v)",pastemsg:"浏览器不支持,请使用 'Ctrl + v'"},copymsg:"浏览器不支持,请使用 'Ctrl + c'",pastemsg:"浏览器不支持,请使用 'Ctrl + v'",anthorMsg:"链接",clearColor:"清空颜色",standardColor:"标准颜色",themeColor:"主题颜色",property:"属性","default":"默认",modify:"修改",justifyleft:"左对齐",justifyright:"右对齐",justifycenter:"居中",justify:"默认",clear:"清除",anchorMsg:"锚点","delete":"删除",clickToUpload:"点击上传",unset:"尚未设置语言文件",t_row:"行",t_col:"列",more:"更多",pasteOpt:"粘贴选项",pasteSourceFormat:"保留源格式",tagFormat:"只保留标签",pasteTextFormat:"只保留文本",autoTypeSet:{mergeLine:"合并空行",delLine:"清除空行",removeFormat:"清除格式",indent:"首行缩进",alignment:"对齐方式",imageFloat:"图片浮动",removeFontsize:"清除字号",removeFontFamily:"清除字体",removeHtml:"清除冗余HTML代码",pasteFilter:"粘贴过滤",run:"执行",symbol:"符号转换",bdc2sb:"全角转半角",tobdc:"半角转全角"},background:{"static":{lang_background_normal:"背景设置",lang_background_local:"在线图片",lang_background_set:"选项",lang_background_none:"无背景色",lang_background_colored:"有背景色",lang_background_color:"颜色设置",lang_background_netimg:"网络图片",lang_background_align:"对齐方式",lang_background_position:"精确定位",repeatType:{options:["居中","横向重复","纵向重复","平铺","自定义"]}},noUploadImage:"当前未上传过任何图片！",toggleSelect:"单击可切换选中状态\n原图尺寸: "},insertimage:{"static":{lang_tab_remote:"插入图片",lang_tab_upload:"本地上传",lang_tab_online:"在线管理",lang_tab_search:"图片搜索",lang_input_url:"地 址：",lang_input_size:"大 小：",lang_input_width:"宽度",lang_input_height:"高度",lang_input_border:"边 框：",lang_input_vhspace:"边 距：",lang_input_title:"描 述：",lang_input_align:"图片浮动方式：",lang_imgLoading:"　图片加载中……",lang_start_upload:"开始上传",lock:{title:"锁定宽高比例"},searchType:{title:"图片类型",options:["新闻","壁纸","表情","头像"]},searchTxt:{value:"请输入搜索关键词"},searchBtn:{value:"百度一下"},searchReset:{value:"清空搜索"},noneAlign:{title:"无浮动"},leftAlign:{title:"左浮动"},rightAlign:{title:"右浮动"},centerAlign:{title:"居中独占一行"}},uploadSelectFile:"点击选择图片",uploadAddFile:"继续添加",uploadStart:"开始上传",uploadPause:"暂停上传",uploadContinue:"继续上传",uploadRetry:"重试上传",uploadDelete:"删除",uploadTurnLeft:"向左旋转",uploadTurnRight:"向右旋转",uploadPreview:"预览中",uploadNoPreview:"不能预览",updateStatusReady:"选中_张图片，共_KB。",updateStatusConfirm:"已成功上传_张照片，_张照片上传失败",updateStatusFinish:"共_张（_KB），_张上传成功",updateStatusError:"，_张上传失败。",errorNotSupport:"WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！",errorExceedSize:"文件大小超出",errorFileType:"文件格式不允许",errorInterrupt:"文件传输中断",errorUploadRetry:"上传失败，请重试",errorHttp:"http请求错误",errorServerUpload:"服务器返回出错",remoteLockError:"宽高不正确,不能所定比例",numError:"请输入正确的长度或者宽度值！例如：123，400",imageUrlError:"不允许的图片格式或者图片域！",imageLoadError:"图片加载失败！请检查链接地址或网络状态！",searchRemind:"请输入搜索关键词",searchLoading:"图片加载中，请稍后……",searchRetry:" :( ，抱歉，没有找到图片！请重试一次！"},attachment:{"static":{lang_tab_upload:"上传附件",lang_tab_online:"在线附件",lang_start_upload:"开始上传",lang_drop_remind:"可以将文件拖到这里，单次最多可选100个文件"},uploadSelectFile:"点击选择文件",uploadAddFile:"继续添加",uploadStart:"开始上传",uploadPause:"暂停上传",uploadContinue:"继续上传",uploadRetry:"重试上传",uploadDelete:"删除",uploadTurnLeft:"向左旋转",uploadTurnRight:"向右旋转",uploadPreview:"预览中",updateStatusReady:"选中_个文件，共_KB。",updateStatusConfirm:"已成功上传_个文件，_个文件上传失败",updateStatusFinish:"共_个（_KB），_个上传成功",updateStatusError:"，_张上传失败。",errorNotSupport:"WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！",errorExceedSize:"文件大小超出",errorFileType:"文件格式不允许",errorInterrupt:"文件传输中断",errorUploadRetry:"上传失败，请重试",errorHttp:"http请求错误",errorServerUpload:"服务器返回出错"},insertvideo:{"static":{lang_tab_insertV:"插入视频",lang_tab_searchV:"搜索视频",lang_tab_uploadV:"上传视频",lang_video_url:"视频网址",lang_video_size:"视频尺寸",lang_videoW:"宽度",lang_videoH:"高度",lang_alignment:"对齐方式",videoSearchTxt:{value:"请输入搜索关键字！"},videoType:{options:["全部","热门","娱乐","搞笑","体育","科技","综艺"]},videoSearchBtn:{value:"百度一下"},videoSearchReset:{value:"清空结果"},lang_input_fileStatus:" 当前未上传文件",startUpload:{style:"background:url(upload.png) no-repeat;"},lang_upload_size:"视频尺寸",lang_upload_width:"宽度",lang_upload_height:"高度",lang_upload_alignment:"对齐方式",lang_format_advice:"建议使用mp4格式."},numError:"请输入正确的数值，如123,400",floatLeft:"左浮动",floatRight:"右浮动",'"default"':"默认",block:"独占一行",urlError:"输入的视频地址有误，请检查后再试！",loading:" &nbsp;视频加载中，请等待……",clickToSelect:"点击选中",goToSource:"访问源视频",noVideo:" &nbsp; &nbsp;抱歉，找不到对应的视频，请重试！",browseFiles:"浏览文件",uploadSuccess:"上传成功!",delSuccessFile:"从成功队列中移除",delFailSaveFile:"移除保存失败文件",statusPrompt:" 个文件已上传！ ",flashVersionError:"当前Flash版本过低，请更新FlashPlayer后重试！",flashLoadingError:"Flash加载失败!请检查路径或网络状态",fileUploadReady:"等待上传……",delUploadQueue:"从上传队列中移除",limitPrompt1:"单次不能选择超过",limitPrompt2:"个文件！请重新选择！",delFailFile:"移除失败文件",fileSizeLimit:"文件大小超出限制！",emptyFile:"空文件无法上传！",fileTypeError:"文件类型不允许！",unknownError:"未知错误！",fileUploading:"上传中，请等待……",cancelUpload:"取消上传",netError:"网络错误",failUpload:"上传失败!",serverIOError:"服务器IO错误！",noAuthority:"无权限！",fileNumLimit:"上传个数限制",failCheck:"验证失败，本次上传被跳过！",fileCanceling:"取消中，请等待……",stopUploading:"上传已停止……",uploadSelectFile:"点击选择文件",uploadAddFile:"继续添加",uploadStart:"开始上传",uploadPause:"暂停上传",uploadContinue:"继续上传",uploadRetry:"重试上传",uploadDelete:"删除",uploadTurnLeft:"向左旋转",uploadTurnRight:"向右旋转",uploadPreview:"预览中",updateStatusReady:"选中_个文件，共_KB。",updateStatusConfirm:"成功上传_个，_个失败",updateStatusFinish:"共_个(_KB)，_个成功上传",updateStatusError:"，_张上传失败。",errorNotSupport:"WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！",errorExceedSize:"文件大小超出",errorFileType:"文件格式不允许",errorInterrupt:"文件传输中断",errorUploadRetry:"上传失败，请重试",errorHttp:"http请求错误",errorServerUpload:"服务器返回出错"},webapp:{tip1:"本功能由百度APP提供，如看到此页面，请各位站长首先申请百度APPKey!",tip2:"申请完成之后请至ueditor.config.js中配置获得的appkey! ",applyFor:"点此申请",anthorApi:"百度API"},template:{"static":{lang_template_bkcolor:"背景颜色",lang_template_clear:"保留原有内容",lang_template_select:"选择模板"},blank:"空白文档",blog:"博客文章",resume:"个人简历",richText:"图文混排",sciPapers:"科技论文"},scrawl:{"static":{lang_input_previousStep:"上一步",lang_input_nextsStep:"下一步",lang_input_clear:"清空",lang_input_addPic:"添加背景",lang_input_ScalePic:"缩放背景",lang_input_removePic:"删除背景",J_imgTxt:{title:"添加背景图片"}},noScarwl:"尚未作画，白纸一张~",scrawlUpLoading:"涂鸦上传中,别急哦~",continueBtn:"继续",imageError:"糟糕，图片读取失败了！",backgroundUploading:"背景图片上传中,别急哦~"},music:{"static":{lang_input_tips:"输入歌手/歌曲/专辑，搜索您感兴趣的音乐！",J_searchBtn:{value:"搜索歌曲"}},emptyTxt:"未搜索到相关音乐结果，请换一个关键词试试。",chapter:"歌曲",singer:"歌手",special:"专辑",listenTest:"试听"},anchor:{"static":{lang_input_anchorName:"锚点名字："}},charts:{"static":{lang_data_source:"数据源：",lang_chart_format:"图表格式：",lang_data_align:"数据对齐方式",lang_chart_align_same:"数据源与图表X轴Y轴一致",lang_chart_align_reverse:"数据源与图表X轴Y轴相反",lang_chart_title:"图表标题",lang_chart_main_title:"主标题：",lang_chart_sub_title:"子标题：",lang_chart_x_title:"X轴标题：",lang_chart_y_title:"Y轴标题：",lang_chart_tip:"提示文字",lang_cahrt_tip_prefix:"提示文字前缀：",lang_cahrt_tip_description:"仅饼图有效， 当鼠标移动到饼图中相应的块上时，提示框内的文字的前缀",lang_chart_data_unit:"数据单位",lang_chart_data_unit_title:"单位：",lang_chart_data_unit_description:"显示在每个数据点上的数据的单位， 比如： 温度的单位 ℃",lang_chart_type:"图表类型：",lang_prev_btn:"上一个",lang_next_btn:"下一个"}},emotion:{"static":{lang_input_choice:"精选",lang_input_Tuzki:"兔斯基",lang_input_BOBO:"BOBO",lang_input_lvdouwa:"绿豆蛙",lang_input_babyCat:"baby猫",lang_input_bubble:"泡泡",lang_input_youa:"有啊"}},gmap:{"static":{lang_input_address:"地址",lang_input_search:"搜索",address:{value:"北京"}},searchError:"无法定位到该地址!"},help:{"static":{lang_input_about:"关于UEditor",lang_input_shortcuts:"快捷键",lang_input_introduction:"UEditor是由百度web前端研发部开发的所见即所得富文本web编辑器，具有轻量，可定制，注重用户体验等特点。开源基于BSD协议，允许自由使用和修改代码。",lang_Txt_shortcuts:"快捷键",lang_Txt_func:"功能",lang_Txt_bold:"给选中字设置为加粗",lang_Txt_copy:"复制选中内容",lang_Txt_cut:"剪切选中内容",lang_Txt_Paste:"粘贴",lang_Txt_undo:"重新执行上次操作",lang_Txt_redo:"撤销上一次操作",lang_Txt_italic:"给选中字设置为斜体",lang_Txt_underline:"给选中字加下划线",lang_Txt_selectAll:"全部选中",lang_Txt_visualEnter:"软回车",lang_Txt_fullscreen:"全屏"}},insertframe:{"static":{lang_input_address:"地址：",lang_input_width:"宽度：",lang_input_height:"高度：",lang_input_isScroll:"允许滚动条：",lang_input_frameborder:"显示框架边框：",lang_input_alignMode:"对齐方式：",align:{title:"对齐方式",options:["默认","左对齐","右对齐","居中"]}},enterAddress:"请输入地址!"},link:{"static":{lang_input_text:"文本内容：",lang_input_url:"链接地址：",lang_input_title:"标题：",lang_input_target:"是否在新窗口打开："},validLink:"只支持选中一个链接时生效",httpPrompt:"您输入的超链接中不包含http等协议名称，默认将为您添加http://前缀"},map:{"static":{lang_city:"城市",lang_address:"地址",city:{value:"北京"},lang_search:"搜索",lang_dynamicmap:"插入动态地图"},cityMsg:"请选择城市",errorMsg:"抱歉，找不到该位置！"},searchreplace:{"static":{lang_tab_search:"查找",lang_tab_replace:"替换",lang_search1:"查找",lang_search2:"查找",lang_replace:"替换",lang_searchReg:"支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”",lang_searchReg1:"支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”",lang_case_sensitive1:"区分大小写",lang_case_sensitive2:"区分大小写",nextFindBtn:{value:"下一个"},preFindBtn:{value:"上一个"},nextReplaceBtn:{value:"下一个"},preReplaceBtn:{value:"上一个"},repalceBtn:{value:"替换"},repalceAllBtn:{value:"全部替换"}},getEnd:"已经搜索到文章末尾！",getStart:"已经搜索到文章头部",countMsg:"总共替换了{#count}处！"},snapscreen:{"static":{lang_showMsg:"截图功能需要首先安装UEditor截图插件！ ",lang_download:"点此下载",lang_step1:"第一步，下载UEditor截图插件并运行安装。",lang_step2:"第二步，插件安装完成后即可使用，如不生效，请重启浏览器后再试！"}},spechars:{"static":{},tsfh:"特殊字符",lmsz:"罗马字符",szfh:"数学字符",rwfh:"日文字符",xlzm:"希腊字母",ewzm:"俄文字符",pyzm:"拼音字母",yyyb:"英语音标",zyzf:"其他"},edittable:{"static":{lang_tableStyle:"表格样式",lang_insertCaption:"添加表格名称行",lang_insertTitle:"添加表格标题行",lang_insertTitleCol:"添加表格标题列",lang_orderbycontent:"使表格内容可排序",lang_tableSize:"自动调整表格尺寸",lang_autoSizeContent:"按表格文字自适应",lang_autoSizePage:"按页面宽度自适应",lang_example:"示例",lang_borderStyle:"表格边框",lang_color:"颜色:"},captionName:"表格名称",titleName:"标题",cellsName:"内容",errorMsg:"有合并单元格，不可排序"},edittip:{"static":{lang_delRow:"删除整行",lang_delCol:"删除整列"}},edittd:{"static":{lang_tdBkColor:"背景颜色:"}},formula:{"static":{}},wordimage:{"static":{lang_resave:"转存步骤",uploadBtn:{src:"upload.png",alt:"上传"},clipboard:{style:"background: url(copy.png) -153px -1px no-repeat;"},lang_step:"1、点击顶部复制按钮，将地址复制到剪贴板；2、点击添加照片按钮，在弹出的对话框中使用Ctrl+V粘贴地址；3、点击打开后选择图片上传流程。"},fileType:"图片",flashError:"FLASH初始化失败，请检查FLASH插件是否正确安装！",netError:"网络连接错误，请重试！",copySuccess:"图片地址已经复制！",flashI18n:{}},autosave:{saving:"保存中...",success:"本地保存成功"}},function(){var e=this,t=e._,n={},i=Array.prototype,o=Object.prototype,r=Function.prototype,a=i.push,s=i.slice,l=i.concat,d=o.toString,c=o.hasOwnProperty,u=i.forEach,p=i.map,h=i.reduce,f=i.reduceRight,m=i.filter,g=i.every,b=i.some,v=i.indexOf,y=i.lastIndexOf,x=Array.isArray,_=Object.keys,w=r.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.5.2";var C=k.each=k.forEach=function(e,t,i){if(null!=e)if(u&&e.forEach===u)e.forEach(t,i);else if(e.length===+e.length){for(var o=0,r=e.length;r>o;o++)if(t.call(i,e[o],o,e)===n)return}else for(var a=k.keys(e),o=0,r=a.length;r>o;o++)if(t.call(i,e[a[o]],a[o],e)===n)return};k.map=k.collect=function(e,t,n){var i=[];return null==e?i:p&&e.map===p?e.map(t,n):(C(e,function(e,o,r){i.push(t.call(n,e,o,r))}),i)};var E="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,n,i){var o=arguments.length>2;if(null==e&&(e=[]),h&&e.reduce===h)return i&&(t=k.bind(t,i)),o?e.reduce(t,n):e.reduce(t);if(C(e,function(e,r,a){o?n=t.call(i,n,e,r,a):(n=e,o=!0)}),!o)throw new TypeError(E);return n},k.reduceRight=k.foldr=function(e,t,n,i){var o=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return i&&(t=k.bind(t,i)),o?e.reduceRight(t,n):e.reduceRight(t);var r=e.length;if(r!==+r){var a=k.keys(e);r=a.length}if(C(e,function(s,l,d){l=a?a[--r]:--r,o?n=t.call(i,n,e[l],l,d):(n=e[l],o=!0)}),!o)throw new TypeError(E);return n},k.find=k.detect=function(e,t,n){var i;return T(e,function(e,o,r){return t.call(n,e,o,r)?(i=e,!0):void 0}),i},k.filter=k.select=function(e,t,n){var i=[];return null==e?i:m&&e.filter===m?e.filter(t,n):(C(e,function(e,o,r){t.call(n,e,o,r)&&i.push(e)}),i)},k.reject=function(e,t,n){return k.filter(e,function(e,i,o){return!t.call(n,e,i,o)},n)},k.every=k.all=function(e,t,i){t||(t=k.identity);var o=!0;return null==e?o:g&&e.every===g?e.every(t,i):(C(e,function(e,r,a){return(o=o&&t.call(i,e,r,a))?void 0:n}),!!o)};var T=k.some=k.any=function(e,t,i){t||(t=k.identity);var o=!1;return null==e?o:b&&e.some===b?e.some(t,i):(C(e,function(e,r,a){return o||(o=t.call(i,e,r,a))?n:void 0}),!!o)};k.contains=k.include=function(e,t){return null!=e&&(v&&e.indexOf===v?e.indexOf(t)!=-1:T(e,function(e){return e===t}))},k.invoke=function(e,t){var n=s.call(arguments,2),i=k.isFunction(t);return k.map(e,function(e){return(i?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,t,n){return k.isEmpty(t)?n?void 0:[]:k[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},k.findWhere=function(e,t){return k.where(e,t,!0)},k.max=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&k.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return C(e,function(e,o,r){var a=t?t.call(n,e,o,r):e;a>i.computed&&(i={value:e,computed:a})}),i.value},k.min=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&k.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return C(e,function(e,o,r){var a=t?t.call(n,e,o,r):e;a<i.computed&&(i={value:e,computed:a})}),i.value},k.shuffle=function(e){var t,n=0,i=[];return C(e,function(e){t=k.random(n++),i[n-1]=i[t],i[t]=e}),i},k.sample=function(e,t,n){return arguments.length<2||n?e[k.random(e.length-1)]:k.shuffle(e).slice(0,Math.max(0,t))};var S=function(e){return k.isFunction(e)?e:function(t){return t[e]}};k.sortBy=function(e,t,n){var i=S(t);return k.pluck(k.map(e,function(e,t,o){return{value:e,index:t,criteria:i.call(n,e,t,o)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var N=function(e){return function(t,n,i){var o={},r=null==n?k.identity:S(n);return C(t,function(n,a){var s=r.call(i,n,a,t);e(o,s,n)}),o}};k.groupBy=N(function(e,t,n){(k.has(e,t)?e[t]:e[t]=[]).push(n)}),k.indexBy=N(function(e,t,n){e[t]=n}),k.countBy=N(function(e,t){k.has(e,t)?e[t]++:e[t]=1}),k.sortedIndex=function(e,t,n,i){n=null==n?k.identity:S(n);for(var o=n.call(i,t),r=0,a=e.length;a>r;){var s=r+a>>>1;n.call(i,e[s])<o?r=s+1:a=s}return r},k.toArray=function(e){return e?k.isArray(e)?s.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:s.call(e,0,t)},k.initial=function(e,t,n){return s.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var $=function(e,t,n){return t&&k.every(e,k.isArray)?l.apply(n,e):(C(e,function(e){k.isArray(e)||k.isArguments(e)?t?a.apply(n,e):$(e,t,n):n.push(e)}),n)};k.flatten=function(e,t){return $(e,t,[])},k.without=function(e){return k.difference(e,s.call(arguments,1))},k.uniq=k.unique=function(e,t,n,i){k.isFunction(t)&&(i=n,n=t,t=!1);var o=n?k.map(e,n,i):e,r=[],a=[];return C(o,function(n,i){(t?i&&a[a.length-1]===n:k.contains(a,n))||(a.push(n),r.push(e[i]))}),r},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(e){var t=s.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.indexOf(t,e)>=0})})},k.difference=function(e){var t=l.apply(i,s.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=k.max(k.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=k.pluck(arguments,""+n);return t},k.object=function(e,t){if(null==e)return{};for(var n={},i=0,o=e.length;o>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var i=0,o=e.length;if(n){if("number"!=typeof n)return i=k.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,o+n):n}if(v&&e.indexOf===v)return e.indexOf(t,n);for(;o>i;i++)if(e[i]===t)return i;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(y&&e.lastIndexOf===y)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var o=i?n:e.length;o--;)if(e[o]===t)return o;return-1},k.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),o=0,r=new Array(i);i>o;)r[o++]=e,e+=n;return r};var q=function(){};k.bind=function(e,t){var n,i;if(w&&e.bind===w)return w.apply(e,s.call(arguments,1));if(!k.isFunction(e))throw new TypeError;return n=s.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(s.call(arguments)));q.prototype=e.prototype;var o=new q;q.prototype=null;var r=e.apply(o,n.concat(s.call(arguments)));return Object(r)===r?r:o}},k.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},k.bindAll=function(e){var t=s.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return C(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var n={};return t||(t=k.identity),function(){var i=t.apply(this,arguments);return k.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},k.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(s.call(arguments,1)))},k.throttle=function(e,t,n){var i,o,r,a=null,s=0;n||(n={});var l=function(){s=n.leading===!1?0:new Date,a=null,r=e.apply(i,o)};return function(){var d=new Date;s||n.leading!==!1||(s=d);var c=t-(d-s);return i=this,o=arguments,0>=c?(clearTimeout(a),a=null,s=d,r=e.apply(i,o)):a||n.trailing===!1||(a=setTimeout(l,c)),r}},k.debounce=function(e,t,n){var i,o,r,a,s;return function(){r=this,o=arguments,a=new Date;var l=function(){var d=new Date-a;t>d?i=setTimeout(l,t-d):(i=null,n||(s=e.apply(r,o)))},d=n&&!i;return i||(i=setTimeout(l,t)),d&&(s=e.apply(r,o)),s}},k.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return function(){var n=[e];return a.apply(n,arguments),t.apply(this,n)}},k.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},k.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},k.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)k.has(e,n)&&t.push(n);return t},k.values=function(e){for(var t=k.keys(e),n=t.length,i=new Array(n),o=0;n>o;o++)i[o]=e[t[o]];return i},k.pairs=function(e){for(var t=k.keys(e),n=t.length,i=new Array(n),o=0;n>o;o++)i[o]=[t[o],e[t[o]]];return i},k.invert=function(e){for(var t={},n=k.keys(e),i=0,o=n.length;o>i;i++)t[e[n[i]]]=n[i];return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(e){return C(s.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},k.pick=function(e){var t={},n=l.apply(i,s.call(arguments,1));return C(n,function(n){n in e&&(t[n]=e[n])}),t},k.omit=function(e){var t={},n=l.apply(i,s.call(arguments,1));for(var o in e)k.contains(n,o)||(t[o]=e[o]);return t},k.defaults=function(e){return C(s.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var A=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var o=d.call(e);if(o!=d.call(t))return!1;switch(o){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=n.length;r--;)if(n[r]==e)return i[r]==t;var a=e.constructor,s=t.constructor;if(a!==s&&!(k.isFunction(a)&&a instanceof a&&k.isFunction(s)&&s instanceof s))return!1;n.push(e),i.push(t);var l=0,c=!0;if("[object Array]"==o){if(l=e.length,c=l==t.length)for(;l--&&(c=A(e[l],t[l],n,i)););}else{for(var u in e)if(k.has(e,u)&&(l++,!(c=k.has(t,u)&&A(e[u],t[u],n,i))))break;if(c){for(u in t)if(k.has(t,u)&&!l--)break;c=!l}}return n.pop(),i.pop(),c};k.isEqual=function(e,t){return A(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=x||function(e){return"[object Array]"==d.call(e)},k.isObject=function(e){return e===Object(e)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return d.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==d.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return c.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.times=function(e,t,n){for(var i=Array(Math.max(0,e)),o=0;e>o;o++)i[o]=t.call(n,o);return i},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=k.invert(I.escape);var D={escape:new RegExp("["+k.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(I.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return I[e][t]})}}),k.result=function(e,t){if(null!=e){var n=e[t];return k.isFunction(n)?n.call(e):n}},k.mixin=function(e){C(k.functions(e),function(t){var n=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),L.call(this,n.apply(k,e))}})};var R=0;k.uniqueId=function(e){var t=++R+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var U=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","        ":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,n){var i;n=k.defaults({},n,k.templateSettings);var o=new RegExp([(n.escape||U).source,(n.interpolate||U).source,(n.evaluate||U).source].join("|")+"|$","g"),r=0,a="__p+='";e.replace(o,function(t,n,i,o,s){return a+=e.slice(r,s).replace(B,function(e){return"\\"+O[e]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(a+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),o&&(a+="';\n"+o+"\n__p+='"),r=s+t.length,t}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(n.variable||"obj","_",a)}catch(s){throw s.source=a,s}if(t)return i(t,k);var l=function(e){return i.call(this,e,k)};return l.source="function("+(n.variable||"obj")+"){\n"+a+"}",l},k.chain=function(e){return k(e).chain()};var L=function(e){return this._chain?k(e).chain():e};k.mixin(k),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];k.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],L.call(this,n)}}),C(["concat","join","slice"],function(e){var t=i[e];k.prototype[e]=function(){return L.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var e,t=this,n=t.Backbone,i=[],o=(i.push,i.slice);i.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.1.0";var r=t._;r||"undefined"==typeof require||(r=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var i=this,o=r.once(function(){i.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,n)},off:function(e,t,n){var i,o,a,s,d,c,u,p;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(s=e?[e]:r.keys(this._events),d=0,c=s.length;d<c;d++)if(e=s[d],a=this._events[e]){if(this._events[e]=i=[],t||n)for(u=0,p=a.length;u<p;u++)o=a[u],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&i.push(o);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&d(n,t),i&&d(i,arguments),this},stopListening:function(e,t,n){var i=this._listeningTo;if(!i)return this;var o=!t&&!n;n||"object"!=typeof t||(n=this),e&&((i={})[e._listenId]=e);for(var a in i)e=i[a],e.off(t,n,this),(o||r.isEmpty(e._events))&&delete this._listeningTo[a];return this}},s=/\s+/,l=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)e[t].apply(e,[o,n[o]].concat(i));return!1}if(s.test(n)){for(var r=n.split(s),a=0,l=r.length;a<l;a++)e[t].apply(e,[r[a]].concat(i));return!1}return!0},d=function(e,t){var n,i=-1,o=e.length,r=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++i<o;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=e[i]).callback.call(n.ctx,r);return;case 2:for(;++i<o;)(n=e[i]).callback.call(n.ctx,r,a);return;case 3:for(;++i<o;)(n=e[i]).callback.call(n.ctx,r,a,s);return;default:for(;++i<o;)(n=e[i]).callback.apply(n.ctx,t)}},c={listenTo:"on",listenToOnce:"once"};r.each(c,function(e,t){a[t]=function(t,n,i){var o=this._listeningTo||(this._listeningTo={}),a=t._listenId||(t._listenId=r.uniqueId("l"));return o[a]=t,i||"object"!=typeof n||(i=this),t[e](n,i,this),this}}),a.bind=a.on,a.unbind=a.off,r.extend(e,a);var u=e.Model=function(e,t){var n=e||{};t||(t={}),this.cid=r.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=r.defaults({},n,r.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};r.extend(u.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return r.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return r.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var i,o,a,s,l,d,c,u;if(null==e)return this;if("object"==typeof e?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;a=n.unset,l=n.silent,s=[],d=this._changing,this._changing=!0,d||(this._previousAttributes=r.clone(this.attributes),this.changed={}),u=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(i in o)t=o[i],r.isEqual(u[i],t)||s.push(i),r.isEqual(c[i],t)?delete this.changed[i]:this.changed[i]=t,a?delete u[i]:u[i]=t;if(!l){s.length&&(this._pending=!0);for(var p=0,h=s.length;p<h;p++)this.trigger("change:"+s[p],this,u[s[p]],n)}if(d)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,r.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,r.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!r.isEmpty(this.changed):r.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&r.clone(this.changed);var t,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in e)r.isEqual(i[o],t=e[o])||((n||(n={}))[o]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return!!t.set(t.parse(i,e),e)&&(n&&n(t,i,e),void t.trigger("sync",t,i,e))},O(this,e),this.sync("read",this,e)},save:function(e,t,n){var i,o,a,s=this.attributes;if(null==e||"object"==typeof e?(i=e,n=t):(i={})[e]=t,n=r.extend({validate:!0},n),i&&!n.wait){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=r.extend({},s,i)),void 0===n.parse&&(n.parse=!0);var l=this,d=n.success;return n.success=function(e){l.attributes=s;var t=l.parse(e,n);return n.wait&&(t=r.extend(i||{},t)),!(r.isObject(t)&&!l.set(t,n))&&(d&&d(l,e,n),void l.trigger("sync",l,e,n))},O(this,n),o=this.isNew()?"create":n.patch?"patch":"update","patch"===o&&(n.attrs=i),a=this.sync(o,this,n),i&&n.wait&&(this.attributes=s),a},destroy:function(e){e=e?r.clone(e):{};var t=this,n=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(o){(e.wait||t.isNew())&&i(),n&&n(t,o,e),t.isNew()||t.trigger("sync",t,o,e);
},this.isNew())return e.success(),!1;O(this,e);var o=this.sync("delete",this,e);return e.wait||i(),o},url:function(){var e=r.result(this,"urlRoot")||r.result(this.collection,"url")||U();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},r.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=r.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,r.extend(t,{validationError:n})),!1)}});var p=["keys","values","pairs","invert","pick","omit"];r.each(p,function(e){u.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),r[e].apply(r,t)}});var h=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,r.extend({silent:!0},t))},f={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};r.extend(h.prototype,a,{model:u,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,r.extend({merge:!1},t,m))},remove:function(e,t){var n=!r.isArray(e);e=n?[e]:r.clone(e),t||(t={});var i,o,a,s;for(i=0,o=e.length;i<o;i++)s=e[i]=this.get(e[i]),s&&(delete this._byId[s.id],delete this._byId[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,t.silent||(t.index=a,s.trigger("remove",s,this,t)),this._removeReference(s));return n?e[0]:e},set:function(e,t){t=r.defaults({},t,f),t.parse&&(e=this.parse(e,t));var n=!r.isArray(e);e=n?e?[e]:[]:r.clone(e);var i,o,a,s,l,d,c,p=t.at,h=this.model,m=this.comparator&&null==p&&t.sort!==!1,g=r.isString(this.comparator)?this.comparator:null,b=[],v=[],y={},x=t.add,_=t.merge,w=t.remove,k=!(m||!x||!w)&&[];for(i=0,o=e.length;i<o;i++){if(l=e[i],a=l instanceof u?s=l:l[h.prototype.idAttribute],d=this.get(a))w&&(y[d.cid]=!0),_&&(l=l===s?s.attributes:l,t.parse&&(l=d.parse(l,t)),d.set(l,t),m&&!c&&d.hasChanged(g)&&(c=!0)),e[i]=d;else if(x){if(s=e[i]=this._prepareModel(l,t),!s)continue;b.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)}k&&k.push(d||s)}if(w){for(i=0,o=this.length;i<o;++i)y[(s=this.models[i]).cid]||v.push(s);v.length&&this.remove(v,t)}if(b.length||k&&k.length)if(m&&(c=!0),this.length+=b.length,null!=p)for(i=0,o=b.length;i<o;i++)this.models.splice(p+i,0,b[i]);else{k&&(this.models.length=0);var C=k||b;for(i=0,o=C.length;i<o;i++)this.models.push(C[i])}if(c&&this.sort({silent:!0}),!t.silent){for(i=0,o=b.length;i<o;i++)(s=b[i]).trigger("add",s,this,t);(c||k&&k.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),e=this.add(e,r.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,r.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,r.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return r.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),r.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(r.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return r.invoke(this.models,"get",e)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var o=e.reset?"reset":"set";n[o](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},O(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?r.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,i=t.success;return t.success=function(e,t,o){o.wait&&n.add(e,o),i&&i(e,t,o)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof u)return e.collection||(e.collection=this),e;t=t?r.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(g,function(e){h.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),r[e].apply(r,t)}});var b=["groupBy","countBy","sortBy"];r.each(b,function(e){h.prototype[e]=function(t,n){var i=r.isFunction(t)?t:function(e){return e.get(t)};return r[e](this.models,i,n)}});var v=e.View=function(e){this.cid=r.uniqueId("view"),e||(e={}),r.extend(this,r.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},y=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];r.extend(v.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=r.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(r.isFunction(n)||(n=this[e[t]]),n){var i=t.match(y),o=i[1],a=i[2];n=r.bind(n,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,n):this.$el.on(o,a,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(r.result(this,"el"),!1);else{var t=r.extend({},r.result(this,"attributes"));this.id&&(t.id=r.result(this,"id")),this.className&&(t["class"]=r.result(this,"className"));var n=e.$("<"+r.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,i){var o=w[t];r.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(i.url||(a.url=r.result(n,"url")||U()),null!=i.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),i.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",i.emulateJSON&&(a.data._method=o);var s=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),s)return s.apply(this,arguments)}}"GET"===a.type||i.emulateJSON||(a.processData=!1),"PATCH"===a.type&&_&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=i.xhr=e.ajax(r.extend(a,i));return n.trigger("request",n,l,i),l};var _=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var k=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,T=/\*\w+/g,S=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(k.prototype,a,{initialize:function(){},route:function(t,n,i){r.isRegExp(t)||(t=this._routeToRegExp(t)),r.isFunction(n)&&(i=n,n=""),i||(i=this[n]);var o=this;return e.history.route(t,function(r){var a=o._extractParameters(t,r);i&&i.apply(o,a),o.trigger.apply(o,["route:"+n].concat(a)),o.trigger("route",n,a),e.history.trigger("route",o,n,a)}),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=r.result(this,"routes");for(var e,t=r.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(S,"\\$&").replace(C,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/]+)"}).replace(T,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return r.map(n,function(e){return e?decodeURIComponent(e):null})}});var N=e.History=function(){this.handlers=[],r.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},$=/^[#\/]|\s+$/g,q=/^\/+|\/+$/g,A=/msie [\w.]+/,I=/\/$/,D=/[?#].*$/;N.started=!1,r.extend(N.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(I,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace($,"")},start:function(t){if(N.started)throw new Error("Backbone.history has already been started");N.started=!0,this.options=r.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,o=A.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(q,"/"),o&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location,s=a.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&s&&a.hash&&(this.fragment=this.getHash().replace($,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),N.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t!==this.fragment&&(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),r.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!N.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(D,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),e.history=new N;var R=function(e,t){var n,i=this;n=e&&r.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},r.extend(n,i,t);var o=function(){this.constructor=n};return o.prototype=i.prototype,n.prototype=new o,e&&r.extend(n.prototype,e),n.__super__=i.prototype,n};u.extend=h.extend=k.extend=v.extend=N.extend=R;var U=function(){throw new Error('A "url" property or function must be specified')},O=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}}}.call(this);var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,o){!n&&hasProp(e,o)||(!i||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[o]=t:(e[o]||(e[o]={}),mixin(e[o],t,n,i)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,i){var o=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return o.requireType=e,o.requireModules=i,n&&(o.originalError=n),o}function newContext(e){function t(e){var t,n;for(t=0;t<e.length;t++)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var o,r,a,s,l,d,c,u,p,h,f,m,g=n&&n.split("/"),b=k.map,v=b&&b["*"];if(e&&(e=e.split("/"),c=e.length-1,k.nodeIdCompat&&jsSuffixRegExp.test(e[c])&&(e[c]=e[c].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&g&&(m=g.slice(0,g.length-1),e=m.concat(e)),t(e),e=e.join("/")),i&&b&&(g||v)){a=e.split("/");e:for(s=a.length;s>0;s-=1){if(d=a.slice(0,s).join("/"),g)for(l=g.length;l>0;l-=1)if(r=getOwn(b,g.slice(0,l).join("/")),r&&(r=getOwn(r,d))){u=r,p=s;break e}!h&&v&&getOwn(v,d)&&(h=getOwn(v,d),f=s)}!u&&h&&(u=h,p=f),u&&(a.splice(0,p,u),e=a.join("/"))}return o=getOwn(k.pkgs,e),o?o:e}function i(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===x.contextName)return t.parentNode.removeChild(t),!0})}function o(e){var t=getOwn(k.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),x.require.undef(e),x.makeRequire(null,{skipMap:!0})([e]),!0}function r(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(e,t,i,o){var a,s,l,d,c=null,u=t?t.name:null,p=e,h=!0,f="";return e||(h=!1,e="_@r"+(A+=1)),d=r(e),c=d[0],e=d[1],c&&(c=n(c,u,o),s=getOwn(N,c)),e&&(c?f=s&&s.normalize?s.normalize(e,function(e){return n(e,u,o)}):e.indexOf("!")===-1?n(e,u,o):e:(f=n(e,u,o),d=r(f),c=d[0],f=d[1],i=!0,a=x.nameToUrl(f))),l=!c||s||i?"":"_unnormalized"+(I+=1),{prefix:c,name:f,parentMap:t,unnormalized:!!l,url:a,originalName:p,isDefine:h,id:(c?c+"!"+f:f)+l}}function s(e){var t=e.id,n=getOwn(C,t);return n||(n=C[t]=new x.Module(e)),n}function l(e,t,n){var i=e.id,o=getOwn(C,i);!hasProp(N,i)||o&&!o.defineEmitComplete?(o=s(e),o.error&&"error"===t?n(o.error):o.on(t,n)):"defined"===t&&n(N[i])}function d(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=getOwn(C,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function c(){globalDefQueue.length&&(apsp.apply(S,[S.length,0].concat(globalDefQueue)),globalDefQueue=[])}function u(e){delete C[e],delete E[e]}function p(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,o){var r=i.id,a=getOwn(C,r);!a||e.depMatched[o]||n[r]||(getOwn(t,r)?(e.defineDep(o,N[r]),e.check()):p(a,t,n))}),n[i]=!0)}function h(){var e,t,n=1e3*k.waitSeconds,r=n&&x.startTime+n<(new Date).getTime(),a=[],s=[],l=!1,c=!0;if(!v){if(v=!0,eachProp(E,function(e){var n=e.map,d=n.id;if(e.enabled&&(n.isDefine||s.push(e),!e.error))if(!e.inited&&r)o(d)?(t=!0,l=!0):(a.push(d),i(d));else if(!e.inited&&e.fetched&&n.isDefine&&(l=!0,!n.prefix))return c=!1}),r&&a.length)return e=makeError("timeout","Load timeout for modules: "+a,null,a),e.contextName=x.contextName,d(e);c&&each(s,function(e){p(e,{},{})}),r&&!t||!l||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,h()},50)),v=!1}}function f(e){hasProp(N,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function m(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function g(e){var t=e.currentTarget||e.srcElement;return m(t,x.onScriptLoad,"load","onreadystatechange"),m(t,x.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function b(){var e;for(c();S.length;){if(e=S.shift(),null===e[0])return d(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}}var v,y,x,_,w,k={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},C={},E={},T={},S=[],N={},$={},q={},A=1,I=1;return _={require:function(e){return e.require?e.require:e.require=x.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?N[e.map.id]=e.exports:e.exports=N[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(k.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},y=function(e){this.events=getOwn(T,e.id)||{},this.map=e,this.shim=getOwn(k.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,x.startTime=(new Date).getTime();var e=this.map;return this.shim?void x.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;$[e]||($[e]=!0,x.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,o=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=x.execCb(n,r,i,o)}catch(a){e=a}else o=x.execCb(n,r,i,o);if(this.map.isDefine&&void 0===o&&(t=this.module,t?o=t.exports:this.usingExports&&(o=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",d(this.error=e)}else o=r;this.exports=o,this.map.isDefine&&!this.ignore&&(N[n]=o,req.onResourceLoad&&req.onResourceLoad(x,this.map,this.depMaps)),u(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=a(e.prefix);this.depMaps.push(i),l(i,"defined",bind(this,function(i){var o,r,c,p=getOwn(q,this.map.id),h=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,m=x.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(h=i.normalize(h,function(e){return n(e,f,!0)})||""),r=a(e.prefix+"!"+h,this.map.parentMap),l(r,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),c=getOwn(C,r.id),void(c&&(this.depMaps.push(r),this.events.error&&c.on("error",bind(this,function(e){this.emit("error",e)})),c.enable()))):p?(this.map.url=x.nameToUrl(p),void this.load()):(o=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),o.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(C,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&u(e.map.id)}),d(e)}),o.fromText=bind(this,function(n,i){var r=e.name,l=a(r),c=useInteractive;i&&(n=i),c&&(useInteractive=!1),s(l),hasProp(k.config,t)&&(k.config[r]=k.config[t]);try{req.exec(n)}catch(u){return d(makeError("fromtexteval","fromText eval for "+t+" failed: "+u,u,[t]))}c&&(useInteractive=!0),this.depMaps.push(l),x.completeLoad(r),m([r],o)}),void i.load(e.name,m,o,k))})),x.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){E[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,o;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(_,e.id))return void(this.depExports[t]=o(this));this.depCount+=1,l(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?l(e,"error",bind(this,this.errback)):this.events.error&&l(e,"error",bind(this,function(e){this.emit("error",e)}))}n=e.id,i=C[n],hasProp(_,n)||!i||i.enabled||x.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(C,e.id);t&&!t.enabled&&x.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},x={config:k,contextName:e,registry:C,defined:N,urlFetched:$,defQueue:S,Module:y,makeModuleMap:a,nextTick:req.nextTick,onError:d,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=k.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(k[t]||(k[t]={}),mixin(k[t],e,!0,!0)):k[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(q[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,n){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=x.makeShimExports(e)),t[n]=e}),k.shim=t),e.packages&&each(e.packages,function(e){var t,n;e="string"==typeof e?{name:e}:e,n=e.name,t=e.location,t&&(k.paths[n]=e.location),k.pkgs[n]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(C,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t,null,!0))}),(e.deps||e.callback)&&x.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,o){function r(n,i,l){var c,u,p;return o.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?d(makeError("requireargs","Invalid require call"),l):t&&hasProp(_,n)?_[n](C[t.id]):req.get?req.get(x,n,t,r):(u=a(n,t,!1,!0),c=u.id,hasProp(N,c)?N[c]:d(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(b(),x.nextTick(function(){b(),p=s(a(null,t)),p.skipMap=o.skipMap,p.init(n,i,l,{enabled:!0}),h()}),r)}return o=o||{},mixin(r,{isBrowser:isBrowser,toUrl:function(e){var i,o=e.lastIndexOf("."),r=e.split("/")[0],a="."===r||".."===r;return o!==-1&&(!a||o>1)&&(i=e.substring(o,e.length),e=e.substring(0,o)),x.nameToUrl(n(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(N,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(N,e)||hasProp(C,e)}}),t||(r.undef=function(e){c();var n=a(e,t,!0),o=getOwn(C,e);o.undefed=!0,i(e),delete N[e],delete $[n.url],delete T[e],eachReverse(S,function(t,n){t[0]===e&&S.splice(n,1)}),o&&(o.events.defined&&(T[e]=o.events),u(e))}),r},enable:function(e){var t=getOwn(C,e.id);t&&s(e).enable()},completeLoad:function(e){var t,n,i,r=getOwn(k.shim,e)||{},a=r.exports;for(c();S.length;){if(n=S.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);f(n)}if(i=getOwn(C,e),!t&&!hasProp(N,e)&&i&&!i.inited){if(!(!k.enforceDefine||a&&getGlobal(a)))return o(e)?void 0:d(makeError("nodefine","No define call for "+e,null,[e]));f([e,r.deps||[],r.exportsFn])}h()},nameToUrl:function(e,t,n){var i,o,r,a,s,l,d,c=getOwn(k.pkgs,e);if(c&&(e=c),d=getOwn(q,e))return x.nameToUrl(d,t,n);if(req.jsExtRegExp.test(e))s=e+(t||"");else{for(i=k.paths,o=e.split("/"),r=o.length;r>0;r-=1)if(a=o.slice(0,r).join("/"),l=getOwn(i,a)){isArray(l)&&(l=l[0]),o.splice(0,r,l);break}s=o.join("/"),s+=t||(/^data\:|\?/.test(s)||n?"":".js"),s=("/"===s.charAt(0)||s.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+s}return k.urlArgs?s+((s.indexOf("?")===-1?"?":"&")+k.urlArgs):s},load:function(e,t){req.load(x,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=g(e);x.completeLoad(t.id)}},onScriptError:function(e){var t=g(e);if(!o(t.id))return d(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},x.require=x.makeRequire(),x}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.18",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var o,r,a=defContextName;return isArray(e)||"string"==typeof e||(r=e,isArray(t)?(e=t,t=n,n=i):e=[]),r&&r.context&&(a=r.context),o=getOwn(contexts,a),o||(o=contexts[a]=req.s.newContext(a)),r&&o.configure(r),o.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var i=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return i.type=e.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i},req.load=function(e,t,n){var i,o=e&&e.config||{};if(isBrowser)return i=req.createNode(o,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(r){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,r,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,n){var i,o;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),o=contexts[i.getAttribute("data-requirecontext")])),(o?o.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),requirejs.config({baseUrl:"//common1.qyerstatic.com/bbs/",urlArgs:"v="+window.__qRequire__.version,map:{"*":{css:"common/models/basic/js/require-css",text:"common/models/basic/js/text"}},paths:{web_ct_logindialog:"bower_components/web_ct_logindialog/loginDialog",web_ct_logindialog_loginFormValid:"bower_components/web_ct_logindialog/loginFormValid",web_ct_antispam:"bower_components/web_ct_antispam/antiSpam",web_old_popup:"bower_components/web_old_popup/popup",web_old_select:"bower_components/web_old_select/select",web_old_tip:"bower_components/web_old_tip/tip",web_old_popup2:"bower_components/web_old_popup2/popup2",web_old_loading:"bower_components/web_old_loading/loading",web_ct_submitBeforeValidCode:"bower_components/web_ct_submitBeforeValidCode/submitBeforeValidCode",web_lib_jquerymousewheel:"bower_components/web_lib_jquerymousewheel/jquery.mousewheel",web_lib_jquerylazyload:"bower_components/web_lib_jquerylazyload/jquery.lazyload",web_old_tooltips:"bower_components/web_old_tooltips/tooltip",web_old_slidconfirm:"bower_components/web_old_slidconfirm/slidconfirm",web_old_confirm:"bower_components/web_old_confirm/confirm",web_old_share:"bower_components/web_old_share/share",web_old_textarea:"bower_components/web_old_textarea/textArea",web_old_inputautocomplete:"bower_components/web_old_inputautocomplete/inputAutocomplete",web_lib_template:"bower_components/web_lib_template/template",web_qui_controlbase:"bower_components/web_qui_controlbase/controlBase",web_qui_quiupload:"bower_components/web_qui_quiupload/QuiUpload",web_qui_quiupload_qiniu:"bower_components/web_qui_quiupload/qiniu",plupload:"bower_components/web_qui_quiupload/lib/plupload/plupload.full.min",web_old_datepicker:"bower_components/web_old_datepicker/datepicker",web_lib_jqueryuicore:"bower_components/web_lib_jqueryuicore/jquery.ui.core.min",web_ct_addlisttoplan:"bower_components/web_ct_addlisttoplan/addListToPlan",
web_old_inputvalidation:"bower_components/web_old_inputvalidation/inputValidation",web_ct_openAsk:"bower_components/web_ct_openAsk/openAsk",web_ct_uploadpopup:"bower_components/web_ct_uploadpopup/uploadPopup"}}),window.QYER||(window.QYER={uid:0}),!function(){var e=jQuery;!function(){window.qyerUtil={init:function(){window.QYER&&window.QYER.frameVersion>1&&(this._initHead(),this.spam_text_filter(),this.includeGA(),this.frameCompatibleh())},frameCompatibleh:function(){window._qyer_userid=window.QYER.uid,window.setCookie=this.setCookie,window.getCookie=this.getCookie,window._gaq=window._gaq||[]},includeGA:function(){window._gaq=window._gaq||[],window._gaq.push(["_setAccount","UA-185023-1"],["_setDomainName","qyer.com"],["_setSiteSpeedSampleRate",10],["_addIgnoredRef","qyer.com"],["_addOrganic","soso","w"],["_addOrganic","sogou","query"],["_addOrganic","baidu","word"],["_addOrganic","baidu","q1"],["_addOrganic","baidu","q2"],["_addOrganic","m.baidu","word"],["_addOrganic","so.360","q"],["_addOrganic","so","q"],["_addOrganic","baidu","w"],["_addOrganic","cn.bing","q"],["_addOrganic","sm","q"],["_trackPageview"]),requirejs("https:"==document.location.protocol?["https://ssl.google-analytics.com/ga.js"]:["http://www.google-analytics.com/ga.js"])},setCookie:function(e,t,n){var i=365,o=new Date;arguments[2]||(n=1),1==n?(o.setTime(o.getTime()+24*i*60*60*1e3),document.cookie=e+"="+escape(t)+"; path=/;domain=.qyer.com;expires="+o.toGMTString()):document.cookie=e+"="+escape(t)+"; path=/;domain=.qyer.com",i=o=null},getCookie:function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?unescape(t[2]):null},_initHead:function(){"ask.qyer.com"==window.location.hostname&&e(".qyer_header_bg").css("position","fixed")},_head:null,_getHead:function(){return this._head||(this._head=document.getElementsByTagName("head")[0]),this._head},loadCss:function(t,n){n===!1?this.insertStyle(e.ajax({url:t,async:!1}).responseText):e('<link rel="stylesheet" type="text/css" />').attr("href",t).appendTo(this._getHead())},insertStyle:function(e){var t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.innerHTML=e,this._getHead().appendChild(t),t=null},sliceArguments:function(e,t){for(var n=[],i=t;i<e.length;i++)n.push(e[i]);return n},isMobile:function(){var e=navigator.userAgent;return e.match(/Android/i)||-1!=e.indexOf("iPhone")||-1!=e.indexOf("iPad")},getWordLen:function(t,n){function i(e){if("undefined"==typeof e)return 0;var t=e.match(/[^\x00-\x80]/g);return e.length+(t?t.length:0)}function o(e){return e.replace(/[^\x00-\xff]/g,"*")}return n&&(t=o(t)),i(e.trim(t))},subStr:function(e,t){for(var n,i,o=0,r=0;r<e.length;r++)if(n=e.charAt(r),o+=encodeURI(n).length>2?1:.5,o>=t)return i=o==t?r+1:r,e.substr(0,i);return e},doTrackCode:function(t){var n="__dotarckcodebutton__";document.getElementById(n)||e('<button id="'+n+'" style="display:none;">dotarckcodebutton</button>').appendTo(document.body),e("#"+n).attr("data-bn-ipg",t).trigger("click"),n=null},ajaxFillter:function(e,t,n){if(0!=window.location.href.indexOf("http://plan.qyer.com")&&"object"==typeof e&&e.extra&&e.extra.code)switch(0|e.extra.code){case 1:window.qyerUtil.showAntiSpam(e.extra.msg)}},showAntiSpam:function(e){requirejs(["web_ct_antispam"],function(t){t.show(e)})},doAjax:function(t){var n,i,o;if(n=t.minResponseTime?new Date:null,o=function(e){if("undefined"==typeof e.error_code)try{e.error_code=e.error,e.result=e.result,0!=e.error_code&&(e.data=e.data||{},e.data.msg=e.msg)}catch(n){}0==e.error_code?("undefined"==typeof e.data&&(e.data=t.__defaultData__),t.onCallSuccessBefore&&t.onCallSuccessBefore(e),t.onSuccess&&t.onSuccess(e),t.onCallSuccessAfter&&t.onCallSuccessAfter(e)):t.onError&&t.onError(e)},t.testData)return"undefined"==typeof t.testData.data&&(t.testData.data=t.__defaultData__),void setTimeout(function(){o(t.testData)},t.minResponseTime||200);var r=window.location.host,a=t.url||t.posturl,s=t.data,l="json";if(/static.qyer.com/.test(r)===!0||/qyerstatic.com/.test(r)===!0){var d;s=e.extend({},s,{__qFED__:t.__qFED__}),t.__qFED__&&t.__qFED__.id&&(d=t.__qFED__.id,t.type="GET"),a="http://fe.2b6.me:3000/service/api/"+d,l="jsonp",api=null}var c=e.ajax({type:t.type||"POST",url:a,dataType:l,data:s,cache:t.cache||!1,success:function(e){n?(i=new Date-n,setTimeout(function(){o.call(null,e)},i>t.minResponseTime?0:t.minResponseTime-i)):o.call(null,e),n=i=null},error:function(e,n){t.onError&&t.onError({error_code:-1,__server_error__:!0,__server_status__:c.statusText,result:"error",data:{msg:n||{}}})}});return c},runOneInPeriodOfTime:function(e,t){var n;return function(i,o,r,a,s){window.clearTimeout(n),n=window.setTimeout(function(){e(i,o,r,a,s)},t||300)}},isLogin:function(){return!(!window.QYER||!window.QYER.uid)},doLogin:function(e){window.qyerUtil.isLogin()||requirejs(["web_ct_logindialog"],function(t){t.show(e)})},doSignin:function(t){requirejs(["web_ct_logindialog"],function(n){n.show(e.extend({},{page:"regist"},t))})},getUrlParam:function(e,t){var n,i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");if(t){var o=t.indexOf("?");-1!=o&&(n=t.substr(t.indexOf("?")+1))}else n=window.location.search.substr(1);if(!n)return null;var r=n.match(i);return null!=r?unescape(r[2]):null},spam_text_filter:function(){var t,n,i,o,r;t=/(http:\/\/)?[\w\.]*\.?(mafengwo\.cn|mafengwo\.com|mafengwo\.net)[a-zA-Z\/0-9&\?\.#\-_]*/gim,r=e(".qyer_spam_text_filter"),r.find("a").each(function(){n=e(this),(-1!=(n.html()+n.attr("href")).indexOf("mafengwo.cn")||-1!=(n.html()+n.attr("href")).indexOf("mafengwo.com")||-1!=(n.html()+n.attr("href")).indexOf("mafengwo.net"))&&n.replaceWith(e(this).html())}),r.each(function(){if(n=e(this),i=n.html().replace(/\<script.*?\>document\.write\(AC_FL_RunContent.*?\<\/script\>/gim,""),o=i.match(/\<img[\s\S]*?\>/gim),null!=o)for(var r=0;r<o.length;r++)i=i.replace(o[r],"[imgimg]"+r+"[/imgimg]");if(i=i.replace(t,""),null!=o)for(var r=0;r<o.length;r++)i=i.replace("[imgimg]"+r+"[/imgimg]",o[r]);n.html(i)}),t=n=i=o=r=null},openUrl:function(t){var n=e('<form action="'+t+'" target="_blank" method="get"></form>');n.appendTo(document.body),n.submit(),setTimeout(function(){n.remove(),n=null},8e3)}}}(),!function(){function e(e,t){for(var n in t)e[n]=t[n]}e(Date.prototype,{qGetWeekStr:function(){return"星期"+["日","一","二","三","四","五","六"][this.getDay()]},qAddDate:function(e){return this.setDate(this.getDate()+e),this},qToString:function(e){var t=[this.getFullYear(),this.getMonth()+1,this.getDate()];return t.join(e||"-")}}),e(String.prototype,{qToDate:function(e){var t=this.split(e||"-");t=[0|t[0],(0|t[1])-1,0|t[2]];var n=new Date(t[0],t[1],t[2]);return t.length=0,t=null,n},qToIntFixed:function(){var e=0|this;return 10>e?"0"+e:e.toString()},qToHTML:function(){return this.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\n/gi,"<br />").replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;")}})}()}(),$(function(){qyerUtil.init()});var BBS_Url={createAlbum:"/qcross/pictrip/album.php?action=createAlbum",getMyAlbumList:"/qcross/pictrip/album.php?action=getMyAlbumList",getAlbumPhotoPage:"/qcross/pictrip/album.php?action=getAlbumPhotoPage",addAttach2ssdb:"/qcross/bbs/attachment.php?action=addAttach2ssdb",getHashAttach:"/qcross/bbs/attachment.php?action=getHashAttach",uploadAttach:"/qcross/bbs/attachment.php?action=uploadAttach",saveUploadAlbumPhoto:"/attachment.php?action=saveUploadAlbumPhoto",searchphotopoi:"/qcross/place/poi.php?action=poisearch",editPhotoPlace:"/qcross/pictrip/detail.php?action=editPhotoPlace",editPhotoDescript:"/qcross/pictrip/detail.php?action=editPhotoDescript",getNewPhoto:"/qcross/pictrip/detail.php?action=getNewPhoto",rotate:"/qcross/pictrip/index.php?action=rotate",opensession:"/qcross/pictrip/api.php?action=createalbum&oper=showform",singleCreateAlbum:"/qcross/pictrip/api.php?action=createalbum",checkVideo:"/qcross/bbs/thread.php?action=videoUrl",fontfix:"/post.php?action=fontfix"};window.qyerUtil.insertStyle([".qui-feedback { position:fixed; _position:absolute; z-index:99; top:120px; right:-246px; display:none;}",".qui-feedback .icon { float:left; width:24px; height:150px; background:url(//static.qyer.com/models/common/component/feedback/icons_feedback.png) 0 0 no-repeat; cursor:pointer;}",".qui-feedback.js-current > .icon { background-position:-29px 0;}",".qui-feedback .cnt { float:left; width:246px; height:280px; background-color:#e8e4df;}",".qui-feedback .cnt form { padding:10px; font-size:0;}",".qui-feedback .cnt textarea { width:214px; height:192px; padding:2px 5px; border:1px solid #ccc; font-size:12px;}",".qui-feedback .cnt input { float:right; margin-top:10px;}",".qui-feedback .help { position:relative; top:-1px; border:1px solid #ccc; border-top:none; background:#fefdc9; height:24px; line-height:22px; text-align:center;font-size:12px;}",".qui-feedback .help a { font-weight:bold; }"].join("")),setTimeout(function(){!function(){function e(){this.init()}var t;e.prototype={$div:null,init:function(){this.createDom(),this.bindEvt()},tip:function(e){requirejs(["common/models/common/ui/tip/tip"],function(t){t.tip(e)})},createDom:function(){var e=['<div class="qui-feedback">','<div class="icon js-btn" title="意见反馈"></div>','<div class="cnt">','<form method="post">','<textarea class="js-feedback-cnt" cols="50" rows="10" placeholder="有任何意见或建议请告诉我们"></textarea>','<p class="help">使用遇到问题？请先进入<a href="//bbs.qyer.com/forum-10-1.html" target="_blank">帮助中心</a></p>','<input class="ui_button js-submitBtn" type="button" value="提交" class="ui_button">',"</form>","</div>","</div>"].join("");$(document.body).append(e),this.$div=$(".qui-feedback").fadeIn(300),$div=null},showLogin:function(){window.qyerUtil.doLogin()},bindEvt:function(){var e=this;this.$div.on("click",".js-btn",function(t){e[e.$div.hasClass("js-current")?"hideDiv":"showDiv"]()}).on("click","textarea.js-feedback-cnt",function(e){window.QYER&&window.QYER.uid||t.showLogin()}).on("click","input.js-submitBtn",function(n){if(window.QYER&&window.QYER.uid){var i=e.checkForm();i&&e.submitForm(i)}else t.showLogin()}),$(document).on("click",function(t){var n=$(t.target);n.closest(".qui-feedback").size()<1&&e.hideDiv()})},showDiv:function(){var e=this;this.$div.animate({right:0},200,function(){e.$div.addClass("js-current")})},hideDiv:function(){var e=this;this.$div.animate({right:-246},200,function(){e.$div.removeClass("js-current")})},checkValue:{cnt:function(e){var n=$(".js-feedback-cnt").val();if(n=$.trim(n),""==n||"有任何意见或建议请告诉我们"==n)return t.tip({text:"意见或建议不能为空",type:"error"}),!1;var i=window.qyerUtil.getWordLen(n);return i<20?(t.tip({text:"不能少于10个字",type:"error"}),!1):n}},checkForm:function(){var e=this.$div.find(".js-feedback-cnt").val();return this.checkValue.cnt(e)},submitForm:function(e){var n=this,i={data:{cnt:e,url:location.href},onSuccess:function(e){n.$div.find("textarea.js-feedback-cnt").val(""),t.tip({text:e.data.msg})},onError:function(e){77==e.error_code?t.showLogin():t.tip({text:ret.data.msg,type:"error"})}};this.postFeedback(i)},postFeedback:function(e){e.posturl="/api_action_feedback",window.qyerUtil.doAjax(e)}},t=new e}()},3e3),!function(e,t,n,i){var o=e(t);e.fn.lazyload=function(r){function a(){var t=0;l.each(function(){var n=e(this);if(!d.skip_invisible||n.is(":visible"))if(e.abovethetop(this,d)||e.leftofbegin(this,d));else if(e.belowthefold(this,d)||e.rightoffold(this,d)){if(++t>d.failure_limit)return!1}else n.trigger("appear"),t=0})}var s,l=this,d={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return r&&(i!==r.failurelimit&&(r.failure_limit=r.failurelimit,delete r.failurelimit),i!==r.effectspeed&&(r.effect_speed=r.effectspeed,delete r.effectspeed),e.extend(d,r)),s=d.container===i||d.container===t?o:e(d.container),0===d.event.indexOf("scroll")&&s.bind(d.event,function(){return a()}),this.each(function(){var t=this,n=e(t);t.loaded=!1,(n.attr("src")===i||n.attr("src")===!1)&&n.is("img")&&n.attr("src",d.placeholder),n.one("appear",function(){if(!this.loaded){if(d.appear){var i=l.length;d.appear.call(t,i,d)}e("<img />").bind("load",function(){var i=n.attr("data-"+d.data_attribute);n.hide(),n.is("img")?n.attr("src",i):n.css("background-image","url('"+i+"')"),n[d.effect](d.effect_speed),t.loaded=!0;var o=e.grep(l,function(e){return!e.loaded});if(l=e(o),d.load){var r=l.length;d.load.call(t,r,d)}}).attr("src",n.attr("data-"+d.data_attribute))}}),0!==d.event.indexOf("scroll")&&n.bind(d.event,function(){t.loaded||n.trigger("appear")})}),o.bind("resize",function(){a()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&o.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&l.each(function(){e(this).trigger("appear")})}),e(n).ready(function(){a()}),this},e.belowthefold=function(n,r){var a;return a=r.container===i||r.container===t?(t.innerHeight?t.innerHeight:o.height())+o.scrollTop():e(r.container).offset().top+e(r.container).height(),a<=e(n).offset().top-r.threshold},e.rightoffold=function(n,r){var a;return a=r.container===i||r.container===t?o.width()+o.scrollLeft():e(r.container).offset().left+e(r.container).width(),a<=e(n).offset().left-r.threshold},e.abovethetop=function(n,r){var a;return a=r.container===i||r.container===t?o.scrollTop():e(r.container).offset().top,a>=e(n).offset().top+r.threshold+e(n).height()},e.leftofbegin=function(n,r){var a;return a=r.container===i||r.container===t?o.scrollLeft():e(r.container).offset().left,a>=e(n).offset().left+r.threshold+e(n).width()},e.inviewport=function(t,n){return!(e.rightoffold(t,n)||e.leftofbegin(t,n)||e.belowthefold(t,n)||e.abovethetop(t,n))},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})}(jQuery,window,document),define("common/models/common/js/message",[],function(){function e(){this.__listeners__=[]}var t=jQuery;return e.prototype={msg:{},__listeners__:null,addListener:function(e){"object"==t.type(e)&&t.inArray(e,this.__listeners__)==-1&&this.__listeners__.push(e)},removeListener:function(e){var n=t.inArray(e,this.__listeners__);n!=-1&&this.__listeners__.splice(n,1),n=null},postMessage:function(e,n){for(var i,o,r=qyerUtil.sliceArguments(arguments,1),a=0,s=this.__listeners__.length;a<s;a++)i=this.__listeners__[a]||{},o=i[e],"function"==t.type(o)&&o.apply(i,r);r.length=0,i=o=null}},e}),define("common/models/common/component/planItinerary/message",["common/models/common/js/message"],function(e){var t=(jQuery,new e);return t.msg={onBasicModelLoaded:"onBasicModelLoaded",onDataAPIInit:"onDataAPIInit",onDepartureTimeChange:"onDepartureTimeChange",onIncludeComplete:"onIncludeComplete",onAddCity:"onAddCity",onAddCityFromAddPOI:"onAddCityFromAddPOI",onUpdateCity:"onUpdateCity",onUpdatePOI:"onUpdatePOI",oneDelHotel:"oneDelHotel",onAddHotel:"onAddHotel",onUpdateHotel:"onUpdateHotel",onUpdateTraffic:"onUpdateTraffic"},t}),define("common/models/common/component/planItinerary/dataAPI",["common/models/common/component/planItinerary/message"],function(e){function t(e){e.data&&(e.data.sourcetype=1),qyerUtil.doAjax(e)}var n=(jQuery,{_initAction:null,getInitAction:function(){return this._initAction},_topicType:1,getTopicType:function(){return this._topicType},listener:{onBasicModelLoaded:function(){n.initData()}},unListener:function(){},_createUrl:null,getCreateUrl:function(){return this._createUrl},_disableCell:{},getDisableCell:function(){return this._disableCell},init:function(){e.addListener(this.listener)},initData:function(){switch(this.getInitAction()){case"browse":n.unListener(),e.postMessage(e.msg.onDataAPIInit);break;case"empty":n.unListener(),e.postMessage(e.msg.onDataAPIInit);break;case"add":this.loadBasicData();break;case"edit":this.loadBasicData();break;case"guidance":this.loadBasicData()}},_planid:null,getPlanID:function(){return this._planid},_currencys:[],getCurrencyList:function(){return this._currencys},_startTime:null,getStartTime:function(){return this._startTime},_url:null,getPlanUrl:function(){return this._url},_tid:null,getTID:function(){return this._tid},getAllDay:function(){},loadBasicData:function(){var i={};i.posturl="/planapi/base.php?action=getcurrency",i.onSuccess=function(t){n._currencys=t.data.currency,n.unListener(),e.postMessage(e.msg.onDataAPIInit)},i.onError=function(){alert("获取基础数据失败，请刷新重试")},t(i)},setStartTime:function(e){e.onCallSuccessBefore=function(){n._startTime=e.data.starttime},e.posturl="/planapi/route.php?action=saveplan",t(e)},getToken:function(e){e.posturl="planapi/travelnote/route.php?action=gettoken",t(e)},insertDay:function(e){e.onCallSuccessBefore=function(e){e.data.onedayid=e.data.onedayid||e.data.id,e.data.pois=[],e.data.hotels=[],e.data.traffics=[],e.data.citys=[],e.data.tag_list&&e.data.tag_list.length&&(e.data.citys=e.data.tag_list)},e.posturl="/planapi/oneday.php?action=insertoneday",t(e)},delOneDay:function(e){e.posturl="/planapi/oneday.php?action=deloneday",t(e)},createPlan:function(e){e.onCallSuccessBefore=function(e){n._planid=e.data.id,n._startTime=e.data.start_time,n._url=e.data.url},e.posturl="/planapi/travelnote/route.php?action=createplan",t(e)},_page:1,getPage:function(){return this._page},getPlanData:function(e){e.onCallSuccessBefore=function(e){n._planid=e.data.id,n._startTime=e.data.start_time,n._url=e.data.url;for(var t,i=e.data.allday,o=0,r=i.length;o<r;o++)t=i[o].hotels,t&&t.length>1&&(i[o].hotels=[t[0]]);t=i=null},e.posturl="/planapi/travelnote/route.php?action=getplan&ajaxID=59239dc4733e86c93db2a1d0",t(e)},delOneDayNote:function(e){e.posturl="/planapi/travelnote/route.php?action=delonedaynote",t(e)},setLift:function(e){e.posturl="/planapi/travelnote/route.php?action=setlift",t(e)},copyPlan:function(e){e.posturl="/planapi/route.php?action=copyplan",t(e)},delPlan:function(e){e.onCallSuccessBefore=function(e){n._planid=null,n._startTime=null,n._url=null},e.posturl="/planapi/travelnote/route.php?action=removeplan",t(e)},getPlanList:function(e){e.__defaultData__=[],e.posturl="/planapi/travelnote/route.php?action=getmyplanlist",t(e)},includePlan:function(e){e.posturl="/planapi/travelnote/route.php?action=importplan",t(e)},updateCity:function(e){e.posturl="/planapi/oneday.php?action=updatecitylist",t(e)},getRecommendCityList:function(e){e.__defaultData__=[],e.posturl="/planapi/recommend.php?action=getrelatedcitylist",t(e)},getAddedCityList:function(e){e.__defaultData__=[],e.posturl="/planapi/route.php?action=getplancityunique",e.onCallSuccessBefore=function(e){e.data.unshift({})},t(e)},searchCity:function(e){e.__defaultData__=[],e.posturl="/planapi/place.php?action=searchcityonly",t(e)},searchPOI:function(e){e.__defaultData__=[],e.posturl="/planapi/poi.php?action=search",t(e)},getRecommendPOIList:function(e){e.__defaultData__={counts:0,list:[]},e.posturl="/planapi/travelnote/ra.php?action=getrecommendpoi",t(e)},updatePOI:function(e){e.posturl="/planapi/travelnote/poi.php?action=save",t(e)},searchHotel:function(e){e.__defaultData__=[],e.posturl="/planapi/hotel.php?action=searchhotel",t(e)},delHotel:function(e){e.posturl="/planapi/hotel.php?action=delhotel",t(e)},addHotel:function(e){e.posturl="/planapi/hotel.php?action=addhotel",t(e)},updateHotel:function(e){e.posturl="/planapi/hotel.php?action=updatehotel",t(e)},updataTraffic:function(e){e.__defaultData__={},e.posturl="/planapi/travelnote/traffic.php?action=save",t(e)}});return n.init(),n}),define("common/models/common/component/planItinerary/tpl",["common/models/common/component/planItinerary/dataAPI"],function(e){var t=(jQuery,{browserTitle:function(e,t){var n=t?'<h4 class="title">行程单</h4>':"",i=t?"":'<span class="b_title" ><%=str%></span>',o=["<tr>",'<td colspan="6">','<div class="tHead clearfix">',n,"<%","var str = [];",'data.plan.start_time && (str.push( "出发时间："+data.plan.start_time )) ;','(data.plan.total_person|0) && (str.push( "共" + data.plan.total_person + "人" )) ;','(data.plan.avg_expense|0) && (str.push( "人均花费"+data.plan.avg_expense+"元" )) ;','str = str.join("，");',"%>","<% if(str) { %>",i,"<% } %>","<%str=null;%>","<% if(data.plan.isself){ %>",'<a class="b_details-self" href="<%= (window.__pageData__&&window.__pageData__.editurl)?window.__pageData__.editurl:"javascript:void(0)" %>" >编辑行程单</a>',"<% } else { %>",'<a class="createMyPlan" href="//plan.qyer.com/create/" target="_blank" data-bn-ipg="bbs-plan-view-create" ><span class="createMyPlan_span">+</span><span class="createMyPlan_spanText">创建专属行程</span></a>',"<% } %>",'<a class="b_copyPlan js_copyPlan" href="javascript:void(0)"  data-bn-ipg="bbs-plan-view-copy" >复制行程单</a>',"</div>","</td>","</tr>"].join("");return _.template(o,{plan:e},{variable:"data"})},editTitle:function(e){var t=["<tr>",'<td colspan="6">','<div class="tHead clearfix">','<div class="e_startTime js_selectStartTime" data-bn-ipg="bbs-plan-edit-date" >','<span><%= data.plan.start_time?("出发时间："+data.plan.start_time):"请选择出发时间"%></span>','<div class="icon">&nbsp;</div>',"</div>",'<a class="e_del js_delPlan" href="javascript:void(0)" data-bn-ipg="bbs-plan-edit-del" >删除整个行程</a>','<a class="e_include js_include" href="javascript:void(0)" data-bn-ipg="bbs-plan-edit-import" >从行程助手导入</a>',"</div>","</td>","</tr>"].join("");return _.template(t,{plan:e},{variable:"data"})},tTitle:function(){return['<tr class="tTitle">','<td width="140" ><span class="time fontYaHei">日期</span></td>','<td width="100" ><span class="city fontYaHei">城市</span></td>',e.getDisableCell().traffic===!0?"":'<td width="136" ><span class="traffic fontYaHei">交通</span></td>','<td width="156" ><span class="poi fontYaHei">景点</span></td>','<td><span class="hotel fontYaHei">酒店</span></td>','<td width="40" class="planItinerary_tTitle_lift" >&nbsp;</td>',"</tr>"].join("")},oneTR:function(t,n,i,o,r,a){var s="",l="",d="",c=0,u=0;if(n){var p=n.split("-"),h=p[1]+"/"+p[2]+"/"+p[0];l=new Date(Date.parse(h)+864e5*(t-1)),c=l.getMonth()+1,u=l.getDate(),c=c>9?c:"0"+c,u=u>9?u:"0"+u,d=c+"-"+u}else d="";if(a){var f="",m="",g=["",'<i class="bicf i_plane">&#xEA26;</i>','<i class="bicf i_train">&#xEA42;</i>','<i class="bicf i_bus">&#xEA43;</i>','<i class="bicf i_taxi">&#xEA3E;</i>','<i class="bicf i_steamer">&#xEA3F;</i>','<i class="bicf i_walk">&#xEA40;</i>','<i class="bicf i_taxi">&#xEA3E;</i>'],b="",v=i.get("traffics"),y=i.get("citys"),x=i.get("pois"),w=i.get("hotels"),k=i.get("note"),C=k?'<a class="bicf i_info">&#xEA39;<span class="infotooltip"><span class="it-triup i_tri"></span><span class="it-tridown i_tri"></span><p class="it-content">'+k+"</p></span></a>":"",E=["<span>__content__</span>",'<a class="d_da" target="_blank" href="__href__" data-bn-ipg="bbs-thread-plan-city">__content__</a>'];if(v.length)_.each(v.models,function(e,t){var n=t===v.models.length-1?"last":"";f=f+'<div class="t_traf '+n+'"><span class="t_con">'+E[+!!e.get("fromurl")].replace(/__content__/,e.get("fromplace")).replace(/__href__/,e.get("fromurl"))+g[e.get("tripmode")]+E[+!!e.get("tourl")].replace(/__content__/,e.get("toplace")).replace(/__href__/,e.get("tourl"))+"</span>"+(+e.get("spend")?'<span class="t_price">'+e.get("spend")+e.get("currency")+"</span>":"")+"</div>"});else{var T=_.map(y.models,function(e,t){return'<a href="'+e.get("url")+'" target="_blank" class="p_city" data-bn-ipg="bbs-thread-plan-city">'+(e.get("name")||e.get("en_name"))+"</a>"});f=T.join('<span class="citysplit">-</span>'),f='<p class="t_citys">'+f+"</p>"}x.length&&(m='<div class="t_dest clearfix"><i class="bicf idest">&#xEA15;</i><p class="d_detail">',m+=_.map(x.models,function(e,t){return'<a href="'+e.get("url")+'" target="_blank" class="d_da" data-bn-ipg="bbs-thread-plan-poi">'+(e.get("cn_name")?e.get("cn_name"):e.get("en_name"))+"</a>"}).join('<span class="p_split">-</span>'),m+="</p></div>"),w.length&&(b='<div class="t_hotel clearfix"><i class="bicf ihotel">&#xEA31;</i><div class="hotelwrap">',_.each(w.models,function(e,t){e.get("cn_name")||e.get("en_name");b=b+'<a class="h_detail" data-pop-url="'+e.get("url")+'" data-group="groupB" data-cnname="'+e.get("cn_name")+'" data-enname="'+e.get("en_name")+'" data-source="'+e.get("source")+'" data-price="'+e.get("spend")+'" data-currency="'+e.get("currency")+'"  data-id="'+e.get("pid")+'" href="'+e.get("url")+'" target="_blank" data-bn-ipg="bbs-thread-plan-hotel-'+e.get("pid")+'"><span class="p_hname">'+(e.get("cn_name")?e.get("cn_name"):e.get("en_name"))+'</span><i class="p_ding"></i></a>'}),b+="</div></div>"),s=['<tr class="<%= data.type==0?"record recordedit":"record"%>" data-onedayid="<%=data.oneday.get("onedayid")%>" >','<td class="p_time">',"<% if(data.type==0) { %>",'<a href="javascript:void(0)" class="clearfix"  >',"<% } else { %>",'<a href="<%= data.url+"/#day"+data.num%>" target="_blank" class="clearfix timea"  data-bn-ipg="bbs-plan-view-date" >',"<% } %>",'<span class="t_day"><%="D"+data.num%></span>','<span class="t_date">'+d+"</span>","</a></td>",'<td class="p_con">',f,m,b,"</td>",'<td class="p_side">'+C+'<a class="bicf imap" target="_blank" data-bn-ipg="bbs-thread-plan-map" href="//plan.qyer.com/trip/'+r+'/map#D<%=data.num%>">&#xEA14;</a></td>'].join("")}else s=['<tr class="<%= data.type==0?"record recordedit":"record"%>" data-onedayid="<%=data.oneday.get("onedayid")%>" >','<td class="time fontYaHei">',"<% if(data.type==0) { %>",'<a href="javascript:void(0)" class="clearfix"  >',"<% } else { %>",'<a href="<%= data.url+"/#day"+data.num%>" target="_blank" class="clearfix"  data-bn-ipg="bbs-plan-view-date" >',"<% } %>","<% if(!data.start_time){ %>",'<div class="e_null">','<span><%=data.num<10?("&nbsp;D"+data.num):("D"+data.num)%></span>',"</div>","<%} else {%>",'<% var date= data.start_time.qToDate("-").qAddDate(data.num-1) ,m=date.getMonth()+1,day=date.getDate(),week=["日","一","二","三","四","五","六"][date.getDay()]; %>','<span class="day"><%=day<10?("&nbsp;"+day):day%></span>',"<div>","<p><%=m%>月</p>",'<p class="line"></p>',"<p>星期<%=week%></p>","</div>","<% date= m= day= week=null ;%>","<% } %>","</a>","</td>","<% if(data.type==0) { %>",'<% if( !data.oneday.get("citys").length) {%> ','<td class="city null js_editCity" ><span data-bn-ipg="Bbs-plan-edit-city" >新增</span></td>',"<% } else { %>",'<td class="city js_editCity"  data-bn-ipg="Bbs-plan-edit-city" >','<% data.oneday.get("citys").each(function(aT){%>','<p><a href="javascript:void(0)" ><%= aT.get("name")||aT.get("en_name") %></a></p>',"<% }); %>","</td>","<% }%>","<% } else { %>",'<td class="city">','<% data.oneday.get("citys").each(function(aT){%>','<% if( aT.get("url") ){ %>','<p><a href="<%=aT.get("url")%>" target="_blank" data-bn-ipg="bbs-plan-view-city" title="<%= aT.get("name")||aT.get("en_name") %>" ><%= aT.get("name")||aT.get("en_name") %></a></p>',"<% }else { %>",'<p><a href="javascript:void(0)" class="noLink"  data-bn-ipg="bbs-plan-view-city" title="<%= aT.get("name")||aT.get("en_name") %>" ><%= aT.get("name")||aT.get("en_name") %></a></p>',"<% } %>","<% }); %>","</td>","<% }%>","<% if(!data.disableTraffic) { %>","<% if(data.type==0) { %>",'<% if( !data.oneday.get("traffics").length) {%> ','<td class="traffic null js_editTraffic" ><span  data-bn-ipg="bbs-plan-edit-traffic">新增</span></td>',"<% } else { %>",'<td class="traffic js_editTraffic"  data-bn-ipg="bbs-plan-edit-traffic" >','<%data.oneday.get("traffics").each(function(aT){%>',"<div>",'<span class="start"><%=aT.get("fromplace")%>&nbsp;</span>','<span class="icon <%= ["","plane","train","bus","taxi","steamer","walk"][aT.get("tripmode")] %>">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>','<span class="end"><%=aT.get("toplace")%></span>',"</div>",'<% if(aT.get("spend")|0){ %>','<p><%= (aT.get("spend")|0) + aT.get("currency") %></p>',"<% } %>","<% }); %>","</td>","<% }%>","<% } else { %>",'<td class="traffic">','<%data.oneday.get("traffics").each(function(aT){%>',"<div>",'<span class="start"><%=aT.get("fromplace")%>&nbsp;</span>','<span class="icon <%= ["","plane","train","bus","taxi","steamer","walk"][aT.get("tripmode")] %>">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>','<span class="end"><%=aT.get("toplace")%></span>',"</div>",'<% if(aT.get("spend")|0){ %>','<p><%= (aT.get("spend")|0) + aT.get("currency")%></p>',"<% } %>","<% }); %>","</td>","<% }%>","<% } %>","<% if(data.type==0) { %>",'<% if( !data.oneday.get("pois").length && !data.oneday.get("note")) {%> ','<td class="poi null js_editPOI" ><span   data-bn-ipg="bbs-plan-edit-poi">新增</span></td>',"<% } else { %>",'<td class="poi js_editPOI" data-bn-ipg="bbs-plan-edit-poi" >','<%data.oneday.get("pois").each(function(aT,aIndex){%>','<p><a href="javascript:void(0)"><%=aIndex+1%>. <%= aT.get("cn_name")||aT.get("en_name") %></a></p>',"<% }); %>",'<% if(data.oneday.get("note")){ %>','<p class="note js_showOneDayNote">&nbsp;</p>','<div class="notewrapTap js_oneDayNoteDiv">','<div class="notewrap">','<div class="arrow">&nbsp;</div>','<div class="content">','<p><%=data.oneday.get("note")%></p>','<div class="del"><a href="javascript:void(0);" class="js_delOneDayNote" >&nbsp;</a></div>',"</div>","</div>","</div>","<% } %>","</td>","<% }%>","<% } else { %>",'<td class="poi">','<%data.oneday.get("pois").each(function(aT,aIndex){%>','<% if( aT.get("url") ){ %>','<p><a href="<%=aT.get("url")%>"  target="_blank"  data-bn-ipg="bbs-plan-view-poi" title="<%= aT.get("cn_name")||aT.get("en_name") %>" ><%=aIndex+1%>. <%= aT.get("cn_name")||aT.get("en_name") %></a></p>',"<% }else { %>",'<p><a href="javascript:void(0)" class="noLink" data-bn-ipg="bbs-plan-view-poi" title="<%= aT.get("cn_name")||aT.get("en_name") %>" ><%=aIndex+1%>. <%= aT.get("cn_name")||aT.get("en_name") %></a></p>',"<% } %>","<% }); %>",'<% if(data.oneday.get("note")){ %>','<p class="note js_showOneDayNote" title="查看备注">&nbsp;</p>','<div class="notewrapTap js_oneDayNoteDiv">','<div class="notewrap">','<div class="arrow">&nbsp;</div>','<div class="content">','<p><%=data.oneday.get("note")%></p>',"</div>","</div>","</div>","<% } %>","</td>","<% }%>","<% if(data.type==0) { %>",'<% if( !data.oneday.get("hotels").length) {%> ','<td class="hotel null js_editHotel" ><span  data-bn-ipg="bbs-plan-edit-hotel">新增</span></td>',"<% } else { %>",'<td class="hotel js_editHotel" data-bn-ipg="bbs-plan-edit-hotel" >','<%data.oneday.get("hotels").each(function(aT){%>','<a href="javascript:void(0)"><%= aT.get("cn_name")||aT.get("en_name") %></a>','<% if( aT.get("spend")|0 ) { %>','<p><%= (aT.get("spend")|0) + aT.get("currency") + " X " + aT.get("counts") %></p>',"<% }else { %>","<p>&nbsp;</p>","<% } %>","<% }); %>","</td>","<% }%>","<% } else { %>",'<td class="hotel">','<%data.oneday.get("hotels").each(function(aT){%>','<% if( (aT.get("pid")|0) > 0 ){ %>','<a href="<%=aT.get("url")%>" class="linkIcon" target="_blank" data-bn-ipg="bbs-plan-view-hotel" ><span><%= aT.get("cn_name")||aT.get("en_name") %></span><span class="icon">&nbsp;</span></a>',"<% }else { %>",'<a href="<%=aT.get("url")%>" class="" target="_blank" data-bn-ipg="bbs-plan-view-hotel" ><span><%= aT.get("cn_name")||aT.get("en_name") %></span></a>',"<% } %>",'<% if( aT.get("spend")|0 ) { %>','<p><%= (aT.get("spend")|0) + aT.get("currency") + " X " + aT.get("counts") %></p>',"<% }else { %>","<p>&nbsp;</p>","<% } %>","<% }); %>","</td>","<% }%>","<% if(data.type==0) {%> ",'<td class="setting">','<div class="js_showSettingMenu  <%=data.oneday.get("lift_url")?"liftSeted":""%>"  >',"<div>","<ul>",'<li class="js_insertDayBefore before" data-bn-ipg="bbs-plan-edit-preday" >之前插入一天</li>','<li class="js_insertDayAfter after" data-bn-ipg="bbs-plan-edit-backday">之后插入一天</li>'," <% if(data.hasLift){ %> ",'<li class="js_editLift lift" data-bn-ipg="bbs-plan-edit-elevator">编辑电梯</li>'," <% } %> ",'<li class="js_delDay del" data-bn-ipg="bbs-plan-edit-del">删除该日</li>',"</ul>","</div>","</div>","</td>","<%} else { %>",'<td class="lift">','<% if(data.oneday.get("lift_url")){ %>','<a href="<%=data.oneday.get("lift_url")%>"  data-bn-ipg="bbs-plan-view-elevator" ><div>&nbsp;</div></a>',"<% } %>","</td>","<% } %>","</tr>"].join("");
return _.template(s,{num:t,start_time:n,oneday:i,type:o,url:e.getPlanUrl(),hasLift:!!e.getTID()&&1==e.getTopicType(),disableTraffic:e.getDisableCell().traffic===!0},{variable:"data"})},getEditHTML:function(e,t){var n=['<div class="planItinerary" >','<div id="planItinerary_datepickerDiv"></div>','<table class="contentTable">',"<%=data.titleFun(data.plan)%>","<%= data.tTitleFun()%>",'<tbody id="__planItinerary__tbody" >',"<% data.allday.each(function(aT,aIndex){ %>","<%= data.oneTR(aIndex+1,data.plan.start_time,data.allday.at(aIndex),data.type) %>","<% }); %>","</tbody>",'<tr class="tBottom">','<td colspan="6">','<div class="e_addoneday"><span class="js_addLastDay" data-bn-ipg="bbs-plan-edit-addday" >新增一天</span></div>',"</td>","</tr>","</table>","</div>"].join("");return _.template(n,{oneTR:this.oneTR,plan:e,allday:t,titleFun:this.editTitle,type:0,tTitleFun:this.tTitle},{variable:"data"})},getBrowserHTML:function(e,t,n){var i=n?'<a class="js_toggleMore close" data-bn-ipg="bbs-thread-plan-all" href="javascript:void(0)" >查看全部 <%= data.plan.total || data.allday.length%> 天行程<i class="bicf i_more">&#xEA07;</i></span>':'<span class="js_toggleMore close" data-bn-ipg="bbs-thread-plan-all" >展开全部 <%= data.plan.total || data.allday.length%> 天</span>',o=['<div class="planItinerary" >','<div id="planItinerary_datepickerDiv"></div>','<table class="contentTable">',"<%=data.titleFun(data.plan,data.isnew)%>","<%= data.tTitleFun()%>",'<tbody id="__planItinerary__tbody" >',"<% data.allday.each(function(aT,aIndex){ %>","<%= data.oneTR(aIndex+1,data.plan.start_time,data.allday.at(aIndex),data.type,data.plan.id,data.isnew) %>","<% }); %>","</tbody>","<% if(data.plan.total>3) {%>",'<tbody id="__planItinerary__tbody__more" style="display:none;"></tbody>','<tr class="tBottom">','<td colspan="6">','<div class="b_toggle">',i,"</div>","</td>","</tr>","<% } %>","</table>","</div>"].join("");return _.template(o,{oneTR:this.oneTR,plan:e,allday:t,titleFun:this.browserTitle,type:1,tTitleFun:this.tTitle,isnew:n},{variable:"data"})},getBrowserMoreHTML:function(e,t,n){var i=["<% data.allday.each(function(aT,aIndex){ %>","<%= data.oneTR(aIndex+4,data.plan.start_time,data.allday.at(aIndex),data.type,data.plan.id,data.isnew) %>","<% }); %>"].join("");return _.template(i,{oneTR:this.oneTR,plan:e,allday:t,type:1,isnew:n},{variable:"data"})},getEmptyHTML:function(){var t=['<div class="planItinerary" >','<div class="Empty clearfix" >','<span class="left fl" >暂无行程单</span>','<a class="right fr" href="'+e.getCreateUrl()+'" >+ 添加行程</a>',"</div>","</div>"].join("");return t},getEmptyHTML_edit:function(){var e=['<div class="planItinerary" >','<div class="Empty clearfix" >','<span class="left fl" >暂无行程单</span>','<a class="right fr js_edit_create" href="javascript:void(0)" >+ 创建行程</a>','<a class="includeFromPlanList js_include" href="javascript:void(0)" data-bn-ipg="bbs-plan-edit-import" >从行程助手导入</a>',"</div>","</div>"].join("");return e}});return t}),define("common/models/common/component/planItinerary/model",["require"],function(e){var t=(jQuery,Backbone.Model.extend({defaults:{name:"",en_name:"",tagid:"",url:"",type:1}})),n=Backbone.Collection.extend({model:t}),i=Backbone.Model.extend({defaults:{id:"",pid:"",en_name:"",cn_name:"",url:"",type:1}}),o=Backbone.Collection.extend({model:i}),r=Backbone.Model.extend({defaults:{id:"",pid:"",cn_name:"",en_name:"",spend:"0",currency:"CNY",counts:"1",inDay:"",outDay:"",url:"",pic:"",source:1}}),a=Backbone.Collection.extend({model:r}),s=Backbone.Model.extend({defaults:{id:"",fromplace:"",fromplaceid:"",toplace:"",toplaceid:"",tripmode:"1",spend:"0",currency:"CNY",counts:"1"}}),l=Backbone.Collection.extend({model:s}),d=Backbone.Model.extend({defaults:{onedayid:"",lift_url:"",note:"",citys:[],pois:[],hotels:[],traffics:[]}}),c=Backbone.Collection.extend({model:d}),u={CityClass:t,CityCollectionClass:n,POIClass:i,POIClassCollectionClass:o,HotelClass:r,HotelClassCollectionClass:a,TrafficClass:s,TrafficClassCollectionClass:l,OneDayClass:d,OneDayClassCollectionClass:c};return u}),define("common/models/basic/js/normalize",[],function(){function e(e,i,o){if(e.match(s)||e.match(a))return e;e=r(e);var l=o.match(a),d=i.match(a);return!d||l&&l[1]==d[1]&&l[2]==d[2]?n(t(e,i),o):t(e,i)}function t(e,t){if("./"==e.substr(0,2)&&(e=e.substr(2)),e.match(s)||e.match(a))return e;var n=t.split("/"),i=e.split("/");for(n.pop();curPart=i.shift();)".."==curPart?n.pop():n.push(curPart);return n.join("/")}function n(e,t){var n=t.split("/");for(n.pop(),t=n.join("/")+"/",i=0;t.substr(i,1)==e.substr(i,1);)i++;for(;"/"!=t.substr(i,1);)i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var o=e.split("/");for(out="";n.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var o=/([^:])\/+/g,r=function(e){return e.replace(o,"$1/")},a=/[^\:\/]*:\/\/([^\/])*/,s=/^(\/|data:)/,l=function(t,n,i){n=r(n),i=r(i);for(var o,a,t,s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=s.exec(t);){a=o[3]||o[2]||o[5]||o[6]||o[4];var l;l=e(a,n,i);var d=o[5]||o[6]?1:0;t=t.substr(0,s.lastIndex-a.length-d-1)+l+t.substr(s.lastIndex-d-1),s.lastIndex=s.lastIndex+(l.length-a.length)}return t};return l.convertURIBase=e,l.absoluteURI=t,l.relativeURI=n,l}),define("common/models/basic/js/require-css",[],function(){if("undefined"==typeof window)return{load:function(e,t,n){n()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,n=!1,i=!0;t[1]||t[7]?n=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]||t[8]?i=!1:t[4]&&(n=parseInt(t[4])<18);var o={};o.pluginBuilder="./css-builder";var r,a,s,l=function(){r=document.createElement("style"),e.appendChild(r),a=r.styleSheet||r.sheet},d=0,c=[],u=function(e){d++,32==d&&(l(),d=0),a.addImport(e),r.onload=function(){p()}},p=function(){s();var e=c.shift();return e?(s=e[1],void u(e[0])):void(s=null)},h=function(e,t){if(a&&a.addImport||l(),a&&a.addImport)s?c.push([e,t]):(u(e),s=t);else{r.textContent='@import "'+e+'";';var n=setInterval(function(){try{r.sheet.cssRules,clearInterval(n),t()}catch(e){}},10)}},f=function(t,n){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",i)o.onload=function(){o.onload=function(){},setTimeout(n,7)};else var r=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.href==o.href)return clearInterval(r),n()}},10);o.href=t,e.appendChild(o)};return o.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},o.load=function(e,t,i,o){(n?h:f)(t.toUrl(e+".css"),i)},o}),define("common/models/basic/js/require-css!common/models/common/ui/popup/popup",[],function(){}),define("common/models/common/ui/popup/popup",["css!common/models/common/ui/popup/popup.css"],function(){var e=jQuery,t={$ui:null,$content:null,$box:null,$title:null,$okBtn:null,$cancelBtn:null,$loadBtn:null,$closeIcon:null,_uiState:"normal",defaultWidth:400,init:function(){var t=['<div class="qui-popup" style="display:none">',"<div>",'<div class="qui-popup-dt">','<div class="qui-popup-box">','<div class="qui-popup-closeIcon">&nbsp;</div>','<div class="qui-popup-box-title fontYaHei">title</div>','<div class="qui-popup-box-content">',"</div>",'<div class="qui-popup-box-bottom">',"&nbsp;",'<input class="qui-popup-cancelBtn ui_button_cancel" type="button" value="取消" />  ','<input class="qui-popup-okBtn ui_button" type="button" value="确定" />  ','<input class="qui-popup-loadingBtn  ui_button_load" type="button" value="" />  ',"</div>","</div>","</div>","</div>","</div>"].join("");this.$ui=e(t),this.$content=this.$ui.find(".qui-popup-box-content"),this.$box=this.$ui.find(".qui-popup-box"),this.$title=this.$ui.find(".qui-popup-box-title"),this.$okBtn=this.$ui.find(".qui-popup-okBtn"),this.$cancelBtn=this.$ui.find(".qui-popup-cancelBtn"),this.$loadBtn=this.$ui.find(".qui-popup-loadingBtn"),this.$closeIcon=this.$ui.find(".qui-popup-closeIcon"),this.$ui.appendTo(document.body)},setWidth:function(e){this.$box.animate({width:e},300)},setUIDefault:function(e){this.$ui[0].className="qui-popup",e.exClassName&&this.$ui.addClass(e.exClassName),e.iframeSrc?this.$content.html('<iframe src="'+e.iframeSrc+'"  scrolling="auto" style="height:'+(e.iframeHeight||300)+'px;"  />'):this.$content.html(e.contentHTML||"&nbsp;"),this.$title.html(e.title||"Title"),this.$box.css("width",e.width||this.defaultWidth),this.$title[e.showTitle===!1?"hide":"show"](),this.$okBtn.val(e.okText||"确定"),this.$cancelBtn.val(e.cancelText||"取消"),this.$okBtn[e.showOKBtn===!1?"hide":"show"](),this.$okBtn.removeAttr("data-bn-ipg"),this.$cancelBtn[e.showCancelBtn===!1?"hide":"show"](),this.$cancelBtn.removeAttr("data-bn-ipg"),this.$loadBtn[e.showLoadBtn===!0?"show":"hide"](),this.$loadBtn.removeAttr("data-bn-ipg"),this.$ui.find(".qui-popup-closeIcon").removeAttr("data-bn-ipg"),this.$closeIcon[e.showCloseIcon===!1?"hide":"show"]()},show:function(n){if("hideing"==t._uiState)t.$box.stop(),t.$ui.stop(),this.$ui.css({display:"block",opacity:1}),this.$box.css({top:0,opacity:1}),t._uiState="normal",n.onShow&&n.onShow();else{t._uiState="showing";var i={},o={top:0};e.support.leadingWhitespace&&(i.opacity=1,o.opacity=1),this.$ui.css("display","block").animate(i,200,function(){t.$box.css("top",-30).animate(o,200,function(){t._uiState="normal",n.onShow&&n.onShow()})})}},hide:function(n){if(!n||!n.onBeforeHide||n.onBeforeHide()!==!1){t._uiState="hideing";var i={top:-30},o={};e.support.leadingWhitespace&&(i.opacity=0,o.opacity=0),this.$box.animate(i,200,function(){t.$ui.animate(o,200,function(){t._uiState="normal",t.$ui.css("display","none"),t.$content.html(""),n&&n.onAfterHide&&n.onAfterHide()})})}}};t.init();var n=null,i={show:function(e){return n=e,t.setUIDefault(e),t.$ui.undelegate("click").delegate(".qui-popup-okBtn,.qui-popup-cancelBtn,.qui-popup-closeIcon","click",function(n){if(this.className.indexOf("qui-popup-closeIcon")!=-1||this.className.indexOf("qui-popup-cancelBtn")!=-1){if(e.onBeforeCancel&&!e.onBeforeCancel(n))return;e.onCancel&&e.onCancel()}else if(this.className.indexOf("qui-popup-okBtn")!=-1&&e.onOK&&e.onOK()===!1)return;t.hide(e)}),t.show(e),this},hide:function(e){return t.hide(),e&&e(),this},setContent:function(e){return t.$content.html(e),this},getContent:function(){return t.$content[0]},getButtons:function(){return{okBtn:t.$okBtn[0],cancelBtn:t.$cancelBtn[0],loadBtn:t.$loadBtn[0],closeIcon:t.$ui.find(".qui-popup-closeIcon")[0]}},setOption:function(i){var o={width:function(){t.setWidth(i.width)},showTitle:function(){i.showTitle===!1?t.$title.hide():t.$title.show()},okText:function(){t.$okBtn.val(i.okText)},cancelText:function(){t.$cancelBtn.val(i.cancelText)},showOKBtn:function(){i.showOKBtn===!1?t.$okBtn.hide():t.$okBtn.show()},showCancelBtn:function(){i.showCancelBtn===!1?t.$cancelBtn.hide():t.$cancelBtn.show()},showLoadBtn:function(){i.showLoadBtn===!1?t.$loadBtn.hide():t.$loadBtn.show()},showCloseIcon:function(){i.showCloseIcon===!1?t.$closeIcon.hide():t.$closeIcon.show()},title:function(){t.$title.html(i.title)},exClassName:function(){t.$ui[0].className="qui-popup "+i.exClassName},contentHTML:function(){i.iframeSrc||t.$content.html(i.contentHTML)},iframeSrc:function(){t.$content.html('<iframe src="'+i.iframeSrc+'"  scrolling="auto" style="height:'+(i.iframeHeight||300)+'px;" />')},iframeHeight:function(){t.$content.children("iframe").css("height",i.iframeHeight)}};for(var r in i)n[r]=i[r],"function"==e.type(o[r])&&o[r]()}};return i}),define("common/models/basic/js/require-css!common/models/common/ui/tip/tip",[],function(){}),define("common/models/common/ui/tip/tip",["css!common/models/common/ui/tip/tip.css"],function(){function e(e){i.html(e.text||"&nbsp;"),n[0].className="qui-tip-box","error"==e.type?n.addClass("qui-tip-box-error"):"warning"==e.type&&n.addClass("qui-tip-box-warning")}var t,n,i,o=jQuery;!function(){var e=['<div class="qui-tip" style="display:none;" >','<div class="qui-tip-box">','<span class="qui-tip-text fontYaHei">这里是提示文本</span>',"</div>","</div>"].join("");t=o(e),i=t.find(".qui-tip-text"),n=t.find(".qui-tip-box"),t.appendTo(document.body)}();var r={_timer:null,tip:function(n){return e(n),t.slideDown(200),window.clearTimeout(this._timer),this._timer=setTimeout(function(){t.slideUp(200)},n.time||3e3),this}};return r}),define("common/models/common/component/planItinerary/browser",["common/models/common/component/planItinerary/tpl","common/models/common/component/planItinerary/dataAPI","common/models/common/component/planItinerary/message","common/models/common/component/planItinerary/model","common/models/common/ui/popup/popup","common/models/common/ui/tip/tip"],function(e,t,n,i,o,r){var a,s,l=jQuery,d=Backbone.View.extend({el:"#__planItinerary__",$dom:l("#__planItinerary__"),initialize:function(){var t=s.pluck("lift_url").join("").length>0;t||this.$dom.addClass("planItineraryNoLift"),isCreateLift=null,this.$dom.html(e.getBrowserHTML(gPlan,s,this.$dom.attr("data-isnew")))},isLoading:!1,events:{"click .js_toggleMore":"evt_toggleMore","click .js_showOneDayNote":"evt_showOneDayNote","click .js_oneDayNoteDiv":"evt_oneDayNoteDivClick","click .js_copyPlan":"evt_copyPlan"},evt_toggleMore:function(n){var o,r,a,d=this;if(a=l(n.currentTarget),o=l("#__planItinerary__tbody__more"),r=o.is(":hidden"),d.isLoading)return!1;if(r)o.show(),1==t._page?l.ajax({type:"post",url:"/planapi/travelnote/route.php?action=getplan",data:{planid:t.getPlanID(),cate:t.getTopicType(),tid:t.getTID(),page:2},dataType:"json",beforeSend:function(){d.isLoading=!0,t._page=2,a.html("加载中...")},success:function(t){if(0===t.error_code){s=new i.OneDayClassCollectionClass(t.data.allday),s.each(function(e){e.set("citys",new i.CityCollectionClass(e.get("citys"))),e.set("pois",new i.POIClassCollectionClass(e.get("pois"))),e.set("hotels",new i.HotelClassCollectionClass(e.get("hotels"))),e.set("traffics",new i.TrafficClassCollectionClass(e.get("traffics")))});s.pluck("lift_url").join("").length>0;isCreateLift=null,o.html(e.getBrowserMoreHTML(t.data,s,l("#__planItinerary__").attr("data-isnew"))),a.removeClass("close").html("收起").attr("data-bn-ipg","bbs-thread-plan-fold")}},complete:function(){d.isLoading=!1}}):a.removeClass("close").html("收起");else{o.hide();var c=l(".bbs_detail_item").eq(0);l(window).scrollTop(c.offset().top-52),a.addClass("close").html("展开全部 "+(gPlan.total||s.length)+" 天")}},evt_showOneDayNote:function(e){e.stopPropagation();var t=l(e.currentTarget).next();t.is(":visible")?t.fadeOut(300,function(){t=null}):t.fadeIn(300,function(){l(document).one("click",function(){t.fadeOut(300,function(){t=null})})})},evt_oneDayNoteDivClick:function(e){e.stopPropagation()},evt_copyPlan:function(e){function n(e){var t=["<div>","<style>",".bbs_travel_plan_pup {}",".bbs_travel_plan_pup .title { font-size:24px; line-height:26px; height:26px;}",".bbs_travel_plan_pup .text { line-height:24px; font-size:14px; color:#636363;padding-top:18px; border-top:1px solid #ced0d5;}",".bbs_travel_plan_pup .button { text-align:center; margin:30px auto;}",".bbs_travel_plan_pup .button a { width:137px; height:42px; display:inline-block; background:url(//static.qyer.com/images/bbs/travel/bbs_plan_wen_button.png) no-repeat; text-indent:-9999px; text-align:left;}",".bbs_travel_plan_pup .button a:hover { background-position:0 -42px;}",".bbs_found_content { margin:50px 0 0;}",".bbs_found_content dl { width:173px; float:left; margin-left:20px; padding:45px 10px 0; height:80px; background:#eee; border-radius:8px; text-align:center;}",".bbs_found_content .bg1 { margin-left:0;}",".bbs_found_content .bg1 span { background:url(//static.qyer.com/images/bbs/travel/help_bg1.png) no-repeat;}",".bbs_found_content .bg2 span { background:url(//static.qyer.com/images/bbs/travel/help_bg2.png) no-repeat;}",".bbs_found_content .bg3 span { background:url(//static.qyer.com/images/bbs/travel/help_bg3.png) no-repeat;}",".bbs_found_content dt { height:18px; font-size:14px; line-height:18px; font-weight:700; position:relative;}",".bbs_found_content dt span { width:62px; height:62px; display:block; position:absolute; left:60px; top:-75px;}",".bbs_found_content dd { color:#959595; margin-top:4px;}","</style>",'<div class="bbs_travel_plan_pup">','<p class="text fontYaHei">复制行程后，你可以去<a target="_blank" href="//plan.qyer.com">行程助手</a>按照自己的想法随意调整行程，获得智能目的地推荐，并轻松导出PDF同步到手机查看。</p>','<div class="bbs_found_content clearfix">','<dl class="bg1">',"<dt>轻松打造个性化完美行程<span></span></dt>","<dd>根据喜好，快速安排完美行程</dd>","</dl>",'<dl class="bg2">',"<dt>1000万网友智能推荐<span></span></dt>","<dd>基于1000万穷游er的旅行经验智能推荐全球20万目的地</dd>","</dl>",'<dl class="bg3">',"<dt>一键同步到移动设备<span></span></dt>","<dd>可以同步到手机，也可导出超详细PDF，在路上随时查看</dd>","</dl>","</div>",'<div class="button"><a target="_blank" href="'+e.url+'">查看行程</a></div>','<div class="arrow"></div>','<div class="close"></div>',"</div>","</div>"].join("");o.show({width:680,exClassName:"copyCompleteExClassName",title:"复制行程成功",contentHTML:t})}function i(){var e=['<div class="planItinerary__copyPlan">','<input type="text" class="m_boxsizing ui2_input js_newPlanName" value="" placeholder="填写行程计划标题，最多18个汉字" />',"</div>"].join("");o.show({width:435,exClassName:"m_exClass",title:"复制行程",contentHTML:e,onOK:function(){var e=l(o.getContent()).find(".js_newPlanName").val();return e?e.length>18?(r.tip({text:"行程标题不能超过18个汉字",type:"warning"}),!1):(t.copyPlan({data:{planid:t.getPlanID(),planner_name:e,token:a},onSuccess:function(t){o.hide(),n(t.data),e=null},onError:function(e){o.setOption({showOKBtn:!0,showLoadBtn:!1}),r.tip({text:e.data.msg,type:"error"})}}),o.setOption({showOKBtn:!1,showLoadBtn:!0}),!1):(r.tip({text:"请输入行程标题",type:"warning"}),!1)}}),e.length=0,e=null}var a;qyerUtil.isLogin()?i():t.getToken({onSuccess:function(e){a=e.data,i()},onError:function(e){r.tip({text:e.data.msg,type:"error"})}})}}),c={init:function(){n.addListener(this.listener)},listener:{onDataAPIInit:function(){n.removeListener(c.listener),"empty"==t.getInitAction()?l("#__planItinerary__").html(e.getEmptyHTML()):t.getPlanData({data:{planid:t.getPlanID(),cate:t.getTopicType(),tid:t.getTID(),page:t.getPage()},onSuccess:function(e){gPlan=e.data,s=new i.OneDayClassCollectionClass(gPlan.allday),s.each(function(e){e.set("citys",new i.CityCollectionClass(e.get("citys"))),e.set("pois",new i.POIClassCollectionClass(e.get("pois"))),e.set("hotels",new i.HotelClassCollectionClass(e.get("hotels"))),e.set("traffics",new i.TrafficClassCollectionClass(e.get("traffics")))}),c.initUI()},onError:function(e){r.tip({text:e.data.msg,type:"error"}),c.initUI()}})}},initUI:function(){a=new d}};return c.init(),c}),define("common/models/basic/js/require-css!common/models/common/component/planItinerary/planItinerary",[],function(){}),define("common/models/basic/js/require-css!web_old_popup2",[],function(){}),define("web_old_popup2",["css!web_old_popup2"],function(){function e(e){return this.option=e,this.initUI(),this.ui.setUIDefault(this.option),this}var t=jQuery;return e.prototype={option:null,ui:null,initUI:function(){var e=this.ui={$ui:null,$content:null,$box:null,$title:null,$okBtn:null,$cancelBtn:null,$loadBtn:null,$closeIcon:null,defaultWidth:"auto"},n=['<div class="qui-popup2" style="display:none">',"<div>",'<div class="qui-popup2-dt">','<div class="qui-popup2-box">','<div class="qui-popup2-closeIcon">&nbsp;</div>','<div class="qui-popup2-box-title">title</div>','<div class="qui-popup2-box-content">',"</div>",'<div class="qui-popup2-box-bottom">',"&nbsp;",'<input class="qui-popup2-cancelBtn ui_button_cancel" type="button" value="取消" />  ','<input class="qui-popup2-okBtn ui_button" type="button" value="确定" />  ','<input class="qui-popup2-loadingBtn  ui_button_load" type="button" value="" />  ',"</div>","</div>","</div>","</div>","</div>"].join("");return e.$ui=t(n),e.$content=e.$ui.find(".qui-popup2-box-content"),e.$box=e.$ui.find(".qui-popup2-box"),e.$title=e.$ui.find(".qui-popup2-box-title"),e.$okBtn=e.$ui.find(".qui-popup2-okBtn"),e.$cancelBtn=e.$ui.find(".qui-popup2-cancelBtn"),e.$loadBtn=e.$ui.find(".qui-popup2-loadingBtn"),e.$closeIcon=e.$ui.find(".qui-popup2-closeIcon"),e.$bottom=e.$ui.find(".qui-popup2-box-bottom"),e.$ui.appendTo(document.body),e.option=this.option,e=n=null,t.extend(this.ui,{setWidth:function(e){this.$box.animate({width:e},300)},setUIDefault:function(e){this.$ui[0].className="qui-popup2",e.exClassName&&this.$ui.addClass(e.exClassName),e.iframeSrc?this.$content.html('<iframe src="'+e.iframeSrc+'"  scrolling="auto" style="height:'+(e.iframeHeight||300)+'px;"  />'):this.$content.html(e.contentHTML||"&nbsp;"),this.$title.html(e.title||"Title"),this.$box.css("width",e.width||this.defaultWidth),this.$title[e.showTitle===!1?"hide":"show"](),this.$okBtn.val(e.okText||"确定"),this.$cancelBtn.val(e.cancelText||"取消"),this.$okBtn[e.showOKBtn===!1?"hide":"show"](),this.$okBtn.removeAttr("data-bn-ipg"),this.$cancelBtn[e.showCancelBtn===!1?"hide":"show"](),this.$cancelBtn.removeAttr("data-bn-ipg"),this.$loadBtn[e.showLoadBtn===!0?"show":"hide"](),this.$loadBtn.removeAttr("data-bn-ipg"),this.$ui.find(".qui-popup2-closeIcon").removeAttr("data-bn-ipg"),this.$closeIcon[e.showCloseIcon===!1?"hide":"show"](),e.showOKBtn===!1&&e.showCancelBtn===!1&&this.$bottom.hide()},show:function(){var e={},n={top:0},i=this;t.support.leadingWhitespace&&(e.opacity=1,n.opacity=1),this.$ui.css("display","block").animate(e,200,function(){i.$box.css("top",-30).animate(n,200,function(){i.option.onShow&&i.option.onShow(),e=n=i=null})})},hide:function(e){var n={top:-30},i={},o=this;o.option&&o.option.onBeforeHide&&o.option.onBeforeHide()===!1||(t.support.leadingWhitespace&&(n.opacity=0,i.opacity=0),this.$box.animate(n,200,function(){o.$ui.animate(i,200,function(){e?o.$ui.hide():o.$ui.remove(),o.option&&o.option.onAfterHide&&o.option.onAfterHide(),n=i=o=null})}))}}),this},show:function(){var e=this;return this.ui.$ui.undelegate("click").delegate(".qui-popup2-okBtn,.qui-popup2-cancelBtn,.qui-popup2-closeIcon","click",function(t){if(this.className.indexOf("qui-popup2-closeIcon")!=-1||this.className.indexOf("qui-popup2-cancelBtn")!=-1){if(e.option.onBeforeCancel&&!e.option.onBeforeCancel(t))return;e.option.onCancel&&e.option.onCancel()}else if(this.className.indexOf("qui-popup2-okBtn")!=-1&&e.option.onOK&&e.option.onOK()===!1)return;e.ui.hide()}),this.ui.show(),this},hide:function(e){return this.ui.hide(e),this},setContent:function(e){return this.ui.$content.html(e),this},getContent:function(){return this.ui.$content[0]},getButtons:function(){return{okBtn:this.ui.$okBtn[0],cancelBtn:this.ui.$cancelBtn[0],loadBtn:this.ui.$loadBtn[0],closeIcon:this.ui.$ui.find(".qui-popup2-closeIcon")[0]}},setOption:function(e){var n=this.ui,i={width:function(){n.setWidth(e.width)},showTitle:function(){n.$title[e.showTitle===!1?"hide":"show"]()},okText:function(){n.$okBtn.val(e.okText)},cancelText:function(){n.$cancelBtn.val(e.cancelText)},showOKBtn:function(){n.$okBtn[e.showOKBtn===!1?"hide":"show"]()},showCancelBtn:function(){n.$cancelBtn[e.showCancelBtn===!1?"hide":"show"]()},showLoadBtn:function(){n.$loadBtn[e.showLoadBtn===!1?"hide":"show"]()},title:function(){n.$title.html(e.title)},exClassName:function(){n.$ui[0].className="qui-popup2 "+e.exClassName},contentHTML:function(){e.iframeSrc||n.$content.html(e.contentHTML)},iframeSrc:function(){n.$content.html('<iframe src="'+e.iframeSrc+'"  scrolling="auto" style="height:'+(e.iframeHeight||300)+'px;" />')},iframeHeight:function(){n.$content.children("iframe").css("height",e.iframeHeight)},showCloseIcon:function(){n.$closeIcon[e.showCloseIcon===!1?"hide":"show"]()}};for(var o in e)this.option[o]=e[o],"function"==t.type(i[o])&&i[o]();n=i=null}},e}),define("old/js/bbs_dlg_common",[],function(){var e=baidu.editor.browser;return{dlgOpt:{showTitle:!1,showCancelBtn:!1,showOKBtn:!1,showCloseIcon:!1},$focus:function(t){setTimeout(function(){if(e.ie){var n=t.createTextRange();n.collapse(!1),n.select()}else t.focus()},0)}}}),define("common/models/basic/js/require-css!web_old_select",[],function(){}),define("web_old_select",["css!web_old_select"],function(){function e(e,t){for(var n=[],i=t;i<e.length;i++)n.push(e[i]);return n}function t(e){this.$obj=e.$obj,this.$title=this.$obj.find(".titles > .title-text"),this.$content=this.$obj.find(".contents"),this.option=e.option,this.selectIndex=0,this.setUI(),this.bindEvent(),this.setDefaultValue()}var n=jQuery;t.prototype={$obj:null,$title:null,$content:null,option:null,selectIndex:null,_disable:!1,setUI:function(){var e=this.$obj.find(".titles"),t=this.$obj.attr("data-ui-width");t=t?t:e.outerWidth(),t=parseInt(t,10),0>=t&&(t=100),t-=2,e.css("width",t),this.$obj.css("width",e.outerWidth());var n=this.$obj.attr("data-ui-height");n&&(this.$obj.css("height",n),this.$obj.find(".titles").css("line-height",n),this.$content.css("top",n)),t=this.$obj.attr("data-ui-menuWidth"),t=t?t:e.outerWidth(),t=parseInt(t,10),t-=2,this.$content.css("width",t),t=n=e=null},bindEvent:function(){var e=this,t=200;this.$obj.delegate(".titles","click",function(i){e._disable||(window.__currentSelect__&&window.__currentSelect__!=e&&window.__currentSelect__.$content.slideUp(t),window.__currentSelect__=e,i.stopPropagation(),e.$content.is(":hidden")?(e.$content.slideDown(t),n(document).one("click",function(){e.$content.slideUp(t)})):e.$content.slideUp(t))}),this.$obj.delegate(".contents > ul > li ","click",function(){e.$content.slideUp(t);var i=n(this);if(e.option&&e.option.onBeforeChange){var o=e.option.onBeforeChange.call(e.$obj[0],i[0]);if(o===!1)return}e.selectIndex=i.index();var r=i.attr("data-value");e.$obj.attr("data-value",r),e.$title.html(i.find("a").html()),e.option&&e.option.onChange&&e.option.onChange.call(e.$obj[0],i[0]),i=r=null})},setDefaultValue:function(){var e=n.trim(this.$obj.attr("data-dafaultValue"));if(e){var t=this.$content.find('ul > li[data-value="'+e+'"] ');t.length&&(this.selectIndex=t.index(),this.$title.html(t.text())),t=null}e=null},getSelectItem:function(){return this.$content.find("ul > li:eq("+this.selectIndex+") ")[0]},setSelectIndex:function(e){this.selectIndex=e;var t=this.$content.find("ul > li:eq("+e+") > a ").html();this.$title.html(t),t=null},getSelectIndex:function(){return this.selectIndex},setOption:function(e,t){this.option[e]=t},setValue:function(e){var t=this.$content.find('ul > li[data-value="'+e+'"]');this.selectIndex=t.index(),this.$title.html(t.children("a").html()),t=null},disable:function(){this._disable=!0,this.$obj.addClass("qui-select-disable")},enable:function(){this._disable=!1,this.$obj.removeClass("qui-select-disable")},setTitle:function(e){this.$title.html(e)}},n.fn.extend({qyerSelect:function(i){var o={getSelectItem:function(e){return e.data("_qyerSelect").getSelectItem()},getValue:function(e){return e.data("_qyerSelect").getSelectItem().getAttribute("data-value")},setValue:function(e,t){return e.data("_qyerSelect").setValue(t)},setSelectIndex:function(e,t){return e.data("_qyerSelect").setSelectIndex(t),e},setOption:function(e,t,n){return e.data("_qyerSelect").setOption(t,n),e},getSelectIndex:function(e){return e.data("_qyerSelect").getSelectIndex()},disable:function(e){return e.data("_qyerSelect").disable()},enable:function(e){return e.data("_qyerSelect").enable()},setTitle:function(e,t){return e.data("_qyerSelect").setTitle(t)}},r=n.type(i);if("object"==r||"undefined"==r){var a;return n.each(this,function(e,o){a=n(o),a.data("_qyerSelect")||a.data("_qyerSelect",new t({$obj:a,option:i?i:{}}))}),a=null,this}if("string"==r){var a,s=arguments,l=[];return n.each(this,function(t,r){if(a=n(r),o[i]){var d=e(s,1);d.unshift(a),l.push(o[i].apply(o,d)),d=null}}),a=s=null,l.length?1==l.length?l[0]:l:this}}})}),define("common/models/basic/js/require-css!old/css/bbs_selimage",[],function(){}),define("old/js/bbs_selimage",["web_old_popup2","old/js/bbs_dlg_common","web_old_select","css!old/css/bbs_selimage.css"],function(e,t){function n(e){this.init(e)}return n.prototype={opt:{contentHTML:'<div class="qyEdit_append_pic clearfix"><div class="qyEdit_append_title clearfix"><strong class="text fontYaHei">插入图片</strong><div class="qui-select" id="photolist" data-ui-width="133"><strong class="titles"><span class="title-text"></span></strong><div style="display: none;" class="contents"></div></div><a href="javascript:void(0);" title="关闭" class="close"></a></div><div class="qyEdit_append_wrap"><div class="qyEdit_append_list clearfix"></div></div><div class="qyEdit_append_button clearfix"><a href="javascript:void(0);" class="btn ui_button_disabled">插入图片</a><a href="javascript:void(0);" class="ui_button_cancel">取消</a></div></div>',exClassName:"editor_selimage",width:622},editor:null,parms:{type:"json",page:1,size:20},curLi:null,init:function(t){return $.extend(this,t||{}),this.popup=new e($.extend(t,this.opt)),this.dom=$("."+this.opt.exClassName),this.loadSelect(),this},loadSelect:function(){var e=this;this.dom.find("#photolist").qyerSelect({onChange:function(t){e.parms.album=t.getAttribute("data-value"),e.parms.page=1,e.dom.find(".qyEdit_append_wrap").scrollTop(0),e.loadData()}})},loadAlbumList:function(){var e=this,t=e.dom.find("#photolist");$.ajax({url:BBS_Url.getMyAlbumList,method:"post",success:function(n){var n=JSON.parse(n);if(0==n.error_code){for(var i,o=n.data||[],r=[],a=0;a<o.length;a++)i=o[a],0==a&&(t.find(".title-text").html(i.name),e.parms.album=i.id,e.parms.page=1,e.loadData()),r.push('<li data-value="'+i.id+'"><a href="javascript:;">'+i.name+"</a></li>");t.find(".contents").html("<ul>"+r.join("")+"</ul>")}}})},loadData:function(e){var t=this,n=e||!1;$.ajax({url:BBS_Url.getAlbumPhotoPage,method:"get",data:t.parms,success:function(e){if(e=JSON.parse(e),0==e.error_code){var i=e.data.res,o=[];if(t.parms.count=e.data.count,0==t.parms.count)return void(0==n&&t.dom.find(".qyEdit_append_list").html(""));for(var r=0;r<i.length;r++)o.push('<li data-src="'+i[r].url+'" data-pid="'+i[r].id+'"><img src="'+i[r].url+'/120x120" width="100" height="100" alt="" /><span class="status"><span ></span></span></li>');1==n?t.dom.find(".qyEdit_append_list").find("ul").append(o.join("")):t.dom.find(".qyEdit_append_list").html("<ul>"+o.join("")+"</ul>")}}})},bindEvent:function(){var e=this;this.dom.off("click input"),this.dom.on("click",".close",function(t){e.hide()}),this.dom.on("click",".ui_button_cancel",function(t){e.hide(),e.curLi=null,$(".btn").addClass("ui_button_disabled").removeClass("ui_button")}),this.dom.find(".qyEdit_append_list").on("click","li",function(){e.curLi&&$(e.curLi).find(".status span").removeClass("selected"),$(this).find(".status span").toggleClass("selected"),e.curLi=this,$(".btn").removeClass("ui_button_disabled").addClass("ui_button")}),this.dom.on("click",".btn",function(){if(null!=e.curLi){var t=$(e.curLi).attr("data-src"),n=$(e.curLi).attr("data-pid");e.editor.execCommand("insertimage",{src:t,_src:t,floatStyle:"left",id:n}),e.hide(),e.curLi=null,$(".btn").addClass("ui_button_disabled").removeClass("ui_button")}}),this.dom.find(".qyEdit_append_wrap").on("scroll",function(){"number"==typeof scrollTimer&&clearTimeout(scrollTimer),scrollTimer=setTimeout(function(){e.execScroll()},1e3)})},execScroll:function(){var e=this.dom.find(".qyEdit_append_wrap"),t=e[0].scrollHeight,n=e.scrollTop(),i=e.height();if(n+i+i/2>=t){var o=Math.ceil(this.parms.count/this.parms.size);this.parms.page<o&&(this.parms.page+=1,this.loadData(!0))}},show:function(){this.popup.show(),this.parms.page=1,this.loadData(!1),this.dom.find(".qyEdit_append_wrap").scrollTop(0),this.bindEvent()},hide:function(){this.popup.hide(!0)}},n}),define("old/js/crumbdroplist",[],function(){function e(){$(".qyer_head_crumb .arrow").removeClass("hover"),$("#bbsDropLayer").hide()}var t,n,i,o,r,a;$(".qyer_head_crumb .arrow").hover(function(){a=$(this),t=a.parent(".drop"),o=t.height(),n=t.offset().left,i=t.offset().top;$(this).attr("data");window.clearTimeout(r),$(".qyer_head_crumb .arrow").removeClass("hover"),$(this).addClass("hover"),$("#bbsDropLayer").css({left:n,
top:i+o}).show()},function(){}),$(".qyer_head_crumb .drop").hover(function(){},function(){r=window.setTimeout(e,300)}),$("#bbsDropLayer").hover(function(){window.clearTimeout(r),a.addClass("hover"),$(this).show()},function(){r=window.setTimeout(e,300)})}),define("common/models/basic/js/require-css!web_old_tip",[],function(){}),define("web_old_tip",["css!web_old_tip"],function(){function e(e){i.html(e.text||"&nbsp;"),n[0].className="qui-tip-box","error"==e.type?n.addClass("qui-tip-box-error"):"warning"==e.type&&n.addClass("qui-tip-box-warning")}var t,n,i,o=jQuery;!function(){var e=['<div class="qui-tip" style="display:none;" >','<div class="qui-tip-box">','<span class="qui-tip-text fontYaHei">这里是提示文本</span>',"</div>","</div>"].join("");t=o(e),i=t.find(".qui-tip-text"),n=t.find(".qui-tip-box"),t.appendTo(document.body)}();var r={_timer:null,tip:function(n){return e(n),t.slideDown(200),window.clearTimeout(this._timer),this._timer=setTimeout(function(){t.slideUp(200)},n.time||3e3),this}};return r}),define("old/js/like",[],function(){function e(e){var t={dom:"",tid:0,isLike:function(){return!1},onLike:function(){},onDislike:function(){}};this.config=$.extend(!0,{},t,e),this.config.dom.addClass("doc-info-like");var n=$(".doc-info-like");n.hasClass("active")?n.html("已喜欢").attr("title","取消喜欢"):n.html("喜欢").attr("title","喜欢"),this.bindEvent()}var t="/qcross/bbs/thread.php?action=like",n=!1;return e.prototype.onError=function(e){requirejs(["web_old_tip"],function(t){t.tip({text:e,type:"error"})})},e.prototype.onSuccess=function(){this.config.isLike()?this.config.onDislike():this.config.onLike()},e.prototype.bindEvent=function(){var e=this,i=this.config.dom;i.on("click",function(){if(!window.qyerUtil.isLogin())return void window.qyerUtil.doLogin();if(!n){var i={tid:e.config.tid,opt:e.config.isLike()?0:1};n=!0,$.post(t,i,function(t){if(n=!1,0!==t.error_code)e.onError(t.data.msg);else{e.onSuccess();var i=$(".doc-info-like");e.config.isLike()?i.html("已喜欢").attr("title","取消喜欢"):i.html("喜欢").attr("title","喜欢")}},"json")}})},e}),define("old/js/collect",[],function(){function e(e){var t={dom:"",tid:0,isCollect:function(){return!1},onCollect:function(){},onDiscollect:function(){}};this.config=$.extend(!0,{},t,e),this.config.dom.addClass("doc-info-col");var n=$(".doc-info-col");n.hasClass("active")?n.html("已收藏").attr("title","取消收藏"):n.html("收藏").attr("title","收藏"),this.bindEvent()}var t="/qcross/bbs/thread.php?action=favorite",n=!1;return e.prototype.onError=function(e){requirejs(["web_old_tip"],function(t){t.tip({text:e,type:"error"})})},e.prototype.onSuccess=function(){this.config.isCollect()?this.config.onDiscollect():this.config.onCollect()},e.prototype.bindEvent=function(){var e=this,i=this.config.dom;i.on("click",function(){if(!window.qyerUtil.isLogin())return void window.qyerUtil.doLogin();if(!n){var i={tid:e.config.tid,opt:e.config.isCollect()?0:1};n=!0,$.post(t,i,function(t){if(n=!1,0!==t.error_code)e.onError(t.data.msg);else{e.onSuccess();var i=$(".doc-info-col");e.config.isCollect()?i.html("已收藏").attr("title","取消收藏"):i.html("收藏").attr("title","收藏")}},"json")}})},e}),!function(e,t){"use strict";function n(e,t){for(var n,i=[],r=0;r<e.length;++r){if(n=a[e[r]]||o(e[r]),!n)throw"module definition dependecy not found: "+e[r];i.push(n)}t.apply(null,i)}function i(e,i,o){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(i===t)throw"invalid module definition, dependencies must be specified";if(o===t)throw"invalid module definition, definition function must be specified";n(i,function(){a[e]=o.apply(null,arguments)})}function o(t){for(var n=e,i=t.split(/[.\/]/),o=0;o<i.length;++o){if(!n[i[o]])return;n=n[i[o]]}return n}function r(n){for(var i=0;i<n.length;i++){for(var o=e,r=n[i],s=r.split(/[.\/]/),l=0;l<s.length-1;++l)o[s[l]]===t&&(o[s[l]]={}),o=o[s[l]];o[s[s.length-1]]=a[r]}}var a={},s="moxie/core/utils/Basic",l="moxie/core/I18n",d="moxie/core/utils/Mime",c="moxie/core/utils/Env",u="moxie/core/utils/Dom",p="moxie/core/Exceptions",h="moxie/core/EventTarget",f="moxie/core/utils/Encode",m="moxie/runtime/Runtime",g="moxie/runtime/RuntimeClient",b="moxie/file/Blob",v="moxie/file/File",y="moxie/file/FileInput",x="moxie/file/FileDrop",_="moxie/runtime/RuntimeTarget",w="moxie/file/FileReader",k="moxie/core/utils/Url",C="moxie/file/FileReaderSync",E="moxie/xhr/FormData",T="moxie/xhr/XMLHttpRequest",S="moxie/runtime/Transporter",N="moxie/image/Image",$="moxie/runtime/html5/Runtime",q="moxie/runtime/html5/file/Blob",A="moxie/core/utils/Events",I="moxie/runtime/html5/file/FileInput",D="moxie/runtime/html5/file/FileDrop",R="moxie/runtime/html5/file/FileReader",U="moxie/runtime/html5/xhr/XMLHttpRequest",O="moxie/runtime/html5/utils/BinaryReader",B="moxie/runtime/html5/image/JPEGHeaders",L="moxie/runtime/html5/image/ExifParser",j="moxie/runtime/html5/image/JPEG",P="moxie/runtime/html5/image/PNG",H="moxie/runtime/html5/image/ImageInfo",M="moxie/runtime/html5/image/MegaPixel",z="moxie/runtime/html5/image/Image",F="moxie/runtime/flash/Runtime",W="moxie/runtime/flash/file/Blob",V="moxie/runtime/flash/file/FileInput",X="moxie/runtime/flash/file/FileReader",G="moxie/runtime/flash/file/FileReaderSync",Y="moxie/runtime/flash/xhr/XMLHttpRequest",K="moxie/runtime/flash/runtime/Transporter",J="moxie/runtime/flash/image/Image",Q="moxie/runtime/silverlight/Runtime",Z="moxie/runtime/silverlight/file/Blob",ee="moxie/runtime/silverlight/file/FileInput",te="moxie/runtime/silverlight/file/FileDrop",ne="moxie/runtime/silverlight/file/FileReader",ie="moxie/runtime/silverlight/file/FileReaderSync",oe="moxie/runtime/silverlight/xhr/XMLHttpRequest",re="moxie/runtime/silverlight/runtime/Transporter",ae="moxie/runtime/silverlight/image/Image",se="moxie/runtime/html4/Runtime",le="moxie/runtime/html4/file/FileInput",de="moxie/runtime/html4/file/FileReader",ce="moxie/runtime/html4/xhr/XMLHttpRequest",ue="moxie/runtime/html4/image/Image";i(s,[],function(){var e=function(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},t=function(i){var o;return n(arguments,function(r,s){s>0&&n(r,function(n,r){n!==o&&(e(i[r])===e(n)&&~a(e(n),["array","object"])?t(i[r],n):i[r]=n)})}),i},n=function(e,t){var n,i,o,r;if(e){try{n=e.length}catch(a){n=r}if(n===r){for(i in e)if(e.hasOwnProperty(i)&&t(e[i],i)===!1)return}else for(o=0;n>o;o++)if(t(e[o],o)===!1)return}},i=function(t){var n;if(!t||"object"!==e(t))return!0;for(n in t)return!1;return!0},o=function(t,n){function i(o){"function"===e(t[o])&&t[o](function(e){++o<r&&!e?i(o):n(e)})}var o=0,r=t.length;"function"!==e(n)&&(n=function(){}),t&&t.length||n(),i(o)},r=function(e,t){var i=0,o=e.length,r=new Array(o);n(e,function(e,n){e(function(e){if(e)return t(e);var a=[].slice.call(arguments);a.shift(),r[n]=a,i++,i===o&&(r.unshift(null),t.apply(this,r))})})},a=function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n}return-1},s=function(t,n){var i=[];"array"!==e(t)&&(t=[t]),"array"!==e(n)&&(n=[n]);for(var o in t)-1===a(t[o],n)&&i.push(t[o]);return!!i.length&&i},l=function(e,t){var i=[];return n(e,function(e){-1!==a(e,t)&&i.push(e)}),i.length?i:null},d=function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},c=function(){var e=0;return function(t){var n,i=(new Date).getTime().toString(32);for(n=0;5>n;n++)i+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+i+(e++).toString(32)}}(),u=function(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e},p=function(e){if("string"!=typeof e)return e;var t,n={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],n.hasOwnProperty(t)&&(e*=n[t]),e};return{guid:c,typeOf:e,extend:t,each:n,isEmptyObj:i,inSeries:o,inParallel:r,inArray:a,arrayDiff:s,arrayIntersect:l,toArray:d,trim:u,parseSizeStr:p}}),i(l,[s],function(e){var t={};return{addI18n:function(n){return e.extend(t,n)},translate:function(e){return t[e]||e},_:function(e){return this.translate(e)},sprintf:function(t){var n=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=n.shift();return"undefined"!==e.typeOf(t)?t:""})}}}),i(d,[s,l],function(e,t){var n="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",i={mimes:{},extensions:{},addMimeType:function(e){var t,n,i,o=e.split(/,/);for(t=0;t<o.length;t+=2){for(i=o[t+1].split(/ /),n=0;n<i.length;n++)this.mimes[i[n]]=o[t];this.extensions[o[t]]=i}},extList2mimes:function(t,n){var i,o,r,a,s=this,l=[];for(o=0;o<t.length;o++)for(i=t[o].extensions.split(/\s*,\s*/),r=0;r<i.length;r++){if("*"===i[r])return[];if(a=s.mimes[i[r]])-1===e.inArray(a,l)&&l.push(a);else{if(!n||!/^\w+$/.test(i[r]))return[];l.push("."+i[r])}}return l},mimes2exts:function(t){var n=this,i=[];return e.each(t,function(t){if("*"===t)return i=[],!1;var o=t.match(/^(\w+)\/(\*|\w+)$/);o&&("*"===o[2]?e.each(n.extensions,function(e,t){new RegExp("^"+o[1]+"/").test(t)&&[].push.apply(i,n.extensions[t])}):n.extensions[t]&&[].push.apply(i,n.extensions[t]))}),i},mimes2extList:function(n){var i=[],o=[];return"string"===e.typeOf(n)&&(n=e.trim(n).split(/\s*,\s*/)),o=this.mimes2exts(n),i.push({title:t.translate("Files"),extensions:o.length?o.join(","):"*"}),i.mimes=n,i},getFileExtension:function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""},getFileMime:function(e){return this.mimes[this.getFileExtension(e)]||""}};return i.addMimeType(n),i}),i(c,[s],function(e){function t(e,t,n){var i=0,o=0,r=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(e){return e=(""+e).replace(/[_\-+]/g,"."),e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),e.length?e.split("."):[-8]},l=function(e){return e?isNaN(e)?a[e]||-7:parseInt(e,10):0};for(e=s(e),t=s(t),o=Math.max(e.length,t.length),i=0;o>i;i++)if(e[i]!=t[i]){if(e[i]=l(e[i]),t[i]=l(t[i]),e[i]<t[i]){r=-1;break}if(e[i]>t[i]){r=1;break}}if(!n)return r;switch(n){case">":case"gt":return r>0;case">=":case"ge":return r>=0;case"<=":case"le":return 0>=r;case"==":case"=":case"eq":return 0===r;case"<>":case"!=":case"ne":return 0!==r;case"":case"<":case"lt":return 0>r;default:return null}}var n=function(e){var t="",n="?",i="function",o="undefined",r="object",a="major",s="name",l="version",d={has:function(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()}},c={rgx:function(){for(var t,n,a,s,l,d,c,u=0,p=arguments;u<p.length;u+=2){var h=p[u],f=p[u+1];if(typeof t===o){t={};for(s in f)l=f[s],typeof l===r?t[l[0]]=e:t[l]=e}for(n=a=0;n<h.length;n++)if(d=h[n].exec(this.getUA())){for(s=0;s<f.length;s++)c=d[++a],l=f[s],typeof l===r&&l.length>0?2==l.length?t[l[0]]=typeof l[1]==i?l[1].call(this,c):l[1]:3==l.length?t[l[0]]=typeof l[1]!==i||l[1].exec&&l[1].test?c?c.replace(l[1],l[2]):e:c?l[1].call(this,c,l[2]):e:4==l.length&&(t[l[0]]=c?l[3].call(this,c.replace(l[1],l[2])):e):t[l]=c?c:e;break}if(d)break}return t},str:function(t,i){for(var o in i)if(typeof i[o]===r&&i[o].length>0){for(var a=0;a<i[o].length;a++)if(d.has(i[o][a],t))return o===n?e:o}else if(d.has(i[o],t))return o===n?e:o;return t}},u={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},p={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[s,l,a],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[s,"Opera"],l,a],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[s,l,a],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[s,"IE"],l,a],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[s,"Yandex"],l,a],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[s,/_/g," "],l,a],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[s,l,a],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[s,"Dolphin"],l,a],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[s,"Chrome"],l,a],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[s,"Android Browser"],l,a],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[l,a,[s,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[l,a,s],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[s,[a,c.str,u.browser.oldsafari.major],[l,c.str,u.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[s,l,a],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[s,"Netscape"],l,a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[s,l,a]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,l],[/rv\:([\w\.]+).*(gecko)/i],[l,s]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[l,c.str,u.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[l,c.str,u.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[s,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],l],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],l],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],l],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,l],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[l,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[s,[l,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[s,l]]},h=function(e){var n=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:t);this.getBrowser=function(){return c.rgx.apply(this,p.browser)},this.getEngine=function(){return c.rgx.apply(this,p.engine)},this.getOS=function(){return c.rgx.apply(this,p.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this.setUA(n)};return(new h).getResult()}(),i=function(){var t={define_property:function(){return!1}(),create_canvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),return_response_type:function(t){try{if(-1!==e.inArray(t,["","text","document"]))return!0;if(window.XMLHttpRequest){var n=new XMLHttpRequest;if(n.open("get","/"),"responseType"in n)return n.responseType=t,n.responseType===t}}catch(i){}return!1},use_data_uri:function(){var e=new Image;return e.onload=function(){t.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return t.use_data_uri&&("IE"!==o.browser||o.version>=9)},use_data_uri_of:function(e){return t.use_data_uri&&33e3>e||t.use_data_uri_over32kb()},use_fileinput:function(){var e=document.createElement("input");return e.setAttribute("type","file"),!e.disabled}};return function(n){var i=[].slice.call(arguments);return i.shift(),"function"===e.typeOf(t[n])?t[n].apply(this,i):!!t[n]}}(),o={can:i,browser:n.browser.name,version:parseFloat(n.browser.major),os:n.os.name,osVersion:n.os.version,verComp:t,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return o.OS=o.os,o}),i(u,[c],function(e){var t=function(e){return"string"!=typeof e?e:document.getElementById(e)},n=function(e,t){if(!e.className)return!1;var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return n.test(e.className)},i=function(e,t){n(e,t)||(e.className=e.className?e.className.replace(/\s+$/,"")+" "+t:t)},o=function(e,t){if(e.className){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return" "===t&&" "===n?" ":""})}},r=function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},a=function(t,n){function i(e){var t,n,i=0,o=0;return e&&(n=e.getBoundingClientRect(),t="CSS1Compat"===d.compatMode?d.documentElement:d.body,i=n.left+t.scrollLeft,o=n.top+t.scrollTop),{x:i,y:o}}var o,r,a,s=0,l=0,d=document;if(t=t,n=n||d.body,t&&t.getBoundingClientRect&&"IE"===e.browser&&(!d.documentMode||d.documentMode<8))return r=i(t),a=i(n),{x:r.x-a.x,y:r.y-a.y};for(o=t;o&&o!=n&&o.nodeType;)s+=o.offsetLeft||0,l+=o.offsetTop||0,o=o.offsetParent;for(o=t.parentNode;o&&o!=n&&o.nodeType;)s-=o.scrollLeft||0,l-=o.scrollTop||0,o=o.parentNode;return{x:s,y:l}},s=function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}};return{get:t,hasClass:n,addClass:i,removeClass:o,getStyle:r,getPos:a,getSize:s}}),i(p,[s],function(e){function t(e,t){var n;for(n in e)if(e[n]===t)return n;return null}return{RuntimeError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": RuntimeError "+this.code}var i={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(n,i),n.prototype=Error.prototype,n}(),OperationNotAllowedException:function(){function t(e){this.code=e,this.name="OperationNotAllowedException"}return e.extend(t,{NOT_ALLOWED_ERR:1}),t.prototype=Error.prototype,t}(),ImageError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": ImageError "+this.code}var i={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return e.extend(n,i),n.prototype=Error.prototype,n}(),FileException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": FileException "+this.code}var i={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(n,i),n.prototype=Error.prototype,n}(),DOMException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": DOMException "+this.code}var i={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(n,i),n.prototype=Error.prototype,n}(),EventException:function(){function t(e){this.code=e,this.name="EventException"}return e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0}),t.prototype=Error.prototype,t}()}}),i(h,[p,s],function(e,t){function n(){var n={};t.extend(this,{uid:null,init:function(){this.uid||(this.uid=t.guid("uid_"))},addEventListener:function(e,i,o,r){var a,s=this;return e=t.trim(e),/\s/.test(e)?void t.each(e.split(/\s+/),function(e){s.addEventListener(e,i,o,r)}):(e=e.toLowerCase(),o=parseInt(o,10)||0,a=n[this.uid]&&n[this.uid][e]||[],a.push({fn:i,priority:o,scope:r||this}),n[this.uid]||(n[this.uid]={}),void(n[this.uid][e]=a))},hasEventListener:function(e){return e?!(!n[this.uid]||!n[this.uid][e]):!!n[this.uid]},removeEventListener:function(e,i){e=e.toLowerCase();var o,r=n[this.uid]&&n[this.uid][e];if(r){if(i){for(o=r.length-1;o>=0;o--)if(r[o].fn===i){r.splice(o,1);break}}else r=[];r.length||(delete n[this.uid][e],t.isEmptyObj(n[this.uid])&&delete n[this.uid])}},removeAllEventListeners:function(){n[this.uid]&&delete n[this.uid]},dispatchEvent:function(i){var o,r,a,s,l,d={},c=!0;if("string"!==t.typeOf(i)){if(s=i,"string"!==t.typeOf(s.type))throw new e.EventException(e.EventException.UNSPECIFIED_EVENT_TYPE_ERR);i=s.type,s.total!==l&&s.loaded!==l&&(d.total=s.total,d.loaded=s.loaded),d.async=s.async||!1}if(-1!==i.indexOf("::")?function(e){o=e[0],i=e[1]}(i.split("::")):o=this.uid,i=i.toLowerCase(),r=n[o]&&n[o][i]){r.sort(function(e,t){return t.priority-e.priority}),a=[].slice.call(arguments),a.shift(),d.type=i,a.unshift(d);var u=[];t.each(r,function(e){a[0].target=e.scope,d.async?u.push(function(t){setTimeout(function(){t(e.fn.apply(e.scope,a)===!1)},1)}):u.push(function(t){t(e.fn.apply(e.scope,a)===!1)})}),u.length&&t.inSeries(u,function(e){c=!e})}return c},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(e){var n;"array"!==t.typeOf(e)&&(e=[e]);for(var i=0;i<e.length;i++)n="on"+e[i],"function"===t.typeOf(this[n])?this.addEventListener(e[i],this[n]):"undefined"===t.typeOf(this[n])&&(this[n]=null)}})}return n.instance=new n,n}),i(f,[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))},n=function(e,n){if("function"==typeof window.atob)return n?t(window.atob(e)):window.atob(e);var i,o,r,a,s,l,d,c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,h=0,f="",m=[];if(!e)return e;e+="";do a=u.indexOf(e.charAt(p++)),s=u.indexOf(e.charAt(p++)),l=u.indexOf(e.charAt(p++)),d=u.indexOf(e.charAt(p++)),c=a<<18|s<<12|l<<6|d,i=255&c>>16,o=255&c>>8,r=255&c,m[h++]=64==l?String.fromCharCode(i):64==d?String.fromCharCode(i,o):String.fromCharCode(i,o,r);while(p<e.length);return f=m.join(""),n?t(f):f},i=function(t,n){if(n&&e(t),"function"==typeof window.btoa)return window.btoa(t);var i,o,r,a,s,l,d,c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,h=0,f="",m=[];if(!t)return t;do i=t.charCodeAt(p++),o=t.charCodeAt(p++),r=t.charCodeAt(p++),c=i<<16|o<<8|r,a=63&c>>18,s=63&c>>12,l=63&c>>6,d=63&c,m[h++]=u.charAt(a)+u.charAt(s)+u.charAt(l)+u.charAt(d);while(p<t.length);f=m.join("");var g=t.length%3;return(g?f.slice(0,g-3):f)+"===".slice(g||3)};return{utf8_encode:e,utf8_decode:t,atob:n,btoa:i}}),i(m,[s,u,h],function(e,t,n){function i(n,o,a,s,l){var d,c=this,u=e.guid(o+"_"),p=l||"browser";n=n||{},r[u]=this,a=e.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},a),n.preferred_caps&&(p=i.getMode(s,n.preferred_caps,p)),d=function(){var t={};return{exec:function(e,n,i,o){return d[n]&&(t[e]||(t[e]={context:this,instance:new d[n]}),t[e].instance[i])?t[e].instance[i].apply(this,o):void 0},removeInstance:function(e){delete t[e]},removeAllInstances:function(){var n=this;e.each(t,function(t,i){"function"===e.typeOf(t.instance.destroy)&&t.instance.destroy.call(t.context),n.removeInstance(i)})}}}(),e.extend(this,{initialized:!1,uid:u,type:o,mode:i.getMode(s,n.required_caps,p),shimid:u+"_container",clients:0,options:n,can:function(t,n){var o=arguments[2]||a;if("string"===e.typeOf(t)&&"undefined"===e.typeOf(n)&&(t=i.parseCaps(t)),"object"===e.typeOf(t)){for(var r in t)if(!this.can(r,t[r],o))return!1;return!0}return"function"===e.typeOf(o[t])?o[t].call(this,n):n===o[t]},getShimContainer:function(){var n,i=t.get(this.shimid);return i||(n=this.options.container?t.get(this.options.container):document.body,i=document.createElement("div"),i.id=this.shimid,i.className="moxie-shim moxie-shim-"+this.type,e.extend(i.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),n.appendChild(i),n=null),i},getShim:function(){return d},shimExec:function(e,t){var n=[].slice.call(arguments,2);return c.getShim().exec.call(this,this.uid,e,t,n)},exec:function(e,t){var n=[].slice.call(arguments,2);return c[e]&&c[e][t]?c[e][t].apply(this,n):c.shimExec.apply(this,arguments)},destroy:function(){if(c){var e=t.get(this.shimid);e&&e.parentNode.removeChild(e),d&&d.removeAllInstances(),this.unbindAll(),delete r[this.uid],this.uid=null,u=c=d=e=null}}}),this.mode&&n.required_caps&&!this.can(n.required_caps)&&(this.mode=!1)}var o={},r={};return i.order="html5,flash,silverlight,html4",i.getRuntime=function(e){return!!r[e]&&r[e]},i.addConstructor=function(e,t){t.prototype=n.instance,o[e]=t},i.getConstructor=function(e){return o[e]||null},i.getInfo=function(e){var t=i.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},i.parseCaps=function(t){var n={};return"string"!==e.typeOf(t)?t||{}:(e.each(t.split(","),function(e){n[e]=!0}),n)},i.can=function(e,t){var n,o,r=i.getConstructor(e);return!!r&&(n=new r({required_caps:t}),o=n.mode,n.destroy(),!!o)},i.thatCan=function(e,t){var n=(t||i.order).split(/\s*,\s*/);for(var o in n)if(i.can(n[o],e))return n[o];return null},i.getMode=function(t,n,i){var o=null;if("undefined"===e.typeOf(i)&&(i="browser"),n&&!e.isEmptyObj(t)){if(e.each(n,function(n,i){if(t.hasOwnProperty(i)){var r=t[i](n);if("string"==typeof r&&(r=[r]),o){if(!(o=e.arrayIntersect(o,r)))return o=!1}else o=r}}),o)return-1!==e.inArray(i,o)?i:o[0];if(o===!1)return!1}return i},i.capTrue=function(){return!0},i.capFalse=function(){return!1},i.capTest=function(e){return function(){return!!e}},i}),i(g,[p,s,m],function(e,t,n){return function i(){var i;t.extend(this,{connectRuntime:function(o){function r(t){var a,l;return t.length?(a=t.shift(),(l=n.getConstructor(a))?(i=new l(o),i.bind("Init",function(){i.initialized=!0,setTimeout(function(){i.clients++,s.trigger("RuntimeInit",i)},1)}),i.bind("Error",function(){i.destroy(),r(t)}),i.mode?void i.init():void i.trigger("Error")):void r(t)):(s.trigger("RuntimeError",new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)),void(i=null))}var a,s=this;if("string"===t.typeOf(o)?a=o:"string"===t.typeOf(o.ruid)&&(a=o.ruid),a){if(i=n.getRuntime(a))return i.clients++,i;throw new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)}r((o.runtime_order||n.order).split(/\s*,\s*/))},getRuntime:function(){return i&&i.uid?i:(i=null,null)},disconnectRuntime:function(){i&&--i.clients<=0&&(i.destroy(),i=null)}})}}),i(b,[s,f,g],function(e,t,n){function i(r,a){function s(t,n,r){var a,s=o[this.uid];return"string"===e.typeOf(s)&&s.length?(a=new i(null,{type:r,size:n-t}),a.detach(s.substr(t,a.size)),a):null}n.call(this),r&&this.connectRuntime(r),a?"string"===e.typeOf(a)&&(a={data:a}):a={},e.extend(this,{uid:a.uid||e.guid("uid_"),ruid:r,size:a.size||0,type:a.type||"",slice:function(e,t,n){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,n)},getSource:function(){return o[this.uid]?o[this.uid]:null},detach:function(e){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy",o[this.uid]),this.disconnectRuntime(),this.ruid=null),e=e||"";var n=e.match(/^data:([^;]*);base64,/);n&&(this.type=n[1],e=t.atob(e.substring(e.indexOf("base64,")+7))),this.size=e.length,o[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===e.typeOf(o[this.uid])},destroy:function(){this.detach(),delete o[this.uid]}}),a.data?this.detach(a.data):o[this.uid]=a}var o={};return i}),i(v,[s,d,b],function(e,t,n){function i(i,o){var r,a;if(o||(o={}),a=o.type&&""!==o.type?o.type:t.getFileMime(o.name),o.name)r=o.name.replace(/\\/g,"/"),r=r.substr(r.lastIndexOf("/")+1);else{var s=a.split("/")[0];r=e.guid((""!==s?s:"file")+"_"),t.extensions[a]&&(r+="."+t.extensions[a][0])}n.apply(this,arguments),e.extend(this,{type:a||"",name:r||e.guid("file_"),lastModifiedDate:o.lastModifiedDate||(new Date).toLocaleString()})}return i.prototype=n.prototype,i}),i(y,[s,d,u,p,h,l,v,m,g],function(e,t,n,i,o,r,a,s,l){function d(o){var d,u,p,h=this;if(-1!==e.inArray(e.typeOf(o),["string","node"])&&(o={browse_button:o}),u=n.get(o.browse_button),!u)throw new i.DOMException(i.DOMException.NOT_FOUND_ERR);p={accept:[{title:r.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:u.parentNode||document.body},o=e.extend({},p,o),"string"==typeof o.required_caps&&(o.required_caps=s.parseCaps(o.required_caps)),"string"==typeof o.accept&&(o.accept=t.mimes2extList(o.accept)),d=n.get(o.container),d||(d=document.body),"static"===n.getStyle(d,"position")&&(d.style.position="relative"),d=u=null,l.call(h),e.extend(h,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){h.convertEventPropsToHandlers(c),h.bind("RuntimeInit",function(t,i){h.ruid=i.uid,h.shimid=i.shimid,h.bind("Ready",function(){h.trigger("Refresh")},999),h.bind("Change",function(){var t=i.exec.call(h,"FileInput","getFiles");h.files=[],e.each(t,function(e){return 0===e.size||void h.files.push(new a(h.ruid,e))})},999),h.bind("Refresh",function(){var t,r,a,s;a=n.get(o.browse_button),s=n.get(i.shimid),a&&(t=n.getPos(a,n.get(o.container)),r=n.getSize(a),s&&e.extend(s.style,{top:t.y+"px",left:t.x+"px",width:r.w+"px",height:r.h+"px"})),s=a=null}),i.exec.call(h,"FileInput","init",o)}),h.connectRuntime(e.extend({},o,{required_caps:{select_file:!0}}))},disable:function(t){
var n=this.getRuntime();n&&n.exec.call(this,"FileInput","disable","undefined"===e.typeOf(t)||t)},refresh:function(){h.trigger("Refresh")},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===e.typeOf(this.files)&&e.each(this.files,function(e){e.destroy()}),this.files=null}})}var c=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return d.prototype=o.instance,d}),i(x,[l,u,p,s,v,g,h,d],function(e,t,n,i,o,r,a,s){function l(n){var a,l=this;"string"==typeof n&&(n={drop_zone:n}),a={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},n="object"==typeof n?i.extend({},a,n):a,n.container=t.get(n.drop_zone)||document.body,"static"===t.getStyle(n.container,"position")&&(n.container.style.position="relative"),"string"==typeof n.accept&&(n.accept=s.mimes2extList(n.accept)),r.call(l),i.extend(l,{uid:i.guid("uid_"),ruid:null,files:null,init:function(){l.convertEventPropsToHandlers(d),l.bind("RuntimeInit",function(e,t){l.ruid=t.uid,l.bind("Drop",function(){var e=t.exec.call(l,"FileDrop","getFiles");l.files=[],i.each(e,function(e){l.files.push(new o(l.ruid,e))})},999),t.exec.call(l,"FileDrop","init",n),l.dispatchEvent("ready")}),l.connectRuntime(n)},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var d=["ready","dragenter","dragleave","drop","error"];return l.prototype=a.instance,l}),i(_,[s,g,h],function(e,t,n){function i(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return i.prototype=n.instance,i}),i(w,[s,f,p,h,b,v,_],function(e,t,n,i,o,r,a){function s(){function i(e,i){function c(e){d.readyState=s.DONE,d.error=e,d.trigger("error"),u()}function u(){r.destroy(),r=null,d.trigger("loadend")}function p(t){r.bind("Error",function(e,t){c(t)}),r.bind("Progress",function(e){d.result=t.exec.call(r,"FileReader","getResult"),d.trigger(e)}),r.bind("Load",function(e){d.readyState=s.DONE,d.result=t.exec.call(r,"FileReader","getResult"),d.trigger(e),u()}),t.exec.call(r,"FileReader","read",e,i)}if(r=new a,this.convertEventPropsToHandlers(l),this.readyState===s.LOADING)return c(new n.DOMException(n.DOMException.INVALID_STATE_ERR));if(this.readyState=s.LOADING,this.trigger("loadstart"),i instanceof o)if(i.isDetached()){var h=i.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=h;break;case"readAsDataURL":this.result="data:"+i.type+";base64,"+t.btoa(h)}this.readyState=s.DONE,this.trigger("load"),u()}else p(r.connectRuntime(i.ruid));else c(new n.DOMException(n.DOMException.NOT_FOUND_ERR))}var r,d=this;e.extend(this,{uid:e.guid("uid_"),readyState:s.EMPTY,result:null,error:null,readAsBinaryString:function(e){i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){i.call(this,"readAsDataURL",e)},readAsText:function(e){i.call(this,"readAsText",e)},abort:function(){this.result=null,-1===e.inArray(this.readyState,[s.EMPTY,s.DONE])&&(this.readyState===s.LOADING&&(this.readyState=s.DONE),r&&r.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),r&&(r.getRuntime().exec.call(this,"FileReader","destroy"),r.disconnectRuntime()),d=r=null}})}var l=["loadstart","progress","load","abort","error","loadend"];return s.EMPTY=0,s.LOADING=1,s.DONE=2,s.prototype=i.instance,s}),i(k,[],function(){var e=function(t,n){for(var i=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],o=i.length,r={http:80,https:443},a={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,l=s.exec(t||"");o--;)l[o]&&(a[i[o]]=l[o]);if(!a.scheme){n&&"string"!=typeof n||(n=e(n||document.location.href)),a.scheme=n.scheme,a.host=n.host,a.port=n.port;var d="";/^[^\/]/.test(a.path)&&(d=n.path,/(\/|\/[^\.]+)$/.test(d)?d+="/":d=d.replace(/\/[^\/]+$/,"/")),a.path=d+(a.path||"")}return a.port||(a.port=r[a.scheme]||80),a.port=parseInt(a.port,10),a.path||(a.path="/"),delete a.source,a},t=function(t){var n={http:80,https:443},i=e(t);return i.scheme+"://"+i.host+(i.port!==n[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},n=function(t){function n(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof t&&(t=e(t)),n(e())===n(t)};return{parseUrl:e,resolveUrl:t,hasSameOrigin:n}}),i(C,[s,g,f],function(e,t,n){return function(){function i(e,t){if(!t.isDetached()){var i=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),i}var o=t.getSource();switch(e){case"readAsBinaryString":return o;case"readAsDataURL":return"data:"+t.type+";base64,"+n.btoa(o);case"readAsText":for(var r="",a=0,s=o.length;s>a;a++)r+=String.fromCharCode(o[a]);return r}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(e){return i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return i.call(this,"readAsDataURL",e)},readAsText:function(e){return i.call(this,"readAsText",e)}})}}),i(E,[p,s,b],function(e,t,n){function i(){var e,i=[];t.extend(this,{append:function(o,r){var a=this,s=t.typeOf(r);r instanceof n?e={name:o,value:r}:"array"===s?(o+="[]",t.each(r,function(e){a.append(o,e)})):"object"===s?t.each(r,function(e,t){a.append(o+"["+t+"]",e)}):"null"===s||"undefined"===s||"number"===s&&isNaN(r)?a.append(o,"false"):i.push({name:o,value:r.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(n){t.each(i,function(e){n(e.value,e.name)}),e&&n(e.value,e.name)},destroy:function(){e=null,i=[]}})}return i}),i(T,[s,p,h,f,k,m,_,b,C,E,c,d],function(e,t,n,i,o,r,a,s,l,d,c,u){function p(){this.uid=e.guid("uid_")}function h(){function n(e,t){return T.hasOwnProperty(e)?1===arguments.length?c.can("define_property")?T[e]:E[e]:void(c.can("define_property")?T[e]=t:E[e]=t):void 0}function l(t){function i(){k.destroy(),k=null,s.dispatchEvent("loadend"),s=null}function o(o){k.bind("LoadStart",function(e){n("readyState",h.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(e),D&&s.upload.dispatchEvent(e)}),k.bind("Progress",function(e){n("readyState")!==h.LOADING&&(n("readyState",h.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(e)}),k.bind("UploadProgress",function(e){D&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),k.bind("Load",function(t){n("readyState",h.DONE),n("status",Number(o.exec.call(k,"XMLHttpRequest","getStatus")||0)),n("statusText",f[n("status")]||""),n("response",o.exec.call(k,"XMLHttpRequest","getResponse",n("responseType"))),~e.inArray(n("responseType"),["text",""])?n("responseText",n("response")):"document"===n("responseType")&&n("responseXML",n("response")),P=o.exec.call(k,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),n("status")>0?(D&&s.upload.dispatchEvent(t),s.dispatchEvent(t)):(U=!0,s.dispatchEvent("error")),i()}),k.bind("Abort",function(e){s.dispatchEvent(e),i()}),k.bind("Error",function(e){U=!0,n("readyState",h.DONE),s.dispatchEvent("readystatechange"),R=!0,s.dispatchEvent(e),i()}),o.exec.call(k,"XMLHttpRequest","send",{url:b,method:v,async:S,user:y,password:x,headers:N,mimeType:q,encoding:$,responseType:s.responseType,withCredentials:s.withCredentials,options:j},t)}var s=this;_=(new Date).getTime(),k=new a,"string"==typeof j.required_caps&&(j.required_caps=r.parseCaps(j.required_caps)),j.required_caps=e.extend({},j.required_caps,{return_response_type:s.responseType}),t instanceof d&&(j.required_caps.send_multipart=!0),O||(j.required_caps.do_cors=!0),j.ruid?o(k.connectRuntime(j)):(k.bind("RuntimeInit",function(e,t){o(t)}),k.bind("RuntimeError",function(e,t){s.dispatchEvent("RuntimeError",t)}),k.connectRuntime(j))}function g(){n("responseText",""),n("responseXML",null),n("response",null),n("status",0),n("statusText",""),_=w=null}var b,v,y,x,_,w,k,C,E=this,T={timeout:0,readyState:h.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},S=!0,N={},$=null,q=null,A=!1,I=!1,D=!1,R=!1,U=!1,O=!1,B=null,L=null,j={},P="";e.extend(this,T,{uid:e.guid("uid_"),upload:new p,open:function(r,a,s,l,d){var c;if(!r||!a)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(r)||i.utf8_encode(r)!==r)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(~e.inArray(r.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(v=r.toUpperCase()),~e.inArray(v,["CONNECT","TRACE","TRACK"]))throw new t.DOMException(t.DOMException.SECURITY_ERR);if(a=i.utf8_encode(a),c=o.parseUrl(a),O=o.hasSameOrigin(c),b=o.resolveUrl(a),(l||d)&&!O)throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);if(y=l||c.user,x=d||c.pass,S=s||!0,S===!1&&(n("timeout")||n("withCredentials")||""!==n("responseType")))throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);A=!S,I=!1,N={},g.call(this),n("readyState",h.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(o,r){var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(n("readyState")!==h.OPENED||I)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(o)||i.utf8_encode(o)!==o)throw new t.DOMException(t.DOMException.SYNTAX_ERR);return o=e.trim(o).toLowerCase(),!~e.inArray(o,a)&&!/^(proxy\-|sec\-)/.test(o)&&(N[o]?N[o]+=", "+r:N[o]=r,!0)},getAllResponseHeaders:function(){return P||""},getResponseHeader:function(t){return t=t.toLowerCase(),U||~e.inArray(t,["set-cookie","set-cookie2"])?null:P&&""!==P&&(C||(C={},e.each(P.split(/\r\n/),function(t){var n=t.split(/:\s+/);2===n.length&&(n[0]=e.trim(n[0]),C[n[0].toLowerCase()]={header:n[0],value:e.trim(n[1])})})),C.hasOwnProperty(t))?C[t].header+": "+C[t].value:null},overrideMimeType:function(i){var o,r;if(~e.inArray(n("readyState"),[h.LOADING,h.DONE]))throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(i=e.trim(i.toLowerCase()),/;/.test(i)&&(o=i.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(i=o[1],o[2]&&(r=o[2])),!u.mimes[i])throw new t.DOMException(t.DOMException.SYNTAX_ERR);B=i,L=r},send:function(n,o){if(j="string"===e.typeOf(o)?{ruid:o}:o?o:{},this.convertEventPropsToHandlers(m),this.upload.convertEventPropsToHandlers(m),this.readyState!==h.OPENED||I)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(n instanceof s)j.ruid=n.ruid,q=n.type||"application/octet-stream";else if(n instanceof d){if(n.hasBlob()){var r=n.getBlob();j.ruid=r.ruid,q=r.type||"application/octet-stream"}}else"string"==typeof n&&($="UTF-8",q="text/plain;charset=UTF-8",n=i.utf8_encode(n));this.withCredentials||(this.withCredentials=j.required_caps&&j.required_caps.send_browser_cookies&&!O),D=!A&&this.upload.hasEventListener(),U=!1,R=!n,A||(I=!0),l.call(this,n)},abort:function(){if(U=!0,A=!1,~e.inArray(n("readyState"),[h.UNSENT,h.OPENED,h.DONE]))n("readyState",h.UNSENT);else{if(n("readyState",h.DONE),I=!1,!k)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);k.getRuntime().exec.call(k,"XMLHttpRequest","abort",R),R=!0}},destroy:function(){k&&("function"===e.typeOf(k.destroy)&&k.destroy(),k=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var f={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};p.prototype=n.instance;var m=["loadstart","progress","abort","error","load","timeout","loadend"];return h.UNSENT=0,h.OPENED=1,h.HEADERS_RECEIVED=2,h.LOADING=3,h.DONE=4,h.prototype=n.instance,h}),i(S,[s,f,g,h],function(e,t,n,i){function o(){function i(){c=u=0,d=this.result=null}function r(t,n){var i=this;l=n,i.bind("TransportingProgress",function(t){u=t.loaded,c>u&&-1===e.inArray(i.state,[o.IDLE,o.DONE])&&a.call(i)},999),i.bind("TransportingComplete",function(){u=c,i.state=o.DONE,d=null,i.result=l.exec.call(i,"Transporter","getAsBlob",t||"")},999),i.state=o.BUSY,i.trigger("TransportingStarted"),a.call(i)}function a(){var e,n=this,i=c-u;p>i&&(p=i),e=t.btoa(d.substr(u,p)),l.exec.call(n,"Transporter","receive",e,c)}var s,l,d,c,u,p;n.call(this),e.extend(this,{uid:e.guid("uid_"),state:o.IDLE,result:null,transport:function(t,n,o){var a=this;if(o=e.extend({chunk_size:204798},o),(s=o.chunk_size%3)&&(o.chunk_size+=3-s),p=o.chunk_size,i.call(this),d=t,c=t.length,"string"===e.typeOf(o)||o.ruid)r.call(a,n,this.connectRuntime(o));else{var l=function(e,t){a.unbind("RuntimeInit",l),r.call(a,n,t)};this.bind("RuntimeInit",l),this.connectRuntime(o)}},abort:function(){var e=this;e.state=o.IDLE,l&&(l.exec.call(e,"Transporter","clear"),e.trigger("TransportingAborted")),i.call(e)},destroy:function(){this.unbindAll(),l=null,this.disconnectRuntime(),i.call(this)}})}return o.IDLE=0,o.BUSY=1,o.DONE=2,o.prototype=i.instance,o}),i(N,[s,u,p,C,T,m,g,S,c,h,b,v,f],function(e,t,n,i,o,r,a,s,l,d,c,u,p){function h(){function i(e){e||(e=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name)}function d(t){var i=e.typeOf(t);try{if(t instanceof h){if(!t.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);m.apply(this,arguments)}else if(t instanceof c){if(!~e.inArray(t.type,["image/jpeg","image/png"]))throw new n.ImageError(n.ImageError.WRONG_FORMAT);g.apply(this,arguments)}else if(-1!==e.inArray(i,["blob","file"]))d.call(this,new u(null,t),arguments[1]);else if("string"===i)/^data:[^;]*;base64,/.test(t)?d.call(this,new c(null,{data:t}),arguments[1]):b.apply(this,arguments);else{if("node"!==i||"img"!==t.nodeName.toLowerCase())throw new n.DOMException(n.DOMException.TYPE_MISMATCH_ERR);d.call(this,t.src,arguments[1])}}catch(o){this.trigger("error",o)}}function m(t,n){var i=this.connectRuntime(t.ruid);this.ruid=i.uid,i.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(n)||n)}function g(t,n){function i(e){o.ruid=e.uid,e.exec.call(o,"Image","loadFromBlob",t)}var o=this;o.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){i(t)}),n&&"string"==typeof n.required_caps&&(n.required_caps=r.parseCaps(n.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},n))):i(this.connectRuntime(t.ruid))}function b(e,t){var n,i=this;n=new o,n.open("get",e),n.responseType="blob",n.onprogress=function(e){i.trigger(e)},n.onload=function(){g.call(i,n.response,!0)},n.onerror=function(e){i.trigger(e)},n.onloadend=function(){n.destroy()},n.bind("RuntimeError",function(e,t){i.trigger("RuntimeError",t)}),n.send(null,t)}a.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){i.call(this)},999),this.convertEventPropsToHandlers(f),d.apply(this,arguments)},downsize:function(t,i,o,r){try{if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);(!t&&!i||"undefined"===e.typeOf(o))&&(o=!1),t=t||this.width,i=i||this.height,r="undefined"===e.typeOf(r)||!!r,this.getRuntime().exec.call(this,"Image","downsize",t,i,o,r)}catch(a){this.trigger("error",a)}},crop:function(e,t,n){this.downsize(e,t,!0,n)},getAsCanvas:function(){if(!l.can("create_canvas"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);var e=this.connectRuntime(this.ruid);return e.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return e||(e="image/jpeg"),"image/jpeg"!==e||t||(t=90),this.getRuntime().exec.call(this,"Image","getAsBlob",e,t)},getAsDataURL:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",e,t)},getAsBinaryString:function(e,t){var n=this.getAsDataURL(e,t);return p.atob(n.substring(n.indexOf("base64,")+7))},embed:function(i){function o(){if(l.can("create_canvas")){var t=r.getAsCanvas();if(t)return i.appendChild(t),t=null,r.destroy(),void f.trigger("embedded")}var o=r.getAsDataURL(a,d);if(!o)throw new n.ImageError(n.ImageError.WRONG_FORMAT);if(l.can("use_data_uri_of",o.length))i.innerHTML='<img src="'+o+'" width="'+r.width+'" height="'+r.height+'" />',r.destroy(),f.trigger("embedded");else{var c=new s;c.bind("TransportingComplete",function(){u=f.connectRuntime(this.result.ruid),f.bind("Embedded",function(){e.extend(u.getShimContainer().style,{top:"0px",left:"0px",width:r.width+"px",height:r.height+"px"}),u=null},999),u.exec.call(f,"ImageView","display",this.result.uid,g,b),r.destroy()}),c.transport(p.atob(o.substring(o.indexOf("base64,")+7)),a,e.extend({},m,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:i}))}}var r,a,d,c,u,f=this,m=arguments[1]||{},g=this.width,b=this.height;try{if(!(i=t.get(i)))throw new n.DOMException(n.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);if(a=m.type||this.type||"image/jpeg",d=m.quality||90,c="undefined"!==e.typeOf(m.crop)&&m.crop,m.width)g=m.width,b=m.height||g;else{var v=t.getSize(i);v.w&&v.h&&(g=v.w,b=v.h)}return r=new h,r.bind("Resize",function(){o.call(f)}),r.bind("Load",function(){r.downsize(g,b,c,!1)}),r.clone(this,!1),r}catch(y){this.trigger("error",y)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var f=["progress","load","error","resize","embedded"];return h.MAX_RESIZE_WIDTH=6500,h.MAX_RESIZE_HEIGHT=6500,h.prototype=d.instance,h}),i($,[s,p,m,c],function(e,t,n,i){function o(t){var o=this,s=n.capTest,l=n.capTrue,d=e.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return o.can("access_binary")&&!!a.Image},display_media:s(i.can("create_canvas")||i.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==i.browser||i.version>9)}()),filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),return_response_headers:l,return_response_type:function(e){return!("json"!==e||!window.JSON)||i.can("return_response_type",e)},return_status_code:l,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return o.can("access_binary")&&i.can("create_canvas")},select_file:function(){return i.can("use_fileinput")&&window.File},select_folder:function(){return o.can("select_file")&&"Chrome"===i.browser&&i.version>=21},select_multiple:function(){return!(!o.can("select_file")||"Safari"===i.browser&&"Windows"===i.os||"iOS"===i.os&&i.verComp(i.osVersion,"7.0.4","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||o.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return o.can("slice_blob")&&o.can("send_multipart")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||"IE"===i.browser&&i.version>=10||!!~e.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:l},arguments[2]);n.call(this,t,arguments[1]||r,d),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(o),e=o=null}}(this.destroy)}),e.extend(this.getShim(),a)}var r="html5",a={};return n.addConstructor(r,o),a}),i(q,[$,b],function(e,t){function n(){function e(e,t,n){var i;if(!window.File.prototype.slice)return(i=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?i.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(o){return e.slice(t,n-t)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))}}return e.Blob=n}),i(A,[s],function(e){function t(){this.returnValue=!1}function n(){this.cancelBubble=!0}var i={},o="moxie_"+e.guid(),r=function(r,a,s,l){var d,c;a=a.toLowerCase(),r.addEventListener?(d=s,r.addEventListener(a,d,!1)):r.attachEvent&&(d=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=t,e.stopPropagation=n,s(e)},r.attachEvent("on"+a,d)),r[o]||(r[o]=e.guid()),i.hasOwnProperty(r[o])||(i[r[o]]={}),c=i[r[o]],c.hasOwnProperty(a)||(c[a]=[]),c[a].push({func:d,orig:s,key:l})},a=function(t,n,r){var a,s;if(n=n.toLowerCase(),t[o]&&i[t[o]]&&i[t[o]][n]){a=i[t[o]][n];for(var l=a.length-1;l>=0&&(a[l].orig!==r&&a[l].key!==r||(t.removeEventListener?t.removeEventListener(n,a[l].func,!1):t.detachEvent&&t.detachEvent("on"+n,a[l].func),a[l].orig=null,a[l].func=null,a.splice(l,1),r===s));l--);if(a.length||delete i[t[o]][n],e.isEmptyObj(i[t[o]])){delete i[t[o]];try{delete t[o]}catch(d){t[o]=s}}}},s=function(t,n){t&&t[o]&&e.each(i[t[o]],function(e,i){a(t,i,n)})};return{addEvent:r,removeEvent:a,removeAllEvents:s}}),i(I,[$,s,u,A,d,c],function(e,t,n,i,o,r){function a(){var e,a=[];t.extend(this,{init:function(s){var l,d,c,u,p,h,f=this,m=f.getRuntime();e=s,a=[],c=e.accept.mimes||o.extList2mimes(e.accept,m.can("filter_by_extension")),d=m.getShimContainer(),d.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&m.can("select_multiple")?"multiple":"")+(e.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(c?' accept="'+c.join(",")+'"':"")+" />",l=n.get(m.uid),t.extend(l.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),u=n.get(e.browse_button),m.can("summon_file_dialog")&&("static"===n.getStyle(u,"position")&&(u.style.position="relative"),p=parseInt(n.getStyle(u,"z-index"),10)||1,u.style.zIndex=p,d.style.zIndex=p-1,i.addEvent(u,"click",function(e){var t=n.get(m.uid);t&&!t.disabled&&t.click(),e.preventDefault()},f.uid)),h=m.can("summon_file_dialog")?u:d,i.addEvent(h,"mouseover",function(){f.trigger("mouseenter")},f.uid),i.addEvent(h,"mouseout",function(){f.trigger("mouseleave")},f.uid),i.addEvent(h,"mousedown",function(){f.trigger("mousedown")},f.uid),i.addEvent(n.get(e.container),"mouseup",function(){f.trigger("mouseup")},f.uid),l.onchange=function g(){if(a=[],e.directory?t.each(this.files,function(e){"."!==e.name&&a.push(e)}):a=[].slice.call(this.files),"IE"!==r.browser)this.value="";else{var n=this.cloneNode(!0);this.parentNode.replaceChild(n,this),n.onchange=g}f.trigger("change")},f.trigger({type:"ready",async:!0}),d=null},getFiles:function(){return a},disable:function(e){var t,i=this.getRuntime();(t=n.get(i.uid))&&(t.disabled=!!e)},destroy:function(){var t=this.getRuntime(),o=t.getShim(),r=t.getShimContainer();i.removeAllEvents(r,this.uid),i.removeAllEvents(e&&n.get(e.container),this.uid),i.removeAllEvents(e&&n.get(e.browse_button),this.uid),r&&(r.innerHTML=""),o.removeInstance(this.uid),a=e=r=o=null}})}return e.FileInput=a}),i(D,[$,s,u,A,d],function(e,t,n,i,o){function r(){function e(e){for(var n=[],i=0;i<e.length;i++)[].push.apply(n,e[i].extensions.split(/\s*,\s*/));return-1===t.inArray("*",n)?n:[]}function r(e){var n=o.getFileExtension(e.name);return!n||!p.length||-1!==t.inArray(n,p)}function a(e,n){var i=[];t.each(e,function(e){var t=e.webkitGetAsEntry();if(t)if(t.isFile){var n=e.getAsFile();r(n)&&u.push(n)}else i.push(t)}),i.length?s(i,n):n()}function s(e,n){var i=[];t.each(e,function(e){i.push(function(t){l(e,t)})}),t.inSeries(i,function(){n()})}function l(e,t){e.isFile?e.file(function(e){r(e)&&u.push(e),t()},function(){t()}):e.isDirectory?d(e,t):t()}function d(e,t){function n(e){o.readEntries(function(t){t.length?([].push.apply(i,t),n(e)):e()},e)}var i=[],o=e.createReader();n(function(){s(i,t)})}var c,u=[],p=[];t.extend(this,{init:function(n){var o,s=this;c=n,p=e(c.accept),o=c.container,i.addEvent(o,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},s.uid),i.addEvent(o,"drop",function(e){e.preventDefault(),e.stopPropagation(),u=[],e.dataTransfer.items&&e.dataTransfer.items[0].webkitGetAsEntry?a(e.dataTransfer.items,function(){s.trigger("drop")}):(t.each(e.dataTransfer.files,function(e){r(e)&&u.push(e)}),s.trigger("drop"))},s.uid),i.addEvent(o,"dragenter",function(e){e.preventDefault(),e.stopPropagation(),s.trigger("dragenter")},s.uid),i.addEvent(o,"dragleave",function(e){e.preventDefault(),e.stopPropagation(),s.trigger("dragleave")},s.uid)},getFiles:function(){return u},destroy:function(){i.removeAllEvents(c&&n.get(c.container),this.uid),u=p=c=null}})}return e.FileDrop=r}),i(R,[$,f,s],function(e,t,n){function i(){function e(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var i,o=!1;n.extend(this,{read:function(e,t){var r=this;i=new window.FileReader,i.addEventListener("progress",function(e){r.trigger(e)}),i.addEventListener("load",function(e){r.trigger(e)}),i.addEventListener("error",function(e){r.trigger(e,i.error)}),i.addEventListener("loadend",function(){i=null}),"function"===n.typeOf(i[e])?(o=!1,i[e](t.getSource())):"readAsBinaryString"===e&&(o=!0,i.readAsDataURL(t.getSource()))},getResult:function(){return i&&i.result?o?e(i.result):i.result:null},abort:function(){i&&i.abort()},destroy:function(){i=null}})}return e.FileReader=i}),i(U,[$,s,d,k,v,b,E,p,c],function(e,t,n,i,o,r,a,s,l){function d(){function e(e,t){var n,i,o=this;n=t.getBlob().getSource(),i=new window.FileReader,i.onload=function(){t.append(t.getBlobName(),new r(null,{type:n.type,data:i.result})),f.send.call(o,e,t)},i.readAsBinaryString(n)}function d(){return!window.XMLHttpRequest||"IE"===l.browser&&l.version<8?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(n){}}():new window.XMLHttpRequest}function c(e){var t=e.responseXML,n=e.responseText;return"IE"===l.browser&&n&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(n)),t&&("IE"===l.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t}function u(e){var t="----moxieboundary"+(new Date).getTime(),n="--",i="\r\n",o="",a=this.getRuntime();if(!a.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return p.setRequestHeader("Content-Type","multipart/form-data; boundary="+t),e.each(function(e,a){o+=e instanceof r?n+t+i+'Content-Disposition: form-data; name="'+a+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+i+"Content-Type: "+(e.type||"application/octet-stream")+i+i+e.getSource()+i:n+t+i+'Content-Disposition: form-data; name="'+a+'"'+i+i+unescape(encodeURIComponent(e))+i}),o+=n+t+n+i}var p,h,f=this;t.extend(this,{send:function(n,o){var s=this,c="Mozilla"===l.browser&&l.version>=4&&l.version<7,f="Android Browser"===l.browser,m=!1;if(h=n.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),p=d(),p.open(n.method,n.url,n.async,n.user,n.password),o instanceof r)o.isDetached()&&(m=!0),o=o.getSource();else if(o instanceof a){if(o.hasBlob())if(o.getBlob().isDetached())o=u.call(s,o),m=!0;else if((c||f)&&"blob"===t.typeOf(o.getBlob().getSource())&&window.FileReader)return void e.call(s,n,o);if(o instanceof a){var g=new window.FormData;o.each(function(e,t){e instanceof r?g.append(t,e.getSource()):g.append(t,e)}),o=g}}p.upload?(n.withCredentials&&(p.withCredentials=!0),p.addEventListener("load",function(e){s.trigger(e)}),p.addEventListener("error",function(e){s.trigger(e)}),p.addEventListener("progress",function(e){s.trigger(e)}),p.upload.addEventListener("progress",function(e){s.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):p.onreadystatechange=function(){switch(p.readyState){case 1:break;case 2:break;case 3:var e,t;try{i.hasSameOrigin(n.url)&&(e=p.getResponseHeader("Content-Length")||0),p.responseText&&(t=p.responseText.length)}catch(o){e=t=0}s.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:p.onreadystatechange=function(){},0===p.status?s.trigger("error"):s.trigger("load")}},t.isEmptyObj(n.headers)||t.each(n.headers,function(e,t){p.setRequestHeader(t,e)}),""!==n.responseType&&"responseType"in p&&(p.responseType="json"!==n.responseType||l.can("return_response_type","json")?n.responseType:"text"),m?p.sendAsBinary?p.sendAsBinary(o):function(){for(var e=new Uint8Array(o.length),t=0;t<o.length;t++)e[t]=255&o.charCodeAt(t);p.send(e.buffer)}():p.send(o),s.trigger("loadstart")},getStatus:function(){try{if(p)return p.status}catch(e){}return 0},getResponse:function(e){var t=this.getRuntime();try{switch(e){case"blob":var i=new o(t.uid,p.response),r=p.getResponseHeader("Content-Disposition");if(r){var a=r.match(/filename=([\'\"'])([^\1]+)\1/);a&&(h=a[2])}return i.name=h,i.type||(i.type=n.getFileMime(h)),i;case"json":return l.can("return_response_type","json")?p.response:200===p.status&&window.JSON?JSON.parse(p.responseText):null;case"document":return c(p);default:return""!==p.responseText?p.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return p.getAllResponseHeaders()}catch(e){}return""},abort:function(){p&&p.abort()},destroy:function(){f=h=null}})}return e.XMLHttpRequest=d}),i(O,[],function(){return function(){function e(e,t){var n,i=r?0:-8*(t-1),a=0;for(n=0;t>n;n++)a|=o.charCodeAt(e+n)<<Math.abs(i+8*n);return a}function n(e,t,n){n=3===arguments.length?n:o.length-t-1,o=o.substr(0,t)+e+o.substr(n+t)}function i(e,t,i){var o,a="",s=r?0:-8*(i-1);for(o=0;i>o;o++)a+=String.fromCharCode(255&t>>Math.abs(s+8*o));n(a,e,i)}var o,r=!1;return{II:function(e){return e===t?r:void(r=e)},init:function(e){r=!1,o=e},SEGMENT:function(e,t,i){switch(arguments.length){case 1:return o.substr(e,o.length-e-1);case 2:return o.substr(e,t);case 3:n(i,e,t);break;default:return o}},BYTE:function(t){return e(t,1)},SHORT:function(t){return e(t,2)},LONG:function(n,o){return o===t?e(n,4):void i(n,o,4)},SLONG:function(t){var n=e(t,4);return n>2147483647?n-4294967296:n},STRING:function(t,n){var i="";for(n+=t;n>t;t++)i+=String.fromCharCode(e(t,1));return i}}}}),i(B,[O],function(e){
return function t(n){var i,o,r,a=[],s=0;if(i=new e,i.init(n),65496===i.SHORT(0)){for(o=2;o<=n.length;)if(r=i.SHORT(o),r>=65488&&65495>=r)o+=2;else{if(65498===r||65497===r)break;s=i.SHORT(o+2)+2,r>=65505&&65519>=r&&a.push({hex:r,name:"APP"+(15&r),start:o,length:s,segment:i.SEGMENT(o,s)}),o+=s}return i.init(null),{headers:a,restore:function(e){var t,n;for(i.init(e),o=65504==i.SHORT(2)?4+i.SHORT(4):2,n=0,t=a.length;t>n;n++)i.SEGMENT(o,0,a[n].segment),o+=a[n].length;return e=i.SEGMENT(),i.init(null),e},strip:function(e){var n,o,r;for(o=new t(e),n=o.headers,o.purge(),i.init(e),r=n.length;r--;)i.SEGMENT(n[r].start,n[r].length,"");return e=i.SEGMENT(),i.init(null),e},get:function(e){for(var t=[],n=0,i=a.length;i>n;n++)a[n].name===e.toUpperCase()&&t.push(a[n].segment);return t},set:function(e,t){var n,i,o,r=[];for("string"==typeof t?r.push(t):r=t,n=i=0,o=a.length;o>n&&(a[n].name===e.toUpperCase()&&(a[n].segment=r[i],a[n].length=r[i].length,i++),!(i>=r.length));n++);},purge:function(){a=[],i.init(null),i=null}}}}}),i(L,[s,O],function(e,n){return function i(){function i(e,n){var i,o,r,s,l,u,p,h,f=a.SHORT(e),m=[],g={};for(i=0;f>i;i++)if(p=u=e+12*i+2,r=n[a.SHORT(p)],r!==t){switch(s=a.SHORT(p+=2),l=a.LONG(p+=2),p+=4,m=[],s){case 1:case 7:for(l>4&&(p=a.LONG(p)+c.tiffHeader),o=0;l>o;o++)m[o]=a.BYTE(p+o);break;case 2:l>4&&(p=a.LONG(p)+c.tiffHeader),g[r]=a.STRING(p,l-1);continue;case 3:for(l>2&&(p=a.LONG(p)+c.tiffHeader),o=0;l>o;o++)m[o]=a.SHORT(p+2*o);break;case 4:for(l>1&&(p=a.LONG(p)+c.tiffHeader),o=0;l>o;o++)m[o]=a.LONG(p+4*o);break;case 5:for(p=a.LONG(p)+c.tiffHeader,o=0;l>o;o++)m[o]=a.LONG(p+4*o)/a.LONG(p+4*o+4);break;case 9:for(p=a.LONG(p)+c.tiffHeader,o=0;l>o;o++)m[o]=a.SLONG(p+4*o);break;case 10:for(p=a.LONG(p)+c.tiffHeader,o=0;l>o;o++)m[o]=a.SLONG(p+4*o)/a.SLONG(p+4*o+4);break;default:continue}h=1==l?m[0]:m,g[r]=d.hasOwnProperty(r)&&"object"!=typeof h?d[r][h]:h}return g}function o(){var e=c.tiffHeader;return a.II(18761==a.SHORT(e)),42===a.SHORT(e+=2)&&(c.IFD0=c.tiffHeader+a.LONG(e+=2),l=i(c.IFD0,s.tiff),"ExifIFDPointer"in l&&(c.exifIFD=c.tiffHeader+l.ExifIFDPointer,delete l.ExifIFDPointer),"GPSInfoIFDPointer"in l&&(c.gpsIFD=c.tiffHeader+l.GPSInfoIFDPointer,delete l.GPSInfoIFDPointer),!0)}function r(e,t,n){var i,o,r,l=0;if("string"==typeof t){var d=s[e.toLowerCase()];for(var u in d)if(d[u]===t){t=u;break}}i=c[e.toLowerCase()+"IFD"],o=a.SHORT(i);for(var p=0;o>p;p++)if(r=i+12*p+2,a.SHORT(r)==t){l=r+8;break}return!!l&&(a.LONG(l,n),!0)}var a,s,l,d,c={};return a=new n,s={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},d={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(e){return c={tiffHeader:10},!(e===t||!e.length)&&(a.init(e),65505===a.SHORT(0)&&"EXIF\0"===a.STRING(4,5).toUpperCase()&&o())},TIFF:function(){return l},EXIF:function(){var t;if(t=i(c.exifIFD,s.exif),t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var n=0,o="";n<t.ExifVersion.length;n++)o+=String.fromCharCode(t.ExifVersion[n]);t.ExifVersion=o}return t},GPS:function(){var t;return t=i(c.gpsIFD,s.gps),t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join(".")),t},setExif:function(e,t){return("PixelXDimension"===e||"PixelYDimension"===e)&&r("exif",e,t)},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null),a=l=null,c={}}}}}),i(j,[s,p,B,O,L],function(e,t,n,i,o){function r(r){function a(){for(var e,t,n=0;n<=l.length;){if(e=d.SHORT(n+=2),e>=65472&&65475>=e)return n+=5,{height:d.SHORT(n),width:d.SHORT(n+=2)};t=d.SHORT(n+=2),n+=t-2}return null}function s(){u&&c&&d&&(u.purge(),c.purge(),d.init(null),l=p=c=u=d=null)}var l,d,c,u,p,h;if(l=r,d=new i,d.init(l),65496!==d.SHORT(0))throw new t.ImageError(t.ImageError.WRONG_FORMAT);c=new n(r),u=new o,h=!!u.init(c.get("app1")[0]),p=a.call(this),e.extend(this,{type:"image/jpeg",size:l.length,width:p&&p.width||0,height:p&&p.height||0,setExif:function(t,n){return!!h&&("object"===e.typeOf(t)?e.each(t,function(e,t){u.setExif(t,e)}):u.setExif(t,n),void c.set("app1",u.getBinary()))},writeHeaders:function(){return arguments.length?c.restore(arguments[0]):l=c.restore(l)},stripHeaders:function(e){return c.strip(e)},purge:function(){s.call(this)}}),h&&(this.meta={tiff:u.TIFF(),exif:u.EXIF(),gps:u.GPS()})}return r}),i(P,[p,s,O],function(e,t,n){function i(i){function o(){var e,t;return e=a.call(this,8),"IHDR"==e.type?(t=e.start,{width:l.LONG(t),height:l.LONG(t+=4)}):null}function r(){l&&(l.init(null),s=u=d=c=l=null)}function a(e){var t,n,i,o;return t=l.LONG(e),n=l.STRING(e+=4,4),i=e+=4,o=l.LONG(e+t),{length:t,type:n,start:i,CRC:o}}var s,l,d,c,u;s=i,l=new n,l.init(s),function(){var t=0,n=0,i=[35152,20039,3338,6666];for(n=0;n<i.length;n++,t+=2)if(i[n]!=l.SHORT(t))throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),u=o.call(this),t.extend(this,{type:"image/png",size:s.length,width:u.width,height:u.height,purge:function(){r.call(this)}}),r.call(this)}return i}),i(H,[s,p,j,P],function(e,t,n,i){return function(o){var r,a=[n,i];r=function(){for(var e=0;e<a.length;e++)try{return new a[e](o)}catch(n){}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},stripHeaders:function(e){return e},purge:function(){}}),e.extend(this,r),this.purge=function(){r.purge(),r=null}}}),i(M,[],function(){function e(e,i,o){var r=e.naturalWidth,a=e.naturalHeight,s=o.width,l=o.height,d=o.x||0,c=o.y||0,u=i.getContext("2d");t(e)&&(r/=2,a/=2);var p=1024,h=document.createElement("canvas");h.width=h.height=p;for(var f=h.getContext("2d"),m=n(e,r,a),g=0;a>g;){for(var b=g+p>a?a-g:p,v=0;r>v;){var y=v+p>r?r-v:p;f.clearRect(0,0,p,p),f.drawImage(e,-v,-g);var x=v*s/r+d<<0,_=Math.ceil(y*s/r),w=g*l/a/m+c<<0,k=Math.ceil(b*l/a/m);u.drawImage(h,0,0,y,b,x,w,_,k),v+=p}g+=p}h=f=null}function t(e){var t=e.naturalWidth,n=e.naturalHeight;if(t*n>1048576){var i=document.createElement("canvas");i.width=i.height=1;var o=i.getContext("2d");return o.drawImage(e,-t+1,0),0===o.getImageData(0,0,1,1).data[3]}return!1}function n(e,t,n){var i=document.createElement("canvas");i.width=1,i.height=n;var o=i.getContext("2d");o.drawImage(e,0,0);for(var r=o.getImageData(0,0,1,n).data,a=0,s=n,l=n;l>a;){var d=r[4*(l-1)+3];0===d?s=l:a=l,l=s+a>>1}i=null;var c=l/n;return 0===c?1:c}return{isSubsampled:t,renderTo:e}}),i(z,[$,s,p,f,v,H,M,d,c],function(e,t,n,i,o,r,a,s,l){function d(){function e(){if(!y&&!b)throw new n.ImageError(n.DOMException.INVALID_STATE_ERR);return y||b}function d(e){return i.atob(e.substring(e.indexOf("base64,")+7))}function c(e,t){return"data:"+(t||"")+";base64,"+i.btoa(e)}function u(e){var t=this;b=new Image,b.onerror=function(){g.call(this),t.trigger("error",new n.ImageError(n.ImageError.WRONG_FORMAT))},b.onload=function(){t.trigger("load")},b.src=/^data:[^;]*;base64,/.test(e)?e:c(e,_.type)}function p(e,t){var i,o=this;return window.FileReader?(i=new FileReader,i.onload=function(){t(this.result)},i.onerror=function(){o.trigger("error",new n.FileException(n.FileException.NOT_READABLE_ERR))},void i.readAsDataURL(e)):t(e.getAsDataURL())}function h(n,i,o,r){var a,s,l,d,c,u,p=this,h=0,g=0;if(C=r,u=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==t.inArray(u,[5,6,7,8])){var b=n;n=i,i=b}return l=e(),s=o?Math.max:Math.min,a=s(n/l.width,i/l.height),a>1&&(!o||r)?void this.trigger("Resize"):(y||(y=document.createElement("canvas")),d=Math.round(l.width*a),c=Math.round(l.height*a),o?(y.width=n,y.height=i,d>n&&(h=Math.round((d-n)/2)),c>i&&(g=Math.round((c-i)/2))):(y.width=d,y.height=c),C||m(y.width,y.height,u),f.call(this,l,y,-h,-g,d,c),this.width=y.width,this.height=y.height,k=!0,void p.trigger("Resize"))}function f(e,t,n,i,o,r){if("iOS"===l.OS)a.renderTo(e,t,{width:o,height:r,x:n,y:i});else{var s=t.getContext("2d");s.drawImage(e,n,i,o,r)}}function m(e,t,n){switch(n){case 5:case 6:case 7:case 8:y.width=t,y.height=e;break;default:y.width=e,y.height=t}var i=y.getContext("2d");switch(n){case 2:i.translate(e,0),i.scale(-1,1);break;case 3:i.translate(e,t),i.rotate(Math.PI);break;case 4:i.translate(0,t),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-t);break;case 7:i.rotate(.5*Math.PI),i.translate(e,-t),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-e,0)}}function g(){v&&(v.purge(),v=null),x=b=y=_=null,k=!1}var b,v,y,x,_,w=this,k=!1,C=!0;t.extend(this,{loadFromBlob:function(e){var t=this,i=t.getRuntime(),o=!(arguments.length>1)||arguments[1];if(!i.can("access_binary"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);return _=e,e.isDetached()?(x=e.getSource(),void u.call(this,x)):void p.call(this,e.getSource(),function(e){o&&(x=d(e)),u.call(t,e)})},loadFromImage:function(e,t){this.meta=e.meta,_=new o(null,{name:e.name,size:e.size,type:e.type}),u.call(this,t?x=e.getAsBinaryString():e.getAsDataURL())},getInfo:function(){var t,n=this.getRuntime();return!v&&x&&n.can("access_image_binary")&&(v=new r(x)),t={width:e().width||0,height:e().height||0,type:_.type||s.getFileMime(_.name),size:x&&x.length||_.size||0,name:_.name||"",meta:v&&v.meta||this.meta||{}}},downsize:function(){h.apply(this,arguments)},getAsCanvas:function(){return y&&(y.id=this.uid+"_canvas"),y},getAsBlob:function(e,t){return e!==this.type&&h.call(this,this.width,this.height,!1),new o(null,{name:_.name||"",type:e,data:w.getAsBinaryString.call(this,e,t)})},getAsDataURL:function(e){var t=arguments[1]||90;if(!k)return b.src;if("image/jpeg"!==e)return y.toDataURL("image/png");try{return y.toDataURL("image/jpeg",t/100)}catch(n){return y.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!k)return x||(x=d(w.getAsDataURL(e,t))),x;if("image/jpeg"!==e)x=d(w.getAsDataURL(e,t));else{var n;t||(t=90);try{n=y.toDataURL("image/jpeg",t/100)}catch(i){n=y.toDataURL("image/jpeg")}x=d(n),v&&(x=v.stripHeaders(x),C&&(v.meta&&v.meta.exif&&v.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),x=v.writeHeaders(x)),v.purge(),v=null)}return k=!1,x},destroy:function(){w=null,g.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=d}),i(F,[s,c,u,p,m],function(e,t,n,i,o){function r(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function a(a){var d,c=this;a=e.extend({swf_url:t.swf_url},a),o.call(this,a,s,{access_binary:function(e){return e&&"browser"===c.mode},access_image_binary:function(e){return e&&"browser"===c.mode},display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===c.mode},resize_image:o.capTrue,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||(!e.arrayDiff(t,["","text","document"])||"browser"===c.mode)},return_status_code:function(t){return"browser"===c.mode||!e.arrayDiff(t,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:function(e){return e&&"browser"===c.mode},send_browser_cookies:function(e){return e&&"browser"===c.mode},send_custom_headers:function(e){return e&&"browser"===c.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:function(e){return e&&"browser"===c.mode},summon_file_dialog:!1,upload_filesize:function(t){return e.parseSizeStr(t)<=2097152||"client"===c.mode},use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function(e){return e?"browser":"client"},access_image_binary:function(e){return e?"browser":"client"},report_upload_progress:function(e){return e?"browser":"client"},return_response_type:function(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function(e){return e?"browser":"client"},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"browser":"client"},stream_upload:function(e){return e?"client":"browser"},upload_filesize:function(t){return e.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),r()<10&&(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid)},shimExec:function(e,t){var n=[].slice.call(arguments,2);return c.getShim().exec(this.uid,e,t,n)},init:function(){var n,o,r;r=this.getShimContainer(),e.extend(r.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),n='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+a.swf_url+'" ',"IE"===t.browser&&(n+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),n+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+t.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===t.browser?(o=document.createElement("div"),r.appendChild(o),o.outerHTML=n,o=r=null):r.innerHTML=n,d=setTimeout(function(){c&&!c.initialized&&c.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){e.call(c),clearTimeout(d),a=d=e=c=null}}(this.destroy)},l)}var s="flash",l={};return o.addConstructor(s,a),l}),i(W,[F,b],function(e,t){var n={slice:function(e,n,i,o){var r=this.getRuntime();return 0>n?n=Math.max(e.size+n,0):n>0&&(n=Math.min(n,e.size)),0>i?i=Math.max(e.size+i,0):i>0&&(i=Math.min(i,e.size)),e=r.shimExec.call(this,"Blob","slice",n,i,o||""),e&&(e=new t(r.uid,e)),e}};return e.Blob=n}),i(V,[F],function(e){var t={init:function(e){this.getRuntime().shimExec.call(this,"FileInput","init",{name:e.name,accept:e.accept,multiple:e.multiple}),this.trigger("ready")}};return e.FileInput=t}),i(X,[F,f],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i="",o={read:function(e,t){var o=this,r=o.getRuntime();return"readAsDataURL"===e&&(i="data:"+(t.type||"")+";base64,"),o.bind("Progress",function(t,o){o&&(i+=n(o,e))}),r.shimExec.call(this,"FileReader","readAsBase64",t.uid)},getResult:function(){return i},destroy:function(){i=null}};return e.FileReader=o}),i(G,[F,f],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i={read:function(e,t){var i,o=this.getRuntime();return(i=o.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid))?("readAsDataURL"===e&&(i="data:"+(t.type||"")+";base64,"+i),n(i,e,t.type)):null}};return e.FileReaderSync=i}),i(Y,[F,s,b,v,C,E,S],function(e,t,n,i,o,r,a){var s={send:function(e,i){function o(){e.transport=c.mode,c.shimExec.call(d,"XMLHttpRequest","send",e,i)}function s(e,t){c.shimExec.call(d,"XMLHttpRequest","appendBlob",e,t.uid),i=null,o()}function l(e,t){var n=new a;n.bind("TransportingComplete",function(){t(this.result)}),n.transport(e.getSource(),e.type,{ruid:c.uid})}var d=this,c=d.getRuntime();if(t.isEmptyObj(e.headers)||t.each(e.headers,function(e,t){c.shimExec.call(d,"XMLHttpRequest","setRequestHeader",t,e.toString())}),i instanceof r){var u;if(i.each(function(e,t){e instanceof n?u=t:c.shimExec.call(d,"XMLHttpRequest","append",t,e)}),i.hasBlob()){var p=i.getBlob();p.isDetached()?l(p,function(e){p.destroy(),s(u,e)}):s(u,p)}else i=null,o()}else i instanceof n?i.isDetached()?l(i,function(e){i.destroy(),i=e.uid,o()}):(i=i.uid,o()):o()},getResponse:function(e){var n,r,a=this.getRuntime();if(r=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(r=new i(a.uid,r),"blob"===e)return r;try{if(n=new o,~t.inArray(e,["","text"]))return n.readAsText(r);if("json"===e&&window.JSON)return JSON.parse(n.readAsText(r))}finally{r.destroy()}}return null},abort:function(e){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=s}),i(K,[F,b],function(e,t){var n={getAsBlob:function(e){var n=this.getRuntime(),i=n.shimExec.call(this,"Transporter","getAsBlob",e);return i?new t(n.uid,i):null}};return e.Transporter=n}),i(J,[F,s,S,b,C],function(e,t,n,i,o){var r={loadFromBlob:function(e){function t(e){o.shimExec.call(i,"Image","loadFromBlob",e.uid),i=o=null}var i=this,o=i.getRuntime();if(e.isDetached()){var r=new n;r.bind("TransportingComplete",function(){t(r.result.getSource())}),r.transport(e.getSource(),e.type,{ruid:o.uid})}else t(e.getSource())},loadFromImage:function(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getAsBlob:function(e,t){var n=this.getRuntime(),o=n.shimExec.call(this,"Image","getAsBlob",e,t);return o?new i(n.uid,o):null},getAsDataURL:function(){var e,t=this.getRuntime(),n=t.Image.getAsBlob.apply(this,arguments);return n?(e=new o,e.readAsDataURL(n)):null}};return e.Image=r}),i(Q,[s,c,u,p,m],function(e,t,n,i,o){function r(e){var t,n,i,o,r,a=!1,s=null,l=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(e)&&(a=!0),s=null}catch(d){var c=navigator.plugins["Silverlight Plug-In"];if(c){for(t=c.description,"1.0.30226.2"===t&&(t="2.0.30226.2"),n=t.split(".");n.length>3;)n.pop();for(;n.length<4;)n.push(0);for(i=e.split(".");i.length>4;)i.pop();do o=parseInt(i[l],10),r=parseInt(n[l],10),l++;while(l<i.length&&o===r);r>=o&&!isNaN(o)&&(a=!0)}}}catch(u){a=!1}return a}function a(a){var d,c=this;a=e.extend({xap_url:t.xap_url},a),o.call(this,a,s,{access_binary:o.capTrue,access_image_binary:o.capTrue,display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:o.capTrue,resize_image:o.capTrue,return_response_headers:function(e){return e&&"client"===c.mode},return_response_type:function(e){return"json"!==e||!!window.JSON},return_status_code:function(t){return"client"===c.mode||!e.arrayDiff(t,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:o.capTrue,send_browser_cookies:function(e){return e&&"browser"===c.mode},send_custom_headers:function(e){return e&&"client"===c.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:o.capTrue,use_http_method:function(t){return"client"===c.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function(e){return e?"client":"browser"},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"client":"browser"},use_http_method:function(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),r("2.0.31005.0")&&"Opera"!==t.browser||(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid).content.Moxie},shimExec:function(e,t){var n=[].slice.call(arguments,2);return c.getShim().exec(this.uid,e,t,n)},init:function(){var e;e=this.getShimContainer(),e.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+a.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+t.global_event_dispatcher+'"/></object>',d=setTimeout(function(){c&&!c.initialized&&c.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},"Windows"!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(c),clearTimeout(d),a=d=e=c=null}}(this.destroy)},l)}var s="silverlight",l={};return o.addConstructor(s,a),l}),i(Z,[Q,s,W],function(e,t,n){return e.Blob=t.extend({},n)}),i(ee,[Q],function(e){var t={init:function(e){function t(e){for(var t="",n=0;n<e.length;n++)t+=(""!==t?"|":"")+e[n].title+" | *."+e[n].extensions.replace(/,/g,";*.");return t}this.getRuntime().shimExec.call(this,"FileInput","init",t(e.accept),e.name,e.multiple),this.trigger("ready")}};return e.FileInput=t}),i(te,[Q,u,A],function(e,t,n){var i={init:function(){var e,i=this,o=i.getRuntime();return e=o.getShimContainer(),n.addEvent(e,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},i.uid),n.addEvent(e,"dragenter",function(e){e.preventDefault();var n=t.get(o.uid).dragEnter(e);n&&e.stopPropagation()},i.uid),n.addEvent(e,"drop",function(e){e.preventDefault();var n=t.get(o.uid).dragDrop(e);n&&e.stopPropagation()},i.uid),o.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=i}),i(ne,[Q,s,X],function(e,t,n){return e.FileReader=t.extend({},n)}),i(ie,[Q,s,G],function(e,t,n){return e.FileReaderSync=t.extend({},n)}),i(oe,[Q,s,Y],function(e,t,n){return e.XMLHttpRequest=t.extend({},n)}),i(re,[Q,s,K],function(e,t,n){return e.Transporter=t.extend({},n)}),i(ae,[Q,s,J],function(e,t,n){return e.Image=t.extend({},n,{getInfo:function(){var e=this.getRuntime(),n=["tiff","exif","gps"],i={meta:{}},o=e.shimExec.call(this,"Image","getInfo");return o.meta&&t.each(n,function(e){var t,n,r,a,s=o.meta[e];if(s&&s.keys)for(i.meta[e]={},n=0,r=s.keys.length;r>n;n++)t=s.keys[n],a=s[t],a&&(/^(\d|[1-9]\d+)$/.test(a)?a=parseInt(a,10):/^\d*\.\d+$/.test(a)&&(a=parseFloat(a)),i.meta[e][t]=a)}),i.width=parseInt(o.width,10),i.height=parseInt(o.height,10),i.size=parseInt(o.size,10),i.type=o.type,i.name=o.name,i}})}),i(se,[s,p,m,c],function(e,t,n,i){function o(t){var o=this,s=n.capTest,l=n.capTrue;n.call(this,t,r,{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s(a.Image&&(i.can("create_canvas")||i.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),resize_image:function(){return a.Image&&o.can("access_binary")&&i.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||!!~e.inArray(t,["text","document",""])},return_status_code:function(t){return!e.arrayDiff(t,[200,404])},select_file:function(){return i.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return o.can("select_file")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||!!~e.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:l,use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}}),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(o),e=o=null}}(this.destroy)}),e.extend(this.getShim(),a)}var r="html4",a={};return n.addConstructor(r,o),a}),i(le,[se,s,u,A,d,c],function(e,t,n,i,o,r){function a(){function e(){var o,c,u,p,h,f,m=this,g=m.getRuntime();f=t.guid("uid_"),o=g.getShimContainer(),a&&(u=n.get(a+"_form"),u&&t.extend(u.style,{top:"100%"})),p=document.createElement("form"),p.setAttribute("id",f+"_form"),p.setAttribute("method","post"),p.setAttribute("enctype","multipart/form-data"),p.setAttribute("encoding","multipart/form-data"),t.extend(p.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),h=document.createElement("input"),h.setAttribute("id",f),h.setAttribute("type","file"),h.setAttribute("name",s.name||"Filedata"),h.setAttribute("accept",d.join(",")),t.extend(h.style,{fontSize:"999px",opacity:0}),p.appendChild(h),o.appendChild(p),t.extend(h.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===r.browser&&r.version<10&&t.extend(h.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),h.onchange=function(){var t;this.value&&(t=this.files?this.files[0]:{name:this.value},l=[t],this.onchange=function(){},e.call(m),m.bind("change",function i(){var e,t=n.get(f),o=n.get(f+"_form");m.unbind("change",i),m.files.length&&t&&o&&(e=m.files[0],t.setAttribute("id",e.uid),o.setAttribute("id",e.uid+"_form"),o.setAttribute("target",e.uid+"_iframe")),t=o=null},998),h=p=null,m.trigger("change"))},g.can("summon_file_dialog")&&(c=n.get(s.browse_button),i.removeEvent(c,"click",m.uid),i.addEvent(c,"click",function(e){h&&!h.disabled&&h.click(),e.preventDefault()},m.uid)),a=f,o=u=c=null}var a,s,l=[],d=[];t.extend(this,{init:function(t){var r,a=this,l=a.getRuntime();s=t,d=t.accept.mimes||o.extList2mimes(t.accept,l.can("filter_by_extension")),r=l.getShimContainer(),function(){var e,o,s;e=n.get(t.browse_button),l.can("summon_file_dialog")&&("static"===n.getStyle(e,"position")&&(e.style.position="relative"),o=parseInt(n.getStyle(e,"z-index"),10)||1,e.style.zIndex=o,r.style.zIndex=o-1),s=l.can("summon_file_dialog")?e:r,i.addEvent(s,"mouseover",function(){a.trigger("mouseenter")},a.uid),i.addEvent(s,"mouseout",function(){a.trigger("mouseleave")},a.uid),i.addEvent(s,"mousedown",function(){a.trigger("mousedown")},a.uid),i.addEvent(n.get(t.container),"mouseup",function(){a.trigger("mouseup")},a.uid),e=null}(),e.call(this),r=null,a.trigger({type:"ready",async:!0})},getFiles:function(){return l},disable:function(e){var t;(t=n.get(a))&&(t.disabled=!!e)},destroy:function(){var e=this.getRuntime(),t=e.getShim(),o=e.getShimContainer();i.removeAllEvents(o,this.uid),i.removeAllEvents(s&&n.get(s.container),this.uid),i.removeAllEvents(s&&n.get(s.browse_button),this.uid),o&&(o.innerHTML=""),t.removeInstance(this.uid),a=l=d=s=o=t=null}})}return e.FileInput=a}),i(de,[se,R],function(e,t){return e.FileReader=t}),i(ce,[se,s,u,k,p,A,b,E],function(e,t,n,i,o,r,a,s){function l(){function e(e){var t,i,o,a,s=this,l=!1;if(c){if(t=c.id.replace(/_iframe$/,""),i=n.get(t+"_form")){for(o=i.getElementsByTagName("input"),a=o.length;a--;)switch(o[a].getAttribute("type")){case"hidden":o[a].parentNode.removeChild(o[a]);break;case"file":l=!0}o=[],l||i.parentNode.removeChild(i),i=null}setTimeout(function(){r.removeEvent(c,"load",s.uid),c.parentNode&&c.parentNode.removeChild(c);var t=s.getRuntime().getShimContainer();t.children.length||t.parentNode.removeChild(t),t=c=null,e()},1)}}var l,d,c;t.extend(this,{send:function(u,p){function h(){var n=y.getShimContainer()||document.body,o=document.createElement("div");o.innerHTML='<iframe id="'+f+'_iframe" name="'+f+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',c=o.firstChild,n.appendChild(c),r.addEvent(c,"load",function(){var n;try{n=c.contentWindow.document||c.contentDocument||window.frames[c.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(n.title)?l=n.title.replace(/^(\d+).*$/,"$1"):(l=200,d=t.trim(n.body.innerHTML),v.trigger({type:"progress",loaded:d.length,total:d.length}),b&&v.trigger({type:"uploadprogress",loaded:b.size||1025,total:b.size||1025}))}catch(o){if(!i.hasSameOrigin(u.url))return void e.call(v,function(){v.trigger("error")});l=404}e.call(v,function(){v.trigger("load")})},v.uid)}var f,m,g,b,v=this,y=v.getRuntime();if(l=d=null,p instanceof s&&p.hasBlob()){if(b=p.getBlob(),f=b.uid,g=n.get(f),m=n.get(f+"_form"),!m)throw new o.DOMException(o.DOMException.NOT_FOUND_ERR)}else f=t.guid("uid_"),m=document.createElement("form"),m.setAttribute("id",f+"_form"),m.setAttribute("method",u.method),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),m.setAttribute("target",f+"_iframe"),y.getShimContainer().appendChild(m);p instanceof s&&p.each(function(e,n){if(e instanceof a)g&&g.setAttribute("name",n);else{var i=document.createElement("input");t.extend(i,{type:"hidden",name:n,value:e}),g?m.insertBefore(i,g):m.appendChild(i)}}),m.setAttribute("action",u.url),h(),m.submit(),v.trigger("loadstart")},getStatus:function(){return l},getResponse:function(e){if("json"===e&&"string"===t.typeOf(d)&&window.JSON)try{return JSON.parse(d.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(n){return null}return d},abort:function(){var t=this;c&&c.contentWindow&&(c.contentWindow.stop?c.contentWindow.stop():c.contentWindow.document.execCommand?c.contentWindow.document.execCommand("Stop"):c.src="about:blank"),e.call(this,function(){t.dispatchEvent("abort")})}})}return e.XMLHttpRequest=l}),i(ue,[se,z],function(e,t){return e.Image=t}),r([s,l,d,c,u,p,h,f,m,g,b,v,y,x,_,w,k,C,E,T,S,N,A])}(this),function(){"use strict";var e={},t=moxie.core.utils.Basic.inArray;return function n(i){var o,r;for(o in i)r=typeof i[o],"object"!==r||~t(o,["Exceptions","Env","Mime"])?"function"===r&&(e[o]=i[o]):n(i[o])}(window.moxie),e.Env=window.moxie.core.utils.Env,e.Mime=window.moxie.core.utils.Mime,e.Exceptions=window.moxie.core.Exceptions,window.mOxie=e,window.o||(window.o=e),e}(),function(e,t,n){function i(e){function t(e,t,n){var o={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};o[e]?i[o[e]]=t:n||(i[e]=t)}var n=e.required_features,i={};return"string"==typeof n?a.each(n.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==typeof n?a.each(n,function(e,n){t(n,e)}):n===!0&&(e.multipart||(i.send_binary_string=!0),
e.chunk_size>0&&(i.slice_blob=!0),e.resize.enabled&&(i.send_binary_string=!0),a.each(e,function(e,n){t(n,!!e,!0)})),i}var o=e.setTimeout,r={},a={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,get:function(e){var n,i=[];"array"!==t.typeOf(e)&&(e=[e]);for(var o=e.length;o--;)n=t.get(e[o]),n&&i.push(n);return i.length?i:null},each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},n=/[<>&\"\']/g;return e?(""+e).replace(n,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,n;for(n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var n="";return a.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},formatSize:function(e){function t(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(e===n||/\D/.test(e))return a.translate("N/A");var i=Math.pow(1024,4);return e>i?t(e/i,1)+" "+a.translate("tb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("gb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("mb"):e>1024?Math.round(e/1024)+" "+a.translate("kb"):e+" "+a.translate("b")},parseSize:t.parseSizeStr,predictRuntime:function(e,n){var i,o;return i=new a.Uploader(e),o=t.Runtime.thatCan(i.getOption().required_features,n||e.runtimes),i.destroy(),o},addFileFilter:function(e,t){r[e]=t}};a.addFileFilter("mime_types",function(e,t,n){e.length&&!e.regexp.test(t.name)?(this.trigger("Error",{code:a.FILE_EXTENSION_ERROR,message:a.translate("File extension error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("max_file_size",function(e,t,n){var i;e=a.parseSize(e),t.size!==i&&e&&t.size>e?(this.trigger("Error",{code:a.FILE_SIZE_ERROR,message:a.translate("File size error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("prevent_duplicates",function(e,t,n){if(e)for(var i=this.files.length;i--;)if(t.name===this.files[i].name&&t.size===this.files[i].size)return this.trigger("Error",{code:a.FILE_DUPLICATE_ERROR,message:a.translate("Duplicate file error."),file:t}),void n(!1);n(!0)}),a.Uploader=function(e){function s(){var e,t,n=0;if(this.state==a.STARTED){for(t=0;t<q.length;t++)e||q[t].status!=a.QUEUED?n++:(e=q[t],this.trigger("BeforeUpload",e)&&(e.status=a.UPLOADING,this.trigger("UploadFile",e)));n==q.length&&(this.state!==a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",q))}}function l(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,d()}function d(){var e,t;for(S.reset(),e=0;e<q.length;e++)t=q[e],t.size!==n?(S.size+=t.origSize,S.loaded+=t.loaded*t.origSize/t.size):S.size=n,t.status==a.DONE?S.uploaded++:t.status==a.FAILED?S.failed++:S.queued++;S.size===n?S.percent=q.length>0?Math.ceil(S.uploaded/q.length*100):0:(S.bytesPerSec=Math.ceil(S.loaded/((+new Date-T||1)/1e3)),S.percent=S.size>0?Math.ceil(S.loaded/S.size*100):0)}function c(){var e=I[0]||D[0];return!!e&&e.getRuntime().uid}function u(e,n){if(e.ruid){var i=t.Runtime.getInfo(e.ruid);if(i)return i.can(n)}return!1}function p(){this.bind("FilesAdded",g),this.bind("CancelUpload",_),this.bind("BeforeUpload",b),this.bind("UploadFile",v),this.bind("UploadProgress",y),this.bind("StateChanged",x),this.bind("QueueChanged",d),this.bind("Error",k),this.bind("FileUploaded",w),this.bind("Destroy",C)}function h(e,n){var i=this,o=0,r=[],s={accept:e.filters.mime_types,runtime_order:e.runtimes,required_caps:e.required_features,preferred_caps:A,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url};a.each(e.runtimes.split(/\s*,\s*/),function(t){e[t]&&(s[t]=e[t])}),e.browse_button&&a.each(e.browse_button,function(n){r.push(function(r){var l=new t.FileInput(a.extend({},s,{name:e.file_data_name,multiple:e.multi_selection,container:e.container,browse_button:n}));l.onready=function(){var e=t.Runtime.getInfo(this.ruid);t.extend(i.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),o++,I.push(this),r()},l.onchange=function(){i.addFile(this.files)},l.bind("mouseenter mouseleave mousedown mouseup",function(i){R||(e.browse_button_hover&&("mouseenter"===i.type?t.addClass(n,e.browse_button_hover):"mouseleave"===i.type&&t.removeClass(n,e.browse_button_hover)),e.browse_button_active&&("mousedown"===i.type?t.addClass(n,e.browse_button_active):"mouseup"===i.type&&t.removeClass(n,e.browse_button_active)))}),l.bind("error runtimeerror",function(){l=null,r()}),l.init()})}),e.drop_element&&a.each(e.drop_element,function(e){r.push(function(n){var r=new t.FileDrop(a.extend({},s,{drop_zone:e}));r.onready=function(){var e=t.Runtime.getInfo(this.ruid);i.features.dragdrop=e.can("drag_and_drop"),o++,D.push(this),n()},r.ondrop=function(){i.addFile(this.files)},r.bind("error runtimeerror",function(){r=null,n()}),r.init()})}),t.inSeries(r,function(){"function"==typeof n&&n(o)})}function f(e,n,i){var o=new t.Image;try{o.onload=function(){o.downsize(n.width,n.height,n.crop,n.preserve_headers)},o.onresize=function(){i(this.getAsBlob(e.type,n.quality)),this.destroy()},o.onerror=function(){i(e)},o.load(e)}catch(r){i(e)}}function m(e,n,o){function r(e,t,n){var i=E[e];switch(e){case"max_file_size":"max_file_size"===e&&(E.max_file_size=E.filters.max_file_size=t);break;case"chunk_size":(t=a.parseSize(t))&&(E[e]=t);break;case"filters":"array"===a.typeOf(t)&&(t={mime_types:t}),n?a.extend(E.filters,t):E.filters=t,t.mime_types&&(E.filters.mime_types.regexp=function(e){var t=[];return a.each(e,function(e){a.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}(E.filters.mime_types));break;case"resize":n?a.extend(E.resize,t,{enabled:!0}):E.resize=t;break;case"prevent_duplicates":E.prevent_duplicates=E.filters.prevent_duplicates=!!t;break;case"browse_button":case"drop_element":t=a.get(t);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":E[e]=t,n||(l=!0);break;default:E[e]=t}n||s.trigger("OptionChanged",e,t,i)}var s=this,l=!1;"object"==typeof e?a.each(e,function(e,t){r(t,e,o)}):r(e,n,o),o?(E.required_features=i(a.extend({},E)),A=i(a.extend({},E,{required_features:!0}))):l&&(s.trigger("Destroy"),h.call(s,E,function(e){e?(s.runtime=t.Runtime.getInfo(c()).type,s.trigger("Init",{runtime:s.runtime}),s.trigger("PostInit")):s.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}))}function g(e,t){[].push.apply(q,t),e.trigger("QueueChanged"),e.refresh()}function b(e,t){if(E.unique_names){var n=t.name.match(/\.([^.]+)$/),i="part";n&&(i=n[1]),t.target_name=t.id+"."+i}}function v(e,n){function i(){c-- >0?o(r,1e3):(n.loaded=h,e.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:n,response:N.responseText,status:N.status,responseHeaders:N.getAllResponseHeaders()}))}function r(){var u,f,m,g;n.status!=a.DONE&&n.status!=a.FAILED&&e.state!=a.STOPPED&&(m={name:n.target_name||n.name},d&&p.chunks&&s.size>d?(g=Math.min(d,s.size-h),u=s.slice(h,h+g)):(g=s.size,u=s),d&&p.chunks&&(e.settings.send_chunk_number?(m.chunk=Math.ceil(h/d),m.chunks=Math.ceil(s.size/d)):(m.offset=h,m.total=s.size)),N=new t.XMLHttpRequest,N.upload&&(N.upload.onprogress=function(t){n.loaded=Math.min(n.size,h+t.loaded),e.trigger("UploadProgress",n)}),N.onload=function(){return N.status>=400?void i():(c=e.settings.max_retries,g<s.size?(u.destroy(),h+=g,n.loaded=Math.min(h,s.size),e.trigger("ChunkUploaded",n,{offset:n.loaded,total:s.size,response:N.responseText,status:N.status,responseHeaders:N.getAllResponseHeaders()}),"Android Browser"===t.Env.browser&&e.trigger("UploadProgress",n)):n.loaded=n.size,u=f=null,!h||h>=s.size?(n.size!=n.origSize&&(s.destroy(),s=null),e.trigger("UploadProgress",n),n.status=a.DONE,e.trigger("FileUploaded",n,{response:N.responseText,status:N.status,responseHeaders:N.getAllResponseHeaders()})):o(r,1),void 0)},N.onerror=function(){i()},N.onloadend=function(){this.destroy(),N=null},e.settings.multipart&&p.multipart?(m.name=n.target_name||n.name,N.open("post",l,!0),a.each(e.settings.headers,function(e,t){N.setRequestHeader(t,e)}),f=new t.FormData,a.each(a.extend(m,e.settings.multipart_params),function(e,t){f.append(t,e)}),f.append(e.settings.file_data_name,u),N.send(f,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:A,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})):(l=a.buildUrl(e.settings.url,a.extend(m,e.settings.multipart_params)),N.open("post",l,!0),N.setRequestHeader("Content-Type","application/octet-stream"),a.each(e.settings.headers,function(e,t){N.setRequestHeader(t,e)}),N.send(u,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:A,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})))}var s,l=e.settings.url,d=e.settings.chunk_size,c=e.settings.max_retries,p=e.features,h=0;n.loaded&&(h=n.loaded=d*Math.floor(n.loaded/d)),s=n.getSource(),e.settings.resize.enabled&&u(s,"send_binary_string")&&~t.inArray(s.type,["image/jpeg","image/png"])?f.call(this,s,e.settings.resize,function(e){s=e,n.size=e.size,r()}):r()}function y(e,t){l(t)}function x(e){if(e.state==a.STARTED)T=+new Date;else if(e.state==a.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==a.UPLOADING&&(e.files[t].status=a.QUEUED,d())}function _(){N&&N.abort()}function w(e){d(),o(function(){s.call(e)},1)}function k(e,t){t.file&&(t.file.status=a.FAILED,l(t.file),e.state==a.STARTED&&(e.trigger("CancelUpload"),o(function(){s.call(e)},1)))}function C(e){e.stop(),a.each(q,function(e){e.destroy()}),q=[],I.length&&(a.each(I,function(e){e.destroy()}),I=[]),D.length&&(a.each(D,function(e){e.destroy()}),D=[]),A={},R=!1,T=N=null,S.reset()}var E,T,S,N,$=a.guid(),q=[],A={},I=[],D=[],R=!1;E={runtimes:t.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_chunk_number:!0},m.call(this,e,null,!0),S=new a.QueueProgress,a.extend(this,{id:$,uid:$,state:a.STOPPED,features:{},runtime:null,files:q,settings:E,total:S,init:function(){var e=this;return"function"==typeof E.preinit?E.preinit(e):a.each(E.preinit,function(t,n){e.bind(n,t)}),E.browse_button&&E.url?(p.call(this),void h.call(this,E,function(n){"function"==typeof E.init?E.init(e):a.each(E.init,function(t,n){e.bind(n,t)}),n?(e.runtime=t.Runtime.getInfo(c()).type,e.trigger("Init",{runtime:e.runtime}),e.trigger("PostInit")):e.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})})):void this.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})},setOption:function(e,t){m.call(this,e,t,!this.runtime)},getOption:function(e){return e?E[e]:E},refresh:function(){I.length&&a.each(I,function(e){e.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=a.STARTED&&(this.state=a.STARTED,this.trigger("StateChanged"),s.call(this))},stop:function(){this.state!=a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){R=arguments[0]===n||arguments[0],I.length&&a.each(I,function(e){e.disable(R)}),this.trigger("DisableBrowse",R)},getFile:function(e){var t;for(t=q.length-1;t>=0;t--)if(q[t].id===e)return q[t]},addFile:function(e,n){function i(e,n){var i=[];t.each(d.settings.filters,function(t,n){r[n]&&i.push(function(i){r[n].call(d,t,e,function(e){i(!e)})})}),t.inSeries(i,n)}function s(e){var r=t.typeOf(e);if(e instanceof t.File){if(!e.ruid&&!e.isDetached()){if(!l)return!1;e.ruid=l,e.connectRuntime(l)}s(new a.File(e))}else e instanceof t.Blob?(s(e.getSource()),e.destroy()):e instanceof a.File?(n&&(e.name=n),u.push(function(t){i(e,function(n){n||(p.push(e),d.trigger("FileFiltered",e)),o(t,1)})})):t.inArray(r,["file","blob"])!==-1?s(new t.File(null,e)):"node"===r&&"filelist"===t.typeOf(e.files)?t.each(e.files,s):"array"===r&&(n=null,t.each(e,s))}var l,d=this,u=[],p=[];l=c(),s(e),u.length&&t.inSeries(u,function(){p.length&&d.trigger("FilesAdded",p)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,n=q.length-1;n>=0;n--)if(q[n].id===t)return this.splice(n,1)[0]},splice:function(e,t){var i=q.splice(e===n?0:e,t===n?q.length:t),o=!1;return this.state==a.STARTED&&(o=!0,this.stop()),this.trigger("FilesRemoved",i),a.each(i,function(e){e.destroy()}),this.trigger("QueueChanged"),this.refresh(),o&&this.start(),i},bind:function(e,t,n){var i=this;a.Uploader.prototype.bind.call(this,e,function(){var e=[].slice.call(arguments);return e.splice(0,1,i),t.apply(this,e)},0,n)},destroy:function(){this.trigger("Destroy"),E=S=null,this.unbindAll()}})},a.Uploader.prototype=t.EventTarget.instance,a.File=function(){function e(e){a.extend(this,{id:a.guid(),name:e.name||e.fileName,type:e.type||"",size:e.size||e.fileSize,origSize:e.size||e.fileSize,loaded:0,percent:0,status:a.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var e=this.getSource().getSource();return t.inArray(t.typeOf(e),["blob","file"])!==-1?e:null},getSource:function(){return n[this.id]?n[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete n[this.id])}}),n[this.id]=e}var n={};return e}(),a.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=a}(window,mOxie),define("plupload",function(){}),!function(global){function createCookie(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="; expires="+i.toGMTString();document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t=e+"=",n=document.cookie.split(";"),i=0,o=n.length;i<o;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function QiniuJsSDK(){function log(e,t){for(var n="[qiniu-js-sdk]["+e+"]",i=n,o=0;o<t.length;o++)i+="string"==typeof t[o]?" "+t[o]:" "+that.stringifyJSON(t[o]);that.detectIEVersion()?console.log(i):(t.unshift(n),console.log.apply(console,t)),document.getElementById("qiniu-js-sdk-log")&&(document.getElementById("qiniu-js-sdk-log").innerHTML+="<p>"+i+"</p>")}function makeLogFunc(e){var t=e.toLowerCase();logger[t]=function(){if(window.console&&window.console.log&&logger.level>=logger[e]){var n=Array.prototype.slice.call(arguments);log(t,n)}}}var that=this;this.detectIEVersion=function(){for(var e=4,t=document.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+e+"]><i></i><![endif]-->",n[0];)e++;return e>4&&e};var logger={MUTE:0,FATA:1,ERROR:2,WARN:3,INFO:4,DEBUG:5,TRACE:6,level:0};for(var property in logger)logger.hasOwnProperty(property)&&"number"==typeof logger[property]&&!logger.hasOwnProperty(property.toLowerCase())&&makeLogFunc(property);var qiniuUploadUrl;qiniuUploadUrl="https:"===window.location.protocol?"https://up.qbox.me":"http://upload.qiniu.com";var qiniuUploadUrls=["http://upload.qiniu.com","http://up.qiniu.com"],qiniuUpHosts={http:["http://upload.qiniu.com","http://up.qiniu.com"],https:["https://up.qbox.me"]},changeUrlTimes=0;this.resetUploadUrl=function(){var e="https:"===window.location.protocol?qiniuUpHosts.https:qiniuUpHosts.http,t=changeUrlTimes%e.length;qiniuUploadUrl=e[t],changeUrlTimes++,logger.debug("resetUploadUrl: "+qiniuUploadUrl)},this.isImage=function(e){return e=e.split(/[?#]/)[0],/\.(png|jpg|jpeg|gif|bmp)$/i.test(e)},this.getFileExtension=function(e){var t,n=e.split(".");return t=1===n.length||""===n[0]&&2===n.length?"":n.pop().toLowerCase()},this.utf8_encode=function(e){if(null===e||"undefined"==typeof e)return"";var t,n,i=e+"",o="",r=0;t=n=0,r=i.length;for(var a=0;a<r;a++){var s=i.charCodeAt(a),l=null;if(s<128)n++;else if(s>127&&s<2048)l=String.fromCharCode(s>>6|192,63&s|128);else if(63488&s^!0)l=String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128);else{if(64512&s^!0)throw new RangeError("Unmatched trail surrogate at "+a);var d=i.charCodeAt(++a);if(64512&d^!0)throw new RangeError("Unmatched lead surrogate at "+(a-1));s=((1023&s)<<10)+(1023&d)+65536,l=String.fromCharCode(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}null!==l&&(n>t&&(o+=i.slice(t,n)),o+=l,t=n=a+1)}return n>t&&(o+=i.slice(t,r)),o},this.base64_decode=function(e){var t,n,i,o,r,a,s,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,u=0,p="",h=[];if(!e)return e;e+="";do o=d.indexOf(e.charAt(c++)),r=d.indexOf(e.charAt(c++)),a=d.indexOf(e.charAt(c++)),s=d.indexOf(e.charAt(c++)),l=o<<18|r<<12|a<<6|s,t=l>>16&255,n=l>>8&255,i=255&l,64===a?h[u++]=String.fromCharCode(t):64===s?h[u++]=String.fromCharCode(t,n):h[u++]=String.fromCharCode(t,n,i);while(c<e.length);return p=h.join("")},this.base64_encode=function(e){var t,n,i,o,r,a,s,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,u=0,p="",h=[];if(!e)return e;e=this.utf8_encode(e+"");do t=e.charCodeAt(c++),n=e.charCodeAt(c++),i=e.charCodeAt(c++),l=t<<16|n<<8|i,o=l>>18&63,r=l>>12&63,a=l>>6&63,s=63&l,h[u++]=d.charAt(o)+d.charAt(r)+d.charAt(a)+d.charAt(s);while(c<e.length);switch(p=h.join(""),e.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p},this.URLSafeBase64Encode=function(e){return e=this.base64_encode(e),e.replace(/\//g,"_").replace(/\+/g,"-")},this.URLSafeBase64Decode=function(e){return e=e.replace(/_/g,"/").replace(/-/g,"+"),this.base64_decode(e)},this.createAjax=function(e){var t={};return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);var rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,text=String(data);return rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),eval("("+text+")")},this.stringifyJSON=function(e){if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(e);switch(typeof e){case"string":return'"'+e.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+e.map(that.stringifyJSON).join(",")+"]";case"object":if(e instanceof Array){for(var t=[],n=e.length,i=0;i<n;i++)t.push(that.stringifyJSON(e[i]));return"["+t.join(",")+"]"}if(null===e)return"null";var o=[];for(var r in e)e.hasOwnProperty(r)&&o.push(that.stringifyJSON(r)+":"+that.stringifyJSON(e[r]));return"{"+o.join(",")+"}";case"number":return e;case!1:return e;case"boolean":return e}},this.trim=function(e){return null===e?"":e.replace(/^\s+|\s+$/g,"")},this.uploader=function(e){var t=function(){var t,n,i,o=that.detectIEVersion(),r="Safari"===mOxie.Env.browser&&mOxie.Env.version<=5&&"Windows"===mOxie.Env.os&&"7"===mOxie.Env.osVersion||"Safari"===mOxie.Env.browser&&"iOS"===mOxie.Env.os&&"7"===mOxie.Env.osVersion;o&&o<9&&e.chunk_size&&e.runtimes.indexOf("flash")>=0?e.chunk_size=0:r?e.chunk_size=0:(t=20,n=4<<t,i=plupload.parseSize(e.chunk_size),i>n&&(e.chunk_size=n))},n=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];0===i.indexOf("-H")?t.push(i.split(" ")[2]):t.push(i)}return t},i=function(e){var t=e.split(":"),n=t[0],i=that.parseJSON(that.URLSafeBase64Decode(t[2]));return i.ak=n,i.scope.indexOf(":")>=0?(i.bucket=i.scope.split(":")[0],i.key=i.scope.split(":")[1]):i.bucket=i.scope,i},o=function(t){var o=i(t),r=window.location.protocol+"//uc.qbox.me/v1/query?ak="+o.ak+"&bucket="+o.bucket;logger.debug("putPolicy: ",o),logger.debug("get uphosts from: ",r);var a,s=that.detectIEVersion();s&&s<=9?(a=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=e.flash_swf_url):a=that.createAjax(),a.open("GET",r,!0);var l=function(){if(logger.debug("ajax.readyState: ",a.readyState),4===a.readyState)if(logger.debug("ajax.status: ",a.status),a.status<400){var e=that.parseJSON(a.responseText);qiniuUpHosts.http=n(e.http.up),qiniuUpHosts.https=n(e.https.up),logger.debug("get new uphosts: ",qiniuUpHosts),that.resetUploadUrl()}else logger.error("get uphosts error: ",a.responseText)};s&&s<=9?a.bind("readystatechange",l):a.onreadystatechange=l,a.send()},r=function(t){return!that.token||e.uptoken_url&&that.tokenInfo.isExpired()?a(t):that.token},a=function(t){if(e.uptoken)that.token=e.uptoken;else if(e.uptoken_url){logger.debug("get uptoken from: ",that.uptoken_url);var n=that.createAjax();if(n.open("GET",that.uptoken_url,!1),n.setRequestHeader("If-Modified-Since","0"),n.send(),200===n.status){var i=that.parseJSON(n.responseText);that.token=i.uptoken;var r=that.token.split(":"),a=that.parseJSON(that.URLSafeBase64Decode(r[2]));that.tokenMap||(that.tokenMap={});var s=function(e){return Math.ceil(e.getTime()/1e3)},l=s(new Date(n.getResponseHeader("date"))),d=s(new Date);that.tokenInfo={serverDelay:d-l,deadline:a.deadline,isExpired:function(){var e=this.deadline-s(new Date)+this.serverDelay;return e<600}},logger.debug("get new uptoken: ",that.token),logger.debug("get token info: ",that.tokenInfo)}else logger.error("get uptoken error: ",n.responseText)}else e.uptoken_func?(logger.debug("get uptoken from uptoken_func"),that.token=e.uptoken_func(t),logger.debug("get new uptoken: ",that.token)):logger.error("one of [uptoken, uptoken_url, uptoken_func] settings in options is required!");return that.token&&o(that.token),that.token},s=function(t,n,i){var o="",r=!1;if(!e.save_key)if(r=t.getOption&&t.getOption("unique_names"),r=r||t.settings&&t.settings.unique_names){var a=that.getFileExtension(n.name);o=a?n.id+"."+a:n.id}else o="function"==typeof i?i(t,n):n.name;return o};if(e.log_level&&(logger.level=e.log_level),!e.domain)throw"domain setting in options is required!";if(!e.browse_button)throw"browse_button setting in options is required!";if(!e.uptoken&&!e.uptoken_url&&!e.uptoken_func)throw"one of [uptoken, uptoken_url, uptoken_func] settings in options is required!";logger.debug("init uploader start"),logger.debug("environment: ",mOxie.Env),logger.debug("userAgent: ",navigator.userAgent);var l={},d=e.init&&e.init.Error,c=e.init&&e.init.FileUploaded;e.init.Error=function(){},e.init.FileUploaded=function(){},that.uptoken_url=e.uptoken_url,that.token="",that.key_handler="function"==typeof e.init.Key?e.init.Key:"",this.domain=e.domain;var u="",p={isResumeUpload:!1,resumeFilesize:0,startTime:"",currentTime:""};t(),logger.debug("invoke reset_chunk_size()"),logger.debug("op.chunk_size: ",e.chunk_size);var h={url:qiniuUploadUrl,multipart_params:{token:""}},f=that.detectIEVersion();f&&f<=9&&(h.multipart_params.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),plupload.extend(l,e,h),logger.debug("option: ",l);var m=new plupload.Uploader(l);logger.debug("new plupload.Uploader(option)"),m.bind("Init",function(t,n){logger.debug("Init event activated"),e.get_new_uptoken||a(null)}),logger.debug("bind Init event"),m.bind("FilesAdded",function(e,t){logger.debug("FilesAdded event activated");var n=e.getOption&&e.getOption("auto_start");n=n||e.settings&&e.settings.auto_start,logger.debug("auto_start: ",n),logger.debug("files: ",t);var i=function(){return"ios"===mOxie.Env.OS.toLowerCase()};if(i())for(var o=0;o<t.length;o++){var r=t[o],a=that.getFileExtension(r.name);r.name=r.id+"."+a}n&&setTimeout(function(){e.start(),logger.debug("invoke up.start()")},0),e.refresh()}),logger.debug("bind FilesAdded event"),m.bind("BeforeUpload",function(t,n){logger.debug("BeforeUpload event activated"),n.speed=n.speed||0,u="",e.get_new_uptoken&&a(n);var i=function(t,n,i){p.startTime=(new Date).getTime();var r;r=e.save_key?{token:that.token}:{key:s(t,n,i),token:that.token};var a=that.detectIEVersion();a&&a<=9&&(r.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),logger.debug("directUpload multipart_params_obj: ",r);var l=e.x_vars;if(void 0!==l&&"object"==typeof l)for(var d in l)l.hasOwnProperty(d)&&("function"==typeof l[d]?r["x:"+d]=l[d](t,n):"object"!=typeof l[d]&&(r["x:"+d]=l[d]));t.setOption({url:qiniuUploadUrl,multipart:!0,chunk_size:o()?e.max_file_size:void 0,multipart_params:r})},o=function(){var e=navigator.userAgent.toLowerCase();return!(!e.match(/MicroMessenger/i)&&"QQBrowser"!==mOxie.Env.browser&&!e.match(/V1_AND_SQ/i)||"android"!==mOxie.Env.OS.toLowerCase())},l=t.getOption&&t.getOption("chunk_size");if(l=l||t.settings&&t.settings.chunk_size,logger.debug("uploader.runtime: ",m.runtime),logger.debug("chunk_size: ",l),"html5"!==m.runtime&&"flash"!==m.runtime||!l)logger.debug("directUpload because uploader.runtime !== 'html5' || uploader.runtime !== 'flash' || !chunk_size"),i(t,n,that.key_handler);else if(n.size<l||o())logger.debug("directUpload because file.size < chunk_size || is_android_weixin_or_qq()"),i(t,n,that.key_handler);else{var d=localStorage.getItem(n.name),c=l;if(d){d=that.parseJSON(d);var h=(new Date).getTime(),f=d.time||0,g=864e5;h-f<g&&100!==d.percent&&n.size===d.total?(n.percent=d.percent,n.loaded=d.offset,u=d.ctx,p.isResumeUpload=!0,p.resumeFilesize=d.offset,d.offset+c>n.size&&(c=n.size-d.offset)):localStorage.removeItem(n.name)}p.startTime=(new Date).getTime();var b={},v=that.detectIEVersion();v&&v<=9&&(b.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),t.setOption({url:qiniuUploadUrl+"/mkblk/"+c,multipart:!1,chunk_size:l,required_features:"chunks",headers:{Authorization:"UpToken "+r(n)},multipart_params:b})}}),logger.debug("bind BeforeUpload event"),m.bind("UploadProgress",function(e,t){logger.trace("UploadProgress event activated"),p.currentTime=(new Date).getTime();var n=p.currentTime-p.startTime,i=t.loaded||0;p.isResumeUpload&&(i=t.loaded-p.resumeFilesize),t.speed=(i/n*1e3).toFixed(0)||0}),logger.debug("bind UploadProgress event"),m.bind("ChunkUploaded",function(e,t,n){logger.debug("ChunkUploaded event activated"),logger.debug("file: ",t),logger.debug("info: ",n);var i=that.parseJSON(n.response);logger.debug("res: ",i),u=u?u+","+i.ctx:i.ctx;var o=n.total-n.offset,a=e.getOption&&e.getOption("chunk_size");a=a||e.settings&&e.settings.chunk_size,o<a&&(e.setOption({url:qiniuUploadUrl+"/mkblk/"+o}),logger.debug("up.setOption url: ",qiniuUploadUrl+"/mkblk/"+o)),e.setOption({headers:{Authorization:"UpToken "+r(t)}}),localStorage.setItem(t.name,that.stringifyJSON({ctx:u,percent:t.percent,total:n.total,offset:n.offset,time:(new Date).getTime()}))}),logger.debug("bind ChunkUploaded event");var g=qiniuUploadUrls.length,b=function(e){return g-- >0?(setTimeout(function(){that.resetUploadUrl(),e.status=plupload.QUEUED,m.stop(),m.start()},0),!0):(g=qiniuUploadUrls.length,!1)};return m.bind("Error",function(e){return function(t,n){logger.error("Error event activated"),logger.error("err: ",n);var i="",o=n.file;if(o){switch(n.code){case plupload.FAILED:i="上传失败。请稍后再试。";break;case plupload.FILE_SIZE_ERROR:var r=t.getOption&&t.getOption("max_file_size");r=r||t.settings&&t.settings.max_file_size,i="浏览器最大可上传"+r+"。更大文件请使用命令行工具。";break;case plupload.FILE_EXTENSION_ERROR:i="文件验证失败。请稍后重试。";break;case plupload.HTTP_ERROR:if(""===n.response){if(i=n.message||"未知网络错误。",!b(o))return;break}var a=that.parseJSON(n.response),s=a.error;switch(n.status){case 400:i="请求报文格式错误。";break;case 401:i="客户端认证授权失败。请重试或提交反馈。";break;case 405:i="客户端请求错误。请重试或提交反馈。";break;case 579:i="资源上传成功，但回调失败。";break;case 599:if(i="网络连接异常。请重试或提交反馈。",!b(o))return;break;case 614:i="文件已存在。";try{a=that.parseJSON(a.error),s=a.error||"file exists"}catch(l){s=a.error||"file exists"}break;case 631:i="指定空间不存在。";break;case 701:i="上传数据块校验出错。请重试或提交反馈。";break;default:if(i="未知错误。",!b(o))return}i=i+"("+n.status+"："+s+")";break;case plupload.SECURITY_ERROR:i="安全配置错误。请联系网站管理员。";break;case plupload.GENERIC_ERROR:i="上传失败。请稍后再试。";break;case plupload.IO_ERROR:i="上传失败。请稍后再试。";break;case plupload.INIT_ERROR:i="网站配置错误。请联系网站管理员。",m.destroy();break;default:if(i=n.message+n.details,!b(o))return}e&&e(t,n,i)}t.refresh()}}(d)),logger.debug("bind Error event"),m.bind("FileUploaded",function(t){return function(n,i,o){logger.debug("FileUploaded event activated"),logger.debug("file: ",i),logger.debug("info: ",o);var r=function(n,i,o){if(e.downtoken_url){var r=that.createAjax();r.open("POST",e.downtoken_url,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var e;try{e=that.parseJSON(r.responseText)}catch(a){throw"invalid json format"}var s={};plupload.extend(s,that.parseJSON(o),e),t&&t(n,i,that.stringifyJSON(s))}else m.trigger("Error",{status:r.status,response:r.responseText,file:i,code:plupload.HTTP_ERROR})},r.send("key="+that.parseJSON(o).key+"&domain="+e.domain)}else t&&t(n,i,o)},a=that.parseJSON(o.response);if(u=u?u:a.ctx,logger.debug("ctx: ",u),u){var l="";logger.debug("save_key: ",e.save_key),e.save_key||(l=s(n,i,that.key_handler),l=l?"/key/"+that.URLSafeBase64Encode(l):"");var d="/fname/"+that.URLSafeBase64Encode(i.name);logger.debug("op.x_vars: ",e.x_vars);var c=e.x_vars,p="",h="";if(void 0!==c&&"object"==typeof c)for(var f in c)c.hasOwnProperty(f)&&("function"==typeof c[f]?p=that.URLSafeBase64Encode(c[f](n,i)):"object"!=typeof c[f]&&(p=that.URLSafeBase64Encode(c[f])),h+="/x:"+f+"/"+p);var g,b=qiniuUploadUrl+"/mkfile/"+i.size+l+d+h,v=that.detectIEVersion();v&&v<=9?(g=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=e.flash_swf_url):g=that.createAjax(),g.open("POST",b,!0),g.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),g.setRequestHeader("Authorization","UpToken "+that.token);var y=function(){if(logger.debug("ajax.readyState: ",g.readyState),4===g.readyState){localStorage.removeItem(i.name);var e;200===g.status?(e=g.responseText,logger.debug("mkfile is success: ",e),r(n,i,e)):(e={status:g.status,response:g.responseText,file:i,code:-200},logger.debug("mkfile is error: ",e),m.trigger("Error",e))}};v&&v<=9?g.bind("readystatechange",y):g.onreadystatechange=y,g.send(u),logger.debug("mkfile: ",b)}else r(n,i,o.response)}}(c)),logger.debug("bind FileUploaded event"),m.init(),logger.debug("invoke uploader.init()"),logger.debug("init uploader end"),m},this.getUrl=function(e){if(!e)return!1;e=encodeURI(e);var t=this.domain;return"/"!==t.slice(t.length-1)&&(t+="/"),t+e},this.imageView2=function(e,t){var n=e.mode||"",i=e.w||"",o=e.h||"",r=e.q||"",a=e.format||"";if(!n)return!1;if(!i&&!o)return!1;var s="imageView2/"+n;return s+=i?"/w/"+i:"",s+=o?"/h/"+o:"",s+=r?"/q/"+r:"",s+=a?"/format/"+a:"",t&&(s=this.getUrl(t)+"?"+s),s},this.imageMogr2=function(e,t){var n=e["auto-orient"]||"",i=e.thumbnail||"",o=e.strip||"",r=e.gravity||"",a=e.crop||"",s=e.quality||"",l=e.rotate||"",d=e.format||"",c=e.blur||"",u="imageMogr2";return u+=n?"/auto-orient":"",u+=i?"/thumbnail/"+i:"",u+=o?"/strip":"",u+=r?"/gravity/"+r:"",u+=s?"/quality/"+s:"",u+=a?"/crop/"+a:"",u+=l?"/rotate/"+l:"",u+=d?"/format/"+d:"",u+=c?"/blur/"+c:"",t&&(u=this.getUrl(t)+"?"+u),u},this.watermark=function(e,t){var n=e.mode;if(!n)return!1;var i="watermark/"+n;if(1===n){var o=e.image||"";if(!o)return!1;i+=o?"/image/"+this.URLSafeBase64Encode(o):"";
}else{if(2!==n)return!1;var r=e.text?e.text:"",a=e.font?e.font:"",s=e.fontsize?e.fontsize:"",l=e.fill?e.fill:"";if(!r)return!1;i+=r?"/text/"+this.URLSafeBase64Encode(r):"",i+=a?"/font/"+this.URLSafeBase64Encode(a):"",i+=s?"/fontsize/"+s:"",i+=l?"/fill/"+this.URLSafeBase64Encode(l):""}var d=e.dissolve||"",c=e.gravity||"",u=e.dx||"",p=e.dy||"";return i+=d?"/dissolve/"+d:"",i+=c?"/gravity/"+c:"",i+=u?"/dx/"+u:"",i+=p?"/dy/"+p:"",t&&(i=this.getUrl(t)+"?"+i),i},this.imageInfo=function(e){if(!e)return!1;var t,n=this.getUrl(e)+"?imageInfo",i=this.createAjax(),o=this;return i.open("GET",n,!1),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(t=o.parseJSON(i.responseText))},i.send(),t},this.exif=function(e){if(!e)return!1;var t,n=this.getUrl(e)+"?exif",i=this.createAjax(),o=this;return i.open("GET",n,!1),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(t=o.parseJSON(i.responseText))},i.send(),t},this.get=function(e,t){return!(!t||!e)&&("exif"===e?this.exif(t):"imageInfo"===e&&this.imageInfo(t))},this.pipeline=function(e,t){var n,i,o="[object Array]"===Object.prototype.toString.call(e),r="";if(o){for(var a=0,s=e.length;a<s;a++){if(n=e[a],!n.fop)return!1;switch(n.fop){case"watermark":r+=this.watermark(n)+"|";break;case"imageView2":r+=this.imageView2(n)+"|";break;case"imageMogr2":r+=this.imageMogr2(n)+"|";break;default:i=!0}if(i)return!1}if(t){r=this.getUrl(t)+"?"+r;var l=r.length;"|"===r.slice(l-1)&&(r=r.slice(0,l-1))}return r}return!1}}window.localStorage||(window.localStorage={setItem:function(e,t){createCookie(e,t,30)},getItem:function(e){return readCookie(e)},removeItem:function(e){createCookie(e,"",-1)}});var Qiniu=new QiniuJsSDK;global.Qiniu=Qiniu,global.QiniuJsSDK=QiniuJsSDK}(window),define("web_qui_quiupload_qiniu",function(){}),define("web_qui_quiupload",["plupload","web_qui_quiupload_qiniu"],function(){"use strict";function e(e){this.upopt={browse_button:"",container:"",dragdrop:!1,drop_element:"",max_file_size:"100mb",runtimes:"html5,flash,html4",flash_swf_url:"/qcross/static/models/basic/js/plupload/Moxie.swf",multi_selection:!0,chunk_size:"4mb",max_retries:3,qyer_token_url:"/qcross/www/api.php?action=getAlbumToken",domain:"//pic.qyer.com/",auto_start:!0,token_format:function(e){return e.data.tk=e.data.token,e},init:{FilesAdded:function(e,t){},BeforeUpload:function(e,t){},UploadProgress:function(e,t){},UploadComplete:function(){},FileUploaded:function(e,t,n){},Key:function(e,t){var n,i=[];return i.push(window.QYER.uid),i.push((new Date).getTime()),i.push(parseInt(1e4*Math.random())),n=i.join(""),t.key=n,n},Error:function(e,t,n){var i="";if(t)switch(t.code){case-100:i="Silverlight加载失败";break;case-300:case-400:i="无法打开文件";break;case-600:i="图片必须小于"+e.getOption("max_file_size");break;case-601:i="文件扩展名不正确";break;default:i="未知错误"}e.trigger("UploadError",t,i)}}},this.init(e)}return e.prototype={init:function(e){this.upopt=$.extend(!0,this.upopt,e||{}),this._getUpToken()},_getUpToken:function(){var e=this;$.getJSON(e.upopt.qyer_token_url,function(t){if(0!==t.error_code)throw new Error(t.data);e.upopt.uptoken=t.data.token||t.data.tk,t.data.domain&&e.upopt.domain==t.data.domain,e.uploader=Qiniu.uploader(e.upopt),$(e).trigger("uploadready")})}},e}),define("common/models/basic/js/require-css!web_ct_uploadpopup",[],function(){}),define("web_ct_uploadpopup",["web_old_popup2","web_qui_quiupload","web_old_tip","css!web_ct_uploadpopup"],function(e,t,n){function i(e){this.init(e)}function o(e){this.init(e)}function r(e){this.init(e)}function a(e){this.init(e)}function s(e){this.init(e)}function l(e){this.init(e)}function d(e){this.init(e)}function c(e){this.init(e)}function u(e){this.init(e)}var p;p={getPhotoList:function(e){e.posturl="/qcross/pictrip/album.php?action=getMyAlbumList",qyerUtil.doAjax(e)},getLocalForKw:function(e){e.posturl="/api.php?action=searchphotopoi",qyerUtil.doAjax(e)},getPhotos:function(e){e.posturl="/qcross/pictrip/album.php?action=getAlbumPhotoPage",qyerUtil.doAjax(e)},submitPhoto:function(e){e.posturl="/api.php?action=popupwebupload",qyerUtil.doAjax(e)},savePhoto:function(e){e.posturl="/qcross/place/album.php?action=saveUploadAlbumPhoto",qyerUtil.doAjax(e)}},i.prototype={tpl:"",label:"将照片保存到",init:function(e){$.extend(this,e),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){e.render()}),$(document).delegate(e.node+" .source","change",function(){$(e).trigger("fireloaddata")})},getHtml:function(e){var t=this,n=[],i=[];p.getPhotoList({type:"get",onError:function(e){},onSuccess:function(o){if(o.data){i=o.data;for(var r=0;r<i.length;r++)n.push('<option value="'+i[r].id+'">'+i[r].name+"</option>")}t.tpl="<strong>"+t.label+'：</strong><select name="album_list" class="source">'+n.join("")+"</select>",t.dom=$(t.tpl),e&&e()}})},getCurPhoto:function(){return $(this.node).find(".source").val()},render:function(){var e=this;this.getHtml(function(){$(e.node).html(e.dom),$(e).trigger("fireloaddata")})},dispose:function(){$(this.parent).off("aftershow"),$(document).undelegate(this.node+" .source","change")}},o.prototype={init:function(e){$.extend(this,e||{}),this.bindEvent()},bindEvent:function(){},getHtml:function(){return'<strong>新建相册：</strong><div class="qyer_upload_new"><input name="album_new" maxlength="15" type="text" class="albumname" placeholder="输入新相册名，不超过15字"><div class="qyer_upload_new_error" id="swf_albumname_tips"><span></span><div class="icon_warn">相册名不能为空，请输入</div></div></div>'},getPhotoName:function(){var e=$(this.node).find(".albumname").val();return e?($(this.node).find(".qyer_upload_new_error").hide(),e):void $(this.node).find(".qyer_upload_new_error").show()},render:function(){var e=this;$(e.node).html(e.getHtml())}},r.prototype={param:{},init:function(e){$.extend(this,e||{}),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){e.render()}),$(document).delegate(e.node+" input","input",function(){var t=$(this).val();t&&e.getData(t)}),$(document).on("click",function(){$(e.node).find(".editphotopoisearch").hide()}),$(document).delegate(e.node+" .editphotopoisearch .ui_album_poiSelect_search_list","click",function(){e.param.type=$(this).attr("type"),e.param.poiid=$(this).attr("data"),$(e.node).find("input").val($(this).text().trim())})},getData:function(e){var t=this;p.getLocalForKw({type:"get",data:{kw:e,format:"json-html",isnothaveimg:1},onError:function(e){n.tip({text:"获取位置错误",type:"error",time:1e3})},onSuccess:function(e){$(t.node).find(".editphotopoisearch").show().html(e.data)}})},getLocalParm:function(){return this.param},getHtml:function(){var e='<div class="qyer_upload_t_item"><a href="#"><img class="poi_icon" src="//static.qyer.com/images/user/album/album_upload_found_icon.png" alt=""></a><input type="text" class="ui_input js_inputGap fl editpoiinfo" placeholder="为照片批量添加目的地位置" value="" autocomplete="off"><div class="ui_album_poiSelect_div editphotopoisearch tl"></div></div>';return e},render:function(){var e=this;$(e.node).html(e.getHtml())},dispose:function(){$(this.parent).off("aftershow"),$(document).undelegate(this.node+" input","input"),$(document).undelegate(this.node+" .editphotopoisearch .ui_album_poiSelect_search_list","click")}},a.prototype={models:["list","local","create"],status:"list",modelList:[],photolistOpt:{},init:function(e){$.extend(this,e||{}),this.modelList=[],this.initModels(),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){e.render()}),$(document).delegate(e.node+" .create_album","click",function(){"create"==e.status?($(this).html("新建相册"),e.photoList.render(),e.status="list"):(e.photoCreate.render(),$(this).html("选择相册"),e.status="create")})},initModels:function(){for(var e=this,t="",n=0;n<this.models.length;n++)t=this.models[n],"list"==t?(e.photoList=new i($.extend({parent:this,node:this.node+" .qyer_upload_myphoto_list"},e.photolistOpt)),e.modelList.push(e.photoList)):"local"==t?(e.photoLocal=new r({parent:this,node:this.node+" .qyer_upload_t_local"}),e.modelList.push(e.photoLocal)):"create"==t&&(e.photoCreate=new o({node:this.node+" .qyer_upload_myphoto_list"}),e.modelList.push(e.photoCreate))},getHtml:function(){var e='<div class="qyer_upload_myphoto_list"></div><div class="qyer_upload_t_local"></div><span class="fr qyer_upload_create"></span><div class="clear"></div>';return e},getHeadParams:function(){for(var e={},t="",n=0;n<this.models.length;n++)switch(this.models[n]){case"list":"list"==this.status&&(e.isnewalbum=0,e.album_new="",e.album_list=this.photoList.getCurPhoto());break;case"create":"create"==this.status&&(t=this.photoCreate.getPhotoName(),void 0!=t&&(e.isnewalbum=1,e.album_new=t));break;case"local":$.extend(e,this.photoLocal.getLocalParm())}return e},aftershow:function(){if(this.models.length>0)for(var e=0;e<this.models.length;e++)tmpModel=this.models[e],"create"==tmpModel&&$(this.node).find(".qyer_upload_create").html('或 <a class="create_album" href="javascript:void(0);">新建相册</a>');else $(this.node).hide()},render:function(){var e=this;$(e.node).html(e.getHtml()),$(this).trigger("aftershow")},dispose:function(){for(var e=0;e<this.modelList.length;e++)$(this.modelList[e]).trigger("dispose")}},s.prototype={tpl:'<div class="upload_file_item"><span class="filebg" ><em class="percent" style="width:__percent__;"></em></span><strong>__name__</strong><span class="fstatus cLightgray">__status__</span><span class="fr"><a href="javascript:;" class="_jscancelup" data-id="__id__">删除</a></span></div>',init:function(e){$.extend(this,e),this.initDom()},initDom:function(){var e=this.tpl.replace(/__percent__/gi,this.percent).replace(/__name__/,this.name).replace(/__status__/,this.getStatus()).replace(/__id__/,this.id);this.dom=$(e)},setProgress:function(e){this.progress=e},getStatus:function(){var e="";switch(this.status){case 0:e="等待中";break;case 1:e="准备上传";break;case 2:e="上传中";break;case 5:e="上传成功",this.dom.find(".fstatus").addClass("icon_finish")}return e},setStatus:function(e){this.status=e,this.dom.find(".fstatus").html(this.getStatus())},setPercent:function(e){this.percent=e,this.dom.find(".percent").css("width",e+"%")}};var h={list:[],init:function(e){$.extend(this,e||{}),this.list=[],this.dom=$("#"+this.id),this.dom.html=""},addFile:function(e){var t=new s(e);this.list.push(t),this.dom.append(t.dom)},removeFile:function(e){for(var t=0;t<this.list.length;t++)e==this.list[t].id&&this.list.splice(t,1)},getFile:function(e){for(var t=0;t<this.list.length;t++)if(e==this.list[t].id)return this.list[t];return null},dispose:function(){this.list=[]}};return l.prototype={headOpt:{},title:"本地上传",className:"qyer_upload_local",status:"disable",max:-1,init:function(e){$.extend(this,e||{}),this.photoHead=new a($.extend(this.headOpt,{parent:this,node:"."+this.className+" .qyer_upload_item_tit"})),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){$(e).trigger("aftershow")}),$(document).delegate("._jscancelup","click",function(){var t=$(this).attr("data-id"),n=$(this).parents(".upload_file_item"),i=e.upload.uploader.getFile(t);h.removeFile(t),e.upload.uploader.removeFile(i),e.upload.uploader.refresh(),n.remove(),e.toggleStatus()}),$(document).delegate("."+e.className+" .ui_button","click",function(){e.subUpFile()})},getHtml:function(){return'<div class="qyer_upload_local ui_tab_cnt_item"><div class="qyer_upload_item_tit"></div><!--上传照片 --><div class="qyer_upload_item_con"><!--上传照片按钮 --><div id="swf_upload_container_around"><div id="swf_upload_container" class="qyer_upload_upbtn"><div><a id="swfuploadbut" href="javascript:void(0);">+ 上传照片</a></div><p class="mt15" style="font-size:14px;font-weight:bold;color:#c9c9c9">支持JPG、JPEG、PNG格式，每张小于10M.</p></div><!--照片flash上传中 --><div id="album_submit_div" class="qyer_upload_item_loading" style="display:none;"><div class="qyer_upload_list" id="fsUploadProgress"><!--照片flash上传列表显示 --><div id="UploadResult" class="qyer_upload_list_status"></div></div><div class="p10 clearfix"><input type="button" id="album_submit" value="确定" class="fr ui_button_disabled" disabled="disabled"></div></div></div></div><div id="warn_tips" class="qyer_upload_layout_error"><img src="//static.qyer.com/images/common/tpl/icon_warn.png" alt="" class="vm mr10"><span class="fontYaHei cLightgray f14">一次上传文件过多</span></div></div>'},aftershow:function(){var e=this;h.init({id:"UploadResult"}),this.upload=new t({browse_button:"swfuploadbut",container:"swf_upload_container",drop_element:"swf_upload_container_around",filters:[{title:"images files",extensions:"jpg,jpeg,png"}],max_file_size:"10mb",multi_selection:1!=e.max,init:{FilesAdded:function(t,n){plupload.each(n,function(e){h.addFile(e)}),e.toggleStatus()},BeforeUpload:function(e,t){},UploadProgress:function(t,n){var i=h.getFile(n.id);i.setStatus(n.status),i.setPercent(n.percent),e.status="upload",e.toggleSubBtn()},UploadComplete:function(){e.status="ok",e.toggleSubBtn()},FileUploaded:function(e,t,n){var i=h.getFile(t.id);i.setStatus(t.status)},Key:function(e,t){var n=(new Date).getTime(),i=h.getFile(t.id);return n+=parseInt(1e3*Math.random()),n+=window.QYER?""+window.QYER.uid:"",i?i.key=n:t.key=n,n},UploadError:function(e,t,i){n.tip({text:i,type:"error",time:1e3})}}})},toggleStatus:function(){var e=this;h.list.length>0?($("#album_submit_div").show(),$("#swf_upload_container").hide()):(e.status="disable",$("#album_submit_div").hide(),$("#swf_upload_container").show(),e.toggleSubBtn())},toggleSubBtn:function(){var e=$("#album_submit");switch(this.status){case"disable":e.val("确定"),e.attr("disabled",!0),e.removeClass("ui_button").addClass("ui_button_disabled");break;case"upload":e.val("上传中...");break;case"ok":e.val("确定").attr("disabled",!1).removeClass("ui_button_disabled").addClass("ui_button")}},subUpFile:function(){var e,t=this,i=this.photoHead.getHeadParams(),o=h.list,r=[],a=[];void 0!=i.type&&(r=[i.type,i.poiid]);for(var s=0;s<o.length;s++)e={key:o[s].key,description:""},$.isEmptyObject(r)||(e.place=r),a.push(e);i.photo=a,t.status="disable",t.toggleSubBtn(),p.savePhoto({data:i,onSuccess:function(e){var n=e.data.photo,i=[];for(var o in n)i.push({id:o,url:n[o]});$(t).trigger("uploadimage",JSON.stringify(i)),t.parent.hide()},onError:function(e){n.tip({text:e.data.msg||e.data,type:"error",time:1e3})}})},dispose:function(){$(this.photoHead).trigger("dispose"),$(document).undelegate("._jscancelup","click"),$(this.parent).off("aftershow"),$(document).undelegate("."+this.className+" .ui_button","click"),h.dispose()}},d.prototype={headOpt:{},title:"从我的相册选择",className:"qyer_upload_mylist",dataList:[],max:-1,currentPage:1,pageSize:48,loadAjaxFlag:!0,scrollLoadOnly:!0,currentPhotosFlag:!0,init:function(e){$.extend(this,e||{}),this.photoHead=new a($.extend(this.headOpt,{parent:this,node:"."+this.className+" .qyer_upload_item_tit",photolistOpt:{label:"选择相册"}})),this.bindEvent()},bindEvent:function(){var e=this;$(e.photoHead.photoList).on("fireloaddata",function(){e.currentPhotosFlag=!0,e.currentPage=1,e.getData()}),$(this.parent).on("aftershow",function(){$(e).trigger("aftershow")}),$(document).delegate("."+e.className+" .myPhotoList li","click",function(){if(e.max>0){var t=$("."+e.className).find("li[class='current']").length;!$(this).hasClass("current")&&t>=e.max?n.tip({text:"最多选择"+e.max+"张",type:"error",time:1e3}):$(this).toggleClass("current")}else $(this).toggleClass("current")}),$(document).delegate("."+e.className+" #my_photo","click",function(){e.dataList=[],$("."+e.className).find("li[class='current']").each(function(t,n){e.dataList.push({id:$(n).attr("data-id"),url:$(n).attr("data-url")})}),$(e).trigger("uploadimage",JSON.stringify(e.dataList))}),$(document).delegate("."+e.className+" #cancel_my_photo","click",function(){$(e).trigger("firecancel")})},getData:function(){var e=this,t=e.photoHead.photoList.getCurPhoto();p.getPhotos({type:"get",data:{type:"json",album:t,page:e.currentPage,size:e.pageSize},onSuccess:function(t){e.loadAjaxFlag=!0,e.maxPageCount=Math.ceil(t.data.count/e.pageSize);for(var n=t.data.res,i=(t.data.pager,t.data.count,[]),o=$("."+e.className).find(".myPhotoList"),r=0;r<n.length;r++)i.push('<li data-id="'+n[r].id+'" data-url="'+n[r].url+'"><img src="'+n[r].url+'/80" width="80" height="80" ><div class="icon_current"><span></span></div></li>');o.find(".x-loading-page").remove(),e.currentPhotosFlag&&(e.currentPhotosFlag=!1,o.html("")),o.append('<ul class="clearfix">'+i.join("")+"</ul>"),e.maxPageCount>e.currentPage&&o.append('<div class="x-loading-page"></div>'),e.scrollLoadOnly&&(e.scrollLoadOnly=!1,e.scrollLoad())},onError:function(){}})},scrollLoad:function(){var e=this,t=$("."+e.className).find(".myPhotoList"),n=t.height();t.on("scroll",function(){n+t.scrollTop()>=t[0].scrollHeight&&e.loadAjaxFlag&&e.currentPage<e.maxPageCount&&(e.loadAjaxFlag=!1,e.currentPage=e.currentPage+1,e.getData())})},getHtml:function(){return'<div class="qyer_upload_mylist ui_tab_cnt_item"><form id="selecg" name="upfile_form" action="/api.php?action=inputupfile" method="post" enctype="multipart/form-data" target="check_file_frame"><div class="qyer_upload_item_tit"></div><!--上传照片 --><div class="qyer_upload_photo_list myPhotoList" ></div><div class="p10 clearfix qyer_upload_btn"><input type="button" value="确定" class="ui_button fr" id="my_photo"><input type="button" value="取消" class="ui_button_cancel mr10 fr" id="cancel_my_photo"></div></form></div>'},dispose:function(){$(this.photoHead.photoList).off("fireloaddata"),$(document).undelegate("."+this.className+" .myPhotoList li","click"),$(document).undelegate("."+this.className+" #my_photo","click"),$(document).undelegate("."+this.className+" #cancel_my_photo","click"),$(this.photoHead).trigger("dispose")}},c.prototype={headOpt:{},title:"网络图片",className:"qyer_upload_network",init:function(e){$.extend(this,e||{}),this.photoHead=new a($.extend(this.headOpt,{parent:this,node:"."+this.className+" .qyer_upload_item_tit"})),this.bindEvent()},bindEvent:function(){var e=this;$(this.parent).on("aftershow",function(){$(e).trigger("aftershow")}),$(document).delegate("#web_album_submit","click",function(){if("upload"!=e.status){var t=$("#web_img_url").val();/^http:\/\/([\w-]+\.)+[\w-]+(\/[\w-.\/?%&amp;=]*)?$/.test(t)?(e.status="upload",$(".qyer_upload_new_error").hide(),$(this).removeClass("ui_button").addClass("ui_button_disabled").val("上传中..."),e.uploadNetPhoto(t)):$(".qyer_upload_new_error").show()}})},getHtml:function(){return'<div class="qyer_upload_network ui_tab_cnt_item"><form id="web_photo_form"><input type="hidden" name="type" id="poitype_data" value=""><input type="hidden" name="isnewalbum" id="web_isnewalbum" value=""><input type="hidden" name="poiid" id="poiid_data" value=""><div class="qyer_upload_item_tit"></div><div class="qyer_upload_network_url"><div class="fl pr"><input type="text" id="web_img_url" name="imgurl" class="ui_input" placeholder="http://" value=""><!--提示有两种状态 切换里面的两个div --><div class="qyer_upload_new_error" id="web_img_url_tips"><span></span><div class="icon_error">请输入有效图片url地址</div></div></div><input type="button" id="web_album_submit" class="ui_button fl ml10" value="确定"><input type="button" class="ui_button_disabled fl ml10" value="上传中..." style="display:none;"></div></form></div>'},uploadNetPhoto:function(e){var t=this,i=this.photoHead.getHeadParams();i.imgurl=e,i.size="*",p.submitPhoto({type:"get",data:i,onError:function(e){n.tip({text:"上传网络图片错误",type:"error",time:1e3})},onSuccess:function(e){$("."+t.className).find("#web_album_submit").val("完成"),$(t).trigger("uploadimage",e.data),$(document).undelegate("#web_album_submit","click"),t.parent.hide()}})},dispose:function(){$(this.photoHead).trigger("dispose"),$(this.parent).off("aftershow")}},u.prototype={items:[],max:-1,modelMap:{local:l,myphoto:d,net:c},modelList:[],tpl:'<div class="qyer_upload">__headtpl____bodytpl__</div>',currentClass:"ui_tab_trigger_item_current",init:function(e){$.extend(this,e||{}),this.initModels(),this.getHtml(),this.bindEvent()},initModels:function(){var e,t=this;this.modelList=[];for(var n=0;n<this.items.length;n++)e=t.modelMap[this.items[n].model],e=new e($.extend(this.items[n].opt,{parent:t,max:this.max})),t.modelList.push(e)},bindEvent:function(){var e,t=this;$(document).delegate(".qyer_upload_head li","click",function(){t.toggleHead(),$(this).addClass(t.currentClass),e=$(this).index(),t.hideContent(),$(".qyer_upload_content .ui_tab_cnt_item").eq(e).addClass("ui_tab_cnt_item_current"),$(t.modelList[$(this).index()]).trigger("fireshow")});for(var n=0;n<this.modelList.length;n++)$(this.modelList[n]).on("uploadimage firecancel",function(e,n){switch(e.type){case"uploadimage":$(t).trigger("fireuploadimage",n);break;case"firecancel":t.hide()}})},toggleHead:function(){var e=this;$(".qyer_upload_head li").each(function(t,n){$(n).removeClass(e.currentClass)})},hideContent:function(){$(".qyer_upload_content .ui_tab_cnt_item").each(function(e,t){$(t).removeClass("ui_tab_cnt_item_current")})},getHtml:function(){var e="",t=this.getHeadTpl(),n=this.getBodyTpl();e=this.tpl.replace(/__headtpl__/gi,t),e=e.replace(/__bodytpl__/gi,n),this.tpl=e},getHeadTpl:function(){for(var e=this,t=[],n=0;n<e.modelList.length;n++)t.push('<li class="ui_tab_trigger_item">'+e.modelList[n].title+"</li>");return'<div class="qyer_upload_head"><ul class="fl fb f14 ml10 fontYaHei cGray">'+t.join("")+"</ul></div>"},getBodyTpl:function(){for(var e=this,t=[],n=0;n<e.modelList.length;n++)t.push(e.modelList[n].getHtml());return'<div class="qyer_upload_content ui_tab_cnt">'+t.join("")+"</div>"},aftershow:function(){var e=$(".qyer_upload_head li").eq(0);$(e).trigger("click")},show:function(){var t=this;return qyerUtil.isLogin()?(this.popup=new e({contentHTML:t.tpl,showTitle:!1,showCloseIcon:!0,exClassName:"uploadpopup",showOKBtn:!1,showCancelBtn:!1,onCancel:function(){t.dispose()}}),this.popup.show(),void $(this).trigger("aftershow")):void qyerUtil.doLogin()},hide:function(){this.popup.hide(),this.dispose()},dispose:function(){for(var e=0;e<this.modelList.length;e++)$(this.modelList[e]).trigger("dispose")}},u}),define("common/models/basic/js/require-css!old/css/hotelPopup",[],function(){}),define("old/js/hotelPopup",["css!old/css/hotelPopup.css"],function(){function HotelPopup(e){this.opt=e||{},this.init(e.data)}HotelPopup.prototype={init:function(e){var t=this;t.getData(e)},url:"getHotelData",getData:function(e){var t=this;t.data=e,$(t).trigger("getDataSuccess")},getDom:function(data,cb){var me=this,data=data.data.info,group=data.group||BBS.GROUP||"groupA",hotelid=(data.seemore.match(/hotel_?id=(\d+)/)||[])[1],str='<div class="hotelPopup" id="wrapCardHotel" location-href="'+data.seemore+'">',star="零一二三四五".charAt(data.star),cityNames=data.city_name?'|<span class="xgd-dic">'+data.city_name+"</span>":"",starnums=data.star?'<span class="xgd-star">'+star+"星级</span>":"",starStr=data.group&&data.nopid?'<div class="starempty"></div>':starnums+cityNames,pricestr=data.markdown?'<p class="xgpp"><strong class="xgpp-num">'+data.price+'</strong>元</p><a class="xgppdis">'+ +data.reference_price+"</a>":'<p class="xgpp xmt6"><strong class="xgpp-num">'+data.price+"</strong>元</p>",groupcp=data.markdown?'<a class="xcc-pd">'+data.reference_price+'</a>|<span class="xcca-rp"><strong class="xcc-pp">'+data.price+"</strong>元</span>":'<span class="xcca-rp"><strong class="xcc-pp">'+data.price+"</strong>元</span>",groupCimgstr="",groupA='<div class="box1 clearfix"><span class="picture">'+(data.pic.length?'<img src="'+data.pic[0]+'"/>':"")+'</span><div class="info"><h4 class="cn">'+(data.cn_name?data.cn_name:data.en_name)+'</h4><h4 class="en">'+(data.cn_name&&data.en_name?data.en_name:"")+'</h4><p class="score"> <span class="goal">评分<i>'+data.grade+'</i></span><span class="stars">'+new Array(parseInt(data.star)+1).join("<em></em>")+'</span></p></div></div><div class="box3 clearfix"><span class="btn"><a class="ui_btn_bigC" target="_blank" data-bn-ipg="bbs-thread-hotelCard-'+hotelid+'-A" href="'+data.seemore+'" target="_blank">查看实时价格</a> </span><span class="price fontYaHei">   参考价<em>'+data.currency_code+" "+data.price+"</em></span></div>",groupB="";1==data.source?groupB='<div class="xgroupb-tle"><h4 class="xh-titlecn"><span class="xh-discount" style="display:'+["none","inline-block"][+!!data.markdown]+'">'+data.markdown+"折</span>"+(data.cn_name?data.cn_name:data.en_name)+'</h4><h4 class="xh-titlen">'+(data.cn_name&&data.en_name?data.en_name:"")+'</h4></div><div class="xgroupb-des">'+starStr+'</div><div class="xgroupb-pri clearfix"><div class="xgp-pw">'+pricestr+'</div><a class="xgp-a" href="'+data.seemore+'" target="_blank" data-bn-ipg="bbs-thread-hotelCard-'+hotelid+'-B">去<strong class="xgpa-str">Booking.com</strong>查看</a></div>':3==data.source&&(groupB='<div class="xgroupb-tle"><h4 class="xh-titlecn"><span class="xh-discount" style="display:'+["none","inline-block"][+!!data.markdown]+'">'+data.markdown+"折</span>"+(data.cn_name?data.cn_name:data.en_name)+'</h4><h4 class="xh-titlen">'+(data.cn_name&&data.en_name?data.en_name:"")+'</h4></div><div class="xgroupb-des">'+starStr+'</div><div class="xgroupb-pri clearfix"><div class="xgp-pw">'+pricestr+'</div><a class="xgp-airbnb" href="'+data.seemore+'" target="_blank" data-bn-ipg="bbs-thread-hotelCard-'+hotelid+'-B">去<strong class="xgpa-str">Airbnb爱彼迎</strong>查看</a></div>'),data.pic.length&&$.each(data.pic.slice(0,3),function(e,t){groupCimgstr=groupCimgstr+'<img src="'+t+'" alt="" class="xcci"/>'});var groupC='<div class="xgroupC"><div class="xc-header"><h4 class="xch-tlecn">'+(data.cn_name?data.cn_name:data.en_name)+'<span class="xh-discount" style="display:'+["none","inline-block"][+!!data.markdown]+'">'+data.markdown+'折</span></h4><h4 class="xch-tlen">'+(data.cn_name&&data.en_name?data.en_name:"")+'</h4></div><div class="xc-content clearfix"><div class="xcc-imgwrap">'+groupCimgstr+'</div><div class="xcc-aside"><p class="xcca-p">'+groupcp+'</p><a href="'+data.seemore+'" target="_blank" class="xcca-a" data-bn-ipg="bbs-thread-hotelCard-'+hotelid+'-C">查看详情</a></div></div></div>';return cb&&cb(data.seemore),str+eval(group)+"</div>"}};var arrowClass={top:{left:"hotelPopupWrapLB",center:"hotelPopupWrapCB",right:"hotelPopupWrapRB"},bottom:{left:"hotelPopupWrapLT",center:"hotelPopupWrapCT",right:"hotelPopupWrapRT"}},ctroler={init:function(e,t){var n=this;n.dom||(n.dom=n.mainDom()),n.dom.html(""),n.domAddLoading(),n.domStatusReset(),n.dom.hide()},mainDom:function(){return $('<a class="hotelPopupWrap hotelPopupWrapLoading" id="hotelPopupWrap"></a>')},domStatusReset:function(){this.dom.removeClass("hotelPopupWrapLB hotelPopupWrapCB hotelPopupWrapRB hotelPopupWrapLT hotelPopupWrapCT hotelPopupWrapRT")},domAddLoading:function(){this.dom.addClass("hotelPopupWrapLoading")},domRemoveLoading:function(){this.dom.removeClass("hotelPopupWrapLoading")},countPosition:function(e){var t=this,e=$(e),n=e.offset(),i=n.left,o=n.top,r=e.width(),a=e.height(),s=$(window).width(),l=($(window).height(),t.dom.width()||440),d=t.dom.height()||102,c=$(window).scrollTop(),u="center";i+r/2>=l/2&&s-i-r/2>=l/2?(u="center",t.left=i+r-6-l/2):i+r/2<l/2&&s-i-r/2>=l/2?(u="left",t.left=i):i+r/2>=l/2&&s-i-r/2<l/2?(u="right",t.left=i+r-6-l):(u="center",t.left=i+r-6-l/2);var p="top";return o>=c+d?(p="top",t.top=o-d-10):(p="bottom",t.top=o+a+10),[p,u]},show:function(e,t,n){var i=this;i.tar=e,t.seemore=n,i.opt=t,i.dom.html(""),i.domAddLoading();var o={data:{info:t}},r=new HotelPopup(o),a="";i.dom.html(r.getDom(o,function(e){a=e})),i.dom.attr("href",a).attr("target","_blank").attr("data-bn-ipg","bbs-thread-hotelCard-"+(n.match(/hotel_?id=(\d+)/)||[])[1]+"-"+(BBS.GROUP.match(/group(\w?)/)||[])[1]),0==$("#hotelPopupWrap").length&&i.dom.appendTo($("body")),i.arr=i.countPosition.call(i,i.tar),i.setStatus(),i.domRemoveLoading()},setStatus:function(){var e=this;e.arr=e.countPosition(e.tar),e.domStatusReset(),e.dom.addClass(arrowClass[e.arr[0]][e.arr[1]]).css({left:e.left,top:e.top,position:"absolute",display:"block"})},hide:function(){var e=this;e.dom.hide(),$(e).trigger("hotelPopupHide")},remove:function(){var e=this;$("#hotelPopupWrap").remove(),e.id="",$(e).trigger("hotelPopupRemove")}};return ctroler.init(),ctroler}),define("old/js/detail_infobar",[],function(){function e(e,n){e.hide();var i="/qcross/bbs/thread.php?action=editCover",o={tid:window.BBS.TID,photoid:n};$.post(i,o,function(e){"error"==e.result?requirejs(["web_old_tip"],function(t){t.tip({text:e.data.msg,type:"error"})}):t(e.data.pic)},"json")}function t(e){var t=$(".g-ban");t.removeClass("z-nocover"),$(".bbs_info_content").removeClass("z-nocover").find(".names-nohp").removeClass("names-nohp"),$(".g-ban .f-bw .title").hasClass("onerow")&&$(".bbs_info_content .sts.like").css("top","-58px"),t.find(".bigimg").attr("src",e.replace(/index\/.*/,"index?imageMogr/v2/thumbnail/x520/blur/30x30")),t.find(".banimg").attr("src",e),$("#userEditCover").text("修改封面")}function n(){requirejs(["web_ct_uploadpopup"],function(t){var n=new t({max:1,items:[{model:"myphoto",opt:{headOpt:{models:["list"]}}},{model:"local",opt:{headOpt:{models:["list"]}}}]});n.show(),$(n).one("fireuploadimage",function(t,i){var o=JSON.parse(i);0==o.length?requirejs(["web_old_tip"],function(e){e.tip({text:"请选择一张照片",type:"warning"})}):1==o.length&&e(n,o[0].id)})})}var i=$("#bbsDetailInfobar");requirejs(["old/js/like"],function(e){var t=i.find("#infobarLikeBtn");new e({dom:t,tid:window.BBS.TID,isLike:function(){var e=t.hasClass("active");return e},onLike:function(){t.addClass("active"),$("#dockbarLikeBtn").addClass("active")},onDislike:function(){t.removeClass("active"),$("#dockbarLikeBtn").removeClass("active")}})}),requirejs(["old/js/collect"],function(e){var t=i.find("#infobarCollectBtn");new e({dom:t,tid:window.BBS.TID,isCollect:function(){var e=t.hasClass("active");return e},onCollect:function(){t.addClass("active"),$("#dockbarCollectBtn").addClass("active")},onDiscollect:function(){t.removeClass("active"),$("#dockbarCollectBtn").removeClass("active")}})}),$("#userEditCover").on("click",function(){n()}),requirejs(["old/js/hotelPopup"],function(e){var t=0,n=0,i=null;$("body").on("mouseenter",".hotel-card-link,.h_detail",function(){var o=this,r=$(this);clearTimeout(t),clearTimeout(n);var a=r.data("info"),s=r.attr("data-pop-url");if(r.hasClass("h_detail")&&!r.attr("data-info")){var l=r.attr("data-id");+l?$.post("/qcross/bbs/post.php?action=planhotelByid",{hotel_id:r.attr("data-id")}).then(function(t){console.log(t,"suc",typeof t);var n=$.parseJSON(t);"ok"===n.result&&(n.data.group="groupB",r.attr("data-info",JSON.stringify(n.data)),e.show.call(e,o,n.data,s))}):e.show.call(e,o,{nopid:!0,group:r.attr("data-group"),en_name:r.attr("data-enname"),cn_name:r.attr("data-cnname"),currency_code:r.attr("data-currency"),price:r.attr("data-price"),url:r.attr("data-url"),pic:[],star:0},s)}else i=setTimeout(function(){e.show.call(e,o,a,s)},500)}),$("body").on("mouseleave",".hotel-card-link,.h_detail",function(){$(this);i&&clearTimeout(i),t=setTimeout(function(){e.hide.call(e)},500)}),e.dom.mouseenter(function(){t&&clearTimeout(t),n&&clearTimeout(n)}).mouseleave(function(){n=setTimeout(function(){e.hide.call(e)},30)})})}),define("old/js/detail_dockbar",[],function(){function e(){var e=$(window).scrollTop();t(e>r.offset().top+r.height()?"show":"hide")}function t(e){var t="block"===$(".m-popupreply").css("display");"show"!=e||a?"hide"==e&&a&&(a=!1,o.slideUp(),$(".rtt-wrap").removeClass("rttshow"),t&&$(document).trigger("popupeditor",0)):(a=!0,o.slideDown(),$(".rtt-wrap").addClass("rttshow"),t&&$(document).trigger("popupeditor",1))}function n(){$(window).on("scroll",function(t){e()}),requirejs(["old/js/like"],function(e){var t=o.find("#dockbarLikeBtn");new e({dom:t,tid:BBS.TID,isLike:function(){var e=t.hasClass("active");return e},onLike:function(){t.addClass("active"),$("#infobarLikeBtn").addClass("active")},onDislike:function(){t.removeClass("active"),$("#infobarLikeBtn").removeClass("active")}})}),requirejs(["old/js/collect"],function(e){var t=o.find("#dockbarCollectBtn");new e({dom:t,tid:BBS.TID,isCollect:function(){var e=t.hasClass("active");return e;
},onCollect:function(){t.addClass("active"),$("#infobarCollectBtn").addClass("active")},onDiscollect:function(){t.removeClass("active"),$("#infobarCollectBtn").removeClass("active")}})})}function i(){n(),e()}var o=$("#bbsDetailDockbar"),r=$("#bbsDetailInfobar"),a=(r.offset().top+r.height(),!1);i()}),define("old/js/gotoup",[],function(){function e(){var e='<div class="bbs_returnTop" id="detailGotoUp">';e+='<div class="return"><a href="javascript:;" data-bn-ipg="bbs-gotoTop" title="返回顶部" id="detailGotoUpBtn">返回顶部</a></div>',e+='<div class="weixin"><div class="pic"><img width="100" height="100" alt="" id="detailGotoUpQRCodeImg" /></div><p class="txt">手机看帖</p></div>',e+='<div class="return"><a href="javascript:;" data-bn-ipg="bbs-gotoBtm" class="goto-btm" title="直达底部" id="detailGotoBtm">直达底部</a></div>',e+="</div>",$("body").append(e),o=$("#detailGotoUp");var t=$("#pageUrlQRCode").find("img").attr("src");$("#detailGotoUpQRCodeImg").attr("src",t)}function t(){var e=$(window).scrollTop(),t=r.offset()||{},n=e+a<t.top?20:e+a-t.top+20;$("#detailGotoUp").css("bottom",n)}function n(){$(window).on("scroll",function(e){t()}),$("#detailGotoUpBtn").on("click",function(){$("html,body").animate({scrollTop:0},300)}),$("#detailGotoBtm").on("click",function(){$("html,body").animate({scrollTop:$("body").height()-$(window).height()},300)})}function i(){e(),n(),t()}var o=$(),r=$(".qyer_footer"),a=$(window).height();i()}),define("common/models/basic/js/require-css!old/css/bbs_dlg_common",[],function(){}),define("common/models/basic/js/require-css!old/css/bbs_video",[],function(){}),define("old/js/bbs_video",["web_old_popup2","old/js/bbs_dlg_common","css!old/css/bbs_dlg_common.css","css!old/css/bbs_video.css"],function(e,t){function n(e){this.init(e)}var i=0;return n.prototype={opt:{contentHTML:'<div class="qyEdit_append_pic clearfix"><div class="qyEdit_append_title clearfix"><strong class="text fontYaHei">插入视频</strong><a href="javascript:;" title="关闭" class="close"></a></div><div class="qyEdit_append_video"><div class="input"><input type="text" value="" placeholder="请输入视频网址" class="ui2_input" /><span class="toggleTip"></span></div><div class="tips"><p class="tip">仅支持优酷、腾讯视频、新浪视频</p><p class="error" id="BBSAddVideoError"><span></span>视频网址有错误，请重新输入</p></div></div><div class="qyEdit_append_button clearfix"><a href="javascript:;" class="btn ui_button">插入视频</a><a href="javascript:;" class="ui_button_cancel">取消</a></div></div>',exClassName:"editor_video",width:622},urlMap:{youku:"优酷",youtube:"youtube",sina:"新浪",56:"我乐",pps:"PPS影音",letv:"乐视网",tudou:"土豆",qq:"腾讯",ku6:"酷6",sohu:"搜狐",qyer:"穷游网"},editor:null,init:function(n){return $.extend(this,n||{}),this.popup=new e($.extend(t.dlgOpt,this.opt)),this.dom=this.popup.ui.$content,this},bindEvent:function(){function e(){var e,n=t.dom.find(".ui2_input").val(),o=t.dom.find(".btn");n&&(e=n.match("([a-z1-9]*).com"),o.removeClass("ui_button").addClass("ui_button_disabled"),n=null!=n.match(/^http:\/\//)?n:"http://"+n,t.setStatus("loading"),$.ajax({url:BBS_Url.checkVideo,data:{url:n},success:function(r){o.removeClass("ui_button_disabled").addClass("ui_button");var r=JSON.parse(r);0==r.error_code?(t.setStatus("correct"),r.data.swf&&(t.hide(),setTimeout(function(){var o=$("<div>"+r.data.title+"</div>");t.editor.execCommand("insertvideo",{url:r.data.swf,title:t.urlMap[e[1]]||"",src:n,poster:r.data.pic||"",live:r.data.live||0,videoTitle:o.text()}),$(document).trigger("x-editDomInsert",i)},500))):t.setTipError(!0,r.data.msg)}}))}var t=this;this.dom.off("click input keydown"),this.dom.on("click",".close",function(e){t.hide()}),this.dom.on("click",".ui_button_cancel",function(e){t.hide()}),this.dom.on("input",".ui2_input",function(){$(".qyEdit_append_video .error").css("display","none")}),this.dom.on("keydown",".ui2_input",function(t){13==t.keyCode&&e()}),this.dom.on("click",".btn",function(){i=$(window).scrollTop(),e()})},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},convert_url:function(e){return e?e=this.trim(e).replace(/v\.youku\.com\/v_show\/id_([\w\-=]+)\.html/i,"player.youku.com/player.php/sid/$1/v.swf").replace(/(www\.)?youtube\.com\/watch\?v=([\w\-]+)/i,"www.youtube.com/v/$2").replace(/youtu.be\/(\w+)$/i,"www.youtube.com/v/$1").replace(/v\.ku6\.com\/.+\/([\w\.]+)\.html.*$/i,"player.ku6.com/refer/$1/v.swf").replace(/www\.56\.com\/u\d+\/v_([\w\-]+)\.html/i,"player.56.com/v_$1.swf").replace(/www.56.com\/w\d+\/play_album\-aid\-\d+_vid\-([^.]+)\.html/i,"player.56.com/v_$1.swf").replace(/v\.pps\.tv\/play_([\w]+)\.html.*$/i,"player.pps.tv/player/sid/$1/v.swf").replace(/www\.letv\.com\/ptv\/vplay\/([\d]+)\.html.*$/i,"i7.imgs.letv.com/player/swfPlayer.swf?id=$1&autoplay=0").replace(/www\.tudou\.com\/programs\/view\/([\w\-]+)\/?/i,"www.tudou.com/v/$1").replace(/v\.qq\.com\/cover\/[\w]+\/[\w]+\/([\w]+)\.html/i,"static.video.qq.com/TPout.swf?vid=$1").replace(/v\.qq\.com\/.+[\?\&]vid=([^&]+).*$/i,"static.video.qq.com/TPout.swf?vid=$1").replace(/my\.tv\.sohu\.com\/[\w]+\/[\d]+\/([\d]+)\.shtml.*$/i,"share.vrs.sohu.com/my/v.swf&id=$1"):""},checkUrl:function(e){var t;return e?(e=this.convert_url(e),t=e.match("([a-z1-9]*).com"),t&&t.length>1?(this.setTipError(!1),e):(this.setTipError(!0),"")):(this.dom.find(".input").removeClass("inputError"),this.dom.find(".tips .error").hide(),this.dom.find(".tips .tip").show(),"")},setStatus:function(e){var t=this.dom.find(".toggleTip");t.removeClass("loading correct"),t.addClass(e).show()},setTipError:function(e,t){var n=this.dom.find(".input"),i=this.dom.find(".tips .error"),o=this.dom.find(".tips .tip"),r=this.dom.find(".toggleTip");e===!0?(n.addClass("inputError"),$("#BBSAddVideoError").html(t?"<span></span>"+t:"<span></span>视频url有错误，请重新输入"),o.hide(),i.show(),r.hide()):(n.removeClass("inputError"),o.show(),i.hide(),r.show())},show:function(){this.popup.show();var e=this.dom.find(".ui2_input");e.val(""),t.$focus(e[0]),this.dom.find(".toggleTip").hide(),this.checkUrl(),this.bindEvent()},hide:function(){this.popup.hide(!0)}},n}),define("common/models/basic/js/require-css!old/css/bbs_attach",[],function(){}),define("old/js/bbs_attach",["web_old_popup2","old/js/bbs_dlg_common","plupload","css!old/css/bbs_dlg_common.css","css!old/css/bbs_attach.css"],function(Popup,BbsUtils){function Attach(e){this.init(e)}return Attach.prototype={opt:{contentHTML:'<div class="qyEdit_append_pic clearfix"><div class="qyEdit_append_title clearfix"><strong class="text fontYaHei">插入附件</strong><a href="javascript:;" title="关闭" class="close"></a></div><div class="qyEdit_append_affix"><div class="input" id="selContainerWrap"><div class="upload" id="selContainer"><span class="default" id="selBtn">从电脑中选择文件上传</span></div><span class="toggleTip"></span></div><div class="tips"><p class="error"><span></span>仅支持不超过20MB大小的文件</p><p>支持单个不超过20MB的pdf格式文件上传</p></div></div><div class="qyEdit_append_button clearfix"><a href="javascript:;" class="btn ui_button_disabled">插入附件</a><a href="javascript:;" class="ui_button_cancel">取消</a></div></div>',exClassName:"editor_file",width:620},GStatus:!1,GFile:null,init:function(e){return $.extend(this,e||{}),this.popup=new Popup($.extend(BbsUtils.dlgOpt,this.opt)),this.dom=this.popup.ui.$content.find(".qyEdit_append_pic"),this},initUploader:function(){var me=this;$.ajax({url:BBS_Url.getHashAttach,async:!1,success:function(e){e=JSON.parse(e),0==e.error_code&&(me.GKey=e.data.key)}}).done(function(){me.uploader&&me.uploader.destroy()&(me.uploader=null),me.uploader=new plupload.Uploader({runtimes:"html5,html4,flash",browse_button:me.dom.find("#selContainer").get(0),container:me.dom.find("#selContainerWrap").get(0),flash_swf_url:"/qcross/static/models/basic/js/plupload/Moxie.swf",max_file_size:"20mb",multipart:!0,multi_selection:!1,url:BBS_Url.uploadAttach,filters:[{title:"Pdf files",extensions:"pdf"}],init:{BeforeUpload:function(e,t,n){me.uploader.setOption({multipart_params:{hash:me.GKey,file:t.name}}),me.GStatus=!0},FilesAdded:function(e,t){me.uploader.start()},UploadProgress:function(e,t){me.dom.find(".toggleTip").removeClass("correct").addClass("loading")},FileUploaded:function(up,file,resp){var res="function"==typeof JSON.parse?JSON.parse(resp.response):eval("("+resp.response+")"),fT=file;fT.key=res.data.key,me.GFile=fT,me.dom.find(".toggleTip").removeClass("loading").addClass("correct"),me.GFile&&me.setName(),me.GStatus=!1,up.destroy()},UploadComplete:function(e,t){},Error:function(e,t){var n="";if(t)switch(t.code){case-100:case-200:n="网络错误";break;case-300:case-400:n="无法打开文件";break;case-600:n="单个文件必须小于20M";break;case-601:n="文件扩展名不正确"}e.trigger("UploadError",t,n),requirejs(["web_old_tip"],function(e){e.tip({text:n,type:"error"})}),me.dom.find(".toggleTip").removeClass("loading"),me.dom.find(".btn").removeClass("ui_button").addClass("ui_button_disabled")}}}),me.uploader.init()})},setName:function(e){var t=this.dom.find(".btn");this.dom.find("#selBtn").html(this.GFile.name),t.removeClass("ui_button_disabled").addClass("ui_button")},bindEvent:function(){var e=this;this.dom.off("click"),this.dom.on("click",".close",function(t){e.hide(),e.uploader&&e.uploader.destroy()}),this.dom.on("click",".ui_button_cancel",function(t){e.hide(),e.uploader&&e.uploader.destroy()}),this.dom.on("click",".btn",function(){e.GFile&&0==e.GStatus&&(e.editor.execCommand("insertfile",e.GFile),e.hide(),$(document).trigger("x-editDomInsert"))}),this.initUploader()},show:function(){this.popup.show(),this.bindEvent(),this.dom.find(".toggleTip").removeClass("correct loading"),this.dom.find("#selBtn").html("从电脑中选择文件上传")},hide:function(){this.popup.hide(!0)}},Attach}),define("common/models/basic/js/require-css!old/css/bbs_createalbum",[],function(){}),define("old/js/bbs_createalbum",["web_old_popup2","old/js/bbs_dlg_common","css!old/css/bbs_dlg_common.css","css!old/css/bbs_createalbum.css"],function(e,t){function n(e){this.init(e)}return n.prototype={opt:{contentHTML:'<div class="qyEdit_append_pic clearfix"><div class="qyEdit_append_title clearfix"><strong class="text fontYaHei">创建新相册</strong><a href="javascript:;" title="关闭" class="close"></a></div><div class="qyEdit_append_video"><div class="input"><input type="text" value="" placeholder="相册名称" class="ui2_input" /></div><div class="tips"><p class="error"><span></span>相册名称不能超过15个汉字</p></div></div><div class="qyEdit_append_button clearfix"><a href="javascript:;" class="btn ui_button_disabled">创建相册</a><a href="javascript:;" class="ui_button_cancel">取消</a></div></div>',exClassName:"editor_createAlbum",width:622},editor:null,init:function(t){return $.extend(this,t||{}),this.popup=new e($.extend(t,this.opt)),this.dom=$("."+this.opt.exClassName),this},setTipError:function(e){var t=this.dom.find(".qyEdit_append_video"),n=this.dom.find(".btn");1==e?(t.addClass("showError"),n.removeClass("ui_button").addClass("ui_button_disabled")):(t.removeClass("showError"),n.removeClass("ui_button_disabled").addClass("ui_button"))},bindEvent:function(){var e=this;this.dom.off("click input"),this.dom.on("click",".close",function(t){e.hide()}),this.dom.on("click",".ui_button_cancel",function(t){e.hide()}),this.dom.on("input",".ui2_input",function(){var t=$(this).val();t.length>0&&t.length<=15?e.setTipError(!1):0==t.length?e.setTipError(!1):e.setTipError(!0)}),this.dom.on("click",".btn",function(){var t=$(this);t.hasClass("ui_button")&&$.ajax({url:BBS_Url.opensession,method:"get",async:!1,success:function(t){e.create()}})})},create:function(){var e=this,t=this.dom.find(".ui2_input").val();$.ajax({url:BBS_Url.singleCreateAlbum,method:"post",async:!1,data:{name:t},success:function(n){var i=JSON.parse(n);0==i.error_code&&requirejs(["web_old_tip"],function(n){n.tip({text:i.data.msg}),e.hide(),$(e).trigger("createalbumsuccess",{id:i.data.id,name:t,url:i.data.url})})}})},resetIpt:function(){var e=this.dom.find(".ui2_input");e.val(""),t.$focus(e[0])},show:function(){this.popup.show(),this.resetIpt(),this.bindEvent()},hide:function(){this.popup.hide(!0)}},n}),define("common/models/basic/js/require-css!old/css/loading",[],function(){}),define("old/js/loading",["css!old/css/loading.css"],function(){function e(e){this.init(e)}return e.prototype={parent:null,status:!1,init:function(e){$.extend(this,e)},getHtml:function(){return'<div class="loading"><img src="//static.qyer.com/models/basic/images/loading-32.gif"></div>'},render:function(e){this.dom=$(this.getHtml()),e.append(this.dom),this.status=!0},show:function(e){this.dom.show()},hide:function(){this.dom.hide()}},e}),define("old/js/bbs_lift",[],function(){function e(e){this.init(e)}return e.prototype={data:[],dom:null,editor:null,init:function(e){return $.extend(this,e),this},getHtml:function(){return'<div class="lift_cont fontSong"><div class="lift_head"><h3>帖子电梯</h3><span class="reload animateRotate"></span></div><div class="lift_body">'+this.getDataHtml()+"</div></div>"},getDataHtml:function(){var e=[];if(this.data.length){for(var t,n=0;t=this.data[n++];)if(t.mainTitle&&e.push('<h4><span data-alt="'+t.alt+'">'+t.mainTitle+"</span></h4>"),t.subTitle.length>0){e.push("<ul>");for(var i,o=0;i=t.subTitle[o++];)e.push('<li><span data-alt="'+i.alt+'">'+i.title+"</span></li>");e.push("</ul>")}}else e.push("<span style='color:#c0c0c0'>选中文字设置标题1或标题2后，会自动生成目录电梯</span>");return e.join("")},bindEvent:function(){var e=this;this.dom.on("click",".reload",function(){e.reload()}),this.dom.on("click","span",function(){var t=$(this).attr("data-alt");$(e).trigger("scrollview",t)})},reload:function(){var e,t=this;t.loadData(),e=$(t.getHtml()),t.dom&&(t.dom.replaceWith(e),t.dom=e,t.bindEvent())},loadData:function(){for(var e,t,n=this.editor.document.body.childNodes,i=[],o=0;t=n[o++];)1==/h1/i.test(t.tagName)&&($(t).prop("id",o),e={mainTitle:$(t).text(),alt:o,subTitle:[]},i.push(e)),1==/h2/i.test(t.tagName)&&($(t).prop("id",o),i.length<1&&(e={mainTitle:"",subTitle:[]},i.push(e)),e=i[i.length-1],e.subTitle.push({title:$(t).text(),alt:o}));this.data=i},getDom:function(){var e=this;return this.dom?(this.reload(),setTimeout(function(){e.dom.find(".reload").removeClass("animateRotate")},500),this.dom):(this.loadData(),this.dom=$(this.getHtml()),this.bindEvent(),setTimeout(function(){e.dom.find(".reload").removeClass("animateRotate")},500),this.dom)}},e}),define("old/js/bbs_emotion",[],function(){function e(e){this.init(e)}return e.prototype={baseUrl:"//static.qyer.com/models/project/bbs/css/images/face/",maxNum:30,dom:null,editor:null,init:function(e){return $.extend(this,e),this},getDataHtml:function(){for(var e,t=[],n=0;n<this.maxNum;n++)e=-26*n+"px",t.push("<span style='background-position:0 "+e+";' data-num='"+n+"'></span>");return t.join("")},getHtml:function(){return'<div class="emotion_cont clearfix">'+this.getDataHtml()+"</div>"},bindEvent:function(){var e=this;this.dom.on("click","span",function(t){var n=$(this).attr("data-num"),i={type:"emotion",src:e.baseUrl+"face"+n+".png"};i._src=i.src,e.editor.execCommand("insertimage",i),$(document).trigger("x-editDomInsert")})},getDom:function(){return this.dom=$(this.getHtml()),this.bindEvent(),this.dom}},e}),define("common/models/basic/js/require-css!web_old_slidconfirm",[],function(){}),define("web_old_slidconfirm",["css!web_old_slidconfirm"],function(){function e(e){n.find(".qui-slidConfirm-text").html(e.text||"确定要继续吗？");var i,o=t(e.target),r=o.offset(),a=r.left-n.width()/2+o.width()/2;i=e.down?r.top+o.height():r.top-n.height()-o.height()-8,0>i&&(i=0),n.css({left:a,top:i}),o=r=a=i=null}var t=jQuery,n=null;!function(){var e=['<div class="qui-slidConfirm" style="display:none">','<div class="qui-slidConfirm-title">','<span class="qui-slidConfirm-text">你确认要删除吗</span>',"</div>",'<div class="qui-slidConfirm-bottom">','<input type="button" class="qui-slidConfirm-cancelBtn ui_button_cancel" value="取消" /> ','<input type="button" class="qui-slidConfirm-okBtn ui_button" value="确定" /> ',"</div>","</div>"].join("");n=t(e),n.appendTo(document.body)}();var i={confirm:function(i){return e(i),n.undelegate("click").delegate(".qui-slidConfirm-cancelBtn,.qui-slidConfirm-okBtn","click",function(){-1!=this.className.indexOf("qui-slidConfirm-cancelBtn")?i.onCancel&&i.onCancel():-1!=this.className.indexOf("qui-slidConfirm-okBtn")&&i.onOK&&i.onOK(),n.slideUp(300)}).slideDown(300,function(){t(document).one("click",function(e){var t=e.target||e.srcElement;-1==t.className.indexOf("qui-slidConfirm-")&&(n.hide(),i.onCancel&&i.onCancel())})}),this}};return i}),define("common/models/basic/js/require-css!old/css/tools",[],function(){}),define("common/models/basic/js/require-css!web_old_inputautocomplete",[],function(){}),define("web_old_inputautocomplete",["css!web_old_inputautocomplete"],function(){function e(e){this.$obj=e.$obj,this.timer=null,this.isSearching=!1,this.$contentDiv=null,this.option=e.option,e.option.parent&&(this.$parent=t(e.option.parent)),this.init()}var t=jQuery;e.prototype={$obj:null,timer:null,option:null,isSearching:!1,$contentDiv:null,$parent:null,init:function(){this.createDomNode(),this.bindEvent()},createDomNode:function(){var e=['<div class="qui-inputAutocomplete" style="display:none;">','<ul class="qui-inputAutocomplete-ul" >','<li class="disableDefalut">loading ... </li>',"</ul>","</div>"].join("");if(this.$contentDiv=t(e),this.$obj.is(":visible")){var n={width:this.$obj.outerWidth()};if(!this.$parent){var i=this.$obj.offset();n.top=i.top+this.$obj.outerHeight(),n.left=i.left,i=null}this.$contentDiv.css(n)}this.$contentDiv.appendTo(this.$parent||document.body),e=n=null},_blurTimer:null,bindEvent:function(){var e=this;this.$obj.keyup(function(n){if(t.inArray(n.keyCode,[37,39])==-1)return 9==n.keyCode?(e.$contentDiv.hide(),void(e.option.onVoid&&e.option.onVoid(e.$obj[0]))):void(t.inArray(n.keyCode,[38,40,13])!=-1&&e.updateUI(n.keyCode))}).on("input",function(){t.trim(e.$obj.val())||e.option.isAllowEmptySeach?e.registSearch():(e.$contentDiv.hide(),e.option.onVoid&&e.option.onVoid(e.$obj[0]))}).blur(function(){e._blurTimer=window.setTimeout(function(){e.$contentDiv.is(":hidden")||e.option.isBlurClose!==!1&&e.$contentDiv.hide()},300),e.option.isBlurSelect&&e.option.onSelect&&e.option.onSelect.call(null,e.$contentDiv.find("li[data-select=true]").get(0),!0)}),this.option.isFocusedSeach&&this.$obj.focus(function(){(t.trim(e.$obj.val())||e.option.isAllowEmptySeach)&&e.registSearch()}),this.$contentDiv.delegate(".qui-inputAutocomplete-ul li","click",function(n){return n.target.className.indexOf("disableDefalut")!=-1?(n.stopPropagation(),void window.clearTimeout(e._blurTimer)):void(this.className.indexOf("disableDefalut")==-1&&(e.$obj.val(t(this).text()),e.$contentDiv.hide(),e.option.onSelect&&(e.option.onSelect.call(e.$obj[0],this),e.$contentDiv.html(""))))})},registSearch:function(){var e=this;this.isSearching=!1,window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){(t.trim(e.$obj.val())||e.option.isAllowEmptySeach)&&(e.isSearching=!0,e.showContentDiv(),e.option.onSearch.call(e.$obj[0]))},300)},showContentDiv:function(){var e=this;if(this.$contentDiv.is(":hidden")){if(this.$obj.is(":visible")){var n={width:this.$obj.outerWidth()};if(!this.$parent){var i=this.$obj.offset();n.top=i.top+this.$obj.outerHeight(),n.left=i.left,i=null}this.$contentDiv.css(n)}this.$contentDiv.show(),t(document).one("click",function(t){e.option.isBlurClose!==!1&&e.$contentDiv.hide()})}},updateUI:function(e){function n(){var e=o.find("li[data-select=true]"),t=o.find("li").index(e);e.attr("data-select",""),e.length?(e=o.find("li:not(.disableDefalut)").eq(t+1),e.length||(e=o.find("li:eq(0)"))):e=o.find("li:eq(0)"),e.attr("data-select","true"),e=null}function i(){var e=o.find("li[data-select=true]"),t=o.find("li").index(e);e.attr("data-select",""),e.length?(e=o.find("li:not(.disableDefalut)").eq(t-1),e.length||(e=o.find("li:eq("+(r-1)+")"))):e=o.find("li:eq("+(r-1)+")"),e.attr("data-select","true"),e=null}if(!this.$contentDiv.is(":hidden")){var o=this.$contentDiv.find(".qui-inputAutocomplete-ul"),r=o.find("li:not(.disableDefalut)").size();if(r&&(t.inArray(e,[38,40])!=-1&&(40==e?n():i()),this.option.enterSelect!==!1&&13==e)){var a=o.find("li[data-select=true]");a.length?(this.$obj.val(a.text()),this.option.onSelect&&(this.option.onSelect.call(this.$obj[0],a[0],!0),this.$contentDiv.html("")),this.$contentDiv.hide()):this.option.isBlurClose!==!1&&this.$contentDiv.hide()}}},pushHTML:function(e){if(this.$obj.is(":visible")){var t={width:this.$obj.outerWidth()};if(!this.$parent){var n=this.$obj.offset();t.top=n.top+this.$obj.outerHeight(),t.left=n.left,n=null}this.$contentDiv.css(t),t=null}this.$contentDiv.html(e),this.isSearching=!1;var i=this.$contentDiv.find(".qui-inputAutocomplete-ul > li:not(.disableDefalut)");i.length&&this.option.autoSelect&&i.eq(0).attr("data-select","true"),i=null},isShow:function(){return!this.$contentDiv.is(":hidden")},hide:function(){return this.$contentDiv.hide()},destroy:function(){this.$contentDiv.remove()}},t.fn.extend({qyerAutocomplete:function(n){var i,o,r=arguments;return t.each(this,function(a,s){i=t(s),"object"==t.type(n)?i.data("_autocomplete",new e({$obj:i,option:n})):"pushHTML"==n?i.data("_autocomplete").pushHTML(r[1]):"getContent"==n?o=i.data("_autocomplete").$contentDiv:"isShow"==n?o=i.data("_autocomplete").isShow():"hide"==n?i.data("_autocomplete").hide():"destroy"==n&&(i.data("_autocomplete").destroy(),i.data("_autocomplete",null))}),i=r=null,"undefined"==typeof o?this:o}})}),define("old/js/senior_tool",["web_old_popup2","old/js/bbs_video","old/js/bbs_attach","old/js/bbs_createalbum","old/js/loading","old/js/bbs_lift","old/js/bbs_emotion","web_old_slidconfirm","web_old_select","css!old/css/tools.css"],function(e,t,n,i,o,r,a,s){function l(e){this.init(e)}function d(e){this.init(e)}function c(e){this.init(e)}function u(e){this.init(e)}function p(e){this.init(e)}function h(e){this.init(e)}function f(e){this.init(e)}var m=(baidu.editor.browser,baidu.editor.utils,function(e,t,n,i){var o=e[0],r=function(e){o.onload=o.onerror=o.onabort=null,e&&e.apply(null,arguments)};o.onload=r(n),o.onerror=o.onabort=r(i),o.src=t}),g=function(e){var t="/photo.php?action=remove";$.post(t,{id:[e]})},b={baseImgUrl:"//static.qyer.com/models/project/bbs/images/",images:[{title:"调整字体样式",url:"edit-1.gif",desc:"选中文字后可进行加粗、调整颜色"},{title:"给选中文字添加超链接",desc:"选中文字后可为其添加或移除超链接",url:"link-2.gif"},{title:"利用标题添加帖子目录",url:"title-3.gif",desc:"选中文字设置标题1或标题2样式后，会自动生成目录电梯。浏览时，可通过目录快速定位至感兴趣的内容"},{title:"通过穷游相册给帖子插入图片",url:"photo-4.gif",desc:"先将旅行照片上传到穷游相册并关联拍摄地点，点击相册中的照片可将照片插入到编辑器的光标处"},{title:"未发布的内容会自动保存草稿",url:"save-5.gif",desc:"亦可点击“保存草稿”来手动保存草稿"},{title:"设置帖子发布信息让帖子更多的穷游er看见",url:"information-6.gif",desc:"可通过设置帖子所属版面和帖子标签让更多穷游er看到你的大作"},{title:"",url:"egg-7.png",desc:""}],body:$("body"),index:0,wrapClass:"pub-threadhelp-wrap",slide:function(){var e=$("."+this.wrapClass);return e.find(".pub-gifwrap").eq(this.index).fadeIn(300).siblings().fadeOut(300),e.find(".x-footer a").eq(this.index).addClass("active").siblings().removeClass("active"),this},bindEvent:function(){var e=this,t=$("."+this.wrapClass);return t.on("click",".xcd i,.x-footer a",function(){this.className.match(/\b(xright)\b/)?e.index=e.index===e.images.length-1?0:e.index+1:this.className.match(/\b(xleft)\b/)?e.index=0===e.index?e.images.length-1:e.index-1:e.index=$(this).index(),e.slide()}),t.find(".x-header a").on("click",function(){t.slideUp(200)}),this},domInit:function(){for(var e,t=$("<div class='"+this.wrapClass+"'><div class='x-header'><a href='javascript:void(0);'></a><p></p></div><div class='x-content'><span class='xcd xfl'><i class='xleft'></i></span><div class='xcimages'></div><span class='xcd xfr'><i class='xright'></i></span></div><div class='x-footer'></div></div>"),n=this.images.length,i=[],o=0;e=this.images[o++];)i.push("<div class='pub-gifwrap'><img src='"+(this.baseImgUrl+e.url)+"' alt=''/><div class='x-pubdesc-wrap'><span class='x-pubnum'>"+o+"</span><div class='x-pubdesc"+o+"'><p class='x-pubdesc-title'>"+e.title+"</p><p class='x-pubdesc-content'>"+e.desc+"</p></div></div></div>");t.find(".xcimages").append(i.join("")).find(".pub-gifwrap").eq(4).css("top","-48px").find(".x-pubnum").css("margin-top","-130px"),t.find(".pub-gifwrap").eq(5).css("top","-60px").find(".x-pubnum").css("margin-top","-108px"),t.find(".pub-gifwrap").eq(6).css("top","30px").find(".x-pubdesc-wrap").css("display","none");for(var r=[],a=t.find(".x-footer"),o=n;o--;)r.push("<a href='javascript:void(0);'></a>");return a.append(r.join("")),this.body.append(t),this},init:function(){return this.domInit().bindEvent().slide(),$("."+this.wrapClass)}},v=b.init().hide();return l.prototype={dom:null,status:"",domain:null,init:function(e){$.extend(this,e)},getHtml:function(){return'<li><img width="100" height="100" alt="" onerror="javascript:this.src=\'//static.qyer.com/images/place/no/poi_150_150.jpg\'"/><div class="loading"><span><em style="width:0%;"></em></span></div><div class="delete" title="删除">删除</div><div class="rotate"><span class="left" title="向左旋转">向左旋转</span><span class="right" title="向右旋转">向右旋转</span></div></li>'},bindEvent:function(){var e=this;this.dom.on("mouseenter mouseleave",function(t){"complete"==e.status&&("mouseenter"==t.type?e.dom.find(".delete").show():e.dom.find(".delete").hide())}),this.dom.on("click",".delete",function(){e.dom.remove(),$(e).trigger("filedestroy")})},setRotate:function(e){this.dom.find(".loading em").css({width:parseInt(.8*e)+"%"})},setStatus:function(e){switch(this.status=e,this.status){case"loading":break;case"error":break;case"complete":var t=this.url,n=t+"/120",i=this,o=i.dom.find("img");i.dom.find(".delete"),i.dom.find(".loading");m(o,n,function(){setTimeout(function(){i.dom.find(".loading").hide(),i.dom.find(".delete").hide(),i.dom.find("img").attr({"data-src":t})},200)})}},getDom:function(){return this.dom?this.dom:(this.dom=$(this.getHtml()),this.bindEvent(),this.dom)}},d.prototype={opt:{contentHTML:'<div class="qyEdit_append_pic clearfix"><div class="qyEdit_append_title clearfix"><strong class="text fontYaHei">上传图片到相册</strong><a href="javascript:;" class="minimize hvr"><em class="tip">最小化</em></a></div><div class="qyEdit_append_wrap"><div class="qyEdit_append_list clearfix"><ul></ul></div></div><div class="qyEdit_append_button clearfix"><p class="tips">已上传：<span class="num"></span>张</p><div class="cancel"><a href="javascript:;" class="btn btn_upload_cancel ui_button_cancel">取消上传</a></div><div class="complete" style="display: none;"><div class="fr button"><a href="javascript:;" class="btn btn_upload_complete ui_button">完成</a></div><div class="checkBox clearfix"><label class="clearfix"><input class="cbox" name="checkbox" type="checkbox"><p>关联目的地</p></label></div></div></div></div>',exClassName:"editor_uploadImage",width:622},editor:null,fileMap:{},curnum:0,init:function(t){return $.extend(this,t||{}),this.popup=new e($.extend(t,this.opt)),this.dom=this.popup.ui.$content.find(".qyEdit_append_pic"),this.MinimizeBar=new h,this.minimizeTipShow(),this},bindEvent:function(){var e=this;this.dom.off("click input"),this.dom.on("click",".close,.btn_upload_cancel",function(t){var n=this,i="您还有 "+e.leftCount()+"张图片正在上传中。";e.isComplete()?e.hide():s.confirm({down:!0,text:i,target:n,onOK:function(){for(var t in e.fileMap)$(e.fileMap[t]).trigger("filedestroy");e.hide()}})}),this.dom.on("click",".minimize",function(){e.popup.ui.$box.animate({top:30,opacity:0},200,function(){e.popup.ui.$ui.hide()}),e.MinimizeBar.show()}),$(e.MinimizeBar).on("reduction",function(){e.popup.ui.$ui.show(),e.popup.ui.$box.animate({top:0,opacity:1},200)}),this.dom.on("click",".btn_upload_complete",function(){var t,n,i=$(this);i.hasClass("ui_button")&&(e.hide(),t=e.dom.find(".cbox"),e.isComplete()&&t.prop("checked")===!0&&(n=_.map(e.fileMap,function(e,t){return{id:e.photo_id,key:e.key,src:e.url}}),$(e).trigger("showconcatpoi",n)))}),this.dom.on("click",".minimize_tip > em",function(){e.minimizeTipClose()})},minimizeTipShow:function(){if(localStorage&&null==localStorage.getItem("popup_minimize_tip")){var e='<span class="minimize_tip">点击最小化，边传图边写帖子吧~<em>&times;</em></span>';this.dom.find(".qyEdit_append_title").append(e).find(".minimize").removeClass("hvr")}},minimizeTipClose:function(){this.dom.find(".minimize").addClass("hvr").end().find(".minimize_tip").remove(),localStorage&&localStorage.setItem("popup_minimize_tip","1")},totalCount:function(){return _.size(this.fileMap)},doneCount:function(){return _.size(_.filter(_.pluck(this.fileMap,"status"),function(e){return"complete"===e}))},leftCount:function(){return this.totalCount()-this.doneCount()},isComplete:function(){return this.doneCount()===this.totalCount()},getAllNum:function(){var e=0;this.curnum=0;for(var t in this.fileMap)this.fileMap[t]&&("complete"==this.fileMap[t].status&&(this.curnum+=1),e++);return this.allnum=e,this.curnum+"/"+e},getFileForId:function(e){return this.fileMap[e]},setFileRotate:function(e,t){var n=this.getFileForId(e);n&&n.setRotate(t)},setFileStatus:function(e,t){var n=this.getFileForId(e.id);n&&($.extend(n,e),n.setStatus(t),this.curnum++,this.setUpNum())},setFileError:function(e,t){requirejs(["web_old_tip"],function(e){e.tip({text:t,type:"error"})})},setUploadComplete:function(){this.dom.find(".complete").show().end().find(".cancel").hide(),this.MinimizeBar.uploadComplete()},bindFileEvent:function(e){var t=this;$(e).on("filedestroy",function(){delete t.fileMap[this.id],$(t).trigger("removeupfile",this.id),g(this.photo_id),t.setUpNum(),void 0!=typeof t.allnum&&0==t.allnum&&(t.popup.hide(!0),$(".uploadPanel").hide())})},loadFiles:function(e,t){var n;this.curnum=0,this.fileMap={};for(var i,o=0;i=t[o++];)n=new l(i),n.domain=e,this.bindFileEvent(n),this.fileMap[i.id]=n;this.renderFiles()},renderFiles:function(){this.dom.find(".qyEdit_append_list ul").html("");for(var e in this.fileMap)this.dom.find(".qyEdit_append_list ul").append(this.fileMap[e].getDom())},setUpNum:function(){var e=this.getAllNum();this.dom.find(".tips .num").html(e),this.MinimizeBar.uploadProgress(this.curnum,this.totalCount())},uploadProgress:function(e){this.setFileRotate(e.id,e.percent)},show:function(){this.dom.find(".cbox").get("0").checked=!0,this.popup.show(),this.bindEvent()},hide:function(){this.popup.hide(!0),$(this).trigger("savealbumphoto")}},c.prototype={dom:null,domain:null,init:function(e){$.extend(this,e)},getHtml:function(){var e="string"==typeof this.url?this.url.replace("300x300",""):"";return'<li data-pid="'+this.id+'"><div class="x-ischecked unchecked" data-pid="'+this.id+'"></div><img width="100" height="100" alt="" src="'+e+'/120" onerror="javascript:this.src=\'//static.qyer.com/images/place/no/poi_150_150.jpg\'"><span class="status"></span><span class="place"><span style="position:relative;"><strong>'+(this.description||"")+'</strong><span class="con-des"></span></span></span></li>'},bindEvent:function(){var e=this;this.dom.on("click",function(t){var n=t||window.event;$(n.tareget||n.srcElement);e.dom.find(".x-ischecked").toggleClass("checked").toggleClass("unchecked"),e.dom.find(".status").toggle(),$(e).trigger("imgclick")}),this.dom.on("mouseenter",function(){!e.dom.find(".hasChecked").hasClass("checked")&&e.dom.find(".hasChecked").addClass("unchecked")}).on("mouseleave",function(){e.dom.find(".hasChecked").removeClass("unchecked")})},getDom:function(){return this.dom?this.dom:(this.dom=$(this.getHtml()),this.bindEvent(),this.dom)}},u.prototype={opt:{contentHTML:'<div class="qyEdit_append_pic clearfix"><div class="qyEdit_append_title clearfix"><strong class="text fontYaHei">关联目的地</strong><span class="x-contact-tips">点击选中要关联的图片</span><p class="place" id="contactPlaceCon"><i class="x-ao-dest x-ao-pos1"></i><input type="text" placeholder="添加目的地" value="" class="x-ui-input" /><span class="tText" style="display:none"><em class="x-ao-dest x-ao-pos2"></em>目的地名称须在20汉字以内</span></p><a href="javascript:;" title="关闭" class="close"></a></div><div class="qyEdit_append_wrap"><div class="qyEdit_append_list clearfix"><ul></ul></div></div><div class="qyEdit_append_button clearfix"><div class="fr button"><a href="javascript:;" class="ui_button">完成</a></div><div class="x-btl-wrap"><input type="checkbox" id="checkedXAll"/><label for="checkedXAll">全选</label>已关联至:&nbsp;&nbsp;<span id="checkedXNum">0</span>/<span id="allPhotoListLen"></span></div></div></div>',
exClassName:"editor_concatpoi",width:622},photoList:[],allcount:0,init:function(t){return $.extend(this,t||{}),this.popup=new e($.extend(t,this.opt)),this.dom=this.popup.ui.$content.find(".qyEdit_append_pic"),this},disabledFlag:!0,bindEvent:function(e){var t=this;this.dom.off("click"),requirejs(["web_old_inputautocomplete"],function(){t.dom.find(".x-ui-input").qyerAutocomplete({parent:$(".place"),onSearch:function(){var e=$(this).val();$.ajax({url:BBS_Url.searchphotopoi,type:"post",data:{keyword:e},success:function(n){var i,o,r=JSON.parse(n),a=r.data,s=[];if(a&&a.length>0){o=new RegExp(e,"ig"),s.push('<ul class="qui-inputAutocomplete-ul">');for(var l,d=0;l=a[d++];)i='<li data-pid="'+l.id+'" data-placetype="'+l.place_type+'" data-allname="'+l.cn_name+"&nbsp;&nbsp;"+l.last+'"><span class="poiname">'+l.cn_name.replace(o,'<a class="kw">'+e+"</a>")+'</span><span class="poiname">'+l.en_name.replace(o,'<a class="kw">'+e+"</a>")+'</span><span class="country">'+l.last+"</span></li>",s.push(i);s.push("</ul>"),t.dom.find(".x-ui-input").qyerAutocomplete("pushHTML",s.join(""))}else t.dom.find(".x-ui-input").qyerAutocomplete("pushHTML","")}})},onSelect:function(e){var n=$(e).attr("data-pid");t.pid=n,t.disabledFlag=!1;var i=$(".qyEdit_append_list .checked");$.each(i,function(n,i){$(i).removeClass("checked").removeClass("unchecked").addClass("hasChecked").attr("data-placeid",$(e).attr("data-pid")).attr("data-placetype",$(e).attr("data-placetype")).attr("title",$(e).attr("data-allname")).parent().find(".con-des").empty().html($(e).attr("data-allname")).parent().parent().fadeIn(),$(".x-ui-input").val("").blur(),t.selectedUpdateNum(),t.placeShow(),$("#checkedXAll")[0].checked=!1})}})}),this.dom.on("focus",".x-ui-input",function(){$(this).removeAttr("readonly").val("")}).on("blur",".x-ui-input",function(){$(this).attr("readonly","readonly"),t.disabledFlag?this.value="":t.disabledFlag=!0}),this.dom.on("click",".close",function(e){t.hide()}),this.dom.on("click",".ui_button_cancel",function(e){t.hide()}),this.dom.on("click",".ui_button",function(){var e=t.dom.find("[data-placeid]"),n=[];$.each(e,function(e,t){var i=$(t);n[e]={photoid:i.attr("data-pid"),type:i.attr("data-placetype"),placeid:i.attr("data-placeid")}}),n.length?$.ajax({url:BBS_Url.editPhotoPlace,type:"post",data:{photo:n},success:function(e){var n=JSON.parse(e);0==n.error_code?t.hide():requirejs(["web_old_tip"],function(e){e.tip({text:n.data.msg,type:"error"})})}}):t.hide()}),t.checkedXAll()},bindFileEvent:function(e){var t=this;$(e).on("imgclick",function(){t.togglePoi()})},getPhotos:function(e){var t=this,n=[];t.photoList=[];for(var i=0;i<e.length;i++)n.push(e[i].id);$.ajax({url:BBS_Url.getNewPhoto,data:{photoids:n.join(",")},success:function(e){var n,i=JSON.parse(e);if(0==i.error_code){t.allcount=i.data.count;for(var o,r=0;o=i.data.res[r++];)n=new c(o),t.bindFileEvent(n),t.photoList.push(n);t.renderHtml()}}})},getSelPohots:function(){var e=[],t=[];return this.dom.find("li").each(function(n,i){var o=$(i);o.find(".x-ischecked").hasClass("hasChecked")&&(e.push(o.attr("data-pid")),t.push(o.attr("data-xpid")))}),{phids:e.join(","),plids:t.join(",")}},togglePoi:function(){this.selectedUpdateNum(),this.placeShow()},placeShow:function(){$(".qyEdit_append_list .checked").length?$(".x-contact-tips").css("display","none").next().fadeIn(300):$(".x-contact-tips").fadeIn(300).next().css("display","none")},selectedUpdateNum:function(){$("#checkedXNum").html($(".qyEdit_append_list").find(".x-ischecked.hasChecked").length)},checkedXAll:function(){var e=$(".x-btl-wrap"),t=this;$("#checkedXAll").on("click",function(){var n=$(".qyEdit_append_list").find(".x-ischecked");e.find(":checked").length?n.addClass("checked").removeClass("unchecked"):(n.removeClass("checked"),!n.hasClass("hasChecked")&&n.addClass("unchecked")),t.selectedUpdateNum(),t.placeShow()})},renderHtml:function(){var e=this.dom.find(".qyEdit_append_list ul");e.html("");for(var t,n=0;t=this.photoList[n++];)e.append(t.getDom());$("#allPhotoListLen").html(this.photoList.length)},reset:function(){this.dom.find(".x-ui-input").val("");var e=this.dom.find(".qyEdit_append_list ul");e.html("")},show:function(){this.reset(),this.popup.show(),this.bindEvent()},hide:function(){this.popup.hide(!0)}},p.prototype={editor:null,dom:null,parms:{type:"json",page:1,size:20},defOpt:{showTitle:!1,showCancelBtn:!1,showOKBtn:!1,showCloseIcon:!1},editorui:baidu.editor.ui,init:function(e){$.extend(this,e||{})},getHtml:function(){return'<div class="image_cont clearfix"><div class="qui-select" id="photolist"   data-ui-width="133" ><strong class="titles" ><span class="title-text">相册加载中...</span></strong><div style="display: none;" class="contents"></div></div><div class="buttons" id="addPhotoWrap"><span class="uploadPanel"></span><a href="javascript:;" class="ui_button" id="addPhoto"><span class="add"></span>添加图片到本相册</a></div><div class="lists" style="max-height:'+this.getMaxHeight()+'px"><ul class="clearfix"></ul></div><div class="scrollTip"></div></div>'},getMaxHeight:function(){var e=$(".tool_right").length?$(".tool_right"):$(".senior_dlg_tools"),t=0,n=$(window).height();return t="absolute"===e.css("position")?n-(((e.offset()||{}).top||0)+60+100):n-(+e.css("top").replace("px","")+60+100)},getPhotoList:function(){var e=this;0==this.Load.status&&this.Load.render(this.dom.find(".lists")),this.Load.show(),$.ajax({url:BBS_Url.getMyAlbumList,method:"post",success:function(t){var t=JSON.parse(t);if(0==t.error_code){for(var n,i=t.data||[],o=[],r=0;r<i.length;r++)n=i[r],0==r&&(e.dom.find("#photolist").find(".title-text").text(n.name),e.parms.album=n.id,e.loadPhotos()),o.push('<li data-value="'+n.id+'"><a href="javascript:;">'+$("<div/>").html(n.name).text()+"</a></li>");o.push('<li data-value="-1"><a href="javascript:;" style="color:#02b052">+<span style="margin-left:3px;">创建新相册<span></a></li>'),e.dom.find("#photolist").find(".contents").html("<ul>"+o.join("")+"</ul>")}else e.dom.find("#photolist").find(".title-text").text("相册加载失败")}})},loadNext:function(){this.parms.page=this.parms.page+1,this.loadPhotos(!0)},loadPhotos:function(e){var t=this,n=e||!1;t.parms.timer=(new Date).getTime(),$.ajax({url:BBS_Url.getAlbumPhotoPage,method:"get",data:t.parms,success:function(e){if(e=JSON.parse(e),0==e.error_code){var i=e.data.res||[],o=[];if(t.Load.hide(),n===!1){t.dom.find(".lists ul").html("");for(var r=0;r<e.data.count-0;r++){i&&"undefined"==typeof i[r]&&(i[r]={url:"",id:""});var a="string"==typeof i[r].url?i[r].url.replace("300x300",""):"";o.push('<li data-src="'+a+'" data-pid="'+i[r].id+'" '+(i[r].size?'data-size="'+i[r].size+'"':"")+'><img title="点击图片插入到编辑器中" src="'+(a?a+"/120x120":"")+'" onerror="javascript:this.src=\'//static.qyer.com/images/place/no/poi_150_150.jpg\'" width="100" height="100" alt="" /></li>')}$(o.join("")).prependTo(t.dom.find(".lists ul"))}else{var s=t.dom.find(".lists ul li");i=i.reverse();var l=0,d=0;t.parms.page>s.length/t.parms.size?(l=s.length-1,d=s.length%t.parms.size):(l=t.parms.page*t.parms.size-1,d=t.parms.size);for(var r=l,c=0;(r>t.parms.size,c<d)&&s[r];r--,c++)i[c]&&i[c].size&&$(s[r]).attr("data-size",i[c].size),$(s[r]).attr("data-src",i[c].url).attr("data-pid",i[c].id),$(s[r]).find("img").attr("src",i[c].url+"/120x120")}t.parms.page<e.data.count/t.parms.size&&t.loadNext()}}})},bindEvent:function(){var e=this;e.editor.upImage={},requirejs(["web_qui_quiupload"],function(t){var n=[],i={},o="/photo.php?action=getUploadPhotoId&count=<%= count %>&album_id=<%= album_id %>",r=function(e){var t=i[e.id]||{};return t},a=function(e,t){var i=_.template(o)({count:e,album_id:t});return $.getJSON(i).then(function(e){return n=e.data})};e.upload=new t({browse_button:"addPhoto",container:"addPhotoWrap",filters:[{extensions:"jpg,jpeg,png"}],max_file_size:"20mb",multi_selection:!0,auto_start:!1,qyer_token_url:"/photo.php?action=token",token_format:function(e){return e.data.tk=e.data.token,e.data.domain="//pic.qyer.com",e},x_vars:{photo_id:function(e,t){return r(t).id.toString()},credit_jy:function(e,t){return((r(t).credit||{}).credit_jy||0).toString()},credit_qb:function(e,t){return((r(t).credit||{}).credit_qb||0).toString()},style:function(e,t){return"120x120"}},init:{FilesAdded:function(t,n){e.UploadImageDlg.dom.find(".qyEdit_append_list ul").html("<li style='font-size:14px'>图片加载中...</li>"),e.UploadImageDlg.show(),e.UploadImageDlg.albumid=e.parms.album,e.UploadImageDlg.MinimizeBar.uploadReady(),e.dom.find(".uploadPanel").show(),a(n.length,e.parms.album).then(function(o){_.each(o,function(e,t){i[n[t].id]=e,n[t].key=e.key,n[t].photo_id=e.id,n[t].url=e.url}),e.UploadImageDlg.dom.find(".qyEdit_append_list ul").html(""),e.UploadImageDlg.dom.find(".complete").hide(),e.UploadImageDlg.dom.find(".cancel").show(),e.UploadImageDlg.loadFiles(t.getOption("domain"),n)}).then(function(){e.UploadImageDlg.setUpNum(),t.start()})},BeforeUpload:function(e,t){t.timer=+new Date;var n={source:"bbs",label:"photoUploadStart",uid:window.QYER.uid,fileId:t.photo_id,fileSize:t.origSize,url:encodeURIComponent(t.url),time:t.timer,uploadTime:0};$.get("/qcross/photo/trace/tc",n)},UploadComplete:function(){e.UploadImageDlg&&e.UploadImageDlg.setUploadComplete()},UploadProgress:function(t,n){e.UploadImageDlg&&e.UploadImageDlg.setFileRotate(n.id,n.percent)},FileUploaded:function(t,n,i){e.UploadImageDlg&&e.UploadImageDlg.setFileStatus(n,"complete");var o={source:"bbs",label:"photoUploadEnd",uid:window.QYER.uid,fileId:n.photo_id,fileSize:n.origSize,url:encodeURIComponent(n.url),time:+new Date,uploadTime:new Date-n.timer};$.get("/qcross/photo/trace/tc",o)},Error:function(t,n,i){e.UploadImageDlg&&e.UploadImageDlg.setFileError(n,i)},Key:function(e,t){return r(t).key}}})}),$(e.UploadImageDlg).on("showconcatpoi",function(t){e.ConcatPoi.show();for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);e.ConcatPoi.getPhotos(n)}),$(this.UploadImageDlg).on("savealbumphoto",function(){e.parms.page=1,e.loadPhotos(),e.dom.find(".uploadPanel").hide()});var t=88,n=e.dom.find(".scrollTip");e.dom.find(".lists").on("scroll",function(){var i=$(this).scrollTop(),o=(e.parms.size/2*t*e.parms.page,parseInt(i/880));e.timer&&clearTimeout(e.timer),n.html(o*e.parms.size+1+"-"+(o+1)*e.parms.size),n.show(),e.timer=setTimeout(function(){n.hide()},3e3)}),$(window).on("scroll",function(){e.dom.find(".lists").css("max-height",e.getMaxHeight())})},bindImgEvent:function(){var e=this;e.dom.find("#photolist").data("_qyerSelect",null),e.dom.find("#photolist").qyerSelect({onBeforeChange:function(t){var n=$(t).attr("data-value");return"-1"==n?(e.createDialog||(e.createDialog=new i(e.defOpt),$(e.createDialog).on("createalbumsuccess",function(t){e.reset()})),e.createDialog.show(),!1):(e.parms.album=n,e.parms.page=1,e.loadPhotos(),void 0)}}),e.dom.on("click",".lists li",function(){var t=$(this),n=t.attr("data-size"),i=t.attr("data-pid"),o="/680x";return n&&(n=n.split(","),n.shift()<680&&(o="")),i?(e.editor.execCommand("insertimage",{src:t.attr("data-src")+o,_src:t.attr("data-src"),floatStyle:"left",id:i}),void $(document).trigger("x-editDomInsert")):void requirejs(["web_old_tip"],function(e){e.tip({text:"图片还未加载完成,请稍后在操作",type:"error"})})})},reset:function(){this.getPhotoList(),this.loadPhotos()},getDom:function(){var e=this;return this.dom||(this.dom=$(this.getHtml()),this.Load=new o,this.UploadImageDlg=new d(this.defOpt),$(this.UploadImageDlg).on("removeupfile",function(t,n){e.upload.uploader.removeFile(n)}),this.ConcatPoi=new u(this.defOpt),this.getPhotoList(),this.bindEvent()),this.bindImgEvent(),this.dom}},h.prototype={dom:null,init:function(e){$.extend(this,e),$("body").append(this.getDom()),this.bindEvent()},getDom:function(){return this.dom||(this.dom=$(this.getHtml())),this.dom},getHtml:function(){return'<div class="fixed_minimizebar"><div class="wrap"><p class="text">图片加载中...</p><a class="back btn-reduction" href="javascript:;"></a></div><span class="progress"></span></div>'},show:function(){$("body").css("padding-bottom",50),this.dom.fadeIn(300)},hide:function(){$("body").css("padding-bottom",0),this.dom.fadeOut(300)},bindEvent:function(){var e=this;this.dom.on("click",".btn-reduction",function(){e.hide(),$(e).trigger("reduction")})},uploadReady:function(){this.dom.removeClass("complete").hide().find(".text").html("图片加载中...").end().find(".progress").show().css({width:0})},uploadProgress:function(e,t){if(e>=t)this.uploadComplete();else{var n=[e,t].join("/");this.dom.find(".text").html('图片上传中：<em class="num">'+n+"</em>"),this.dom.find(".progress").css({width:e/t*100+"%"})}},uploadComplete:function(){this.dom.addClass("complete").find(".text").html("上传完成，请查看").end().find(".progress").hide()}},f.prototype={models:{},openModel:null,selClass:"selected",editor:null,editorui:baidu.editor.ui,target:"",defOpt:{showTitle:!1,showCancelBtn:!1,showOKBtn:!1,showCloseIcon:!1},init:function(e){$.extend(this,e),this.models.emotion=new a,this.models.lift=new r,this.models.image=new p,this.models.video=new t(this.defOpt),this.models.attach=new n(this.defOpt);for(var i in this.models)this.models[i].editor=this.editor;this.dom=$(this.target),this.render(),this.bindEvent()},bindEvent:function(){var e=this;this.tools.on("click",".tools-inner-wrap",function(){var t=$(this).attr("data-mode");switch(t){case"emotion":case"lift":case"image":e.selectTool(this),e.content.html(""),e.content.append(e.models[t].getDom(e.content));break;case"video":case"attach":e.models[t].editor=e.editor,e.models[t].show();break;case"help":v.slideToggle()}return!1}),this.isShowLift&&e.tools.find("[data-mode=lift]").trigger("click"),setInterval(function(){e.models.lift.reload()},6e4),$(this.models.lift).on("scrollview",function(t,n){var i=e.editor.document.getElementById(n);i&&domUtils.scrollToView(i,e.editor.window,50)})},getHtml:function(){return'<div class="tools clearfix"><div class="tools-inner-wrap" data-mode="lift"><span class="lift"><i></i></span><div class="x-tool-wrap"><div class="x-tool-left"></div><div class="x-tool-xtm">帖子电梯</div><div class="x-tool-right"></div></div></div><div class="tools-inner-wrap" data-mode="emotion"><span class="faces"><i></i></span><div class="x-tool-wrap"><div class="x-tool-left"></div><div class="x-tool-xtm">插入表情</div><div class="x-tool-right"></div></div></div><div class="tools-inner-wrap" data-mode="image"><span class="insertimage"><i></i></span><div class="x-tool-wrap"><div class="x-tool-left"></div><div class="x-tool-xtm">插入图片</div><div class="x-tool-right"></div></div></div><div class="tools-inner-wrap" data-mode="video"><span class="insertvideo"></span><div class="x-tool-wrap"><div class="x-tool-left"></div><div class="x-tool-xtm">插入视频</div><div class="x-tool-right"></div></div></div><div class="tools-inner-wrap" data-mode="attach"><span class="insertattach"></span><div class="x-tool-wrap"><div class="x-tool-left"></div><div class="x-tool-xtm">插入附件</div><div class="x-tool-right"></div></div></div><div class="tools-inner-wrap" data-mode="help"><span class="help"></span><div class="x-tool-wrap"><div class="x-tool-left"></div><div class="x-tool-xtm">发帖帮助</div><div class="x-tool-right"></div></div></div></div><div class="tool_content"></div>'},selectTool:function(e){this.tools.find(".tools-inner-wrap").removeClass(this.selClass),$(e).addClass(this.selClass)},render:function(){this.dom.html(this.getHtml()),this.tools=this.dom.find(".tools"),this.content=this.dom.find(".tool_content")}},f}),define("common/models/basic/js/require-css!old/css/bbs_normal_editor",[],function(){}),define("common/models/basic/js/require-css!web_old_popup",[],function(){}),define("web_old_popup",["css!web_old_popup"],function(){var e=jQuery,t={$ui:null,$content:null,$box:null,$title:null,$okBtn:null,$cancelBtn:null,$loadBtn:null,$closeIcon:null,$bottomBtns:null,_uiState:"normal",defaultWidth:400,init:function(){var t=['<div class="qui-popup" style="display:none">',"<div>",'<div class="qui-popup-dt">','<div class="qui-popup-box">','<div class="qui-popup-closeIcon">&nbsp;</div>','<div class="qui-popup-box-title fontYaHei">title</div>','<div class="qui-popup-box-content">',"</div>",'<div class="qui-popup-box-bottom">',"&nbsp;",'<input class="qui-popup-cancelBtn ui_button_cancel" type="button" value="取消" />  ','<input class="qui-popup-okBtn ui_button" type="button" value="确定" />  ','<input class="qui-popup-loadingBtn  ui_button_load" type="button" value="" />  ',"</div>","</div>","</div>","</div>","</div>"].join("");this.$ui=e(t),this.$content=this.$ui.find(".qui-popup-box-content"),this.$box=this.$ui.find(".qui-popup-box"),this.$title=this.$ui.find(".qui-popup-box-title"),this.$okBtn=this.$ui.find(".qui-popup-okBtn"),this.$cancelBtn=this.$ui.find(".qui-popup-cancelBtn"),this.$loadBtn=this.$ui.find(".qui-popup-loadingBtn"),this.$closeIcon=this.$ui.find(".qui-popup-closeIcon"),this.$bottomBtns=this.$ui.find(".qui-popup-box-bottom"),this.$ui.appendTo(document.body)},setWidth:function(e){this.$box.animate({width:e},300)},setUIDefault:function(e){this.$ui[0].className="qui-popup",e.exClassName&&this.$ui.addClass(e.exClassName),e.iframeSrc?this.$content.html('<iframe src="'+e.iframeSrc+'"  scrolling="auto" style="height:'+(e.iframeHeight||300)+'px;"  />'):this.$content.html(e.contentHTML||"&nbsp;"),this.$title.html(e.title||"Title"),this.$box.css("width",e.width||this.defaultWidth),this.$title[e.showTitle===!1?"hide":"show"](),this.$okBtn.val(e.okText||"确定"),this.$cancelBtn.val(e.cancelText||"取消"),e.showBottomBtns===!1&&this.$bottomBtns.hide(),this.$okBtn[e.showOKBtn===!1?"hide":"show"](),this.$okBtn.removeAttr("data-bn-ipg"),this.$cancelBtn[e.showCancelBtn===!1?"hide":"show"](),this.$cancelBtn.removeAttr("data-bn-ipg"),this.$loadBtn[e.showLoadBtn===!0?"show":"hide"](),this.$loadBtn.removeAttr("data-bn-ipg"),this.$ui.find(".qui-popup-closeIcon").removeAttr("data-bn-ipg"),this.$closeIcon[e.showCloseIcon===!1?"hide":"show"]()},show:function(n){if("hideing"==t._uiState)t.$box.stop(),t.$ui.stop(),this.$ui.css({display:"block",opacity:1}),this.$box.css({top:0,opacity:1}),t._uiState="normal",n.onShow&&n.onShow();else{t._uiState="showing";var i={},o={top:0};e.support.leadingWhitespace&&(i.opacity=1,o.opacity=1),this.$ui.css("display","block").animate(i,200,function(){t.$box.css("top",-30).animate(o,200,function(){t._uiState="normal",n.onShow&&n.onShow()})})}},hide:function(n){if(!n||!n.onBeforeHide||n.onBeforeHide()!==!1){t._uiState="hideing";var i={top:-30},o={};e.support.leadingWhitespace&&(i.opacity=0,o.opacity=0),this.$box.animate(i,200,function(){t.$ui.animate(o,200,function(){t._uiState="normal",t.$ui.css("display","none"),t.$content.html(""),n&&n.onAfterHide&&n.onAfterHide()})})}}};t.init();var n=null,i={show:function(e){return n=e,t.setUIDefault(e),t.$ui.undelegate("click").delegate(".qui-popup-okBtn,.qui-popup-cancelBtn,.qui-popup-closeIcon","click",function(n){if(-1!=this.className.indexOf("qui-popup-closeIcon")||-1!=this.className.indexOf("qui-popup-cancelBtn")){if(e.onBeforeCancel&&!e.onBeforeCancel(n))return;e.onCancel&&e.onCancel()}else if(-1!=this.className.indexOf("qui-popup-okBtn")&&e.onOK&&e.onOK()===!1)return;t.hide(e)}),t.show(e),this},hide:function(){return t.hide(),this},setContent:function(e){return t.$content.html(e),this},getContent:function(){return t.$content[0]},getButtons:function(){return{okBtn:t.$okBtn[0],cancelBtn:t.$cancelBtn[0],loadBtn:t.$loadBtn[0],closeIcon:t.$ui.find(".qui-popup-closeIcon")[0]}},setOption:function(i){var o={width:function(){t.setWidth(i.width)},showTitle:function(){i.showTitle===!1?t.$title.hide():t.$title.show()},showBottomBtns:function(){i.showBottomBtns===!1?t.$bottomBtns.hide():t.$bottomBtns.show()},okText:function(){t.$okBtn.val(i.okText)},cancelText:function(){t.$cancelBtn.val(i.cancelText)},showOKBtn:function(){i.showOKBtn===!1?t.$okBtn.hide():t.$okBtn.show()},showCancelBtn:function(){i.showCancelBtn===!1?t.$cancelBtn.hide():t.$cancelBtn.show()},showLoadBtn:function(){i.showLoadBtn===!1?t.$loadBtn.hide():t.$loadBtn.show()},showCloseIcon:function(){i.showCloseIcon===!1?t.$closeIcon.hide():t.$closeIcon.show()},title:function(){t.$title.html(i.title)},exClassName:function(){t.$ui[0].className="qui-popup "+i.exClassName},contentHTML:function(){i.iframeSrc||t.$content.html(i.contentHTML)},iframeSrc:function(){t.$content.html('<iframe src="'+i.iframeSrc+'"  scrolling="auto" style="height:'+(i.iframeHeight||300)+'px;" />')},iframeHeight:function(){t.$content.children("iframe").css("height",i.iframeHeight)}};for(var r in i)n[r]=i[r],"function"==e.type(o[r])&&o[r]()}};return i}),define("old/js/bbs_normal_editor",["old/js/bbs_video","old/js/bbs_attach","old/js/senior_tool","css!old/css/bbs_normal_editor.css"],function(e,t,n){function i(e){this.init(e)}function o(e){this.init(e)}function r(e){this.init(e)}var a=baidu.editor.ui.uiUtils;return i.prototype={editor:null,init:function(e){return $.extend(this,e||{}),this.dom=$(this.getHtml()),$("body").append(this.dom),this.bindEvent(),this.hide(),this},getHtml:function(){var e='<span style="margin-left:20px;white-space:nowrap;">返回普通模式</span>',t="",n="";return"bottom"===this.where&&(e='<span class="saveback">保存并返回</span>',t='<span class="savetip"></span>',n='<span class="saveinfo"><span class="stats"></span><a href="javascript:void(0)" class="btn">保存草稿</a></span>'),'<div class="senior_dlg_head"><div class="senior_dlg_head_content"><span class="senior_dlg_close '+this.where+'" title="">'+e+"</span>"+t+'<a class="senior_dlg_pub" href="javascript:void(0)">发布</a>'+n+"</div></div>"},bindEvent:function(){var e=this;this.dom.on("click",".senior_dlg_close",function(){if("bottom"===e.where){var t=$(".senior_dlg_head .savetip");t.fadeIn(300),e.editor.getContent()?window.replyDraft&&window.replyDraft.saveManu($(".saveinfo .stats")).done(function(){t.html("保存成功").fadeOut(1e3,function(){e.target&&$(e.target).hide(),e.editor.ui.setFullScreen(!1),window.replyDraft.clearDraftTimer(),location.reload()})}).fail(function(e){e=e||"保存失败",t.html(e)}):($(".senior_dlg_head .savetip").hide(),e.target&&$(e.target).hide(),e.editor.ui.setFullScreen(!1),location.reload())}else e.editor.ui.setFullScreen(!1)}),this.dom.on("click",".senior_dlg_pub",function(){e.editor.options.isSubmit=!0,e.editor.fireEvent("postreply")}),this.editor.addListener("fullscreenchanged",function(){1==this.ui._fullscreen?e.show():e.hide()})},show:function(){this.dom.show()},hide:function(){this.dom.hide()}},o.prototype={editor:null,className:"senior_dlg_tools",init:function(e){return $.extend(this,e||{}),this.dom=$(this.getHtml()),$("body").append(this.dom),this.initTools(),this.hide(),this.bindEvent(),this},bindEvent:function(){var e=this;this.editor.addListener("fullscreenchanged",function(){1==this.ui._fullscreen?e.show():e.hide()})},initTools:function(){this.toolContent=new n({target:this.dom,editor:this.editor})},getHtml:function(){return'<div class="'+this.className+'"></div>'},show:function(){this.dom.show()},hide:function(){this.dom.hide()}},r.prototype={target:null,id:"",tools:[],hasSenior:!1,where:"floor",topOffset:100,html:'<div class="bbs_simple_editor"><div id="##_editor" ></div><div id="##_foot" class="bbs_simple_foot">__tools__</div></div><div id="##_Btn" class="bbs_simple_Btn"><div class="btns"><span class="cancel fontSong disable">取消</span><input type="button" value="发布" class="ui_btn_small"></div></div>',maxWord:1e5,editorOpt:{initialFrameHeight:320,zIndex:900},toolMap:{image:{classname:"insertimage",label:"插入图片"},video:{classname:"insertvideo",label:"插入视频"},attach:{classname:"insertattach",label:"插入附件"},faces:{classname:"faces",label:"插入表情"}},init:function(e){$.extend(this,e),this.dom=$(this.target),this.dom.html(this.getHtml()),this.initEditor(),1==this.hasSenior&&(this.initSeniorHead(),this.initSeniorTool()),this.bindEvent(),this.toggleErrorTip(!1)},initTools:function(){for(var e,t=0;e=this.tools[t++];)this["init"+e.replace(/\b(\w)(\w*)/g,function(e,t,n){return t.toUpperCase()+n.toLowerCase()})].call(this)},getTools:function(){for(var e,t=[],n=0;e=this.tools[n++];)t.push('<a href="javascript:;" class="'+this.toolMap[e].classname+'">'+this.toolMap[e].label+'<div class="x-tooln-wrap"><div class="x-tooln-top"></div><div class="x-tooln-xtm">'+this.toolMap[e].label+'</div><div class="x-tooln-bottom"></div></div></a>');return 1==this.hasSenior&&t.push('<a href="javascript:;" title="进入写作模式编辑" class="senior"><i></i>切换到写作模式</a>'),t.join("")},initVideo:function(){this.VideoDlg=new e({editor:this.editor})},initAttach:function(){this.AttachDlg=new t({editor:this.editor})},initFaces:function(){var e=new baidu.editor.ui.QyerEmotion({content:"",editor:this.editor});e.render(),this.dom.find(".faces").on("click",function(){var t=a.getClientRect(this);e.showAt({left:t.left-16,top:t.top+31})})},initImage:function(){this.imgPopup=new baidu.editor.ui.QyerImgPopup({targetDom:this.dom.find(".insertimage"),content:"",editor:this.editor}),this.imgPopup.render()},bindEvent:function(){var e=this;this.dom.on("click",".insertvideo",function(){e.initVideo(),e.VideoDlg.show()}),this.dom.on("click",".insertattach",function(){e.AttachDlg.show()}),this.dom.on("click",".senior",function(){e.showSenior()}),this.dom.on("click",".btns input",function(){e.editor.options.isSubmit=!0;var t=e.getContent();t=baidu.editor.utils.trim(t);var n=t.replace(/\<img\s+class=\"\s*phimage\"[\s\S]*\/\>/gi,""),i=$(n).find("[data-type=attach]").map(function(e,t){return $(t).attr("data-key")||$(t).attr("data-id")}).toArray();n.length>0&&(e.isPopupReply?e.onPostReply.call(e,n,i):$(e).trigger("sendsubmit",{content:n,attachment:i}))}),this.dom.on("click",".btns .cancel",function(){var t=e.editor.getContentLength(!0);e.isPopupReply?e.onPopupEditorCancel&&e.onPopupEditorCancel():t>0?requirejs(["web_old_popup"],function(t){t.show({title:"取消",contentHTML:"确认取消操作？",onOK:function(){e.editor.options.isSubmit=!1,$(e).trigger("sendcancel",e.getContent())}})}):$(e).trigger("sendcancel",e.getContent())}),this.editor.addListener("postreply",function(){e.onPostReply.call(this)})},onPostReply:function(){},showSenior:function(e){this.editor.setOpt("topOffset",this.topOffset),this.editor.ui.setFullScreen(!0)},initSeniorHead:function(){this.seniorHead||(this.seniorHead=new i({editor:this.editor,target:this.target,where:this.where}))},initSeniorTool:function(){this.seniorTool||(this.seniorTool=new o({editor:this.editor}))},initEditor:function(){var e=this;this.editor=UE.getEditor(this.id+"_editor",$.extend({theme:"simple",initialContent:this.initialContent,pasteplain:!0,initialStyle:"body{padding:0 5px;}",focusInEnd:!0,focus:!0,toolbars:[["stylecontrol","bbs_common"]]},this.editorOpt)),this.editor.addListener("fullscreenchanged",function(){var t=e.editor;if(t.ui._fullscreen){var n=a.getViewportRect();e.bodyPadding=$(t.document.body).css("padding"),$(t.document.body).css("padding","0 "+(n.width-600)/2+"px"),$.extend(!0,this.options,{bbs_font:!0}),t.reset()}else $(t.document.body).css("padding",e.bodyPadding),$.extend(!0,this.options,{bbs_font:!1}),t.focus(!0),t.reset()}),this.editor.addListener("ready",function(){e.initTools()})},toggleErrorTip:function(e){1==e?this.dom.find(".status").show():this.dom.find(".status").hide()},getHtml:function(){var e=this.html.replace(/##/gi,this.id);return e=e.replace(/__tools__/,this.getTools())},setContent:function(e){var t=this;t.editor.ready(function(){t.editor.setContent(e),t.editor.focus(!0)})},clearInsert:function(){const e=$("div[id^='edui']").find("iframe")||[];if(e.length)for(var t=0;t<e.length;t++){var n=$(e[t]).contents().find("embed[id^='xunlei_com_thunder']");n&&n.remove()}},getContent:function(){this.clearInsert();var e=$("<div/>").html(this.editor.getContent());return $.each(e.find(".qyer_image"),function(e,t){$(t).replaceWith("<span data-type='photo' data-id='"+$(t).attr("data-id")+"'></span>")}),e.html()}},r}),define("common/models/basic/js/require-css!web_old_loading",[],function(){}),define("web_old_loading",["css!web_old_loading"],function(){function e(e){n.find(".qui-loading-text").html(e.text||"loading ...")}var t=jQuery,n=null;!function(){var e=['<div class="qui-loading" style="display:none">',"<div>",'<div class="qui-loading-box">','<span class="qui-loading-text">loading ...</span>',"</div>","</div>","</div>"].join("");n=t(e),n.appendTo(document.body)}();var i={show:function(i,o){e(i);var r=t.support.leadingWhitespace?{opacity:1}:{};return n.css("display","table").animate(r,300,function(){o&&o()}),this},hide:function(e){var i=t.support.leadingWhitespace?{opacity:0}:{};return n.animate(i,300,function(){n.css("display","none",function(){e&&e()})}),this},setUI:function(t){return e(t),this}};return i}),define("web_ct_submitBeforeValidCode",["web_old_popup2","web_old_tip"],function(e,t){var n=window.__needVerifyImage||0;return function(i){1==n?new e({title:"请输入验证码",contentHTML:function(){return['<input id="js_valid_code_input" type="text" placeholder="请输入验证码" style="border:solid 1px rgb(204, 204, 204); padding:3px; border-radius:3px; margin-left:10px; vertical-align:8px;" />','<img id="js_valid_code_img" src="/ajax.php?action=captcha" onclick=\'this.src="/ajax.php?action=captcha&timer="+((new Date()).getTime())+(window.QYER&&window.QYER.uid?("&uid="+window.QYER.uid):"")\' />'].join("")}(),onOK:function(){var e=document.getElementById("js_valid_code_input").value;return e?void(i&&i.call(null,e)):(t.tip({text:"请输入验证码",type:"warning"}),!1)}}).show():i&&i(null,!1)}}),define("common/models/common/component/report/report",["common/models/common/ui/popup/popup","common/models/common/ui/tip/tip"],function(e,t){var n={};return n.options={url:null,id:0,reason:"",reason_other:""},n.doReport=function(e){return e.posturl="/api.php?action=jubao",window.qyerUtil.doAjax(e)},n.init=function(e){return qyerUtil.isLogin()?($.extend(n.options,e),void this.show.call(this)):void qyerUtil.doLogin()},n.show=function(){e.show({title:"举报",okText:"举报",contentHTML:["<style>.qui-report input,.qui-report label{vertical-align:middle;margin-right:5px;}</style>",'<div class="qui-report">举报原因&nbsp;&nbsp','<input id="qui-report-radio1" type="radio" name="reason" value="广告">','<label for="qui-report-radio1">广告</label>&nbsp;&nbsp','<input id="qui-report-radio2" type="radio" name="reason" value="灌水">','<label for="qui-report-radio2">灌水</label>&nbsp;&nbsp','<input id="qui-report-radio3" type="radio" name="reason" value="色情污秽">','<label for="qui-report-radio3">色情污秽</label>&nbsp;&nbsp','<input id="qui-report-radio4" name="reason" type="radio" value="危害国家安全">','<label for="qui-report-radio4">危害国家安全</label>&nbsp;&nbsp','<input id="qui-report-radio5" name="reason" type="radio" value="其他">','<label for="qui-report-radio5">其他</label>',"</div>",'<div style="margin-top:10px;">','<input type="text" name="reason_other" class="ui2_input" style="width:380px;" placeholder="详细的说明会帮助我们更快的处理举报内容" value="">',"</div>"].join(""),width:450,onOK:function(){var i=e.getContent();if(0==$(i).find("input[type=radio]:checked").length)return t.tip({text:"选择分类",type:"warning"}),!1;if($(i).find("input[type=text]").val().length>300)return t.tip({text:"输入详细说明不能大于300字",type:"warning"}),!1;n.options.url=location.href,n.options.reason=$(i).find("input[type=radio]:checked").val(),n.options.reason_other=$(i).find("input[type=text]").val();var o={data:n.options,onSuccess:function(e){t.tip({text:"举报成功"})},onError:function(e){return t.tip({text:data.data.msg,type:"error"}),!1}};n.doReport(o)}})},n});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("assets/issue/draft/draftFactory",[],function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"loadDraft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.okText,n=void 0===t?"继续写草稿":t,i=e.cancelText,o=void 0===i?"删除草稿写新帖":i,r=e.count,a=void 0===r?3:r,s=e.statusDom,l=void 0===s?$(".qy_issue_mask .text"):s,d=e.deleteHandler,c=void 0===d?function(){}:d,u=e.mode,p=void 0===u?"pub":u,h=e.saveBtn,f=void 0===h?$(".saveBtns .save"):h,m=e.saveBackBtn,g=void 0===m?$(".save-back"):m,b=e.delayRead,v=void 0!==b&&b,y=this.genDraft(p);
return y.beforeunload(),!v&&y.read({okText:n,cancelText:o,count:a,statusDom:l,deleteHandler:c}),y.bindEvent(f,g),y}},{key:"genDraft",value:function(){throw new Error("Unsupported opteration on an abstract class.")}}]),e}();return{DraftFactory:e}}),define("assets/issue/constant",[],function(){var e=window.__pageData__,t=0,n=0,i=0,o="",r=0,a=0,s=0;return e&&(i=+e.threadType[0],o=e.threadType[1],n=e.tid,r=e.plan_id,e.forumInfo&&(t=+e.forumInfo.id)),window.BBS&&window.BBS.TID&&!+n&&(n=window.BBS.TID),window.QYER&&window.QYER.uid&&(a=window.QYER.uid),window.BBS&&+window.BBS.ISWRITER&&(s=+window.BBS.ISWRITER),{fid:t,threadType:i,threadTypeName:o,tid:n,planId:r,uid:a,isWriter:s}}),define("common/models/basic/js/require-css!web_old_confirm",[],function(){}),define("web_old_confirm",["css!web_old_confirm"],function(){var e=jQuery,t={$ui:null,$box:null,$icon:null,$title:null,$text:null,init:function(){var n=['<div class="qui-confirm">',"<div>",'<div class="qui-confirm-box">','<div class="qui-confirm-box-title">',"title","</div>",'<div class="qui-confirm-box-content">','<div class="qui-confirm-box-content-icon"></div>','<div class="qui-confirm-box-content-text">',"提示文字","</div>",'<div class="qui-confirm-box-clearFloat">&nbsp;</div>',"</div>",'<div class="qui-confirm-box-bottom">','<input class="qui-confirm-okBtn ui_btn_small" type="button" value="确定" />  ','<input class="qui-confirm-cancelBtn ui_btn_small_cancel" type="button" value="取消" />  ',"</div>",'<div class="qui-confirm-closeIcon">&nbsp;</div>',"</div>","</div>","</div>"].join("");this.$ui=e(n),this.$box=t.$ui.find(".qui-confirm-box"),this.$title=t.$ui.find(".qui-confirm-box-title"),this.$icon=t.$ui.find(".qui-confirm-box-content-icon"),this.$text=t.$ui.find(".qui-confirm-box-content-text"),this.$ui.appendTo(document.body)},setUI:function(e){this.$text.html(e.text||""),this.$title.html(e.title||"提示"),this.$icon[0].className="qui-confirm-box-content-icon",this.$icon.addClass("ok"==e.type?"qui-confirm-box-content-iconOK":"error"==e.type?"qui-confirm-box-content-iconError":("warning"==e.type,"qui-confirm-box-content-iconWarning"))},show:function(){var n={},i={top:0};e.support.leadingWhitespace&&(n.opacity=1,i.opacity=1),this.$ui.css("display","table").animate(n,300,function(){t.$box.animate(i,200)})},hide:function(){var n={top:-30},i={};e.support.leadingWhitespace&&(n.opacity=0,i.opacity=0),this.$box.animate(n,200,function(){t.$ui.animate(i,300,function(){t.$ui.css("display","none")})})}};t.init();var n={confirm:function(e){return t.setUI(e),t.$ui.undelegate("click").delegate(".qui-confirm-okBtn,.qui-confirm-cancelBtn,.qui-confirm-closeIcon","click",function(n){-1!=this.className.indexOf("qui-confirm-closeIcon")||-1!=this.className.indexOf("qui-confirm-cancelBtn")?e.onCancel&&e.onCancel(n):-1!=this.className.indexOf("qui-confirm-okBtn")&&e.onOK&&e.onOK(n),t.hide()}),t.show(),this}};return n}),define("common/models/common/component/planItinerary/index",[],function(){function e(e){this.option=e,this.init()}var t,n=jQuery;e.prototype={option:null,init:function(){this.loadModels()},unInit:function(){for(var e in this)this[e]=null;t=null},loadModels:function(){n("#__planItinerary__").html('<div style="border:solid 1px #ccc;width:auto;text-align:center;font-size:16px;color:#aaa;background-color:#fff;height:40px;line-height:40px;">loading...</div>'),this.option.isNew&&n("#__planItinerary__").attr("data-isnew","true");var e=["common/models/common/component/planItinerary/tpl","common/models/common/component/planItinerary/dataAPI","common/models/common/component/planItinerary/message","common/models/common/component/planItinerary/model","css!common/models/common/component/planItinerary/planItinerary.css","common/models/common/ui/popup/popup","common/models/common/ui/tip/tip"];"browse"==this.option.action||"empty"==this.option.action?e.push("common/models/common/component/planItinerary/browser"):"add"!=this.option.action&&"edit"!=this.option.action&&"guidance"!=this.option.action||(e.push("common/models/common/component/planItinerary/model_city"),e.push("common/models/common/component/planItinerary/model_hotel"),e.push("common/models/common/component/planItinerary/model_poi"),e.push("common/models/common/component/planItinerary/model_traffic"),e.push("common/models/common/component/planItinerary/frame"),e.push("common/models/common/ui/datepicker/datepicker"),e.push("common/models/common/ui/select/select"),e.push("common/models/common/ui/inputValidation/inputValidation"),e.push("common/models/common/ui/slidConfirm/slidConfirm"),e.push("common/models/common/ui/confirm/confirm"),e.push("common/models/common/ui/inputAutocomplete/inputAutocomplete"),e.push("css!common/models/common/component/planItinerary/model.css")),requirejs(e,function(){e.length=0,e=null,requirejs(["common/models/common/component/planItinerary/message","common/models/common/component/planItinerary/dataAPI"],function(e,n){n._planid=t.option.planid,n._initAction=t.option.action,n._createUrl=t.option.createUrl,n._tid=t.option.tid,n._topicType=t.option.topicType||1,n._disableCell=t.option.disableCell||{},e.postMessage(e.msg.onBasicModelLoaded)})})}};var i={init:function(n){t&&t.unInit(),t=new e(n)}};return i}),define("old/js/bbs_title",[],function(){({init:function(){this.dom=$(".title"),this.ipt=this.dom.find("textarea"),this.tip=this.dom.find(".info"),this.tempTad=$(".template-textarea"),this.placeholderspan=$(".thread-title-placeholder"),this.tempTad.width(this.ipt.width()),this.bindEvent()},setTipError:function(e){1==e?this.tip.show():this.tip.hide()},bindEvent:function(){var e=this;e.placeholderspan.on("click",function(){e.ipt.focus()}),this.ipt.on("blur",function(){var t=this.value;return 0==t.length?void e.placeholderspan.css("display","block"):t.length>60?void e.setTipError(!0):void 0}).on("keydown",function(t){var n=t.which||t.keyCode||t.charCode;if(e.placeholderspan.css("display","none"),13===n)return t.preventDefault?t.preventDefault():window.event.returnValue=!1,!1}).on("keyup",function(t){var n=(t.which||t.keyCode||t.charCode,this.value);!$.trim(n)&&e.placeholderspan.css("display","block"),n.length>60?e.setTipError(!0):e.setTipError(!1),e.tempTad.html(n),$(this).height(e.tempTad.height()||"40")})}}).init(),$.trim($("#threadTitle").val())&&$(".thread-title-placeholder").css("display","none")}),define("assets/issue/components",["assets/issue/constant"],function(e){var t=function(){},n=e.uid?'<a class="lookmore" href="//www.qyer.com/u/'+e.uid+'/travel#draft" target="_blank">查看全部草稿</a>':"",i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.exClassName,o=void 0===i?"x-draft-popup":i,r=e.title,a=void 0===r?"你有一份草稿"+n:r,s=e.name,l=void 0===s?"":s,d=e.date,c=void 0===d?"":d,u=e.okText,p=void 0===u?"继续写草稿":u,h=e.width,f=void 0===h?"478":h,m=e.cancelText,g=void 0===m?"删除草稿写新帖":m,b=e.showCloseIcon,v=void 0!==b&&b,y=e.contentSubstr,x=void 0===y?"":y,_=e.contentHTML,w=void 0===_?"<h3 class='x-draftp-title'>["+l+"]"+c+"</h3><p class='x-draftp-content'>"+x+"</p>":_,k=e.onBeforeHide,C=void 0===k?t:k,E=e.onOK,T=void 0===E?t:E,S=e.onCancel,N=void 0===S?t:S;requirejs(["web_old_popup"],function(e){e.show({exClassName:o,title:a,name:l,date:c,okText:p,width:f,cancelText:g,showCloseIcon:v,contentHTML:w,onBeforeHide:C,onOK:T,onCancel:N})})},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.title,i=void 0===n?"确认删除":n,o=e.text,r=void 0===o?"确定要永久删除这份草稿吗？":o,a=e.exClassName,s=void 0===a?"x-draft-confirm":a,l=e.okText,d=void 0===l?"确认删除":l,c=e.onOK,u=void 0===c?t:c,p=e.onCancel,h=void 0===p?t:p;requirejs(["web_old_confirm"],function(e){e.confirm({title:i,text:r,exClassName:s,okText:d,onOK:u,onCancel:h})})},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.text,n=void 0===t?"请登录":t,i=e.type,o=void 0===i?"warning":i,r=e.timer,a=void 0===r?2e3:r;require(["web_old_tip"],function(e){e.tip({text:n,type:o,timer:a})})},a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.parent,o=n.onSearch,r=void 0===o?t:o,a=n.onSelect,s=void 0===a?t:a;requirejs(["web_old_inputautocomplete"],function(){e.qyerAutocomplete({parent:i,onSearch:r,onSelect:s})})},s=function(){var e=$.Deferred();return requirejs(["common/models/common/component/planItinerary/dataAPI"],function(t){e.resolve(t)}),e.promise()},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{disableCell:{traffic:!0}},t=e.action,n=void 0===t?"guidance":t,i=e.topicType,o=e.disableCell,r=e.tid,a=e.planid,s=$.Deferred();return requirejs(["common/models/common/component/planItinerary/index"],function(e){var t={action:n,topicType:i,disableCell:o};r&&(t.tid=r),a&&(t.planid=a),e.init(t),s.resolve()}),s.promise()},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.text,n=void 0===t?"正在发布中，请稍候...":t,i=$.Deferred();return requirejs(["web_old_loading"],function(e){e.show({text:n}),i.resolve(e)}),i.promise()},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".tool_right",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=$.Deferred();return e?requirejs(["old/js/senior_tool"],function(o){return i.resolve(new o({target:t,editor:e,isShowLift:n}))}):i.reject(),i.promise()},u=function(){requirejs(["old/js/bbs_title"])};return{loadPopup:i,loadConfirm:o,loadTip:r,loadSearch:a,Plan:s,loadPlan:l,loading:d,loadToolContent:c,loadTitle:u}}),define("assets/issue/util",[],function(){var e=function(){return(new Date).getTime()},t=function(e){return e.replace(/<\/?[^>]*>/g,"").replace(/[ | ]*\n/g,"\n").replace(/\n[\s| | ]*\r/g,"\n").replace(/&nbsp;/gi,"")},n=function(e,t){return function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.apply(t,i)}},i=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,n="visible",i="hidden",o={focus:n,focusin:n,focusout:i,pageshow:n,pagehide:i};e.type in o?document.body.className=o[e.type]:document.body.className=this[t]?"hidden":"visible",~document.body.className.indexOf("hidden")?$(document).trigger("winunactived"):$(document).trigger("winactived")}var t="hidden";t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e},o=function(e){var t="";"number"==typeof+e&&(e=new Date((+e)));var n=function(e){return e>9?e:"0"+e};if("[object Date]"===Object.prototype.toString.call(e)){var i=e.getMonth()+1,o=e.getDate(),r=e.getHours(),a=e.getMinutes();t=e.getFullYear()+"-"+n(i)+"-"+n(o)+" "+n(r)+":"+n(a)}return t},r=function(e,t,n){var i=n,o=0;for(null==i&&(i=e[0],o=1);o<e.length;o++)i=t(i,e[o],o);return i},a=function(e,t){return r(e,function(e,n,i){return e.push(t(n,i)),e},[])},s=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"name",t=arguments[1],n=[],i={},o=!0,r=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var d=s.value;i[d[e]]||(n.push(d),i[d[e]]=!0)}}catch(c){r=!0,a=c}finally{try{!o&&l["return"]&&l["return"]()}finally{if(r)throw a}}return n},d=function(e){if("function"==typeof Set)return[].concat(_toConsumableArray(new Set(e)));var t={},n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var l=a.value;t[l]||(n.push(l),t[l]=!0)}}catch(d){o=!0,r=d}finally{try{!i&&s["return"]&&s["return"]()}finally{if(o)throw r}}return n};return{now:e,removeHtmlTag:t,bind:n,windowActive:i,dateParse:o,reduce:r,map:a,includes:s,distinctJson:l,distinctAry:d}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("assets/issue/draft/draft",["assets/issue/components","assets/issue/util"],function(e,t){var n=function(){function n(){_classCallCheck(this,n),this.isSaveProcess=!1,this.hasDraftUnsave=!1,this.loadDraftTime=0,this.loadDraftCount=3,this.token="",this.ue=null,this.saveDraftStatus="保存中",this.beforeunloadstart=!1}return _createClass(n,[{key:"writeContent",value:function(e){var t=this;if(this.ue){this.ue.setOpt("isSubmit",!1),$(".editHolder").hide(),this.ue.setContent(e);var n=setTimeout(function(){t.ue.fireEvent("contentChange"),clearTimeout(n)},500)}}},{key:"resumeEditDraft",value:function(e){var t=e&&$("<div/>").html(e.subject).text();n.loadTitle(t,$(".thread-title-placeholder"),$("#threadTitle"),$(".template-textarea")),e.plan_id&&n.loadPlan(e.plan_id),n.loadTag(e.tag),$.trim(e.content)&&this.writeContent(e.content),n.updateLift()}},{key:"getDraft",value:function(){return(new $.Deferred).promise()}},{key:"read",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.okText,i=void 0===t?"继续写草稿":t,o=e.cancelText,r=void 0===o?"删除草稿写新帖":o,a=e.count,s=void 0===a?3:a,l=e.statusDom,d=void 0===l?$(".qy_issue_mask .text"):l,c=e.deleteHandler,u=void 0===c?function(){}:c;this.loadDraftCount=s,this.statusDom=d,n.loadDraft(i,r,u,d,this)}},{key:"saveDraft",value:function(e){return $.Deferred().promise()}},{key:"save",value:function(i){var o=this,r=$.Deferred(),a=!1,s=function(e,t){o.saveDraftStatus=e,o.hasDraftUnsave=!!t,i.html(o.saveDraftStatus),a?o.clearDraftTimer():o.saveDraftTimer(i),o.isSaveProcess=!1};if(!this.ue||!this.ue.getContent()){var l=this.ue?"帖子还没有内容哟，请您书写帖子吧":"编辑器未加载完成";return s(l),r.reject(l),r.promise()}return this.saveDraftStatus="保存中",i.html(this.saveDraftStatus),this.isSaveProcess?r.reject():(this.isSaveProcess=!0,this.saveDraft().done(function(i){var l=$.parseJSON(i),d="",c=!0;if("ok"===l.result)r.resolve(),c=!1,d="保存成功",o.toolContent&&o.toolContent.models.lift.reload(),l.data&&l.data.token&&(o.token=l.data.token),o.saveLastTime=t.dateParse(new Date);else if(d="保存失败",r.reject(d,l),412===+l.error_code){a=!0;var u=t.dateParse(l.data.t?l.data.t+"000":""),p=o.saveLastTime?"<p>当前页面的内容最后保存于 "+o.saveLastTime+"</p>":"",h={title:"发现了一份更新的草稿",exClassName:"loadnew-draft-confirm",okText:"替换草稿",onCancel:function(){$(".x-draft-popup").show()}};n.loadPopup({title:"发现了一份更新的草稿",okText:"载入最新的草稿",cancelText:"将当前页面内容保存为最新草稿",contentHTML:'<div class="qpbc">'+p+"<p>我们发现最新的一份草稿保存于 "+u+' <a class="detail-draft" target="_blank" href="'+window.location.href+'&lookDetail">查看详情</a></p><p class="new-content">'+(l.data.c&&l.data.c.content)+"</p></div>",draft:o,data:l.data,okHandler:function(){e.loadConfirm($.extend({text:"载入您于"+u+"保存的草稿？ </br>当前页面上编辑的内容将被替换且无法恢复。",onOK:function(){n.loadDraftWithoutPopup(o)}},h))},cancelHandler:function(){e.loadConfirm($.extend({text:"将保存当前页面的内容作为最新的草稿？ </br>您于"+u+"保存的草稿将被替换且无法恢复。",onOK:function(){o.token=l.data.token,o.save(o.statusDom)}},h))}})}else 401===+l.error_code&&e.loadTip();s(d,c)}).fail(function(e){r.reject(e),s("保存失败",!0)})),r.promise()}},{key:"saveDraftTimer",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e4,i=new Date((new Date).getTime()+n),o=i.getHours(),r=i.getMinutes(),a=(o<10?"0"+o:o)+":"+(r<10?"0"+r:r),s=setTimeout(function(){t.saveDraftStatus="保存于"+a,e.html(t.saveDraftStatus),clearTimeout(s)},1e3);this.saveDraftTime=setTimeout(function(){t.save(e)},n)}},{key:"clearDraftTimer",value:function(){return clearTimeout(this.saveDraftTime),this}},{key:"saveSync",value:function(){return this.saveDraft(1)}},{key:"deleteDraft",value:function(){return $.Deferred().promise()}},{key:"draftDelete",value:function(){var e=this;this.deleteDraft().done(function(t){e.getDraft().done(function(t){var n=$.parseJSON(t);e.token=n.data&&n.data.token})})}},{key:"saveManu",value:function(e){return this.clearDraftTimer(),this.save(e)}},{key:"bindEvent",value:function(e,t){var n=this;e.on("click",function(){n.saveManu(n.statusDom)}),t&&t.length>0&&t.on("click",".btn",function(){var e=t.find(".sts");e.fadeIn(300),n.saveManu(n.statusDom).done(function(){e.html("保存成功").fadeOut(1e3,function(){history.go(-1)})}).fail(function(){e.html("保存失败")})})}},{key:"beforeunload",value:function(){var e=this;window.onbeforeunload=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,n={result:"ok"};if(e.beforeunloadstart&&e.ue&&e.ue.getContent()&&e.saveSync(e.body()).done(function(e){return n=$.parseJSON(e)}),"ok"!==n.result){var i="您有未保存的草稿！";return t&&(t.returnValue=i),i}}}},{key:"body",value:function(){return{}}},{key:"setPlan",value:function(e){this.plan=e}},{key:"setUe",value:function(e){this.ue=e}},{key:"setSection",value:function(e){this.section=e}},{key:"setToolContent",value:function(e){this.toolContent=e}},{key:"multipleWin",value:function(){}}],[{key:"loadPopup",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.title,r=i.contentHTML,a=i.okText,s=void 0===a?"继续写草稿":a,l=i.cancelText,d=void 0===l?"删除草稿写新帖":l,c=i.deleteHandler,u=i.okHandler,p=void 0===u?function(){b.beforeunloadstart=!0,b.resumeEditDraft(g.c)}:u,h=i.cancelHandler,f=void 0===h?function(){n.cancelEditDraft(c,b)}:h,m=i.data,g=void 0===m?{}:m,b=i.draft,v="",y="";g.c&&(v=g.c.subject?g.c.subject:"未命名草稿",y=t.removeHtmlTag(g.c.content),y=y?"..."+y.substring(y.length-100):"");var x='<span class="savetime">最后保存于 '+(g.date||"")+"</span>";e.loadPopup({title:o,okText:s,cancelText:d,name:v,date:x,contentHTML:r,contentSubstr:y,onBeforeHide:function(){return $(".x-draft-popup").hide(),!1},onOK:p,onCancel:f})}},{key:"loadDraftWithoutPopup",value:function(e){e.getDraft().done(function(t){var n=$.parseJSON(t);"ok"===n.result&&(e.token=n.data.token,e.hasDraftUnsave=!1,e.saveDraftTimer(e.statusDom),n.data&&n.data.t&&(e.beforeunloadstart=!0,e.resumeEditDraft(n.data.c)))})}},{key:"loadDraft",value:function(){for(var t=arguments.length,i=Array(t),o=0;o<t;o++)i[o]=arguments[o];var r=i[0],a=i[1],s=i[2],l=i[3],d=i[4],c=!0;window.location.href.match(/lookDetail/)&&(c=!1),c?(d.loadDraftTime+=1,d.getDraft().done(function(t){var o=$.parseJSON(t);"ok"===o.result?(d.token=o.data.token,d.hasDraftUnsave=!1,d.saveDraftTimer(l),o.data&&o.data.t?n.loadPopup({okText:r,cancelText:a,data:o.data,deleteHandler:s,draft:d}):d.beforeunloadstart=!0):401===+o.error_code?e.loadTip():d.loadDraftTime<d.loadDraftCount&&n.loadDraft.apply(n,i)}).fail(function(e){})):n.loadDraftWithoutPopup(d)}},{key:"cancelEditDraft",value:function(t,n){e.loadConfirm({onOK:function(){n.draftDelete(),t(),n.beforeunloadstart=!0},onCancel:function(){$(".x-draft-popup").show()}})}},{key:"loadTitle",value:function(e,t,n,i){""!==e?t.css("display","none"):t.css("display","block"),n.val(e),i.html(e),n.height(i.height()||40)}},{key:"loadPlan",value:function(e){requirejs(["common/models/common/component/planItinerary/index"],function(t){t.init({action:"edit",planid:e,disableCell:{traffic:!0}}),$(".x-issue-planLoad").hide(),$(".qy_issue_showHide").show()})}},{key:"loadTag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0){var t="";$.each(e,function(e,n){t=t+'<a href="javascript:;" class="tag js_cmd" data-cmd="delTag">'+$("<div/>").html(n).text()+"</a>"}),$("#js_tagContainer").html(t).css("display","block")}}},{key:"updateLift",value:function(){$("[data-mode=lift]").length&&$("[data-mode=lift]").hasClass("selected")&&$("[data-mode=lift]").trigger("click")}}]),n}();return{Draft:n}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("assets/issue/draft/editDraft",["assets/issue/draft/draft","assets/issue/util"],function(e,t){var n=function(e){function n(e){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.pid=e,t}return _inherits(n,e),_createClass(n,[{key:"getDraft",value:function(){return $.get("/draft/load-modify?pid="+this.pid+"&"+t.now())}},{key:"saveDraft",value:function(e){return $.ajax({type:"POST",url:"/draft/save-modify?pid="+this.pid,data:this.body(),async:!e})}},{key:"deleteDraft",value:function(){return $.post("/draft/remove-modify",{pid:this.pid})}},{key:"body",value:function(){if(!this.ue)return{};var e=this.plan&&this.plan.getPlanID();this.ue.options.isSubmit=!1;var t=$(".main-tags .selected").map(function(){return $(this).text()}).toArray(),n={subject:$.trim($("#threadTitle").val()),content:this.ue.getContent().replace(/\&nbsp\;/gi," "),tag:$("#js_tagContainer > a").map(function(){return $(this).text()}).toArray().concat(t),plan_id:e};return{token:this.token,mode:"W",data:n}}}]),n}(e.Draft);return{EditDraft:n}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("assets/issue/draft/pubDraft",["assets/issue/draft/draft","assets/issue/util"],function(e,t){var n=function(e){function n(e,t){_classCallCheck(this,n);var i=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return i.fid=e,i.type=t,i}return _inherits(n,e),_createClass(n,[{key:"getDraft",value:function(){return $.get("/draft/load-new?type="+this.type+"&fid="+this.fid+"&"+t.now())}},{key:"saveDraft",value:function(e){return $.ajax({type:"POST",url:"/draft/save-new?type="+this.type+"&fid="+this.fid,data:this.body(),async:!e})}},{key:"deleteDraft",value:function(){return $.post("/draft/remove-new",{type:this.type,fid:this.fid})}},{key:"body",value:function(){if(!this.ue)return{};var e=this.plan&&this.plan.getPlanID(),t=[],n=$("#js_blockContainer").find("p.show-forward-banner"),i=this.section&&this.section.getCheckedFid();i&&t.push(i);for(var o=0,r=n.length;o<r;o++)n.eq(o).attr("data-forward-fid")&&t.push(n.eq(o).attr("data-forward-fid"));this.ue.options.isSubmit=!1;var a={subject:$.trim($("#threadTitle").val()),content:this.ue.getContent().replace(/\&nbsp\;/gi," "),tag:$("#js_tagContainer > a").map(function(){return $(this).text()}).toArray(),plan_id:e};return{token:this.token,mode:"W",data:a}}}]),n}(e.Draft);return{PubDraft:n}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("assets/issue/draft/replyDraft",["assets/issue/draft/draft","assets/issue/util"],function(e,t){var n=e.Draft,i=function(e){function i(e){_classCallCheck(this,i);var t=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.tid=e,t}return _inherits(i,e),_createClass(i,[{key:"resumeEditDraft",value:function(e){e&&e.content&&$.trim(e.content)&&this.writeContent(e.content),n.updateLift()}},{key:"getDraft",value:function(){return $.get("/draft/load-reply?tid="+this.tid+"&"+t.now())}},{key:"saveDraft",value:function(e){return $.ajax({type:"POST",url:"/draft/save-reply?tid="+this.tid,data:this.body(),async:!e})}},{key:"deleteDraft",value:function(){return $.post("/draft/remove-reply",{tid:this.tid})}},{key:"body",value:function(){if(!this.ue)return{};this.ue.options.isSubmit=!1;var e={content:this.ue.getContent().replace(/\&nbsp\;/gi," ")};return{token:this.token,mode:"W",data:e}}}]),i}(n);return{ReplyDraft:i}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("assets/issue/draft/threadDraft",["assets/issue/draft/draftFactory","assets/issue/draft/editDraft","assets/issue/draft/pubDraft","assets/issue/draft/replyDraft","assets/issue/constant"],function(e,t,n,i,o){var r=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return _inherits(r,e),_createClass(r,[{key:"genDraft",value:function(e){var r=window.location.href.match(/pid=(\d+)&?.*$/),a=r?r[1]:0,s=null;switch(e){case"edit":s=new t.EditDraft(a);break;case"pub":s=new n.PubDraft(o.fid,o.threadType);break;case"reply":s=new i.ReplyDraft(o.tid);break;default:s=new n.PubDraft(o.fid,o.threadType)}return s}}]),r}(e.DraftFactory);return{ThreadDraft:r}}),define("old/js/detail_floor",["old/js/bbs_normal_editor","web_old_loading","web_old_tip","web_ct_submitBeforeValidCode"],function(e,t,n,i){function o(){window.replyDraft&&(window.replyDraft.beforeunloadstart=!1,window.replyDraft.clearDraftTimer())}function r(n,o,r,l){var c={where:"floor",baseCon:{initContent:"",initialFrameHeight:120,zIndex:0,focus:!0,isSubmit:!1}};$.extend(!0,c,n);var u=0===r||1===r?function(){return+QYER.uid===+BBS.WRITER||!!BBS.ISBBSADMIN}():function(){return!!BBS.ISBBSADMIN}();+QYER.uid===+BBS.WRITER&&(u=!0);var h=new e({tools:["faces","image","video"],target:c.target,id:(new Date).getTime(),editorOpt:c.baseCon,hasSenior:u,where:c.where,onPostReply:function(){var e=this,n=function(n){t.show({text:"正在提交内容..."});var i=e.getContent(),c=$(i).find("[data-type=attach]").map(function(e,t){return $(t).attr("data-key")||$(t).attr("data-id")}).toArray();"reply"===r?a({pid:o,content:i,valid_code:n,attachment:c,quote:s(l)},o):"edit"===r?d({pid:o,content:i,valid_code:n,attachment:c},o):p({content:i,valid_code:n,attachment:c},r)};i(n)}});return $(h)}function a(e,i){o();var r="/thread-reply",a=(new Date).getTime()+Math.random();$.get(r+"?tid="+window.BBS.TID+"&_rd="+a,function(i){var o=$.parseJSON(i);if("ok"===o.result){var a={token:o.data.token,tid:window.BBS.TID,device:1,pid:0,content:"",quote:""};$.extend(!0,a,e),$.post(r,a,function(e){if(t.hide(),"ok"==e.result){var i=+e.data.badword_level?{text:"回复成功，但你发布的内容需要接受X光检查。不要担心，正常内容会马上通过。请不要重复发布哟~",time:2e3}:{text:"回复成功"};n.tip(i),window.location.reload()}else t.hide(),n.tip({text:e.data,type:"warning"})},"json")}})}function s(e){var t=e.find(".bbsDetailContainer").html(),n=$("<div style='display:none'></div>"),i=n.append(t),o=i.find("img[data-type=photo]"),r=i.find("img[data-type!=photo]"),a=i.find("span[data-type=video]"),s=i.find(".qyer_attach");$.each(r,function(){$(this).parent().append("<span>[表情]</span>").end().remove()}),$.each(o,function(){$(this).parent().append("<span>[图片]</span>").end().remove()}),$.each(a,function(){$(this).parent().append("<span>[视频:"+$(this).attr("data-videotitle")+"]</span>").end().remove()}),$.each(s,function(){$(this).parent().append("<span>[附件:"+$(this).find(".name").html()+"]</span>").end().remove()});var l=$.trim(i.text().substring(0,1e3));return n=null,l}function l(e,t){$.get("/post.php?action=get",{pid:e},function(e){if("ok"==e.result){var n=$("<div id='editContainerTempx'></div>");n.append(e.data.content);var i=n.find(".qyer_block.qyer_image");i.length&&$.each(i,function(e,t){var n=$(t).find("img");$(t).replaceWith('<img class="qyer_image" src="'+n.attr("src")+'" _src="'+n.attr("src")+'" data-id="'+n.attr("id")+'"/>')});var o=n.find("img");$.each(o,function(e,t){$(t).attr("data-original")&&$(t).attr("src",$(t).attr("data-original"))}),t(n.html()),n=null}},"json")}function d(e,i,r){o();var a={pid:0,content:"",device:1,attachment:[]};$.extend(!0,a,e),f["id"+i][0].setContent(""),$.post("/post-edit",a,function(e){if(r&&r(),t.hide(),"ok"==e.result){var i=e.data.badword_level?{text:"编辑成功，但你发布的内容需要接受X光检查。不要担心，正常内容会马上通过。请不要重复发布哟~",time:2e3}:{text:"编辑成功"};n.tip(i),window.location.reload()}else n.tip({text:e.data,type:"warning"})},"json")}function c(e,t,i){$.post("/qcross/bbs/post.php?action=remove",{pid:t,fid:BBS.FID},function(t){"ok"==t.result?(n.tip({text:"删除成功！"}),i?window.setTimeout(function(){window.location.href=(t.data||{url:"bbs.qyer.com"}).url},500):(e.remove(),window.setTimeout(function(){window.location.reload()},500))):n.tip({text:t.data.msg,type:"warning"})},"json")}function u(){$(".bbs_detail_list .click").each(function(){var e=$(this);if(!e.data("OK"))if(e.attr("data-OK","true"),window.clipboardData)e.off("click").on("click",function(){window.clipboardData.setData("text",e.attr("data-clipboard-text"))}).off("mouseenter").on("mouseenter",function(){var e=$(this).offset()||{left:0,top:0};$("#floorTipInfo").css({visibility:"visible",opacity:1,left:e.left+$(this).width()+3,top:e.top-3})}).off("mouseleave").on("mouseleave",function(){$("#floorTipInfo").css({visibility:"hidden",opacity:0})});else{var t=new ZeroClipboard(this);t.on("ready",function(e){t.on("aftercopy",function(e){n.tip({text:"复制成功"})})})}})}function p(e,n){var i="/thread-reply",r=(new Date).getTime()+Math.random();o(),$.get(i+"?tid="+window.BBS.TID+"&_rd="+r,function(o){if("ok"===o.result){var r={token:o.data.token,tid:window.BBS.TID,device:1,content:""};$.extend(!0,r,e),$.post(i,r,function(e){if(t.hide(),"ok"==e.result){var i=e.data.badword_level?{text:["续写","回复"][n]+"成功，但你发布的内容需要接受X光检查。不要担心，正常内容会马上通过。请不要重复发布哟~",time:2e3}:{text:["续写","回复"][n]+"成功"};requirejs(["web_old_tip"],function(e){e.tip(i)}),window.location.href=window.location.href.replace(/#(?:reply|item-post-\d+)?/,"")}else h&&window.replyDraft&&window.replyDraft.save($(".saveinfo .stats")),requirejs(["web_old_tip"],function(t){t.tip({text:e.data,type:"warning"})})},"json")}},"json")}var h=!!+window.BBS.ISWRITER||!!+window.BBS.ISBBSADMIN,f={};$(".bbs_detail_list").on("click",".js_floorReply",function(){if(!window.qyerUtil.isLogin())return void window.qyerUtil.doLogin();var e=$(this),n=e.parents(".bbs_detail_item"),o=n.attr("data-id"),l=n.find(".bbs_detail_content"),d=n.find(".bbs_detail_seting"),c=n.find(".floorReplyBoxs"),u=c.find(".floorReplyTit");u.show(),l.show(),d.hide(),c.show(),f["id"+n.data("id")]||(f["id"+n.attr("data-id")]=r({target:c.find(".floorReplyBox")[0]},o,"reply",n)),f["id"+n.data("id")][0].editor.options.isSubmit=!1,f["id"+n.data("id")].off("sendsubmit").on("sendsubmit",function(e,r){r.content&&i(function(e){t.show({text:"正在提交内容..."}),u.hide(),d.show(),c.hide(),a({pid:o,content:r.content,attachment:r.attachment,valid_code:e,quote:s(n)},o)})}).off("sendcancel").on("sendcancel",function(){u.hide(),d.show(),c.hide()})}),$(".bbs_detail_list").on("click",".js_floorContentEdit",function(){if(!window.qyerUtil.isLogin())return void window.qyerUtil.doLogin();var e=$(this),n=e.parents(".bbs_detail_item"),o=n.attr("data-id"),a=n.find(".bbs_detail_content"),s=n.find(".bbs_detail_seting"),c=n.find(".floorReplyBoxs"),u=c.find(".floorReplyTit");u.hide(),a.hide(),s.hide(),c.show(),f["id"+n.data("id")]||(f["id"+n.attr("data-id")]=r({target:c.find(".floorReplyBox")[0]},o,"edit",n)),l(o,function(e){f["id"+n.data("id")][0].editor.options.isSubmit=!0,f["id"+n.data("id")].off("sendsubmit").on("sendsubmit",function(e,n){n.content&&i(function(e){a.show(),c.hide(),s.show(),u.show(),t.show({text:"正在提交内容..."}),d({pid:o,content:n.content,valid_code:e,attachment:n.attachment},o)})}).off("sendcancel").on("sendcancel",function(){a.show(),c.hide(),s.show(),u.show(),f["id"+n.data("id")][0].setContent("")}),f["id"+n.data("id")][0].setContent(e),$("#post-"+n.data("id")).length&&$(window).scrollTop($("#post-"+n.data("id")).offset().top||0)})}),$(".js_floorDelete").on("click",function(){var e=$(this).parents(".bbs_detail_item"),t=e.attr("data-id"),n=!!e.attr("data-isfirst");requirejs(["web_old_popup2"],function(i){new i({title:"删除",contentHTML:n?"确认删除首楼层吗？删除首楼层将删除整个帖子。此操作不可撤销。":"确认删除该楼层帖子吗？此操作不可撤销。",onOK:function(){c(e,t,n)}}).show()})}),$(".js_floorReport").on("click",function(){var e=$(this).parents(".bbs_detail_item"),t=e.attr("data-id");require(["common/models/common/component/report/report"],function(n){
n.init({type:80,id:t,page_url:e.find("[data-clipboard-text]").attr("data-clipboard-text")})})}),$("body").append('<div style="position:absolute;right:-100px;top:-5px;opacity:0;visibility:hidden;width:200px;" class="x-tool-wrap" id="floorTipInfo"><div class="x-tool-left"></div><div class="x-tool-xtm">点击复制此楼层地址</div><div class="x-tool-right"></div></div>');var m=setInterval(function(){function e(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy")&&n.tip({text:"复制成功"}),document.body.removeChild(t)}"undefined"!=typeof ZeroClipboard&&(clearInterval(m),document.execCommand?($(".bbs_detail_list .click").on("mouseenter",function(){$(this).append('<div style="position: absolute;right:-180px;top:-5px;opacity:1;visibility:visible;width:180px;z-index: 22;" class="x-tool-execCommand"><div class="x-tool-left"></div><div class="x-tool-xtm">点击复制此楼层地址</div><div class="x-tool-right"></div></div>')}).on("mouseleave",function(){$(".x-tool-execCommand").remove()}),$(".bbs_detail_list .click").click(function(){console.log($(this)),console.log($(this).attr("data-clipboard-text")),e($(this).attr("data-clipboard-text"))})):(u(),$("#global-zeroclipboard-html-bridge").append('<div style="display:block;right:-100px;top:-5px;opacity:1;visibility:visible;width:200px;" class="x-tool-wrap"><div class="x-tool-left"></div><div class="x-tool-xtm">点击复制此楼层地址</div><div class="x-tool-right"></div></div>')))},1e3);$("#topicReplyDefault").on("click",function(e,n){var o="undefined"==typeof n?1:n;if(!window.qyerUtil.isLogin())return void window.qyerUtil.doLogin();var a=$(this),s=$("#topicReplyEditor");s.show(),!h&&$(this).hide(),f.detailBtmEditor||(f.detailBtmEditor=r({target:document.getElementById("topicReplyEditor"),where:"bottom",baseCon:{fullscreen:h,initialContent:"",initialFrameHeight:65,zIndex:0,focus:!0,isSubmit:!1}},0,o),f.detailBtmEditor.on({sendsubmit:function(e,n){i(function(e){""==n.content?s.hide():(t.show({text:"正在提交内容..."}),p({content:n.content,valid_code:e,attachment:n.attachment},o))})},sendcancel:function(){s.hide(),a.show()}}));var l=f.detailBtmEditor[0].editor;l.ready(function(){if(h){$(".bbs_simple_foot").hide(),$(".bbs_simple_Btn").hide(),$("#topicReplyEditor .senior").click();var e=document.documentElement.scrollTop||document.body.scrollTop;if(~navigator.userAgent.toLowerCase().indexOf("firefox"))var t=setTimeout(function(){$("#topicReplyEditor .edui-editor.edui-simple").css("top",e+100),$("#topicReplyEditor .edui-editor.edui-simple").css("padding-top","40px"),clearTimeout(t)},500);else $("#topicReplyEditor .edui-editor.edui-simple").css("top",e+100),$("#topicReplyEditor .edui-editor.edui-simple").css("padding-top","40px");var n={okText:"继续编辑草稿",cancelText:"删除此草稿重新发表",statusDom:$(".saveinfo .stats"),deleteHandler:function(){l.setContent(""),l.focus()},mode:"reply",saveBtn:$(".saveinfo .btn")};window.replyDraft?window.replyDraft.read(n):require(["assets/issue/draft/threadDraft"],function(e){var t=(new e.ThreadDraft).loadDraft(n);window.replyDraft=t,t.setUe(l)})}})}),$("#topicReplyDefault .tipsTxt").on("click",function(e){e.stopPropagation()}),$("#topicReplyDefault .tipsTxt").on("click","a",function(){if(!window.qyerUtil.isLogin())return void window.qyerUtil.doLogin();var e=$(this).attr("data-type");$("#topicReplyDefault").trigger("click",{writing:0,reply:1}[e])});var g=window.location.hash;g&&~g.indexOf("#reply")&&$("#topicReplyDefault").click(),$(window).load(function(){var e=window.location.href.match(/post\-[\d]+\-?[\d]*/);if(e)var t=setTimeout(function(){$("#"+e[0]).length&&$(window).scrollTop($("#"+e[0]).offset().top-80),clearTimeout(t)},500)})}),define("old/js/sideCatalog",[],function(){var e={parDom:$(".j-elevator"),height:0,conHeight:0,targetId:0,scrollHeight:200,scrolling:!0,scrollToFixedTop:0,heightAry:[],idAry:[],planid:$("#__planItinerary__").attr("data-planid")||0,getElevators:function(){return $.post("/qcross/bbs/post.php?action=dom",{tid:BBS.TID})},getEleBodyDom:function(){return $(".j-elevator .container .list")},ind:-1,bindEvent:function(){var e=this,t=this.getEleBodyDom();$(".j-elevator").on("click","a",function(n){var i=$(this),o=i.attr("data-href-val");"undefined"!=typeof o&&o&&(e.scrolling=!1,$("html,body").animate({scrollTop:$("#"+o).offset().top-80},100,function(){t.find("a").removeClass("active"),i.addClass("active"),e.scrolling=!0}))})},scrollIndex:function(e,t,n){var i,o=this,r=0,a=e.concat(n+2);a.sort(function(e,t){return e-t});for(var s=0,l=a.length;s<l;s++)a[s]===n+2&&(r=s-1);if(o.ind!==r){o.ind=r;var d=t[r],c=o.getEleBodyDom();i=c.find("a[data-href-val="+d+"]"),c.find("a").removeClass("active"),i.addClass("active"),i.length&&c.scrollTop(i.offset().top+c.scrollTop()-c.offset().top-o.height/2)}},scrollEleBodyHash:function(){var e=this,t=window.location.hash.replace(/#/,"");if(t){var n=e.getEleBodyDom(),i=n.find("[data-href-val="+t+"]"),o=i.length?i.offset().top-n.offset().top+n.scrollTop():0;n.find("a").removeClass("active"),i.addClass("active"),n.scrollTop(o-e.height/2)}},getArys:function(){var e=this;e.idAry=[],e.heightAry=[];for(var t=$(".bbs_detail_list").find("h1,h2"),n=0,i=t.length;n<i;n++){var o=t[n].id;if(o){var r=o.match(/post\-[\d]+\-[\d]+/);r&&(e.idAry.push(o),e.heightAry.push($("#"+o).offset().top-80))}}},bodyScroll:function(){var e=this,t=$(".j-elevator"),n=e.getEleBodyDom(),i=null,o=-25,r=$(window).height()-294,a=r-121,s=t.find(".container"),l=!0,d=null,c=function(){d&&clearTimeout(d),l=!1,d=setTimeout(function(){t.hide().css({"z-index":"11",position:"fixed",left:$(".bbs_content").offset().left+840,bottom:"-"+e.height+"px",width:"368px","background-color":"#fff"}).find(".container").addClass("noborder"),t.show().animate({bottom:o},300,"linear",function(){e.scrollEleBodyHash()})},300)};$("body").on("elevatorbottomchange",function(n,i){r=$(window).height()-294,a=r-121,i?(e.height=e.conHeight>a?a:e.conHeight,o=96):(e.height=e.conHeight>r?r:e.conHeight,o=-25),t.css("bottom",o),s.height(e.height)});var u=n.find(".e_tle"),p=n.find(".subtle");$("body").on("elevatordocking",function(o,a){a?(l&&c(),r=$(window).height()-294,e.height=e.conHeight>r?r:e.conHeight,s.height(e.height),$.each(u,function(e,t){$(t).attr("data-bn-ipg","bbs-thread-docklift-first")}),$.each(p,function(e,t){$(t).attr("data-bn-ipg","bbs-thread-docklift-second")}),n.find("[data-href-val=__planItinerary__]").attr("data-bn-ipg","bbs-thread-docklift-plan")):(l=!0,t.css({"z-index":"",position:"",left:"","margin-left":"",bottom:"",width:""}).find(".container").removeClass("noborder"),e.height=e.conHeight>395?395:e.conHeight,s.height(e.height),$.each(u,function(e,t){$(t).attr("data-bn-ipg","bbs-thread-rightlift-first")}),$.each(p,function(e,t){$(t).attr("data-bn-ipg","bbs-thread-rightlift-second")}),n.find("[data-href-val=__planItinerary__]").attr("data-bn-ipg","bbs-thread-rightlift-plan")),i&&clearTimeout(i),i=setTimeout(function(){e.scrolling&&e.scrollIndex(e.heightAry,e.idAry,$(window).scrollTop())},50)}),e.getArys();setInterval(function(){e.getArys()},2e3)},init:function(){var e=this;e.getElevators().then(function(t){var n=$.parseJSON(t),i=[];if("ok"===n.result){var o=n.data||[],r=[];if($.each(o,function(e,t){""!==$.trim($("<div/>").html(t.title).text())&&r.push(t)}),!r.length)return void e.parDom.hide();var a=$(".bbs_content").html(),s=0,l=e.planid?'<h4 class="title"><i class="eline"></i><i class="bicf iplan">&#xEA1A;</i><b class="dot j-linestart">&bull;</b><a class="title" href="__pagehref__" data-href-val="__planItinerary__" data-bn-ipg="bbs-thread-rightlift-plan">行程单</a></h4>':"";e.height=$(window).height()-51-$("#detailSideBiz").height()-111;var d=+window.location.href.match(/thread\-\d+\-(\d*)/)[1];l=l.replace(/__pagehref__/,1===d?"javascript:void(0);":window.location.href.replace(/(thread\-\d+\-)\d*/,"$11")),i.push('<h3 class="tle">电梯</h3><div class="container"><div class="list"><div class="listinner">'+l),s=r.length,$.each(r,function(e,t){var n=t.url,o=(/post\-[\d]+\-[\d]+/.exec(n)||[])[0],r="",l="";a.match(new RegExp(o))?(r=o,l="javascript:void(0)"):(l=n,r="");var d=($.trim($("<div/>").html(t.title).text()),"");strline=e===s-1?"":'<i class="eline"></i>',1===+t.level?(d=e===s-1?"dot j-linend":"dot",i.push('<h4 class="title clearfix">'+strline+'<b class="'+d+'">&bull;</b><a class="e_tle" href="'+l+'" data-href-val="'+r+'" data-bn-ipg="bbs-thread-rightlift-first" data-index="'+(e+1)+'">'+t.title+"</a></h4>")):(d=e===s-1?"eleline j-linend":"eleline",i.push('<ul class="eleitem">'+strline+'<b class="'+d+'"></b><li class="subitm"><a class="subtle" href="'+l+'" data-href-val="'+r+'" data-bn-ipg="bbs-thread-rightlift-second" data-index="'+(e+1)+'">'+t.title+"</a></li></ul>"))}),i.push('</div></div><div class="page" style="display:none"><a href="javascript:;" title="向上" class="up"><span></span></a><span class="line"></span><a href="javascript:;" title="向下" class="down"><span></span></a></div></div>'),e.parDom.empty().append(i.join("")),e.conHeight=e.parDom.find(".listinner").height()+12,e.height=e.conHeight>395?395:e.conHeight,$(".j-elevator").find(".container").height(e.height),e.bodyScroll(),$("body").trigger("elevatorloaded"),e.bindEvent()}else $("body").trigger("elevatorloaded")})}};e.init()}),define("old/js/detail/video",[],function(){return{translate:function(e){$.each(e,function(e,t){var n=$(t),i=n.attr("data-osrc")||n.attr("data-src");~i.indexOf("vod.qyer.com")&&$(t).remove()})}}}),define("common/models/basic/js/require-css!common/models/common/ui/numberTurn/numberTurn",[],function(){}),define("common/models/common/ui/numberTurn/numberTurn",["css!common/models/common/ui/numberTurn/numberTurn.css"],function(){function e(e,t){this.$obj=$(e),this.$turnWrap=null,this.num=t||0,this.numArr=[],this.numLen=0,this.turn_h=this.$obj.height(),this.numTop=20*this.turn_h,this.init()}e.prototype={init:function(){var e=[];this.toArr();for(var t=0;t<this.numLen;t++)e.push(this.getTurnDom());this.$obj.addClass("num-turn"),this.$obj.html(e.join("")),this.$turnWrap=this.$obj.find(".num-wrap"),this.turn(this.num)},toArr:function(){this.numArr=(0==this.num?"0":this.num.toString()).split(""),this.numLen=this.numArr.length},getTurnDom:function(){var e=['<div class="num-wrap" style="top: -'+this.numTop+'px;">','<div class="num-span">',this.getSpanDom(),"</div>","</div>"].join("");return e},getSpanDom:function(){for(var e=[],t=0;t<5;t++)e.push('<div class="num-dom-span">'),e.push("<span>0</span>"),e.push("<span>1</span>"),e.push("<span>2</span>"),e.push("<span>3</span>"),e.push("<span>4</span>"),e.push("<span>5</span>"),e.push("<span>6</span>"),e.push("<span>7</span>"),e.push("<span>8</span>"),e.push("<span>9</span>"),e.push("</div>");return e.join("")},loadNumber:function(){},turn:function(e){var t=this;if(this.num=e||0,this.toArr(),this.numLen>this.$turnWrap.length)for(var n=this.numLen-this.$turnWrap.length,i=0;i<n;i++)this.$obj.append(this.getTurnDom()),this.$turnWrap=this.$obj.find(".num-wrap");else if(this.numLen<this.$turnWrap.length)for(var n=this.$turnWrap.length-this.numLen,i=0;i<n;i++)this.$turnWrap.eq(0).remove(),this.$turnWrap=this.$obj.find(".num-wrap");$.each(this.numArr,function(e,n){var i=t.$turnWrap.eq(e);if(!i.is(":animated")){var o=e%2!=0?0:t.numTop;o=t.numTop,i.animate({top:-(n*t.turn_h)},1e3+200*e,function(){i.css("top",-(t.numTop+n*t.turn_h))})}})},getNum:function(){return this.num}},$.fn.extend({numberTurn:function(t){return new e(this,t)}})}),define("common/models/basic/js/require-css!common/models/common/ui/share/share",[],function(){}),define("common/models/common/ui/share/share",["css!common/models/common/ui/share/share.css"],function(){function e(e){var t={appkey:{tsina:"2254065920",tqq:"fae7e432cbfd4ae378f0e501ebb4feed",renren:"d5ecb574cf7e4ef7a3840898aab6fe4f",qzone:"fae7e432cbfd4ae378f0e501ebb4feed",douban:"0239fb1e9a36072606adf15bcea21572"}},n=$(e),i=n.parent();title=n.attr("data-title")||i.attr("data-title"),summary=n.attr("data-summary")||i.attr("data-summary"),pic=n.attr("data-pic")||i.attr("data-pic"),url=n.attr("data-url")||i.attr("data-url"),"undefined"!=typeof title&&(t.title=title),"undefined"!=typeof summary&&(t.summary=summary),BBS&&BBS.SHAREPIC&&(t.pic=BBS.SHAREPIC),"undefined"!=typeof pic&&(t.pic=pic),"undefined"!=typeof url&&(t.url=url),window.jiathis_config=t}return function(){var t=['<div id="jiathisShadowLayer">','<div class="jiathis_style">','<a class="jiathis_button_tsina"></a>','<a class="jiathis_button_tqq"></a>','<a class="jiathis_button_qzone"></a>','<a class="jiathis_button_renren"></a>','<a class="jiathis_button_douban"></a>','<a class="jiathis_button_weixin"></a>',"</div>","</div>"].join("");$("body").append(t),t=null;var n=$("#jiathisShadowLayer");$.getScript("http://v3.jiathis.com/code/jia.js",function(){$(document).on("mousedown",".qui-iconShares > a",function(){e(this)}),$(document).on("click",".qui-iconShares > a",function(){var e=$(this).attr("class");n.find(".jiathis_button_"+e).trigger("click"),e=null})})}(),{trigger:function(e,t){window.jiathis_config="object"==typeof t?t:{},$("#jiathisShadowLayer").find(".jiathis_button_"+e).trigger("click")}}}),define("common/models/basic/js/require-css!common/models/common/component/shareIcon/shareIcon",[],function(){}),define("common/models/common/component/shareIcon/shareIcon",["common/models/common/ui/tip/tip","common/models/common/ui/numberTurn/numberTurn","common/models/common/ui/share/share","css!common/models/common/component/shareIcon/shareIcon.css"],function(){function e(e){this.status=0,this.init(e)}function t(e){this.init(e)}function n(){}function i(e){this.icons={},this.container="",this.tid="",this.factory=null,this.init(e)}return e.prototype={uiName:"reply",stsClassName:"",txt:"回复",tpl:'<div class="sts _uiName_ _stsClassName_" data-bn-ipg="_ipg_" data-hoverclass="_hoverclass_" dat-leaveclass="_leaveclass_"><div class="icon-wrap"><a class="icon bicf" href="javascript:;">_iconfont_</a><a class="txt _txtafter_">_txt_</a></div></div>',selClass:"selected",hoverClass:"enter",activeClass:"press",isChangeTxt:!1,init:function(e){$.extend(this,e),this.dom=$(this.getHtml()),this.icon=this.dom.find(".icon");var t=QYER.uid==BBS.WRITER;return this.bindEvent(t),this.dom},bindEvent:function(e){var t=this;return e&&(t.dom.hasClass("like")||t.dom.hasClass("collect"))?(t.dom.find("a").css("cursor","default"),t.dom.css("cursor","default"),!1):void this.dom.on("click",function(e){return window.qyerUtil.isLogin()||t.dom.hasClass("share")||t.dom.hasClass("reply")?(t.onClick(e,$(this)),void $(t).trigger(t.type)):void window.qyerUtil.doLogin()})},onClick:function(){this.setStatus(1==this.status?0:1),1==this.status?(this.setTxt(1),this.doAjax()):(this.setTxt(-1),this.doAjax()),$(this).trigger("iconchange",this.status),this.isChangeTxt&&this.setCnText()},setStatus:function(e){this.status=e,1==this.status?(this.icon.addClass(this.selClass).html(this.selIconfont),this.icon.parent().addClass(this.selClass)):(this.icon.removeClass(this.selClass).html(this.iconfont),this.icon.parent().removeClass(this.selClass))},setTxt:function(e){var t=this.dom.find(".txt");if(this.txt=+this.txt,1!=isNaN(this.txt)){this.txt=this.txt+e,t.numberTurn(this.txt);var n=+!!this.txt;this.dom.find(".txt")[["remove","add"][n]+"Class"]("num-turn"),this.dom.find(".num-span")[["hide","show"][n]]()}},setCnText:function(e){var t=this,n=[t.txtafterclass,t.txtafterclassyet];e=t.status?t.status:e||0,t.dom.find(".txt").addClass(n[e]).removeClass(n[+!e])},doAjax:function(){var e=this;$.ajax({url:this.url,data:{tid:e.tid,opt:e.status},success:function(t){t=JSON.parse(t),0!=t.error_code&&(e.icon.removeClass(e.selClass).html(e.iconfont),e.icon.parent().removeClass(e.selClass))},error:function(){e.icon.removeClass(e.selClass).html(e.iconfont),e.icon.parent().removeClass(e.selClass)}})},getHtml:function(){return this.tpl.replace(/_uiName_/,this.uiName).replace(/_stsClassName_/,this.stsClassName).replace(/_iconfont_/g,this.iconfont).replace(/_hovericon_/,this.iconfont).replace(/_hoverclass_/,this.hoverclass).replace(/_leaveclass_/,this.leaveclass).replace(/_txt_/,this.txt).replace(/_txtafter_/,this.txtafterclass).replace(/_ipg_/,this.ipg)}},t.prototype={uiName:"",txt:"",title:"",url:"",summary:"",tpl:'<div class="sts _uiName_"><div class="icon-wrap"><a class="icon bicf" href="javascript:;">_iconfont_</a><a class="txt">_txt_</a><div class="content"><span class="arrow0"><span class="arrow1"></span><span class="arrow2"></span></span><div class="qui-iconShares size24" data-title="_title_" data-url="_url_" data-summary="_summary_"><a class="tsina" data-bn-ipg="bbs-thread-top-share-weibo" data-url="_url__link_campaign=weibo_share&category=bbs_content_hash_"></a><a class="weixin" data-bn-ipg="bbs-thread-top-share-weixin" data-url="_url__link_campaign=wechat_share&category=bbs_content_hash_"></a><a class="qzone" data-bn-ipg="bbs-thread-top-share-qq" data-url="_url__link_campaign=qq_share&category=bbs_content_hash_"></a></div></div></div></div>',hoverClass:"enter",init:function(e){return $.extend(this,e),this.dom=$(this.getHtml()),this.content=this.dom.find(".content"),this.bindEvent(),this.dom},bindEvent:function(){var e=this;this.dom.on("mouseenter",function(){e.dom.addClass(e.hoverClass),e.content.show()}).on("mouseleave",function(t){e.content.hide(),e.dom.find(".icon").html(e.iconfont),e.dom.removeClass(e.hoverClass)})},getHtml:function(){var e=this.url.split("#"),t=e[0],n=e[1]?"#"+e[1]:"",i=this.url.indexOf("?")>0?"&":"?";return this.tpl.replace(/_uiName_/,this.uiName).replace(/_txt_/,this.txt).replace(/_title_/,this.title).replace(/_url_/g,t).replace(/_link_/g,i).replace(/_hash_/g,n).replace(/_iconfont_/,this.iconfont).replace(/_summary_/,this.summary)}},n.prototype={getTool:function(e){var t;switch(e.type){case"reply":t=this.createReply(e);break;case"like":t=this.createLike(e);break;case"collect":t=this.createCollect(e);break;case"share":t=this.createShare(e)}return t},createReply:function(t){var n={uiName:"reply",txt:"回复"};return new e($.extend(n,t))},createLike:function(t){var n={uiName:"like",txt:"喜欢",status:0,url:"/thread.php?action=like"};return new e($.extend(n,t))},createCollect:function(t){var n={uiName:"collect",txt:"收藏",status:0,url:"/thread.php?action=favorite"};return new e($.extend(n,t))},createShare:function(e){var n={uiName:"share",txt:"分享"};return new t($.extend(n,e))}},i.prototype={tools:[{type:"like",ipg:"like"},{type:"collect",ipg:"collect"},{type:"reply",ipg:"reply"},{type:"share",ipg:"share"}],init:function(e){$.extend(!0,this,e),this.dom=$(this.container),this.factory=new n,this.bindEvent(),this.render()},bindEvent:function(){var e=this;$(this.factory).on("reply",function(){e.onReply()})},onReply:function(){},setLike:function(e){var t=this.icons.like;t.setStatus(e||0),t.isChangeTxt&&t.setCnText(e||0)},setCollect:function(e){var t=this.icons.collect;t.setStatus(e||0),t.isChangeTxt&&t.setCnText(e||0)},render:function(){for(var e,t,n=this,i=QYER.uid==BBS.WRITER,o=0;t=this.tools[o++];)e=this.factory.getTool($.extend(t,{tid:this.tid})),$(e).on("iconchange",function(e,t){$(n).trigger("iconchange",{type:this.type,data:t})}),this.icons[t.type]=e,this.dom.append(e.dom),$(".g-ban .f-bw .title").hasClass("onerow")&&!$(".bbs_info_content").hasClass("z-nocover")&&$(".bbs_info_content .sts.like").css("top","-58px");$("body").on("mouseenter",".sts",function(e){$(".icon-wrap").addClass("bordertrans");var t=$(this),n=t.find(".icon");t.hasClass("reply")?(n.html(t.attr("data-hovericon")),t.removeClass("mouse_leave").addClass("mouse_enter")):i||(t.hasClass("like")&&!t.parents(".bbs_dockFixed").length?n.addClass("cfff"):n.html(t.attr("data-hovericon")),t.removeClass("mouse_leave").addClass("mouse_enter"))}).on("mouseleave",".sts",function(e){$(".icon-wrap").removeClass("bordertrans");var t=$(this),n=t.find(".icon");n.removeClass("cfff"),t.removeClass("mouse_enter").addClass("mouse_leave"),t.hasClass("reply")?"none"===$(".m-popupreply").css("display")&&n.html(t.attr("data-nicon"))&&t.removeClass("mouse_enter").addClass("mouse_leave"):i||(t.removeClass("mouse_enter").addClass("mouse_leave"),n.hasClass("selected")?n.html(t.attr("data-hovericon")):n.html(t.attr("data-nicon")))})}},i}),define("old/js/imgTool",["web_old_tip","web_old_popup2","web_old_inputautocomplete"],function(e,t){function n(e){$.extend(this,e||{}),this.init()}var i={tips:function(t,n){e.tip({text:t.data.msg||n})},doAjax:function(e){qyerUtil.doAjax({url:e.url,data:e.data,onSuccess:function(t){return $.isFunction(e.onSuccess)?(e.onSuccess(t),!1):void i.tips(t,e.successMSG||"操作成功")},onError:function(t){return $.isFunction(e.onError)?(e.onError(t),!1):void i.tips(t,e.errorMSG||"操作失败")}})}},o={linkDestination:{url:"/qcross/pictrip/detail.php?action=editPhotoPlace",successMSG:"关联目的地成功",errorMSG:"关联目的地失败",dom:'<a class="item _link" href="javascript:void(0)">关联目的地</a><span class="separate"></span>'},setCoverphoto:{url:"/qcross/bbs/thread.php?action=editAdminCover",successMSG:"设置封图成功",errorMSG:"设置封图失败",dom:'<a class="item _set" href="javascript:void(0)">设为封图</a><span class="separate"></span>'},likePhoto:{url:"/qcross/pictrip/detail.php?action=like",successMSG:"喜欢成功",errorMSG:"喜欢失败",dom:'<a class="item like _like" href="javascript:void(0)" data-bn-ipg="bbs-thread-pic-like">&nbsp;</a><span class="separate"></span>'},seeLarge:{dom:'<a class="item seeLarge _see" target="_blank" data-bn-ipg="bbs-thread-pic-raw">&nbsp;</a><span class="separate"></span>'}};n.prototype={basicDom:'<div id="_bbs_img_toolbar" class="bbs_img_toolbar"></div>',init:function(){var e=this,t=$("#_bbs_img_toolbar");!t.length&&function(){t=$(e.basicDom)}(),t.html(""),$.each(e.opts.split(","),function(n,i){o[i].id=e.imgId,t.append($.isFunction(o[i].dom)?o[i].dom():o[i].dom)}),e.dom=t,e.bindEvent()},opts:"linkDestination,setCoverphoto,likePhoto,seeLarge",type:1,smallImg:"",getDom:function(){return this.dom},bindEvent:function(){var n=this;n.dom.find("._like").length>0&&(n.status?n.dom.find("._like").removeClass("like").addClass("liked"):n.dom.find("._like").removeClass("liked").addClass("like")),n.dom.find("._see").attr("href","//www.qyer.com/photo/"+n.photoid+"/?spm=allphoto"),n.dom.off("click").on("click",function(r){var a=$(r.target);if(!(a.closest("_disable").length>0)){if(a.closest("._link").length>0){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();new t({title:"图片关联目的地",okText:"保存设置",exClassName:"bbs_detail_linkBox",showCancelBtn:!1,width:"620px",contentHTML:'<div class="bbs_detail_link"><span class="smallImg">'+(n.smallImg?'<img src="'+n.smallImg+'"/>':"暂无图片")+'</span><div class="box"><p class="row">图片关联至</p><p><input type="text" id="_PoiList" class="ui3_input"/><input type="hidden" id="_PoiPlaceType"/><input type="hidden" id="_PoiPlaceId"/></p></div></div>',onOK:function(){o.linkDestination.data={fid:BBS.FID,pid:n.dom.attr("data-floorid"),photo:[{photoid:n.photoid,type:$("#_PoiPlaceType").val(),placeid:$("#_PoiPlaceId").val()}]},i.doAjax(o.linkDestination)},onCancel:function(){}}).show(),$(".bbs_detail_linkBox .qui-popup-box").css({top:"-30px",opacity:0}),$("#_PoiList").qyerAutocomplete({enterSelect:!1,onSearch:function(){var e=$("#_PoiList").val();qyerUtil.doAjax({data:{keyword:e},url:"/qcross/place/poi.php?action=poisearch",onSuccess:function(t){var n='<ul class="qui-inputAutocomplete-ul">';0==t.data.length?n+='<li data-placeid="0">没有数据</li>':$.each(t.data,function(t,i){n+='<li data-placeid="'+i.id+'" data-placetype="'+i.place_type+'"><span class="qyer_inputAutocomplete_name">'+i.cn_name.replace(new RegExp("("+e+")"),'<em class="current">$1</em>')+'</span><span class="qyer_inputAutocomplete_en">'+i.en_name.replace(new RegExp("("+e+")"),'<em class="current">$1</em>')+'</span><span class="qyer_inputAutocomplete_found">'+i.last.replace(new RegExp("("+e+")"),'<em class="current">$1</em>')+"</span></li>"}),n+="</ul>",$("#_PoiList").qyerAutocomplete("pushHTML",n)}})},onSelect:function(e){$("#_PoiPlaceType").val(""),$("#_PoiPlaceId").val(""),$(e).data("placetype")&&$("#_PoiPlaceType").val($(e).data("placetype")),$(e).data("placeid")&&$("#_PoiPlaceId").val($(e).data("placeid"))}})}if(a.closest("._set").length>0){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();var s=a.closest("._set");s.addClass("_disable"),$.extend(o.setCoverphoto,{data:{photoid:n.photoid,tid:n.tid,fid:n.fid},onSuccess:function(t){s.removeClass("_disable"),e.tip({text:t.data.msg||"设置封图成功"}),$(n).trigger("setCoverphoto",t)},onError:function(t){e.tip({type:"warning",text:t.data.msg||"喜欢失败"}),s.removeClass("_disable")}}),i.doAjax(o.setCoverphoto)}if(a.closest("._like").length>0){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();var l=a.closest("._like");l.addClass("_disable"),$.extend(o.likePhoto,{data:{photoid:n.photoid,opt:likephoto["id_"+n.photoid]?0:1,type:n.type},onSuccess:function(e){likephoto["id_"+n.photoid]?(l.removeClass("liked").addClass("like"),likephoto["id_"+n.photoid]=0):(l.removeClass("like").addClass("liked"),likephoto["id_"+n.photoid]=1),l.removeClass("_disable"),$(n).trigger("toolBarLike",e)},onError:function(t){e.tip({type:"warning",text:t.data.msg||"喜欢失败"}),l.removeClass("_disable")}}),i.doAjax(o.likePhoto)}}})}};var r={show:function(e){return this.obj&&this.hide(),$.extend(e,{opts:BBS.ISADMIN?"linkDestination,setCoverphoto,likePhoto,seeLarge":"likePhoto,seeLarge"}),this.obj=new n(e),this.obj.getDom()},hide:function(){this.obj=!1,$("#_bbs_img_toolbar").remove()}};return r}),define("common/models/basic/js/require-css!web_old_textarea",[],function(){}),define("web_old_textarea",["css!web_old_textarea"],function(){function e(e,t){for(var n=[],i=t;i<e.length;i++)n.push(e[i]);return n}function t(e){this.$obj=e.$obj,this.timer=null,this.option=e.option,this.init()}var n=jQuery;t.prototype={$obj:null,$textarea:null,$cloneTextarea:null,initHeight:null,maxHeight:null,timer:null,option:null,init:function(){this.$textarea=this.$obj.find("textarea").size()?this.$obj.find("textarea"):this.$obj.find("input"),this.$obj.attr("data-width")&&(this.$textarea.css("width",this.$obj.attr("data-width")),this.initHeight=this.$obj.attr("data-height")||this.$textarea.outerHeight()),this.$obj.attr("data-height")&&(this.$textarea.css("height",this.$obj.attr("data-height")),this.initWidth=this.$obj.attr("data-width")||this.$textarea.outerWidth()),this.option&&this.option.autoIncreaseHeight===!0&&(this.$cloneTextarea=this.createClone(this.$textarea)),this.$obj.show(),this.updateUI(),this.bindEvent()},createClone:function(e){if(e){var t=this.$textarea.clone(!0);return t.removeAttr("placeholder").css({position:"absolute",left:"-9999em",overflow:"auto"}),t.insertAfter(e),t}},bindEvent:function(){var e=this;this.$obj.keyup(function(t){e.registEvent()})},registEvent:function(){var e=this;window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){e.updateUI(!0)},100)},updateUI:function(e){var t=this.$textarea,i=this.$cloneTextarea,o=this.$obj.find(".max"),r=this.$obj.find(".min"),a=this.$obj.find(".current"),s=(this.$obj.find(".exceed"),this.option.max),l=this.option.min,d=t.val().length;if(i){var c,u;i[0].value=t.val(),c=parseInt(i[0].scrollHeight,10),u=n.isNumeric(this.$obj.attr("data-max-height"))?this.$obj.attr("data-max-height"):99999,c>this.initHeight?(t.addClass("autoHeight"),c>=u&&(c=u,t.removeClass("autoHeight"))):c=this.initHeight,t.css("height",c),c=u=null}-1==s?l>d?(a.addClass("red"),0==d&&a.removeClass("red")):a.removeClass("red"):l>d||d>s?(a.addClass("red"),0==d&&a.removeClass("red")):a.removeClass("red"),a.html(d),o.html(s),r.html(l),$aTextArea=i=o=a=$left=s=l=d=left=null},isValidate:function(){var e=this.$obj.find("textarea").val().length;return-1==this.option.max?e>=this.option.min:e>=this.option.min&&e<=this.option.max},getContent:function(){return this.$obj.find("textarea")[0]},setValue:function(e){this.$textarea.val(e),this.$cloneTextarea.val(e),this.updateUI(!0)},getTextArea:function(){return this.$obj.find("textarea")[0]},unload:function(){this.$cloneTextarea.remove()},reset:function(){this.$textarea.val(""),this.$cloneTextarea.val(""),this.$obj.find(".current").html(0)}},n.fn.extend({qyerTextArea:function(i){var o,r;if(o={isValidate:function(e){return e.data("_qyerTextArea").isValidate()},getValue:function(e){return e.data("_qyerTextArea").getTextArea().value},unload:function(e){e.data("_qyerTextArea").unload()},reset:function(e){e.data("_qyerTextArea").setValue("")},setValue:function(e,t){e.data("_qyerTextArea").setValue(t)}},r=n.type(i),"object"==r||"undefined"==r)n.each(this,function(e,o){var r,a;r=n(o),a=n.extend({},i),a.max="undefined"!=typeof a.max?a.max:-1,a.min="undefined"!=typeof a.min?a.min:0,a.width=1==n.isNumeric(r.attr("data-width"))?r.attr("data-width"):null,a.height=1==n.isNumeric(r.attr("data-height"))?r.attr("data-height"):null,r.data("_qyerTextArea")||r.data("_qyerTextArea",new t({$obj:r,option:a})),r=a=null});else if("string"==r){var a,s,l=[];if(s=arguments,n.each(this,function(t,r){if(a=n(r),o[i]){var d=e(s,1);d.unshift(a),l.push(o[i].apply(a,d)),d=null}}),a=s=null,l.length)return 1==l.length?l[0]:l}return o=r=null,this}})}),define("common/models/basic/js/require-css!web_old_inputvalidation",[],function(){}),define("web_old_inputvalidation",["css!web_old_inputvalidation"],function(){function e(e,n){this.$obj=t(e),this.option=n,this.init()}var t=jQuery;e.prototype={$obj:null,$textDiv:null,option:null,init:function(){var e=this;this.setDefault(),this.option.blurAutoCheck!==!1&&this.$obj.blur(function(){e.check()}),this.$obj.focus(function(){e.clearTip()})},setDefault:function(){switch(this.option.defaultType){case"mail":this.option.exp=/^([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,6}$/,this.option.text=this.option.text||"邮箱地址格式错误";break;case"phone":this.option.exp=/^1[3|4|5|7|8][0-9]\d{4,8}$/,this.option.text=this.option.text||"手机号码格式错误";break;case"identityID":this.option.exp=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,this.option.text=this.option.text||"身份证号码格式错误";break;case"async":var e=this;this.option.exp=function(){return e.$obj.addClass("ui3_input_icon_loading"),e.$obj.removeClass("ui3_input_icon_error ui3_input_icon_ok"),e.option.asyncCheck(e.$obj.val(),function(t){setTimeout(function(){e.$obj.removeClass("ui3_input_icon_loading"),t?(e.option.text=t,e.addTip(),e.$obj.addClass("ui3_input_icon_error")):e.$obj.addClass("ui3_input_icon_ok")},10)}),!0}}},check:function(){var e=!1;switch(t.type(this.option.exp)){case"regexp":this.option.exp.lastIndex=0,e=this.option.exp.test(this.$obj.val());break;case"function":e=this.option.exp(this.$obj.val())}return this[e?"clearTip":"addTip"](),e},clearTip:function(){this.$obj.removeClass("qui-errorip ui3_input_icon_error"),this.$textDiv&&(this.$textDiv.remove(),this.$textDiv=null)},addTip:function(){this.$obj.addClass("qui-errorip"),this.$obj.hasClass("ui3_input")&&this.$obj.addClass("ui3_input_icon_error"),this.$textDiv&&this.$textDiv.remove();var e="qui-errorip-textDiv"+(this.option.style||"");this.$textDiv=t('<div class="'+e+'"><div class="tip"> <p class="a1"></p> <p class="a2"></p> </div> <div class="text">'+this.option.text+"</div> </div>");var n=this.$obj[this.option.parent?"position":"offset"]();if(1==this.option.style){this.$textDiv.appendTo(this.option.parent||document.body);var i=t(this.option.parent||document.body).outerWidth();i-=n.left,i-=this.$obj.outerWidth(),i=i-this.$textDiv.outerWidth()/2+16,this.$textDiv.css({right:i,top:n.top-25})}else this.$textDiv.css({left:n.left+10,top:n.top+this.$obj.outerHeight()-1}),this.$textDiv.appendTo(this.option.parent||document.body)},clear:function(){this.clearTip()}},t.fn.extend({qyerInputValidation:function(n){var i,o=!1,r=this;return t.each(this,function(){i=t(this),i.data("__errorTip__")?"clear"==n?(o=r,i.data("__errorTip__").clear()):o=i.data("__errorTip__").check():i.data("__errorTip__",new e(this,n))}),r=null,n?this:o;
}})}),define("common/models/basic/js/require-css!web_ct_openAsk",[],function(){}),define("web_ct_openAsk",["web_old_popup","web_old_tip","web_old_textarea","web_old_inputautocomplete","web_old_inputvalidation","css!web_ct_openAsk"],function(e,t){function n(e){i.extend(this.option,this.defaultOption),this.option=e,this.init()}if("undefined"!=typeof jQuery){var i=jQuery,o=function(e){var t=[{from:11,name:"place_profile",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+\/(profile|citytransport|when-to-go|cost|information|advice|ctytransport|ncost|pracinfo|nadvice|whentogo|carrental|ctyprofile|nvisa|transportation)/},{from:12,name:"place_travelnote",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+\/travel-notes/},{from:13,name:"place_city",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+/},{from:14,name:"bbs_forum",reg:/^http(s)?:\/\/bbs\.qyer\.com\/forum-[^\/]+/},{from:15,name:"bbs_index",reg:/^http(s)?:\/\/bbs\.qyer\.com\/?\??/},{from:16,name:"ask_tags",reg:/^http(s)?:\/\/ask\.qyer\.com\/tags/},{from:17,name:"ask_detail",reg:/^http(s)?:\/\/ask\.qyer\.com\/question\/\d+/},{from:18,name:"ask_search",reg:/^http(s)?:\/\/ask\.qyer\.com\/search/},{from:19,name:"ask_index",reg:/^http(s)?:\/\/ask\.qyer\.com\/?\??/},{from:20,name:"search_ask",reg:/^http(s)?:\/\/search\.qyer\.com\/ask/},{from:21,name:"ucenter_ask",reg:/^http(s)?:\/\/www\.qyer\.com\/u\/\d+\/ask/}],n=function(){for(var e,n=window.location.href,i=0,o=t.length;o>i;i+=1){var r=t[i];if(r.reg.test(n)){e=r.from;break}}return e||0};return e||n()};i.ajaxSetup({traditional:!0}),n.prototype={option:null,popup:null,tags:[],forums:{},defaultOption:{fid:0,from:0},getFNameByID:function(e){var t=this.forums,n=[];for(var i in t)n=n.concat(t[i]);for(var o=0;o<n.length;o++)if(n[o].id==e)return n[o].name},API:{baseURL:/^bbs\.qyer\.com/.test(location.host)?"/qyerajax.php":"/ajax.php",getTagByString:function(e){e.posturl=this.baseURL+"?action=maketag&ispopup=1&returnjson=1",window.qyerUtil.doAjax(e)},getTagByTag:function(e){e.posturl=this.baseURL+"?action=TopicMenu",window.qyerUtil.doAjax(e)},submitForm_openAsk:function(e){e.posturl="/qcross/ask/json/askpopup",window.qyerUtil.doAjax(e)}},init:function(){this.initFrame()},checkOpenAskForm:function(){var n=i(e.getContent()),r=n.find("input[name='js_question_title']"),a=n.find("input[name='js_ask_fid']"),s={error:!1,data:{}};if(0==r.qyerInputValidation())return s.error=!0,s;if(this.tags.length<1)return t.tip({text:"没有标签的问题，石沉大海，无人回答哦",type:"error"}),s.error=!0,s;if(s.error===!1){s.data={title:n.find("input[name='js_question_title']").val(),content:n.find("textarea[name='js_ask_content']").val(),"tag[]":[],fid:n.find("input[name='js_ask_fid']").val(),from:o()};for(var l=0,d=this.tags.length;d>l;l++)s.data["tag[]"].push(this.tags[l])}return n=r=$tag=a=null,s},_bindEvt:function(){var n=i(e.getContent()),o=n.find(".js-dropmenu"),r=n.find(".js-dropmenu-popup"),a=n.find("input[name='js_ask_fid']"),s=this;n.off("click.popup").on("click.popup",".js-btn-submit-openAsk",function(){var n=s.checkOpenAskForm(),o=i(this);o.hasClass("ui_button_load")||n&&n.error===!1&&(s.setBtnStatus(o,1),opt={data:n.data,onSuccess:function(n){("undefined"==typeof s.option.onSuccess||"function"==typeof s.option.onSuccess&&s.option.onSuccess(n.data)!==!1)&&o.next().attr("target",s.option.target||"_self").attr("href",n.data.jumpurl)[0].click(),s.setBtnStatus(o,0),e.hide(),t.tip({text:"提问成功！经验+1"})},onError:function(e){s.option&&s.option.onError&&"function"==i.type(s.option.onError)&&s.option.onError(),s.setBtnStatus(o,0),t.tip({text:e.__server_error__?"服务器响应失败，请重试":e.data.msg,type:"error"})}},s.API.submitForm_openAsk(opt))}).on("click",".js-btn-cancel-openAsk",function(){e.hide()}).on("click",".js-dropmenu",function(){r.toggleClass("hide"),o.toggleClass("open")}).on("click",".js-dropmenu-popup .item a",function(){var e=i(this);o.toggleClass("open").find("em").text(e.text()),r.toggleClass("hide"),a.val(e.attr("data-id"))}).on("blur",'input[name="js_question_title"]',function(){s.searchTag(i(this).val())}).on("click",".js-btn-tag-close",function(){s.removeATag(i(this).parent())})},setBtnStatus:function(e,t){0===t?e.removeClass("ui_button_load ui_button_disabled").addClass("ui_button"):e.removeClass("ui_button").addClass("ui_button_load")},getForumSublistHTML:function(e,t){var n=18,t=t||1,o=n*(t-1),r=n*t-1,a="";return i.each(this.forums[e],function(e,t){var n="";if(e>=o&&r>=e){var n='<dd class="js-bbs"><a data-id="'+t.id+'" href="javascript:void(0);">'+t.name+"</a></dd>";a+=n}}),a},getTpl:function(){var e=['<h2 class="openAsk-askTitle fontYaHei p20 mt20">提问</h2>','<div class="qui-textArea openAsk-title p20" data-width="720" data-height="32">','<input placeholder="输入完整清晰的问题" class="ui2_textarea bs" name="js_question_title"/>','<div class="tips">','<span class="current"></span>/<span class="max"></span>字',"</div>","</div>",'<h2 class="openAsk-contentTitle fontYaHei p20">详细内容<em class="fz12">(可选)</em></h2>','<div class="qui-textArea openAsk-content clearfix p20" data-width="720"  data-height="128">','<textarea placeholder="在这里添加详细内容" class="ui2_textarea bs" name="js_ask_content"></textarea>','<div class="tips">','<span class="current"></span>/<span class="max"></span>字</div>',"</div>",'<dl class="tags bs p20">','<dt class="tag-title vm">标签：</dt>','<p class="tag-input-ribbon vm">','<input type="text" value="" placeholder="添加标签" class="tag-input js-tag-input" />',"</p>","</dl>",'<div class="ask-bottom-box p20 bs">','<div class="publish-box js-dropmenu">','<em class="publish-title">选择同时发布的论坛版面</em><span class="publish-arrow"></span>',"</div>\t\t\t",'<input type="button" class="ui_button fr js-btn-submit-openAsk" value="提问"/>',"<a></a>",'<input type="button" class="ui_button_cancel fr mr10 js-btn-cancel-openAsk" value="取消" />','<div class="js-dropmenu-popup bbs-container hide">','<div class="item">',"<dl>","<dt>穷游兴趣小组</dt>",this.getForumSublistHTML("穷游兴趣小组"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游欧洲</dt>",this.getForumSublistHTML("穷游欧洲"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游亚洲</dt>",this.getForumSublistHTML("穷游亚洲",1),"</dl>","</div>",'<div class="item">',"<dl>",this.getForumSublistHTML("穷游亚洲",2),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游美洲</dt>",this.getForumSublistHTML("穷游美洲"),"</dl>","<dl>","<dt>穷游大洋洲</dt>",this.getForumSublistHTML("穷游大洋洲"),"</dl>","<dl>","<dt>穷游非洲</dt>",this.getForumSublistHTML("穷游非洲"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>线上线下</dt>",this.getForumSublistHTML("线上线下"),"</dl>","<dl>","<dt>后院</dt>",this.getForumSublistHTML("后院"),"</dl>","</div>","</div>","</div>",'<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="js_ask_fid" />','<input type="hidden" name="js_ask_oper" />','<input type="hidden" name="js_ask_from" />'].join("");return e},initFrame:function(){var t=this;e.show({contentHTML:'<div style="padding:100px; text-align:center;">loading</div>',width:760,title:"提问",exClassName:"qui-openAskContainer",showTitle:!1,showOKBtn:!1,showCancelBtn:!1,onShow:function(){var n="/qcross/bbs/thread.php?action=getForums";i.get(n,function(n){var i;0==n.error_code?(t.forums=n.data,i=t.getTpl(),e.setContent(i),t._initComponent(),t._bindEvt()):e.hide()},"json")}})},encode:function(e){var t="";return 0==e.length?"":(t=e.replace(/&/g,"&gt;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/ /g,"&nbsp;"),t=t.replace(/\'/g,"&#39;"),t=t.replace(/\"/g,"&quot;"),t=t.replace(/\n/g,"<br>"))},_initComponent:function(){var t=this,n=i(e.getContent()),o=n.find(".js-tag-input"),r=n.find(".openAsk-title");n.find("input[name='js_ask_fid']").val(t.option.fid),n.find(".publish-title").html(t.getFNameByID(t.option.fid)),n.find("input[name='js_ask_from']").val(t.option.from),n.find("input[name='js_ask_oper']").val(1),n.find(".openAsk-title").qyerTextArea({min:1,max:50}).end().find(".openAsk-content").qyerTextArea({max:1e3}).end().find("input[name='js_question_title']").qyerInputValidation({parent:r[0],text:"至少写够1个字，最多不超过50字",exp:function(e){return/^.{1,50}$/.test(e)}}).end().find(".js-tag-input").qyerAutocomplete({parent:o.parent()[0],onSearch:function(){function e(e){var t,n=[],i=e.data.item,o=i.length;if(1>o)n.push('<div class="qui-inputAutocomplete-noResult">没有找到任何结果</div>');else{for(t=0;o>t;t++)n.push("<li data-tag="+i[t]+"><em>"+i[t]+"</em></li>");n.unshift('<ul class="qui-inputAutocomplete-ul js-inputAutoComplete">'),n.push("</ul>")}return n.join("")}var n=o.val(),r={data:{keyword:n},onSuccess:function(t){if(t&&t.data&&"array"==i.type(t.data.item))try{o.qyerAutocomplete("pushHTML",e(t))}catch(n){}},onError:function(t){o.qyerAutocomplete("pushHTML",e(t))}};t.API.getTagByTag(r)},onSelect:function(e){t.addATag(e.getAttribute("data-tag")),o.val("")}})},searchTag:function(e){if(e){var t=this,n={data:{title:e},onSuccess:function(e){var n,i,o=e.data;if(o)for(i=0,n=e.data.length;n>i;i++)t.addATag(o[i])},onError:function(e){}};this.API.getTagByString(n)}},addATag:function(t){var n=i(e.getContent()).find(".tag-input-ribbon");this.tagIndexOfTags(t,this.tags)<0&&this.tags.length<5&&i.trim(t).length>0&&(i('<dd class="tag-item vm" title="'+t+'"><span class="tag">'+this.encode(t)+'</span><span class="btn-tag-close js-btn-tag-close"></span></dd>').insertBefore(n),this.tags.push(t),5==this.tags.length&&n.hide()),n=null},removeATag:function(e){var t=e.find(".tag").text(),n=this.tagIndexOfTags(t,this.tags);e.animate({marginTop:-40,opacity:0},200,function(){e.siblings(".tag-input-ribbon").show().end().remove()}),this.tags.splice(n,1),t=n=null},tagIndexOfTags:function(e,t){var n,i;for(n=0,i=t.length;i>n;n++)if(e===t[n])return n;return-1}};var r={qyerOpenAsk:function(e){window.qyerUtil.isLogin()?new n(e||{}):window.qyerUtil.doLogin()}};return r}}),define("old/js/slide",[],function(){function e(e){this._prev=e.prev,this._next=e.next,this._content=e.content,this._step=e.step||3,this._currentIndex=0,this._length=0,this._list=$(),this._liWidth=e.liWidth||236}function t(t){var n=new e(t);return n.init(),n}return e.prototype.doPrev=function(){this._currentIndex-this._step<0?this._currentIndex=0:this._currentIndex-=this._step,this._next.removeClass("disabled"),this.animate(this._currentIndex),0==this._currentIndex&&this._prev.addClass("disabled")},e.prototype.doNext=function(){this._currentIndex+this._step+this._step>this._length-1?this._currentIndex=this._length-this._step:this._currentIndex+=this._step;var e=this._currentIndex+this._step,t=this._list.find("li:lt("+e+")");t.each(function(e,t){var n=$(this).find("img[data-original]");n.each(function(e,t){var n=$(this).attr("src"),i=$(this).attr("data-original");n!==i&&$(this).attr("src",i)})}),this._prev.removeClass("disabled"),this.animate(this._currentIndex),this._currentIndex+this._step==this._length&&this._next.addClass("disabled")},e.prototype.animate=function(e){this._list.stop(!0).animate({left:-(e*this._liWidth)},500)},e.prototype.init=function(){var e=this;return this._list=this._content.find("ul"),this._length=this._list.find("li").length,this._list.css("width",this._liWidth*this._length),this._length<=this._step?void $(".plcMguidePage").hide():(this._prev.addClass("disabled"),this._prev.on("click",function(t){t.preventDefault(),e.doPrev()}),void this._next.on("click",function(t){t.preventDefault(),e.doNext()}))},t}),$(function(){requirejs(["common/models/common/component/planItinerary/tpl","common/models/common/component/planItinerary/model","common/models/common/component/planItinerary/browser","css!common/models/common/component/planItinerary/planItinerary","old/js/bbs_selimage"]),requirejs(["old/js/crumbdroplist"]),requirejs(["old/js/detail_infobar"]),requirejs(["old/js/detail_dockbar"]),requirejs(["old/js/gotoup"]),requirejs(["old/js/detail_floor"]),requirejs(["old/js/sideCatalog"]),requirejs(["old/js/detail/video"],function(e){e.translate($("[data-type=video], [data-type=media]"))});var e=$(".g-ban .title");e.height();e.addClass("f-dn");var t=e.text();e.attr("title",t);var n=t.length,i=77,o=e.height(),r=null;if(o<50)e.removeClass("tworow").addClass("onerow");else if(o>i){for(var a=n;a--;)if(o=e.empty().html(t.substring(0,a)).height(),o<i){e.empty().html(t.substring(0,a-1)+"...").removeClass("onerow").addClass("tworow");break}}else e.removeClass("onerow").addClass("tworow");requirejs(["common/models/common/component/shareIcon/shareIcon"],function(e){function t(e,t){if($(".rtt-wrap").removeClass("rttshow").remove(),k.setCookie("detail_reply_tooltip_flag",!0),!window.qyerUtil.isLogin())return void window.qyerUtil.doLogin();t.offset();if(t.find(".icon").html("&#xEA13;"),t.closest("#dock_icongroup").length)o=o?o:{position:"fixed",left:$(".bbs_setingIcon").offset().left+3,top:50},$(".m-popupreply").css(o).find(".itri").css("right","120px").end().fadeIn(300);else if(i=i?i:{position:"absolute",left:$(".bbs_setingIcon").offset().left+3,top:t.offset().top+t.height()+4},$(".m-popupreply").css(i).find(".itri").css("right","119px").end().fadeIn(300),"none"===$("#bbsDetailDockbar").css("display")){var n=$("#bbsDetailInfobar").offset().top+77-($(window).height()-179)/2;$(window).scrollTop()<n&&$("html,body").animate({scrollTop:n},300)}}function n(e){"like"==e.type&&(e.obj.setLike(e.data),e.obj.icons[e.type].setTxt(1==e.data?1:-1)),"collect"==e.type&&(e.obj.setCollect(e.data),e.obj.icons[e.type].setTxt(1==e.data?1:-1))}var i=null,o=null;$(document).on("popupeditor",function(e,t){var n,i=null,o=null;t?(n=$("#dock_icongroup .reply"),i={position:"fixed",left:$(".bbs_setingIcon").offset().left+3,top:50},o={right:"120px"}):(n=$("#bbsDetailInfobar .reply"),i={position:"absolute",left:$(".bbs_setingIcon").offset().left+3,top:n.offset().top+n.height()+4},o={right:"119px"}),n.find(".icon").html("&#xEA13;"),$(".m-popupreply").css(i).find(".itri").css(o).end().fadeIn(300)}).on("click",function(e){var t=$(e.target);!t.closest(".z-replyeditor").length&&!t.closest(".edui-popup").length&&!t.closest(".editor_selimage").length&&!t.closest(".editor_video").length&&$(".m-popupreply").fadeOut(300)&&$(".z-replyeditor").find(".icon").html("&#xEA12;")});var r=$(".bbs_info_content .bbs_setingIcon"),a=r.attr("data-islike"),s=r.attr("data-isfavorite"),t={type:"reply",txt:+r.attr("data-replies")||"",ipg:"bbs-thread-top-reply",iconfont:"&#xEA12;",selIconfont:"&#xEA13;",stsClassName:"z-replyeditor",txtafterclass:"replytxt",txtafteryet:"replytxtyet",hoverclass:"mouse_enter",leaveclass:"mouse_leave",onClick:t},l={type:"like",txt:+r.attr("data-likes")||"",iconfont:"&#xEA10;",selIconfont:"&#xEA11;",txtafterclass:"liketxt",txtafteryet:"liketxtyet",hoverclass:"mouse_enter",leaveclass:"mouse_leave",ipg:"bbs-thread-top-like"},d={type:"collect",txt:+r.attr("data-favorites")||"",iconfont:"&#xEA0B;",selIconfont:"&#xEA0C;",txtafterclass:"collecttxt",txtafteryet:"collecttxtyet",hoverclass:"mouse_enter",leaveclass:"mouse_leave",ipg:"bbs-thread-top-collect"},c={type:c,iconfont:"&#xEA2B;",selIconfont:"&#xEA3D;",txtafterclass:"sharetxt",hoverclass:"mouse_enter",leaveclass:"mouse_leave",url:window.location.href},u=new e({container:".bbs_info_content .bbs_setingIcon",tools:[l,d,t,c],tid:BBS.TID});t.ipg="bbs-thread-dock-reply",l.ipg="bbs-thread-dock-like",l.isChangeTxt=!0,d.ipg="bbs-thread-dock-favorites",d.isChangeTxt=!0;var p=new e({container:"#dock_icongroup",tools:[l,d,t],tid:BBS.TID});$(u).on("iconchange",function(e,t){t.obj=p,n(t)}),$(p).on("iconchange",function(e,t){t.obj=u,n(t)}),u.setLike(a),p.setLike(a),u.setCollect(s),p.setCollect(s)});var s=$("#__planItinerary__");if(s.size()>0&&requirejs(["common/models/common/component/planItinerary/index"],function(e){e.init({tid:BBS.TID,action:"browse",planid:s.attr("data-planid"),page:1,isNew:!0})}),3===BBS.TYPE&&+BBS.PLANID){var l=$(".plancontent .pcc"),d=$(".xpan-tip"),c=$(".qy_issue_showHide"),u=0,p="",h=!0;c.on("click","span",function(){var e=+$(this).hasClass("tShow");h&&(h=!1,p=l.height(),u=l.find("p").removeClass("x-dn").end().height(),l.height(p)),l.animate({height:[p,u][e]},500,function(){c.find("span").removeAttr("class").addClass(["tShow","tHide"][e]).html(["展开","收起"][e])})}),l.append("<p class='xplanloading'></p>"),$.get("/planapi/travelnote/route.php?action=getplan",{planid:BBS.PLANID,sourcetype:1,topicType:1},function(e){var t=$.parseJSON(e),n=[];if(d.attr("href",t.data.url).css("border","none"),t.data&&t.data.allday.length){for(var i=t.data.allday,o=0,r=null;r=i[o++];){var a='<span class="xs2 xfl">',s='<span class="xs3 xfl">';$.each(r.citys||[],function(e,t){var n=t.url?'<a href="'+t.url+'" target="_blank">'+t.name+"</a>":"<span>"+t.name+"</span>";n=e===r.citys.length-1?n:n+";",a+=n}),a+="</span>",$.each(r.hotels||[],function(e,t){s=s+'<a href="'+t.url+'" target="_blank"><span>'+(t.cn_name||t.en_name)+'</span><i class="iconding"></i></a>'}),s+="</span>",n.push('<p class="'+(o>3?"x-dn":"")+'"><span class="xs1 xfl">D'+o+"</span>"+a+s+"</p>")}l.empty().append(n.join("")),i.length>3&&c.css("display","block")&&l.css({overflow:"hidden"})}})}$(".bbs_detail_planCtl").on("click","a",function(){$(this).toggleClass("slideDown"),$(".bbs_detail_planbill").slideToggle(),$(".bbs_detail_planCtl .x-tool-xtm span").toggleClass("x-dn")}),s.on("click",".b_details-self",function(){window.location.assign("/thread-edit?tid="+BBS.TID+"&pid="+$(".bbs_detail_item").eq(0).attr("data-id"))}),$(".bbsDetailContentQuote").on("click",".more",function(){var e="opened",t=$(this).parents(".bbsDetailContentQuote"),n=t.hasClass(e);n?t.removeClass(e):t.addClass(e)}),requirejs(["old/js/imgTool"],function(e){var t=null,n=null,i=null;$(".bbs_detail_list").on("mouseenter",".qyer_image > img,.js_addImgSpan",function(){clearTimeout(i);var o=$(this);if(o.height()&&o.width()){var r={photoid:o.data("id")||o.attr("id"),status:likephoto["id_"+o.data("id")]?1:0},a=o.offset();BBS.ISADMIN?$.extend(r,{tid:BBS.TID,fid:BBS.FID}):r,n=e.show(r),t=e.obj,n.appendTo("body"),+o.parents(".bbs_detail_item").attr("data-uid")===+QYER.uid?$("#_bbs_img_toolbar .like._like").hide():$("#_bbs_img_toolbar .like._like").show(),n.css({top:o.offset().top-30+o.height(),right:$(window).width()-a.left-o.width()}),n.attr("data-floorid",o.parents(".bbs_detail_item").attr("data-id")),n.show(),n.off("mouseenter").on("mouseenter",function(){clearTimeout(i)}).off("mouseleave").on("mouseleave",function(){i=setTimeout(function(){n&&n.hide()},100)})}}).on("mouseleave",".qyer_image > img,.js_addImgSpan",function(){$(this);i=setTimeout(function(){n&&n.hide()},100)}).on("click",".qyer_image,.js_addImgSpan",function(e){return $("#_bbs_img_toolbar .seeLarge._see").get(0).click(),e.preventDefault(),!1})}),$(".bbsDetailContainer").find("img").each(function(e,t){!$(t).attr("data-id")&&$(t).css("vertical-align","bottom")});var f=$(".bbsDetailContainer .qyer_image,.bbsDetailContainer .js_addImgSpan");f.length&&$.each(f,function(e,t){var n=$.parseJSON($(t).attr("data-info")||"{}");if(!$.isEmptyObject(n)){var i=n.place.id?"-"+n.place.id:"";$(t).after("<div class='imagedest-wrap'><i class='bicf'></i><a class='x-image-dest' href="+n.place.url+" target='_blank' style='border:none;' data-bn-ipg='bbs-thread-placeLink"+i+"'>"+n.place.name+"</a></div>")}}),$.each($(".bbsPlaceLabel,.bbsbizlabel,.bbsLmLabel"),function(e,t){var n=$(t).parent().get(0),i=n.currentStyle?n.currentStyle.color:window.getComputedStyle(n,null).color;$(t).css({"text-decoration":"none","border-bottom":"1px "+($(t).hasClass("bbsPlaceLabel")||$(t).hasClass("bbsLmLabel")?"dotted ":"solid ")+i,color:i})}),$.each($("a>span"),function(e,t){var n=$(t).css("color");$(t).parents("a").css({color:n,"text-decoration":"none","border-bottom":"1px solid "+n})}),$("a>img").parent().css("border","none"),$(".xpan-tip").css("border","none"),$(".from-device").hover(function(){var e=$(this).find(".fromdevice-download"),t=(($(this).offset()||{}).top||0)-$(window).scrollTop()>e.height(),n=["appdownLoad.png","appdownloaddown.png","18px","-330px"];e.css({background:"url(//common1.qyerstatic.com/bbs/old/images/"+n[+t]+") no-repeat",top:n[+t+2]}).show()},function(){$(this).find(".fromdevice-download").hide()}),$(".bbs_banner_none .signs .text").height()>50&&$(".bbsbanner-nohp").css("height","145px")&&$(".new-ban.bbs_banner_none").css("height","222px");var m={imgClass:".xdetailauthen",ttClass:".xtt-wrap",initTmpl:function(){$(this.ttClass).remove(),$("body").append('<span class="xtt-wrap"><span class="xtt-inner"><span class="xtt-l"></span><span class="xtt-c"></span><span class="xtt-r"></span></span><span class="xtt-sj"></span></span>')},bind:function(){var e=this,t=$(e.ttClass);$(e.imgClass).hover(function(){var e=$(this),n=e.offset()||{top:0,left:0},i=+e.attr("data-tooltiptype")||0,o=0,r=["xttd.png","xttu.png","-2px","-31px"];t.find(".xtt-sj").css({"background-image":"url(//common1.qyerstatic.com/bbs/old/images/"+r[i]+")",top:r[i+2]}),t.find(".xtt-c").html(e.attr("data-title")),o=i?n.top+e.height()+8:n.top-e.height()-18,t.css({left:n.left-(t.width()-e.width())/2+"px",top:o+"px"}).css("display","block")},function(){t.hide()}).on("click",function(e){return window.location.href=$(this).attr("data-url"),!1})},init:function(){this.initTmpl(),this.bind()}};m.init(),$(".bs-it").on("focus",function(){$(this).parent().css("border-color","#10b041")}).on("blur",function(){$(this).parent().css("border-color","#d7d7d7")});var g={btn:$(".bd-pub"),closeBtn:$(".intclose"),modal:$("#issueNewThread"),askBtn:$(".js-open-ask-layer"),bind:function(){var e=this;e.btn.off("click.issueThread").on("click.issueThread",function(){return window.qyerUtil.isLogin()?void e.modal.fadeIn(300):void window.qyerUtil.doLogin()}),e.closeBtn.off("click.issueThread").on("click.issueThread",function(){e.modal.fadeOut(300)}),e.askBtn.on("click",function(){e.modal.hide(),requirejs(["web_ct_openAsk","web_old_tip"],function(e,t){e.qyerOpenAsk({target:"_blank",from:1,onError:function(){t.tip({text:"提问失败",type:"warning"})}})})})},init:function(){this.bind()}};g.init();var b={bs:$(".cnb-sj"),bc:$(".cnb-container"),dom:null,bind:function(){var e=this,t=null,n=null,i=e.bs.width(),o=e.bs.height();$(".j-bannerhover").hover(function(){var r=$(this),a=r.hasClass("itma"),s=0;if(clearTimeout(n),a&&(e.dom=r,s=r.offset().top+r.height()+4,e.bs.css({left:e.dom.offset().left+(e.dom.width()-i)/2,top:s}),e.bc.css("top",s+o-1).find("."+r.attr("data-show")).show().siblings().hide(),r.hasClass("j-world"))){var l=$(".cnbcii-u"),d=$(".cnbci-sec"),c=$(".cnbci-th");l.data({splitlen:9,left:"108px"}),d.data({splitlen:14,left:"136px"}),c.data({splitlen:14,left:"108px"}),e.reList([l,d,c])}t=setTimeout(function(){e.bc.fadeIn(300),e.bs.fadeIn(300),a&&$(".j-bannerhover").removeClass("cnb-hover")&&r.addClass("cnb-hover")},100)},function(){$(this);clearTimeout(t),n=setTimeout(function(){e.bc.fadeOut(300),e.bs.fadeOut(300),$(".j-bannerhover").removeClass("cnb-hover")},600)})},reList:function(e){$.each(e,function(e,t){var n=[],i=[];$.each(t.find("li"),function(e,o){e<t.data("splitlen")?n.push(o):(i.push($(o)),$(o).hide())});for(var o=0,r=i.length;o<r;o++)i[o].css({position:"absolute",display:"block",left:t.data("left"),top:n[o].offsetTop})})},hide:function(){this.bc.hide(),this.bs.hide()},init:function(){var e=this,t=$(".cnbcii-u"),n=$(".cnbci-sec"),i=$(".cnbci-th");t.data({splitlen:9,left:"108px"}),n.data({splitlen:14,left:"136px"}),i.data({splitlen:14,left:"108px"}),e.reList([t,n,i]),e.bc.hide().removeClass("xvh"),e.bind()}};b.init();var v={baseLeft:0,sameDebateFlag:"",keyword:"",template:'<div class="debate-popup dp-0"><div class="dp-triw"><i class="dp-tri dpt1"></i><i class="dp-tri dpt2"></i></div><ul class="dp-list"><li class="dpl-item dpl1"><div class="dpli-con1"><img width="90" height="90" src="" alt="折扣图片" class="dpli-img"/><i class="dpli-flag">销量冠军</i></div><div class="dpli-con2"><h4 class="dpli-title"></h4><h4 class="dpli-onlytitle"></h4><div class="dpli-desw"></div><a href="#" class="dpli-a" target="_blank"><strong class="dplia"></strong>元</a></div><a href="#" class="dpl-href" target="_blank"></a></li><li class="dpl-item dpl2 dpli-3"><div class="dpli-con1"><img width="90" height="90" src="" alt="折扣图片" class="dpli-img"/></div><div class="dpli-con2"><h4 class="dpli-title"></h4><a href="#" class="dpli-a" target="_blank"><strong class="dplia"></strong>元</a></div><a href="#" class="dpl-href" target="_blank"></a></li><li class="dpl-item dpl3 dpli-3"><span class="dpl3-line"></span><div class="dpli-con2"><h4 class="dpli-title"></h4><a href="#" class="dpli-a" target="_blank"><strong class="dplia"></strong>元</a></div><a href="#" class="dpl-href" target="_blank"></a></li></ul></div>',render:function(e,t){var n=this,i=$.parseJSON(e)||[],o=i.length,r=n.tmpl,a=$(".debate-popup");r.find(".dpl1");o&&($.each(i,function(e,t){var i=r.find(".dpl"+(e+1)),a=t.highlight;if(i.length&&i.find(".dpli-img").attr("src",t.picture+"/90"||"//common1.qyerstatic.com/bbs/old/images/detail/test1.jpg").end().find(".dpli-title").html(t.title).end().find(".dplia").html(t.price).end().find(".dpli-a").attr("href",t.url).end().find(".dpl-href").attr("href",t.url).attr("data-bn-ipg","bbs-thread-lmCard-"+n.keyword+"-"+o),0===e&&a&&a.length){var s="";if(a.match(/<p>.*<\/p>/))s=a;else{a=a.split(/\<br\s*\/\>/).slice(0,3);for(var l=0,d=a.length;l<d;l++)s=s+"<p>"+a[l]+"</p>"}i.find(".dpli-desw").html(s)}}),a.get(0).className=$(".debate-popup").get(0).className.replace(/dp-\d?/,"dp-"+o),t&&t(i[0].highlight,i[0].title))},bind:function(){var e=this,t=null,n=null,i=0,o=0,r=$(".debate-popup"),a=e.tmpl.find(".dp-triw");$("body").on("mouseenter mouseleave",".bbsLmLabel",function(s){var l=$(this);e.keyword=l.text(),"mouseenter"===s.type?(t&&clearTimeout(t),n=setTimeout(function(){var t=l.offset(),n=l.height();i=t.left,e.render(l.attr("data-info"),function(s,d){if(o=l.width(),r.removeClass("dp-onlytitle"),r.css("left",e.baseLeft),a.css("left",i+o-e.baseLeft-15),r.hasClass("dp-1"))if(s)$(".dp-1").removeClass("dp-onlytitle"),r.css("left",e.baseLeft),a.css("left",i+o-e.baseLeft-15);else{$(".dp-1").addClass("dp-onlytitle").find(".dpli-onlytitle").html(d);var c=r.width(),u=i-c/2+o-10,p=0;u<e.baseLeft?(dptl=e.baseLeft,p=i-dptl+o-15):(dptl=u,p=(c-12)/2),r.css("left",dptl),a.css("left",p)}e.tmpl.css("top",t.top+n+12).show()})},200)):(n&&clearTimeout(n),t=setTimeout(function(){e.tmpl.hide()},250))}),e.tmpl.on("mouseenter mouseleave",function(n){"mouseenter"===n.type?clearTimeout(t):t=setTimeout(function(){e.tmpl.hide()},250)})},init:function(){var e=$(".bbs_content");this.tmpl=$(this.template),$("body").append(this.tmpl),this.baseLeft=e.offset().left+(e.width()-this.tmpl.width()-2)/2,this.bind()}};v.init(),requirejs(["old/js/bbs_normal_editor","web_old_loading","web_old_tip","web_ct_submitBeforeValidCode"],function(e,t,n,i){var o=new e({tools:["faces","image","video"],target:document.getElementById("J_replyfast"),id:(new Date).getTime(),isPopupReply:!0,editorOpt:{initContent:"",initialFrameHeight:75,initialStyle:"body{padding:0 5px;overflow-y:auto !important;overflow-x:hidden;max-height:130px !important} img{max-width:100% !important;padding:0 !important;} p{padding:6px 4px 4px;font-size:14px;line-height:22px;} .qyer_video{width:276px !important;}",zIndex:0,focus:!0,isSubmit:!1},hasSenior:!1,onPopupEditorCancel:function(){$(".m-popupreply").fadeOut(300),$(".z-replyeditor .icon").html("&#xEA12;")},onPostReply:function(e,o){var r=this;i(function(i){t.show({text:"正在提交内容..."});var o="/thread-reply",a=(new Date).getTime()+Math.random();$.get(o+"?tid="+window.BBS.TID+"&_rd="+a,function(a){if("ok"===a.result){var s={token:a.data.token,tid:window.BBS.TID,content:e,valid_code:i,fast_reply:1};$.post(o,s,function(e){if(t.hide(),"ok"==e.result){n.tip({text:"回复成功"}),r.onPopupEditorCancel(),r.editor.setContent("");var i=$("#bbsDetailInfobar .z-replyeditor .txt");i.html(+i.html()+1),$(".bbs_detail_item").length<15&&window.location.reload()}else n.tip({text:e.data,type:"warning"})},"json")}},"json")})}});o.editor.addListener("afterinsertimage",function(e,t){setTimeout(function(){t.curScrollTop&&$(window).scrollTop(t.curScrollTop)},200)}),$(document).on("x-editDomInsert",function(e,t){setTimeout(function(){$(window).scrollTop(t)},200)})});var y={wrap:$(".m-recommend"),con:$(".recwrap"),lkUrl:[],getTmpl:function(){return'<li><a class="item clearfix _index_" href="_href_" target="_blank" data-bn-ipg="_tab_"><img class="ltimg" src="_url_" alt="" width="80" height="80"><div class="conwrap"><p class="lt-title">_title_</p><p class="lt-price"><b class="f-num ltnum">_price_</b>元起</p></div></a></li>'},getData:function(){return $.get("qcross/bbs/thread.php?action=getBusinessRecommend&tid="+BBS.TID)},render:function(){var e=this;e.getData().then(function(t){var n=$.parseJSON(t);if("ok"===n.result){var i=n.data,o='<ul class="wrap">';if(!(i.localHot||i.ticket||i.traffic||i.travel))return;e.wrap.removeClass("xvh"),$.each(i,function(t,n){n?(n.list&&n.list.length&&($.each(n.list,function(i,r){var a=e.getTmpl();a=i?i===n.list.length-1?a.replace(/_index_/,"last"):a:a.replace(/_index_/,"first"),o+=a.replace(/_href_/,r.url).replace(/_url_/,r.img).replace(/_title_/,r.title).replace(/_price_/,r.price).replace(/_tab_/,"bbs-thread-rightlm-"+t+"-"+(i+1))}),$(".j-"+t).empty().html(o+"</ul>"),o='<ul class="wrap">'),e.lkUrl.push(n.url),e.wrap.find("[data-type="+t+"]").show()):e.wrap.find("[data-type="+t+"]").hide()})}})},bindEvent:function(){var e=this,t=e.wrap,n=null,i=null,o=!0,a=!0;$("body").on("elevatorloaded",function(){var n=t.offset(),i=t.height(),s=n.top+i-51;r=s;var l=$(".bbs_content").offset().left+840;$(window).scrollTop()>s?(o&&(o=!1,t.css({position:"fixed",width:"364px",top:"45px",left:l}).addClass("z-recfixed"),t.find(".t_item").removeClass("cur"),e.con.hide(),$.each(t.find(".recwrap .item"),function(e,t){$(t).attr("data-bn-ipg",$(t).attr("data-bn-ipg").replace(/rightlm/,"docklm"))}),$(".j-lkme").attr("data-bn-ipg","bbs-thread-docklm-more"),$("body").trigger("elevatordocking",1)),$(window).scrollTop()+$(window).height()>$(".qyer_footer").offset().top?a&&(a=!1,$("body").trigger("elevatorbottomchange",1)):a||(a=!0,$("body").trigger("elevatorbottomchange",0))):(t.find(".t_item").eq(0).addClass("cur"),e.con.show(),$("body").trigger("elevatordocking",0),$.each(t.find(".recwrap .item"),function(e,t){$(t).attr("data-bn-ipg",$(t).attr("data-bn-ipg").replace(/docklm/,"rightlm"))}),$(".j-lkme").attr("data-bn-ipg","bbs-thread-rightlm-more")),$(window).on("scroll",function(){if($(window).scrollTop()>s){if(o){var n=$(".bbs_content").offset().left+840;o=!1,t.css({position:"fixed",width:"364px",top:"45px",left:n}).addClass("z-recfixed"),t.find(".t_item").removeClass("cur"),e.con.hide(),$.each(t.find(".recwrap .item"),function(e,t){$(t).attr("data-bn-ipg",$(t).attr("data-bn-ipg").replace(/rightlm/,"docklm"))}),$(".j-lkme").attr("data-bn-ipg","bbs-thread-docklm-more")}$("body").trigger("elevatordocking",1),$(window).scrollTop()+$(window).height()>$(".qyer_footer").offset().top?a&&(a=!1,$("body").trigger("elevatorbottomchange",1)):a||(a=!0,$("body").trigger("elevatorbottomchange",0))}else{o=!0,t.css({position:"static",width:"368px",top:"",left:""}).removeClass("z-recfixed"),e.con.show(),$.each(t.find(".recwrap .item"),function(e,t){$(t).attr("data-bn-ipg",$(t).attr("data-bn-ipg").replace(/docklm/,"rightlm"))}),$(".j-lkme").attr("data-bn-ipg","bbs-thread-rightlm-more");var i=t.find(".previndex");i.length?i.addClass("cur").removeClass("previndex").siblings().removeClass("cur"):t.find(".cur").length?"":t.find(".t_item").eq(0).addClass("cur"),$("body").trigger("elevatordocking",0)}})}),t.on("mouseenter",".t_item,.recwrap",function(o){var r=$(o.target);i&&clearTimeout(i),r.hasClass("t_item")&&($(".j-lkme").attr("href",e.lkUrl[r.index()]),n=setTimeout(function(){r.find(".rtri").css("left",r[0].offsetLeft+(r.width()-12)/2),r.addClass("cur").siblings().removeClass("cur"),e.con.attr("data-index",r.index()).find(".j-"+r.attr("data-type")).fadeIn().siblings().hide(),t.hasClass("z-recfixed")&&"none"===e.con.css("display")&&e.con.slideDown()},200))}).on("mouseleave",".t_item,.recwrap",function(o){
n&&clearTimeout(n);$(o.target);i=setTimeout(function(){t.hasClass("z-recfixed")&&(t.find(".t_item").removeClass("cur"),e.con.slideUp(),t.find(".t_item").eq(e.con.attr("data-index")).addClass("previndex").siblings().removeClass("previndex"))},200)})},init:function(){this.render(),this.bindEvent()}};y.init(),$(window).resize(function(){var e=$(".bbs_content").offset().left+840;r&&$(window).scrollTop()>r&&($(".m-recommend").css({position:"fixed",width:"364px",top:"45px",left:e}).addClass("z-recfixed"),$(".j-elevator").css({position:"fixed",width:"368px",bottom:"-25px",left:e}))});var x=$(".g-ban .banimg"),_=x[0],w=function(){var e=x.width(),t=x.height(),n=1160*t/e,i=400*e/t,o=0;n>=400?(o=(n-400)/2,x.css({width:"1160px",top:"-"+o+"px"})):i>=1160?(o=(i-1160)/2,x.css({height:"400px",left:"-"+o+"px"})):x.css({height:"400px",width:"1160px"})};_.complete?w():_.onload=function(){w()};var k={setCookie:function(e,t,n){var i=new Date;return i.setTime(i.getTime()+24*n*60*60*1e3),document.cookie=e+"="+escape(t)+(n?";expires="+i.toGMTString():""),!0},getCookie:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null}},C={tl:null,bind:function(){var e=this;$(".rtt-close.bicf").on("click",function(){e.tl.removeClass("rttshow").remove(),k.setCookie("detail_reply_tooltip_flag",!0)})},init:function(){!k.getCookie("detail_reply_tooltip_flag")&&$("body").append('<div class="rtt-wrap"><div class="rtt-triangle"></div><div class="rtt-con">盖个楼，提个问，来跟楼主唠唠嗑～<a href="javascript:void(0);" class="rtt-close bicf">&#xEA29;</a></div></div>'),this.tl=$(".rtt-wrap"),this.tl.css("right",$(".bbs_wrap").offset().left+"px"),this.bind()}};C.init();var E=$(".bbs_detail_correlat"),T=$(".lists",E);E.append(""),require(["old/js/slide"],function(e){e({content:T,prev:$("#mguidePagePrev"),next:$("#mguidePageNext")})});var S={baseWidth:370,translate:"-webkit-transform:translateX(_move_);-moz-transform:translateX(_move_);transform:translateX(_move_)",outter:$(".m-localtravel"),index:1,slide:function(e){this.inner.get(0).style.cssText=this.translate.replace(/_move_/g,"-"+this.baseWidth*this.index+"px");var t=setTimeout(function(){e&&e(),clearTimeout(t)},300);return this},bind:function(){var e=this;e.outter.on("click",".bicf",function(){var t=$(this);t.hasClass("mlpl")?e.index=e.index-1:e.index=e.index+1;e.slide(function(){0===e.index&&(e.index=e.len),e.index===e.len+1&&(e.index=1),e.inner.removeClass("trans"),e.page.html(e.index),e.slide(function(){e.addTrans()})})})},addTrans:function(){var e=this.inner,t=setTimeout(function(){e.addClass("trans"),clearTimeout(t)},0);return this},init:function(){var e=this.outter,t=this.inner=$(".ml-inner",e),n=this.list=$(".wrap",e);this.page=$(".mlp-page",e);var i=this.len=n.length;if(i>1){var o=n.eq(0).clone(),r=n.eq(i-1).clone(),a=i+2;t.width(this.baseWidth*a),t.prepend(r).append(o),this.slide().addTrans().bind()}else $(".ml-page",e).hide()}};S.init(),window.BBS&&window._RATrack&&3==window.BBS.TYPE&&(window._RATrack.forum=2)}),define("old/js/detail",function(){}),function(e){var t=document,n="appendChild",i="styleSheet",o=t.createElement("style");o.type="text/css",t.getElementsByTagName("head")[0][n](o),o[i]?o[i].cssText=e:o[n](t.createTextNode(e))}('.qui-popup{\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    background-image:url(//static.qyer.com/models/common/images/bg_255_255_255_0.7.png);\n    z-index: 1000;\n    overflow-y: auto;\n    opacity: 0;\n}\n.qui-popup > div{\n    display: table;\n    height: 100%;\n    margin: 0 auto;\n}\n.qui-popup-dt{\n    display: table-cell;\n    vertical-align:middle;\n}\n.qui-popup-box{\n    margin: 0 auto;\n    background-color: #fff;\n    position: relative;\n    -webkit-box-shadow: 0 0 6px #aaa;\n    -moz-box-shadow: 0 0 6px #aaa;\n    box-shadow: 0 0 6px #aaa;\n    border: solid 1px #ccc;\n    \n    opacity: 0;\n}\n.qui-popup-box-title{\n    height: 60px;\n    line-height: 60px;\n    font-size: 18px;\n    font-weight: bold;\n    padding-left: 20px;\n}\n.qui-popup-box-content{\n    -webkit-box-sizing: border-box; \n    -moz-box-sizing: border-box;  \n    box-sizing: border-box; \n    padding: 0 20px;\n}\n.qui-popup-box-content >iframe{\n    width: 100%;\n    border: none;\n}\n.qui-popup-box-bottom{\n    text-align: right;\n    height: 70px;\n    line-height: 70px;\n    padding-right: 20px;\n}\n.qui-popup-closeIcon{\n    position: absolute;\n    right: 10px;\n    top: 10px;  \n    cursor: pointer;\n    background-image: url("//static.qyer.com/models/common/ui/popup/ico.png");\n    height: 32px;\n    width: 32px;\n    background-repeat: no-repeat;\n    background-position:0 0;\n    border-radius: 5px;\n}\n.qui-popup-closeIcon:hover{\n    background-position: 0px -38px;\n}\n.qui-popup-cancelBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-okBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-loadingBtn{\n    vertical-align: middle;\n    display: none;\n    margin-left:10px;\n}.qui-tip{\n\tposition: fixed;\n\ttop: 100px;\n\tleft: 0;\n\twidth: 100%;\n\ttext-align: center;\n\tdisplay: none;\n\tz-index: 1100;\n}\n.qui-tip-box{\n\tdisplay: inline-block;\n\tmin-width:120px;\n\tmax-width:390px;\n\tpadding:20px 30px;\n\tbackground-color:#fff;\n\tbox-shadow: 0 2px 7px rgba(0,0,0,0.25);\n\tborder: solid 1px #c0c0c0;\n\ttext-align:left;\n\tfont-size: 18px;\n\tline-height: 32px;\n}\n.qui-tip-text { display:block; position:relative; padding-left:34px;}\n.qui-tip-text:before { content:\'\'; position:absolute; left:0; top:4px; width:24px; height:24px; background:#fff url(//static.qyer.com/models/common/ui/tip/icons2.png) no-repeat;}\n.qui-tip-box-error .qui-tip-text:before { background-position:0 -80px;}\n.qui-tip-box-warning .qui-tip-text:before { background-position:0 -40px;}.planItinerary{position: relative;z-index: 1;}\n#planItinerary_datepickerDiv{\n    position: absolute;\n    display: none;\n    z-index: 20;\n    left: 21px;\n    top: 50px;\n}\n.planItinerary > .contentTable{\n    width: 100%;\n    border-collapse: collapse;\n    background-color: #fff;\n    width:100%;\n}\n.planItinerary > .contentTable td{\n    border: 1px solid #f1f1f1;\n    vertical-align: top;\n}\n.planItinerary > .contentTable  .tHead{\n    height: 68px;\n    line-height: 68px;\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    background-color: #f9f9f9;\n    padding: 0 20px;\n}\n.planItinerary .tHead  .b_title{\n    color: #000;\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    font-size: 12px;\n    padding: 3px 0 0 25px;\n    cursor: default;\n}\n.planItinerary .tHead  .b_copyPlan,\n.planItinerary .tHead  .e_include{\n    float: right;\n    background-color: #0095db;\n    height: 35px;\n    line-height: 35px;\n    width: 127px;\n    color: #fff;\n    text-align: center;\n    border-radius: 3px;\n    font-size: 14px;\n    margin-top: 18px;\n    text-decoration: none;\n}\n.planItinerary .tHead  .b_copyPlan:hover,\n.planItinerary .tHead  .e_include:hover{\n    background-color: #3ba5e2;\n}\n.planItinerary .tHead  .b_details,\n.planItinerary .tHead  .e_del\n{\n    float: right;\n    margin: 18px 0 0 15px;\n    font-size: 14px;\n    color: #959595;\n    height: 35px;\n    line-height: 35px;\n}\n.planItinerary .tHead  .b_details-self{\n    background-color: #f3661f;\n    border-radius: 3px;\n    color: #fff;\n    float: right;\n    font-size: 14px;\n    height: 35px;\n    line-height: 35px;\n    margin-top: 18px;\n    text-align: center;\n    width: 127px;\n    margin-left: 20px;\n    text-decoration: none;\n}\n.planItinerary .tHead  .b_details-self:hover{\n    background-color: #f5802d;\n}\n.planItinerary .tHead .e_startTime{\n    width: 200px;\n    border: solid 1px #d8d8d8;\n    height: 35px;\n    line-height: 35px;\n    float: left;\n    background-color: #fff;\n    border-radius: 3px;\n    margin-top: 15px;\n    padding-left: 15px;\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    position: relative;\n    overflow: hidden;\n    cursor: pointer;\n}\n.planItinerary .tHead .e_startTime .icon{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    width: 38px;\n    height: 100%;\n    background-color: #5cad77;\n    background-repeat: no-repeat;\n    background-position: 0px -10px;\n    background-position: 10px -1240px;\n    top: 0px;\n    right: 0px;\n    position: absolute;\n}\n.planItinerary .tTitle{\n    background-color: #656c7e;\n    height: 40px;\n    line-height: 40px;;\n    color:#d4d9e2;\n    font-size: 16px;\n}\n.planItinerary .tTitle td{\n    border: none;\n    text-align: center;\n}\n.planItinerary .tTitle td span{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/evecticon.png);\n    background-repeat: no-repeat;\n    padding-left: 26px;\n    background-position: 0px -1px;\n    cursor: default;\n    color: #d4d9e2;\n    font-size: 16px;\n    line-height: 40px;\n}\n.planItinerary .tTitle td span.city{\n    background-position: -135px -1px;\n}\n.planItinerary .tTitle td span.traffic{\n    background-position: -256px -0px;\n}\n.planItinerary .tTitle td span.poi{\n    background-position: -389px -0px;\n}\n.planItinerary .tTitle td span.hotel{\n    background-position: -518px -0px;\n}\n.planItinerary .tBottom .b_toggle,\n.planItinerary .tBottom .e_addoneday{\n        text-align: center;\n        height: 50px;\n        line-height: 50px;\n        background-color: #f9f9f9;\n        font-size: 14px;\n        color: #696969;\n}\n.planItinerary .tBottom .b_toggle span{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    padding-left: 17px;\n    cursor: pointer;\n    background-position: 0px -410px;\n}\n.planItinerary .tBottom .b_toggle span.close{\n    background-position: 0px -338px;\n}\n.planItinerary .tBottom .e_addoneday{\n    text-align: left;\n    padding-left: 30px;\n}\n.planItinerary .tBottom .e_addoneday span{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    padding: 4px 0 3px 24px;\n    background-position: 0px -1149px;\n    cursor: pointer;\n}\n.planItinerary .tBottom .e_addoneday span:hover{\n    color: #5cad77;\n}\n.planItinerary .record .time{\n    padding: 20px 0 10px 5px;\n    vertical-align: inherit;\n}\n.planItinerary .record .time > a{\n    text-decoration: none;\n    line-height: 1;\n}\n.planItinerary .record .time > a >  span,\n.planItinerary .record .time > a >  div{\n    float: left;\n    color: #636363;\n    font-size: 16px;\n    margin-right: 4px;\n}\n.planItinerary .record .time .day{\n    font-size: 48px;\n    font-family: arial;\n}\n.planItinerary .record .time > a > div{\n    margin-top: 6px;\n}\n.planItinerary .record .time > a > div .line{\n    background-color: #cacaca;\n    height: 1px;\n    margin: 2px 0;\n}\n.planItinerary .record .time .e_null{\n    text-align: center;\n    float: none;\n    margin-left: -10px;\n    min-height: 70px;\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    padding-top: 17px;\n    cursor: pointer;\n}\n.planItinerary .record .time .e_null  span{\n    color: #b0b1b2;\n    padding: 17px 12px 12px 10px;\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    background-position: 2px -1364px;\n}\n.planItinerary .record .lift{\n    vertical-align:inherit;\n}\n.planItinerary .record .lift > a{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    background-position: 9px -83px;\n    cursor: pointer;\n    position: relative;\n    height: 19px;\n    display: block;\n    text-decoration: none;\n}\n.planItinerary .record .lift > a:hover > div{\n    display: block;\n}\n.planItinerary .record .lift > a > div {\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    background-position: 9px -172px;\n    position: absolute;\n    top: -35px;\n    width: 69px;\n    left: -19px;\n    height: 29px;\n    display: none;\n}\n.planItinerary .record .city {\n    padding: 10px 0 ;\n}\n.planItinerary .record .city > p{\n    overflow: hidden;\n    width: 90px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    font-size: 14px;\n    margin-left: 10px;\n}\n.planItinerary .record .city > p > a{\n    color: #636363;\n    text-decoration: none;\n}\n.planItinerary .record .poi {\n    padding: 10px 0 ;\n}\n.planItinerary .record .poi > p{\n    overflow: hidden;\n    width: 135px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    font-size: 14px;\n    margin-left: 10px;\n}\n.planItinerary .record .poi > p > a{\n    color: #636363;\n    text-decoration: none;\n}\n.planItinerary .record .poi > .note{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    background-position: 0px -250px;\n    cursor: pointer;\n    display: inline;\n    padding: 6px 10px 10px 6px;\n}\n.planItinerary .record .poi .notewrapTap{\n    position: relative;\n    z-index: 5;\n    display: none;\n}\n.planItinerary .record .poi .notewrap{\n    left: 30px;\n    padding: 0 0 0 24px;\n    position: absolute;\n    top: -7px;\n}\n.planItinerary .record .poi  .notewrap .arrow{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/arrow.png);\n    background-repeat: no-repeat;\n    position: absolute;\n    top: 0px;\n    left:4px;\n    width: 24px;\n    height: 24px;\n    z-index: 2;\n}\n.planItinerary .record .poi  .notewrap .content{\n    background-color: #fff;\n    border: 1px solid #d5d5d5;\n    border-radius: 3px;\n    padding: 20px;\n    width: 196px;\n    box-sizing: border-box;\n    color: #636363;\n    box-shadow: 0px 2px 5px #ccc;\n}\n.planItinerary .record .poi   .notewrap .del{\n    text-align:right;\n}\n.planItinerary .record .poi   .notewrap .del a{\n    padding: 7px;\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    background-position: 0px -922px;\n    text-decoration: none;\n    cursor: pointer;\n}\n.planItinerary .record .poi   .notewrap .del a:hover{\n    background-position: -1px -1033px;\n}\n.planItinerary .record .hotel {\n    padding: 10px;\n}\n.planItinerary .record .hotel > a{\n    text-decoration: none;\n    font-size: 14px;\n    color: #636363;\n    display: block;\n    word-break: break-all;\n}\n.planItinerary .record .hotel > a>span{\n    border-bottom: 1px dotted #0073b6;\n}\n.planItinerary .record .hotel > a.linkIcon{\n}\n.planItinerary .record .hotel > a.linkIcon .icon{\n    background-image: url("//static.qyer.com/models/common/component/planItinerary/images/other.png");\n    background-position: 7px -1692px;\n    background-repeat: no-repeat;\n    padding: 0 10px;\n}\n.planItinerary .record .hotel > a:hover{\n    color: #0073b6;\n}\n.planItinerary .record .hotel > p{\n    overflow: hidden;\n    width: 100px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    font-size: 12px;\n    color: #959595;\n    margin-top: 5px;\n}\n.planItinerary .record .traffic{\n    padding: 10px;\n    font-size: 14px;\n    color: #636363;\n}\n.planItinerary .record .traffic > p{\n    overflow: hidden;\n    width: 100px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    font-size: 12px;\n    color: #959595;\n    margin: -18px 0 25px 0;\n}\n.planItinerary .record .traffic > div {\n    position: relative;\n    \n    \n    margin-bottom: 20px;\n    word-break: break-all;\n}\n.planItinerary .record .traffic > div > span{\n    \n    top: 0px;\n    text-overflow: ellipsis;\n    \n    overflow: hidden;\n    \n}\n.planItinerary .record .traffic > div > span.start{\n    left: 0px;\n    \n}\n.planItinerary .record .traffic > div > .icon{\n    left: 45px;\n    width: 25px;\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/trafficicon.png);\n    background-repeat: no-repeat;\n}\n.planItinerary .record .traffic > div > span.end{\n    left: 67px;\n    \n}\n.planItinerary .record .traffic > div > .plane{\n    background-position: -228px 0px;\n}\n.planItinerary .record .traffic > div > .steamer{\n    background-position:-180px 0px;\n    width: 24px;\n    left: 42px;\n}\n.planItinerary .record .traffic > div > .taxi{\n    background-position:-124px 0px;\n    width: 30px;\n}\n.planItinerary .record .traffic > div > .bus{\n    background-position:-76px 0px;\n}\n.planItinerary .record .traffic > div > .walk{\n    background-position:-34px 0px;\n    width: 20px;\n}\n.planItinerary .record .traffic > div > .train{\n    background-position:6px 0px;\n}\n.planItinerary .recordedit .time,\n.planItinerary .recordedit .city,\n.planItinerary .recordedit .traffic,\n.planItinerary .recordedit .poi,\n.planItinerary .recordedit .hotel,\n.planItinerary .recordedit .setting{\n    background-color: #fff;\n    cursor: pointer;\n}\n.planItinerary .recordedit .city:hover,\n.planItinerary .recordedit .traffic:hover,\n.planItinerary .recordedit .poi:hover,\n.planItinerary .recordedit .hotel:hover{\n    background-color: #e6f4fb;\n}\n.planItinerary .record .null{\n    color: #d9d9d9;\n    text-align: center;\n    font-size: 16px;\n    vertical-align: inherit;\n    cursor: pointer;\n}\n.planItinerary .record .null:hover{\n    color: #8fcacc;\n}\n.planItinerary .record .null:hover span{\n    background-position: 0px -596px;\n}\n.planItinerary .record .null span{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    padding-left: 20px;\n    background-position: 0px -505px;\n    position: relative;\n}\n.planItinerary .record .setting{\n    vertical-align:inherit;\n}\n.planItinerary .record .setting > div{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    background-position: 9px -703px;\n    cursor: pointer;\n    position: relative;\n    height: 19px;\n    z-index: 5;\n}\n.planItinerary .record .setting > div:hover,\n.planItinerary .record .setting > .liftSeted{\n    background-position: 9px -812px;\n}\n.planItinerary .record .setting > div > div {\n    position: absolute;\n    top: 10px;\n    width: 145px;\n    left: -130px;\n    background-color: #fff;\n    border: solid 1px #d5d5d5;\n    border-radius: 3px;\n    box-shadow: 3px 5px 10px #ccc;\n    font-size: 16px;\n    color: #636363;\n    display: none;\n}\n.planItinerary .record .setting ul li{\n    height: 40px;\n    line-height: 40px;\n    padding-left:35px;\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/menuicons.png);\n    background-repeat: no-repeat;\n    background-position: 9px 11px;\n    background-color: #fff;\n    border-bottom: 1px solid #fff;\n    border-top: 1px solid #fff;\n}\n.planItinerary .record .setting ul li:hover{\n    background-color: #f5f5f5;\n    border-bottom: 1px solid #eee;\n    border-top: 1px solid #eee;\n}\n.planItinerary .record .setting ul li.before{\n    background-position: 9px 11px;\n}\n.planItinerary .record .setting ul li.after{\n    background-position: 9px 11px;\n}\n.planItinerary .record .setting ul li.del{\n    background-position: 9px -98px;\n}\n.planItinerary .record .setting ul li.lift{\n    background-position: 9px -61px;\n}\n.planItineraryNoLift{}\n.planItineraryNoLift td.lift,\n.planItineraryNoLift td.planItinerary_tTitle_lift{ }\n.planItinerary__copyPlan input{\n    height: 35px;\n    width: 100%;\n    margin:10px 0 20px 0;\n}\n.planItinerary .Empty{\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    height: 65px;\n    width: 100%;\n    line-height: 65px;\n    border:solid 1px #dadada;\n    background-color: #f9f9f9;\n    padding: 15px 15px 0 20px;\n}\n.planItinerary .Empty .left{\n    background-image: url(//static.qyer.com/models/common/component/planItinerary/images/other.png);\n    background-repeat: no-repeat;\n    background-position: 0 -1534px;\n    padding-left: 25px;\n    font-size: 12px;\n    color: #959595;\n    line-height:40px;\n    height:40px;\n}\n.planItinerary .Empty .right{\n    color: #fff;\n    background-color: #349f66;\n    height: 35px;\n    line-height: 35px;\n    border-radius: 3px;\n    padding: 0 15px;\n    font-size: 14px;\n}\n.includeFromPlanList\n{\n    float: right;\n    background-color: #0095db;\n    height: 35px;\n    line-height: 35px;\n    width: 127px;\n    color: #fff;\n    text-align: center;\n    border-radius: 3px;\n    font-size: 14px;\n    margin-right: 18px;\n}\n.copyCompleteExClassName .qui-popup-box-bottom{display:none;}\n.planItinerary .record .city > p > a:hover,\n.planItinerary .record .poi > p > a:hover{\n    color: #0073b6;\n}\n.noLink{\n    cursor: default !important;\n    color: #636363 !important;\n    text-decoration: none !important;\n}\n.b_copyPlan{\n    background-color: #f3661f !important;\n}\n.b_copyPlan:hover{\n    background-color: #f5802d !important;\n}\n.b_details-self{\n    \n    background-color: #fff !important;\n}\n.b_details-self:hover{\n    \n  color: #fff !important;;\n  background: #10b041 !important;;\n}\n.createMyPlan{\n    float: right;\n    background-color: #fff;\n    color: #636363;\n    height: 35px;\n    line-height: 35px;\n    width: 127px;\n    text-align: center;\n    border-radius: 3px;\n    font-size: 14px;\n    margin-top: 18px;\n    text-decoration: none;\n    margin-left: 16px;\n    border: 1px solid #c0c0c0;\n}\n.createMyPlan:hover{\n    background-color: #10b041;\n    border: 1px solid #10b041;\n    color: #fff;\n    text-decoration: none;\n}\n.createMyPlan_span{\n    font-size: 18px;\n    margin: 0 3px 0 0;\n    position: relative;\n    top: -1px;\n}\n.createMyPlan_spanText{\n}\n.qui-popup2{position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(//static.qyer.com/models/common/images/bg_255_255_255_0.7.png);z-index:1000;overflow-y:auto;opacity:0}.qui-popup2>div{display:table;height:100%;margin:0 auto}.qui-popup2-dt{display:table-cell;vertical-align:middle}.qui-popup2-box{margin:0 auto;background-color:#fff;position:relative;-webkit-box-shadow:0 0 6px #aaa;-moz-box-shadow:0 0 6px #aaa;box-shadow:0 0 6px #aaa;border:1px solid #ccc;opacity:0}.qui-popup2-loadingBtn,.qui-popup2-okBtn{vertical-align:middle;margin-left:16px}.qui-popup2-box-title{height:70px;line-height:70px;font-size:20px;font-weight:700;padding-left:30px}.qui-popup2-box-content{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0 30px}.qui-popup2-box-content>iframe{width:100%;border:none}.qui-popup2-box-bottom{text-align:right;height:70px;line-height:70px;padding-right:30px}.qui-popup2-closeIcon{position:absolute;right:10px;top:10px;cursor:pointer;background-image:url(//static.qyer.com/models/common/ui/popup2/icons.png);height:32px;width:32px;background-repeat:no-repeat;background-position:0 -18px;border-radius:5px}.qui-popup2-closeIcon:hover{background-position:0 -65px}.qui-popup2-cancelBtn{vertical-align:middle}.qui-popup2-loadingBtn{display:none}.qui-select{position:relative;display:inline-block;width:75pt;height:30px;overflow:visible}.qui-select-disable>.titles{background-color:#eee!important;cursor:default!important}.qui-select .contents ul li,.qui-select .titles{font-size:14px;cursor:pointer;text-overflow:ellipsis}.qui-select .titles{background:url(//fed.static.qyer.com/core/web/common/resource/ui/oldselect/icons.png) center right no-repeat #fff;border:1px solid silver;color:#636363;display:block;line-height:30px;padding:0 10px 0 5px;width:100%;height:100%;overflow:hidden}.qui-select .titles .title-text{background-position:0 -4px;margin-left:5px;white-space:nowrap}.qui-select .contents{background-color:#FFF;border:1px solid silver;box-shadow:0 1px 2px rgba(0,0,0,.1);display:none;line-height:38px;position:absolute;top:31px;width:180px;max-height:235px;overflow:auto;z-index:10}.qui-select .contents ul li:first-child{border-top:0 none}.qui-select .contents ul li{border-top:1px solid #EBEBEB;line-height:38px;white-space:nowrap;overflow:hidden}.qui-select .contents ul li:hover{background-color:#d9eed7}.qui-select .contents ul li a{padding-left:10px;color:#636363;text-decoration:none}.editor_selimage .qui-popup2-box-content{padding: 0;}\n.editor_selimage .qyEdit_append_title { height:26px; padding:10px 20px; position:relative; border-bottom:1px solid #c0c0c0; box-shadow:0 1px 2px rgba(0,0,0,0.15);}\n.editor_selimage .qyEdit_append_title .text { float:left; margin-right:10px; font-size:18px; line-height:26px;}\n.editor_selimage .qyEdit_append_title .qui-select { float:left;}\n.editor_selimage .qyEdit_append_title .qui-select .titles { height:24px; line-height:24px; font-size:12px;}\n.editor_selimage .qyEdit_append_title .qui-select .contents { top:25px;}\n.editor_selimage .qyEdit_append_title .qui-select .contents li { line-height:28px; font-size:12px;}\n.editor_selimage .qyEdit_append_title .close { position:absolute; right:10px; top:8px; width:32px; height:32px; display:block; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat 0 -452px; cursor:pointer;}\n.editor_selimage .qyEdit_append_title .close:hover { background-position:0 -484px;}\n.editor_selimage .qyEdit_append_button { padding:20px; height:28px;}\n.editor_selimage .qyEdit_append_button a { float:right; margin-left:10px;}\n.editor_selimage .qyEdit_append_wrap { height:260px; overflow:hidden; overflow-y:auto; border-bottom:1px solid #c0c0c0;}\n.editor_selimage .qyEdit_append_list { padding-bottom:20px;}\n.editor_selimage .qyEdit_append_list li { width:100px; float:left; margin:20px 0 0 20px; position:relative;}\n.editor_selimage .qyEdit_append_list li img { width:100px; height:100px; display:block;}\n.editor_selimage .qyEdit_append_list li .status { display:block; height:100px; width:100px; position:absolute; left:0; top:0;}\n.editor_selimage .qyEdit_append_list li .status span { position:absolute; left:34px; top:34px; width:32px; height:32px; display:block; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat -1000px;}\n.editor_selimage .qyEdit_append_list li .status .selected { background-position:0 -416px;}\n.qui-tip{position:fixed;top:75pt;left:0;width:100%;text-align:center;display:none;z-index:1100}.qui-tip-box{display:inline-block;min-width:90pt;max-width:390px;padding:20px 30px;background-color:#fff;box-shadow:0 2px 7px rgba(0,0,0,.25);border:1px solid silver;text-align:left;font-size:18px;line-height:2pc}.qui-tip-text{display:block;position:relative;padding-left:34px}.qui-tip-text:before{content:\'\';position:absolute;left:0;top:4px;width:24px;height:24px;background:url(//fed.static.qyer.com/core/web/common/resource/ui/oldtip/icons2.png) no-repeat #fff}.qui-tip-box-error .qui-tip-text:before{background-position:0 -5pc}.qui-tip-box-warning .qui-tip-text:before{background-position:0 -40px}.qyer_upload{width:580px;border:1px solid #7e7e7e;position:relative;background:#fff;margin:0 auto}.qyer_upload_head{height:29px;padding-top:8px;background:url(//static.qyer.com/images/common/upload/qyer_upload_head_bg.png) repeat-x}.qyer_upload_head ul{border-left:1px solid #e8e8e8}.qyer_upload_head ul li{float:left;border-right:1px solid #e8e8e8;padding:2px 10px 0;height:25px;line-height:24px;border-top:1px solid #e8e8e8;cursor:pointer;background:#fff}.qyer_upload_head ul .ui_tab_trigger_item_current{color:#077345;padding:0 10px;border-top:3px solid #0ca46c;height:26px}.qyer_upload_item_tit{color:#636363;border-bottom:1px solid #e8e5df;padding:10px;position:relative;z-index:16;height:22px}.qyer_upload_item_tit strong{line-height:22px;float:left}.qyer_upload_item_tit span{line-height:22px;padding-left:10px}.qyer_upload_item_tit span a{color:#006aad}.qyer_upload_item_tit select{float:left;height:22px;border:1px solid #ccc;width:148px}.qyer_upload_t_item{float:left;width:173px;border:1px solid #e8e5e0;height:20px;margin-left:10px;display:inline;position:relative}.qyer_upload_t_item a{margin:4px;float:left}.qyer_upload_t_item a img{float:left}.qyer_upload_t_item input{width:150px;border:0;height:18px;line-height:18px;padding:0 5px 0 1px}.ui_album_poiSelect_div{position:absolute;left:-1px;top:20px;width:316px;border:1px solid #e8e5e0;background:#fff;display:none}.ui_album_poiSelect_search{overflow:hidden;zoom:1}.ui_album_poiSelect_search_title{float:left;width:60px;text-align:center;line-height:28px;padding:0}.ui_album_poiSelect_search_item{width:255px;float:right;color:#323232;border-left:1px solid #ebebeb;border-top:1px solid #ebebeb;line-height:28px}.ui_album_poiSelect_search_list{display:block;float:none;padding:0 10px;cursor:pointer}.ui_album_poiSelect_search_list:hover{background:#e6f4d9}.qyer_upload_item_tit .ui_album_poiSelect_search_list span{line-height:28px;padding:0}.ui_album_poiSelect_search_item_none{border-top:0}.qyer_upload_new{float:left;position:relative}.qyer_upload_new input{width:160px;height:20px;border:1px solid #e8e5e0;padding:0 5px;color:#636363}.qyer_upload_new_error{border:1px solid #ffd088;background:#ffffe5;position:absolute;left:0;top:27px;width:152px;padding:4px 9px;color:#323232;display:none;box-shadow:1px 1px 2px #ccc}.qyer_upload_new_error span{background:url(//place.qyerstatic.com/common/basic/old/images/upload/qyer_upload_new_error_bg.png) no-repeat;width:9px;height:5px;display:block;position:absolute;left:60px;top:-5px}.qyer_upload_item_con{height:300px;position:relative;z-index:15}.qyer_upload_upbtn{padding-top:100px;text-align:center}.qyer_upload_upbtn_hide{padding:0;height:0;overflow:hidden}.qyer_upload_upbtn div{position:relative;height:38px}.qyer_upload_upbtn a,.qyer_upload_upbtn object{position:absolute;left:226px;height:38px;top:0;cursor:pointer}.qyer_upload_upbtn object{width:126px;z-index:18}.qyer_upload_upbtn a{width:124px;z-index:17;display:inline-block;text-align:center;border:1px solid #0073b6;border-radius:3px;background:#0073b6;font:700 20px/38px arial,"Microsoft YaHei",\\5b8b\\4f53,sans-serif;color:#fff;overflow:visible;text-shadow:0 -1px 0 #00395b}.qyer_upload_upbtn_hide a,.qyer_upload_upbtn_hide object{left:-9999px}.qyer_upload_list{height:236px;padding:15px 0 0 15px;border-bottom:1px solid #dbdbdb;overflow:hidden;overflow-y:auto}.qyer_upload_list_status{padding-bottom:15px;width:100%;float:left}.qyer_upload_list_status div{height:22px;margin-right:10px;position:relative;margin-bottom:15px}.qyer_upload_list_status div .filebg{border:1px solid #ccc;display:inline-block;width:330px;height:20px;float:none}.qyer_upload_list_status div em{background:#02734a;display:block;margin:0;height:20px}.qyer_upload_list_status div strong{color:#fff;padding-left:10px;display:block;height:22px;line-height:22px;position:absolute;top:0;z-index:2}.qyer_upload_list_status span{vertical-align:middle}.qyer_upload_list_status span.fr{width:90px;float:right;line-height:22px;margin-top:0}.qyer_upload_list_status .fstatus{margin-left:10px}.qyer_upload_list_status .icon_finish{color:#323232}.qyer_upload_list_file{width:100%;float:left;margin-bottom:15px}.qyer_upload_list_file .fl{line-height:22px;margin-right:10px}.qyer_upload_list_file input{float:left;height:22px}.qyer_upload_list_file .fr{width:240px}.qyer_upload_list_file .fr span{float:left}.qyer_upload_list_file .fr .qcz{width:130px;float:right}.qyer_upload_network_url{padding:70px 0 0 35px;height:230px}.qyer_upload_network_url .fl .ui_input{width:438px;height:26px;line-height:26px;font-size:14px}.qyer_upload_network_url .qyer_upload_new_error{top:33px}.qyer_upload_layout_error{border:5px solid #e6e6e6;border-color:rgba(102,102,102,.4);border-radius:5px;background:#fff;width:350px;padding:10px;position:absolute;left:100px;top:150px;z-index:40;display:none}.qyer_upload_layout_form{border:5px solid #e6e6e6;border-color:rgba(102,102,102,.4);border-radius:5px;background:#fff;width:220px;text-align:center;position:absolute;left:170px;top:120px;z-index:41;padding:15px 0;display:none}.qyer_upload_layout_form input{margin:0 5px}.qyer_upload_mylist .qyer_upload_photo_list{height:216px;margin:15px 0 20px 5px;overflow:hidden;overflow-y:auto}.qyer_upload_mylist .qyer_upload_photo_list li{float:left;margin:5px 0 0 5px;display:inline;height:80px;width:80px;overflow:hidden;cursor:pointer}.qyer_upload_photo_list li .icon_current{margin-top:-80px;display:none;width:100%;height:100%;background:url(//static.qyer.com/images/common/upload/icon_current.png);float:left}.qyer_upload_photo_list .current .icon_current{display:block}.qyer_upload_photo_list li img{float:left}.qyer_upload_photo_list li .icon_current span{display:block;height:100%;width:100%;background:url(//static.qyer.com/images/common/upload/icon_current_draw.png) center center no-repeat}.qyer_upload_mylist .qyer_upload_btn{border-top:1px solid #e8e5df}.uploadpopup .qui-popup2-box-content{padding:0}.uploadpopup .qui-popup2-box-bottom{display:none}.uploadpopup .qui-popup2-closeIcon{position:absolute;z-index:1;top:5px;right:5px;width:26px;height:26px;background:url(//static.qyer.com/images/common/tpl/pup_close.png) no-repeat;cursor:pointer;border-radius:0}.uploadpopup .qui-popup2-closeIcon:hover{background-position:0 -26px}.uploadpopup .qui-popup2-box{border:5px solid #aeadad;border-color:rgba(0,0,0,.3);border-radius:8px}.x-loading-page{margin-top:16px;height:32px;clear:both;background:url(//static.qyer.com/images/common/londing32.gif) center no-repeat}.hotelPopup{background: #fff;}\n.hotelPopup .box1{padding:10px;}\n.hotelPopup .box2{overflow: hidden;padding: 5px 10px 15px;color: #959595;line-height:22px;\nborder-bottom:solid 1px #ececec;}\n.hotelPopup .box3{overflow: hidden;}\n.hotelPopup .picture{float: left;width: 161px;height: 107px;background: #e5e5e5;overflow: hidden;}\n.hotelPopup .picture img{width: 100%;height: 100%;}\n.hotelPopup .info{margin-left:171px;}\n.hotelPopup .cn,.hotelPopup .en{font-size: 16px;white-space: nowrap;overflow: hidden;text-overflow:ellipsis;}\n.hotelPopup .score{overflow: hidden;}\n.hotelPopup .stars{float:left;overflow: hidden;width: 100px;margin-top: 10px;}\n.hotelPopup .stars em{float:left;width: 12px;height: 12px;\n\tbackground: url(//static.qyer.com/models/project/bbs/images/hotelStar.png) no-repeat left top;\n\tmargin:0 6px 0 0;\n}\n.hotelPopup .goal{float:right;height: 20px;line-height: 20px;margin-top: 6px;}\n.hotelPopup .goal i{font-style: normal;font-size: 16px;color: #f26622;padding:0 10px 0 5px;}\n.hotelPopup .service{overflow: hidden;height: 16px;margin-top: 13px;}\n.hotelPopup .service a{float: left;line-height: 100px;overflow: hidden;background-image: url(//static.qyer.com/models/project/bbs/images/hotelIcon.png);\nbackground-repeat: no-repeat;height: 16px;margin-right: 5px;}\n.hotelPopup .wifi{background-position:-22px -64px ;width: 51px;}\n.hotelPopup .meet{background-position:-84px -64px ;width: 71px;}\n.hotelPopup .park{background-position:-167px -64px;width: 59px;}\n.hotelPopup .deposit{background-position:-238px -64px ;width: 46px;}\n.hotelPopup .wifi:hover{background-position:-22px -19px ;}\n.hotelPopup .meet:hover{background-position:-84px -19px ;}\n.hotelPopup .park:hover{background-position:-167px -19px;}\n.hotelPopup .deposit:hover{background-position:-238px -19px ;}\n.hotelPopup .advantage {color:#959595;list-style-type: square;font-size: 8px;}\n.hotelPopup .advantage li{margin-left: 14px;line-height: 20px;}\n.hotelPopup .advantage span{font-size: 12px;position: relative;top:2px;}\n.hotelPopup .price{font-size: 16px;line-height:50px;height: 50px;margin:0 10px;color: #636363;}\n.hotelPopup .price em{font-size: 22px;font-style: normal;font-weight: bold;color:#f26622 ;padding:0 0 0 10px;}\n.hotelPopup .btn{float:right;margin:8px 9px 0 0;}\n.hotelPopupWrap{display:block;min-width:280px;border: solid 1px #e0e0e0;box-shadow: 0 0 20px rgba(0,0,0,0.05);border-radius:3px;position: relative;\nopacity:1;transition:opacity 1s;-webkit-transition:opacity 1s;z-index:9999;}\n.hotelPopupWrap:after{position: absolute;width: 8px;height: 8px;content: "";background-image:url(//common1.qyerstatic.com/bbs/old/images/detail/hotelpopuparrow.png);\nbackground-repeat: no-repeat;z-index: 2;}\n.hotelPopupWrapLB:after{background-position: -8px 0px;left:0px;bottom:-7px;}\n.hotelPopupWrapCB:after{background-position: -8px 0px;left:50%;margin-left: -10px;bottom:-7px;}\n.hotelPopupWrapRB:after{background-position: -8px 0px;right:0px;bottom:-7px;}\n.hotelPopupWrapLT:after{left:0px;top:-6px;}\n.hotelPopupWrapCT:after{left:50%;top:-6px;margin-left: -10px;}\n.hotelPopupWrapRT:after{right:0px;top:-6px;}\n.hotelPopupWrapLoading{min-height: 100px;opacity: 0.7;}\n.hotelPopupWrapLoading:before{background: url("//static.qyer.com/models/common/images/wait_16.gif") no-repeat scroll center center #fff;position: absolute;\nwidth: 100%;height:100%;content: "";z-index: 1;left:0;top:0;}\n.hotelPopupWrap:hover{text-decoration:none;}\n.xgroupb-tle{\n    padding: 12px 0 8px;\n    font-size: 14px;\n    color: #323232;\n}\n.xh-titlecn {\n    padding: 0 14px;\n    width: 265px;\n    color: #323232;\n    font-weight: bold;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n.xh-discount {\n    display: inline-block;\n    padding: 0 3px;\n    margin-right: 5px;\n    font-weight: normal;\n    font-size: 12px;\n    color: #ff7466;\n    border: 1px solid #ff7466;\n    border-radius: 2px;\n}\n.xh-titlen {\n    padding: 2px 14px;\n    width: 265px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n.xgroupb-des {\n    padding:0 14px;\n    font-size: 14px;\n    line-height: 38px;\n    color: #d7d7d7;\n    border-top: 1px solid #f5f5f5;\n}\n.xgd-star {\n    display:inline-block;\n    margin-right: 10px;\n    color: #494949;\n    vertical-align:-1px;\n}\n.xgd-dic {\n    display:inline-block;\n    margin-left: 9px;\n    color: #494949;\n    vertical-align:-1px;\n}\n.xgroupb-pri {\n    padding: 5px 14px 18px 14px;\n}\n.xgp-pw {\n    float: left;\n    margin:3px 9px 0 0;\n}\n.xgpp {\n    color: #8a8a8a;\n}\n.xgpp-num {\n    display: inline-block;\n    color: #ff7466;\n    font-size: 20px;\n    line-height: 20px;\n    font-weight: normal;\n    margin-right: 3px;\n    vertical-align: bottom;\n}\n.xgppdis {\n    color: #959595;\n    font-size: 14px;\n    text-decoration: line-through;\n}\n.xgp-a {\n    float: left;\n    padding: 0 14px;\n    color: #fff;\n    font-size: 16px;\n    line-height: 40px;\n    border-radius: 2px;\n    background: #0896ff;\n}\n.xgp-airbnb {\n    float: left;\n    padding: 0 14px;\n    color: #fff;\n    font-size: 16px;\n    line-height: 40px;\n    border-radius: 2px;\n    background: #ff5a5f; \n}\n.xgp-a:hover{\n    text-decoration:none;\n}\n.xgpa-str {\n    font-weight: bold;\n}\n.xgppdis:hover{text-decoration:line-through;}\n.xc-header {\n    padding: 10px 14px 8px;\n    color: #323232;\n    border-bottom: 1px solid #f5f5f5;\n}\n.xch-tlecn {\n    font-size: 16px;\n    font-weight: bold;\n}\n.xch-tlen {\n    font-size: 14px;\n}\n.xc-content {\n    padding: 15px 13px 15px 15px;\n}\n.xcc-imgwrap {\n    float: left;\n}\n.xcci {\n    margin-right: 10px;\n    width:90px;\n    height:90px;\n}\n.xcc-aside {\n    float: left;\n    margin-top: 12px;\n    margin-left: 4px;\n}\n.xcca-p {\n    font-size: 16px;\n    color: #d7d7d7;\n}\n.xcc-pd {\n    display: inline-block;\n    margin-right: 10px;\n    color: #959595;\n    font-size: 14px;\n    text-decoration: line-through;\n    vertical-align: -2px;\n}\n.xcca-rp {\n    display: inline-block;\n    margin-left: 7px;\n    font-size: 12px;\n    color: #8a8a8a;\n}\n.xcc-pp {\n    margin-right: 3px;\n    font-size: 20px;\n    color: #ff7466;\n    vertical-align:-2px;\n}\n.xcca-a {\n    display: block;\n    padding:0 30px;\n    margin-top: 8px;\n    background: #ff7466;\n    font-size: 16px;\n    line-height: 40px;\n    text-align: center;\n    color: #fff;\n    border-radius: 3px;\n}\n.xcca-a:hover{text-decoration:none;}\n.xcc-pd:hover{text-decoration:line-through;}\n.xgroupC .xh-discount{margin:0 0 0 5px;}\n.xmt6{margin-top:6px;}\n\n.qyEdit_append_title { height:26px; padding:10px 20px; position:relative;}\n.qyEdit_append_title .text { float:left; margin-right:20px; font-size:18px; line-height:26px;}\n.qyEdit_append_title .close { position:absolute; right:10px; top:8px; width:32px; height:32px; display:block; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat 0 -452px; cursor:pointer;}\n.qyEdit_append_title .close:hover { background-position:0 -484px;}\n.qyEdit_append_title .minimize { position:absolute; right:10px; top:8px; width:32px; height:32px; display:block; background:url(//static.qyer.com/models/project/bbs/css/images/icon_arrow.png) no-repeat 0 0; cursor:pointer;}\n.qyEdit_append_title .minimize .tip { display: none; position: absolute; top: -28px; left: -13px; width: 58px; height: 32px; line-height: 26px; color: #959595; text-align: center; background:url(//static.qyer.com/models/project/bbs/css/images/icon_arrow.png) no-repeat 0 -32px;}\n.qyEdit_append_title .minimize.hvr:hover .tip { display: block;}\n.qyEdit_append_title .minimize_tip { position: absolute; top: -42px; right: -79px; width: 220px; height: 30px; line-height: 30px; color: #FFF; text-align: center; background: #3dc067; border-radius: 3px;}\n.qyEdit_append_title .minimize_tip:after { content: \'\\25C6\'; position: absolute; top: 14px; left: 50%; color: #3dc067;}\n.qyEdit_append_title .minimize_tip em { margin-left: 5px; font-size: 18px; vertical-align: -2px; cursor: pointer;}\n.fixed_minimizebar { display: none; position: fixed; z-index: 1000; left: 50%; bottom: 0; margin-left: -299px; width: 598px; height: 48px; border: 1px solid #d7d7d7; background: #FFF; font-size: 14px;}\n.fixed_minimizebar .wrap { position: absolute; z-index: 2; width: 100%; height: 100%; line-height: 48px;}\n.fixed_minimizebar .wrap p { padding: 0 20px;}\n.fixed_minimizebar .wrap .back { position: absolute; top: 8px; right: 10px; width: 32px; height: 32px; background:url(//static.qyer.com/models/project/bbs/css/images/icon_arrow.png) no-repeat -32px 0; cursor:pointer;}\n.fixed_minimizebar .progress { position: absolute; top: 0; left: 0; z-index: 1; width: 0%; height: 100%; background: #f5f5f5; transition: all .2s ease-in;}\n.fixed_minimizebar.complete { border-color: #10b041;}\n.fixed_minimizebar.complete .wrap p { color: #10b041;}\n.fixed_minimizebar.complete .wrap .back { background-position: -64px 0;}\n.fixed_minimizebar.complete .progress { display: none;}\n.qyEdit_append_button { padding:20px; height:28px;}\n.qyEdit_append_button a { float:right; margin-left:10px;}\n.qyEdit_append_video { padding:20px 0 0;}\n.qyEdit_append_video .input { border:1px solid #dedede; margin:0 20px; border-radius:2px; padding:3px 30px 3px 10px; position:relative;}\n.qyEdit_append_video .inputError { border:1px solid #fb6850;}\n.qyEdit_append_video .input input { width:100%; border:0; padding:0;}\n.qyEdit_append_video .input input:focus { box-shadow:0 0 0 rgba(0,0,0,0);}\n.qyEdit_append_video .input .loading { text-indent:-9999px; position:absolute; right:10px; top:8px; left:auto;width:16px; height:16px; background:url(//static.qyer.com/images/common/tpl/wait_16.gif) no-repeat;}\n.qyEdit_append_video .tips { height:18px; margin:10px 20px 0;}\n.qyEdit_append_video .tips .error { padding-left:20px; position:relative;display: none;color:#fb6850;width: auto;}\n.qyEdit_append_video .tips .error span { background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat 0 -385px; display:block; width:16px; height:16px; position:absolute; left:0; top:1px;}\n.qyEdit_append_video .tips .tip{font-size: 14px;color: #959595;}\n.showError .input{border:1px solid #fb6850;}\n.showError .tips .error{display: block;}\n.qyEdit_append_video .input .correct {\n  text-indent: -9999px;\n  position: absolute;\n  right: 10px;\n  top: 10px;\n  left:auto;\n  width: 16px;\n  height: 16px;\n  background: url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat -100px -385px;}\n.editor_video .qui-popup2-box-content{padding: 0;}\n.editor_file .qui-popup2-box-content{padding: 0;}\n.qyEdit_append_affix { padding:20px 0 0;}\n.qyEdit_append_affix .input { border:1px solid #dedede; cursor:pointer; background:#f5f5f5; margin:0 20px; border-radius:2px; padding:3px 30px 3px 10px; position:relative;}\n.qyEdit_append_affix .inputError { border:1px solid #fb6850;}\n.qyEdit_append_affix .upload { line-height:24px; padding:3px 0; color:#636363; font-size:14px;overflow: hidden;text-overflow:ellipsis;white-space:nowrap;}\n.input:hover .upload .default{background-position:-256px -194px; color:#10b041;}\n.qyEdit_append_affix .upload .default { padding-left:20px; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat -256px -168px;}\n.qyEdit_append_affix .input .loading { text-indent:-9999px; position:absolute; left:550px; top:10px; width:16px; height:16px; background:url(//static.qyer.com/images/common/tpl/wait_16.gif) no-repeat;}\n.qyEdit_append_affix .input .correct { text-indent:-9999px; position:absolute; right:10px; top:10px; width:16px; height:16px; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat -100px -385px;}\n.qyEdit_append_affix .tips { height:20px; margin:10px 20px 0; line-height:20px;}\n.qyEdit_append_affix .tips p { font-size:14px; color:#959595;}\n.qyEdit_append_affix .tips .error { color:#fb6850; padding-left:20px; font-size:12px; position:relative;display: none;}\n.qyEdit_append_affix .tips .error span { background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat 0 -385px; display:block; width:16px; height:16px; position:absolute; left:0; top:2px;}\n.webuploader-container {\n    position: relative;\n}\n.webuploader-element-invisible {\n    position: absolute !important;\n    clip: rect(1px 1px 1px 1px); \n    clip: rect(1px,1px,1px,1px);\n}\n.editor_createAlbum .qui-popup2-box-content{padding: 0;}.loading{position: absolute;width: 100%;height: 100%;left: 0;top:0;text-align: center;}.qui-slidConfirm{position:absolute;z-index:1300;top:75pt;left:75pt;border:1px solid #ccc;padding:10px;background-color:#fff;box-shadow:0 0 6px #aaa}.qui-slidConfirm-bottom{margin-top:10px;text-align:center}.qui-slidConfirm-text{background-image:url(//fed.static.qyer.com/core/web/common/resource/ui/oldslidconfirm/icons.png);background-repeat:no-repeat;display:inline-block;padding-left:20px;background-position:0 -79px;text-align:center}\n.tools{width: 24px;padding: 0 23px;float: left;}\n.tools div span{width: 24px;height: 24px;background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat;display: inline-block;}\n.tools div i{display: none;width: 2px;height: 16px;background: #10b041;position: relative;top: 5px;}\n.tools div.selected i{display: inline-block;}\n.tools .lift{background-position:-32px -163px;}\n.tools .faces{background-position:-32px -199px;}\n.tools .insertimage{background-position: -32px -235px;}\n.tools .insertvideo{background-position: -32px -271px;}\n.tools .insertattach{background-position: -32px -307px;}\n.tools .help{background-position: -132px -164px;}\n.tools .lift:hover{background-position:-110px -163px;}\n.tools .selected .lift{background-position:-110px -163px;}\n.tools .faces:hover { background-position:-110px -199px;}\n.tools .selected .faces{background-position:-110px -199px;}\n.tools .insertimage:hover{background-position: -110px -235px;}\n.tools .selected .insertimage{background-position:-110px -235px;}\n.tools .insertvideo:hover{background-position: -110px -271px;}\n.tools .insertattach:hover{background-position: -110px -307px;}\n.tools .help:hover{background-position: -155px -164px;}\n.tool_content{width: 170px;float: right;padding-top: 8px;}\n.tool_content .lift_cont{height: 200px;overflow: auto;}\n.tool_content .lift_cont .lift_head{position: relative;}\n.tool_content .lift_cont .lift_head .reload{position: absolute;right: 8px;top: 3px;}\n.tool_content .lift_cont h3{color: #10b041;font-size: 14px;font-weight: 400;}\n.tool_content .lift_cont h4,.container .tool_content .lift_cont ul li{height: 18px;margin-top:4px;overflow: hidden;text-overflow:ellipsis;white-space:nowrap;}\n.tool_content .lift_cont h4 span{color: #636363;font-size: 12px;cursor:pointer;}\n.tool_content .lift_cont ul{margin-top: 4px;padding-left: 15px;overflow: hidden;}\n.tool_content .lift_cont ul li span{color: #959595;font-size: 12px;line-height: 18px;cursor:pointer;}\n.tool_content .lift_cont span:hover{text-decoration: none;color: #10b041;}\n.tool_content .lift_cont .lift_body{margin-top: 23px;}\n.tool_content .emotion_cont span{background-image: url(//static.qyer.com/models/project/bbs/css/images/emotion.png); display: inline-block; width: 24px; height: 24px; float: left; margin: 4px ; border: 1px solid #fff;cursor:pointer;}\n.tool_content .emotion_cont span:hover{border: 1px solid #c0c0c0; }\n.tool_content .image_cont .buttons{margin-top: 8px;}\n.tool_content .image_cont{width: 100%; display: block; padding: 0; border-radius: 0;}\n.tool_content .image_cont .lists {overflow: auto; width: 184px; min-height: 300px;position: relative;margin-top: 10px;}\n.tool_content .image_cont .lists ul{margin-left: -10px;}\n.tool_content .image_cont .lists ul li{margin: 0 0 0 8px;float: left;}\n.tool_content .image_cont .lists ul li img{display: block;width: 80px;height: 80px;margin-top: 8px;cursor: pointer;}\n.tool_content .image_cont .qui-select{height: auto;}\n.tool_content .image_cont .qui-select .titles{line-height: 24px;height: 24px;padding-right: 28px;}\n.tool_content .image_cont .qui-select .contents{top: 25px;}\n.tool_content .image_cont .qui-select .contents ul li{line-height: 30px;}\n.tool_content .image_cont .ui_button{padding: 1px 28px 0;border-radius:0;background-color:#10b041;font-size: 12px;height: 27px;white-space: nowrap;}\n.tool_content .image_cont .ui_button:hover{background-color: #3f9f5f;}\n.tool_content .image_cont .ui_button .add{display: inline-block;width: 12px;height: 12px;background: url(//static.qyer.com/models/project/bbs/css/images/add.png) no-repeat;float: left;margin: 7px 5px 0 0;}\n.tool_content .image_cont .uploadPanel { display: none; position: absolute; z-index: 10; top: 0; left: 0; width: 100%; height: 100%;}\n.tool_content .image_cont .scrollTip{width: 64px;height: 20px;line-height: 20px;text-align: center;background: url(//static.qyer.com/models/project/bbs/css/images/img_tip.png) no-repeat;position: absolute;left: 166px;top:95px;display: none;color: #636363;}\n@-webkit-keyframes rotate {\n  from {-webkit-transform:rotate(0deg);}\n  to {-webkit-transform:rotate(360deg);}\n}\n.animateRotate{\n  -webkit-animation-name: rotate;\n  -webkit-animation-duration: 0.5s;\n  -webkit-animation-iteration-count: 1;\n  -webkit-animation-timing-function: linear;\n}\n.editor_uploadImage .qui-popup2-box-content,.editor_concatpoi .qui-popup2-box-content{padding: 0;}\n.qyEdit_append_pic { width:620px; border:1px solid #c0c0c0; background:#fff; box-shadow:0 2px 7px rgba(0,0,0,0.25); margin:0 auto;}\n.editor_uploadImage .qyEdit_append_wrap{\n  height: 261px;\n}\n.editor_uploadImage .qyEdit_append_title,.editor_concatpoi .qyEdit_append_title{\n  border-bottom: 1px solid #c0c0c0;\n  box-shadow: 0 1px 3px #ccc;\n}\n.qyEdit_append_button .tips { float:left; color:#959595; line-height:28px;}\n.qyEdit_append_button .checkBox { float:right; padding-right:10px;}\n.qyEdit_append_button .checkBox label { float:left; color:#959595;}\n.qyEdit_append_button .checkBox input { margin:6px 5px 0 0; float:left; width:14px; height:14px;}\n.qyEdit_append_button .checkBox p { float:left; line-height:28px;}\n.qyEdit_append_wrap { height:260px; overflow:hidden; overflow-y:auto; border-bottom:1px solid #c0c0c0;}\n.qyEdit_append_list { padding-bottom:20px;}\n.qyEdit_append_list li { width:100px; float:left; margin:20px 0 0 20px; position:relative;}\n.qyEdit_append_list li img { width:100px; height:100px; display:block; background:#ececec;}\n.qyEdit_append_list li .rotate { display:none; position:absolute; left:0; bottom:0; right:0; background:#575757; background:rgba(0,0,0,0.8); padding:0 14px; height:30px;}\n.qyEdit_append_list li .rotate span { background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat; height:30px; text-indent:-9999px; width:50%; float:left; cursor:pointer;}\n.qyEdit_append_list li .rotate .left { background-position:-30px -16px;}\n.qyEdit_append_list li .rotate .left:hover { background-position:-30px 7px;}\n.qyEdit_append_list li .rotate .right { background-position:-68px -16px;}\n.qyEdit_append_list li .rotate .right:hover { background-position:-68px 7px;}\n.qyEdit_append_list li .error { position:absolute; left:0; right:0; top:0; bottom:0; border:1px solid #fb6850; background:rgba(0,0,0,0); text-align:center;}\n.qyEdit_append_list li .error .icon { background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat 0 -385px; display:inline-block; width:16px; height:16px; margin:13px auto 0;}\n.qyEdit_append_list li .error .tips { display:block; line-height:24px; color:#959595;}\n.qyEdit_append_list li .error a { color:#323232;}\n.qyEdit_append_list li .error a:hover { color:#10b041;}\n.qyEdit_append_list li .delete { position:absolute; right:-7px; top:-7px; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat -114px 0; width:20px; height:19px; overflow:hidden; text-indent:-9999px; cursor:pointer;}\n.qyEdit_append_list li .tArrow { white-space:nowrap; border:1px solid #d7d7d7; background:#f5f5f5; border-radius:3px; position:absolute; left:0; top:-20px; padding:3px 8px; line-height:16px; color:#959595;}\n.qyEdit_append_list li .tArrow .arrow0 { position:absolute; bottom:-6px; left:45%; height:6px; display:inline-block;}\n.qyEdit_append_list li .tArrow .arrow0 span { display:inline-block; height:0; width:0; overflow:hidden; position:absolute; top:0;}\n.qyEdit_append_list li .tArrow .arrow1 { left:1px; z-index:1; border-left:6px solid transparent; border-right:6px solid transparent; border-top:6px solid #f5f5f5;}\n.qyEdit_append_list li .tArrow .arrow2 { left:0; z-index:0; border-left:7px solid transparent; border-right:7px solid transparent; border-top:7px solid #d7d7d7;}\n.qyEdit_append_list li .loading { padding:0 10px; position:absolute; left:0; right:0; top:0; bottom:0;width: auto;}\n.qyEdit_append_list li .loading span { margin-top:47px; display:block; overflow:hidden; height:5px; background:#c0c0c0; border-radius:3px;}\n.qyEdit_append_list li .loading span em { display:block; background:#5cad77; border-radius:3px; overflow:hidden; height:5px;}\n.editor_concatpoi .qyEdit_append_button { padding:20px; height:28px;}\n.editor_concatpoi .qyEdit_append_button .button a { float:right; margin-left:10px;}\n.editor_concatpoi .qyEdit_append_button .tips { float:left; color:#959595; line-height:28px;}\n.editor_concatpoi .qyEdit_append_button .tips a { color:#959595;}\n.editor_concatpoi .qyEdit_append_button .place { float:left; padding-left:20px; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) 0 -570px no-repeat; display: none;position: relative;}\n.editor_concatpoi .qyEdit_append_button .place input { border-radius:3px; float:left; padding:1px 7px; width:230px;}\n.editor_concatpoi .qyEdit_append_button .place .error { border:1px solid #fb6850;}\n.editor_concatpoi .qyEdit_append_button .place .tText { float:left; line-height:28px; margin-left:10px; color:#fb6850;display: none;}\n.editor_concatpoi .qyEdit_append_button .place .tText em { width:16px; height:16px; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat 0 -385px; float:left; margin:5px 5px 0 0;}\n.editor_concatpoi .qyEdit_append_list { padding-bottom:20px;}\n.editor_concatpoi .qyEdit_append_list li { width:100px; float:left; margin:20px 0 0 20px; position:relative;}\n.editor_concatpoi .qyEdit_append_list li img { width:100px; height:100px; display:block; background:#ececec;}\n.editor_concatpoi .qyEdit_append_list li .status { display:none; height:100px; width:100px; position:absolute; left:0; top:0;}\n.editor_concatpoi .qyEdit_append_list li .status span { position:absolute; left:34px; top:34px; width:32px; height:32px; display:block; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat;}\n.editor_concatpoi .qyEdit_append_list li .status .selected { background-position:0 -416px;}\n.editor_concatpoi .qyEdit_append_list li .place { position:absolute; left:0; right:0; bottom:0;background-color:transparent;background-color:rgba(48,51,51,0.8);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#7F303333,endColorstr=#7F434345);line-height:30px;color:#fff;display: none;}\n.editor_concatpoi .qyEdit_append_list li .place strong {position:absolute;left:10px;top:-1px;width:12px;height:16px;background: url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat -124px -385px;}\n.qui-inputAutocomplete{top:-1px;}\n.qui-inputAutocomplete ul { border-top:1px solid #d7d7d7;}\n.qui-inputAutocomplete ul li{font-size: 12px;color: #636363;padding:0 23px 0 7px; line-height:28px; height:28px; width:100%; text-overflow:ellipsis; white-space:nowrap; overflow:hidden;\n-webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box;\n}\n.qui-inputAutocomplete ul .active { background:#e3fae3; cursor:pointer;}\n.qui-inputAutocomplete ul .lastChild { border-top:1px solid #ececec;}\n.qui-inputAutocomplete ul li .poiname{padding-right:10px;}\n.qui-inputAutocomplete ul li .country{color: #959595;}\n.qui-inputAutocomplete ul li .kw{color: #10b041;}\n.pub-threadhelp-wrap{position:fixed;bottom:0;left:0;right:0;height:400px;background-color:#f5f5f5;border-top:2px solid #10b041;z-index:9999;overflow:hidden;}\n.pub-threadhelp-wrap .x-header a{\n\tfloat:right;\n\twidth:24px;\n\theight:24px;\n\tmargin:20px 40px 0 0;\n\tbackground-image:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png);\n\tbackground-repeat:no-repeat;\n\tbackground-position:-40px -418px;\n}\n.pub-threadhelp-wrap .x-header a:hover{\n\tbackground-position:-93px -418px; \n}\n.x-header{position:relative;height:39px;}\n.pub-threadhelp-wrap .x-header p{\n\tposition:absolute;\n\tleft:9%;\n\ttop:-1px;\n\twidth:114px;\n\theight:39px;\n\t\n\tbackground:url(//static.qyer.com/models/project/bbs/css/images/x-publish-help.jpg) no-repeat;\n\tz-index:2000;\n}\n.pub-threadhelp-wrap .x-footer{\n\ttext-align:center;\n}\n.pub-threadhelp-wrap .x-footer a{\n\tdisplay:inline-block;\n\t*display:inline;\n\t*zoom:1;\n\twidth:17px;\n\theight:11px;\n\tmargin-right:6px;\n\tbackground-image:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png);\n\tbackground-repeat: no-repeat;\n\tbackground-position:-119px -418px;\n}\n.pub-threadhelp-wrap .x-footer a.active,\n.pub-threadhelp-wrap .x-footer a:hover{\n\twidth:17px;\n\theight:10px;\n\tbackground-position:-122px -432px;\n}\n.pub-threadhelp-wrap .x-content{position:relative;width:900px;height:292px;padding-bottom:25px;margin:0 auto;text-align:center;}\n.pub-threadhelp-wrap .xcd{\n\tposition: relative;\n\t\n\theight:292px;\n\twidth:25px;\n\ttext-align:center;\n}\n.xfl{float:left;}\n.xfr{float:right;}\n.pub-threadhelp-wrap .xcd i{\n\tposition: absolute;\n\tbottom:0;\n\ttop:0;\n\tleft:0;\n\tright:0;\n\tmargin:auto;\n\twidth:19px;\n\theight:36px;\n\tbackground-image:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png);\n\tbackground-repeat:no-repeat;\n\tcursor:pointer;\n}\n.pub-threadhelp-wrap .xcd .xleft{\n\tbackground-position:-56px -452px;\n}\n.pub-threadhelp-wrap .xcd .xleft:hover{\n\tbackground-position:-101px -452px;\n}\n.pub-threadhelp-wrap .xcd .xright{\n\tbackground-position:-78px -452px;\n}\n.pub-threadhelp-wrap .xcd .xright:hover{\n\tbackground-position: -36px -452px;\n}\n.pub-threadhelp-wrap .xcimages{\n\tposition: relative;\n\tdisplay: inline-block;\n\t*display:inline;\n\t*zoom:1;\n\twidth:660px;\n\theight:240px;\n}\n.pub-gifwrap{\n\tposition:absolute;\n\tdisplay:none;\n\tleft:0;\n\ttop:-8px;\n}\n.x-pubdesc-wrap{\n\twidth:600px;\n\tmargin:0 auto;\n\ttext-align: left;\n}\n.x-pubdesc-wrap > div{\n\tdisplay:inline-block;\n}\n.x-pubnum{\n\tposition:absolute;\n\tmargin-top:-166px;\n\tfont-size:200px;\n\tfont-weight:bold;\t\n\tcolor:#f6e9e8;\n}\n.x-pubdesc1{\n\tmargin:-3px 0 0 122px;\n}\n.x-pubdesc2{\n\tmargin:-3px 0 0 130px;\n}\n.x-pubdesc3,.x-pubdesc4{\n\tmargin:-21px 0 0 130px;\n}\n.x-pubdesc5,.x-pubdesc6{\n\tmargin:33px 0 0 130px;\n}\n.x-pubdesc-title{\n\tline-height:42px;\n\tcolor:#fb6850;\n\tfont-size:24px;\n\tfont-weight:bold;\n}\n.x-pubdesc-content{\n\twidth:415px;\n\theight:40px;\n\tline-height:20px;\n\toverflow:hidden;\n\tcolor:#636363;\n\tfont-size:16px;\n\tword-wrap:break-word;\n\tword-break:break-all;\n}\n.x-edithread-info{\n    position:absolute;\n    right:152px;\n    top:15px;\n    height:18px;\n    font-size:14px;\n    color:#636363;\n    cursor:pointer;\n}\n.x-edithread-info:hover{text-decoration:none;color:#10b041;}\n.x-edithread-info:hover .xei-setting{\n    background-position:-12px 0;\n}\n.xei-setting{display:inline-block;margin-right:7px;width:12px;height:12px;vertical-align:-1px;background:url(//common1.qyerstatic.com/bbs/old/images/issue_settag.png) no-repeat;}\n.tools-inner-wrap{position:relative;float:left;width:24px;height:24px;margin:6px 0;cursor:pointer;}\n.reload {\n  background: url(//static.qyer.com/models/project/bbs/css/images/reload.png) no-repeat;\n  width: 16px;\n  height: 13px;\n  display: block;\n  cursor: pointer;\n}\n#addPhotoWrap{width:166px;}\n.x-tool-wrap{\n\tposition:absolute;\n\tleft:26px;\n\ttop:0;\n\tvisibility: hidden;\n\topacity:0;\n\tmin-width:78px;\n\t-webkit-transition:all 0.3s linear;\n\t-moz-transition:all 0.3s linear;\n\ttransition:all 0.3s linear;\n\tz-index:1000;\n}\n.x-tool-left{\n\tfloat:left;\n\twidth:10px;\n\theight:26px;\n\tbackground:url(//static.qyer.com/models/project/bbs/images/tooltipleft.png) no-repeat;\n}\n.x-tool-xtm{\n\tfloat:left;\t\n\tpadding:0 4px;\n\tline-height:26px;\n\tword-wrap:break-word;\n\tword-break:break-all;\n\tcolor:#959595;\n\tbackground:url(//static.qyer.com/models/project/bbs/images/tagtip.png) repeat-x;\n}\n.x-tool-right{\n\tfloat:left;\n\twidth:4px;\n\theight:26px;\n\tbackground:url(//static.qyer.com/models/project/bbs/images/tooltipright.png) no-repeat;\n}\n.tools .tools-inner-wrap:hover .x-tool-wrap{display:block;visibility: visible;opacity: 1}\n..qui-popup2{z-index:4000 !important;}\n.x-contact-tips{float:left;line-height:30px;color:#959595;}\n.x-ui-input{\n\twidth:200px;\n\theight: 20px;\n\tmargin:0 6px;\n\toverflow: hidden;\n\tpadding: 3px 7px;\n\tborder: 1px solid #c0c0c0;\n\tfont-size: 14px;\n\tline-height: 20px;\n\tborder-radius: 3px;\n  }\n.x-ao-dest{\n\tdisplay:inline-block;\n\t*display:inline;\n\t*zoom:1;\n\tbackground-image:url(//static.qyer.com/models/project/bbs/images/aoDestination.png);\n\tbackground-position:no-repeat;\n}\n.x-ao-pos1{\n\twidth:12px;\n\theight:16px;\n\tbackground-position:-1px -1px;\n\tvertical-align: -2px;\n}\n.x-ao-pos2{\n\twidth:16px;\n\theight:16px;\n\tmargin-right:6px;\n\tvertical-align: -4px;\n\tbackground-position:-1px -19px;\n}\n#contactPlaceCon{display:none;}\n.qyEdit_append_pic .place .con-des{display:inline-block;*display:inline;*zoom:1;width:66px;margin-left:28px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:bold;vertical-align:-12px;}\n.qyEdit_append_pic .place .qui-inputAutocomplete{left:148px;top:44px;z-index:3000;}\n.qyEdit_append_pic .place .tText{color:#ff654c;}\n.x-btl-wrap{padding-top:8px;color:#959595;}\n#checkedXAll{vertical-align: 1px;}\n.x-btl-wrap label{margin:0 20px 0 6px;color:#636363;}\n.x-ischecked{position:absolute;width:100px;height:100px;cursor:pointer;z-index:2000;}\n.x-ischecked.unchecked{background:url(//static.qyer.com/models/project/bbs/images/xunchecked.png) no-repeat;}\n.x-ischecked.checked{background:url(//static.qyer.com/models/project/bbs/images/xchecked.png) no-repeat;}\n.qui-tip{z-index:5000 !important;}\n.image_cont #photolist .contents{width:164px !important;} \n@media screen and (-webkit-min-device-pixel-ratio: 2),\nscreen and (max-moz-device-pixel-ratio: 2){\n   .xei-setting{\n          background:url(//common1.qyerstatic.com/bbs/old/images/issue_settag.png) no-repeat 0 -7px/12px auto;\n     } \n    .x-edithread-info:hover .xei-setting{background-position:0 -20px}\n       \n}\n.qui-inputAutocomplete{position:absolute;z-index:1100;background-color:#fff;border:1px solid #eee}.qui-inputAutocomplete-ul li{height:32px;line-height:32px;border-bottom:solid 1px #eee;background-color:#fff;cursor:pointer;word-break:keep-all;text-overflow:ellipsis;overflow:hidden}.qui-inputAutocomplete-ul li:hover,.qui-inputAutocomplete-ul li[data-select=true]{background-color:#e0f1de}.qui-inputAutocomplete-ul li.disableDefalut{background-color:#fff!important;cursor:default}.qui-inputAutocomplete-noResult{color:red}.qyer_inputAutocomplete_name{padding:0 5px 0 10px}.qyer_inputAutocomplete_name .current{color:#077345}.qyer_inputAutocomplete_en{padding-right:10px;font-family:Tahoma,Geneva,sans-serif}.qyer_inputAutocomplete_found{color:#959595;padding-right:10px}.qyer_inputAutocomplete_creat{padding:10px}.arrowUp { position:absolute; height:7px; width:12px;}\n.arrowUp .arrow1 { position:absolute; left:0; bottom:0px; border-left:6px solid transparent; border-right:6px solid transparent; border-bottom:6px solid #f5f5f5; z-index:10;}\n.arrowUp .arrow2 { position:absolute; left:0; bottom:1px; border-left:6px solid transparent; border-right:6px solid transparent; border-bottom:6px solid #d7d7d7; z-index:9;}\n.arrowDown { position:absolute; height:7px; width:12px;}\n.arrowDown .arrow1 { position:absolute; left:0; bottom:0px; border-left:6px solid transparent; border-right:6px solid transparent; border-top:6px solid #f5f5f5; z-index:10;}\n.arrowDown .arrow2 { position:absolute; left:0; bottom:-1px; border-left:6px solid transparent; border-right:6px solid transparent; border-top:6px solid #d7d7d7; z-index:9;}\n.bbs_simple_editor{\n\tborder: 0;\n\tpadding: 0;\n\tborder: 1px solid #3f9f5f;\n\t-webkit-border-radius: 4px;\n\t-moz-border-radius: 4px;\n\tborder-radius: 4px;\n}\n.bbs_simple_foot { height:36px; -webkit-border-radius: 0 0 4px 4px;\n    -moz-border-radius:  0 0 4px 4px;\n    border-radius:  0 0 4px 4px;}\n.bbs_simple_foot a { position:relative;float:left; width:24px; height:24px; margin:6px 0 0 15px; text-indent:-9999px; background:url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat; }\n.bbs_simple_foot .faces { background-position:-34px -200px;}\n.bbs_simple_foot .faces:hover { background-position:-112px -200px;}\n.bbs_simple_foot .senior{float: right;background-image: none;background-position: 6px 6px;margin-right: 14px;text-indent: 1px;width: auto;font-size: 12px;font-family: arial;text-decoration: none;color: #959595;}\n.bbs_simple_foot .senior i{background: url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) 6px 6px no-repeat;display: inline-block;width: 24px;height: 24px;vertical-align: middle;position: relative;top: -2px;}\n.bbs_simple_foot .senior:hover i{background-position: 6px -20px;}\n.bbs_simple_foot .senior:hover{color: #10b041;}\n.bbs_simple_foot .insertimage{background-position: -34px -236px;}\n.bbs_simple_foot .insertimage:hover{background-position: -112px -236px;}\n.bbs_simple_foot .insertvideo{background-position: -34px -272px;}\n.bbs_simple_foot .insertvideo:hover{background-position: -112px -272px;}\n.bbs_simple_foot .insertattach{background-position: -34px -308px;}\n.bbs_simple_foot .insertattach:hover{background-position: -112px -308px;}\n.bbs_simple_Btn{height: 44px;}\n.bbs_simple_Btn .number{ float:left; line-height:24px; margin-top:10px; color:#959595;}\n.bbs_simple_Btn .number .error { color:#fb6850;}\n.bbs_simple_Btn .status{float: left;line-height: 18px;margin-top: 15px;}\n.bbs_simple_Btn .status .error i{display: inline-block;background: url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat 0 -385px;width: 18px;height: 18px;float: left;margin-right: 6px;}\n.bbs_simple_Btn .status .error {margin-left: 10px;color: #fb6850;display: block;}\n.bbs_simple_Btn .btns{float: right;margin-top: 10px;}\n.bbs_simple_Btn .btns .cancel{color: #3f9f5f;font-size: 12px;margin-right: 20px;cursor: pointer;}\n.bbs_simple_Btn .btns .disable{color:#c0c0c0;cursor: pointer;}\n.edui-simple .edui-bbs_emotion .edui-popup-content{background-color:#f4f4f4; width: 400px;}\n.edui-bbs_emotion .edui-popup-content a{background-image: url(//static.qyer.com/models/project/bbs/css/images/emotion.png);display: inline-block;width: 24px;height: 24px;margin: 8px 7px;border: 1px solid #f4f4f4;}\n.edui-bbs_emotion .edui-popup-content a:hover{border: 1px solid #c0c0c0;}\n.edui-bbs_emotion .arrowUp{left:22px; top:1px;}\n.tool_right .tools a{position:relative;}\n.x-tooln-wrap{\n\tposition:absolute;\n\tdisplay:none;\n\tleft:-23px;\n\ttop:-30px;\n\tvisibility: hidden;\n\topacity:0;\n\twidth:74px;\n  z-index:3000;\n\t-webkit-transition:all 0.5s linear;\n\t-moz-transition:all 0.5s linear;\n\ttransition:all 0.5s linear;\n}\n.x-tooln-top{\n\theight:3px;\n\tbackground:url(//static.qyer.com/models/project/bbs/css/images/tooltiptop.png) no-repeat;\n}\n.x-tooln-xtm{\n\tpadding:0 12px;\n\tline-height:20px;\n\tcolor:#959595;\n\ttext-indent:0;\n\tbackground:url(//static.qyer.com/models/project/bbs/css/images/tooltipmiddle.png) repeat-y;\n}\n.x-tooln-bottom{\n\theight:9px;\n\tbackground:url(//static.qyer.com/models/project/bbs/css/images/tooltipbottom.png) no-repeat;\n}\n.senior_dlg_tools .tools a:hover .x-tool-wrap,\n.bbs_simple_foot a:hover .x-tooln-wrap{display:block;visibility: visible;opacity: 1}\n.senior_dlg_head{\n\theight: 100px;\n\tbackground:#fff;\n\tposition: fixed;\n\ttop: 0;\n\twidth: 100%;\n\tz-index: 100;\n}\n.senior_dlg_head .senior_dlg_head_content{\n\theight: 50px;\n\tbackground: #f8f8f8;\n}\n.senior_dlg_head .senior_dlg_close{\n\twidth: 14px;\n    height: 14px;\n    display: block;\n    float: left;\n    margin: 16px 0 0 30px;\n    background: url(//static.qyer.com/models/project/bbs/css/images/editor_icon.png) no-repeat -168px 0;\n    cursor: pointer\n}\n.senior_dlg_head .senior_dlg_close.bottom{\n  width: 80px;\n  height: 50px;\n line-height: 50px;\n  margin: 0 0 0 30px;\n  background: none;\n}\n.senior_dlg_close.bottom:before {\n  content: \'<\';\n  float: left;\n  width: 10px;\n  line-height: 48px;\n}\n.senior_dlg_head .savetip{\n  display: none;\n  line-height: 50px;\n  color: #c0c0c0;\n}\n.senior_dlg_head .saveinfo{\n  float: right;\n  margin-right: 30px;\n  line-height: 50px;\n}\n.senior_dlg_head .saveinfo .stats{\n  margin-right: 8px;\n  color: #c0c0c0;\n}\n.senior_dlg_head .saveinfo .btn{\n  color: #323232;\n  cursor: pointer;\n  text-decoration: none;\n}\n.senior_dlg_head .saveinfo .btn:hover{\n  color: #10b041;\n}\n.senior_dlg_head .senior_dlg_pub {\n  float: right;\n  width: 120px;\n  line-height: 50px;\n  text-align: center;\n  background-color: #10b041;\n  color: #fff;\n  font-size: 16px;\n  text-decoration: none;\n}\n.senior_dlg_tools{\n\tposition: fixed;\n    left: 74%;\n    top: 110px;\n    z-index: 3000;\n}\n.qui-slidConfirm{\n\tz-index: 4100!important;\n}\n.qui-popup{position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(//static.qyer.com/models/common/images/bg_255_255_255_0.7.png);z-index:1000;overflow-y:auto;opacity:0}.qui-popup>div{display:table;height:100%;margin:0 auto}.qui-popup-dt{display:table-cell;vertical-align:middle}.qui-popup-box{margin:0 auto;background-color:#fff;position:relative;-webkit-box-shadow:0 0 6px #aaa;-moz-box-shadow:0 0 6px #aaa;box-shadow:0 0 6px #aaa;border:1px solid #ccc;opacity:0}.qui-popup-cancelBtn,.qui-popup-loadingBtn,.qui-popup-okBtn{vertical-align:middle;margin-left:10px}.qui-popup-box-title{height:60px;line-height:60px;font-size:18px;font-weight:700;padding-left:20px}.qui-popup-box-content{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0 20px}.qui-popup-box-content>iframe{width:100%;border:none}.qui-popup-box-bottom{text-align:right;height:70px;line-height:70px;padding-right:20px}.qui-popup-closeIcon{position:absolute;right:10px;top:10px;cursor:pointer;background-image:url(//static.qyer.com/models/common/ui/popup/ico.png);height:32px;width:32px;background-repeat:no-repeat;background-position:0 0;border-radius:5px}.qui-popup-closeIcon:hover{background-position:0 -38px}.qui-popup-loadingBtn{display:none}.qui-loading{position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(//static.qyer.com/models/common/images/bg_255_255_255_0.7.png);z-index:1000;display:none;opacity:0}.qui-loading>div{display:table-cell;vertical-align:middle;text-align:center}.qui-loading-box{display:inline-block;margin:0 auto;border:3px solid #cfcfcf;color:#555;padding:10px;border-radius:5px;min-width:75pt;font-weight:700;background:-moz-linear-gradient(#fff,#eee 100%);box-shadow:0 0 5px #999}.qui-confirm{position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(//static.qyer.com/models/common/images/bg_255_255_255_0.7.png);z-index:1200;display:none;opacity:0}.qui-confirm-box,.qui-confirm-box-content{position:relative}.qui-confirm>div{display:table-cell;vertical-align:middle}.qui-confirm-box{margin:0 auto;width:300px;top:-50px;opacity:0;overflow:hidden;box-shadow:0 0 6px #aaa;border:1px solid #ccc;background-color:#fff}.qui-confirm-box-title{height:30px;color:#666;line-height:30px;margin-bottom:20px;padding-left:20px;font-weight:700}.qui-confirm-box-content-icon,.qui-confirm-closeIcon{position:absolute;background-image:url(//fed.static.qyer.com/core/web/common/resource/ui/oldconfirm/icons.png);width:32px;background-repeat:no-repeat}.qui-confirm-box-content-icon{float:left;height:32px;margin:-16px 0 0 10px;top:50%;vertical-align:middle}.qui-confirm-box-content-iconOK{background-position:0 -67px}.qui-confirm-box-content-iconError{background-position:0 -12px}.qui-confirm-box-content-iconWarning{background-position:0 -121px}.qui-confirm-box-content-text{color:#666;height:100%;margin:0 20px 0 60px}.qui-confirm-box-bottom{background-color:#fff;text-align:right;height:50px;line-height:50px;padding-right:20px}.qui-confirm-closeIcon{right:10px;top:10px;cursor:pointer;height:32px;background-position:0 -192px;border-radius:5px}.qui-confirm-closeIcon:hover{background-position:0 -230px}.qui-confirm-box-clearFloat{clear:both;height:0;overflow:hidden}\n.num-turn { line-height: 20px; height: 20px; text-align: center; overflow-y: hidden; white-space: nowrap;}\n.num-turn .num-wrap { display: inline-block; position: relative; width: 8px; height: 100%;}\n.num-turn .num-span { position: absolute; top: 0;}\n.num-turn .num-span span { display: block; height: 100%;}\n.qui-iconShares { float:left;}\n.qui-iconShares > a { float:left; margin-left:5px; width:16px; height:16px; background-color:#f00; cursor:pointer;}\n.qui-iconShares > a:first-child { margin-left:0;}\n.qui-iconShares > a:hover { opacity:0.8;}\n.qui-iconShares > a { background:url(//static.qyer.com/images/common/tpl/share16.png) no-repeat left center;}\n.qui-iconShares > a.tsina { background-position:0 0;}\n.qui-iconShares > a.tqq { background-position:-26px 0;}\n.qui-iconShares > a.qzone { background-position:-52px 0;}\n.qui-iconShares > a.renren { background-position:-78px 0;}\n.qui-iconShares > a.douban { background-position:-104px 0;}\n.qui-iconShares > a.weixin { background-position:-130px 0;}\n.qui-iconShares.size24 > a { width:24px; height:24px; background:url(//static.qyer.com/images/common/tpl/share24.png) no-repeat left center;}\n.qui-iconShares.size24 > a.tsina { background-position:0 0;}\n.qui-iconShares.size24 > a.tqq { background-position:-34px 0;}\n.qui-iconShares.size24 > a.qzone { background-position:-68px 0;}\n.qui-iconShares.size24 > a.renren { background-position:-102px 0;}\n.qui-iconShares.size24 > a.douban { background-position:-136px 0;}\n.qui-iconShares.size24 > a.weixin { background-position:-170px 0;}\n#jiathisShadowLayer { position:absolute; right:0; bottom:0; display:none;}\n.sts{\n  color: #636363;\n  line-height: 20px;\n  float: left;\n}\n.sts a{\n    display: block;\n    margin: 0 10px;\n}\n.sts a:hover{\n    text-decoration: none;\n    cursor: pointer;\n}\n.sts .icon{\n    width: 28px;\n    height: 20px;\n    \n}\n.bbs_setingIcon .sts .txt{\n    display:inline-block;\n    margin-top:-5px;\n    color:#323232;\n}\n.bbs_setingIcon .cntxt{color:#474747;font-size:14px;}\n.bbs_setingIcon .enter .cntxt{color:#10b041;}\n.reply .icon{\n    \n}\n.reply.enter .icon{\n    \n}\n.reply.enter .txt{\n    color: #10b041;\n}\n.reply.press .icon{\n    \n}\n.reply.press .txt{\n    color: #007852;\n}\n.reply .selected{\n    \n}\n.share{\n    position: relative;\n}\n.share .icon{\n    background-position: -1px -200px;\n}\n.share.enter .icon{\n    background-position: -58px -200px;\n}\n.share.enter .txt{\n    color: #10b041;\n}\n.share .icon:active{\n    background-position: -122px -200px;\n}\n.share .selected{\n    background-position: -193px -200px;\n}\n.share .content{\n    display: none;\n    width: 82px;\n    height: 24px;\n    position: absolute;\n    top: 24px;\n    right: 8px;\n    border-radius: 3px;\n    border: 1px solid #ccc;\n    padding: 5px;\n    background: #fff;\n}\n.share .content .arrow0{\n    position: absolute;\n    top: -5px;\n    right: 50px;\n    height: 4px;\n    display: block;\n}\n.share .content .arrow0 span{\n    display: inline-block;\n    height: 0;\n    width: 0;\n    overflow: hidden;\n    position: absolute;\n}\n.share .content .arrow1{\n    left: 1px;\n    top: 1px;\n    z-index: 1;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n    border-bottom: 4px solid #fff;\n}\n.share .content .arrow2{\n    left: 0;\n    top: 0;\n    z-index: 0;\n    border-left: 5px solid transparent;\n    border-right: 5px solid transparent;\n    border-bottom: 5px solid #ccc;\n}\n.share .content .size24 a{\n    width: 24px;\n    height: 24px;\n    background: url(//static.qyer.com/images/common/tpl/share24.png) no-repeat left center;\n    display: inline-block;\n    margin: 0 1px;\n}\n.share .content .size24 a.tsina{\n    background-position: 0 0;\n    margin-right: 4px;\n    margin-left: -1px;\n}\n.share .content .size24 a.weixin{\n    background-position: -170px 0;\n    margin-right: 4px;\n}\n.share .content .size24 a.qzone{\n    background-position: -68px 0;\n}\n@media (-webkit-min-device-pixel-ratio: 2){\n    \n        \n        \n        \n        \n    \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n    \n        \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n    \n        \n    \n}\n.qui-textArea{zoom:1}.qui-textArea .red{color:red}.qui-textArea input,.qui-textArea textarea{word-break:break-all;transition:height .2s;-webkit-transition:height .2s;-moz-transition:height .2s;-ms-transition:height .2s;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box}.qui-textArea .autoHeight{overflow:hidden}.qui-errorip-textDiv1>.tip>p,.qui-errorip-textDiv>.tip>p{position:absolute;width:0;height:0}.qui-errorip{border:1px solid #d0312b!important}.qui-errorip-textDiv{border:1px solid #d0312b;background-color:#ffcccd;color:#88777c;position:absolute;z-index:2000}.qui-errorip-textDiv>.tip{display:block;position:absolute;left:5px;top:0}.qui-errorip-textDiv>.tip>.a1,.qui-errorip-textDiv>.tip>.a2{left:0;border-left:5px solid transparent;border-right:5px solid transparent}.qui-errorip-textDiv>.tip>.a1{top:-5px;border-bottom:5px solid #CB0013}.qui-errorip-textDiv>.tip>.a2{top:-4px;border-bottom:5px solid #FFCCCD}.qui-errorip-textDiv>.text{padding:0 5px}.qui-errorip-textDiv1{border:1px solid #ebb75a;background-color:#fff894;color:#222;position:absolute;z-index:2000;border-radius:3px}.qui-errorip-textDiv1>.tip{display:block;position:absolute;left:50%;bottom:-5px;margin-left:-5px}.qui-errorip-textDiv1>.tip>.a1,.qui-errorip-textDiv1>.tip>.a2{left:0;border-left:5px solid transparent;border-right:5px solid transparent}.qui-errorip-textDiv1>.tip>.a1{top:-4px;border-top:5px solid #ebb75a}.qui-errorip-textDiv1>.tip>.a2{top:-5px;border-top:5px solid #fff894}.qui-errorip-textDiv1>.text{max-width:300px;overflow:hidden;padding:0 8px;text-overflow:ellipsis;white-space:nowrap}.qui-openAskContainer .fz12{font-size:12px}.qui-openAskContainer .vm{vertical-align:middle}.qui-openAskContainer .bs{box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box}.qui-openAskContainer .p20{padding:0 20px}.qui-openAskContainer .mt20{margin-top:20px}.qui-openAskContainer .qui-popup-box-content{padding:0}.qui-openAskContainer .disableDefalut,.qui-openAskContainer .hide,.qui-openAskContainer .qui-popup-box-bottom{display:none}.qui-openAskContainer .qui-textArea{display:block;margin-top:10px}.qui-openAskContainer .qui-textArea input,.qui-openAskContainer .qui-textArea textarea{width:100%;height:100%;font-size:14px}.qui-openAskContainer .qui-textArea textarea{line-height:1.5}.qui-openAskContainer .qui-textArea input{line-height:1}.qui-openAskContainer .qui-textArea .tips{margin-top:6px;font-size:12px;color:#959595}.qui-openAskContainer .openAsk-askTitle{font-size:18px;line-height:20px}.qui-openAskContainer .openAsk-title{height:32px}.qui-openAskContainer .openAsk-content{height:128px}.qui-openAskContainer .openAsk-contentTitle{font-size:14px;line-height:16px;margin-top:40px}.qui-openAskContainer .tags{height:48px;margin-top:60px;border-top:1px solid #c3c3c3;border-bottom:1px solid #c3c3c3;background:#e0f1df;position:relative;z-index:101;font-size:0}.qui-openAskContainer .tags .btn-tag-close,.qui-openAskContainer .tags .tag,.qui-openAskContainer .tags .tag-input-ribbon,.qui-openAskContainer .tags .tag-item,.qui-openAskContainer .tags .tag-title{display:inline-block}.qui-openAskContainer .tags .tag-title{height:48px;line-height:48px;font-size:12px}.qui-openAskContainer .tags .tag-item{float:none;margin-right:10px;font-size:12px}.qui-openAskContainer .tags .tag-item .tag{float:left;padding:0 5px 0 12px;line-height:24px;background:url(//fed.static.qyer.com/core/web/common/resources/component/openAsk/images/two/tag_bg.png) no-repeat;color:#FFF;max-width:85px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.qui-openAskContainer .tags .tag-item .btn-tag-close{float:left;width:22px;height:24px;background:url(//fed.static.qyer.com/core/web/common/resources/component/openAsk/images/two/tag_bg.png) left -30px no-repeat;cursor:pointer}.qui-openAskContainer .tags .tag-item .btn-tag-close:hover{background-position:left -60px}.qui-openAskContainer .tags .tag-input-ribbon em{padding:0 6px;font-size:12px}.qui-openAskContainer .tags .tag-input-ribbon input{width:120px;height:22px;padding:0 6px;font-size:12px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;line-height:1}.qui-openAskContainer .ask-bottom-box{position:relative;padding:20px;height:70px}.qui-openAskContainer .ask-bottom-box .publish-box{position:relative;float:left;border:1px solid silver;padding:0 50px 0 10px;line-height:22px;cursor:pointer}.qui-openAskContainer .ask-bottom-box .publish-box:hover{border:1px solid #999}.qui-openAskContainer .ask-bottom-box .publish-box .publish-arrow{position:absolute;right:10px;top:9px;width:0;height:0;overflow:hidden;border:4px solid transparent;border-top-color:#959595;border-bottom-width:0;cursor:pointer}.qui-openAskContainer .ask-bottom-box .publish-box.open .publish-arrow{border:4px solid transparent;border-bottom-color:#959595;border-top-width:0}.qui-openAskContainer .bbs-container{position:absolute;top:-357px;white-space:nowrap;font-size:0;z-index:2001;border:1px solid silver;background-color:#FFF;padding:10px 30px 10px 10px;overflow:hidden}.qui-openAskContainer .bbs-container .item{display:inline-block;vertical-align:top;padding-left:30px;margin-bottom:-30px;font-size:12px}.qui-openAskContainer .bbs-container .item:first-child{padding-left:0}.qui-openAskContainer .bbs-container dl{margin-bottom:30px}.qui-openAskContainer .bbs-container dt{font-weight:700;margin-bottom:6px;line-height:14px}.qui-openAskContainer .bbs-container a{display:block;line-height:24px;padding:0 6px;color:#636363}.qui-openAskContainer .bbs-container a:hover{background-color:#ececec;color:#0073b6;text-decoration:none}.qui-inputAutocomplete .qui-inputAutocomplete-noResult{padding-left:6px;border:1px solid #d7d7d7;line-height:22px;color:#959595;font-size:12px}'),
function(e){"undefined"==typeof e.cookie&&(e.cookie=function(t,n,i){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null===n||void 0===n)){if(i=e.extend({},i),null!==n&&void 0!==n||(i.expires=-1),"number"==typeof i.expires){var o=i.expires,r=i.expires=new Date;r.setDate(r.getDate()+o)}return n=String(n),document.cookie=[encodeURIComponent(t),"=",i.raw?n:encodeURIComponent(n),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}i=n||{};for(var a,s=i.raw?function(e){return e}:decodeURIComponent,l=document.cookie.split("; "),d=0;a=l[d]&&l[d].split("=");d++)if(s(a[0])===t)return s(a[1]||"");return null})}(jQuery),define("common/models/basic/js/jquery.cookie",function(){}),$(function(){function e(e,t,n){var i=t?'<video class="video_mp4" preload="auto" controls="controls" poster="'+(n||"")+'" onclick="var v = document.querySelector(" video_mp4");="" if="" (v.ended="" ||="" v.paused)="" v.play();="" else="" v.pause();"="" style="cursor:pointer;max-width:100%"><source src="'+e+'" type="video/mp4"></video>':'<object width="680" height="450" type="application/x-oleobject" align="middle"><param name="URL" value="'+e+'"><param name="ShowStatusBar" value="true"><param name="AutoStart" value="0"><param name="PlayCount" value="1"><param name="windowlessVideo" value="1"><param name="invokeURLs" value="false"><param name="wmode" value="opaque"><embed type="application/x-shockwave-flash" wmode="opaque" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+e+'"  width="680" height="450" flashvars="isAutoPlay=false&autoPlay=0" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true"></object>';return i}var t=function(e,t,n){var i=n,o=0;null==n&&(i=e[0],o=1);for(var r=e.length;o<r;o++)i=t.call(null,i,e[o],o,e);return i},n=function(e,t){return e.push(t),e},i=function(e,i,o){return t(e,function(e,t,r){return n(e,i.call(o,t,r))},[])},o=function(e,i,o){return t(e,function(e,t,o){return i(t,o)?n(e,t):e},[])},r=function(e,n){t(e,function(e,t,i){return n(t,i),e},[])},a=$(".editor");$.each(a.find("[data-type=video],[data-type=media]"),function(t,n){var i=$(n),o=i.attr("data-src"),r=i.attr("data-poster")||"",a=o;if(a.indexOf(".swf")>=0)i.append(e(a));else if(~a.indexOf(".mp4"))i.append(e(a,"mp4",r));else if(~a.indexOf(".m3u8")){i.after('<span class="qyer_block qyer_video"><a class="title fontSong"><span>'+i.attr("data-title")+"</span>&nbsp;&nbsp;-&nbsp;&nbsp;视频</a></span>");var s=setTimeout(function(){i.hide(),clearTimeout(s)},0)}else $.ajax({url:BBS_Url.checkVideo,data:{url:a},dataType:"json",success:function(t){if(0!=t.error_code){var n='<a href="'+a+'" target="_blank">'+a+"</a>";i.append(n).css({height:"auto"})}else i.append(e(t.data.swf))}})});var s=$(".qyer_block.qyer_image");s.length&&$.each(s,function(e,t){var n=$(t).find("img");$(t).replaceWith('<img data-type="photo" data-info="[]" data-original="'+n.attr("src")+'" data-id="'+n.attr("id")+'" class="js_addImgSpan" style="display:block;"/>')}),$(document).on("ready",function(){var e,t,n,i,o,r=window.devicePixelRatio,a=/index[^\/]*\/((\d+)x(\d+)?)/;r&&r>=1.5&&$(".bbsDetailContainer img").each(function(r,s){e=$(s).attr("data-original"),e&&(t=e.match(a),t&&t.length>0&&(n=t[1],i=t[2],o=t[3],$(s).attr("data-original",e.replace(n,2*i+"x"+(o?2*o:"")))))}),$(".bbsDetailContainer img[data-original],.xplan-container img[data-original]").lazyload({effect:"fadeIn",threshold:800,load:function(){$(this).removeAttr("height");var e=$(".toggleImg");if(e&&e.length>0){var t=e[0];0==$(t).attr("data-img")||1==$(this).attr("data-isload")?$(this).show():$(this).hide()}}}),$(".bbsDetailContainer").each(function(e,t){var n=$(t).html();if(n.indexOf("font-size:12px")!=-1){var i=$(t).parents(".bbs_detail_item");i.attr("data-id");$(t).html(n.replace(/font-size:12px/gi,""))}})});var l=$(".bbs_detail_content"),d=l.find("span, strong, font");$.each(d,function(e,n){var a=$(n),s=a.attr("style")||"",l=function(e){return e.replace(/^\s+|\s+$/g,"")},d=function(e){return i(e.split(";"),function(e){var t=e.indexOf(":"),n=l(e.substr(0,t)),i=l(e.substr(t+1));return{key:n.toLowerCase(),val:i.toLowerCase()}})},c=d(s),u=o(c,function(e){return"color"!==e.key}),p=t(u,function(e,t){return e[t.key]="",e},{});"font"===a[0].tagName.toLowerCase()&&(a.parents("p").length?p={}:(p["font-size"]="inherit",r(["size","SIZE"],function(e){a.removeAttr(e)}))),a.css(p)}),function(){function e(e){if(1==e)$(".bbs_detail_content .bbsDetailContainer .fillimg").each(function(e,t){$(t).remove()}),$(".bbsDetailContainer img[data-original],.xplan-container img[data-original]").show();else{var t=$(".bbs_detail_content .bbsDetailContainer img[data-type='photo']");t.each(function(e,t){var n=$('<a class="fillimg" href="javascript:;"><div class="x-tooln-wrap"><div class="x-tooln-top"></div><div class="x-tooln-xtm">展示图片</div><div class="x-tooln-bottom"></div></div></a>');n.on("click",function(){$(this).next().show(),$(this).next().attr("data-isload","1"),$(this).remove()}),$(t).before(n),$(t).hide()})}}function t(t){var n=$(".toggleImg"),i="",o="";0==t?(t=1,i="有图模式",n.each(function(e,t){o=$(t).attr("data-bn-ipg"),$(t).attr("data-bn-ipg",o.replace("withPic","withoutPic"))}),e(!1)):(t=0,i="无图模式",n.each(function(e,t){o=$(t).attr("data-bn-ipg"),$(t).attr("data-bn-ipg",o.replace("withoutPic","withPic"))}),e(!0)),n.html(i),n.each(function(e,n){$(n).attr("data-img",t)})}require(["common/models/basic/js/jquery.cookie"],function(){var e=$.cookie("qyer_tids")||"";t(e.indexOf(BBS.TID)!=-1?0:1),$(".toggleImg").on("click",function(){var n=$(this).attr("data-img");if(0==n){if(e.indexOf(BBS.TID)==-1){var i=e.split(",");i.push(BBS.TID),$.cookie("qyer_tids",i.join(","),{expires:1})}}else $.cookie("qyer_tids",e.replace(BBS.TID,"").replace(",,",","));t(n)})})}()}),define("old/js/parseEditor",function(){});