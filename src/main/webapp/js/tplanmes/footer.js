function $SanitizeProvider() {
	this.$get = ["$$sanitizeUri",
		function(e) {
			return function(t) {
				var n = [];
				return htmlParser(t, htmlSanitizeWriter(n, function(t, n) {
					return !/^unsafe/.test(e(t, n))
				})), n.join("")
			}
		}
	]
}

function sanitizeText(e) {
	var t = [];
	return htmlSanitizeWriter(t, angular.noop).chars(e), t.join("")
}

function makeMap(e, t) {
	var n, i = {},
		a = e.split(",");
	for (n = 0; n < a.length; n++) i[t ? angular.lowercase(a[n]) : a[n]] = !0;
	return i
}

function htmlParser(e, t) {
	function n(e, n, a, o) {
		if (n = angular.lowercase(n), blockElements[n])
			for (; l.last() && inlineElements[l.last()];) i("", l.last());
		optionalEndTagElements[n] && l.last() == n && i("", n), (o = voidElements[n] || !!o) || l.push(n);
		var r = {};
		a.replace(ATTR_REGEXP, function(e, t, n, i, a) {
			var o = n || i || a || "";
			r[t] = decodeEntities(o)
		}), t.start && t.start(n, r, o)
	}

	function i(e, n) {
		var i, a = 0;
		if (n = angular.lowercase(n))
			for (a = l.length - 1; a >= 0 && l[a] != n; a--);
		if (a >= 0) {
			for (i = l.length - 1; i >= a; i--) t.end && t.end(l[i]);
			l.length = a
		}
	}
	"string" != typeof e && (e = null === e || void 0 === e ? "" : "" + e);
	var a, o, r, s, l = [],
		c = e;
	for (l.last = function() {
		return l[l.length - 1]
	}; e;) {
		if (s = "", o = !0, l.last() && specialElements[l.last()] ? (e = e.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*" + l.last() + "[^>]*>", "i"), function(e, n) {
			return n = n.replace(COMMENT_REGEXP, "$1").replace(CDATA_REGEXP, "$1"), t.chars && t.chars(decodeEntities(n)), ""
		}), i("", l.last())) : (0 === e.indexOf("\x3c!--") ? (a = e.indexOf("--", 4)) >= 0 && e.lastIndexOf("--\x3e", a) === a && (t.comment && t.comment(e.substring(4, a)), e = e.substring(a + 3), o = !1) : DOCTYPE_REGEXP.test(e) ? (r = e.match(DOCTYPE_REGEXP)) && (e = e.replace(r[0], ""), o = !1) : BEGING_END_TAGE_REGEXP.test(e) ? (r = e.match(END_TAG_REGEXP)) && (e = e.substring(r[0].length), r[0].replace(END_TAG_REGEXP, i), o = !1) : BEGIN_TAG_REGEXP.test(e) && (r = e.match(START_TAG_REGEXP), r ? (r[4] && (e = e.substring(r[0].length), r[0].replace(START_TAG_REGEXP, n)), o = !1) : (s += "<", e = e.substring(1))), o && (a = e.indexOf("<"), s += a < 0 ? e : e.substring(0, a), e = a < 0 ? "" : e.substring(a), t.chars && t.chars(decodeEntities(s)))), e == c) throw $sanitizeMinErr("badparse", "The sanitizer was unable to parse the following block of html: {0}", e);
		c = e
	}
	i()
}

function decodeEntities(e) {
	return e ? (hiddenPre.innerHTML = e.replace(/</g, "&lt;"), hiddenPre.textContent) : ""
}

function encodeEntities(e) {
	return e.replace(/&/g, "&amp;").replace(SURROGATE_PAIR_REGEXP, function(e) {
		return "&#" + (1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320) + 65536) + ";"
	}).replace(NON_ALPHANUMERIC_REGEXP, function(e) {
		return "&#" + e.charCodeAt(0) + ";"
	}).replace(/</g, "&lt;").replace(/>/g, "&gt;")
}

function htmlSanitizeWriter(e, t) {
		var n = !1,
			i = angular.bind(e, e.push);
		return {
			start: function(e, a, o) {
				e = angular.lowercase(e), !n && specialElements[e] && (n = e), n || !0 !== validElements[e] || (i("<"), i(e), angular.forEach(a, function(n, a) {
					var o = angular.lowercase(a),
						r = "img" === e && "src" === o || "background" === o;
					!0 !== validAttrs[o] || !0 === uriAttrs[o] && !t(n, r) || (i(" "), i(a), i('="'), i(encodeEntities(n)), i('"'))
				}), i(o ? "/>" : ">"))
			},
			end: function(e) {
				e = angular.lowercase(e), n || !0 !== validElements[e] || (i("</"), i(e), i(">")), e == n && (n = !1)
			},
			chars: function(e) {
				n || i(encodeEntities(e))
			}
		}
	}! function(e) {
		function t(i) {
			if (n[i]) return n[i].exports;
			var a = n[i] = {
				exports: {},
				id: i,
				loaded: !1
			};
			return e[i].call(a.exports, a, a.exports, t), a.loaded = !0, a.exports
		}
		var n = {};
		t.m = e, t.c = n, t.p = "", t(0)
	}([
		function(e, t, n) {
			"use strict";

			function i(e, t) {
				if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
			}
			var a = function() {
				function e(e, t) {
					for (var n = 0; n < t.length; n++) {
						var i = t[n];
						i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i)
					}
				}
				return function(t, n, i) {
					return n && e(t.prototype, n), i && e(t, i), t
				}
			}();
			n(1);
			var o = n(298),
				r = n(299),
				s = function(e) {
					return e && e.__esModule ? e : {
						default: e
					}
				}(r),
				l = n(300),
				c = new Date,
				d = 201,
				u = (new Date(Date.UTC(c.getFullYear(), c.getMonth(), c.getDate(), 10)), function() {
					function e(t, n) {
						i(this, e), this._markers = [], this._lines = [], this._zIndex = d, this._element = document.getElementById(t), this._options = Object.assign({
							center: {
								lat: 39.9087306,
								lng: 116.3886342
							},
							zoom: 15
						}, n), "undefined" != typeof google && google.maps ? this.initMap() : this.loadScript()
					}
					return a(e, [{
						key: "initMap",
						value: function() {
							this._map = new google.maps.Map(this._element, this._options), this._service = new google.maps.DirectionsService, this.initLayers(), this.onload && this.onload.call(this)
						}
					}, {
						key: "getMap",
						value: function() {
							return this._map
						}
					}, {
						key: "initLayers",
						value: function() {
							var e = n(301),
								t = e.BubbleLayer,
								i = n(306),
								a = i.CardLayer;
							this.bubbleLayer = new t(this._map), this.cardLayer = new a(this._map)
						}
					}, {
						key: "loadScript",
						value: function() {
							var e = this;
							window[o.CALLBACK] = function() {
								e.initMap(), window[o.CALLBACK] = null
							}, this.script = document.createElement("script"), this.script.type = "text/javascript", this.script.src = "http://maps.google.cn/maps/api/js?region=cn&language=zh-CN&libraries=geometry&sensor=false&key=" + o.API_KEY + "&callback=" + o.CALLBACK, document.body.appendChild(this.script)
						}
					}, {
						key: "addMarker",
						value: function(e) {
							var t = new google.maps.Marker(Object.assign({}, e, {
									position: {
										lat: e.lat,
										lng: e.lng
									},
									icon: new s.default(e),
									label: null,
									title: null,
									zIndex: this._zIndex++,
									map: this._map
								})),
								n = void 0;
							return this._markers.push(t), e.title && (n = this.bubbleLayer.addBubble({
								text: e.title,
								marker: t,
								index: e.index,
								type: e.bubbleType || l.BubbleType.TOP
							}), t._bubble = n, this.bubbleLayer.draw()), t.addListener("mouseover", function(e) {
								return t.setZIndex(t.getZIndex() + 1e3)
							}), t.addListener("mouseout", function(e) {
								return t.setZIndex(t.getZIndex() - 1e3)
							}), t
						}
					}, {
						key: "removeMarker",
						value: function(e) {
							var t = this._markers.indexOf(e);
							t > -1 && (e.setMap(null), this._zIndex--, e._bubble && this.bubbleLayer.removeBubble(e._bubble), this._markers.splice(t, 1))
						}
					}, {
						key: "clearMarkers",
						value: function() {
							var e = this;
							this._markers.map(function(t) {
								t.setMap(null), t._bubble && e.bubbleLayer.removeBubble(t._bubble)
							}), this._markers = [], this._zIndex = d
						}
					}, {
						key: "addCard",
						value: function(e, t) {
							this.cardLayer.addCard(e, t)
						}
					}, {
						key: "removeCard",
						value: function() {
							this.cardLayer.removeCard()
						}
					}, {
						key: "addLine",
						value: function(e) {
							var t = arguments.length <= 1 || void 0 === arguments[1] ? {} : arguments[1],
								n = [{
									icon: {
										path: "M 0,-1 0,1",
										strokeOpacity: 1,
										scale: 3
									},
									offset: "0",
									repeat: "15px"
								}];
							Array.isArray(e) ? e = e.map(function(e) {
								return {
									lat: parseFloat(e.lat),
									lng: parseFloat(e.lng)
								}
							}) : (e = google.maps.geometry.encoding.decodePath(e.points), n = null);
							var i = new google.maps.Polyline(Object.assign({
								path: e,
								strokeColor: t.color || "#F56F62",
								strokeOpacity: t.opacity || 1,
								strokeWeight: n ? 0 : 2,
								icons: n,
								map: this._map
							}, t));
							return this._lines.push(i), i
						}
					}, {
						key: "removeLine",
						value: function(e) {
							var t = this._lines.indexOf(e);
							t > -1 && (e.setMap(null), this._lines.splice(t, 1))
						}
					}, {
						key: "clearLines",
						value: function() {
							this._lines.map(function(e) {
								return e.setMap(null)
							}), this._lines = []
						}
					}, {
						key: "clear",
						value: function() {
							this.clearMarkers(), this.clearLines()
						}
					}, {
						key: "fitBounds",
						value: function(e) {
							this._map.fitBounds(e.reduce(function(e, t) {
								return e.extend(new google.maps.LatLng(+t.lat, +t.lng)), e
							}, new google.maps.LatLngBounds))
						}
					}, {
						key: "fromLatLngToPixel",
						value: function(e) {
							var t = Math.pow(2, this._map.getZoom()),
								n = this._map.getProjection(),
								i = this._map.getBounds(),
								a = n.fromLatLngToPoint(new google.maps.LatLng(i.getNorthEast().lat(), i.getSouthWest().lng())),
								o = n.fromLatLngToPoint(e);
							return new google.maps.Point(Math.floor((o.x - a.x) * t), Math.floor((o.y - a.y) * t))
						}
					}, {
						key: "fromPixelToLatLng",
						value: function(e) {
							var t = Math.pow(2, this._map.getZoom()),
								n = this._map.getProjection(),
								i = this._map.getBounds(),
								a = n.fromLatLngToPoint(new google.maps.LatLng(i.getNorthEast().lat(), i.getSouthWest().lng())),
								o = new google.maps.Point;
							return o.x = e.x / t + a.x, o.y = e.y / t + a.y, n.fromPointToLatLng(o)
						}
					}]), e
				}());
			window.planner = window.planner || {}, planner.maps = {
				Map: u,
				IconType: r.iconTypes,
				BubbleType: l.BubbleType
			}
		},
		function(e, t, n) {
			(function(e) {
				"use strict";

				function t(e, t, n) {
					e[t] || Object[i](e, t, {
						writable: !0,
						configurable: !0,
						value: n
					})
				}
				if (n(2), n(293), n(295), e._babelPolyfill) throw new Error("only one instance of babel-polyfill is allowed");
				e._babelPolyfill = !0;
				var i = "defineProperty";
				t(String.prototype, "padLeft", "".padStart), t(String.prototype, "padRight", "".padEnd), "pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e) {
					[][e] && t(Array, e, Function.call.bind([][e]))
				})
			}).call(t, function() {
				return this
			}())
		},
		function(e, t, n) {
			n(3), n(52), n(53), n(54), n(55), n(57), n(60), n(61), n(62), n(63), n(64), n(65), n(66), n(67), n(68), n(70), n(72), n(74), n(76), n(79), n(80), n(81), n(85), n(87), n(89), n(92), n(93), n(94), n(95), n(97), n(98), n(99), n(100), n(101), n(102), n(103), n(105), n(106), n(107), n(109), n(110), n(111), n(113), n(114), n(115), n(116), n(117), n(118), n(119), n(120), n(121), n(122), n(123), n(124), n(125), n(126), n(131), n(132), n(136), n(137), n(138), n(139), n(141), n(142), n(143), n(144), n(145), n(146), n(147), n(148), n(149), n(150), n(151), n(152), n(153), n(154), n(155), n(156), n(157), n(159), n(160), n(166), n(167), n(169), n(170), n(171), n(175), n(176), n(177), n(178), n(179), n(181), n(182), n(183), n(184), n(187), n(189), n(190), n(191), n(193), n(195), n(197), n(198), n(199), n(201), n(202), n(203), n(204), n(211), n(214), n(215), n(217), n(218), n(221), n(222), n(224), n(225), n(226), n(227), n(228), n(229), n(230), n(231), n(232), n(233), n(234), n(235), n(236), n(237), n(238), n(239), n(240), n(241), n(242), n(244), n(245), n(246), n(247), n(248), n(249), n(251), n(252), n(253), n(254), n(255), n(256), n(257), n(258), n(260), n(261), n(263), n(264), n(265), n(266), n(269), n(270), n(271), n(272), n(273), n(274), n(275), n(276), n(278), n(279), n(280), n(281), n(282), n(283), n(284), n(285), n(286), n(287), n(288), n(291), n(292), e.exports = n(9)
		},
		function(e, t, n) {
			"use strict";
			var i = n(4),
				a = n(5),
				o = n(6),
				r = n(8),
				s = n(18),
				l = n(22).KEY,
				c = n(7),
				d = n(23),
				u = n(24),
				p = n(19),
				f = n(25),
				h = n(26),
				g = n(27),
				m = n(29),
				v = n(42),
				y = n(45),
				b = n(12),
				_ = n(32),
				w = n(16),
				x = n(17),
				$ = n(46),
				k = n(49),
				T = n(51),
				C = n(11),
				D = n(30),
				S = T.f,
				P = C.f,
				I = k.f,
				E = i.Symbol,
				L = i.JSON,
				M = L && L.stringify,
				A = f("_hidden"),
				O = f("toPrimitive"),
				j = {}.propertyIsEnumerable,
				F = d("symbol-registry"),
				q = d("symbols"),
				N = d("op-symbols"),
				R = Object.prototype,
				B = "function" == typeof E,
				U = i.QObject,
				H = !U || !U.prototype || !U.prototype.findChild,
				z = o && c(function() {
					return 7 != $(P({}, "a", {
						get: function() {
							return P(this, "a", {
								value: 7
							}).a
						}
					})).a
				}) ? function(e, t, n) {
					var i = S(R, t);
					i && delete R[t], P(e, t, n), i && e !== R && P(R, t, i)
				} : P,
				V = function(e) {
					var t = q[e] = $(E.prototype);
					return t._k = e, t
				},
				W = B && "symbol" == typeof E.iterator ? function(e) {
					return "symbol" == typeof e
				} : function(e) {
					return e instanceof E
				},
				Y = function(e, t, n) {
					return e === R && Y(N, t, n), b(e), t = w(t, !0), b(n), a(q, t) ? (n.enumerable ? (a(e, A) && e[A][t] && (e[A][t] = !1), n = $(n, {
						enumerable: x(0, !1)
					})) : (a(e, A) || P(e, A, x(1, {})), e[A][t] = !0), z(e, t, n)) : P(e, t, n)
				},
				G = function(e, t) {
					b(e);
					for (var n, i = v(t = _(t)), a = 0, o = i.length; o > a;) Y(e, n = i[a++], t[n]);
					return e
				},
				K = function(e, t) {
					return void 0 === t ? $(e) : G($(e), t)
				},
				Q = function(e) {
					var t = j.call(this, e = w(e, !0));
					return !(this === R && a(q, e) && !a(N, e)) && (!(t || !a(this, e) || !a(q, e) || a(this, A) && this[A][e]) || t)
				},
				X = function(e, t) {
					if (e = _(e), t = w(t, !0), e !== R || !a(q, t) || a(N, t)) {
						var n = S(e, t);
						return !n || !a(q, t) || a(e, A) && e[A][t] || (n.enumerable = !0), n
					}
				},
				Z = function(e) {
					for (var t, n = I(_(e)), i = [], o = 0; n.length > o;) a(q, t = n[o++]) || t == A || t == l || i.push(t);
					return i
				},
				J = function(e) {
					for (var t, n = e === R, i = I(n ? N : _(e)), o = [], r = 0; i.length > r;) !a(q, t = i[r++]) || n && !a(R, t) || o.push(q[t]);
					return o
				};
			B || (E = function() {
				if (this instanceof E) throw TypeError("Symbol is not a constructor!");
				var e = p(arguments.length > 0 ? arguments[0] : void 0),
					t = function(n) {
						this === R && t.call(N, n), a(this, A) && a(this[A], e) && (this[A][e] = !1), z(this, e, x(1, n))
					};
				return o && H && z(R, e, {
					configurable: !0,
					set: t
				}), V(e)
			}, s(E.prototype, "toString", function() {
				return this._k
			}), T.f = X, C.f = Y, n(50).f = k.f = Z, n(44).f = Q, n(43).f = J, o && !n(28) && s(R, "propertyIsEnumerable", Q, !0), h.f = function(e) {
				return V(f(e))
			}), r(r.G + r.W + r.F * !B, {
				Symbol: E
			});
			for (var ee = "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","), te = 0; ee.length > te;) f(ee[te++]);
			for (var ee = D(f.store), te = 0; ee.length > te;) g(ee[te++]);
			r(r.S + r.F * !B, "Symbol", {
				for: function(e) {
					return a(F, e += "") ? F[e] : F[e] = E(e)
				},
				keyFor: function(e) {
					if (W(e)) return m(F, e);
					throw TypeError(e + " is not a symbol!")
				},
				useSetter: function() {
					H = !0
				},
				useSimple: function() {
					H = !1
				}
			}), r(r.S + r.F * !B, "Object", {
				create: K,
				defineProperty: Y,
				defineProperties: G,
				getOwnPropertyDescriptor: X,
				getOwnPropertyNames: Z,
				getOwnPropertySymbols: J
			}), L && r(r.S + r.F * (!B || c(function() {
				var e = E();
				return "[null]" != M([e]) || "{}" != M({
					a: e
				}) || "{}" != M(Object(e))
			})), "JSON", {
				stringify: function(e) {
					if (void 0 !== e && !W(e)) {
						for (var t, n, i = [e], a = 1; arguments.length > a;) i.push(arguments[a++]);
						return t = i[1], "function" == typeof t && (n = t), !n && y(t) || (t = function(e, t) {
							if (n && (t = n.call(this, e, t)), !W(t)) return t
						}), i[1] = t, M.apply(L, i)
					}
				}
			}), E.prototype[O] || n(10)(E.prototype, O, E.prototype.valueOf), u(E, "Symbol"), u(Math, "Math", !0), u(i.JSON, "JSON", !0)
		},
		function(e, t) {
			var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")();
			"number" == typeof __g && (__g = n)
		},
		function(e, t) {
			var n = {}.hasOwnProperty;
			e.exports = function(e, t) {
				return n.call(e, t)
			}
		},
		function(e, t, n) {
			e.exports = !n(7)(function() {
				return 7 != Object.defineProperty({}, "a", {
					get: function() {
						return 7
					}
				}).a
			})
		},
		function(e, t) {
			e.exports = function(e) {
				try {
					return !!e()
				} catch (e) {
					return !0
				}
			}
		},
		function(e, t, n) {
			var i = n(4),
				a = n(9),
				o = n(10),
				r = n(18),
				s = n(20),
				l = function(e, t, n) {
					var c, d, u, p, f = e & l.F,
						h = e & l.G,
						g = e & l.S,
						m = e & l.P,
						v = e & l.B,
						y = h ? i : g ? i[t] || (i[t] = {}) : (i[t] || {}).prototype,
						b = h ? a : a[t] || (a[t] = {}),
						_ = b.prototype || (b.prototype = {});
					h && (n = t);
					for (c in n) d = !f && y && void 0 !== y[c], u = (d ? y : n)[c], p = v && d ? s(u, i) : m && "function" == typeof u ? s(Function.call, u) : u, y && r(y, c, u, e & l.U), b[c] != u && o(b, c, p), m && _[c] != u && (_[c] = u)
				};
			i.core = a, l.F = 1, l.G = 2, l.S = 4, l.P = 8, l.B = 16, l.W = 32, l.U = 64, l.R = 128, e.exports = l
		},
		function(e, t) {
			var n = e.exports = {
				version: "2.4.0"
			};
			"number" == typeof __e && (__e = n)
		},
		function(e, t, n) {
			var i = n(11),
				a = n(17);
			e.exports = n(6) ? function(e, t, n) {
				return i.f(e, t, a(1, n))
			} : function(e, t, n) {
				return e[t] = n, e
			}
		},
		function(e, t, n) {
			var i = n(12),
				a = n(14),
				o = n(16),
				r = Object.defineProperty;
			t.f = n(6) ? Object.defineProperty : function(e, t, n) {
				if (i(e), t = o(t, !0), i(n), a) try {
					return r(e, t, n)
				} catch (e) {}
				if ("get" in n || "set" in n) throw TypeError("Accessors not supported!");
				return "value" in n && (e[t] = n.value), e
			}
		},
		function(e, t, n) {
			var i = n(13);
			e.exports = function(e) {
				if (!i(e)) throw TypeError(e + " is not an object!");
				return e
			}
		},
		function(e, t) {
			e.exports = function(e) {
				return "object" == typeof e ? null !== e : "function" == typeof e
			}
		},
		function(e, t, n) {
			e.exports = !n(6) && !n(7)(function() {
				return 7 != Object.defineProperty(n(15)("div"), "a", {
					get: function() {
						return 7
					}
				}).a
			})
		},
		function(e, t, n) {
			var i = n(13),
				a = n(4).document,
				o = i(a) && i(a.createElement);
			e.exports = function(e) {
				return o ? a.createElement(e) : {}
			}
		},
		function(e, t, n) {
			var i = n(13);
			e.exports = function(e, t) {
				if (!i(e)) return e;
				var n, a;
				if (t && "function" == typeof(n = e.toString) && !i(a = n.call(e))) return a;
				if ("function" == typeof(n = e.valueOf) && !i(a = n.call(e))) return a;
				if (!t && "function" == typeof(n = e.toString) && !i(a = n.call(e))) return a;
				throw TypeError("Can't convert object to primitive value")
			}
		},
		function(e, t) {
			e.exports = function(e, t) {
				return {
					enumerable: !(1 & e),
					configurable: !(2 & e),
					writable: !(4 & e),
					value: t
				}
			}
		},
		function(e, t, n) {
			var i = n(4),
				a = n(10),
				o = n(5),
				r = n(19)("src"),
				s = Function.toString,
				l = ("" + s).split("toString");
			n(9).inspectSource = function(e) {
				return s.call(e)
			}, (e.exports = function(e, t, n, s) {
				var c = "function" == typeof n;
				c && (o(n, "name") || a(n, "name", t)), e[t] !== n && (c && (o(n, r) || a(n, r, e[t] ? "" + e[t] : l.join(String(t)))), e === i ? e[t] = n : s ? e[t] ? e[t] = n : a(e, t, n) : (delete e[t], a(e, t, n)))
			})(Function.prototype, "toString", function() {
				return "function" == typeof this && this[r] || s.call(this)
			})
		},
		function(e, t) {
			var n = 0,
				i = Math.random();
			e.exports = function(e) {
				return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++n + i).toString(36))
			}
		},
		function(e, t, n) {
			var i = n(21);
			e.exports = function(e, t, n) {
				if (i(e), void 0 === t) return e;
				switch (n) {
					case 1:
						return function(n) {
							return e.call(t, n)
						};
					case 2:
						return function(n, i) {
							return e.call(t, n, i)
						};
					case 3:
						return function(n, i, a) {
							return e.call(t, n, i, a)
						}
				}
				return function() {
					return e.apply(t, arguments)
				}
			}
		},
		function(e, t) {
			e.exports = function(e) {
				if ("function" != typeof e) throw TypeError(e + " is not a function!");
				return e
			}
		},
		function(e, t, n) {
			var i = n(19)("meta"),
				a = n(13),
				o = n(5),
				r = n(11).f,
				s = 0,
				l = Object.isExtensible || function() {
					return !0
				},
				c = !n(7)(function() {
					return l(Object.preventExtensions({}))
				}),
				d = function(e) {
					r(e, i, {
						value: {
							i: "O" + ++s,
							w: {}
						}
					})
				},
				u = function(e, t) {
					if (!a(e)) return "symbol" == typeof e ? e : ("string" == typeof e ? "S" : "P") + e;
					if (!o(e, i)) {
						if (!l(e)) return "F";
						if (!t) return "E";
						d(e)
					}
					return e[i].i
				},
				p = function(e, t) {
					if (!o(e, i)) {
						if (!l(e)) return !0;
						if (!t) return !1;
						d(e)
					}
					return e[i].w
				},
				f = function(e) {
					return c && h.NEED && l(e) && !o(e, i) && d(e), e
				},
				h = e.exports = {
					KEY: i,
					NEED: !1,
					fastKey: u,
					getWeak: p,
					onFreeze: f
				}
		},
		function(e, t, n) {
			var i = n(4),
				a = i["__core-js_shared__"] || (i["__core-js_shared__"] = {});
			e.exports = function(e) {
				return a[e] || (a[e] = {})
			}
		},
		function(e, t, n) {
			var i = n(11).f,
				a = n(5),
				o = n(25)("toStringTag");
			e.exports = function(e, t, n) {
				e && !a(e = n ? e : e.prototype, o) && i(e, o, {
					configurable: !0,
					value: t
				})
			}
		},
		function(e, t, n) {
			var i = n(23)("wks"),
				a = n(19),
				o = n(4).Symbol,
				r = "function" == typeof o;
			(e.exports = function(e) {
				return i[e] || (i[e] = r && o[e] || (r ? o : a)("Symbol." + e))
			}).store = i
		},
		function(e, t, n) {
			t.f = n(25)
		},
		function(e, t, n) {
			var i = n(4),
				a = n(9),
				o = n(28),
				r = n(26),
				s = n(11).f;
			e.exports = function(e) {
				var t = a.Symbol || (a.Symbol = o ? {} : i.Symbol || {});
				"_" == e.charAt(0) || e in t || s(t, e, {
					value: r.f(e)
				})
			}
		},
		function(e, t) {
			e.exports = !1
		},
		function(e, t, n) {
			var i = n(30),
				a = n(32);
			e.exports = function(e, t) {
				for (var n, o = a(e), r = i(o), s = r.length, l = 0; s > l;)
					if (o[n = r[l++]] === t) return n
			}
		},
		function(e, t, n) {
			var i = n(31),
				a = n(41);
			e.exports = Object.keys || function(e) {
				return i(e, a)
			}
		},
		function(e, t, n) {
			var i = n(5),
				a = n(32),
				o = n(36)(!1),
				r = n(40)("IE_PROTO");
			e.exports = function(e, t) {
				var n, s = a(e),
					l = 0,
					c = [];
				for (n in s) n != r && i(s, n) && c.push(n);
				for (; t.length > l;) i(s, n = t[l++]) && (~o(c, n) || c.push(n));
				return c
			}
		},
		function(e, t, n) {
			var i = n(33),
				a = n(35);
			e.exports = function(e) {
				return i(a(e))
			}
		},
		function(e, t, n) {
			var i = n(34);
			e.exports = Object("z").propertyIsEnumerable(0) ? Object : function(e) {
				return "String" == i(e) ? e.split("") : Object(e)
			}
		},
		function(e, t) {
			var n = {}.toString;
			e.exports = function(e) {
				return n.call(e).slice(8, -1)
			}
		},
		function(e, t) {
			e.exports = function(e) {
				if (void 0 == e) throw TypeError("Can't call method on  " + e);
				return e
			}
		},
		function(e, t, n) {
			var i = n(32),
				a = n(37),
				o = n(39);
			e.exports = function(e) {
				return function(t, n, r) {
					var s, l = i(t),
						c = a(l.length),
						d = o(r, c);
					if (e && n != n) {
						for (; c > d;)
							if ((s = l[d++]) != s) return !0
					} else
						for (; c > d; d++)
							if ((e || d in l) && l[d] === n) return e || d || 0; return !e && -1
				}
			}
		},
		function(e, t, n) {
			var i = n(38),
				a = Math.min;
			e.exports = function(e) {
				return e > 0 ? a(i(e), 9007199254740991) : 0
			}
		},
		function(e, t) {
			var n = Math.ceil,
				i = Math.floor;
			e.exports = function(e) {
				return isNaN(e = +e) ? 0 : (e > 0 ? i : n)(e)
			}
		},
		function(e, t, n) {
			var i = n(38),
				a = Math.max,
				o = Math.min;
			e.exports = function(e, t) {
				return e = i(e), e < 0 ? a(e + t, 0) : o(e, t)
			}
		},
		function(e, t, n) {
			var i = n(23)("keys"),
				a = n(19);
			e.exports = function(e) {
				return i[e] || (i[e] = a(e))
			}
		},
		function(e, t) {
			e.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")
		},
		function(e, t, n) {
			var i = n(30),
				a = n(43),
				o = n(44);
			e.exports = function(e) {
				var t = i(e),
					n = a.f;
				if (n)
					for (var r, s = n(e), l = o.f, c = 0; s.length > c;) l.call(e, r = s[c++]) && t.push(r);
				return t
			}
		},
		function(e, t) {
			t.f = Object.getOwnPropertySymbols
		},
		function(e, t) {
			t.f = {}.propertyIsEnumerable
		},
		function(e, t, n) {
			var i = n(34);
			e.exports = Array.isArray || function(e) {
				return "Array" == i(e)
			}
		},
		function(e, t, n) {
			var i = n(12),
				a = n(47),
				o = n(41),
				r = n(40)("IE_PROTO"),
				s = function() {},
				l = function() {
					var e, t = n(15)("iframe"),
						i = o.length;
					for (t.style.display = "none", n(48).appendChild(t), t.src = "javascript:", e = t.contentWindow.document, e.open(), e.write("<script>document.F=Object<\/script>"), e.close(), l = e.F; i--;) delete l.prototype[o[i]];
					return l()
				};
			e.exports = Object.create || function(e, t) {
				var n;
				return null !== e ? (s.prototype = i(e), n = new s, s.prototype = null, n[r] = e) : n = l(), void 0 === t ? n : a(n, t)
			}
		},
		function(e, t, n) {
			var i = n(11),
				a = n(12),
				o = n(30);
			e.exports = n(6) ? Object.defineProperties : function(e, t) {
				a(e);
				for (var n, r = o(t), s = r.length, l = 0; s > l;) i.f(e, n = r[l++], t[n]);
				return e
			}
		},
		function(e, t, n) {
			e.exports = n(4).document && document.documentElement
		},
		function(e, t, n) {
			var i = n(32),
				a = n(50).f,
				o = {}.toString,
				r = "object" == typeof window && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) : [],
				s = function(e) {
					try {
						return a(e)
					} catch (e) {
						return r.slice()
					}
				};
			e.exports.f = function(e) {
				return r && "[object Window]" == o.call(e) ? s(e) : a(i(e))
			}
		},
		function(e, t, n) {
			var i = n(31),
				a = n(41).concat("length", "prototype");
			t.f = Object.getOwnPropertyNames || function(e) {
				return i(e, a)
			}
		},
		function(e, t, n) {
			var i = n(44),
				a = n(17),
				o = n(32),
				r = n(16),
				s = n(5),
				l = n(14),
				c = Object.getOwnPropertyDescriptor;
			t.f = n(6) ? c : function(e, t) {
				if (e = o(e), t = r(t, !0), l) try {
					return c(e, t)
				} catch (e) {}
				if (s(e, t)) return a(!i.f.call(e, t), e[t])
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Object", {
				create: n(46)
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S + i.F * !n(6), "Object", {
				defineProperty: n(11).f
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S + i.F * !n(6), "Object", {
				defineProperties: n(47)
			})
		},
		function(e, t, n) {
			var i = n(32),
				a = n(51).f;
			n(56)("getOwnPropertyDescriptor", function() {
				return function(e, t) {
					return a(i(e), t)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(9),
				o = n(7);
			e.exports = function(e, t) {
				var n = (a.Object || {})[e] || Object[e],
					r = {};
				r[e] = t(n), i(i.S + i.F * o(function() {
					n(1)
				}), "Object", r)
			}
		},
		function(e, t, n) {
			var i = n(58),
				a = n(59);
			n(56)("getPrototypeOf", function() {
				return function(e) {
					return a(i(e))
				}
			})
		},
		function(e, t, n) {
			var i = n(35);
			e.exports = function(e) {
				return Object(i(e))
			}
		},
		function(e, t, n) {
			var i = n(5),
				a = n(58),
				o = n(40)("IE_PROTO"),
				r = Object.prototype;
			e.exports = Object.getPrototypeOf || function(e) {
				return e = a(e), i(e, o) ? e[o] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? r : null
			}
		},
		function(e, t, n) {
			var i = n(58),
				a = n(30);
			n(56)("keys", function() {
				return function(e) {
					return a(i(e))
				}
			})
		},
		function(e, t, n) {
			n(56)("getOwnPropertyNames", function() {
				return n(49).f
			})
		},
		function(e, t, n) {
			var i = n(13),
				a = n(22).onFreeze;
			n(56)("freeze", function(e) {
				return function(t) {
					return e && i(t) ? e(a(t)) : t
				}
			})
		},
		function(e, t, n) {
			var i = n(13),
				a = n(22).onFreeze;
			n(56)("seal", function(e) {
				return function(t) {
					return e && i(t) ? e(a(t)) : t
				}
			})
		},
		function(e, t, n) {
			var i = n(13),
				a = n(22).onFreeze;
			n(56)("preventExtensions", function(e) {
				return function(t) {
					return e && i(t) ? e(a(t)) : t
				}
			})
		},
		function(e, t, n) {
			var i = n(13);
			n(56)("isFrozen", function(e) {
				return function(t) {
					return !i(t) || !!e && e(t)
				}
			})
		},
		function(e, t, n) {
			var i = n(13);
			n(56)("isSealed", function(e) {
				return function(t) {
					return !i(t) || !!e && e(t)
				}
			})
		},
		function(e, t, n) {
			var i = n(13);
			n(56)("isExtensible", function(e) {
				return function(t) {
					return !!i(t) && (!e || e(t))
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S + i.F, "Object", {
				assign: n(69)
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(30),
				a = n(43),
				o = n(44),
				r = n(58),
				s = n(33),
				l = Object.assign;
			e.exports = !l || n(7)(function() {
				var e = {},
					t = {},
					n = Symbol(),
					i = "abcdefghijklmnopqrst";
				return e[n] = 7, i.split("").forEach(function(e) {
					t[e] = e
				}), 7 != l({}, e)[n] || Object.keys(l({}, t)).join("") != i
			}) ? function(e, t) {
				for (var n = r(e), l = arguments.length, c = 1, d = a.f, u = o.f; l > c;)
					for (var p, f = s(arguments[c++]), h = d ? i(f).concat(d(f)) : i(f), g = h.length, m = 0; g > m;) u.call(f, p = h[m++]) && (n[p] = f[p]);
				return n
			} : l
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Object", {
				is: n(71)
			})
		},
		function(e, t) {
			e.exports = Object.is || function(e, t) {
				return e === t ? 0 !== e || 1 / e == 1 / t : e != e && t != t
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Object", {
				setPrototypeOf: n(73).set
			})
		},
		function(e, t, n) {
			var i = n(13),
				a = n(12),
				o = function(e, t) {
					if (a(e), !i(t) && null !== t) throw TypeError(t + ": can't set as prototype!")
				};
			e.exports = {
				set: Object.setPrototypeOf || ("__proto__" in {} ? function(e, t, i) {
					try {
						i = n(20)(Function.call, n(51).f(Object.prototype, "__proto__").set, 2), i(e, []), t = !(e instanceof Array)
					} catch (e) {
						t = !0
					}
					return function(e, n) {
						return o(e, n), t ? e.__proto__ = n : i(e, n), e
					}
				}({}, !1) : void 0),
				check: o
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(75),
				a = {};
			a[n(25)("toStringTag")] = "z", a + "" != "[object z]" && n(18)(Object.prototype, "toString", function() {
				return "[object " + i(this) + "]"
			}, !0)
		},
		function(e, t, n) {
			var i = n(34),
				a = n(25)("toStringTag"),
				o = "Arguments" == i(function() {
					return arguments
				}()),
				r = function(e, t) {
					try {
						return e[t]
					} catch (e) {}
				};
			e.exports = function(e) {
				var t, n, s;
				return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof(n = r(t = Object(e), a)) ? n : o ? i(t) : "Object" == (s = i(t)) && "function" == typeof t.callee ? "Arguments" : s
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.P, "Function", {
				bind: n(77)
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(21),
				a = n(13),
				o = n(78),
				r = [].slice,
				s = {},
				l = function(e, t, n) {
					if (!(t in s)) {
						for (var i = [], a = 0; a < t; a++) i[a] = "a[" + a + "]";
						s[t] = Function("F,a", "return new F(" + i.join(",") + ")")
					}
					return s[t](e, n)
				};
			e.exports = Function.bind || function(e) {
				var t = i(this),
					n = r.call(arguments, 1),
					s = function() {
						var i = n.concat(r.call(arguments));
						return this instanceof s ? l(t, i.length, i) : o(t, i, e)
					};
				return a(t.prototype) && (s.prototype = t.prototype), s
			}
		},
		function(e, t) {
			e.exports = function(e, t, n) {
				var i = void 0 === n;
				switch (t.length) {
					case 0:
						return i ? e() : e.call(n);
					case 1:
						return i ? e(t[0]) : e.call(n, t[0]);
					case 2:
						return i ? e(t[0], t[1]) : e.call(n, t[0], t[1]);
					case 3:
						return i ? e(t[0], t[1], t[2]) : e.call(n, t[0], t[1], t[2]);
					case 4:
						return i ? e(t[0], t[1], t[2], t[3]) : e.call(n, t[0], t[1], t[2], t[3])
				}
				return e.apply(n, t)
			}
		},
		function(e, t, n) {
			var i = n(11).f,
				a = n(17),
				o = n(5),
				r = Function.prototype,
				s = /^\s*function ([^ (]*)/,
				l = Object.isExtensible || function() {
					return !0
				};
			"name" in r || n(6) && i(r, "name", {
				configurable: !0,
				get: function() {
					try {
						var e = this,
							t = ("" + e).match(s)[1];
						return o(e, "name") || !l(e) || i(e, "name", a(5, t)), t
					} catch (e) {
						return ""
					}
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(13),
				a = n(59),
				o = n(25)("hasInstance"),
				r = Function.prototype;
			o in r || n(11).f(r, o, {
				value: function(e) {
					if ("function" != typeof this || !i(e)) return !1;
					if (!i(this.prototype)) return e instanceof this;
					for (; e = a(e);)
						if (this.prototype === e) return !0;
					return !1
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(82);
			i(i.G + i.F * (parseInt != a), {
				parseInt: a
			})
		},
		function(e, t, n) {
			var i = n(4).parseInt,
				a = n(83).trim,
				o = n(84),
				r = /^[\-+]?0[xX]/;
			e.exports = 8 !== i(o + "08") || 22 !== i(o + "0x16") ? function(e, t) {
				var n = a(String(e), 3);
				return i(n, t >>> 0 || (r.test(n) ? 16 : 10))
			} : i
		},
		function(e, t, n) {
			var i = n(8),
				a = n(35),
				o = n(7),
				r = n(84),
				s = "[" + r + "]",
				l = "​",
				c = RegExp("^" + s + s + "*"),
				d = RegExp(s + s + "*$"),
				u = function(e, t, n) {
					var a = {},
						s = o(function() {
							return !!r[e]() || l[e]() != l
						}),
						c = a[e] = s ? t(p) : r[e];
					n && (a[n] = c), i(i.P + i.F * s, "String", a)
				},
				p = u.trim = function(e, t) {
					return e = String(a(e)), 1 & t && (e = e.replace(c, "")), 2 & t && (e = e.replace(d, "")), e
				};
			e.exports = u
		},
		function(e, t) {
			e.exports = "\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"
		},
		function(e, t, n) {
			var i = n(8),
				a = n(86);
			i(i.G + i.F * (parseFloat != a), {
				parseFloat: a
			})
		},
		function(e, t, n) {
			var i = n(4).parseFloat,
				a = n(83).trim;
			e.exports = 1 / i(n(84) + "-0") != -1 / 0 ? function(e) {
				var t = a(String(e), 3),
					n = i(t);
				return 0 === n && "-" == t.charAt(0) ? -0 : n
			} : i
		},
		function(e, t, n) {
			"use strict";
			var i = n(4),
				a = n(5),
				o = n(34),
				r = n(88),
				s = n(16),
				l = n(7),
				c = n(50).f,
				d = n(51).f,
				u = n(11).f,
				p = n(83).trim,
				f = i.Number,
				h = f,
				g = f.prototype,
				m = "Number" == o(n(46)(g)),
				v = "trim" in String.prototype,
				y = function(e) {
					var t = s(e, !1);
					if ("string" == typeof t && t.length > 2) {
						t = v ? t.trim() : p(t, 3);
						var n, i, a, o = t.charCodeAt(0);
						if (43 === o || 45 === o) {
							if (88 === (n = t.charCodeAt(2)) || 120 === n) return NaN
						} else if (48 === o) {
							switch (t.charCodeAt(1)) {
								case 66:
								case 98:
									i = 2, a = 49;
									break;
								case 79:
								case 111:
									i = 8, a = 55;
									break;
								default:
									return +t
							}
							for (var r, l = t.slice(2), c = 0, d = l.length; c < d; c++)
								if ((r = l.charCodeAt(c)) < 48 || r > a) return NaN;
							return parseInt(l, i)
						}
					}
					return +t
				};
			if (!f(" 0o1") || !f("0b1") || f("+0x1")) {
				f = function(e) {
					var t = arguments.length < 1 ? 0 : e,
						n = this;
					return n instanceof f && (m ? l(function() {
						g.valueOf.call(n)
					}) : "Number" != o(n)) ? r(new h(y(t)), n, f) : y(t)
				};
				for (var b, _ = n(6) ? c(h) : "MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","), w = 0; _.length > w; w++) a(h, b = _[w]) && !a(f, b) && u(f, b, d(h, b));
				f.prototype = g, g.constructor = f, n(18)(i, "Number", f)
			}
		},
		function(e, t, n) {
			var i = n(13),
				a = n(73).set;
			e.exports = function(e, t, n) {
				var o, r = t.constructor;
				return r !== n && "function" == typeof r && (o = r.prototype) !== n.prototype && i(o) && a && a(e, o), e
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(38),
				o = n(90),
				r = n(91),
				s = 1..toFixed,
				l = Math.floor,
				c = [0, 0, 0, 0, 0, 0],
				d = "Number.toFixed: incorrect invocation!",
				u = function(e, t) {
					for (var n = -1, i = t; ++n < 6;) i += e * c[n], c[n] = i % 1e7, i = l(i / 1e7)
				},
				p = function(e) {
					for (var t = 6, n = 0; --t >= 0;) n += c[t], c[t] = l(n / e), n = n % e * 1e7
				},
				f = function() {
					for (var e = 6, t = ""; --e >= 0;)
						if ("" !== t || 0 === e || 0 !== c[e]) {
							var n = String(c[e]);
							t = "" === t ? n : t + r.call("0", 7 - n.length) + n
						}
					return t
				},
				h = function(e, t, n) {
					return 0 === t ? n : t % 2 == 1 ? h(e, t - 1, n * e) : h(e * e, t / 2, n)
				},
				g = function(e) {
					for (var t = 0, n = e; n >= 4096;) t += 12, n /= 4096;
					for (; n >= 2;) t += 1, n /= 2;
					return t
				};
			i(i.P + i.F * (!!s && ("0.000" !== 8e-5.toFixed(3) || "1" !== .9.toFixed(0) || "1.25" !== 1.255.toFixed(2) || "1000000000000000128" !== (0xde0b6b3a7640080).toFixed(0)) || !n(7)(function() {
				s.call({})
			})), "Number", {
				toFixed: function(e) {
					var t, n, i, s, l = o(this, d),
						c = a(e),
						m = "",
						v = "0";
					if (c < 0 || c > 20) throw RangeError(d);
					if (l != l) return "NaN";
					if (l <= -1e21 || l >= 1e21) return String(l);
					if (l < 0 && (m = "-", l = -l), l > 1e-21)
						if (t = g(l * h(2, 69, 1)) - 69, n = t < 0 ? l * h(2, -t, 1) : l / h(2, t, 1), n *= 4503599627370496, (t = 52 - t) > 0) {
							for (u(0, n), i = c; i >= 7;) u(1e7, 0), i -= 7;
							for (u(h(10, i, 1), 0), i = t - 1; i >= 23;) p(1 << 23), i -= 23;
							p(1 << i), u(1, 1), p(2), v = f()
						} else u(0, n), u(1 << -t, 0), v = f() + r.call("0", c);
					return c > 0 ? (s = v.length, v = m + (s <= c ? "0." + r.call("0", c - s) + v : v.slice(0, s - c) + "." + v.slice(s - c))) : v = m + v, v
				}
			})
		},
		function(e, t, n) {
			var i = n(34);
			e.exports = function(e, t) {
				if ("number" != typeof e && "Number" != i(e)) throw TypeError(t);
				return +e
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(38),
				a = n(35);
			e.exports = function(e) {
				var t = String(a(this)),
					n = "",
					o = i(e);
				if (o < 0 || o == 1 / 0) throw RangeError("Count can't be negative");
				for (; o > 0;
					(o >>>= 1) && (t += t)) 1 & o && (n += t);
				return n
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(7),
				o = n(90),
				r = 1..toPrecision;
			i(i.P + i.F * (a(function() {
				return "1" !== r.call(1, void 0)
			}) || !a(function() {
				r.call({})
			})), "Number", {
				toPrecision: function(e) {
					var t = o(this, "Number#toPrecision: incorrect invocation!");
					return void 0 === e ? r.call(t) : r.call(t, e)
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Number", {
				EPSILON: Math.pow(2, -52)
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(4).isFinite;
			i(i.S, "Number", {
				isFinite: function(e) {
					return "number" == typeof e && a(e)
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Number", {
				isInteger: n(96)
			})
		},
		function(e, t, n) {
			var i = n(13),
				a = Math.floor;
			e.exports = function(e) {
				return !i(e) && isFinite(e) && a(e) === e
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Number", {
				isNaN: function(e) {
					return e != e
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(96),
				o = Math.abs;
			i(i.S, "Number", {
				isSafeInteger: function(e) {
					return a(e) && o(e) <= 9007199254740991
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Number", {
				MAX_SAFE_INTEGER: 9007199254740991
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Number", {
				MIN_SAFE_INTEGER: -9007199254740991
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(86);
			i(i.S + i.F * (Number.parseFloat != a), "Number", {
				parseFloat: a
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(82);
			i(i.S + i.F * (Number.parseInt != a), "Number", {
				parseInt: a
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(104),
				o = Math.sqrt,
				r = Math.acosh;
			i(i.S + i.F * !(r && 710 == Math.floor(r(Number.MAX_VALUE)) && r(1 / 0) == 1 / 0), "Math", {
				acosh: function(e) {
					return (e = +e) < 1 ? NaN : e > 94906265.62425156 ? Math.log(e) + Math.LN2 : a(e - 1 + o(e - 1) * o(e + 1))
				}
			})
		},
		function(e, t) {
			e.exports = Math.log1p || function(e) {
				return (e = +e) > -1e-8 && e < 1e-8 ? e - e * e / 2 : Math.log(1 + e)
			}
		},
		function(e, t, n) {
			function i(e) {
				return isFinite(e = +e) && 0 != e ? e < 0 ? -i(-e) : Math.log(e + Math.sqrt(e * e + 1)) : e
			}
			var a = n(8),
				o = Math.asinh;
			a(a.S + a.F * !(o && 1 / o(0) > 0), "Math", {
				asinh: i
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = Math.atanh;
			i(i.S + i.F * !(a && 1 / a(-0) < 0), "Math", {
				atanh: function(e) {
					return 0 == (e = +e) ? e : Math.log((1 + e) / (1 - e)) / 2
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(108);
			i(i.S, "Math", {
				cbrt: function(e) {
					return a(e = +e) * Math.pow(Math.abs(e), 1 / 3)
				}
			})
		},
		function(e, t) {
			e.exports = Math.sign || function(e) {
				return 0 == (e = +e) || e != e ? e : e < 0 ? -1 : 1
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				clz32: function(e) {
					return (e >>>= 0) ? 31 - Math.floor(Math.log(e + .5) * Math.LOG2E) : 32
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = Math.exp;
			i(i.S, "Math", {
				cosh: function(e) {
					return (a(e = +e) + a(-e)) / 2
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(112);
			i(i.S + i.F * (a != Math.expm1), "Math", {
				expm1: a
			})
		},
		function(e, t) {
			var n = Math.expm1;
			e.exports = !n || n(10) > 22025.465794806718 || n(10) < 22025.465794806718 || -2e-17 != n(-2e-17) ? function(e) {
				return 0 == (e = +e) ? e : e > -1e-6 && e < 1e-6 ? e + e * e / 2 : Math.exp(e) - 1
			} : n
		},
		function(e, t, n) {
			var i = n(8),
				a = n(108),
				o = Math.pow,
				r = o(2, -52),
				s = o(2, -23),
				l = o(2, 127) * (2 - s),
				c = o(2, -126),
				d = function(e) {
					return e + 1 / r - 1 / r
				};
			i(i.S, "Math", {
				fround: function(e) {
					var t, n, i = Math.abs(e),
						o = a(e);
					return i < c ? o * d(i / c / s) * c * s : (t = (1 + s / r) * i, n = t - (t - i), n > l || n != n ? o * (1 / 0) : o * n)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = Math.abs;
			i(i.S, "Math", {
				hypot: function(e, t) {
					for (var n, i, o = 0, r = 0, s = arguments.length, l = 0; r < s;) n = a(arguments[r++]), l < n ? (i = l / n, o = o * i * i + 1, l = n) : n > 0 ? (i = n / l, o += i * i) : o += n;
					return l === 1 / 0 ? 1 / 0 : l * Math.sqrt(o)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = Math.imul;
			i(i.S + i.F * n(7)(function() {
				return -5 != a(4294967295, 5) || 2 != a.length
			}), "Math", {
				imul: function(e, t) {
					var n = +e,
						i = +t,
						a = 65535 & n,
						o = 65535 & i;
					return 0 | a * o + ((65535 & n >>> 16) * o + a * (65535 & i >>> 16) << 16 >>> 0)
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				log10: function(e) {
					return Math.log(e) / Math.LN10
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				log1p: n(104)
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				log2: function(e) {
					return Math.log(e) / Math.LN2
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				sign: n(108)
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(112),
				o = Math.exp;
			i(i.S + i.F * n(7)(function() {
				return -2e-17 != !Math.sinh(-2e-17)
			}), "Math", {
				sinh: function(e) {
					return Math.abs(e = +e) < 1 ? (a(e) - a(-e)) / 2 : (o(e - 1) - o(-e - 1)) * (Math.E / 2)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(112),
				o = Math.exp;
			i(i.S, "Math", {
				tanh: function(e) {
					var t = a(e = +e),
						n = a(-e);
					return t == 1 / 0 ? 1 : n == 1 / 0 ? -1 : (t - n) / (o(e) + o(-e))
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				trunc: function(e) {
					return (e > 0 ? Math.floor : Math.ceil)(e)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(39),
				o = String.fromCharCode,
				r = String.fromCodePoint;
			i(i.S + i.F * (!!r && 1 != r.length), "String", {
				fromCodePoint: function(e) {
					for (var t, n = [], i = arguments.length, r = 0; i > r;) {
						if (t = +arguments[r++], a(t, 1114111) !== t) throw RangeError(t + " is not a valid code point");
						n.push(t < 65536 ? o(t) : o(55296 + ((t -= 65536) >> 10), t % 1024 + 56320))
					}
					return n.join("")
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(32),
				o = n(37);
			i(i.S, "String", {
				raw: function(e) {
					for (var t = a(e.raw), n = o(t.length), i = arguments.length, r = [], s = 0; n > s;) r.push(String(t[s++])), s < i && r.push(String(arguments[s]));
					return r.join("")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(83)("trim", function(e) {
				return function() {
					return e(this, 3)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(127)(!0);
			n(128)(String, "String", function(e) {
				this._t = String(e), this._i = 0
			}, function() {
				var e, t = this._t,
					n = this._i;
				return n >= t.length ? {
					value: void 0,
					done: !0
				} : (e = i(t, n), this._i += e.length, {
					value: e,
					done: !1
				})
			})
		},
		function(e, t, n) {
			var i = n(38),
				a = n(35);
			e.exports = function(e) {
				return function(t, n) {
					var o, r, s = String(a(t)),
						l = i(n),
						c = s.length;
					return l < 0 || l >= c ? e ? "" : void 0 : (o = s.charCodeAt(l), o < 55296 || o > 56319 || l + 1 === c || (r = s.charCodeAt(l + 1)) < 56320 || r > 57343 ? e ? s.charAt(l) : o : e ? s.slice(l, l + 2) : r - 56320 + (o - 55296 << 10) + 65536)
				}
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(28),
				a = n(8),
				o = n(18),
				r = n(10),
				s = n(5),
				l = n(129),
				c = n(130),
				d = n(24),
				u = n(59),
				p = n(25)("iterator"),
				f = !([].keys && "next" in [].keys()),
				h = function() {
					return this
				};
			e.exports = function(e, t, n, g, m, v, y) {
				c(n, t, g);
				var b, _, w, x = function(e) {
						if (!f && e in C) return C[e];
						switch (e) {
							case "keys":
							case "values":
								return function() {
									return new n(this, e)
								}
						}
						return function() {
							return new n(this, e)
						}
					},
					$ = t + " Iterator",
					k = "values" == m,
					T = !1,
					C = e.prototype,
					D = C[p] || C["@@iterator"] || m && C[m],
					S = D || x(m),
					P = m ? k ? x("entries") : S : void 0,
					I = "Array" == t ? C.entries || D : D;
				if (I && (w = u(I.call(new e))) !== Object.prototype && (d(w, $, !0), i || s(w, p) || r(w, p, h)), k && D && "values" !== D.name && (T = !0, S = function() {
					return D.call(this)
				}), i && !y || !f && !T && C[p] || r(C, p, S), l[t] = S, l[$] = h, m)
					if (b = {
						values: k ? S : x("values"),
						keys: v ? S : x("keys"),
						entries: P
					}, y)
						for (_ in b) _ in C || o(C, _, b[_]);
					else a(a.P + a.F * (f || T), t, b);
				return b
			}
		},
		function(e, t) {
			e.exports = {}
		},
		function(e, t, n) {
			"use strict";
			var i = n(46),
				a = n(17),
				o = n(24),
				r = {};
			n(10)(r, n(25)("iterator"), function() {
				return this
			}), e.exports = function(e, t, n) {
				e.prototype = i(r, {
					next: a(1, n)
				}), o(e, t + " Iterator")
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(127)(!1);
			i(i.P, "String", {
				codePointAt: function(e) {
					return a(this, e)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(37),
				o = n(133),
				r = "".endsWith;
			i(i.P + i.F * n(135)("endsWith"), "String", {
				endsWith: function(e) {
					var t = o(this, e, "endsWith"),
						n = arguments.length > 1 ? arguments[1] : void 0,
						i = a(t.length),
						s = void 0 === n ? i : Math.min(a(n), i),
						l = String(e);
					return r ? r.call(t, l, s) : t.slice(s - l.length, s) === l
				}
			})
		},
		function(e, t, n) {
			var i = n(134),
				a = n(35);
			e.exports = function(e, t, n) {
				if (i(t)) throw TypeError("String#" + n + " doesn't accept regex!");
				return String(a(e))
			}
		},
		function(e, t, n) {
			var i = n(13),
				a = n(34),
				o = n(25)("match");
			e.exports = function(e) {
				var t;
				return i(e) && (void 0 !== (t = e[o]) ? !!t : "RegExp" == a(e))
			}
		},
		function(e, t, n) {
			var i = n(25)("match");
			e.exports = function(e) {
				var t = /./;
				try {
					"/./" [e](t)
				} catch (n) {
					try {
						return t[i] = !1, !"/./" [e](t)
					} catch (e) {}
				}
				return !0
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(133);
			i(i.P + i.F * n(135)("includes"), "String", {
				includes: function(e) {
					return !!~a(this, e, "includes").indexOf(e, arguments.length > 1 ? arguments[1] : void 0)
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.P, "String", {
				repeat: n(91)
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(37),
				o = n(133),
				r = "".startsWith;
			i(i.P + i.F * n(135)("startsWith"), "String", {
				startsWith: function(e) {
					var t = o(this, e, "startsWith"),
						n = a(Math.min(arguments.length > 1 ? arguments[1] : void 0, t.length)),
						i = String(e);
					return r ? r.call(t, i, n) : t.slice(n, n + i.length) === i
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("anchor", function(e) {
				return function(t) {
					return e(this, "a", "name", t)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(7),
				o = n(35),
				r = /"/g,
				s = function(e, t, n, i) {
					var a = String(o(e)),
						s = "<" + t;
					return "" !== n && (s += " " + n + '="' + String(i).replace(r, "&quot;") + '"'), s + ">" + a + "</" + t + ">"
				};
			e.exports = function(e, t) {
				var n = {};
				n[e] = t(s), i(i.P + i.F * a(function() {
					var t = "" [e]('"');
					return t !== t.toLowerCase() || t.split('"').length > 3
				}), "String", n)
			}
		},
		function(e, t, n) {
			"use strict";
			n(140)("big", function(e) {
				return function() {
					return e(this, "big", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("blink", function(e) {
				return function() {
					return e(this, "blink", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("bold", function(e) {
				return function() {
					return e(this, "b", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("fixed", function(e) {
				return function() {
					return e(this, "tt", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("fontcolor", function(e) {
				return function(t) {
					return e(this, "font", "color", t)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("fontsize", function(e) {
				return function(t) {
					return e(this, "font", "size", t)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("italics", function(e) {
				return function() {
					return e(this, "i", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("link", function(e) {
				return function(t) {
					return e(this, "a", "href", t)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("small", function(e) {
				return function() {
					return e(this, "small", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("strike", function(e) {
				return function() {
					return e(this, "strike", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("sub", function(e) {
				return function() {
					return e(this, "sub", "", "")
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(140)("sup", function(e) {
				return function() {
					return e(this, "sup", "", "")
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Date", {
				now: function() {
					return (new Date).getTime()
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(58),
				o = n(16);
			i(i.P + i.F * n(7)(function() {
				return null !== new Date(NaN).toJSON() || 1 !== Date.prototype.toJSON.call({
					toISOString: function() {
						return 1
					}
				})
			}), "Date", {
				toJSON: function(e) {
					var t = a(this),
						n = o(t);
					return "number" != typeof n || isFinite(n) ? t.toISOString() : null
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(7),
				o = Date.prototype.getTime,
				r = function(e) {
					return e > 9 ? e : "0" + e
				};
			i(i.P + i.F * (a(function() {
				return "0385-07-25T07:06:39.999Z" != new Date(-5e13 - 1).toISOString()
			}) || !a(function() {
				new Date(NaN).toISOString()
			})), "Date", {
				toISOString: function() {
					if (!isFinite(o.call(this))) throw RangeError("Invalid time value");
					var e = this,
						t = e.getUTCFullYear(),
						n = e.getUTCMilliseconds(),
						i = t < 0 ? "-" : t > 9999 ? "+" : "";
					return i + ("00000" + Math.abs(t)).slice(i ? -6 : -4) + "-" + r(e.getUTCMonth() + 1) + "-" + r(e.getUTCDate()) + "T" + r(e.getUTCHours()) + ":" + r(e.getUTCMinutes()) + ":" + r(e.getUTCSeconds()) + "." + (n > 99 ? n : "0" + r(n)) + "Z"
				}
			})
		},
		function(e, t, n) {
			var i = Date.prototype,
				a = i.toString,
				o = i.getTime;
			new Date(NaN) + "" != "Invalid Date" && n(18)(i, "toString", function() {
				var e = o.call(this);
				return e === e ? a.call(this) : "Invalid Date"
			})
		},
		function(e, t, n) {
			var i = n(25)("toPrimitive"),
				a = Date.prototype;
			i in a || n(10)(a, i, n(158))
		},
		function(e, t, n) {
			"use strict";
			var i = n(12),
				a = n(16);
			e.exports = function(e) {
				if ("string" !== e && "number" !== e && "default" !== e) throw TypeError("Incorrect hint");
				return a(i(this), "number" != e)
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Array", {
				isArray: n(45)
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(20),
				a = n(8),
				o = n(58),
				r = n(161),
				s = n(162),
				l = n(37),
				c = n(163),
				d = n(164);
			a(a.S + a.F * !n(165)(function(e) {
				Array.from(e)
			}), "Array", {
				from: function(e) {
					var t, n, a, u, p = o(e),
						f = "function" == typeof this ? this : Array,
						h = arguments.length,
						g = h > 1 ? arguments[1] : void 0,
						m = void 0 !== g,
						v = 0,
						y = d(p);
					if (m && (g = i(g, h > 2 ? arguments[2] : void 0, 2)), void 0 == y || f == Array && s(y))
						for (t = l(p.length), n = new f(t); t > v; v++) c(n, v, m ? g(p[v], v) : p[v]);
					else
						for (u = y.call(p), n = new f; !(a = u.next()).done; v++) c(n, v, m ? r(u, g, [a.value, v], !0) : a.value);
					return n.length = v, n
				}
			})
		},
		function(e, t, n) {
			var i = n(12);
			e.exports = function(e, t, n, a) {
				try {
					return a ? t(i(n)[0], n[1]) : t(n)
				} catch (t) {
					var o = e.return;
					throw void 0 !== o && i(o.call(e)), t
				}
			}
		},
		function(e, t, n) {
			var i = n(129),
				a = n(25)("iterator"),
				o = Array.prototype;
			e.exports = function(e) {
				return void 0 !== e && (i.Array === e || o[a] === e)
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(11),
				a = n(17);
			e.exports = function(e, t, n) {
				t in e ? i.f(e, t, a(0, n)) : e[t] = n
			}
		},
		function(e, t, n) {
			var i = n(75),
				a = n(25)("iterator"),
				o = n(129);
			e.exports = n(9).getIteratorMethod = function(e) {
				if (void 0 != e) return e[a] || e["@@iterator"] || o[i(e)]
			}
		},
		function(e, t, n) {
			var i = n(25)("iterator"),
				a = !1;
			try {
				var o = [7][i]();
				o.return = function() {
					a = !0
				}, Array.from(o, function() {
					throw 2
				})
			} catch (e) {}
			e.exports = function(e, t) {
				if (!t && !a) return !1;
				var n = !1;
				try {
					var o = [7],
						r = o[i]();
					r.next = function() {
						return {
							done: n = !0
						}
					}, o[i] = function() {
						return r
					}, e(o)
				} catch (e) {}
				return n
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(163);
			i(i.S + i.F * n(7)(function() {
				function e() {}
				return !(Array.of.call(e) instanceof e)
			}), "Array", {
				of: function() {
					for (var e = 0, t = arguments.length, n = new("function" == typeof this ? this : Array)(t); t > e;) a(n, e, arguments[e++]);
					return n.length = t, n
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(32),
				o = [].join;
			i(i.P + i.F * (n(33) != Object || !n(168)(o)), "Array", {
				join: function(e) {
					return o.call(a(this), void 0 === e ? "," : e)
				}
			})
		},
		function(e, t, n) {
			var i = n(7);
			e.exports = function(e, t) {
				return !!e && i(function() {
					t ? e.call(null, function() {}, 1) : e.call(null)
				})
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(48),
				o = n(34),
				r = n(39),
				s = n(37),
				l = [].slice;
			i(i.P + i.F * n(7)(function() {
				a && l.call(a)
			}), "Array", {
				slice: function(e, t) {
					var n = s(this.length),
						i = o(this);
					if (t = void 0 === t ? n : t, "Array" == i) return l.call(this, e, t);
					for (var a = r(e, n), c = r(t, n), d = s(c - a), u = Array(d), p = 0; p < d; p++) u[p] = "String" == i ? this.charAt(a + p) : this[a + p];
					return u
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(21),
				o = n(58),
				r = n(7),
				s = [].sort,
				l = [1, 2, 3];
			i(i.P + i.F * (r(function() {
				l.sort(void 0)
			}) || !r(function() {
				l.sort(null)
			}) || !n(168)(s)), "Array", {
				sort: function(e) {
					return void 0 === e ? s.call(o(this)) : s.call(o(this), a(e))
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(172)(0),
				o = n(168)([].forEach, !0);
			i(i.P + i.F * !o, "Array", {
				forEach: function(e) {
					return a(this, e, arguments[1])
				}
			})
		},
		function(e, t, n) {
			var i = n(20),
				a = n(33),
				o = n(58),
				r = n(37),
				s = n(173);
			e.exports = function(e, t) {
				var n = 1 == e,
					l = 2 == e,
					c = 3 == e,
					d = 4 == e,
					u = 6 == e,
					p = 5 == e || u,
					f = t || s;
				return function(t, s, h) {
					for (var g, m, v = o(t), y = a(v), b = i(s, h, 3), _ = r(y.length), w = 0, x = n ? f(t, _) : l ? f(t, 0) : void 0; _ > w; w++)
						if ((p || w in y) && (g = y[w], m = b(g, w, v), e))
							if (n) x[w] = m;
							else if (m) switch (e) {
						case 3:
							return !0;
						case 5:
							return g;
						case 6:
							return w;
						case 2:
							x.push(g)
					} else if (d) return !1;
					return u ? -1 : c || d ? d : x
				}
			}
		},
		function(e, t, n) {
			var i = n(174);
			e.exports = function(e, t) {
				return new(i(e))(t)
			}
		},
		function(e, t, n) {
			var i = n(13),
				a = n(45),
				o = n(25)("species");
			e.exports = function(e) {
				var t;
				return a(e) && (t = e.constructor, "function" != typeof t || t !== Array && !a(t.prototype) || (t = void 0), i(t) && null === (t = t[o]) && (t = void 0)), void 0 === t ? Array : t
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(172)(1);
			i(i.P + i.F * !n(168)([].map, !0), "Array", {
				map: function(e) {
					return a(this, e, arguments[1])
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(172)(2);
			i(i.P + i.F * !n(168)([].filter, !0), "Array", {
				filter: function(e) {
					return a(this, e, arguments[1])
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(172)(3);
			i(i.P + i.F * !n(168)([].some, !0), "Array", {
				some: function(e) {
					return a(this, e, arguments[1])
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(172)(4);
			i(i.P + i.F * !n(168)([].every, !0), "Array", {
				every: function(e) {
					return a(this, e, arguments[1])
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(180);
			i(i.P + i.F * !n(168)([].reduce, !0), "Array", {
				reduce: function(e) {
					return a(this, e, arguments.length, arguments[1], !1)
				}
			})
		},
		function(e, t, n) {
			var i = n(21),
				a = n(58),
				o = n(33),
				r = n(37);
			e.exports = function(e, t, n, s, l) {
				i(t);
				var c = a(e),
					d = o(c),
					u = r(c.length),
					p = l ? u - 1 : 0,
					f = l ? -1 : 1;
				if (n < 2)
					for (;;) {
						if (p in d) {
							s = d[p], p += f;
							break
						}
						if (p += f, l ? p < 0 : u <= p) throw TypeError("Reduce of empty array with no initial value")
					}
				for (; l ? p >= 0 : u > p; p += f) p in d && (s = t(s, d[p], p, c));
				return s
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(180);
			i(i.P + i.F * !n(168)([].reduceRight, !0), "Array", {
				reduceRight: function(e) {
					return a(this, e, arguments.length, arguments[1], !0)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(36)(!1),
				o = [].indexOf,
				r = !!o && 1 / [1].indexOf(1, -0) < 0;
			i(i.P + i.F * (r || !n(168)(o)), "Array", {
				indexOf: function(e) {
					return r ? o.apply(this, arguments) || 0 : a(this, e, arguments[1])
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(32),
				o = n(38),
				r = n(37),
				s = [].lastIndexOf,
				l = !!s && 1 / [1].lastIndexOf(1, -0) < 0;
			i(i.P + i.F * (l || !n(168)(s)), "Array", {
				lastIndexOf: function(e) {
					if (l) return s.apply(this, arguments) || 0;
					var t = a(this),
						n = r(t.length),
						i = n - 1;
					for (arguments.length > 1 && (i = Math.min(i, o(arguments[1]))), i < 0 && (i = n + i); i >= 0; i--)
						if (i in t && t[i] === e) return i || 0;
					return -1
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.P, "Array", {
				copyWithin: n(185)
			}), n(186)("copyWithin")
		},
		function(e, t, n) {
			"use strict";
			var i = n(58),
				a = n(39),
				o = n(37);
			e.exports = [].copyWithin || function(e, t) {
				var n = i(this),
					r = o(n.length),
					s = a(e, r),
					l = a(t, r),
					c = arguments.length > 2 ? arguments[2] : void 0,
					d = Math.min((void 0 === c ? r : a(c, r)) - l, r - s),
					u = 1;
				for (l < s && s < l + d && (u = -1, l += d - 1, s += d - 1); d-- > 0;) l in n ? n[s] = n[l] : delete n[s], s += u, l += u;
				return n
			}
		},
		function(e, t, n) {
			var i = n(25)("unscopables"),
				a = Array.prototype;
			void 0 == a[i] && n(10)(a, i, {}), e.exports = function(e) {
				a[i][e] = !0
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.P, "Array", {
				fill: n(188)
			}), n(186)("fill")
		},
		function(e, t, n) {
			"use strict";
			var i = n(58),
				a = n(39),
				o = n(37);
			e.exports = function(e) {
				for (var t = i(this), n = o(t.length), r = arguments.length, s = a(r > 1 ? arguments[1] : void 0, n), l = r > 2 ? arguments[2] : void 0, c = void 0 === l ? n : a(l, n); c > s;) t[s++] = e;
				return t
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(172)(5),
				o = !0;
			"find" in [] && Array(1).find(function() {
				o = !1
			}), i(i.P + i.F * o, "Array", {
				find: function(e) {
					return a(this, e, arguments.length > 1 ? arguments[1] : void 0)
				}
			}), n(186)("find")
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(172)(6),
				o = "findIndex",
				r = !0;
			o in [] && Array(1)[o](function() {
				r = !1
			}), i(i.P + i.F * r, "Array", {
				findIndex: function(e) {
					return a(this, e, arguments.length > 1 ? arguments[1] : void 0)
				}
			}), n(186)(o)
		},
		function(e, t, n) {
			n(192)("Array")
		},
		function(e, t, n) {
			"use strict";
			var i = n(4),
				a = n(11),
				o = n(6),
				r = n(25)("species");
			e.exports = function(e) {
				var t = i[e];
				o && t && !t[r] && a.f(t, r, {
					configurable: !0,
					get: function() {
						return this
					}
				})
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(186),
				a = n(194),
				o = n(129),
				r = n(32);
			e.exports = n(128)(Array, "Array", function(e, t) {
				this._t = r(e), this._i = 0, this._k = t
			}, function() {
				var e = this._t,
					t = this._k,
					n = this._i++;
				return !e || n >= e.length ? (this._t = void 0, a(1)) : "keys" == t ? a(0, n) : "values" == t ? a(0, e[n]) : a(0, [n, e[n]])
			}, "values"), o.Arguments = o.Array, i("keys"), i("values"), i("entries")
		},
		function(e, t) {
			e.exports = function(e, t) {
				return {
					value: t,
					done: !!e
				}
			}
		},
		function(e, t, n) {
			var i = n(4),
				a = n(88),
				o = n(11).f,
				r = n(50).f,
				s = n(134),
				l = n(196),
				c = i.RegExp,
				d = c,
				u = c.prototype,
				p = /a/g,
				f = /a/g,
				h = new c(p) !== p;
			if (n(6) && (!h || n(7)(function() {
				return f[n(25)("match")] = !1, c(p) != p || c(f) == f || "/a/i" != c(p, "i")
			}))) {
				c = function(e, t) {
					var n = this instanceof c,
						i = s(e),
						o = void 0 === t;
					return !n && i && e.constructor === c && o ? e : a(h ? new d(i && !o ? e.source : e, t) : d((i = e instanceof c) ? e.source : e, i && o ? l.call(e) : t), n ? this : u, c)
				};
				for (var g = r(d), m = 0; g.length > m;) ! function(e) {
					e in c || o(c, e, {
						configurable: !0,
						get: function() {
							return d[e]
						},
						set: function(t) {
							d[e] = t
						}
					})
				}(g[m++]);
				u.constructor = c, c.prototype = u, n(18)(i, "RegExp", c)
			}
			n(192)("RegExp")
		},
		function(e, t, n) {
			"use strict";
			var i = n(12);
			e.exports = function() {
				var e = i(this),
					t = "";
				return e.global && (t += "g"), e.ignoreCase && (t += "i"), e.multiline && (t += "m"), e.unicode && (t += "u"), e.sticky && (t += "y"), t
			}
		},
		function(e, t, n) {
			"use strict";
			n(198);
			var i = n(12),
				a = n(196),
				o = n(6),
				r = /./.toString,
				s = function(e) {
					n(18)(RegExp.prototype, "toString", e, !0)
				};
			n(7)(function() {
				return "/a/b" != r.call({
					source: "a",
					flags: "b"
				})
			}) ? s(function() {
				var e = i(this);
				return "/".concat(e.source, "/", "flags" in e ? e.flags : !o && e instanceof RegExp ? a.call(e) : void 0)
			}) : "toString" != r.name && s(function() {
				return r.call(this)
			})
		},
		function(e, t, n) {
			n(6) && "g" != /./g.flags && n(11).f(RegExp.prototype, "flags", {
				configurable: !0,
				get: n(196)
			})
		},
		function(e, t, n) {
			n(200)("match", 1, function(e, t, n) {
				return [
					function(n) {
						"use strict";
						var i = e(this),
							a = void 0 == n ? void 0 : n[t];
						return void 0 !== a ? a.call(n, i) : new RegExp(n)[t](String(i))
					},
					n
				]
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(10),
				a = n(18),
				o = n(7),
				r = n(35),
				s = n(25);
			e.exports = function(e, t, n) {
				var l = s(e),
					c = n(r, l, "" [e]),
					d = c[0],
					u = c[1];
				o(function() {
					var t = {};
					return t[l] = function() {
						return 7
					}, 7 != "" [e](t)
				}) && (a(String.prototype, e, d), i(RegExp.prototype, l, 2 == t ? function(e, t) {
					return u.call(e, this, t)
				} : function(e) {
					return u.call(e, this)
				}))
			}
		},
		function(e, t, n) {
			n(200)("replace", 2, function(e, t, n) {
				return [
					function(i, a) {
						"use strict";
						var o = e(this),
							r = void 0 == i ? void 0 : i[t];
						return void 0 !== r ? r.call(i, o, a) : n.call(String(o), i, a)
					},
					n
				]
			})
		},
		function(e, t, n) {
			n(200)("search", 1, function(e, t, n) {
				return [
					function(n) {
						"use strict";
						var i = e(this),
							a = void 0 == n ? void 0 : n[t];
						return void 0 !== a ? a.call(n, i) : new RegExp(n)[t](String(i))
					},
					n
				]
			})
		},
		function(e, t, n) {
			n(200)("split", 2, function(e, t, i) {
				"use strict";
				var a = n(134),
					o = i,
					r = [].push,
					s = "length";
				if ("c" == "abbc".split(/(b)*/)[1] || 4 != "test".split(/(?:)/, -1)[s] || 2 != "ab".split(/(?:ab)*/)[s] || 4 != ".".split(/(.?)(.?)/)[s] || ".".split(/()()/)[s] > 1 || "".split(/.?/)[s]) {
					var l = void 0 === /()??/.exec("")[1];
					i = function(e, t) {
						var n = String(this);
						if (void 0 === e && 0 === t) return [];
						if (!a(e)) return o.call(n, e, t);
						var i, c, d, u, p, f = [],
							h = (e.ignoreCase ? "i" : "") + (e.multiline ? "m" : "") + (e.unicode ? "u" : "") + (e.sticky ? "y" : ""),
							g = 0,
							m = void 0 === t ? 4294967295 : t >>> 0,
							v = new RegExp(e.source, h + "g");
						for (l || (i = new RegExp("^" + v.source + "$(?!\\s)", h));
							(c = v.exec(n)) && !((d = c.index + c[0][s]) > g && (f.push(n.slice(g, c.index)), !l && c[s] > 1 && c[0].replace(i, function() {
								for (p = 1; p < arguments[s] - 2; p++) void 0 === arguments[p] && (c[p] = void 0)
							}), c[s] > 1 && c.index < n[s] && r.apply(f, c.slice(1)), u = c[0][s], g = d, f[s] >= m));) v.lastIndex === c.index && v.lastIndex++;
						return g === n[s] ? !u && v.test("") || f.push("") : f.push(n.slice(g)), f[s] > m ? f.slice(0, m) : f
					}
				} else "0".split(void 0, 0)[s] && (i = function(e, t) {
					return void 0 === e && 0 === t ? [] : o.call(this, e, t)
				});
				return [
					function(n, a) {
						var o = e(this),
							r = void 0 == n ? void 0 : n[t];
						return void 0 !== r ? r.call(n, o, a) : i.call(String(o), n, a)
					},
					i
				]
			})
		},
		function(e, t, n) {
			"use strict";
			var i, a, o, r = n(28),
				s = n(4),
				l = n(20),
				c = n(75),
				d = n(8),
				u = n(13),
				p = n(21),
				f = n(205),
				h = n(206),
				g = n(207),
				m = n(208).set,
				v = n(209)(),
				y = s.TypeError,
				b = s.process,
				_ = s.Promise,
				b = s.process,
				w = "process" == c(b),
				x = function() {},
				$ = !! function() {
					try {
						var e = _.resolve(1),
							t = (e.constructor = {})[n(25)("species")] = function(e) {
								e(x, x)
							};
						return (w || "function" == typeof PromiseRejectionEvent) && e.then(x) instanceof t
					} catch (e) {}
				}(),
				k = function(e, t) {
					return e === t || e === _ && t === o
				},
				T = function(e) {
					var t;
					return !(!u(e) || "function" != typeof(t = e.then)) && t
				},
				C = function(e) {
					return k(_, e) ? new D(e) : new a(e)
				},
				D = a = function(e) {
					var t, n;
					this.promise = new e(function(e, i) {
						if (void 0 !== t || void 0 !== n) throw y("Bad Promise constructor");
						t = e, n = i
					}), this.resolve = p(t), this.reject = p(n)
				},
				S = function(e) {
					try {
						e()
					} catch (e) {
						return {
							error: e
						}
					}
				},
				P = function(e, t) {
					if (!e._n) {
						e._n = !0;
						var n = e._c;
						v(function() {
							for (var i = e._v, a = 1 == e._s, o = 0; n.length > o;) ! function(t) {
								var n, o, r = a ? t.ok : t.fail,
									s = t.resolve,
									l = t.reject,
									c = t.domain;
								try {
									r ? (a || (2 == e._h && L(e), e._h = 1), !0 === r ? n = i : (c && c.enter(), n = r(i), c && c.exit()), n === t.promise ? l(y("Promise-chain cycle")) : (o = T(n)) ? o.call(n, s, l) : s(n)) : l(i)
								} catch (e) {
									l(e)
								}
							}(n[o++]);
							e._c = [], e._n = !1, t && !e._h && I(e)
						})
					}
				},
				I = function(e) {
					m.call(s, function() {
						var t, n, i, a = e._v;
						if (E(e) && (t = S(function() {
							w ? b.emit("unhandledRejection", a, e) : (n = s.onunhandledrejection) ? n({
								promise: e,
								reason: a
							}) : (i = s.console) && i.error && i.error("Unhandled promise rejection", a)
						}), e._h = w || E(e) ? 2 : 1), e._a = void 0, t) throw t.error
					})
				},
				E = function(e) {
					if (1 == e._h) return !1;
					for (var t, n = e._a || e._c, i = 0; n.length > i;)
						if (t = n[i++], t.fail || !E(t.promise)) return !1;
					return !0
				},
				L = function(e) {
					m.call(s, function() {
						var t;
						w ? b.emit("rejectionHandled", e) : (t = s.onrejectionhandled) && t({
							promise: e,
							reason: e._v
						})
					})
				},
				M = function(e) {
					var t = this;
					t._d || (t._d = !0, t = t._w || t, t._v = e, t._s = 2, t._a || (t._a = t._c.slice()), P(t, !0))
				},
				A = function(e) {
					var t, n = this;
					if (!n._d) {
						n._d = !0, n = n._w || n;
						try {
							if (n === e) throw y("Promise can't be resolved itself");
							(t = T(e)) ? v(function() {
								var i = {
									_w: n,
									_d: !1
								};
								try {
									t.call(e, l(A, i, 1), l(M, i, 1))
								} catch (e) {
									M.call(i, e)
								}
							}): (n._v = e, n._s = 1, P(n, !1))
						} catch (e) {
							M.call({
								_w: n,
								_d: !1
							}, e)
						}
					}
				};
			$ || (_ = function(e) {
				f(this, _, "Promise", "_h"), p(e), i.call(this);
				try {
					e(l(A, this, 1), l(M, this, 1))
				} catch (e) {
					M.call(this, e)
				}
			}, i = function(e) {
				this._c = [], this._a = void 0, this._s = 0, this._d = !1, this._v = void 0, this._h = 0, this._n = !1
			}, i.prototype = n(210)(_.prototype, {
				then: function(e, t) {
					var n = C(g(this, _));
					return n.ok = "function" != typeof e || e, n.fail = "function" == typeof t && t, n.domain = w ? b.domain : void 0, this._c.push(n), this._a && this._a.push(n), this._s && P(this, !1), n.promise
				},
				catch: function(e) {
					return this.then(void 0, e)
				}
			}), D = function() {
				var e = new i;
				this.promise = e, this.resolve = l(A, e, 1), this.reject = l(M, e, 1)
			}), d(d.G + d.W + d.F * !$, {
				Promise: _
			}), n(24)(_, "Promise"), n(192)("Promise"), o = n(9).Promise, d(d.S + d.F * !$, "Promise", {
				reject: function(e) {
					var t = C(this);
					return (0, t.reject)(e), t.promise
				}
			}), d(d.S + d.F * (r || !$), "Promise", {
				resolve: function(e) {
					if (e instanceof _ && k(e.constructor, this)) return e;
					var t = C(this);
					return (0, t.resolve)(e), t.promise
				}
			}), d(d.S + d.F * !($ && n(165)(function(e) {
				_.all(e).catch(x)
			})), "Promise", {
				all: function(e) {
					var t = this,
						n = C(t),
						i = n.resolve,
						a = n.reject,
						o = S(function() {
							var n = [],
								o = 0,
								r = 1;
							h(e, !1, function(e) {
								var s = o++,
									l = !1;
								n.push(void 0), r++, t.resolve(e).then(function(e) {
									l || (l = !0, n[s] = e, --r || i(n))
								}, a)
							}), --r || i(n)
						});
					return o && a(o.error), n.promise
				},
				race: function(e) {
					var t = this,
						n = C(t),
						i = n.reject,
						a = S(function() {
							h(e, !1, function(e) {
								t.resolve(e).then(n.resolve, i)
							})
						});
					return a && i(a.error), n.promise
				}
			})
		},
		function(e, t) {
			e.exports = function(e, t, n, i) {
				if (!(e instanceof t) || void 0 !== i && i in e) throw TypeError(n + ": incorrect invocation!");
				return e
			}
		},
		function(e, t, n) {
			var i = n(20),
				a = n(161),
				o = n(162),
				r = n(12),
				s = n(37),
				l = n(164),
				c = {},
				d = {},
				t = e.exports = function(e, t, n, u, p) {
					var f, h, g, m, v = p ? function() {
							return e
						} : l(e),
						y = i(n, u, t ? 2 : 1),
						b = 0;
					if ("function" != typeof v) throw TypeError(e + " is not iterable!");
					if (o(v)) {
						for (f = s(e.length); f > b; b++)
							if ((m = t ? y(r(h = e[b])[0], h[1]) : y(e[b])) === c || m === d) return m
					} else
						for (g = v.call(e); !(h = g.next()).done;)
							if ((m = a(g, y, h.value, t)) === c || m === d) return m
				};
			t.BREAK = c, t.RETURN = d
		},
		function(e, t, n) {
			var i = n(12),
				a = n(21),
				o = n(25)("species");
			e.exports = function(e, t) {
				var n, r = i(e).constructor;
				return void 0 === r || void 0 == (n = i(r)[o]) ? t : a(n)
			}
		},
		function(e, t, n) {
			var i, a, o, r = n(20),
				s = n(78),
				l = n(48),
				c = n(15),
				d = n(4),
				u = d.process,
				p = d.setImmediate,
				f = d.clearImmediate,
				h = d.MessageChannel,
				g = 0,
				m = {},
				v = function() {
					var e = +this;
					if (m.hasOwnProperty(e)) {
						var t = m[e];
						delete m[e], t()
					}
				},
				y = function(e) {
					v.call(e.data)
				};
			p && f || (p = function(e) {
				for (var t = [], n = 1; arguments.length > n;) t.push(arguments[n++]);
				return m[++g] = function() {
					s("function" == typeof e ? e : Function(e), t)
				}, i(g), g
			}, f = function(e) {
				delete m[e]
			}, "process" == n(34)(u) ? i = function(e) {
				u.nextTick(r(v, e, 1))
			} : h ? (a = new h, o = a.port2, a.port1.onmessage = y, i = r(o.postMessage, o, 1)) : d.addEventListener && "function" == typeof postMessage && !d.importScripts ? (i = function(e) {
				d.postMessage(e + "", "*")
			}, d.addEventListener("message", y, !1)) : i = "onreadystatechange" in c("script") ? function(e) {
				l.appendChild(c("script")).onreadystatechange = function() {
					l.removeChild(this), v.call(e)
				}
			} : function(e) {
				setTimeout(r(v, e, 1), 0)
			}), e.exports = {
				set: p,
				clear: f
			}
		},
		function(e, t, n) {
			var i = n(4),
				a = n(208).set,
				o = i.MutationObserver || i.WebKitMutationObserver,
				r = i.process,
				s = i.Promise,
				l = "process" == n(34)(r);
			e.exports = function() {
				var e, t, n, c = function() {
					var i, a;
					for (l && (i = r.domain) && i.exit(); e;) {
						a = e.fn, e = e.next;
						try {
							a()
						} catch (i) {
							throw e ? n() : t = void 0, i
						}
					}
					t = void 0, i && i.enter()
				};
				if (l) n = function() {
					r.nextTick(c)
				};
				else if (o) {
					var d = !0,
						u = document.createTextNode("");
					new o(c).observe(u, {
						characterData: !0
					}), n = function() {
						u.data = d = !d
					}
				} else if (s && s.resolve) {
					var p = s.resolve();
					n = function() {
						p.then(c)
					}
				} else n = function() {
					a.call(i, c)
				};
				return function(i) {
					var a = {
						fn: i,
						next: void 0
					};
					t && (t.next = a), e || (e = a, n()), t = a
				}
			}
		},
		function(e, t, n) {
			var i = n(18);
			e.exports = function(e, t, n) {
				for (var a in t) i(e, a, t[a], n);
				return e
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(212);
			e.exports = n(213)("Map", function(e) {
				return function() {
					return e(this, arguments.length > 0 ? arguments[0] : void 0)
				}
			}, {
				get: function(e) {
					var t = i.getEntry(this, e);
					return t && t.v
				},
				set: function(e, t) {
					return i.def(this, 0 === e ? 0 : e, t)
				}
			}, i, !0)
		},
		function(e, t, n) {
			"use strict";
			var i = n(11).f,
				a = n(46),
				o = n(210),
				r = n(20),
				s = n(205),
				l = n(35),
				c = n(206),
				d = n(128),
				u = n(194),
				p = n(192),
				f = n(6),
				h = n(22).fastKey,
				g = f ? "_s" : "size",
				m = function(e, t) {
					var n, i = h(t);
					if ("F" !== i) return e._i[i];
					for (n = e._f; n; n = n.n)
						if (n.k == t) return n
				};
			e.exports = {
				getConstructor: function(e, t, n, d) {
					var u = e(function(e, i) {
						s(e, u, t, "_i"), e._i = a(null), e._f = void 0, e._l = void 0, e[g] = 0, void 0 != i && c(i, n, e[d], e)
					});
					return o(u.prototype, {
						clear: function() {
							for (var e = this, t = e._i, n = e._f; n; n = n.n) n.r = !0, n.p && (n.p = n.p.n = void 0), delete t[n.i];
							e._f = e._l = void 0, e[g] = 0
						},
						delete: function(e) {
							var t = this,
								n = m(t, e);
							if (n) {
								var i = n.n,
									a = n.p;
								delete t._i[n.i], n.r = !0, a && (a.n = i), i && (i.p = a), t._f == n && (t._f = i), t._l == n && (t._l = a), t[g] --
							}
							return !!n
						},
						forEach: function(e) {
							s(this, u, "forEach");
							for (var t, n = r(e, arguments.length > 1 ? arguments[1] : void 0, 3); t = t ? t.n : this._f;)
								for (n(t.v, t.k, this); t && t.r;) t = t.p
						},
						has: function(e) {
							return !!m(this, e)
						}
					}), f && i(u.prototype, "size", {
						get: function() {
							return l(this[g])
						}
					}), u
				},
				def: function(e, t, n) {
					var i, a, o = m(e, t);
					return o ? o.v = n : (e._l = o = {
						i: a = h(t, !0),
						k: t,
						v: n,
						p: i = e._l,
						n: void 0,
						r: !1
					}, e._f || (e._f = o), i && (i.n = o), e[g] ++, "F" !== a && (e._i[a] = o)), e
				},
				getEntry: m,
				setStrong: function(e, t, n) {
					d(e, t, function(e, t) {
						this._t = e, this._k = t, this._l = void 0
					}, function() {
						for (var e = this, t = e._k, n = e._l; n && n.r;) n = n.p;
						return e._t && (e._l = n = n ? n.n : e._t._f) ? "keys" == t ? u(0, n.k) : "values" == t ? u(0, n.v) : u(0, [n.k, n.v]) : (e._t = void 0, u(1))
					}, n ? "entries" : "values", !n, !0), p(t)
				}
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(4),
				a = n(8),
				o = n(18),
				r = n(210),
				s = n(22),
				l = n(206),
				c = n(205),
				d = n(13),
				u = n(7),
				p = n(165),
				f = n(24),
				h = n(88);
			e.exports = function(e, t, n, g, m, v) {
				var y = i[e],
					b = y,
					_ = m ? "set" : "add",
					w = b && b.prototype,
					x = {},
					$ = function(e) {
						var t = w[e];
						o(w, e, "delete" == e ? function(e) {
							return !(v && !d(e)) && t.call(this, 0 === e ? 0 : e)
						} : "has" == e ? function(e) {
							return !(v && !d(e)) && t.call(this, 0 === e ? 0 : e)
						} : "get" == e ? function(e) {
							return v && !d(e) ? void 0 : t.call(this, 0 === e ? 0 : e)
						} : "add" == e ? function(e) {
							return t.call(this, 0 === e ? 0 : e), this
						} : function(e, n) {
							return t.call(this, 0 === e ? 0 : e, n), this
						})
					};
				if ("function" == typeof b && (v || w.forEach && !u(function() {
					(new b).entries().next()
				}))) {
					var k = new b,
						T = k[_](v ? {} : -0, 1) != k,
						C = u(function() {
							k.has(1)
						}),
						D = p(function(e) {
							new b(e)
						}),
						S = !v && u(function() {
							for (var e = new b, t = 5; t--;) e[_](t, t);
							return !e.has(-0)
						});
					D || (b = t(function(t, n) {
						c(t, b, e);
						var i = h(new y, t, b);
						return void 0 != n && l(n, m, i[_], i), i
					}), b.prototype = w, w.constructor = b), (C || S) && ($("delete"), $("has"), m && $("get")), (S || T) && $(_), v && w.clear && delete w.clear
				} else b = g.getConstructor(t, e, m, _), r(b.prototype, n), s.NEED = !0;
				return f(b, e), x[e] = b, a(a.G + a.W + a.F * (b != y), x), v || g.setStrong(b, e, m), b
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(212);
			e.exports = n(213)("Set", function(e) {
				return function() {
					return e(this, arguments.length > 0 ? arguments[0] : void 0)
				}
			}, {
				add: function(e) {
					return i.def(this, e = 0 === e ? 0 : e, e)
				}
			}, i)
		},
		function(e, t, n) {
			"use strict";
			var i, a = n(172)(0),
				o = n(18),
				r = n(22),
				s = n(69),
				l = n(216),
				c = n(13),
				d = r.getWeak,
				u = Object.isExtensible,
				p = l.ufstore,
				f = {},
				h = function(e) {
					return function() {
						return e(this, arguments.length > 0 ? arguments[0] : void 0)
					}
				},
				g = {
					get: function(e) {
						if (c(e)) {
							var t = d(e);
							return !0 === t ? p(this).get(e) : t ? t[this._i] : void 0
						}
					},
					set: function(e, t) {
						return l.def(this, e, t)
					}
				},
				m = e.exports = n(213)("WeakMap", h, g, l, !0, !0);
			7 != (new m).set((Object.freeze || Object)(f), 7).get(f) && (i = l.getConstructor(h), s(i.prototype, g), r.NEED = !0, a(["delete", "has", "get", "set"], function(e) {
				var t = m.prototype,
					n = t[e];
				o(t, e, function(t, a) {
					if (c(t) && !u(t)) {
						this._f || (this._f = new i);
						var o = this._f[e](t, a);
						return "set" == e ? this : o
					}
					return n.call(this, t, a)
				})
			}))
		},
		function(e, t, n) {
			"use strict";
			var i = n(210),
				a = n(22).getWeak,
				o = n(12),
				r = n(13),
				s = n(205),
				l = n(206),
				c = n(172),
				d = n(5),
				u = c(5),
				p = c(6),
				f = 0,
				h = function(e) {
					return e._l || (e._l = new g)
				},
				g = function() {
					this.a = []
				},
				m = function(e, t) {
					return u(e.a, function(e) {
						return e[0] === t
					})
				};
			g.prototype = {
				get: function(e) {
					var t = m(this, e);
					if (t) return t[1]
				},
				has: function(e) {
					return !!m(this, e)
				},
				set: function(e, t) {
					var n = m(this, e);
					n ? n[1] = t : this.a.push([e, t])
				},
				delete: function(e) {
					var t = p(this.a, function(t) {
						return t[0] === e
					});
					return ~t && this.a.splice(t, 1), !!~t
				}
			}, e.exports = {
				getConstructor: function(e, t, n, o) {
					var c = e(function(e, i) {
						s(e, c, t, "_i"), e._i = f++, e._l = void 0, void 0 != i && l(i, n, e[o], e)
					});
					return i(c.prototype, {
						delete: function(e) {
							if (!r(e)) return !1;
							var t = a(e);
							return !0 === t ? h(this).delete(e) : t && d(t, this._i) && delete t[this._i]
						},
						has: function(e) {
							if (!r(e)) return !1;
							var t = a(e);
							return !0 === t ? h(this).has(e) : t && d(t, this._i)
						}
					}), c
				},
				def: function(e, t, n) {
					var i = a(o(t), !0);
					return !0 === i ? h(e).set(t, n) : i[e._i] = n, e
				},
				ufstore: h
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(216);
			n(213)("WeakSet", function(e) {
				return function() {
					return e(this, arguments.length > 0 ? arguments[0] : void 0)
				}
			}, {
				add: function(e) {
					return i.def(this, e, !0)
				}
			}, i, !1, !0)
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(219),
				o = n(220),
				r = n(12),
				s = n(39),
				l = n(37),
				c = n(13),
				d = n(4).ArrayBuffer,
				u = n(207),
				p = o.ArrayBuffer,
				f = o.DataView,
				h = a.ABV && d.isView,
				g = p.prototype.slice,
				m = a.VIEW;
			i(i.G + i.W + i.F * (d !== p), {
				ArrayBuffer: p
			}), i(i.S + i.F * !a.CONSTR, "ArrayBuffer", {
				isView: function(e) {
					return h && h(e) || c(e) && m in e
				}
			}), i(i.P + i.U + i.F * n(7)(function() {
				return !new p(2).slice(1, void 0).byteLength
			}), "ArrayBuffer", {
				slice: function(e, t) {
					if (void 0 !== g && void 0 === t) return g.call(r(this), e);
					for (var n = r(this).byteLength, i = s(e, n), a = s(void 0 === t ? n : t, n), o = new(u(this, p))(l(a - i)), c = new f(this), d = new f(o), h = 0; i < a;) d.setUint8(h++, c.getUint8(i++));
					return o
				}
			}), n(192)("ArrayBuffer")
		},
		function(e, t, n) {
			for (var i, a = n(4), o = n(10), r = n(19), s = r("typed_array"), l = r("view"), c = !(!a.ArrayBuffer || !a.DataView), d = c, u = 0, p = "Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(","); u < 9;)(i = a[p[u++]]) ? (o(i.prototype, s, !0), o(i.prototype, l, !0)) : d = !1;
			e.exports = {
				ABV: c,
				CONSTR: d,
				TYPED: s,
				VIEW: l
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(4),
				a = n(6),
				o = n(28),
				r = n(219),
				s = n(10),
				l = n(210),
				c = n(7),
				d = n(205),
				u = n(38),
				p = n(37),
				f = n(50).f,
				h = n(11).f,
				g = n(188),
				m = n(24),
				v = i.ArrayBuffer,
				y = i.DataView,
				b = i.Math,
				_ = i.RangeError,
				w = i.Infinity,
				x = v,
				$ = b.abs,
				k = b.pow,
				T = b.floor,
				C = b.log,
				D = b.LN2,
				S = a ? "_b" : "buffer",
				P = a ? "_l" : "byteLength",
				I = a ? "_o" : "byteOffset",
				E = function(e, t, n) {
					var i, a, o, r = Array(n),
						s = 8 * n - t - 1,
						l = (1 << s) - 1,
						c = l >> 1,
						d = 23 === t ? k(2, -24) - k(2, -77) : 0,
						u = 0,
						p = e < 0 || 0 === e && 1 / e < 0 ? 1 : 0;
					for (e = $(e), e != e || e === w ? (a = e != e ? 1 : 0, i = l) : (i = T(C(e) / D), e * (o = k(2, -i)) < 1 && (i--, o *= 2), e += i + c >= 1 ? d / o : d * k(2, 1 - c), e * o >= 2 && (i++, o /= 2), i + c >= l ? (a = 0, i = l) : i + c >= 1 ? (a = (e * o - 1) * k(2, t), i += c) : (a = e * k(2, c - 1) * k(2, t), i = 0)); t >= 8; r[u++] = 255 & a, a /= 256, t -= 8);
					for (i = i << t | a, s += t; s > 0; r[u++] = 255 & i, i /= 256, s -= 8);
					return r[--u] |= 128 * p, r
				},
				L = function(e, t, n) {
					var i, a = 8 * n - t - 1,
						o = (1 << a) - 1,
						r = o >> 1,
						s = a - 7,
						l = n - 1,
						c = e[l--],
						d = 127 & c;
					for (c >>= 7; s > 0; d = 256 * d + e[l], l--, s -= 8);
					for (i = d & (1 << -s) - 1, d >>= -s, s += t; s > 0; i = 256 * i + e[l], l--, s -= 8);
					if (0 === d) d = 1 - r;
					else {
						if (d === o) return i ? NaN : c ? -w : w;
						i += k(2, t), d -= r
					}
					return (c ? -1 : 1) * i * k(2, d - t)
				},
				M = function(e) {
					return e[3] << 24 | e[2] << 16 | e[1] << 8 | e[0]
				},
				A = function(e) {
					return [255 & e]
				},
				O = function(e) {
					return [255 & e, e >> 8 & 255]
				},
				j = function(e) {
					return [255 & e, e >> 8 & 255, e >> 16 & 255, e >> 24 & 255]
				},
				F = function(e) {
					return E(e, 52, 8)
				},
				q = function(e) {
					return E(e, 23, 4)
				},
				N = function(e, t, n) {
					h(e.prototype, t, {
						get: function() {
							return this[n]
						}
					})
				},
				R = function(e, t, n, i) {
					var a = +n,
						o = u(a);
					if (a != o || o < 0 || o + t > e[P]) throw _("Wrong index!");
					var r = e[S]._b,
						s = o + e[I],
						l = r.slice(s, s + t);
					return i ? l : l.reverse()
				},
				B = function(e, t, n, i, a, o) {
					var r = +n,
						s = u(r);
					if (r != s || s < 0 || s + t > e[P]) throw _("Wrong index!");
					for (var l = e[S]._b, c = s + e[I], d = i(+a), p = 0; p < t; p++) l[c + p] = d[o ? p : t - p - 1]
				},
				U = function(e, t) {
					d(e, v, "ArrayBuffer");
					var n = +t,
						i = p(n);
					if (n != i) throw _("Wrong length!");
					return i
				};
			if (r.ABV) {
				if (!c(function() {
					new v
				}) || !c(function() {
					new v(.5)
				})) {
					v = function(e) {
						return new x(U(this, e))
					};
					for (var H, z = v.prototype = x.prototype, V = f(x), W = 0; V.length > W;)(H = V[W++]) in v || s(v, H, x[H]);
					o || (z.constructor = v)
				}
				var Y = new y(new v(2)),
					G = y.prototype.setInt8;
				Y.setInt8(0, 2147483648), Y.setInt8(1, 2147483649), !Y.getInt8(0) && Y.getInt8(1) || l(y.prototype, {
					setInt8: function(e, t) {
						G.call(this, e, t << 24 >> 24)
					},
					setUint8: function(e, t) {
						G.call(this, e, t << 24 >> 24)
					}
				}, !0)
			} else v = function(e) {
				var t = U(this, e);
				this._b = g.call(Array(t), 0), this[P] = t
			}, y = function(e, t, n) {
				d(this, y, "DataView"), d(e, v, "DataView");
				var i = e[P],
					a = u(t);
				if (a < 0 || a > i) throw _("Wrong offset!");
				if (n = void 0 === n ? i - a : p(n), a + n > i) throw _("Wrong length!");
				this[S] = e, this[I] = a, this[P] = n
			}, a && (N(v, "byteLength", "_l"), N(y, "buffer", "_b"), N(y, "byteLength", "_l"), N(y, "byteOffset", "_o")), l(y.prototype, {
				getInt8: function(e) {
					return R(this, 1, e)[0] << 24 >> 24
				},
				getUint8: function(e) {
					return R(this, 1, e)[0]
				},
				getInt16: function(e) {
					var t = R(this, 2, e, arguments[1]);
					return (t[1] << 8 | t[0]) << 16 >> 16
				},
				getUint16: function(e) {
					var t = R(this, 2, e, arguments[1]);
					return t[1] << 8 | t[0]
				},
				getInt32: function(e) {
					return M(R(this, 4, e, arguments[1]))
				},
				getUint32: function(e) {
					return M(R(this, 4, e, arguments[1])) >>> 0
				},
				getFloat32: function(e) {
					return L(R(this, 4, e, arguments[1]), 23, 4)
				},
				getFloat64: function(e) {
					return L(R(this, 8, e, arguments[1]), 52, 8)
				},
				setInt8: function(e, t) {
					B(this, 1, e, A, t)
				},
				setUint8: function(e, t) {
					B(this, 1, e, A, t)
				},
				setInt16: function(e, t) {
					B(this, 2, e, O, t, arguments[2])
				},
				setUint16: function(e, t) {
					B(this, 2, e, O, t, arguments[2])
				},
				setInt32: function(e, t) {
					B(this, 4, e, j, t, arguments[2])
				},
				setUint32: function(e, t) {
					B(this, 4, e, j, t, arguments[2])
				},
				setFloat32: function(e, t) {
					B(this, 4, e, q, t, arguments[2])
				},
				setFloat64: function(e, t) {
					B(this, 8, e, F, t, arguments[2])
				}
			});
			m(v, "ArrayBuffer"), m(y, "DataView"), s(y.prototype, r.VIEW, !0), t.ArrayBuffer = v, t.DataView = y
		},
		function(e, t, n) {
			var i = n(8);
			i(i.G + i.W + i.F * !n(219).ABV, {
				DataView: n(220).DataView
			})
		},
		function(e, t, n) {
			n(223)("Int8", 1, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			if (n(6)) {
				var i = n(28),
					a = n(4),
					o = n(7),
					r = n(8),
					s = n(219),
					l = n(220),
					c = n(20),
					d = n(205),
					u = n(17),
					p = n(10),
					f = n(210),
					h = n(38),
					g = n(37),
					m = n(39),
					v = n(16),
					y = n(5),
					b = n(71),
					_ = n(75),
					w = n(13),
					x = n(58),
					$ = n(162),
					k = n(46),
					T = n(59),
					C = n(50).f,
					D = n(164),
					S = n(19),
					P = n(25),
					I = n(172),
					E = n(36),
					L = n(207),
					M = n(193),
					A = n(129),
					O = n(165),
					j = n(192),
					F = n(188),
					q = n(185),
					N = n(11),
					R = n(51),
					B = N.f,
					U = R.f,
					H = a.RangeError,
					z = a.TypeError,
					V = a.Uint8Array,
					W = Array.prototype,
					Y = l.ArrayBuffer,
					G = l.DataView,
					K = I(0),
					Q = I(2),
					X = I(3),
					Z = I(4),
					J = I(5),
					ee = I(6),
					te = E(!0),
					ne = E(!1),
					ie = M.values,
					ae = M.keys,
					oe = M.entries,
					re = W.lastIndexOf,
					se = W.reduce,
					le = W.reduceRight,
					ce = W.join,
					de = W.sort,
					ue = W.slice,
					pe = W.toString,
					fe = W.toLocaleString,
					he = P("iterator"),
					ge = P("toStringTag"),
					me = S("typed_constructor"),
					ve = S("def_constructor"),
					ye = s.CONSTR,
					be = s.TYPED,
					_e = s.VIEW,
					we = I(1, function(e, t) {
						return De(L(e, e[ve]), t)
					}),
					xe = o(function() {
						return 1 === new V(new Uint16Array([1]).buffer)[0]
					}),
					$e = !!V && !!V.prototype.set && o(function() {
						new V(1).set({})
					}),
					ke = function(e, t) {
						if (void 0 === e) throw z("Wrong length!");
						var n = +e,
							i = g(e);
						if (t && !b(n, i)) throw H("Wrong length!");
						return i
					},
					Te = function(e, t) {
						var n = h(e);
						if (n < 0 || n % t) throw H("Wrong offset!");
						return n
					},
					Ce = function(e) {
						if (w(e) && be in e) return e;
						throw z(e + " is not a typed array!")
					},
					De = function(e, t) {
						if (!(w(e) && me in e)) throw z("It is not a typed array constructor!");
						return new e(t)
					},
					Se = function(e, t) {
						return Pe(L(e, e[ve]), t)
					},
					Pe = function(e, t) {
						for (var n = 0, i = t.length, a = De(e, i); i > n;) a[n] = t[n++];
						return a
					},
					Ie = function(e, t, n) {
						B(e, t, {
							get: function() {
								return this._d[n]
							}
						})
					},
					Ee = function(e) {
						var t, n, i, a, o, r, s = x(e),
							l = arguments.length,
							d = l > 1 ? arguments[1] : void 0,
							u = void 0 !== d,
							p = D(s);
						if (void 0 != p && !$(p)) {
							for (r = p.call(s), i = [], t = 0; !(o = r.next()).done; t++) i.push(o.value);
							s = i
						}
						for (u && l > 2 && (d = c(d, arguments[2], 2)), t = 0, n = g(s.length), a = De(this, n); n > t; t++) a[t] = u ? d(s[t], t) : s[t];
						return a
					},
					Le = function() {
						for (var e = 0, t = arguments.length, n = De(this, t); t > e;) n[e] = arguments[e++];
						return n
					},
					Me = !!V && o(function() {
						fe.call(new V(1))
					}),
					Ae = function() {
						return fe.apply(Me ? ue.call(Ce(this)) : Ce(this), arguments)
					},
					Oe = {
						copyWithin: function(e, t) {
							return q.call(Ce(this), e, t, arguments.length > 2 ? arguments[2] : void 0)
						},
						every: function(e) {
							return Z(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						fill: function(e) {
							return F.apply(Ce(this), arguments)
						},
						filter: function(e) {
							return Se(this, Q(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0))
						},
						find: function(e) {
							return J(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						findIndex: function(e) {
							return ee(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						forEach: function(e) {
							K(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						indexOf: function(e) {
							return ne(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						includes: function(e) {
							return te(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						join: function(e) {
							return ce.apply(Ce(this), arguments)
						},
						lastIndexOf: function(e) {
							return re.apply(Ce(this), arguments)
						},
						map: function(e) {
							return we(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						reduce: function(e) {
							return se.apply(Ce(this), arguments)
						},
						reduceRight: function(e) {
							return le.apply(Ce(this), arguments)
						},
						reverse: function() {
							for (var e, t = this, n = Ce(t).length, i = Math.floor(n / 2), a = 0; a < i;) e = t[a], t[a++] = t[--n], t[n] = e;
							return t
						},
						some: function(e) {
							return X(Ce(this), e, arguments.length > 1 ? arguments[1] : void 0)
						},
						sort: function(e) {
							return de.call(Ce(this), e)
						},
						subarray: function(e, t) {
							var n = Ce(this),
								i = n.length,
								a = m(e, i);
							return new(L(n, n[ve]))(n.buffer, n.byteOffset + a * n.BYTES_PER_ELEMENT, g((void 0 === t ? i : m(t, i)) - a))
						}
					},
					je = function(e, t) {
						return Se(this, ue.call(Ce(this), e, t))
					},
					Fe = function(e) {
						Ce(this);
						var t = Te(arguments[1], 1),
							n = this.length,
							i = x(e),
							a = g(i.length),
							o = 0;
						if (a + t > n) throw H("Wrong length!");
						for (; o < a;) this[t + o] = i[o++]
					},
					qe = {
						entries: function() {
							return oe.call(Ce(this))
						},
						keys: function() {
							return ae.call(Ce(this))
						},
						values: function() {
							return ie.call(Ce(this))
						}
					},
					Ne = function(e, t) {
						return w(e) && e[be] && "symbol" != typeof t && t in e && String(+t) == String(t)
					},
					Re = function(e, t) {
						return Ne(e, t = v(t, !0)) ? u(2, e[t]) : U(e, t)
					},
					Be = function(e, t, n) {
						return !(Ne(e, t = v(t, !0)) && w(n) && y(n, "value")) || y(n, "get") || y(n, "set") || n.configurable || y(n, "writable") && !n.writable || y(n, "enumerable") && !n.enumerable ? B(e, t, n) : (e[t] = n.value, e)
					};
				ye || (R.f = Re, N.f = Be), r(r.S + r.F * !ye, "Object", {
					getOwnPropertyDescriptor: Re,
					defineProperty: Be
				}), o(function() {
					pe.call({})
				}) && (pe = fe = function() {
					return ce.call(this)
				});
				var Ue = f({}, Oe);
				f(Ue, qe), p(Ue, he, qe.values), f(Ue, {
					slice: je,
					set: Fe,
					constructor: function() {},
					toString: pe,
					toLocaleString: Ae
				}), Ie(Ue, "buffer", "b"), Ie(Ue, "byteOffset", "o"), Ie(Ue, "byteLength", "l"), Ie(Ue, "length", "e"), B(Ue, ge, {
					get: function() {
						return this[be]
					}
				}), e.exports = function(e, t, n, l) {
					l = !!l;
					var c = e + (l ? "Clamped" : "") + "Array",
						u = "Uint8Array" != c,
						f = "get" + e,
						h = "set" + e,
						m = a[c],
						v = m || {},
						y = m && T(m),
						b = !m || !s.ABV,
						x = {},
						$ = m && m.prototype,
						D = function(e, n) {
							var i = e._d;
							return i.v[f](n * t + i.o, xe)
						},
						S = function(e, n, i) {
							var a = e._d;
							l && (i = (i = Math.round(i)) < 0 ? 0 : i > 255 ? 255 : 255 & i), a.v[h](n * t + a.o, i, xe)
						},
						P = function(e, t) {
							B(e, t, {
								get: function() {
									return D(this, t)
								},
								set: function(e) {
									return S(this, t, e)
								},
								enumerable: !0
							})
						};
					b ? (m = n(function(e, n, i, a) {
						d(e, m, c, "_d");
						var o, r, s, l, u = 0,
							f = 0;
						if (w(n)) {
							if (!(n instanceof Y || "ArrayBuffer" == (l = _(n)) || "SharedArrayBuffer" == l)) return be in n ? Pe(m, n) : Ee.call(m, n);
							o = n, f = Te(i, t);
							var h = n.byteLength;
							if (void 0 === a) {
								if (h % t) throw H("Wrong length!");
								if ((r = h - f) < 0) throw H("Wrong length!")
							} else if ((r = g(a) * t) + f > h) throw H("Wrong length!");
							s = r / t
						} else s = ke(n, !0), r = s * t, o = new Y(r);
						for (p(e, "_d", {
							b: o,
							o: f,
							l: r,
							e: s,
							v: new G(o)
						}); u < s;) P(e, u++)
					}), $ = m.prototype = k(Ue), p($, "constructor", m)) : O(function(e) {
						new m(null), new m(e)
					}, !0) || (m = n(function(e, n, i, a) {
						d(e, m, c);
						var o;
						return w(n) ? n instanceof Y || "ArrayBuffer" == (o = _(n)) || "SharedArrayBuffer" == o ? void 0 !== a ? new v(n, Te(i, t), a) : void 0 !== i ? new v(n, Te(i, t)) : new v(n) : be in n ? Pe(m, n) : Ee.call(m, n) : new v(ke(n, u))
					}), K(y !== Function.prototype ? C(v).concat(C(y)) : C(v), function(e) {
						e in m || p(m, e, v[e])
					}), m.prototype = $, i || ($.constructor = m));
					var I = $[he],
						E = !!I && ("values" == I.name || void 0 == I.name),
						L = qe.values;
					p(m, me, !0), p($, be, c), p($, _e, !0), p($, ve, m), (l ? new m(1)[ge] == c : ge in $) || B($, ge, {
						get: function() {
							return c
						}
					}), x[c] = m, r(r.G + r.W + r.F * (m != v), x), r(r.S, c, {
						BYTES_PER_ELEMENT: t,
						from: Ee,
						of: Le
					}), "BYTES_PER_ELEMENT" in $ || p($, "BYTES_PER_ELEMENT", t), r(r.P, c, Oe), j(c), r(r.P + r.F * $e, c, {
						set: Fe
					}), r(r.P + r.F * !E, c, qe), r(r.P + r.F * ($.toString != pe), c, {
						toString: pe
					}), r(r.P + r.F * o(function() {
						new m(1).slice()
					}), c, {
						slice: je
					}), r(r.P + r.F * (o(function() {
						return [1, 2].toLocaleString() != new m([1, 2]).toLocaleString()
					}) || !o(function() {
						$.toLocaleString.call([1, 2])
					})), c, {
						toLocaleString: Ae
					}), A[c] = E ? I : L, i || E || p($, he, L)
				}
			} else e.exports = function() {}
		},
		function(e, t, n) {
			n(223)("Uint8", 1, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			n(223)("Uint8", 1, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			}, !0)
		},
		function(e, t, n) {
			n(223)("Int16", 2, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			n(223)("Uint16", 2, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			n(223)("Int32", 4, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			n(223)("Uint32", 4, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			n(223)("Float32", 4, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			n(223)("Float64", 8, function(e) {
				return function(t, n, i) {
					return e(this, t, n, i)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(21),
				o = n(12),
				r = (n(4).Reflect || {}).apply,
				s = Function.apply;
			i(i.S + i.F * !n(7)(function() {
				r(function() {})
			}), "Reflect", {
				apply: function(e, t, n) {
					var i = a(e),
						l = o(n);
					return r ? r(i, t, l) : s.call(i, t, l)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(46),
				o = n(21),
				r = n(12),
				s = n(13),
				l = n(7),
				c = n(77),
				d = (n(4).Reflect || {}).construct,
				u = l(function() {
					function e() {}
					return !(d(function() {}, [], e) instanceof e)
				}),
				p = !l(function() {
					d(function() {})
				});
			i(i.S + i.F * (u || p), "Reflect", {
				construct: function(e, t) {
					o(e), r(t);
					var n = arguments.length < 3 ? e : o(arguments[2]);
					if (p && !u) return d(e, t, n);
					if (e == n) {
						switch (t.length) {
							case 0:
								return new e;
							case 1:
								return new e(t[0]);
							case 2:
								return new e(t[0], t[1]);
							case 3:
								return new e(t[0], t[1], t[2]);
							case 4:
								return new e(t[0], t[1], t[2], t[3])
						}
						var i = [null];
						return i.push.apply(i, t), new(c.apply(e, i))
					}
					var l = n.prototype,
						f = a(s(l) ? l : Object.prototype),
						h = Function.apply.call(e, f, t);
					return s(h) ? h : f
				}
			})
		},
		function(e, t, n) {
			var i = n(11),
				a = n(8),
				o = n(12),
				r = n(16);
			a(a.S + a.F * n(7)(function() {
				Reflect.defineProperty(i.f({}, 1, {
					value: 1
				}), 1, {
					value: 2
				})
			}), "Reflect", {
				defineProperty: function(e, t, n) {
					o(e), t = r(t, !0), o(n);
					try {
						return i.f(e, t, n), !0
					} catch (e) {
						return !1
					}
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(51).f,
				o = n(12);
			i(i.S, "Reflect", {
				deleteProperty: function(e, t) {
					var n = a(o(e), t);
					return !(n && !n.configurable) && delete e[t]
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(12),
				o = function(e) {
					this._t = a(e), this._i = 0;
					var t, n = this._k = [];
					for (t in e) n.push(t)
				};
			n(130)(o, "Object", function() {
				var e, t = this,
					n = t._k;
				do {
					if (t._i >= n.length) return {
						value: void 0,
						done: !0
					}
				} while (!((e = n[t._i++]) in t._t));
				return {
					value: e,
					done: !1
				}
			}), i(i.S, "Reflect", {
				enumerate: function(e) {
					return new o(e)
				}
			})
		},
		function(e, t, n) {
			function i(e, t) {
				var n, s, d = arguments.length < 3 ? e : arguments[2];
				return c(e) === d ? e[t] : (n = a.f(e, t)) ? r(n, "value") ? n.value : void 0 !== n.get ? n.get.call(d) : void 0 : l(s = o(e)) ? i(s, t, d) : void 0
			}
			var a = n(51),
				o = n(59),
				r = n(5),
				s = n(8),
				l = n(13),
				c = n(12);
			s(s.S, "Reflect", {
				get: i
			})
		},
		function(e, t, n) {
			var i = n(51),
				a = n(8),
				o = n(12);
			a(a.S, "Reflect", {
				getOwnPropertyDescriptor: function(e, t) {
					return i.f(o(e), t)
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(59),
				o = n(12);
			i(i.S, "Reflect", {
				getPrototypeOf: function(e) {
					return a(o(e))
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Reflect", {
				has: function(e, t) {
					return t in e
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(12),
				o = Object.isExtensible;
			i(i.S, "Reflect", {
				isExtensible: function(e) {
					return a(e), !o || o(e)
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Reflect", {
				ownKeys: n(243)
			})
		},
		function(e, t, n) {
			var i = n(50),
				a = n(43),
				o = n(12),
				r = n(4).Reflect;
			e.exports = r && r.ownKeys || function(e) {
				var t = i.f(o(e)),
					n = a.f;
				return n ? t.concat(n(e)) : t
			}
		},
		function(e, t, n) {
			var i = n(8),
				a = n(12),
				o = Object.preventExtensions;
			i(i.S, "Reflect", {
				preventExtensions: function(e) {
					a(e);
					try {
						return o && o(e), !0
					} catch (e) {
						return !1
					}
				}
			})
		},
		function(e, t, n) {
			function i(e, t, n) {
				var l, p, f = arguments.length < 4 ? e : arguments[3],
					h = o.f(d(e), t);
				if (!h) {
					if (u(p = r(e))) return i(p, t, n, f);
					h = c(0)
				}
				return s(h, "value") ? !(!1 === h.writable || !u(f)) && (l = o.f(f, t) || c(0), l.value = n, a.f(f, t, l), !0) : void 0 !== h.set && (h.set.call(f, n), !0)
			}
			var a = n(11),
				o = n(51),
				r = n(59),
				s = n(5),
				l = n(8),
				c = n(17),
				d = n(12),
				u = n(13);
			l(l.S, "Reflect", {
				set: i
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(73);
			a && i(i.S, "Reflect", {
				setPrototypeOf: function(e, t) {
					a.check(e, t);
					try {
						return a.set(e, t), !0
					} catch (e) {
						return !1
					}
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(36)(!0);
			i(i.P, "Array", {
				includes: function(e) {
					return a(this, e, arguments.length > 1 ? arguments[1] : void 0)
				}
			}), n(186)("includes")
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(127)(!0);
			i(i.P, "String", {
				at: function(e) {
					return a(this, e)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(250);
			i(i.P, "String", {
				padStart: function(e) {
					return a(this, e, arguments.length > 1 ? arguments[1] : void 0, !0)
				}
			})
		},
		function(e, t, n) {
			var i = n(37),
				a = n(91),
				o = n(35);
			e.exports = function(e, t, n, r) {
				var s = String(o(e)),
					l = s.length,
					c = void 0 === n ? " " : String(n),
					d = i(t);
				if (d <= l || "" == c) return s;
				var u = d - l,
					p = a.call(c, Math.ceil(u / c.length));
				return p.length > u && (p = p.slice(0, u)), r ? p + s : s + p
			}
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(250);
			i(i.P, "String", {
				padEnd: function(e) {
					return a(this, e, arguments.length > 1 ? arguments[1] : void 0, !1)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			n(83)("trimLeft", function(e) {
				return function() {
					return e(this, 1)
				}
			}, "trimStart")
		},
		function(e, t, n) {
			"use strict";
			n(83)("trimRight", function(e) {
				return function() {
					return e(this, 2)
				}
			}, "trimEnd")
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(35),
				o = n(37),
				r = n(134),
				s = n(196),
				l = RegExp.prototype,
				c = function(e, t) {
					this._r = e, this._s = t
				};
			n(130)(c, "RegExp String", function() {
				var e = this._r.exec(this._s);
				return {
					value: e,
					done: null === e
				}
			}), i(i.P, "String", {
				matchAll: function(e) {
					if (a(this), !r(e)) throw TypeError(e + " is not a regexp!");
					var t = String(this),
						n = "flags" in l ? String(e.flags) : s.call(e),
						i = new RegExp(e.source, ~n.indexOf("g") ? n : "g" + n);
					return i.lastIndex = o(e.lastIndex), new c(i, t)
				}
			})
		},
		function(e, t, n) {
			n(27)("asyncIterator")
		},
		function(e, t, n) {
			n(27)("observable")
		},
		function(e, t, n) {
			var i = n(8),
				a = n(243),
				o = n(32),
				r = n(51),
				s = n(163);
			i(i.S, "Object", {
				getOwnPropertyDescriptors: function(e) {
					for (var t, n = o(e), i = r.f, l = a(n), c = {}, d = 0; l.length > d;) s(c, t = l[d++], i(n, t));
					return c
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(259)(!1);
			i(i.S, "Object", {
				values: function(e) {
					return a(e)
				}
			})
		},
		function(e, t, n) {
			var i = n(30),
				a = n(32),
				o = n(44).f;
			e.exports = function(e) {
				return function(t) {
					for (var n, r = a(t), s = i(r), l = s.length, c = 0, d = []; l > c;) o.call(r, n = s[c++]) && d.push(e ? [n, r[n]] : r[n]);
					return d
				}
			}
		},
		function(e, t, n) {
			var i = n(8),
				a = n(259)(!0);
			i(i.S, "Object", {
				entries: function(e) {
					return a(e)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(58),
				o = n(21),
				r = n(11);
			n(6) && i(i.P + n(262), "Object", {
				__defineGetter__: function(e, t) {
					r.f(a(this), e, {
						get: o(t),
						enumerable: !0,
						configurable: !0
					})
				}
			})
		},
		function(e, t, n) {
			e.exports = n(28) || !n(7)(function() {
				var e = Math.random();
				__defineSetter__.call(null, e, function() {}), delete n(4)[e]
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(58),
				o = n(21),
				r = n(11);
			n(6) && i(i.P + n(262), "Object", {
				__defineSetter__: function(e, t) {
					r.f(a(this), e, {
						set: o(t),
						enumerable: !0,
						configurable: !0
					})
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(58),
				o = n(16),
				r = n(59),
				s = n(51).f;
			n(6) && i(i.P + n(262), "Object", {
				__lookupGetter__: function(e) {
					var t, n = a(this),
						i = o(e, !0);
					do {
						if (t = s(n, i)) return t.get
					} while (n = r(n))
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(58),
				o = n(16),
				r = n(59),
				s = n(51).f;
			n(6) && i(i.P + n(262), "Object", {
				__lookupSetter__: function(e) {
					var t, n = a(this),
						i = o(e, !0);
					do {
						if (t = s(n, i)) return t.set
					} while (n = r(n))
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.P + i.R, "Map", {
				toJSON: n(267)("Map")
			})
		},
		function(e, t, n) {
			var i = n(75),
				a = n(268);
			e.exports = function(e) {
				return function() {
					if (i(this) != e) throw TypeError(e + "#toJSON isn't generic");
					return a(this)
				}
			}
		},
		function(e, t, n) {
			var i = n(206);
			e.exports = function(e, t) {
				var n = [];
				return i(e, !1, n.push, n, t), n
			}
		},
		function(e, t, n) {
			var i = n(8);
			i(i.P + i.R, "Set", {
				toJSON: n(267)("Set")
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "System", {
				global: n(4)
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(34);
			i(i.S, "Error", {
				isError: function(e) {
					return "Error" === a(e)
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				iaddh: function(e, t, n, i) {
					var a = e >>> 0,
						o = t >>> 0,
						r = n >>> 0;
					return o + (i >>> 0) + ((a & r | (a | r) & ~(a + r >>> 0)) >>> 31) | 0
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				isubh: function(e, t, n, i) {
					var a = e >>> 0,
						o = t >>> 0,
						r = n >>> 0;
					return o - (i >>> 0) - ((~a & r | ~(a ^ r) & a - r >>> 0) >>> 31) | 0
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				imulh: function(e, t) {
					var n = +e,
						i = +t,
						a = 65535 & n,
						o = 65535 & i,
						r = n >> 16,
						s = i >> 16,
						l = (r * o >>> 0) + (a * o >>> 16);
					return r * s + (l >> 16) + ((a * s >>> 0) + (65535 & l) >> 16)
				}
			})
		},
		function(e, t, n) {
			var i = n(8);
			i(i.S, "Math", {
				umulh: function(e, t) {
					var n = +e,
						i = +t,
						a = 65535 & n,
						o = 65535 & i,
						r = n >>> 16,
						s = i >>> 16,
						l = (r * o >>> 0) + (a * o >>> 16);
					return r * s + (l >>> 16) + ((a * s >>> 0) + (65535 & l) >>> 16)
				}
			})
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = i.key,
				r = i.set;
			i.exp({
				defineMetadata: function(e, t, n, i) {
					r(e, t, a(n), o(i))
				}
			})
		},
		function(e, t, n) {
			var i = n(211),
				a = n(8),
				o = n(23)("metadata"),
				r = o.store || (o.store = new(n(215))),
				s = function(e, t, n) {
					var a = r.get(e);
					if (!a) {
						if (!n) return;
						r.set(e, a = new i)
					}
					var o = a.get(t);
					if (!o) {
						if (!n) return;
						a.set(t, o = new i)
					}
					return o
				},
				l = function(e, t, n) {
					var i = s(t, n, !1);
					return void 0 !== i && i.has(e)
				},
				c = function(e, t, n) {
					var i = s(t, n, !1);
					return void 0 === i ? void 0 : i.get(e)
				},
				d = function(e, t, n, i) {
					s(n, i, !0).set(e, t)
				},
				u = function(e, t) {
					var n = s(e, t, !1),
						i = [];
					return n && n.forEach(function(e, t) {
						i.push(t)
					}), i
				},
				p = function(e) {
					return void 0 === e || "symbol" == typeof e ? e : String(e)
				},
				f = function(e) {
					a(a.S, "Reflect", e)
				};
			e.exports = {
				store: r,
				map: s,
				has: l,
				get: c,
				set: d,
				keys: u,
				key: p,
				exp: f
			}
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = i.key,
				r = i.map,
				s = i.store;
			i.exp({
				deleteMetadata: function(e, t) {
					var n = arguments.length < 3 ? void 0 : o(arguments[2]),
						i = r(a(t), n, !1);
					if (void 0 === i || !i.delete(e)) return !1;
					if (i.size) return !0;
					var l = s.get(t);
					return l.delete(n), !!l.size || s.delete(t)
				}
			})
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = n(59),
				r = i.has,
				s = i.get,
				l = i.key,
				c = function(e, t, n) {
					if (r(e, t, n)) return s(e, t, n);
					var i = o(t);
					return null !== i ? c(e, i, n) : void 0
				};
			i.exp({
				getMetadata: function(e, t) {
					return c(e, a(t), arguments.length < 3 ? void 0 : l(arguments[2]))
				}
			})
		},
		function(e, t, n) {
			var i = n(214),
				a = n(268),
				o = n(277),
				r = n(12),
				s = n(59),
				l = o.keys,
				c = o.key,
				d = function(e, t) {
					var n = l(e, t),
						o = s(e);
					if (null === o) return n;
					var r = d(o, t);
					return r.length ? n.length ? a(new i(n.concat(r))) : r : n
				};
			o.exp({
				getMetadataKeys: function(e) {
					return d(r(e), arguments.length < 2 ? void 0 : c(arguments[1]))
				}
			})
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = i.get,
				r = i.key;
			i.exp({
				getOwnMetadata: function(e, t) {
					return o(e, a(t), arguments.length < 3 ? void 0 : r(arguments[2]))
				}
			})
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = i.keys,
				r = i.key;
			i.exp({
				getOwnMetadataKeys: function(e) {
					return o(a(e), arguments.length < 2 ? void 0 : r(arguments[1]))
				}
			})
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = n(59),
				r = i.has,
				s = i.key,
				l = function(e, t, n) {
					if (r(e, t, n)) return !0;
					var i = o(t);
					return null !== i && l(e, i, n)
				};
			i.exp({
				hasMetadata: function(e, t) {
					return l(e, a(t), arguments.length < 3 ? void 0 : s(arguments[2]))
				}
			})
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = i.has,
				r = i.key;
			i.exp({
				hasOwnMetadata: function(e, t) {
					return o(e, a(t), arguments.length < 3 ? void 0 : r(arguments[2]))
				}
			})
		},
		function(e, t, n) {
			var i = n(277),
				a = n(12),
				o = n(21),
				r = i.key,
				s = i.set;
			i.exp({
				metadata: function(e, t) {
					return function(n, i) {
						s(e, t, (void 0 !== i ? a : o)(n), r(i))
					}
				}
			})
		},
		function(e, t, n) {
			var i = n(8),
				a = n(209)(),
				o = n(4).process,
				r = "process" == n(34)(o);
			i(i.G, {
				asap: function(e) {
					var t = r && o.domain;
					a(t ? t.bind(e) : e)
				}
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(8),
				a = n(4),
				o = n(9),
				r = n(209)(),
				s = n(25)("observable"),
				l = n(21),
				c = n(12),
				d = n(205),
				u = n(210),
				p = n(10),
				f = n(206),
				h = f.RETURN,
				g = function(e) {
					return null == e ? void 0 : l(e)
				},
				m = function(e) {
					var t = e._c;
					t && (e._c = void 0, t())
				},
				v = function(e) {
					return void 0 === e._o
				},
				y = function(e) {
					v(e) || (e._o = void 0, m(e))
				},
				b = function(e, t) {
					c(e), this._c = void 0, this._o = e, e = new _(this);
					try {
						var n = t(e),
							i = n;
						null != n && ("function" == typeof n.unsubscribe ? n = function() {
							i.unsubscribe()
						} : l(n), this._c = n)
					} catch (t) {
						return void e.error(t)
					}
					v(this) && m(this)
				};
			b.prototype = u({}, {
				unsubscribe: function() {
					y(this)
				}
			});
			var _ = function(e) {
				this._s = e
			};
			_.prototype = u({}, {
				next: function(e) {
					var t = this._s;
					if (!v(t)) {
						var n = t._o;
						try {
							var i = g(n.next);
							if (i) return i.call(n, e)
						} catch (e) {
							try {
								y(t)
							} finally {
								throw e
							}
						}
					}
				},
				error: function(e) {
					var t = this._s;
					if (v(t)) throw e;
					var n = t._o;
					t._o = void 0;
					try {
						var i = g(n.error);
						if (!i) throw e;
						e = i.call(n, e)
					} catch (e) {
						try {
							m(t)
						} finally {
							throw e
						}
					}
					return m(t), e
				},
				complete: function(e) {
					var t = this._s;
					if (!v(t)) {
						var n = t._o;
						t._o = void 0;
						try {
							var i = g(n.complete);
							e = i ? i.call(n, e) : void 0
						} catch (e) {
							try {
								m(t)
							} finally {
								throw e
							}
						}
						return m(t), e
					}
				}
			});
			var w = function(e) {
				d(this, w, "Observable", "_f")._f = l(e)
			};
			u(w.prototype, {
				subscribe: function(e) {
					return new b(e, this._f)
				},
				forEach: function(e) {
					var t = this;
					return new(o.Promise || a.Promise)(function(n, i) {
						l(e);
						var a = t.subscribe({
							next: function(t) {
								try {
									return e(t)
								} catch (e) {
									i(e), a.unsubscribe()
								}
							},
							error: i,
							complete: n
						})
					})
				}
			}), u(w, {
				from: function(e) {
					var t = "function" == typeof this ? this : w,
						n = g(c(e)[s]);
					if (n) {
						var i = c(n.call(e));
						return i.constructor === t ? i : new t(function(e) {
							return i.subscribe(e)
						})
					}
					return new t(function(t) {
						var n = !1;
						return r(function() {
								if (!n) {
									try {
										if (f(e, !1, function(e) {
											if (t.next(e), n) return h
										}) === h) return
									} catch (e) {
										if (n) throw e;
										return void t.error(e)
									}
									t.complete()
								}
							}),
							function() {
								n = !0
							}
					})
				},
				of: function() {
					for (var e = 0, t = arguments.length, n = Array(t); e < t;) n[e] = arguments[e++];
					return new("function" == typeof this ? this : w)(function(e) {
						var t = !1;
						return r(function() {
								if (!t) {
									for (var i = 0; i < n.length; ++i)
										if (e.next(n[i]), t) return;
									e.complete()
								}
							}),
							function() {
								t = !0
							}
					})
				}
			}), p(w.prototype, s, function() {
				return this
			}), i(i.G, {
				Observable: w
			}), n(192)("Observable")
		},
		function(e, t, n) {
			var i = n(4),
				a = n(8),
				o = n(78),
				r = n(289),
				s = i.navigator,
				l = !!s && /MSIE .\./.test(s.userAgent),
				c = function(e) {
					return l ? function(t, n) {
						return e(o(r, [].slice.call(arguments, 2), "function" == typeof t ? t : Function(t)), n)
					} : e
				};
			a(a.G + a.B + a.F * l, {
				setTimeout: c(i.setTimeout),
				setInterval: c(i.setInterval)
			})
		},
		function(e, t, n) {
			"use strict";
			var i = n(290),
				a = n(78),
				o = n(21);
			e.exports = function() {
				for (var e = o(this), t = arguments.length, n = Array(t), r = 0, s = i._, l = !1; t > r;)(n[r] = arguments[r++]) === s && (l = !0);
				return function() {
					var i, o = this,
						r = arguments.length,
						c = 0,
						d = 0;
					if (!l && !r) return a(e, n, o);
					if (i = n.slice(), l)
						for (; t > c; c++) i[c] === s && (i[c] = arguments[d++]);
					for (; r > d;) i.push(arguments[d++]);
					return a(e, i, o)
				}
			}
		},
		function(e, t, n) {
			e.exports = n(4)
		},
		function(e, t, n) {
			var i = n(8),
				a = n(208);
			i(i.G + i.B, {
				setImmediate: a.set,
				clearImmediate: a.clear
			})
		},
		function(e, t, n) {
			for (var i = n(193), a = n(18), o = n(4), r = n(10), s = n(129), l = n(25), c = l("iterator"), d = l("toStringTag"), u = s.Array, p = ["NodeList", "DOMTokenList", "MediaList", "StyleSheetList", "CSSRuleList"], f = 0; f < 5; f++) {
				var h, g = p[f],
					m = o[g],
					v = m && m.prototype;
				if (v) {
					v[c] || r(v, c, u), v[d] || r(v, d, g), s[g] = u;
					for (h in i) v[h] || a(v, h, i[h], !0)
				}
			}
		},
		function(e, t, n) {
			(function(t, n) {
				! function(t) {
					"use strict";

					function i(e, t, n, i) {
						var a = Object.create((t || o).prototype),
							r = new h(i || []);
						return a._invoke = u(e, n, r), a
					}

					function a(e, t, n) {
						try {
							return {
								type: "normal",
								arg: e.call(t, n)
							}
						} catch (e) {
							return {
								type: "throw",
								arg: e
							}
						}
					}

					function o() {}

					function r() {}

					function s() {}

					function l(e) {
						["next", "throw", "return"].forEach(function(t) {
							e[t] = function(e) {
								return this._invoke(t, e)
							}
						})
					}

					function c(e) {
						this.arg = e
					}

					function d(e) {
						function t(n, i, o, r) {
							var s = a(e[n], e, i);
							if ("throw" !== s.type) {
								var l = s.arg,
									d = l.value;
								return d instanceof c ? Promise.resolve(d.arg).then(function(e) {
									t("next", e, o, r)
								}, function(e) {
									t("throw", e, o, r)
								}) : Promise.resolve(d).then(function(e) {
									l.value = e, o(l)
								}, r)
							}
							r(s.arg)
						}

						function i(e, n) {
							function i() {
								return new Promise(function(i, a) {
									t(e, n, i, a)
								})
							}
							return o = o ? o.then(i, i) : i()
						}
						"object" == typeof n && n.domain && (t = n.domain.bind(t));
						var o;
						this._invoke = i
					}

					function u(e, t, n) {
						var i = k;
						return function(o, r) {
							if (i === C) throw new Error("Generator is already running");
							if (i === D) {
								if ("throw" === o) throw r;
								return m()
							}
							for (;;) {
								var s = n.delegate;
								if (s) {
									if ("return" === o || "throw" === o && s.iterator[o] === v) {
										n.delegate = null;
										var l = s.iterator.return;
										if (l) {
											var c = a(l, s.iterator, r);
											if ("throw" === c.type) {
												o = "throw", r = c.arg;
												continue
											}
										}
										if ("return" === o) continue
									}
									var c = a(s.iterator[o], s.iterator, r);
									if ("throw" === c.type) {
										n.delegate = null, o = "throw", r = c.arg;
										continue
									}
									o = "next", r = v;
									var d = c.arg;
									if (!d.done) return i = T, d;
									n[s.resultName] = d.value, n.next = s.nextLoc, n.delegate = null
								}
								if ("next" === o) n.sent = n._sent = r;
								else if ("throw" === o) {
									if (i === k) throw i = D, r;
									n.dispatchException(r) && (o = "next", r = v)
								} else "return" === o && n.abrupt("return", r);
								i = C;
								var c = a(e, t, n);
								if ("normal" === c.type) {
									i = n.done ? D : T;
									var d = {
										value: c.arg,
										done: n.done
									};
									if (c.arg !== S) return d;
									n.delegate && "next" === o && (r = v)
								} else "throw" === c.type && (i = D, o = "throw", r = c.arg)
							}
						}
					}

					function p(e) {
						var t = {
							tryLoc: e[0]
						};
						1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t)
					}

					function f(e) {
						var t = e.completion || {};
						t.type = "normal", delete t.arg, e.completion = t
					}

					function h(e) {
						this.tryEntries = [{
							tryLoc: "root"
						}], e.forEach(p, this), this.reset(!0)
					}

					function g(e) {
						if (e) {
							var t = e[_];
							if (t) return t.call(e);
							if ("function" == typeof e.next) return e;
							if (!isNaN(e.length)) {
								var n = -1,
									i = function t() {
										for (; ++n < e.length;)
											if (y.call(e, n)) return t.value = e[n], t.done = !1, t;
										return t.value = v, t.done = !0, t
									};
								return i.next = i
							}
						}
						return {
							next: m
						}
					}

					function m() {
						return {
							value: v,
							done: !0
						}
					}
					var v, y = Object.prototype.hasOwnProperty,
						b = "function" == typeof Symbol ? Symbol : {},
						_ = b.iterator || "@@iterator",
						w = b.toStringTag || "@@toStringTag",
						x = "object" == typeof e,
						$ = t.regeneratorRuntime;
					if ($) return void(x && (e.exports = $));
					$ = t.regeneratorRuntime = x ? e.exports : {}, $.wrap = i;
					var k = "suspendedStart",
						T = "suspendedYield",
						C = "executing",
						D = "completed",
						S = {},
						P = s.prototype = o.prototype;
					r.prototype = P.constructor = s, s.constructor = r, s[w] = r.displayName = "GeneratorFunction", $.isGeneratorFunction = function(e) {
						var t = "function" == typeof e && e.constructor;
						return !!t && (t === r || "GeneratorFunction" === (t.displayName || t.name))
					}, $.mark = function(e) {
						return Object.setPrototypeOf ? Object.setPrototypeOf(e, s) : (e.__proto__ = s, w in e || (e[w] = "GeneratorFunction")), e.prototype = Object.create(P), e
					}, $.awrap = function(e) {
						return new c(e)
					}, l(d.prototype), $.async = function(e, t, n, a) {
						var o = new d(i(e, t, n, a));
						return $.isGeneratorFunction(t) ? o : o.next().then(function(e) {
							return e.done ? e.value : o.next()
						})
					}, l(P), P[_] = function() {
						return this
					}, P[w] = "Generator", P.toString = function() {
						return "[object Generator]"
					}, $.keys = function(e) {
						var t = [];
						for (var n in e) t.push(n);
						return t.reverse(),
							function n() {
								for (; t.length;) {
									var i = t.pop();
									if (i in e) return n.value = i, n.done = !1, n
								}
								return n.done = !0, n
							}
					}, $.values = g, h.prototype = {
						constructor: h,
						reset: function(e) {
							if (this.prev = 0, this.next = 0, this.sent = this._sent = v, this.done = !1, this.delegate = null, this.tryEntries.forEach(f), !e)
								for (var t in this) "t" === t.charAt(0) && y.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = v)
						},
						stop: function() {
							this.done = !0;
							var e = this.tryEntries[0],
								t = e.completion;
							if ("throw" === t.type) throw t.arg;
							return this.rval
						},
						dispatchException: function(e) {
							function t(t, i) {
								return o.type = "throw", o.arg = e, n.next = t, !!i
							}
							if (this.done) throw e;
							for (var n = this, i = this.tryEntries.length - 1; i >= 0; --i) {
								var a = this.tryEntries[i],
									o = a.completion;
								if ("root" === a.tryLoc) return t("end");
								if (a.tryLoc <= this.prev) {
									var r = y.call(a, "catchLoc"),
										s = y.call(a, "finallyLoc");
									if (r && s) {
										if (this.prev < a.catchLoc) return t(a.catchLoc, !0);
										if (this.prev < a.finallyLoc) return t(a.finallyLoc)
									} else if (r) {
										if (this.prev < a.catchLoc) return t(a.catchLoc, !0)
									} else {
										if (!s) throw new Error("try statement without catch or finally");
										if (this.prev < a.finallyLoc) return t(a.finallyLoc)
									}
								}
							}
						},
						abrupt: function(e, t) {
							for (var n = this.tryEntries.length - 1; n >= 0; --n) {
								var i = this.tryEntries[n];
								if (i.tryLoc <= this.prev && y.call(i, "finallyLoc") && this.prev < i.finallyLoc) {
									var a = i;
									break
								}
							}
							a && ("break" === e || "continue" === e) && a.tryLoc <= t && t <= a.finallyLoc && (a = null);
							var o = a ? a.completion : {};
							return o.type = e, o.arg = t, a ? this.next = a.finallyLoc : this.complete(o), S
						},
						complete: function(e, t) {
							if ("throw" === e.type) throw e.arg;
							"break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = e.arg, this.next = "end") : "normal" === e.type && t && (this.next = t)
						},
						finish: function(e) {
							for (var t = this.tryEntries.length - 1; t >= 0; --t) {
								var n = this.tryEntries[t];
								if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), f(n), S
							}
						},
						catch: function(e) {
							for (var t = this.tryEntries.length - 1; t >= 0; --t) {
								var n = this.tryEntries[t];
								if (n.tryLoc === e) {
									var i = n.completion;
									if ("throw" === i.type) {
										var a = i.arg;
										f(n)
									}
									return a
								}
							}
							throw new Error("illegal catch attempt")
						},
						delegateYield: function(e, t, n) {
							return this.delegate = {
								iterator: g(e),
								resultName: t,
								nextLoc: n
							}, S
						}
					}
				}("object" == typeof t ? t : "object" == typeof window ? window : "object" == typeof self ? self : this)
			}).call(t, function() {
				return this
			}(), n(294))
		},
		function(e, t) {
			function n(e) {
				return l === setTimeout ? setTimeout(e, 0) : l.call(null, e, 0)
			}

			function i(e) {
				c === clearTimeout ? clearTimeout(e) : c.call(null, e)
			}

			function a() {
				f && u && (f = !1, u.length ? p = u.concat(p) : h = -1, p.length && o())
			}

			function o() {
				if (!f) {
					var e = n(a);
					f = !0;
					for (var t = p.length; t;) {
						for (u = p, p = []; ++h < t;) u && u[h].run();
						h = -1, t = p.length
					}
					u = null, f = !1, i(e)
				}
			}

			function r(e, t) {
				this.fun = e, this.array = t
			}

			function s() {}
			var l, c, d = e.exports = {};
			! function() {
				try {
					l = setTimeout
				} catch (e) {
					l = function() {
						throw new Error("setTimeout is not defined")
					}
				}
				try {
					c = clearTimeout
				} catch (e) {
					c = function() {
						throw new Error("clearTimeout is not defined")
					}
				}
			}();
			var u, p = [],
				f = !1,
				h = -1;
			d.nextTick = function(e) {
				var t = new Array(arguments.length - 1);
				if (arguments.length > 1)
					for (var i = 1; i < arguments.length; i++) t[i - 1] = arguments[i];
				p.push(new r(e, t)), 1 !== p.length || f || n(o)
			}, r.prototype.run = function() {
				this.fun.apply(null, this.array)
			}, d.title = "browser", d.browser = !0, d.env = {}, d.argv = [], d.version = "", d.versions = {}, d.on = s, d.addListener = s, d.once = s, d.off = s, d.removeListener = s, d.removeAllListeners = s, d.emit = s, d.binding = function(e) {
				throw new Error("process.binding is not supported")
			}, d.cwd = function() {
				return "/"
			}, d.chdir = function(e) {
				throw new Error("process.chdir is not supported")
			}, d.umask = function() {
				return 0
			}
		},
		function(e, t, n) {
			n(296), e.exports = n(9).RegExp.escape
		},
		function(e, t, n) {
			var i = n(8),
				a = n(297)(/[\\^$*+?.()|[\]{}]/g, "\\$&");
			i(i.S, "RegExp", {
				escape: function(e) {
					return a(e)
				}
			})
		},
		function(e, t) {
			e.exports = function(e, t) {
				var n = t === Object(t) ? function(e) {
					return t[e]
				} : t;
				return function(t) {
					return String(t).replace(e, n)
				}
			}
		},
		function(e, t) {
			"use strict";
			Object.defineProperty(t, "__esModule", {
				value: !0
			});
			t.API_KEY = "AIzaSyCFyj9mrzuoTWACoSqRy77qYr9i8O6gi9s", t.CALLBACK = "__planner_map_initialize__"
		},
		function(e, t) {
			"use strict";

			function n(e, t) {
				if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
			}
			Object.defineProperty(t, "__esModule", {
				value: !0
			});
			var i = function() {
					function e(e, t) {
						for (var n = 0; n < t.length; n++) {
							var i = t[n];
							i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i)
						}
					}
					return function(t, n, i) {
						return n && e(t.prototype, n), i && e(t, i), t
					}
				}(),
				a = '\n  <svg width="31px" height="41px" viewBox="0 0 31 41" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <ellipse fill-opacity="0.1" fill="#000000" cx="15" cy="38.0729167" rx="5.2173913" ry="1.92708333"></ellipse>\n        <path d="M15,14.7743056 L15,25.8854167 L15,36.9965278 L15.6521739,36.9965278 C15.9,36.9965278 24.5984619,27.8255887 26.0869565,25.3006213 C28.2015381,22.8341336 30.0000001,19.3875727 30,14.7743056 L15,14.7743056 L15,14.7743056 Z M15,14.7743056 L15,25.8854167 L15,36.9965278 L14.3478261,36.9965278 C14.3877551,36.9965278 5.51177356,27.8255887 3.91304348,25.3006213 C1.83516522,22.8341336 -6.87489206e-08,19.3875727 0,14.7743056 L15,14.7743056 L15,14.7743056 Z" fill="{{ color }}"></path>\n        <path d="M15,30.4 C23.2842712,30.4 30,23.5947282 30,15.2 C30,6.8052718 23.2842712,0 15,0 C6.71572875,0 0,6.8052718 0,15.2 C0,23.5947282 6.71572875,30.4 15,30.4 Z" fill="{{ color }}"></path>\n        <ellipse fill="#FFFFFF" cx="15" cy="15.2" rx="11.8421053" ry="12"></ellipse>\n        {{ shape }}\n    </g>\n  </svg>\n',
				o = [{
					color: "#F56F62",
					path: '<text font-family="PingFangSC-Semibold, PingFang SC, Lantinghei SC, Microsoft YaHei, 微软雅黑, STHeiti, WenQuanYi Micro Hei, SimSun, sans-serif" font-size="12" font-weight="500" letter-spacing="-0.034285713" fill="{{ color }}"><tspan x="9" y="19">{{ label }}</tspan></text>'
				}, {
					color: "#41C074",
					path: '<path d="M10.3223684,13.5714286 L10.3223684,17.9047619 L12.1184211,17.9047619 L12.1184211,13.5714286 L10.3223684,13.5714286 L10.3223684,13.5714286 Z M13.9144737,13.5714286 L13.9144737,17.9047619 L15.7105263,17.9047619 L15.7105263,13.5714286 L13.9144737,13.5714286 L13.9144737,13.5714286 Z M9.125,21 L20.5,21 L20.5,19.1428571 L9.125,19.1428571 L9.125,21 L9.125,21 Z M17.5065789,13.5714286 L17.5065789,17.9047619 L19.3026316,17.9047619 L19.3026316,13.5714286 L17.5065789,13.5714286 L17.5065789,13.5714286 Z M14.8125,8 L9.125,11.0952381 L9.125,12.3333333 L20.5,12.3333333 L20.5,11.0952381 L14.8125,8 L14.8125,8 Z" fill="{{ color }}"></path>'
				}, {
					color: "#FCC500",
					path: '<path d="M12.2955415,16.376589 L14.0635785,14.608552 L9.67784708,10.2290681 C8.70324009,11.203675 8.70324009,12.7842877 9.67784708,13.7651421 L12.2955415,16.376589 L12.2955415,16.376589 Z M16.5313334,15.245795 C17.4871979,15.6893662 18.8304063,15.3769921 19.8237557,14.3836427 C21.0170245,13.1903739 21.2481813,11.4785642 20.3298016,10.5601845 C19.4176695,9.64805236 17.7058597,9.87296166 16.5063435,11.0662305 C15.512994,12.0595799 15.20062,13.4027882 15.6441911,14.3586528 L9.54664998,20.4561939 L10.4275448,21.3370887 L14.7320589,17.0450695 L19.0303257,21.3433362 L19.9112204,20.4624414 L15.6129537,16.1641747 L16.5313334,15.245795 L16.5313334,15.245795 Z" fill="{{ color }}"></path>'
				}, {
					color: "#FF83A0",
					path: '<path d="M18.4088176,13.3466908 L15.5131279,9.14362043 C15.3815056,9.01625466 15.1840723,8.88888889 14.9866389,8.88888889 C14.7892055,8.88888889 14.5917721,8.95257177 14.4601498,9.14362043 L11.5644602,13.3466908 L8.40552594,13.3466908 C8.01065917,13.3466908 7.74741465,13.6014223 7.74741465,13.9835196 L7.74741465,14.1745683 L9.39269288,20.0970765 C9.52431514,20.6065396 10.0508042,21.0523198 10.6431043,21.0523198 L19.1985511,21.0523198 C19.7908513,21.0523198 20.3173403,20.6702225 20.4489626,20.0970765 L22.0942408,14.1745683 L22.0942408,13.9835196 C22.0942408,13.6014223 21.8309963,13.3466908 21.4361295,13.3466908 L18.4088176,13.3466908 L18.4088176,13.3466908 Z M13.012305,13.3466908 L14.9866389,10.5446439 L16.9609728,13.3466908 L13.012305,13.3466908 L13.012305,13.3466908 Z M14.9866389,18.4413215 C14.2627165,18.4413215 13.6704163,17.8681756 13.6704163,17.1676638 C13.6704163,16.4671521 14.2627165,15.8940061 14.9866389,15.8940061 C15.7105613,15.8940061 16.3028615,16.4671521 16.3028615,17.1676638 C16.3028615,17.8681756 15.7105613,18.4413215 14.9866389,18.4413215 L14.9866389,18.4413215 Z" fill="{{ color }}"></path>'
				}, {
					color: "#5881F2",
					path: '<polygon fill="{{ color }}" points="16.3630435 10.8823529 16.076087 9.44444444 9.61956522 9.44444444 9.61956522 21.6666667 11.0543478 21.6666667 11.0543478 16.6339869 15.0717391 16.6339869 15.3586957 18.0718954 20.3804348 18.0718954 20.3804348 10.8823529"></polygon>'
				}, {
					color: "#03A9F4",
					path: '<path d="M22.3967154,18.2333926 L22.3967154,16.7000262 L16.1157176,13.2333697 L16.1157176,10.0332879 C16.1157176,10.0332879 16.1157176,7.69999981 15.0233701,7.69999981 C13.930998,7.69999981 13.930998,10.0332879 13.930998,10.0332879 L13.930998,13.2333697 L7.6500001,16.7000262 L7.6500001,18.2333926 L13.930998,16.8999758 L13.930998,19.0333143 L11.7463277,20.7666303 L11.7463277,21.6999998 L14.5302795,21.1903577 C14.6425877,21.3370022 14.8215705,21.433351 15.0233701,21.433351 C15.2250957,21.433351 15.4056572,21.3385316 15.5164361,21.1903577 L18.3003878,21.6999998 L18.3003878,20.7666303 L16.1157176,19.0333143 L16.1157176,16.8999758 L22.3967154,18.2333926 L22.3967154,18.2333926 Z" fill="{{ color }}"></path>'
				}, {
					color: "#03A9F4",
					path: '<path d="M9,18.3848662 C9,19.0524579 9.29819137,19.6458991 9.74545698,20.0167811 L9.74545698,21.3519646 C9.74545698,21.7970186 10.0436484,22.09375 10.490914,22.09375 L11.2363709,22.09375 C11.6836366,22.09375 11.9818279,21.7970402 11.9818279,21.3519646 L11.9818279,20.6101793 L17.9454838,20.6101793 L17.9454838,21.3519646 C17.9454838,21.7970186 18.2436752,22.09375 18.6909408,22.09375 L19.4363978,22.09375 C19.8836634,22.09375 20.1818547,21.7970402 20.1818547,21.3519646 L20.1818547,20.0167811 C20.6291204,19.6458991 20.9273117,19.0524579 20.9273117,18.3848662 L20.9273117,10.9670985 C20.9273117,8.37088193 18.2436537,8 14.9636559,8 C11.683658,8 9,8.37088193 9,10.9670985 L9,18.3848662 L9,18.3848662 Z M11.6090994,19.1266515 C11.0127381,19.1266515 10.490914,18.6074039 10.490914,18.0139842 C10.490914,17.4205645 11.0127167,16.9013169 11.6090994,16.9013169 C12.2054607,16.9013169 12.7272849,17.4205645 12.7272849,18.0139842 C12.7272849,18.6074039 12.2054822,19.1266515 11.6090994,19.1266515 L11.6090994,19.1266515 L11.6090994,19.1266515 Z M18.3182123,19.1266515 C17.721851,19.1266515 17.2000268,18.6074039 17.2000268,18.0139842 C17.2000268,17.4205645 17.7218295,16.9013169 18.3182123,16.9013169 C18.9145736,16.9013169 19.4363978,17.4205645 19.4363978,18.0139842 C19.4363978,18.6074039 18.914595,19.1266515 18.3182123,19.1266515 L18.3182123,19.1266515 L18.3182123,19.1266515 Z M19.4363763,14.6759823 L10.490914,14.6759823 L10.490914,10.9670985 L19.4363763,10.9670985 L19.4363763,14.6759823 L19.4363763,14.6759823 Z" fill="{{ color }}"></path>'
				}, {
					color: "#03A9F4",
					path: '<path d="M18.9151475,19.5325664 L19.2334469,19.5325664 C19.6791211,19.5325664 20.0610621,19.1489783 20.0610621,18.7013597 L20.0610621,9.49375752 C20.0610621,9.04616177 19.6790982,8.66248213 19.2334469,8.66248213 L16.6870513,8.66248213 C16.6870513,7.63941269 16.3050874,7 15.0954854,7 C13.9496393,7 13.4403236,7.51158048 13.4403236,8.66248213 L10.9576153,8.66248213 C10.5119412,8.66248213 10.1300001,9.0461389 10.1300001,9.49375752 L10.1300001,18.7013597 C10.1300001,19.1489554 10.511964,19.5325664 10.9576153,19.5325664 L11.2759148,19.5325664 L10.1300001,21.1951172 L11.5942142,21.1951172 L12.9947639,19.5325664 L17.2599857,19.5325664 L18.596848,21.1951172 L20.1247266,21.1951172 L18.9151246,19.5325664 L18.9151475,19.5325664 Z M10.9575924,16.6552437 C10.9575924,16.3994877 11.0211883,16.2715869 11.2122274,16.2715869 L12.9947639,16.2715869 C13.2493988,16.2715869 13.2493988,16.463381 13.2493988,16.6552437 C13.2493988,16.9109996 13.1857344,17.0389004 12.9947639,17.0389004 L11.2122274,17.0389004 C11.0212111,17.0389004 10.9575924,16.8470148 10.9575924,16.6552437 L10.9575924,16.6552437 L10.9575924,16.6552437 Z M14.2679159,15.3764183 L10.9575924,15.3764183 L10.9575924,11.0283388 C10.9575924,10.7086439 11.2122274,10.3889261 11.530504,10.3889261 L14.2679159,10.3889261 L14.2679159,15.3764183 L14.2679159,15.3764183 Z M15.0954625,9.49375752 C14.6499027,9.49375752 14.2679159,9.11010075 14.2679159,8.66248213 C14.2679159,8.21488639 14.6499027,7.83127538 15.0954625,7.83127538 C15.5411366,7.83127538 15.9230777,8.21486351 15.9230777,8.66248213 C15.9230777,9.11010075 15.6047782,9.49375752 15.0954625,9.49375752 L15.0954625,9.49375752 L15.0954625,9.49375752 Z M15.9230777,10.3889261 L18.6605125,10.3889261 C18.9788119,10.3889261 19.2334241,10.644682 19.2334241,11.0283388 L19.2334241,15.4403115 L15.9231006,15.4403115 L15.9231006,10.3889261 L15.9230777,10.3889261 Z M17.2599857,17.0389004 C17.0690381,17.0389004 17.0053507,16.8470148 17.0053507,16.6552437 C17.0053507,16.3994877 17.0690152,16.2715869 17.2599857,16.2715869 L19.0424993,16.2715869 C19.2334469,16.2715869 19.2971343,16.463381 19.2971343,16.6552437 C19.2971343,16.9109996 19.2334469,17.0389004 19.0424993,17.0389004 L17.2599857,17.0389004 L17.2599857,17.0389004 Z" fill="{{ color }}"></path>'
				}, {
					color: "#03A9F4",
					path: '<path d="M19.3493648,9 L10.6481887,9 C10.177392,9 9.78858144,9.30620519 9.5132507,9.74230295 L8,14.1960587 L8,20.5055486 C8,20.9416464 8.31105158,21.2478516 8.75660987,21.2478516 L9.51321973,21.2478516 C10.0218275,21.2478516 10.3328946,20.9416464 10.2698296,20.5055486 L10.2698296,19.7632457 L19.7276155,19.7632457 L19.7276155,20.5055486 C19.664566,20.9416464 19.9756176,21.2478516 20.4842254,21.2478516 L21.2408352,21.2478516 C21.686409,21.2478516 21.9974451,20.9416464 21.9974451,20.5055486 L21.9974451,14.1960587 L20.4841944,9.74230295 C20.2088637,9.30620519 19.7422785,9 19.3492719,9 L19.3493648,9 Z M10.6482042,17.5363678 C10.0429008,17.5363678 9.51326618,17.0167511 9.51326618,16.4229366 C9.51326618,15.8291221 10.0429008,15.3095054 10.6482042,15.3095054 C11.2535076,15.3095054 11.7831267,15.8291221 11.7831267,16.4229366 C11.7831267,17.0167666 11.2534921,17.5363678 10.6482042,17.5363678 L10.6482042,17.5363678 L10.6482042,17.5363678 Z M19.3493648,17.5363678 C18.7440614,17.5363678 18.2144267,17.0167511 18.2144267,16.4229366 C18.2144267,15.8291221 18.7440614,15.3095054 19.3493648,15.3095054 C19.9546681,15.3095054 20.4843028,15.8291221 20.4843028,16.4229366 C20.4843028,17.0167666 19.9546681,17.5363678 19.3493648,17.5363678 L19.3493648,17.5363678 L19.3493648,17.5363678 Z M9.51328167,13.4537558 L10.6482042,10.1134467 L19.3493802,10.1134467 L20.4843183,13.4537558 L9.51328167,13.4537558 L9.51328167,13.4537558 Z" fill="{{ color }}"></path>'
				}, {
					color: "#03A9F4",
					path: '<path d="M19.7956875,19.7931248 C18.9586903,19.7931248 18.1216932,19.5101114 17.3870626,18.9982786 C15.9178013,20.0279658 14.0390739,20.0279658 12.5698126,18.9982786 C11.835182,19.5101114 10.9981848,19.7931248 10.1611877,19.7931248 L8.95687518,19.7931248 L8.95687518,20.9974373 L10.1611877,20.9974373 C10.9921633,20.9974373 11.8110958,20.7866826 12.5698126,20.4013026 C14.0872464,21.1780842 15.8696288,21.1780842 17.3870626,20.4013026 C18.1457794,20.7927042 18.9647119,20.9974373 19.7956875,20.9974373 L21,20.9974373 L21,19.7931248 L19.7956875,19.7931248 L19.7956875,19.7931248 Z M10.1310798,18.5888123 L10.1611877,18.5888123 C11.1246376,18.5888123 11.9796995,18.0589148 12.5698126,17.3844999 C13.1599257,18.0589148 14.0149876,18.5888123 14.9784376,18.5888123 C15.9418876,18.5888123 16.7969494,18.0589148 17.3870626,17.3844999 C17.9771757,18.0589148 18.8322375,18.5888123 19.7956875,18.5888123 L19.8257953,18.5888123 L20.9638706,14.5664086 C21.0120431,14.409848 21,14.2412443 20.9277413,14.0967268 C20.8554825,13.9522093 20.7230081,13.8438212 20.5664475,13.7956487 L19.7956875,13.542743 L19.7956875,10.7607812 C19.7956875,10.0984093 19.2537469,9.55646872 18.591375,9.55646872 L16.7849063,9.55646872 L16.7849063,7.75 L13.1719689,7.75 L13.1719689,9.55646872 L11.3655001,9.55646872 C10.7031283,9.55646872 10.1611877,10.0984093 10.1611877,10.7607812 L10.1611877,13.542743 L9.38440611,13.7956487 C9.22784549,13.8438212 9.09537111,13.9522093 9.02311236,14.0967268 C8.95085362,14.2412443 8.93278893,14.409848 8.98698299,14.5664086 L10.1310798,18.5888123 L10.1310798,18.5888123 Z M11.3655001,10.7607812 L18.591375,10.7607812 L18.591375,13.1513415 L14.9784376,11.9650937 L11.3655001,13.1513415 L11.3655001,10.7607812 L11.3655001,10.7607812 Z" fill="{{ color }}"></path>'
				}, {
					color: "#03A9F4",
					path: '<path d="M21.5,13.4234234 L19.03,13.4234234 L19.03,12.5405405 C20.46,12.2882883 21.5,11.027027 21.5,9.51351351 L19.03,9.51351351 L19.03,8.75675676 C19.03,8.25225225 18.77,8 18.25,8 L11.75,8 C11.23,8 10.97,8.25225225 10.97,8.75675676 L10.97,9.51351351 L8.5,9.51351351 C8.5,11.027027 9.54,12.1621622 10.97,12.5405405 L10.97,13.4234234 L8.5,13.4234234 C8.5,14.9369369 9.54,16.0720721 10.97,16.4504505 L10.97,17.3333333 L8.5,17.3333333 C8.5,18.8468468 9.54,19.981982 10.97,20.3603604 L10.97,21.2432432 C10.97,21.7477477 11.23,22 11.75,22 L18.25,22 C18.77,22 19.03,21.7477477 19.03,21.2432432 L19.03,20.3603604 C20.46,20.1081081 21.5,18.8468468 21.5,17.3333333 L19.03,17.3333333 L19.03,16.4504505 C20.46,16.0720721 21.5,14.8108108 21.5,13.4234234 L21.5,13.4234234 L21.5,13.4234234 Z M15,20.3603604 C14.09,20.3603604 13.44,19.6036036 13.44,18.8468468 C13.44,18.0900901 14.22,17.3333333 15,17.3333333 C15.78,17.3333333 16.56,18.0900901 16.56,18.8468468 C16.56,19.6036036 15.91,20.3603604 15,20.3603604 L15,20.3603604 L15,20.3603604 Z M15,16.4504505 C14.09,16.4504505 13.44,15.6936937 13.44,14.9369369 C13.44,14.1801802 14.09,13.4234234 15,13.4234234 C15.91,13.4234234 16.56,14.1801802 16.56,14.9369369 C16.56,15.6936937 15.91,16.4504505 15,16.4504505 L15,16.4504505 L15,16.4504505 Z M15,12.6666667 C14.09,12.6666667 13.44,11.9099099 13.44,11.1531532 C13.44,10.3963964 14.09,9.51351351 15,9.51351351 C15.91,9.51351351 16.56,10.1441441 16.56,11.027027 C16.56,11.9099099 15.91,12.6666667 15,12.6666667 L15,12.6666667 L15,12.6666667 Z" fill="{{ color }}"></path>'
				}, {
					color: "#03A9F4",
					path: '<polygon fill="{{ color }}" points="16.8909091 12.6909091 16.8909091 9 23 15.3636364 16.8909091 21.7272727 16.8909091 18.0363636 9 18.0363636 9 12.6909091"></polygon>'
				}, {
					color: "#F56F62",
					path: '<path d="M13.1393687,17.2265625 L13.1393687,11.296875 L12.2858382,10.6679688 C11.944426,10.3085938 11.4323077,10.3085938 11.1762486,10.6679688 L10.5787772,11.2070313 L7.50606743,14.2617188 C7.16465523,14.6210938 7.16465523,15.1601562 7.50606743,15.4296875 L12.4565443,20.3710938 C12.7979565,20.640625 13.3100748,21 13.8221931,21 L15.6999602,21 L13.8221931,19.2929688 C13.4807809,18.9335938 13.1393687,18.3046875 13.1393687,17.2265625 L13.1393687,17.2265625 Z M19.9676127,9.5 L14.6757236,9.5 C14.2489583,9.5 13.9928992,9.76953125 13.9928992,10.21875 L13.9928992,17.3164062 C13.9928992,17.765625 14.1636053,18.3945312 14.5050175,18.6640625 L16.7241968,20.7304688 C17.065609,21 17.5777273,21 17.9191395,20.7304688 L20.2236718,18.6640625 C20.565084,18.3945312 20.650437,17.765625 20.650437,17.3164062 L20.650437,10.21875 C20.7357901,9.76953125 20.4797309,9.5 19.9676127,9.5 L19.9676127,9.5 Z M17.3216681,18.3046875 C16.8095498,18.3046875 16.4681376,17.9453125 16.4681376,17.40625 C16.4681376,16.9570312 16.8095498,16.5078125 17.3216681,16.5078125 C17.7484334,16.5078125 18.1751986,16.8671875 18.1751986,17.40625 C18.1751986,17.9453125 17.8337864,18.3046875 17.3216681,18.3046875 L17.3216681,18.3046875 Z" id="Shape" fill="{{ color }}"></path>'
				}, {
					color: "#EF8E00",
					path: '<path d="M12.5454545,15.7666667 C13.5263636,15.7666667 14.3181818,14.96825 14.3181818,13.9791667 C14.3181818,12.9900833 13.5263636,12.1916667 12.5454545,12.1916667 C11.5645455,12.1916667 10.7727273,12.9900833 10.7727273,13.9791667 C10.7727273,14.96825 11.5645455,15.7666667 12.5454545,15.7666667 L12.5454545,15.7666667 Z M19.6363636,12.1916667 L14.9090909,12.1916667 L14.9090909,16.3625 L10.1818182,16.3625 L10.1818182,11 L9,11 L9,19.9375 L10.1818182,19.9375 L10.1818182,18.15 L20.8181818,18.15 L20.8181818,19.9375 L22,19.9375 L22,14.575 C22,13.2582083 20.9422727,12.1916667 19.6363636,12.1916667 L19.6363636,12.1916667 Z" id="ic_hotel" fill="{{ color }}"></path>'
				}],
				r = t.iconTypes = {
					LABEL: 0,
					SIGHT: 1,
					FOOD: 2,
					SHOPPING: 3,
					EXPERIENCE: 4,
					PLANE: 5,
					BUS: 6,
					TRAIN: 7,
					CAR: 8,
					FERRY: 9,
					TRAFFIC: 10,
					OTHER: 11,
					DISCOUNT: 12,
					HOTEL: 13
				},
				s = function() {
					function e(t) {
						n(this, e), this._shape = o[t.label ? r.LABEL : t.icon || r.LABEL], this._color = t.color || this._shape.color, this._label = t.label, this.anchor = {
							x: 15,
							y: 37
						}, this.generateUrl()
					}
					return i(e, [{
						key: "generateUrl",
						value: function() {
							var e = a.replace(/{{ shape }}/g, this._shape.path).replace(/{{ color }}/g, this._color).replace(/{{ label }}/g, this._label);
							this.url = "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(e)
						}
					}]), e
				}();
			t.default = s
		},
		function(e, t) {
			"use strict";
			Object.defineProperty(t, "__esModule", {
				value: !0
			});
			t.BubbleType = {
				TOP: "bubble--top",
				RIGHT: "bubble--right",
				PRICE: "bubble--price"
			}
		},
		function(e, t, n) {
			"use strict";

			function i(e, t) {
				if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
			}

			function a(e, t) {
				if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
				return !t || "object" != typeof t && "function" != typeof t ? e : t
			}

			function o(e, t) {
				if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
				e.prototype = Object.create(t && t.prototype, {
					constructor: {
						value: e,
						enumerable: !1,
						writable: !0,
						configurable: !0
					}
				}), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
			}
			Object.defineProperty(t, "__esModule", {
				value: !0
			}), t.BubbleLayer = void 0;
			var r = function() {
					function e(e, t) {
						for (var n = 0; n < t.length; n++) {
							var i = t[n];
							i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i)
						}
					}
					return function(t, n, i) {
						return n && e(t.prototype, n), i && e(t, i), t
					}
				}(),
				s = n(302),
				l = function(e) {
					return e && e.__esModule ? e : {
						default: e
					}
				}(s),
				c = n(300);
			t.BubbleLayer = function(e) {
				function t(e) {
					i(this, t);
					var n = a(this, Object.getPrototypeOf(t).call(this));
					return n._bubbles = [], n.setMap(e), n
				}
				return o(t, e), r(t, [{
					key: "addBubble",
					value: function(e) {
						var t = e.text,
							n = e.marker,
							i = e.type,
							a = e.index,
							o = document.createElement("div");
						this.getProjection();
						return o.className = l.default[i], o.style.zIndex = n.getZIndex(), a ? o.innerHTML = "<em>" + a + "</em>" + (t || "未命名") : o.innerText = t || "未命名", o._marker = n, o._type = i, this._bubbles.push(o), o
					}
				}, {
					key: "removeBubble",
					value: function(e) {
						var t = this._bubbles.indexOf(e);
						t > -1 && (e.parentNode && e.parentNode.removeChild(e), this._bubbles.splice(t, 1))
					}
				}, {
					key: "draw",
					value: function() {
						var e = this,
							t = this.getProjection();
						t && this._bubbles.map(function(n) {
							var i = t.fromLatLngToDivPixel(n._marker.getPosition());
							switch (e.getPanes().markerLayer.appendChild(n), n._type) {
								case c.BubbleType.TOP:
								case c.BubbleType.PRICE:
									n.style.top = i.y - 65 + "px", n.style.left = i.x - n.offsetWidth / 2 + "px";
									break;
								case c.BubbleType.RIGHT:
									n.style.top = i.y - 34 + "px", n.style.left = i.x + 22 + "px"
							}
						})
					}
				}, {
					key: "onAdd",
					value: function() {}
				}, {
					key: "onRemove",
					value: function() {
						var e = this;
						this._bubbles.map(function(t) {
							return e.getPanes().markerLayer.removeChild(t)
						}), this._bubbles = []
					}
				}]), t
			}(google.maps.OverlayView)
		},
		function(e, t, n) {
			var i = n(303);
			"string" == typeof i && (i = [
				[e.id, i, ""]
			]);
			n(305)(i, {});
			i.locals && (e.exports = i.locals)
		},
		function(e, t, n) {
			t = e.exports = n(304)(), t.push([e.id, '._25BR7,\n._3yU_o,\n._37o7A {\n  position: absolute;\n  color: #323232;\n  background: rgba(255,255,255,.9);\n  box-shadow: 0px 2px 4px 0px rgba(0,0,0,0.26);\n  font-size: 12px;\n  border-radius: 2px;\n  white-space: nowrap;\n  display: block;\n}\n\n._25BR7,\n._37o7A {\n  line-height: 20px;\n  padding: 0 5px;\n}\n\n._25BR7 em {\n  font-style: normal;\n  background: #90a4ae;\n  color: #fff;\n  display: inline-block;\n  margin: 0 5px 0 -5px;\n  padding: 0 5px;\n  border-radius: 2px 0 0 2px;\n}\n\n._25BR7:after,\n._37o7A:after {\n  content: "";\n  display: block;\n  position: absolute;\n  border-top: 4px solid #fff;\n  border-left: 3px solid transparent;\n  border-right: 3px solid transparent;\n  left: 50%;\n  margin-left: -3px;\n}\n\n._3yU_o {\n  line-height: 12px;\n  padding: 6px 7px;\n}\n\n._3yU_o:before {\n  content: "";\n  display: block;\n  position: absolute;\n  left: -4px;\n  top: 9px;\n  border-right: 4px solid rgba(255, 255, 255, 0.9);\n  border-top: 3px solid rgba(0, 0, 0, 0);\n  border-bottom: 3px solid rgba(0, 0, 0, 0);\n}\n\n._37o7A {\n  background: #90a4ae;\n  color: #fff;\n}\n\n._37o7A:after {\n  border-top-color: #90a4ae;\n}\n', ""]), t.locals = {
				"bubble--top": "_25BR7",
				"bubble--right": "_3yU_o",
				"bubble--price": "_37o7A"
			}
		},
		function(e, t) {
			e.exports = function() {
				var e = [];
				return e.toString = function() {
					for (var e = [], t = 0; t < this.length; t++) {
						var n = this[t];
						n[2] ? e.push("@media " + n[2] + "{" + n[1] + "}") : e.push(n[1])
					}
					return e.join("")
				}, e.i = function(t, n) {
					"string" == typeof t && (t = [
						[null, t, ""]
					]);
					for (var i = {}, a = 0; a < this.length; a++) {
						var o = this[a][0];
						"number" == typeof o && (i[o] = !0)
					}
					for (a = 0; a < t.length; a++) {
						var r = t[a];
						"number" == typeof r[0] && i[r[0]] || (n && !r[2] ? r[2] = n : n && (r[2] = "(" + r[2] + ") and (" + n + ")"), e.push(r))
					}
				}, e
			}
		},
		function(e, t, n) {
			function i(e, t) {
				for (var n = 0; n < e.length; n++) {
					var i = e[n],
						a = f[i.id];
					if (a) {
						a.refs++;
						for (var o = 0; o < a.parts.length; o++) a.parts[o](i.parts[o]);
						for (; o < i.parts.length; o++) a.parts.push(c(i.parts[o], t))
					} else {
						for (var r = [], o = 0; o < i.parts.length; o++) r.push(c(i.parts[o], t));
						f[i.id] = {
							id: i.id,
							refs: 1,
							parts: r
						}
					}
				}
			}

			function a(e) {
				for (var t = [], n = {}, i = 0; i < e.length; i++) {
					var a = e[i],
						o = a[0],
						r = a[1],
						s = a[2],
						l = a[3],
						c = {
							css: r,
							media: s,
							sourceMap: l
						};
					n[o] ? n[o].parts.push(c) : t.push(n[o] = {
						id: o,
						parts: [c]
					})
				}
				return t
			}

			function o(e, t) {
				var n = m(),
					i = b[b.length - 1];
				if ("top" === e.insertAt) i ? i.nextSibling ? n.insertBefore(t, i.nextSibling) : n.appendChild(t) : n.insertBefore(t, n.firstChild), b.push(t);
				else {
					if ("bottom" !== e.insertAt) throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");
					n.appendChild(t)
				}
			}

			function r(e) {
				e.parentNode.removeChild(e);
				var t = b.indexOf(e);
				t >= 0 && b.splice(t, 1)
			}

			function s(e) {
				var t = document.createElement("style");
				return t.type = "text/css", o(e, t), t
			}

			function l(e) {
				var t = document.createElement("link");
				return t.rel = "stylesheet", o(e, t), t
			}

			function c(e, t) {
				var n, i, a;
				if (t.singleton) {
					var o = y++;
					n = v || (v = s(t)), i = d.bind(null, n, o, !1), a = d.bind(null, n, o, !0)
				} else e.sourceMap && "function" == typeof URL && "function" == typeof URL.createObjectURL && "function" == typeof URL.revokeObjectURL && "function" == typeof Blob && "function" == typeof btoa ? (n = l(t), i = p.bind(null, n), a = function() {
					r(n), n.href && URL.revokeObjectURL(n.href)
				}) : (n = s(t), i = u.bind(null, n), a = function() {
					r(n)
				});
				return i(e),
					function(t) {
						if (t) {
							if (t.css === e.css && t.media === e.media && t.sourceMap === e.sourceMap) return;
							i(e = t)
						} else a()
					}
			}

			function d(e, t, n, i) {
				var a = n ? "" : i.css;
				if (e.styleSheet) e.styleSheet.cssText = _(t, a);
				else {
					var o = document.createTextNode(a),
						r = e.childNodes;
					r[t] && e.removeChild(r[t]), r.length ? e.insertBefore(o, r[t]) : e.appendChild(o)
				}
			}

			function u(e, t) {
				var n = t.css,
					i = t.media;
				if (i && e.setAttribute("media", i), e.styleSheet) e.styleSheet.cssText = n;
				else {
					for (; e.firstChild;) e.removeChild(e.firstChild);
					e.appendChild(document.createTextNode(n))
				}
			}

			function p(e, t) {
				var n = t.css,
					i = t.sourceMap;
				i && (n += "\n/*# sourceMappingURL=data:application/json;base64," + btoa(unescape(encodeURIComponent(JSON.stringify(i)))) + " */");
				var a = new Blob([n], {
						type: "text/css"
					}),
					o = e.href;
				e.href = URL.createObjectURL(a), o && URL.revokeObjectURL(o)
			}
			var f = {},
				h = function(e) {
					var t;
					return function() {
						return void 0 === t && (t = e.apply(this, arguments)), t
					}
				},
				g = h(function() {
					return /msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())
				}),
				m = h(function() {
					return document.head || document.getElementsByTagName("head")[0]
				}),
				v = null,
				y = 0,
				b = [];
			e.exports = function(e, t) {
				t = t || {}, void 0 === t.singleton && (t.singleton = g()), void 0 === t.insertAt && (t.insertAt = "bottom");
				var n = a(e);
				return i(n, t),
					function(e) {
						for (var o = [], r = 0; r < n.length; r++) {
							var s = n[r],
								l = f[s.id];
							l.refs--, o.push(l)
						}
						if (e) {
							i(a(e), t)
						}
						for (var r = 0; r < o.length; r++) {
							var l = o[r];
							if (0 === l.refs) {
								for (var c = 0; c < l.parts.length; c++) l.parts[c]();
								delete f[l.id]
							}
						}
					}
			};
			var _ = function() {
				var e = [];
				return function(t, n) {
					return e[t] = n, e.filter(Boolean).join("\n")
				}
			}()
		},
		function(e, t) {
			"use strict";

			function n(e, t) {
				if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
			}

			function i(e, t) {
				if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
				return !t || "object" != typeof t && "function" != typeof t ? e : t
			}

			function a(e, t) {
				if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
				e.prototype = Object.create(t && t.prototype, {
					constructor: {
						value: e,
						enumerable: !1,
						writable: !0,
						configurable: !0
					}
				}), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
			}
			Object.defineProperty(t, "__esModule", {
				value: !0
			});
			var o = function() {
					function e(e, t) {
						for (var n = 0; n < t.length; n++) {
							var i = t[n];
							i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i)
						}
					}
					return function(t, n, i) {
						return n && e(t.prototype, n), i && e(t, i), t
					}
				}(),
				r = ["click", "mousedown", "mousemove", "mouseover", "mouseout", "mouseup", "mousewheel", "DOMMouseScroll", "touchstart", "touchend", "touchmove", "dblclick", "contextmenu"];
			t.CardLayer = function(e) {
				function t(e) {
					n(this, t);
					var a = i(this, Object.getPrototypeOf(t).call(this));
					return a._div = document.createElement("div"), a._card = null, a._marker = null, a._listeners = [], a.setMap(e), a
				}
				return a(t, e), o(t, [{
					key: "addCard",
					value: function(e, t) {
						this._marker = e, this._card = t, this.draw()
					}
				}, {
					key: "removeCard",
					value: function() {
						this._div.removeChild(this._card), this._marker = null, this._card = null
					}
				}, {
					key: "draw",
					value: function() {
						if (this._marker && this._card) {
							var e = this.getProjection(),
								t = e.fromLatLngToDivPixel(this._marker.getPosition());
							this._card.style.top = t.y - 155 + "px", this._card.style.left = t.x - 95 + "px", this._div.appendChild(this._card)
						}
					}
				}, {
					key: "onAdd",
					value: function() {
						var e = this;
						this._listeners = r.map(function(t) {
							return google.maps.event.addDomListener(e._div, t, function(e) {
								e.cancelBubble = !0, e.stopPropagation && e.stopPropagation()
							})
						}), this.getPanes().floatPane.appendChild(this._div)
					}
				}, {
					key: "onRemove",
					value: function() {
						this._div.parentNode.removeChild(this._div), this._div = null, this._listeners.map(function(e) {
							return google.maps.event.removeListener(e)
						}), this._listeners = []
					}
				}]), t
			}(google.maps.OverlayView)
		}
	]), window.QYER || (window.QYER = {
		uid: 0
	}),
	function() {
		var e = jQuery;
		! function() {
			window.qyerUtil = {
				init: function() {
					window.QYER && window.QYER.frameVersion > 1 && (this._initHead(), this.spam_text_filter(), this.includeGA(), this.frameCompatibleh())
				},
				frameCompatibleh: function() {
					window._qyer_userid = window.QYER.uid, window.setCookie = this.setCookie, window.getCookie = this.getCookie, window._gaq = window._gaq || []
				},
				includeGA: function() {
					window._gaq = window._gaq || [], window._gaq.push(["_setAccount", "UA-185023-1"], ["_setDomainName", "qyer.com"], ["_setSiteSpeedSampleRate", 10], ["_addIgnoredRef", "qyer.com"], ["_addOrganic", "soso", "w"], ["_addOrganic", "sogou", "query"], ["_addOrganic", "baidu", "word"], ["_addOrganic", "baidu", "q1"], ["_addOrganic", "baidu", "q2"], ["_addOrganic", "m.baidu", "word"], ["_addOrganic", "so.360", "q"], ["_addOrganic", "so", "q"], ["_addOrganic", "baidu", "w"], ["_addOrganic", "cn.bing", "q"], ["_addOrganic", "sm", "q"], ["_trackPageview"]), "https:" == document.location.protocol ? requirejs(["https://ssl.google-analytics.com/ga.js"]) : requirejs(["https://qt.qyer.com/beacon.js", "http://www.google-analytics.com/ga.js"])
				},
				setCookie: function(e, t, n) {
					var i = 365,
						a = new Date;
					arguments[2] || (n = 1), 1 == n ? (a.setTime(a.getTime() + 24 * i * 60 * 60 * 1e3), document.cookie = e + "=" + escape(t) + "; path=/;domain=.qyer.com;expires=" + a.toGMTString()) : document.cookie = e + "=" + escape(t) + "; path=/;domain=.qyer.com", i = a = null
				},
				getCookie: function(e) {
					var t = document.cookie.match(new RegExp("(^| )" + e + "=([^;]*)(;|$)"));
					return null != t ? unescape(t[2]) : null
				},
				_initHead: function() {
					"ask.qyer.com" == window.location.hostname && e(".qyer_header_bg").css("position", "fixed")
				},
				_head: null,
				_getHead: function() {
					return this._head || (this._head = document.getElementsByTagName("head")[0]), this._head
				},
				loadCss: function(t, n) {
					!1 === n ? this.insertStyle(e.ajax({
						url: t,
						async: !1
					}).responseText) : e('<link rel="stylesheet" type="text/css" />').attr("href", t).appendTo(this._getHead())
				},
				insertStyle: function(e) {
					var t = document.createElement("style");
					t.type = "text/css", t.styleSheet ? t.styleSheet.cssText = e : t.innerHTML = e, this._getHead().appendChild(t), t = null
				},
				sliceArguments: function(e, t) {
					for (var n = [], i = t; i < e.length; i++) n.push(e[i]);
					return n
				},
				isMobile: function() {
					var e = navigator.userAgent;
					return e.match(/Android/i) || -1 != e.indexOf("iPhone") || -1 != e.indexOf("iPad")
				},
				getWordLen: function(t, n) {
					return n && (t = function(e) {
							return e.replace(/[^\x00-\xff]/g, "*")
						}(t)),
						function(e) {
							if (void 0 === e) return 0;
							var t = e.match(/[^\x00-\x80]/g);
							return e.length + (t ? t.length : 0)
						}(e.trim(t))
				},
				subStr: function(e, t) {
					for (var n, i, a = 0, o = 0; o < e.length; o++)
						if (n = e.charAt(o), (a += encodeURI(n).length > 2 ? 1 : .5) >= t) return i = a == t ? o + 1 : o, e.substr(0, i);
					return e
				},
				doTrackCode: function(t) {
					var n = "__dotarckcodebutton__";
					document.getElementById(n) || e('<button id="' + n + '" style="display:none;">dotarckcodebutton</button>').appendTo(document.body), e("#" + n).attr("data-bn-ipg", t).trigger("click"), n = null
				},
				ajaxFillter: function(e, t, n) {
					if (0 != window.location.href.indexOf("https://plan.qyer.com") && "object" == typeof e && e.extra && e.extra.code) switch (0 | e.extra.code) {
						case 1:
							window.qyerUtil.showAntiSpam(e.extra.msg)
					}
				},
				showAntiSpam: function(e) {
					requirejs(["web_ct_antispam"], function(t) {
						t.show(e)
					})
				},
				doAjax: function(t) {
					var n, i, a;
					if (n = t.minResponseTime ? new Date : null, a = function(e) {
						if (void 0 === e.error_code) try {
							e.error_code = e.error, e.result = e.result, 0 != e.error_code && (e.data = e.data || {}, e.data.msg = e.msg)
						} catch (e) {}
						0 == e.error_code ? (void 0 === e.data && (e.data = t.__defaultData__), t.onCallSuccessBefore && t.onCallSuccessBefore(e), t.onSuccess && t.onSuccess(e), t.onCallSuccessAfter && t.onCallSuccessAfter(e)) : t.onError && t.onError(e)
					}, t.testData) return void 0 === t.testData.data && (t.testData.data = t.__defaultData__), void setTimeout(function() {
						a(t.testData)
					}, t.minResponseTime || 200);
					var o = window.location.host,
						r = t.url || t.posturl,
						s = t.data,
						l = "json";
					if (!0 === /static.qyer.com/.test(o) || !0 === /qyerstatic.com/.test(o)) {
						var c;
						s = e.extend({}, s, {
							__qFED__: t.__qFED__
						}), t.__qFED__ && t.__qFED__.id && (c = t.__qFED__.id, t.type = "GET"), r = "http://fe.2b6.me:3000/service/api/" + c, l = "jsonp", api = null
					}
					var d = e.ajax({
						type: t.type || "POST",
						url: r,
						dataType: l,
						data: s,
						cache: t.cache || !1,
						success: function(e) {
							n ? (i = new Date - n, setTimeout(function() {
								a.call(null, e)
							}, i > t.minResponseTime ? 0 : t.minResponseTime - i)) : a.call(null, e), n = i = null
						},
						error: function(e, n) {
							t.onError && t.onError({
								error_code: -1,
								__server_error__: !0,
								__server_status__: d.statusText,
								result: "error",
								data: {
									msg: n || {}
								}
							})
						}
					});
					return d
				},
				runOneInPeriodOfTime: function(e, t) {
					var n;
					return function(i, a, o, r, s) {
						window.clearTimeout(n), n = window.setTimeout(function() {
							e(i, a, o, r, s)
						}, t || 300)
					}
				},
				isLogin: function() {
					return !(!window.QYER || !window.QYER.uid)
				},
				doLogin: function(e) {
					window.qyerUtil.isLogin() || requirejs(["web_ct_logindialog"], function(t) {
						t.show(e)
					})
				},
				doSignin: function(t) {
					requirejs(["web_ct_logindialog"], function(n) {
						n.show(e.extend({}, {
							page: "regist"
						}, t))
					})
				},
				getUrlParam: function(e, t) {
					var n, i = new RegExp("(^|&)" + e + "=([^&]*)(&|$)");
					if (t) {
						-1 != t.indexOf("?") && (n = t.substr(t.indexOf("?") + 1))
					} else n = window.location.search.substr(1); if (!n) return null;
					var a = n.match(i);
					return null != a ? unescape(a[2]) : null
				},
				spam_text_filter: function() {
					var t, n, i, a, o;
					t = /(http:\/\/)?[\w\.]*\.?(mafengwo\.cn|mafengwo\.com|mafengwo\.net)[a-zA-Z\/0-9&\?\.#\-_]*/gim, o = e(".qyer_spam_text_filter"), o.find("a").each(function() {
						n = e(this), (-1 != (n.html() + n.attr("href")).indexOf("mafengwo.cn") || -1 != (n.html() + n.attr("href")).indexOf("mafengwo.com") || -1 != (n.html() + n.attr("href")).indexOf("mafengwo.net")) && n.replaceWith(e(this).html())
					}), o.each(function() {
						if (n = e(this), i = n.html().replace(/\<script.*?\>document\.write\(AC_FL_RunContent.*?\<\/script\>/gim, ""), null != (a = i.match(/\<img[\s\S]*?\>/gim)))
							for (var o = 0; o < a.length; o++) i = i.replace(a[o], "[imgimg]" + o + "[/imgimg]");
						if (i = i.replace(t, ""), null != a)
							for (var o = 0; o < a.length; o++) i = i.replace("[imgimg]" + o + "[/imgimg]", a[o]);
						n.html(i)
					}), t = n = i = a = o = null
				},
				openUrl: function(t) {
					var n = e('<form action="' + t + '" target="_blank" method="get"></form>');
					n.appendTo(document.body), n.submit(), setTimeout(function() {
						n.remove(), n = null
					}, 8e3)
				}
			}
		}(),
		function() {
			function e(e, t) {
				for (var n in t) e[n] = t[n]
			}
			e(Date.prototype, {
				qGetWeekStr: function() {
					return "星期" + ["日", "一", "二", "三", "四", "五", "六"][this.getDay()]
				},
				qAddDate: function(e) {
					return this.setDate(this.getDate() + e), this
				},
				qToString: function(e) {
					return [this.getFullYear(), this.getMonth() + 1, this.getDate()].join(e || "-")
				}
			}), e(String.prototype, {
				qToDate: function(e) {
					var t = this.split(e || "-");
					t = [0 | t[0], (0 | t[1]) - 1, 0 | t[2]];
					var n = new Date(t[0], t[1], t[2]);
					return t.length = 0, t = null, n
				},
				qToIntFixed: function() {
					var e = 0 | this;
					return 10 > e ? "0" + e : e.toString()
				},
				qToHTML: function() {
					return this.replace(/</gi, "&lt;").replace(/>/gi, "&gt;").replace(/\n/gi, "<br />").replace(/\t/gi, "&nbsp;&nbsp;&nbsp;&nbsp;")
				}
			})
		}()
	}(), $(function() {
		qyerUtil.init()
	}),
	function(e, t) {
		function n(t, n) {
			var a, o, r, s = t.nodeName.toLowerCase();
			return "area" === s ? (a = t.parentNode, o = a.name, !(!t.href || !o || "map" !== a.nodeName.toLowerCase()) && (!!(r = e("img[usemap=#" + o + "]")[0]) && i(r))) : (/input|select|textarea|button|object/.test(s) ? !t.disabled : "a" === s ? t.href || n : n) && i(t)
		}

		function i(t) {
			return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function() {
				return "hidden" === e.css(this, "visibility")
			}).length
		}
		var a = 0,
			o = /^ui-id-\d+$/;
		e.ui = e.ui || {}, e.extend(e.ui, {
			version: "1.10.3",
			keyCode: {
				BACKSPACE: 8,
				COMMA: 188,
				DELETE: 46,
				DOWN: 40,
				END: 35,
				ENTER: 13,
				ESCAPE: 27,
				HOME: 36,
				LEFT: 37,
				NUMPAD_ADD: 107,
				NUMPAD_DECIMAL: 110,
				NUMPAD_DIVIDE: 111,
				NUMPAD_ENTER: 108,
				NUMPAD_MULTIPLY: 106,
				NUMPAD_SUBTRACT: 109,
				PAGE_DOWN: 34,
				PAGE_UP: 33,
				PERIOD: 190,
				RIGHT: 39,
				SPACE: 32,
				TAB: 9,
				UP: 38
			}
		}), e.fn.extend({
			focus: function(t) {
				return function(n, i) {
					return "number" == typeof n ? this.each(function() {
						var t = this;
						setTimeout(function() {
							e(t).focus(), i && i.call(t)
						}, n)
					}) : t.apply(this, arguments)
				}
			}(e.fn.focus),
			scrollParent: function() {
				var t;
				return t = e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function() {
					return /(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
				}).eq(0) : this.parents().filter(function() {
					return /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
				}).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
			},
			zIndex: function(n) {
				if (n !== t) return this.css("zIndex", n);
				if (this.length)
					for (var i, a, o = e(this[0]); o.length && o[0] !== document;) {
						if (("absolute" === (i = o.css("position")) || "relative" === i || "fixed" === i) && (a = parseInt(o.css("zIndex"), 10), !isNaN(a) && 0 !== a)) return a;
						o = o.parent()
					}
				return 0
			},
			uniqueId: function() {
				return this.each(function() {
					this.id || (this.id = "ui-id-" + ++a)
				})
			},
			removeUniqueId: function() {
				return this.each(function() {
					o.test(this.id) && e(this).removeAttr("id")
				})
			}
		}), e.extend(e.expr[":"], {
			data: e.expr.createPseudo ? e.expr.createPseudo(function(t) {
				return function(n) {
					return !!e.data(n, t)
				}
			}) : function(t, n, i) {
				return !!e.data(t, i[3])
			},
			focusable: function(t) {
				return n(t, !isNaN(e.attr(t, "tabindex")))
			},
			tabbable: function(t) {
				var i = e.attr(t, "tabindex"),
					a = isNaN(i);
				return (a || i >= 0) && n(t, !a)
			}
		}), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function(n, i) {
			function a(t, n, i, a) {
				return e.each(o, function() {
					n -= parseFloat(e.css(t, "padding" + this)) || 0, i && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0), a && (n -= parseFloat(e.css(t, "margin" + this)) || 0)
				}), n
			}
			var o = "Width" === i ? ["Left", "Right"] : ["Top", "Bottom"],
				r = i.toLowerCase(),
				s = {
					innerWidth: e.fn.innerWidth,
					innerHeight: e.fn.innerHeight,
					outerWidth: e.fn.outerWidth,
					outerHeight: e.fn.outerHeight
				};
			e.fn["inner" + i] = function(n) {
				return n === t ? s["inner" + i].call(this) : this.each(function() {
					e(this).css(r, a(this, n) + "px")
				})
			}, e.fn["outer" + i] = function(t, n) {
				return "number" != typeof t ? s["outer" + i].call(this, t) : this.each(function() {
					e(this).css(r, a(this, t, !0, n) + "px")
				})
			}
		}), e.fn.addBack || (e.fn.addBack = function(e) {
			return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
		}), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
			return function(n) {
				return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this)
			}
		}(e.fn.removeData)), e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), e.support.selectstart = "onselectstart" in document.createElement("div"), e.fn.extend({
			disableSelection: function() {
				return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(e) {
					e.preventDefault()
				})
			},
			enableSelection: function() {
				return this.unbind(".ui-disableSelection")
			}
		}), e.extend(e.ui, {
			plugin: {
				add: function(t, n, i) {
					var a, o = e.ui[t].prototype;
					for (a in i) o.plugins[a] = o.plugins[a] || [], o.plugins[a].push([n, i[a]])
				},
				call: function(e, t, n) {
					var i, a = e.plugins[t];
					if (a && e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType)
						for (i = 0; a.length > i; i++) e.options[a[i][0]] && a[i][1].apply(e.element, n)
				}
			},
			hasScroll: function(t, n) {
				if ("hidden" === e(t).css("overflow")) return !1;
				var i = n && "left" === n ? "scrollLeft" : "scrollTop",
					a = !1;
				return t[i] > 0 || (t[i] = 1, a = t[i] > 0, t[i] = 0, a)
			}
		})
	}(jQuery),
	function(e) {
		"use strict";
		! function(e) {
			function t(t) {
				var n = t.data;
				t.isDefaultPrevented() || (t.preventDefault(), e(t.target).ajaxSubmit(n))
			}

			function n(t) {
				var n = t.target,
					i = e(n);
				if (!i.is("[type=submit],[type=image]")) {
					var a = i.closest("[type=submit]");
					if (0 === a.length) return;
					n = a[0]
				}
				var o = this;
				if (o.clk = n, "image" == n.type)
					if (void 0 !== t.offsetX) o.clk_x = t.offsetX, o.clk_y = t.offsetY;
					else if ("function" == typeof e.fn.offset) {
					var r = i.offset();
					o.clk_x = t.pageX - r.left, o.clk_y = t.pageY - r.top
				} else o.clk_x = t.pageX - n.offsetLeft, o.clk_y = t.pageY - n.offsetTop;
				setTimeout(function() {
					o.clk = o.clk_x = o.clk_y = null
				}, 100)
			}

			function i() {
				if (e.fn.ajaxSubmit.debug) {
					var t = "[jquery.form] " + Array.prototype.join.call(arguments, "");
					window.console && window.console.log ? window.console.log(t) : window.opera && window.opera.postError && window.opera.postError(t)
				}
			}
			var a = {};
			a.fileapi = void 0 !== e("<input type='file'/>").get(0).files, a.formdata = void 0 !== window.FormData;
			var o = !!e.fn.prop;
			e.fn.attr2 = function() {
				if (!o) return this.attr.apply(this, arguments);
				var e = this.prop.apply(this, arguments);
				return e && e.jquery || "string" == typeof e ? e : this.attr.apply(this, arguments)
			}, e.fn.ajaxSubmit = function(t) {
				function n(n) {
					var i, a, o = e.param(n, t.traditional).split("&"),
						r = o.length,
						s = [];
					for (i = 0; r > i; i++) o[i] = o[i].replace(/\+/g, " "), a = o[i].split("="), s.push([decodeURIComponent(a[0]), decodeURIComponent(a[1])]);
					return s
				}

				function r(n) {
					function a(e) {
						var t = null;
						try {
							e.contentWindow && (t = e.contentWindow.document)
						} catch (e) {
							i("cannot get iframe.contentWindow document: " + e)
						}
						if (t) return t;
						try {
							t = e.contentDocument ? e.contentDocument : e.document
						} catch (n) {
							i("cannot get iframe.contentDocument: " + n), t = e.document
						}
						return t
					}

					function r() {
						function t() {
							try {
								var e = a(v).readyState;
								i("state = " + e), e && "uninitialized" == e.toLowerCase() && setTimeout(t, 50)
							} catch (e) {
								i("Server abort: ", e, " (", e.name, ")"), l(C), x && clearTimeout(x), x = void 0
							}
						}
						var n = d.attr2("target"),
							o = d.attr2("action"),
							r = d.attr("enctype") || d.attr("encoding") || "multipart/form-data";
						$.setAttribute("target", g), (!s || /post/i.test(s)) && $.setAttribute("method", "POST"), o != p.url && $.setAttribute("action", p.url), p.skipEncodingOverride || s && !/post/i.test(s) || d.attr({
							encoding: "multipart/form-data",
							enctype: "multipart/form-data"
						}), p.timeout && (x = setTimeout(function() {
							w = !0, l(T)
						}, p.timeout));
						var c = [];
						try {
							if (p.extraData)
								for (var u in p.extraData) p.extraData.hasOwnProperty(u) && c.push(e.isPlainObject(p.extraData[u]) && p.extraData[u].hasOwnProperty("name") && p.extraData[u].hasOwnProperty("value") ? e('<input type="hidden" name="' + p.extraData[u].name + '">').val(p.extraData[u].value).appendTo($)[0] : e('<input type="hidden" name="' + u + '">').val(p.extraData[u]).appendTo($)[0]);
							p.iframeTarget || m.appendTo("body"), v.attachEvent ? v.attachEvent("onload", l) : v.addEventListener("load", l, !1), setTimeout(t, 15);
							try {
								$.submit()
							} catch (e) {
								var f = document.createElement("form").submit;
								f.apply($)
							}
						} finally {
							$.setAttribute("action", o), $.setAttribute("enctype", r), n ? $.setAttribute("target", n) : d.removeAttr("target"), e(c).remove()
						}
					}

					function l(t) {
						if (!y.aborted && !E) {
							if (I = a(v), I || (i("cannot access response document"), t = C), t === T && y) return y.abort("timeout"), void k.reject(y, "timeout");
							if (t == C && y) return y.abort("server abort"), void k.reject(y, "error", "server abort");
							if (I && I.location.href != p.iframeSrc || w) {
								v.detachEvent ? v.detachEvent("onload", l) : v.removeEventListener("load", l, !1);
								var n, o = "success";
								try {
									if (w) throw "timeout";
									var r = "xml" == p.dataType || I.XMLDocument || e.isXMLDoc(I);
									if (i("isXml=" + r), !r && window.opera && (null === I.body || !I.body.innerHTML) && --L) return i("requeing onLoad callback, DOM not available"), void setTimeout(l, 250);
									var s = I.body ? I.body : I.documentElement;
									y.responseText = s ? s.innerHTML : null, y.responseXML = I.XMLDocument ? I.XMLDocument : I, r && (p.dataType = "xml"), y.getResponseHeader = function(e) {
										return {
											"content-type": p.dataType
										}[e.toLowerCase()]
									}, s && (y.status = Number(s.getAttribute("status")) || y.status, y.statusText = s.getAttribute("statusText") || y.statusText);
									var c = (p.dataType || "").toLowerCase(),
										d = /(json|script|text)/.test(c);
									if (d || p.textarea) {
										var u = I.getElementsByTagName("textarea")[0];
										if (u) y.responseText = u.value, y.status = Number(u.getAttribute("status")) || y.status, y.statusText = u.getAttribute("statusText") || y.statusText;
										else if (d) {
											var h = I.getElementsByTagName("pre")[0],
												g = I.getElementsByTagName("body")[0];
											h ? y.responseText = h.textContent ? h.textContent : h.innerText : g && (y.responseText = g.textContent ? g.textContent : g.innerText)
										}
									} else "xml" == c && !y.responseXML && y.responseText && (y.responseXML = M(y.responseText));
									try {
										P = O(y, c, p)
									} catch (e) {
										o = "parsererror", y.error = n = e || o
									}
								} catch (e) {
									i("error caught: ", e), o = "error", y.error = n = e || o
								}
								y.aborted && (i("upload aborted"), o = null), y.status && (o = y.status >= 200 && y.status < 300 || 304 === y.status ? "success" : "error"), "success" === o ? (p.success && p.success.call(p.context, P, "success", y), k.resolve(y.responseText, "success", y), f && e.event.trigger("ajaxSuccess", [y, p])) : o && (void 0 === n && (n = y.statusText), p.error && p.error.call(p.context, y, o, n), k.reject(y, "error", n), f && e.event.trigger("ajaxError", [y, p, n])), f && e.event.trigger("ajaxComplete", [y, p]), f && !--e.active && e.event.trigger("ajaxStop"), p.complete && p.complete.call(p.context, y, o), E = !0, p.timeout && clearTimeout(x), setTimeout(function() {
									p.iframeTarget ? m.attr("src", p.iframeSrc) : m.remove(), y.responseXML = null
								}, 100)
							}
						}
					}
					var c, u, p, f, g, m, v, y, b, _, w, x, $ = d[0],
						k = e.Deferred();
					if (k.abort = function(e) {
						y.abort(e)
					}, n)
						for (u = 0; u < h.length; u++) c = e(h[u]), o ? c.prop("disabled", !1) : c.removeAttr("disabled");
					if (p = e.extend(!0, {}, e.ajaxSettings, t), p.context = p.context || p, g = "jqFormIO" + (new Date).getTime(), p.iframeTarget ? (m = e(p.iframeTarget), _ = m.attr2("name"), _ ? g = _ : m.attr2("name", g)) : (m = e('<iframe name="' + g + '" src="' + p.iframeSrc + '" />'), m.css({
						position: "absolute",
						top: "-1000px",
						left: "-1000px"
					})), v = m[0], y = {
						aborted: 0,
						responseText: null,
						responseXML: null,
						status: 0,
						statusText: "n/a",
						getAllResponseHeaders: function() {},
						getResponseHeader: function() {},
						setRequestHeader: function() {},
						abort: function(t) {
							var n = "timeout" === t ? "timeout" : "aborted";
							i("aborting upload... " + n), this.aborted = 1;
							try {
								v.contentWindow.document.execCommand && v.contentWindow.document.execCommand("Stop")
							} catch (e) {}
							m.attr("src", p.iframeSrc), y.error = n, p.error && p.error.call(p.context, y, n, t), f && e.event.trigger("ajaxError", [y, p, n]), p.complete && p.complete.call(p.context, y, n)
						}
					}, f = p.global, f && 0 == e.active++ && e.event.trigger("ajaxStart"), f && e.event.trigger("ajaxSend", [y, p]), p.beforeSend && !1 === p.beforeSend.call(p.context, y, p)) return p.global && e.active--, k.reject(), k;
					if (y.aborted) return k.reject(), k;
					(b = $.clk) && (_ = b.name) && !b.disabled && (p.extraData = p.extraData || {}, p.extraData[_] = b.value, "image" == b.type && (p.extraData[_ + ".x"] = $.clk_x, p.extraData[_ + ".y"] = $.clk_y));
					var T = 1,
						C = 2,
						D = e("meta[name=csrf-token]").attr("content"),
						S = e("meta[name=csrf-param]").attr("content");
					S && D && (p.extraData = p.extraData || {}, p.extraData[S] = D), p.forceSync ? r() : setTimeout(r, 10);
					var P, I, E, L = 50,
						M = e.parseXML || function(e, t) {
							return window.ActiveXObject ? (t = new ActiveXObject("Microsoft.XMLDOM"), t.async = "false", t.loadXML(e)) : t = (new DOMParser).parseFromString(e, "text/xml"), t && t.documentElement && "parsererror" != t.documentElement.nodeName ? t : null
						},
						A = e.parseJSON || function(e) {
							return window.eval("(" + e + ")")
						},
						O = function(t, n, i) {
							var a = t.getResponseHeader("content-type") || "",
								o = "xml" === n || !n && a.indexOf("xml") >= 0,
								r = o ? t.responseXML : t.responseText;
							return o && "parsererror" === r.documentElement.nodeName && e.error && e.error("parsererror"), i && i.dataFilter && (r = i.dataFilter(r, n)), "string" == typeof r && ("json" === n || !n && a.indexOf("json") >= 0 ? r = A(r) : ("script" === n || !n && a.indexOf("javascript") >= 0) && e.globalEval(r)), r
						};
					return k
				}
				if (!this.length) return i("ajaxSubmit: skipping submit process - no element selected"), this;
				var s, l, c, d = this;
				"function" == typeof t ? t = {
					success: t
				} : void 0 === t && (t = {}), s = t.type || this.attr2("method"), l = t.url || this.attr2("action"), c = "string" == typeof l ? e.trim(l) : "", c = c || window.location.href || "", c && (c = (c.match(/^([^#]+)/) || [])[1]), t = e.extend(!0, {
					url: c,
					success: e.ajaxSettings.success,
					type: s || e.ajaxSettings.type,
					iframeSrc: /^https/i.test(window.location.href || "") ? "javascript:false" : "about:blank"
				}, t);
				var u = {};
				if (this.trigger("form-pre-serialize", [this, t, u]), u.veto) return i("ajaxSubmit: submit vetoed via form-pre-serialize trigger"), this;
				if (t.beforeSerialize && !1 === t.beforeSerialize(this, t)) return i("ajaxSubmit: submit aborted via beforeSerialize callback"), this;
				var p = t.traditional;
				void 0 === p && (p = e.ajaxSettings.traditional);
				var f, h = [],
					g = this.formToArray(t.semantic, h);
				if (t.data && (t.extraData = t.data, f = e.param(t.data, p)), t.beforeSubmit && !1 === t.beforeSubmit(g, this, t)) return i("ajaxSubmit: submit aborted via beforeSubmit callback"), this;
				if (this.trigger("form-submit-validate", [g, this, t, u]), u.veto) return i("ajaxSubmit: submit vetoed via form-submit-validate trigger"), this;
				var m = e.param(g, p);
				f && (m = m ? m + "&" + f : f), "GET" == t.type.toUpperCase() ? (t.url += (t.url.indexOf("?") >= 0 ? "&" : "?") + m, t.data = null) : t.data = m;
				var v = [];
				if (t.resetForm && v.push(function() {
					d.resetForm()
				}), t.clearForm && v.push(function() {
					d.clearForm(t.includeHidden)
				}), !t.dataType && t.target) {
					var y = t.success || function() {};
					v.push(function(n) {
						var i = t.replaceTarget ? "replaceWith" : "html";
						e(t.target)[i](n).each(y, arguments)
					})
				} else t.success && v.push(t.success); if (t.success = function(e, n, i) {
					for (var a = t.context || this, o = 0, r = v.length; r > o; o++) v[o].apply(a, [e, n, i || d, d])
				}, t.error) {
					var b = t.error;
					t.error = function(e, n, i) {
						var a = t.context || this;
						b.apply(a, [e, n, i, d])
					}
				}
				if (t.complete) {
					var _ = t.complete;
					t.complete = function(e, n) {
						var i = t.context || this;
						_.apply(i, [e, n, d])
					}
				}
				var w = e("input[type=file]:enabled", this).filter(function() {
						return "" !== e(this).val()
					}),
					x = w.length > 0,
					$ = "multipart/form-data",
					k = d.attr("enctype") == $ || d.attr("encoding") == $,
					T = a.fileapi && a.formdata;
				i("fileAPI :" + T);
				var C, D = (x || k) && !T;
				!1 !== t.iframe && (t.iframe || D) ? t.closeKeepAlive ? e.get(t.closeKeepAlive, function() {
					C = r(g)
				}) : C = r(g) : C = (x || k) && T ? function(i) {
					for (var a = new FormData, o = 0; o < i.length; o++) a.append(i[o].name, i[o].value);
					if (t.extraData) {
						var r = n(t.extraData);
						for (o = 0; o < r.length; o++) r[o] && a.append(r[o][0], r[o][1])
					}
					t.data = null;
					var l = e.extend(!0, {}, e.ajaxSettings, t, {
						contentType: !1,
						processData: !1,
						cache: !1,
						type: s || "POST"
					});
					t.uploadProgress && (l.xhr = function() {
						var n = e.ajaxSettings.xhr();
						return n.upload && n.upload.addEventListener("progress", function(e) {
							var n = 0,
								i = e.loaded || e.position,
								a = e.total;
							e.lengthComputable && (n = Math.ceil(i / a * 100)), t.uploadProgress(e, i, a, n)
						}, !1), n
					}), l.data = null;
					var c = l.beforeSend;
					return l.beforeSend = function(e, n) {
						n.data = t.formData ? t.formData : a, c && c.call(this, e, n)
					}, e.ajax(l)
				}(g) : e.ajax(t), d.removeData("jqxhr").data("jqxhr", C);
				for (var S = 0; S < h.length; S++) h[S] = null;
				return this.trigger("form-submit-notify", [this, t]), this
			}, e.fn.ajaxForm = function(a) {
				if (a = a || {}, a.delegation = a.delegation && e.isFunction(e.fn.on), !a.delegation && 0 === this.length) {
					var o = {
						s: this.selector,
						c: this.context
					};
					return !e.isReady && o.s ? (i("DOM not ready, queuing ajaxForm"), e(function() {
						e(o.s, o.c).ajaxForm(a)
					}), this) : (i("terminating; zero elements found by selector" + (e.isReady ? "" : " (DOM not ready)")), this)
				}
				return a.delegation ? (e(document).off("submit.form-plugin", this.selector, t).off("click.form-plugin", this.selector, n).on("submit.form-plugin", this.selector, a, t).on("click.form-plugin", this.selector, a, n), this) : this.ajaxFormUnbind().bind("submit.form-plugin", a, t).bind("click.form-plugin", a, n)
			}, e.fn.ajaxFormUnbind = function() {
				return this.unbind("submit.form-plugin click.form-plugin")
			}, e.fn.formToArray = function(t, n) {
				var i = [];
				if (0 === this.length) return i;
				var o, r = this[0],
					s = this.attr("id"),
					l = t ? r.getElementsByTagName("*") : r.elements;
				if (l && !/MSIE [678]/.test(navigator.userAgent) && (l = e(l).get()), s && (o = e(':input[form="' + s + '"]').get(), o.length && (l = (l || []).concat(o))), !l || !l.length) return i;
				var c, d, u, p, f, h, g;
				for (c = 0, h = l.length; h > c; c++)
					if (f = l[c], (u = f.name) && !f.disabled)
						if (t && r.clk && "image" == f.type) r.clk == f && (i.push({
							name: u,
							value: e(f).val(),
							type: f.type
						}), i.push({
							name: u + ".x",
							value: r.clk_x
						}, {
							name: u + ".y",
							value: r.clk_y
						}));
						else if ((p = e.fieldValue(f, !0)) && p.constructor == Array)
					for (n && n.push(f), d = 0, g = p.length; g > d; d++) i.push({
						name: u,
						value: p[d]
					});
				else if (a.fileapi && "file" == f.type) {
					n && n.push(f);
					var m = f.files;
					if (m.length)
						for (d = 0; d < m.length; d++) i.push({
							name: u,
							value: m[d],
							type: f.type
						});
					else i.push({
						name: u,
						value: "",
						type: f.type
					})
				} else null !== p && void 0 !== p && (n && n.push(f), i.push({
					name: u,
					value: p,
					type: f.type,
					required: f.required
				})); if (!t && r.clk) {
					var v = e(r.clk),
						y = v[0];
					(u = y.name) && !y.disabled && "image" == y.type && (i.push({
						name: u,
						value: v.val()
					}), i.push({
						name: u + ".x",
						value: r.clk_x
					}, {
						name: u + ".y",
						value: r.clk_y
					}))
				}
				return i
			}, e.fn.formSerialize = function(t) {
				return e.param(this.formToArray(t))
			}, e.fn.fieldSerialize = function(t) {
				var n = [];
				return this.each(function() {
					var i = this.name;
					if (i) {
						var a = e.fieldValue(this, t);
						if (a && a.constructor == Array)
							for (var o = 0, r = a.length; r > o; o++) n.push({
								name: i,
								value: a[o]
							});
						else null !== a && void 0 !== a && n.push({
							name: this.name,
							value: a
						})
					}
				}), e.param(n)
			}, e.fn.fieldValue = function(t) {
				for (var n = [], i = 0, a = this.length; a > i; i++) {
					var o = this[i],
						r = e.fieldValue(o, t);
					null === r || void 0 === r || r.constructor == Array && !r.length || (r.constructor == Array ? e.merge(n, r) : n.push(r))
				}
				return n
			}, e.fieldValue = function(t, n) {
				var i = t.name,
					a = t.type,
					o = t.tagName.toLowerCase();
				if (void 0 === n && (n = !0), n && (!i || t.disabled || "reset" == a || "button" == a || ("checkbox" == a || "radio" == a) && !t.checked || ("submit" == a || "image" == a) && t.form && t.form.clk != t || "select" == o && -1 == t.selectedIndex)) return null;
				if ("select" == o) {
					var r = t.selectedIndex;
					if (0 > r) return null;
					for (var s = [], l = t.options, c = "select-one" == a, d = c ? r + 1 : l.length, u = c ? r : 0; d > u; u++) {
						var p = l[u];
						if (p.selected) {
							var f = p.value;
							if (f || (f = p.attributes && p.attributes.value && !p.attributes.value.specified ? p.text : p.value), c) return f;
							s.push(f)
						}
					}
					return s
				}
				return e(t).val()
			}, e.fn.clearForm = function(t) {
				return this.each(function() {
					e("input,select,textarea", this).clearFields(t)
				})
			}, e.fn.clearFields = e.fn.clearInputs = function(t) {
				var n = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
				return this.each(function() {
					var i = this.type,
						a = this.tagName.toLowerCase();
					n.test(i) || "textarea" == a ? this.value = "" : "checkbox" == i || "radio" == i ? this.checked = !1 : "select" == a ? this.selectedIndex = -1 : "file" == i ? /MSIE/.test(navigator.userAgent) ? e(this).replaceWith(e(this).clone(!0)) : e(this).val("") : t && (!0 === t && /hidden/.test(i) || "string" == typeof t && e(this).is(t)) && (this.value = "")
				})
			}, e.fn.resetForm = function() {
				return this.each(function() {
					("function" == typeof this.reset || "object" == typeof this.reset && !this.reset.nodeType) && this.reset()
				})
			}, e.fn.enable = function(e) {
				return void 0 === e && (e = !0), this.each(function() {
					this.disabled = !e
				})
			}, e.fn.selected = function(t) {
				return void 0 === t && (t = !0), this.each(function() {
					var n = this.type;
					if ("checkbox" == n || "radio" == n) this.checked = t;
					else if ("option" == this.tagName.toLowerCase()) {
						var i = e(this).parent("select");
						t && i[0] && "select-one" == i[0].type && i.find("option").selected(!1), this.selected = t
					}
				})
			}, e.fn.ajaxSubmit.debug = !1
		}("undefined" != typeof jQuery ? jQuery : window.Zepto)
	}(),
	function(e, t) {
		var n = 0,
			i = Array.prototype.slice,
			a = e.cleanData;
		e.cleanData = function(t) {
			for (var n, i = 0; null != (n = t[i]); i++) try {
				e(n).triggerHandler("remove")
			} catch (e) {}
			a(t)
		}, e.widget = function(n, i, a) {
			var o, r, s, l, c = {},
				d = n.split(".")[0];
			n = n.split(".")[1], o = d + "-" + n, a || (a = i, i = e.Widget), e.expr[":"][o.toLowerCase()] = function(t) {
				return !!e.data(t, o)
			}, e[d] = e[d] || {}, r = e[d][n], s = e[d][n] = function(e, n) {
				return this._createWidget ? (arguments.length && this._createWidget(e, n), t) : new s(e, n)
			}, e.extend(s, r, {
				version: a.version,
				_proto: e.extend({}, a),
				_childConstructors: []
			}), l = new i, l.options = e.widget.extend({}, l.options), e.each(a, function(n, a) {
				return e.isFunction(a) ? (c[n] = function() {
					var e = function() {
							return i.prototype[n].apply(this, arguments)
						},
						t = function(e) {
							return i.prototype[n].apply(this, e)
						};
					return function() {
						var n, i = this._super,
							o = this._superApply;
						return this._super = e, this._superApply = t, n = a.apply(this, arguments), this._super = i, this._superApply = o, n
					}
				}(), t) : (c[n] = a, t)
			}), s.prototype = e.widget.extend(l, {
				widgetEventPrefix: r ? l.widgetEventPrefix : n
			}, c, {
				constructor: s,
				namespace: d,
				widgetName: n,
				widgetFullName: o
			}), r ? (e.each(r._childConstructors, function(t, n) {
				var i = n.prototype;
				e.widget(i.namespace + "." + i.widgetName, s, n._proto)
			}), delete r._childConstructors) : i._childConstructors.push(s), e.widget.bridge(n, s)
		}, e.widget.extend = function(n) {
			for (var a, o, r = i.call(arguments, 1), s = 0, l = r.length; l > s; s++)
				for (a in r[s]) o = r[s][a], r[s].hasOwnProperty(a) && o !== t && (n[a] = e.isPlainObject(o) ? e.isPlainObject(n[a]) ? e.widget.extend({}, n[a], o) : e.widget.extend({}, o) : o);
			return n
		}, e.widget.bridge = function(n, a) {
			var o = a.prototype.widgetFullName || n;
			e.fn[n] = function(r) {
				var s = "string" == typeof r,
					l = i.call(arguments, 1),
					c = this;
				return r = !s && l.length ? e.widget.extend.apply(null, [r].concat(l)) : r, s ? this.each(function() {
					var i, a = e.data(this, o);
					return a ? e.isFunction(a[r]) && "_" !== r.charAt(0) ? (i = a[r].apply(a, l), i !== a && i !== t ? (c = i && i.jquery ? c.pushStack(i.get()) : i, !1) : t) : e.error("no such method '" + r + "' for " + n + " widget instance") : e.error("cannot call methods on " + n + " prior to initialization; attempted to call method '" + r + "'")
				}) : this.each(function() {
					var t = e.data(this, o);
					t ? t.option(r || {})._init() : e.data(this, o, new a(r, this))
				}), c
			}
		}, e.Widget = function() {}, e.Widget._childConstructors = [], e.Widget.prototype = {
			widgetName: "widget",
			widgetEventPrefix: "",
			defaultElement: "<div>",
			options: {
				disabled: !1,
				create: null
			},
			_createWidget: function(t, i) {
				i = e(i || this.defaultElement || this)[0], this.element = e(i), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), i !== this && (e.data(i, this.widgetFullName, this), this._on(!0, this.element, {
					remove: function(e) {
						e.target === i && this.destroy()
					}
				}), this.document = e(i.style ? i.ownerDocument : i.document || i), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
			},
			_getCreateOptions: e.noop,
			_getCreateEventData: e.noop,
			_create: e.noop,
			_init: e.noop,
			destroy: function() {
				this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
			},
			_destroy: e.noop,
			widget: function() {
				return this.element
			},
			option: function(n, i) {
				var a, o, r, s = n;
				if (0 === arguments.length) return e.widget.extend({}, this.options);
				if ("string" == typeof n)
					if (s = {}, a = n.split("."), n = a.shift(), a.length) {
						for (o = s[n] = e.widget.extend({}, this.options[n]), r = 0; a.length - 1 > r; r++) o[a[r]] = o[a[r]] || {}, o = o[a[r]];
						if (n = a.pop(), i === t) return o[n] === t ? null : o[n];
						o[n] = i
					} else {
						if (i === t) return this.options[n] === t ? null : this.options[n];
						s[n] = i
					}
				return this._setOptions(s), this
			},
			_setOptions: function(e) {
				var t;
				for (t in e) this._setOption(t, e[t]);
				return this
			},
			_setOption: function(e, t) {
				return this.options[e] = t, "disabled" === e && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
			},
			enable: function() {
				return this._setOption("disabled", !1)
			},
			disable: function() {
				return this._setOption("disabled", !0)
			},
			_on: function(n, i, a) {
				var o, r = this;
				"boolean" != typeof n && (a = i, i = n, n = !1), a ? (i = o = e(i), this.bindings = this.bindings.add(i)) : (a = i, i = this.element, o = this.widget()), e.each(a, function(a, s) {
					function l() {
						return n || !0 !== r.options.disabled && !e(this).hasClass("ui-state-disabled") ? ("string" == typeof s ? r[s] : s).apply(r, arguments) : t
					}
					"string" != typeof s && (l.guid = s.guid = s.guid || l.guid || e.guid++);
					var c = a.match(/^(\w+)\s*(.*)$/),
						d = c[1] + r.eventNamespace,
						u = c[2];
					u ? o.delegate(u, d, l) : i.bind(d, l)
				})
			},
			_off: function(e, t) {
				t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
			},
			_delay: function(e, t) {
				function n() {
					return ("string" == typeof e ? i[e] : e).apply(i, arguments)
				}
				var i = this;
				return setTimeout(n, t || 0)
			},
			_hoverable: function(t) {
				this.hoverable = this.hoverable.add(t), this._on(t, {
					mouseenter: function(t) {
						e(t.currentTarget).addClass("ui-state-hover")
					},
					mouseleave: function(t) {
						e(t.currentTarget).removeClass("ui-state-hover")
					}
				})
			},
			_focusable: function(t) {
				this.focusable = this.focusable.add(t), this._on(t, {
					focusin: function(t) {
						e(t.currentTarget).addClass("ui-state-focus")
					},
					focusout: function(t) {
						e(t.currentTarget).removeClass("ui-state-focus")
					}
				})
			},
			_trigger: function(t, n, i) {
				var a, o, r = this.options[t];
				if (i = i || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], o = n.originalEvent)
					for (a in o) a in n || (n[a] = o[a]);
				return this.element.trigger(n, i), !(e.isFunction(r) && !1 === r.apply(this.element[0], [n].concat(i)) || n.isDefaultPrevented())
			}
		}, e.each({
			show: "fadeIn",
			hide: "fadeOut"
		}, function(t, n) {
			e.Widget.prototype["_" + t] = function(i, a, o) {
				"string" == typeof a && (a = {
					effect: a
				});
				var r, s = a ? !0 === a || "number" == typeof a ? n : a.effect || n : t;
				a = a || {}, "number" == typeof a && (a = {
					duration: a
				}), r = !e.isEmptyObject(a), a.complete = o, a.delay && i.delay(a.delay), r && e.effects && e.effects.effect[s] ? i[t](a) : s !== t && i[s] ? i[s](a.duration, a.easing, o) : i.queue(function(n) {
					e(this)[t](), o && o.call(i[0]), n()
				})
			}
		})
	}(jQuery),
	function(e) {
		var t = !1;
		e(document).mouseup(function() {
			t = !1
		}), e.widget("ui.mouse", {
			version: "1.10.3",
			options: {
				cancel: "input,textarea,button,select,option",
				distance: 1,
				delay: 0
			},
			_mouseInit: function() {
				var t = this;
				this.element.bind("mousedown." + this.widgetName, function(e) {
					return t._mouseDown(e)
				}).bind("click." + this.widgetName, function(n) {
					return !0 === e.data(n.target, t.widgetName + ".preventClickEvent") ? (e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1) : void 0
				}), this.started = !1
			},
			_mouseDestroy: function() {
				this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
			},
			_mouseDown: function(n) {
				if (!t) {
					this._mouseStarted && this._mouseUp(n), this._mouseDownEvent = n;
					var i = this,
						a = 1 === n.which,
						o = !("string" != typeof this.options.cancel || !n.target.nodeName) && e(n.target).closest(this.options.cancel).length;
					return !(a && !o && this._mouseCapture(n)) || (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
						i.mouseDelayMet = !0
					}, this.options.delay)), this._mouseDistanceMet(n) && this._mouseDelayMet(n) && (this._mouseStarted = !1 !== this._mouseStart(n), !this._mouseStarted) ? (n.preventDefault(), !0) : (!0 === e.data(n.target, this.widgetName + ".preventClickEvent") && e.removeData(n.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
						return i._mouseMove(e)
					}, this._mouseUpDelegate = function(e) {
						return i._mouseUp(e)
					}, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), n.preventDefault(), t = !0, !0))
				}
			},
			_mouseMove: function(t) {
				return e.ui.ie && (!document.documentMode || 9 > document.documentMode) && !t.button ? this._mouseUp(t) : this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = !1 !== this._mouseStart(this._mouseDownEvent, t), this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted)
			},
			_mouseUp: function(t) {
				return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
			},
			_mouseDistanceMet: function(e) {
				return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
			},
			_mouseDelayMet: function() {
				return this.mouseDelayMet
			},
			_mouseStart: function() {},
			_mouseDrag: function() {},
			_mouseStop: function() {},
			_mouseCapture: function() {
				return !0
			}
		})
	}(jQuery),
	function(e) {
		function t(e, t) {
			if (!(e.originalEvent.touches.length > 1)) {
				e.preventDefault();
				var n = e.originalEvent.changedTouches[0],
					i = document.createEvent("MouseEvents");
				i.initMouseEvent(t, !0, !0, window, 1, n.screenX, n.screenY, n.clientX, n.clientY, !1, !1, !1, !1, 0, null), e.target.dispatchEvent(i)
			}
		}
		if (e.support.touch = "ontouchend" in document, e.support.touch) {
			var n, i = e.ui.mouse.prototype,
				a = i._mouseInit,
				o = i._mouseDestroy;
			i._touchStart = function(e) {
				var i = this;
				!n && i._mouseCapture(e.originalEvent.changedTouches[0]) && (n = !0, i._touchMoved = !1, t(e, "mouseover"), t(e, "mousemove"), t(e, "mousedown"))
			}, i._touchMove = function(e) {
				n && (this._touchMoved = !0, t(e, "mousemove"))
			}, i._touchEnd = function(e) {
				n && (t(e, "mouseup"), t(e, "mouseout"), this._touchMoved || t(e, "click"), n = !1)
			}, i._mouseInit = function() {
				var t = this;
				t.element.bind({
					touchstart: e.proxy(t, "_touchStart"),
					touchmove: e.proxy(t, "_touchMove"),
					touchend: e.proxy(t, "_touchEnd")
				}), a.call(t)
			}, i._mouseDestroy = function() {
				var t = this;
				t.element.unbind({
					touchstart: e.proxy(t, "_touchStart"),
					touchmove: e.proxy(t, "_touchMove"),
					touchend: e.proxy(t, "_touchEnd")
				}), o.call(t)
			}
		}
	}(jQuery),
	function(e) {
		function t(e, t, n) {
			return e > t && t + n > e
		}

		function n(e) {
			return /left|right/.test(e.css("float")) || /inline|table-cell/.test(e.css("display"))
		}
		e.widget("ui.sortable", e.ui.mouse, {
			version: "1.10.3",
			widgetEventPrefix: "sort",
			ready: !1,
			options: {
				appendTo: "parent",
				axis: !1,
				connectWith: !1,
				containment: !1,
				cursor: "auto",
				cursorAt: !1,
				dropOnEmpty: !0,
				forcePlaceholderSize: !1,
				forceHelperSize: !1,
				grid: !1,
				handle: !1,
				helper: "original",
				items: "> *",
				opacity: !1,
				placeholder: !1,
				revert: !1,
				scroll: !0,
				scrollSensitivity: 20,
				scrollSpeed: 20,
				scope: "default",
				tolerance: "intersect",
				zIndex: 1e3,
				activate: null,
				beforeStop: null,
				change: null,
				deactivate: null,
				out: null,
				over: null,
				receive: null,
				remove: null,
				sort: null,
				start: null,
				stop: null,
				update: null
			},
			_create: function() {
				var e = this.options;
				this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = !!this.items.length && ("x" === e.axis || n(this.items[0].item)), this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
			},
			_destroy: function() {
				this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
				for (var e = this.items.length - 1; e >= 0; e--) this.items[e].item.removeData(this.widgetName + "-item");
				return this
			},
			_setOption: function(t, n) {
				"disabled" === t ? (this.options[t] = n, this.widget().toggleClass("ui-sortable-disabled", !!n)) : e.Widget.prototype._setOption.apply(this, arguments)
			},
			_mouseCapture: function(t, n) {
				var i = null,
					a = !1,
					o = this;
				return !this.reverting && (!this.options.disabled && "static" !== this.options.type && (this._refreshItems(t), e(t.target).parents().each(function() {
					return e.data(this, o.widgetName + "-item") === o ? (i = e(this), !1) : void 0
				}), e.data(t.target, o.widgetName + "-item") === o && (i = e(t.target)), !!i && (!(this.options.handle && !n && (e(this.options.handle, i).find("*").addBack().each(function() {
					this === t.target && (a = !0)
				}), !a)) && (this.currentItem = i, this._removeCurrentsFromItems(), !0))))
			},
			_mouseStart: function(t, n, i) {
				var a, o, r = this.options;
				if (this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
					top: this.offset.top - this.margins.top,
					left: this.offset.left - this.margins.left
				}, e.extend(this.offset, {
					click: {
						left: t.pageX - this.offset.left,
						top: t.pageY - this.offset.top
					},
					parent: this._getParentOffset(),
					relative: this._getRelativeOffset()
				}), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, r.cursorAt && this._adjustOffsetFromHelper(r.cursorAt), this.domPosition = {
					prev: this.currentItem.prev()[0],
					parent: this.currentItem.parent()[0]
				}, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), r.containment && this._setContainment(), r.cursor && "auto" !== r.cursor && (o = this.document.find("body"), this.storedCursor = o.css("cursor"), o.css("cursor", r.cursor), this.storedStylesheet = e("<style>*{ cursor: " + r.cursor + " !important; }</style>").appendTo(o)), r.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", r.opacity)), r.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", r.zIndex)), this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !i)
					for (a = this.containers.length - 1; a >= 0; a--) this.containers[a]._trigger("activate", t, this._uiHash(this));
				return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !r.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
			},
			_mouseDrag: function(t) {
				var n, i, a, o, r = this.options,
					s = !1;
				for (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < r.scrollSensitivity ? this.scrollParent[0].scrollTop = s = this.scrollParent[0].scrollTop + r.scrollSpeed : t.pageY - this.overflowOffset.top < r.scrollSensitivity && (this.scrollParent[0].scrollTop = s = this.scrollParent[0].scrollTop - r.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < r.scrollSensitivity ? this.scrollParent[0].scrollLeft = s = this.scrollParent[0].scrollLeft + r.scrollSpeed : t.pageX - this.overflowOffset.left < r.scrollSensitivity && (this.scrollParent[0].scrollLeft = s = this.scrollParent[0].scrollLeft - r.scrollSpeed)) : (t.pageY - e(document).scrollTop() < r.scrollSensitivity ? s = e(document).scrollTop(e(document).scrollTop() - r.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < r.scrollSensitivity && (s = e(document).scrollTop(e(document).scrollTop() + r.scrollSpeed)), t.pageX - e(document).scrollLeft() < r.scrollSensitivity ? s = e(document).scrollLeft(e(document).scrollLeft() - r.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < r.scrollSensitivity && (s = e(document).scrollLeft(e(document).scrollLeft() + r.scrollSpeed))), !1 !== s && e.ui.ddmanager && !r.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), n = this.items.length - 1; n >= 0; n--)
					if (i = this.items[n], a = i.item[0], (o = this._intersectsWithPointer(i)) && i.instance === this.currentContainer && a !== this.currentItem[0] && this.placeholder[1 === o ? "next" : "prev"]()[0] !== a && !e.contains(this.placeholder[0], a) && ("semi-dynamic" !== this.options.type || !e.contains(this.element[0], a))) {
						if (this.direction = 1 === o ? "down" : "up", "pointer" !== this.options.tolerance && !this._intersectsWithSides(i)) break;
						this._rearrange(t, i), this._trigger("change", t, this._uiHash());
						break
					}
				return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
			},
			_mouseStop: function(t, n) {
				if (t) {
					if (e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t), this.options.revert) {
						var i = this,
							a = this.placeholder.offset(),
							o = this.options.axis,
							r = {};
						o && "x" !== o || (r.left = a.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft)), o && "y" !== o || (r.top = a.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)), this.reverting = !0, e(this.helper).animate(r, parseInt(this.options.revert, 10) || 500, function() {
							i._clear(t)
						})
					} else this._clear(t, n);
					return !1
				}
			},
			cancel: function() {
				if (this.dragging) {
					this._mouseUp({
						target: null
					}), "original" === this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
					for (var t = this.containers.length - 1; t >= 0; t--) this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
				}
				return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" !== this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {
					helper: null,
					dragging: !1,
					reverting: !1,
					_noFinalSort: null
				}), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
			},
			serialize: function(t) {
				var n = this._getItemsAsjQuery(t && t.connected),
					i = [];
				return t = t || {}, e(n).each(function() {
					var n = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[\-=_](.+)/);
					n && i.push((t.key || n[1] + "[]") + "=" + (t.key && t.expression ? n[1] : n[2]))
				}), !i.length && t.key && i.push(t.key + "="), i.join("&")
			},
			toArray: function(t) {
				var n = this._getItemsAsjQuery(t && t.connected),
					i = [];
				return t = t || {}, n.each(function() {
					i.push(e(t.item || this).attr(t.attribute || "id") || "")
				}), i
			},
			_intersectsWith: function(e) {
				var t = this.positionAbs.left,
					n = t + this.helperProportions.width,
					i = this.positionAbs.top,
					a = i + this.helperProportions.height,
					o = e.left,
					r = o + e.width,
					s = e.top,
					l = s + e.height,
					c = this.offset.click.top,
					d = this.offset.click.left,
					u = "x" === this.options.axis || i + c > s && l > i + c,
					p = "y" === this.options.axis || t + d > o && r > t + d,
					f = u && p;
				return "pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? f : t + this.helperProportions.width / 2 > o && r > n - this.helperProportions.width / 2 && i + this.helperProportions.height / 2 > s && l > a - this.helperProportions.height / 2
			},
			_intersectsWithPointer: function(e) {
				var n = "x" === this.options.axis || t(this.positionAbs.top + this.offset.click.top, e.top, e.height),
					i = "y" === this.options.axis || t(this.positionAbs.left + this.offset.click.left, e.left, e.width),
					a = n && i,
					o = this._getDragVerticalDirection(),
					r = this._getDragHorizontalDirection();
				return !!a && (this.floating ? r && "right" === r || "down" === o ? 2 : 1 : o && ("down" === o ? 2 : 1))
			},
			_intersectsWithSides: function(e) {
				var n = t(this.positionAbs.top + this.offset.click.top, e.top + e.height / 2, e.height),
					i = t(this.positionAbs.left + this.offset.click.left, e.left + e.width / 2, e.width),
					a = this._getDragVerticalDirection(),
					o = this._getDragHorizontalDirection();
				return this.floating && o ? "right" === o && i || "left" === o && !i : a && ("down" === a && n || "up" === a && !n)
			},
			_getDragVerticalDirection: function() {
				var e = this.positionAbs.top - this.lastPositionAbs.top;
				return 0 !== e && (e > 0 ? "down" : "up")
			},
			_getDragHorizontalDirection: function() {
				var e = this.positionAbs.left - this.lastPositionAbs.left;
				return 0 !== e && (e > 0 ? "right" : "left")
			},
			refresh: function(e) {
				return this._refreshItems(e), this.refreshPositions(), this
			},
			_connectWith: function() {
				var e = this.options;
				return e.connectWith.constructor === String ? [e.connectWith] : e.connectWith
			},
			_getItemsAsjQuery: function(t) {
				var n, i, a, o, r = [],
					s = [],
					l = this._connectWith();
				if (l && t)
					for (n = l.length - 1; n >= 0; n--)
						for (a = e(l[n]), i = a.length - 1; i >= 0; i--)(o = e.data(a[i], this.widgetFullName)) && o !== this && !o.options.disabled && s.push([e.isFunction(o.options.items) ? o.options.items.call(o.element) : e(o.options.items, o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), o]);
				for (s.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
					options: this.options,
					item: this.currentItem
				}) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]), n = s.length - 1; n >= 0; n--) s[n][0].each(function() {
					r.push(this)
				});
				return e(r)
			},
			_removeCurrentsFromItems: function() {
				var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
				this.items = e.grep(this.items, function(e) {
					for (var n = 0; t.length > n; n++)
						if (t[n] === e.item[0]) return !1;
					return !0
				})
			},
			_refreshItems: function(t) {
				this.items = [], this.containers = [this];
				var n, i, a, o, r, s, l, c, d = this.items,
					u = [
						[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {
							item: this.currentItem
						}) : e(this.options.items, this.element), this]
					],
					p = this._connectWith();
				if (p && this.ready)
					for (n = p.length - 1; n >= 0; n--)
						for (a = e(p[n]), i = a.length - 1; i >= 0; i--)(o = e.data(a[i], this.widgetFullName)) && o !== this && !o.options.disabled && (u.push([e.isFunction(o.options.items) ? o.options.items.call(o.element[0], t, {
							item: this.currentItem
						}) : e(o.options.items, o.element), o]), this.containers.push(o));
				for (n = u.length - 1; n >= 0; n--)
					for (r = u[n][1], s = u[n][0], i = 0, c = s.length; c > i; i++) l = e(s[i]), l.data(this.widgetName + "-item", r), d.push({
						item: l,
						instance: r,
						width: 0,
						height: 0,
						left: 0,
						top: 0
					})
			},
			refreshPositions: function(t) {
				this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
				var n, i, a, o;
				for (n = this.items.length - 1; n >= 0; n--) i = this.items[n], i.instance !== this.currentContainer && this.currentContainer && i.item[0] !== this.currentItem[0] || (a = this.options.toleranceElement ? e(this.options.toleranceElement, i.item) : i.item, t || (i.width = a.outerWidth(), i.height = a.outerHeight()), o = a.offset(), i.left = o.left, i.top = o.top);
				if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this);
				else
					for (n = this.containers.length - 1; n >= 0; n--) o = this.containers[n].element.offset(), this.containers[n].containerCache.left = o.left, this.containers[n].containerCache.top = o.top, this.containers[n].containerCache.width = this.containers[n].element.outerWidth(), this.containers[n].containerCache.height = this.containers[n].element.outerHeight();
				return this
			},
			_createPlaceholder: function(t) {
				t = t || this;
				var n, i = t.options;
				i.placeholder && i.placeholder.constructor !== String || (n = i.placeholder, i.placeholder = {
					element: function() {
						var i = t.currentItem[0].nodeName.toLowerCase(),
							a = e("<" + i + ">", t.document[0]).addClass(n || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper");
						return "tr" === i ? t.currentItem.children().each(function() {
							e("<td>&#160;</td>", t.document[0]).attr("colspan", e(this).attr("colspan") || 1).appendTo(a)
						}) : "img" === i && a.attr("src", t.currentItem.attr("src")), n || a.css("visibility", "hidden"), a
					},
					update: function(e, a) {
						(!n || i.forcePlaceholderSize) && (a.height() || a.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), a.width() || a.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10)))
					}
				}), t.placeholder = e(i.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), i.placeholder.update(t, t.placeholder)
			},
			_contactContainers: function(i) {
				var a, o, r, s, l, c, d, u, p, f, h = null,
					g = null;
				for (a = this.containers.length - 1; a >= 0; a--)
					if (!e.contains(this.currentItem[0], this.containers[a].element[0]))
						if (this._intersectsWith(this.containers[a].containerCache)) {
							if (h && e.contains(this.containers[a].element[0], h.element[0])) continue;
							h = this.containers[a], g = a
						} else this.containers[a].containerCache.over && (this.containers[a]._trigger("out", i, this._uiHash(this)), this.containers[a].containerCache.over = 0);
				if (h)
					if (1 === this.containers.length) this.containers[g].containerCache.over || (this.containers[g]._trigger("over", i, this._uiHash(this)), this.containers[g].containerCache.over = 1);
					else {
						for (r = 1e4, s = null, f = h.floating || n(this.currentItem), l = f ? "left" : "top", c = f ? "width" : "height", d = this.positionAbs[l] + this.offset.click[l], o = this.items.length - 1; o >= 0; o--) e.contains(this.containers[g].element[0], this.items[o].item[0]) && this.items[o].item[0] !== this.currentItem[0] && (!f || t(this.positionAbs.top + this.offset.click.top, this.items[o].top, this.items[o].height)) && (u = this.items[o].item.offset()[l], p = !1, Math.abs(u - d) > Math.abs(u + this.items[o][c] - d) && (p = !0, u += this.items[o][c]), r > Math.abs(u - d) && (r = Math.abs(u - d), s = this.items[o], this.direction = p ? "up" : "down"));
						if (!s && !this.options.dropOnEmpty) return;
						if (this.currentContainer === this.containers[g]) return;
						s ? this._rearrange(i, s, null, !0) : this._rearrange(i, null, this.containers[g].element, !0), this._trigger("change", i, this._uiHash()), this.containers[g]._trigger("change", i, this._uiHash(this)), this.currentContainer = this.containers[g], this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[g]._trigger("over", i, this._uiHash(this)), this.containers[g].containerCache.over = 1
					}
			},
			_createHelper: function(t) {
				var n = this.options,
					i = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t, this.currentItem])) : "clone" === n.helper ? this.currentItem.clone() : this.currentItem;
				return i.parents("body").length || e("parent" !== n.appendTo ? n.appendTo : this.currentItem[0].parentNode)[0].appendChild(i[0]), i[0] === this.currentItem[0] && (this._storedCSS = {
					width: this.currentItem[0].style.width,
					height: this.currentItem[0].style.height,
					position: this.currentItem.css("position"),
					top: this.currentItem.css("top"),
					left: this.currentItem.css("left")
				}), (!i[0].style.width || n.forceHelperSize) && i.width(this.currentItem.width()), (!i[0].style.height || n.forceHelperSize) && i.height(this.currentItem.height()), i
			},
			_adjustOffsetFromHelper: function(t) {
				"string" == typeof t && (t = t.split(" ")), e.isArray(t) && (t = {
					left: +t[0],
					top: +t[1] || 0
				}), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
			},
			_getParentOffset: function() {
				this.offsetParent = this.helper.offsetParent();
				var t = this.offsetParent.offset();
				return "absolute" === this.cssPosition && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && e.ui.ie) && (t = {
					top: 0,
					left: 0
				}), {
					top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
					left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
				}
			},
			_getRelativeOffset: function() {
				if ("relative" === this.cssPosition) {
					var e = this.currentItem.position();
					return {
						top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
						left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
					}
				}
				return {
					top: 0,
					left: 0
				}
			},
			_cacheMargins: function() {
				this.margins = {
					left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
					top: parseInt(this.currentItem.css("marginTop"), 10) || 0
				}
			},
			_cacheHelperProportions: function() {
				this.helperProportions = {
					width: this.helper.outerWidth(),
					height: this.helper.outerHeight()
				}
			},
			_setContainment: function() {
				var t, n, i, a = this.options;
				"parent" === a.containment && (a.containment = this.helper[0].parentNode), ("document" === a.containment || "window" === a.containment) && (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e("document" === a.containment ? document : window).width() - this.helperProportions.width - this.margins.left, (e("document" === a.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), /^(document|window|parent)$/.test(a.containment) || (t = e(a.containment)[0], n = e(a.containment).offset(), i = "hidden" !== e(t).css("overflow"), this.containment = [n.left + (parseInt(e(t).css("borderLeftWidth"), 10) || 0) + (parseInt(e(t).css("paddingLeft"), 10) || 0) - this.margins.left, n.top + (parseInt(e(t).css("borderTopWidth"), 10) || 0) + (parseInt(e(t).css("paddingTop"), 10) || 0) - this.margins.top, n.left + (i ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(e(t).css("borderLeftWidth"), 10) || 0) - (parseInt(e(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, n.top + (i ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(e(t).css("borderTopWidth"), 10) || 0) - (parseInt(e(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top])
			},
			_convertPositionTo: function(t, n) {
				n || (n = this.position);
				var i = "absolute" === t ? 1 : -1,
					a = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
					o = /(html|body)/i.test(a[0].tagName);
				return {
					top: n.top + this.offset.relative.top * i + this.offset.parent.top * i - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : o ? 0 : a.scrollTop()) * i,
					left: n.left + this.offset.relative.left * i + this.offset.parent.left * i - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : o ? 0 : a.scrollLeft()) * i
				}
			},
			_generatePosition: function(t) {
				var n, i, a = this.options,
					o = t.pageX,
					r = t.pageY,
					s = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
					l = /(html|body)/i.test(s[0].tagName);
				return "relative" !== this.cssPosition || this.scrollParent[0] !== document && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (o = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (r = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (o = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (r = this.containment[3] + this.offset.click.top)), a.grid && (n = this.originalPageY + Math.round((r - this.originalPageY) / a.grid[1]) * a.grid[1], r = this.containment ? n - this.offset.click.top >= this.containment[1] && n - this.offset.click.top <= this.containment[3] ? n : n - this.offset.click.top >= this.containment[1] ? n - a.grid[1] : n + a.grid[1] : n, i = this.originalPageX + Math.round((o - this.originalPageX) / a.grid[0]) * a.grid[0], o = this.containment ? i - this.offset.click.left >= this.containment[0] && i - this.offset.click.left <= this.containment[2] ? i : i - this.offset.click.left >= this.containment[0] ? i - a.grid[0] : i + a.grid[0] : i)), {
					top: r - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : l ? 0 : s.scrollTop()),
					left: o - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : l ? 0 : s.scrollLeft())
				}
			},
			_rearrange: function(e, t, n, i) {
				n ? n[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
				var a = this.counter;
				this._delay(function() {
					a === this.counter && this.refreshPositions(!i)
				})
			},
			_clear: function(e, t) {
				this.reverting = !1;
				var n, i = [];
				if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] === this.currentItem[0]) {
					for (n in this._storedCSS)("auto" === this._storedCSS[n] || "static" === this._storedCSS[n]) && (this._storedCSS[n] = "");
					this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
				} else this.currentItem.show();
				for (this.fromOutside && !t && i.push(function(e) {
					this._trigger("receive", e, this._uiHash(this.fromOutside))
				}), !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || t || i.push(function(e) {
					this._trigger("update", e, this._uiHash())
				}), this !== this.currentContainer && (t || (i.push(function(e) {
					this._trigger("remove", e, this._uiHash())
				}), i.push(function(e) {
					return function(t) {
						e._trigger("receive", t, this._uiHash(this))
					}
				}.call(this, this.currentContainer)), i.push(function(e) {
					return function(t) {
						e._trigger("update", t, this._uiHash(this))
					}
				}.call(this, this.currentContainer)))), n = this.containers.length - 1; n >= 0; n--) t || i.push(function(e) {
					return function(t) {
						e._trigger("deactivate", t, this._uiHash(this))
					}
				}.call(this, this.containers[n])), this.containers[n].containerCache.over && (i.push(function(e) {
					return function(t) {
						e._trigger("out", t, this._uiHash(this))
					}
				}.call(this, this.containers[n])), this.containers[n].containerCache.over = 0);
				if (this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, this.cancelHelperRemoval) {
					if (!t) {
						for (this._trigger("beforeStop", e, this._uiHash()), n = 0; i.length > n; n++) i[n].call(this, e);
						this._trigger("stop", e, this._uiHash())
					}
					return this.fromOutside = !1, !1
				}
				if (t || this._trigger("beforeStop", e, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null, !t) {
					for (n = 0; i.length > n; n++) i[n].call(this, e);
					this._trigger("stop", e, this._uiHash())
				}
				return this.fromOutside = !1, !0
			},
			_trigger: function() {
				!1 === e.Widget.prototype._trigger.apply(this, arguments) && this.cancel()
			},
			_uiHash: function(t) {
				var n = t || this;
				return {
					helper: n.helper,
					placeholder: n.placeholder || e([]),
					position: n.position,
					originalPosition: n.originalPosition,
					offset: n.positionAbs,
					item: n.currentItem,
					sender: t ? t.element : null
				}
			}
		})
	}(jQuery),
	function(e, t) {
		function n() {
			this._curInst = null, this._keyEvent = !1, this._disabledInputs = [], this._datepickerShowing = !1, this._inDialog = !1, this._mainDivId = "ui-datepicker-div", this._inlineClass = "ui-datepicker-inline", this._appendClass = "ui-datepicker-append", this._triggerClass = "ui-datepicker-trigger", this._dialogClass = "ui-datepicker-dialog", this._disableClass = "ui-datepicker-disabled", this._unselectableClass = "ui-datepicker-unselectable", this._currentClass = "ui-datepicker-current-day", this._dayOverClass = "ui-datepicker-days-cell-over", this.regional = [], this.regional[""] = {
				closeText: "Done",
				prevText: "Prev",
				nextText: "Next",
				currentText: "Today",
				monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
				monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
				dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
				dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
				dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
				weekHeader: "Wk",
				dateFormat: "mm/dd/yy",
				firstDay: 0,
				isRTL: !1,
				showMonthAfterYear: !1,
				yearSuffix: ""
			}, this._defaults = {
				showOn: "focus",
				showAnim: "fadeIn",
				showOptions: {},
				defaultDate: null,
				appendText: "",
				buttonText: "...",
				buttonImage: "",
				buttonImageOnly: !1,
				hideIfNoPrevNext: !1,
				navigationAsDateFormat: !1,
				gotoCurrent: !1,
				changeMonth: !1,
				changeYear: !1,
				yearRange: "c-10:c+10",
				showOtherMonths: !1,
				selectOtherMonths: !1,
				showWeek: !1,
				calculateWeek: this.iso8601Week,
				shortYearCutoff: "+10",
				minDate: null,
				maxDate: null,
				duration: "fast",
				beforeShowDay: null,
				beforeShow: null,
				onSelect: null,
				onChangeMonthYear: null,
				onClose: null,
				numberOfMonths: 1,
				showCurrentAtPos: 0,
				stepMonths: 1,
				stepBigMonths: 12,
				altField: "",
				altFormat: "",
				constrainInput: !0,
				showButtonPanel: !1,
				autoSize: !1,
				disabled: !1
			}, e.extend(this._defaults, this.regional[""]), this.dpDiv = i(e("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
		}

		function i(t) {
			var n = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
			return t.delegate(n, "mouseout", function() {
				e(this).removeClass("ui-state-hover"), -1 !== this.className.indexOf("ui-datepicker-prev") && e(this).removeClass("ui-datepicker-prev-hover"), -1 !== this.className.indexOf("ui-datepicker-next") && e(this).removeClass("ui-datepicker-next-hover")
			}).delegate(n, "mouseover", function() {
				e.datepicker._isDisabledDatepicker(o.inline ? t.parent()[0] : o.input[0]) || (e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), e(this).addClass("ui-state-hover"), -1 !== this.className.indexOf("ui-datepicker-prev") && e(this).addClass("ui-datepicker-prev-hover"), -1 !== this.className.indexOf("ui-datepicker-next") && e(this).addClass("ui-datepicker-next-hover"))
			})
		}

		function a(t, n) {
			e.extend(t, n);
			for (var i in n) null == n[i] && (t[i] = n[i]);
			return t
		}
		e.extend(e.ui, {
			datepicker: {
				version: "1.10.3"
			}
		});
		var o, r = "datepicker";
		e.extend(n.prototype, {
			markerClassName: "hasDatepicker",
			maxRows: 4,
			_widgetDatepicker: function() {
				return this.dpDiv
			},
			setDefaults: function(e) {
				return a(this._defaults, e || {}), this
			},
			_attachDatepicker: function(t, n) {
				var i, a, o;
				i = t.nodeName.toLowerCase(), a = "div" === i || "span" === i, t.id || (this.uuid += 1, t.id = "dp" + this.uuid), o = this._newInst(e(t), a), o.settings = e.extend({}, n || {}), "input" === i ? this._connectDatepicker(t, o) : a && this._inlineDatepicker(t, o)
			},
			_newInst: function(t, n) {
				return {
					id: t[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1"),
					input: t,
					selectedDay: 0,
					selectedMonth: 0,
					selectedYear: 0,
					drawMonth: 0,
					drawYear: 0,
					inline: n,
					dpDiv: n ? i(e("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) : this.dpDiv
				}
			},
			_connectDatepicker: function(t, n) {
				var i = e(t);
				n.append = e([]), n.trigger = e([]), i.hasClass(this.markerClassName) || (this._attachments(i, n), i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp), this._autoSize(n), e.data(t, r, n), n.settings.disabled && this._disableDatepicker(t))
			},
			_attachments: function(t, n) {
				var i, a, o, r = this._get(n, "appendText"),
					s = this._get(n, "isRTL");
				n.append && n.append.remove(), r && (n.append = e("<span class='" + this._appendClass + "'>" + r + "</span>"), t[s ? "before" : "after"](n.append)), t.unbind("focus", this._showDatepicker), n.trigger && n.trigger.remove(), i = this._get(n, "showOn"), ("focus" === i || "both" === i) && t.focus(this._showDatepicker), ("button" === i || "both" === i) && (a = this._get(n, "buttonText"), o = this._get(n, "buttonImage"), n.trigger = e(this._get(n, "buttonImageOnly") ? e("<img/>").addClass(this._triggerClass).attr({
					src: o,
					alt: a,
					title: a
				}) : e("<button type='button'></button>").addClass(this._triggerClass).html(o ? e("<img/>").attr({
					src: o,
					alt: a,
					title: a
				}) : a)), t[s ? "before" : "after"](n.trigger), n.trigger.click(function() {
					return e.datepicker._datepickerShowing && e.datepicker._lastInput === t[0] ? e.datepicker._hideDatepicker() : e.datepicker._datepickerShowing && e.datepicker._lastInput !== t[0] ? (e.datepicker._hideDatepicker(), e.datepicker._showDatepicker(t[0])) : e.datepicker._showDatepicker(t[0]), !1
				}))
			},
			_autoSize: function(e) {
				if (this._get(e, "autoSize") && !e.inline) {
					var t, n, i, a, o = new Date(2009, 11, 20),
						r = this._get(e, "dateFormat");
					r.match(/[DM]/) && (t = function(e) {
						for (n = 0, i = 0, a = 0; e.length > a; a++) e[a].length > n && (n = e[a].length, i = a);
						return i
					}, o.setMonth(t(this._get(e, r.match(/MM/) ? "monthNames" : "monthNamesShort"))), o.setDate(t(this._get(e, r.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - o.getDay())), e.input.attr("size", this._formatDate(e, o).length)
				}
			},
			_inlineDatepicker: function(t, n) {
				var i = e(t);
				i.hasClass(this.markerClassName) || (i.addClass(this.markerClassName).append(n.dpDiv), e.data(t, r, n), this._setDate(n, this._getDefaultDate(n), !0), this._updateDatepicker(n), this._updateAlternate(n), n.settings.disabled && this._disableDatepicker(t), n.dpDiv.css("display", "block"))
			},
			_dialogDatepicker: function(t, n, i, o, s) {
				var l, c, d, u, p, f = this._dialogInst;
				return f || (this.uuid += 1, l = "dp" + this.uuid, this._dialogInput = e("<input type='text' id='" + l + "' style='position: absolute; top: -100px; width: 0px;'/>"), this._dialogInput.keydown(this._doKeyDown), e("body").append(this._dialogInput), f = this._dialogInst = this._newInst(this._dialogInput, !1), f.settings = {}, e.data(this._dialogInput[0], r, f)), a(f.settings, o || {}), n = n && n.constructor === Date ? this._formatDate(f, n) : n, this._dialogInput.val(n), this._pos = s ? s.length ? s : [s.pageX, s.pageY] : null, this._pos || (c = document.documentElement.clientWidth, d = document.documentElement.clientHeight, u = document.documentElement.scrollLeft || document.body.scrollLeft, p = document.documentElement.scrollTop || document.body.scrollTop, this._pos = [c / 2 - 100 + u, d / 2 - 150 + p]), this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), f.settings.onSelect = i, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), e.blockUI && e.blockUI(this.dpDiv), e.data(this._dialogInput[0], r, f), this
			},
			_destroyDatepicker: function(t) {
				var n, i = e(t),
					a = e.data(t, r);
				i.hasClass(this.markerClassName) && (n = t.nodeName.toLowerCase(), e.removeData(t, r), "input" === n ? (a.append.remove(), a.trigger.remove(), i.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : ("div" === n || "span" === n) && i.removeClass(this.markerClassName).empty())
			},
			_enableDatepicker: function(t) {
				var n, i, a = e(t),
					o = e.data(t, r);
				a.hasClass(this.markerClassName) && (n = t.nodeName.toLowerCase(), "input" === n ? (t.disabled = !1, o.trigger.filter("button").each(function() {
					this.disabled = !1
				}).end().filter("img").css({
					opacity: "1.0",
					cursor: ""
				})) : ("div" === n || "span" === n) && (i = a.children("." + this._inlineClass), i.children().removeClass("ui-state-disabled"), i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1)), this._disabledInputs = e.map(this._disabledInputs, function(e) {
					return e === t ? null : e
				}))
			},
			_disableDatepicker: function(t) {
				var n, i, a = e(t),
					o = e.data(t, r);
				a.hasClass(this.markerClassName) && (n = t.nodeName.toLowerCase(), "input" === n ? (t.disabled = !0, o.trigger.filter("button").each(function() {
					this.disabled = !0
				}).end().filter("img").css({
					opacity: "0.5",
					cursor: "default"
				})) : ("div" === n || "span" === n) && (i = a.children("." + this._inlineClass), i.children().addClass("ui-state-disabled"), i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0)), this._disabledInputs = e.map(this._disabledInputs, function(e) {
					return e === t ? null : e
				}), this._disabledInputs[this._disabledInputs.length] = t)
			},
			_isDisabledDatepicker: function(e) {
				if (!e) return !1;
				for (var t = 0; this._disabledInputs.length > t; t++)
					if (this._disabledInputs[t] === e) return !0;
				return !1
			},
			_getInst: function(t) {
				try {
					return e.data(t, r)
				} catch (e) {
					throw "Missing instance data for this datepicker"
				}
			},
			_optionDatepicker: function(n, i, o) {
				var r, s, l, c, d = this._getInst(n);
				return 2 === arguments.length && "string" == typeof i ? "defaults" === i ? e.extend({}, e.datepicker._defaults) : d ? "all" === i ? e.extend({}, d.settings) : this._get(d, i) : null : (r = i || {}, "string" == typeof i && (r = {}, r[i] = o), d && (this._curInst === d && this._hideDatepicker(), s = this._getDateDatepicker(n, !0), l = this._getMinMaxDate(d, "min"), c = this._getMinMaxDate(d, "max"), a(d.settings, r), null !== l && r.dateFormat !== t && r.minDate === t && (d.settings.minDate = this._formatDate(d, l)), null !== c && r.dateFormat !== t && r.maxDate === t && (d.settings.maxDate = this._formatDate(d, c)), "disabled" in r && (r.disabled ? this._disableDatepicker(n) : this._enableDatepicker(n)), this._attachments(e(n), d), this._autoSize(d), this._setDate(d, s), this._updateAlternate(d), this._updateDatepicker(d)), t)
			},
			_changeDatepicker: function(e, t, n) {
				this._optionDatepicker(e, t, n)
			},
			_refreshDatepicker: function(e) {
				var t = this._getInst(e);
				t && this._updateDatepicker(t)
			},
			_setDateDatepicker: function(e, t) {
				var n = this._getInst(e);
				n && (this._setDate(n, t), this._updateDatepicker(n), this._updateAlternate(n))
			},
			_getDateDatepicker: function(e, t) {
				var n = this._getInst(e);
				return n && !n.inline && this._setDateFromField(n, t), n ? this._getDate(n) : null
			},
			_doKeyDown: function(t) {
				var n, i, a, o = e.datepicker._getInst(t.target),
					r = !0,
					s = o.dpDiv.is(".ui-datepicker-rtl");
				if (o._keyEvent = !0, e.datepicker._datepickerShowing) switch (t.keyCode) {
					case 9:
						e.datepicker._hideDatepicker(), r = !1;
						break;
					case 13:
						return a = e("td." + e.datepicker._dayOverClass + ":not(." + e.datepicker._currentClass + ")", o.dpDiv), a[0] && e.datepicker._selectDay(t.target, o.selectedMonth, o.selectedYear, a[0]), n = e.datepicker._get(o, "onSelect"), n ? (i = e.datepicker._formatDate(o), n.apply(o.input ? o.input[0] : null, [i, o])) : e.datepicker._hideDatepicker(), !1;
					case 27:
						e.datepicker._hideDatepicker();
						break;
					case 33:
						e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(o, "stepBigMonths") : -e.datepicker._get(o, "stepMonths"), "M");
						break;
					case 34:
						e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(o, "stepBigMonths") : +e.datepicker._get(o, "stepMonths"), "M");
						break;
					case 35:
						(t.ctrlKey || t.metaKey) && e.datepicker._clearDate(t.target), r = t.ctrlKey || t.metaKey;
						break;
					case 36:
						(t.ctrlKey || t.metaKey) && e.datepicker._gotoToday(t.target), r = t.ctrlKey || t.metaKey;
						break;
					case 37:
						(t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, s ? 1 : -1, "D"), r = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(o, "stepBigMonths") : -e.datepicker._get(o, "stepMonths"), "M");
						break;
					case 38:
						(t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, -7, "D"), r = t.ctrlKey || t.metaKey;
						break;
					case 39:
						(t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, s ? -1 : 1, "D"), r = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(o, "stepBigMonths") : +e.datepicker._get(o, "stepMonths"), "M");
						break;
					case 40:
						(t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, 7, "D"), r = t.ctrlKey || t.metaKey;
						break;
					default:
						r = !1
				} else 36 === t.keyCode && t.ctrlKey ? e.datepicker._showDatepicker(this) : r = !1;
				r && (t.preventDefault(), t.stopPropagation())
			},
			_doKeyPress: function(n) {
				var i, a, o = e.datepicker._getInst(n.target);
				return e.datepicker._get(o, "constrainInput") ? (i = e.datepicker._possibleChars(e.datepicker._get(o, "dateFormat")), a = String.fromCharCode(null == n.charCode ? n.keyCode : n.charCode), n.ctrlKey || n.metaKey || " " > a || !i || i.indexOf(a) > -1) : t
			},
			_doKeyUp: function(t) {
				var n = e.datepicker._getInst(t.target);
				if (n.input.val() !== n.lastVal) try {
					e.datepicker.parseDate(e.datepicker._get(n, "dateFormat"), n.input ? n.input.val() : null, e.datepicker._getFormatConfig(n)) && (e.datepicker._setDateFromField(n), e.datepicker._updateAlternate(n), e.datepicker._updateDatepicker(n))
				} catch (e) {}
				return !0
			},
			_showDatepicker: function(t) {
				if (t = t.target || t, "input" !== t.nodeName.toLowerCase() && (t = e("input", t.parentNode)[0]), !e.datepicker._isDisabledDatepicker(t) && e.datepicker._lastInput !== t) {
					var n, i, o, r, s, l, c;
					n = e.datepicker._getInst(t), e.datepicker._curInst && e.datepicker._curInst !== n && (e.datepicker._curInst.dpDiv.stop(!0, !0), n && e.datepicker._datepickerShowing && e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])), i = e.datepicker._get(n, "beforeShow"), !1 !== (o = i ? i.apply(t, [t, n]) : {}) && (a(n.settings, o), n.lastVal = null, e.datepicker._lastInput = t, e.datepicker._setDateFromField(n), e.datepicker._inDialog && (t.value = ""), e.datepicker._pos || (e.datepicker._pos = e.datepicker._findPos(t), e.datepicker._pos[1] += t.offsetHeight), r = !1, e(t).parents().each(function() {
						return !(r |= "fixed" === e(this).css("position"))
					}), s = {
						left: e.datepicker._pos[0],
						top: e.datepicker._pos[1]
					}, e.datepicker._pos = null, n.dpDiv.empty(), n.dpDiv.css({
						position: "absolute",
						display: "block",
						top: "-1000px"
					}), e.datepicker._updateDatepicker(n), s = e.datepicker._checkOffset(n, s, r), n.dpDiv.css({
						position: e.datepicker._inDialog && e.blockUI ? "static" : r ? "fixed" : "absolute",
						display: "none",
						left: s.left + "px",
						top: s.top + "px"
					}), n.inline || (l = e.datepicker._get(n, "showAnim"), c = e.datepicker._get(n, "duration"), n.dpDiv.zIndex(e(t).zIndex() + 1), e.datepicker._datepickerShowing = !0, e.effects && e.effects.effect[l] ? n.dpDiv.show(l, e.datepicker._get(n, "showOptions"), c) : n.dpDiv[l || "show"](l ? c : null), e.datepicker._shouldFocusInput(n) && n.input.focus(), e.datepicker._curInst = n))
				}
			},
			_updateDatepicker: function(t) {
				this.maxRows = 4, o = t, t.dpDiv.empty().append(this._generateHTML(t)), this._attachHandlers(t), t.dpDiv.find("." + this._dayOverClass + " a").mouseover();
				var n, i = this._getNumberOfMonths(t),
					a = i[1];
				t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""), a > 1 && t.dpDiv.addClass("ui-datepicker-multi-" + a).css("width", 17 * a + "em"), t.dpDiv[(1 !== i[0] || 1 !== i[1] ? "add" : "remove") + "Class"]("ui-datepicker-multi"), t.dpDiv[(this._get(t, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"), t === e.datepicker._curInst && e.datepicker._datepickerShowing && e.datepicker._shouldFocusInput(t) && t.input.focus(), t.yearshtml && (n = t.yearshtml, setTimeout(function() {
					n === t.yearshtml && t.yearshtml && t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml), n = t.yearshtml = null
				}, 0))
			},
			_shouldFocusInput: function(e) {
				return e.input && e.input.is(":visible") && !e.input.is(":disabled") && !e.input.is(":focus")
			},
			_checkOffset: function(t, n, i) {
				var a = t.dpDiv.outerWidth(),
					o = t.dpDiv.outerHeight(),
					r = t.input ? t.input.outerWidth() : 0,
					s = t.input ? t.input.outerHeight() : 0,
					l = document.documentElement.clientWidth + (i ? 0 : e(document).scrollLeft()),
					c = document.documentElement.clientHeight + (i ? 0 : e(document).scrollTop());
				return n.left -= this._get(t, "isRTL") ? a - r : 0, n.left -= i && n.left === t.input.offset().left ? e(document).scrollLeft() : 0, n.top -= i && n.top === t.input.offset().top + s ? e(document).scrollTop() : 0, n.left -= Math.min(n.left, n.left + a > l && l > a ? Math.abs(n.left + a - l) : 0), n.top -= Math.min(n.top, n.top + o > c && c > o ? Math.abs(o + s) : 0), n
			},
			_findPos: function(t) {
				for (var n, i = this._getInst(t), a = this._get(i, "isRTL"); t && ("hidden" === t.type || 1 !== t.nodeType || e.expr.filters.hidden(t));) t = t[a ? "previousSibling" : "nextSibling"];
				return n = e(t).offset(), [n.left, n.top]
			},
			_hideDatepicker: function(t) {
				var n, i, a, o, s = this._curInst;
				!s || t && s !== e.data(t, r) || this._datepickerShowing && (n = this._get(s, "showAnim"), i = this._get(s, "duration"), a = function() {
					e.datepicker._tidyDialog(s)
				}, e.effects && (e.effects.effect[n] || e.effects[n]) ? s.dpDiv.hide(n, e.datepicker._get(s, "showOptions"), i, a) : s.dpDiv["slideDown" === n ? "slideUp" : "fadeIn" === n ? "fadeOut" : "hide"](n ? i : null, a), n || a(), this._datepickerShowing = !1, o = this._get(s, "onClose"), o && o.apply(s.input ? s.input[0] : null, [s.input ? s.input.val() : "", s]), this._lastInput = null, this._inDialog && (this._dialogInput.css({
					position: "absolute",
					left: "0",
					top: "-100px"
				}), e.blockUI && (e.unblockUI(), e("body").append(this.dpDiv))), this._inDialog = !1)
			},
			_tidyDialog: function(e) {
				e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")
			},
			_checkExternalClick: function(t) {
				if (e.datepicker._curInst) {
					var n = e(t.target),
						i = e.datepicker._getInst(n[0]);
					(n[0].id !== e.datepicker._mainDivId && 0 === n.parents("#" + e.datepicker._mainDivId).length && !n.hasClass(e.datepicker.markerClassName) && !n.closest("." + e.datepicker._triggerClass).length && e.datepicker._datepickerShowing && (!e.datepicker._inDialog || !e.blockUI) || n.hasClass(e.datepicker.markerClassName) && e.datepicker._curInst !== i) && e.datepicker._hideDatepicker()
				}
			},
			_adjustDate: function(t, n, i) {
				var a = e(t),
					o = this._getInst(a[0]);
				this._isDisabledDatepicker(a[0]) || (this._adjustInstDate(o, n + ("M" === i ? this._get(o, "showCurrentAtPos") : 0), i), this._updateDatepicker(o))
			},
			_gotoToday: function(t) {
				var n, i = e(t),
					a = this._getInst(i[0]);
				this._get(a, "gotoCurrent") && a.currentDay ? (a.selectedDay = a.currentDay, a.drawMonth = a.selectedMonth = a.currentMonth, a.drawYear = a.selectedYear = a.currentYear) : (n = new Date, a.selectedDay = n.getDate(), a.drawMonth = a.selectedMonth = n.getMonth(), a.drawYear = a.selectedYear = n.getFullYear()), this._notifyChange(a), this._adjustDate(i)
			},
			_selectMonthYear: function(t, n, i) {
				var a = e(t),
					o = this._getInst(a[0]);
				o["selected" + ("M" === i ? "Month" : "Year")] = o["draw" + ("M" === i ? "Month" : "Year")] = parseInt(n.options[n.selectedIndex].value, 10), this._notifyChange(o), this._adjustDate(a)
			},
			_selectDay: function(t, n, i, a) {
				var o, r = e(t);
				e(a).hasClass(this._unselectableClass) || this._isDisabledDatepicker(r[0]) || (o = this._getInst(r[0]), o.selectedDay = o.currentDay = e("a", a).html(), o.selectedMonth = o.currentMonth = n, o.selectedYear = o.currentYear = i, this._selectDate(t, this._formatDate(o, o.currentDay, o.currentMonth, o.currentYear)))
			},
			_clearDate: function(t) {
				var n = e(t);
				this._selectDate(n, "")
			},
			_selectDate: function(t, n) {
				var i, a = e(t),
					o = this._getInst(a[0]);
				n = null != n ? n : this._formatDate(o), o.input && o.input.val(n), this._updateAlternate(o), i = this._get(o, "onSelect"), i ? i.apply(o.input ? o.input[0] : null, [n, o]) : o.input && o.input.trigger("change"), o.inline ? this._updateDatepicker(o) : (this._hideDatepicker(), this._lastInput = o.input[0], "object" != typeof o.input[0] && o.input.focus(), this._lastInput = null)
			},
			_updateAlternate: function(t) {
				var n, i, a, o = this._get(t, "altField");
				o && (n = this._get(t, "altFormat") || this._get(t, "dateFormat"), i = this._getDate(t), a = this.formatDate(n, i, this._getFormatConfig(t)), e(o).each(function() {
					e(this).val(a)
				}))
			},
			noWeekends: function(e) {
				var t = e.getDay();
				return [t > 0 && 6 > t, ""]
			},
			iso8601Week: function(e) {
				var t, n = new Date(e.getTime());
				return n.setDate(n.getDate() + 4 - (n.getDay() || 7)), t = n.getTime(), n.setMonth(0), n.setDate(1), Math.floor(Math.round((t - n) / 864e5) / 7) + 1
			},
			parseDate: function(n, i, a) {
				if (null == n || null == i) throw "Invalid arguments";
				if ("" === (i = "object" == typeof i ? "" + i : i + "")) return null;
				var o, r, s, l, c = 0,
					d = (a ? a.shortYearCutoff : null) || this._defaults.shortYearCutoff,
					u = "string" != typeof d ? d : (new Date).getFullYear() % 100 + parseInt(d, 10),
					p = (a ? a.dayNamesShort : null) || this._defaults.dayNamesShort,
					f = (a ? a.dayNames : null) || this._defaults.dayNames,
					h = (a ? a.monthNamesShort : null) || this._defaults.monthNamesShort,
					g = (a ? a.monthNames : null) || this._defaults.monthNames,
					m = -1,
					v = -1,
					y = -1,
					b = -1,
					_ = !1,
					w = function(e) {
						var t = n.length > o + 1 && n.charAt(o + 1) === e;
						return t && o++, t
					},
					x = function(e) {
						var t = w(e),
							n = "@" === e ? 14 : "!" === e ? 20 : "y" === e && t ? 4 : "o" === e ? 3 : 2,
							a = RegExp("^\\d{1," + n + "}"),
							o = i.substring(c).match(a);
						if (!o) throw "Missing number at position " + c;
						return c += o[0].length, parseInt(o[0], 10)
					},
					$ = function(n, a, o) {
						var r = -1,
							s = e.map(w(n) ? o : a, function(e, t) {
								return [
									[t, e]
								]
							}).sort(function(e, t) {
								return -(e[1].length - t[1].length)
							});
						if (e.each(s, function(e, n) {
							var a = n[1];
							return i.substr(c, a.length).toLowerCase() === a.toLowerCase() ? (r = n[0], c += a.length, !1) : t
						}), -1 !== r) return r + 1;
						throw "Unknown name at position " + c
					},
					k = function() {
						if (i.charAt(c) !== n.charAt(o)) throw "Unexpected literal at position " + c;
						c++
					};
				for (o = 0; n.length > o; o++)
					if (_) "'" !== n.charAt(o) || w("'") ? k() : _ = !1;
					else switch (n.charAt(o)) {
						case "d":
							y = x("d");
							break;
						case "D":
							$("D", p, f);
							break;
						case "o":
							b = x("o");
							break;
						case "m":
							v = x("m");
							break;
						case "M":
							v = $("M", h, g);
							break;
						case "y":
							m = x("y");
							break;
						case "@":
							l = new Date(x("@")), m = l.getFullYear(), v = l.getMonth() + 1, y = l.getDate();
							break;
						case "!":
							l = new Date((x("!") - this._ticksTo1970) / 1e4), m = l.getFullYear(), v = l.getMonth() + 1, y = l.getDate();
							break;
						case "'":
							w("'") ? k() : _ = !0;
							break;
						default:
							k()
					}
					if (i.length > c && (s = i.substr(c), !/^\s+/.test(s))) throw "Extra/unparsed characters found in date: " + s;
				if (-1 === m ? m = (new Date).getFullYear() : 100 > m && (m += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (u >= m ? 0 : -100)), b > -1)
					for (v = 1, y = b; !((r = this._getDaysInMonth(m, v - 1)) >= y);) v++, y -= r;
				if (l = this._daylightSavingAdjust(new Date(m, v - 1, y)), l.getFullYear() !== m || l.getMonth() + 1 !== v || l.getDate() !== y) throw "Invalid date";
				return l
			},
			ATOM: "yy-mm-dd",
			COOKIE: "D, dd M yy",
			ISO_8601: "yy-mm-dd",
			RFC_822: "D, d M y",
			RFC_850: "DD, dd-M-y",
			RFC_1036: "D, d M y",
			RFC_1123: "D, d M yy",
			RFC_2822: "D, d M yy",
			RSS: "D, d M y",
			TICKS: "!",
			TIMESTAMP: "@",
			W3C: "yy-mm-dd",
			_ticksTo1970: 864e9 * (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)),
			formatDate: function(e, t, n) {
				if (!t) return "";
				var i, a = (n ? n.dayNamesShort : null) || this._defaults.dayNamesShort,
					o = (n ? n.dayNames : null) || this._defaults.dayNames,
					r = (n ? n.monthNamesShort : null) || this._defaults.monthNamesShort,
					s = (n ? n.monthNames : null) || this._defaults.monthNames,
					l = function(t) {
						var n = e.length > i + 1 && e.charAt(i + 1) === t;
						return n && i++, n
					},
					c = function(e, t, n) {
						var i = "" + t;
						if (l(e))
							for (; n > i.length;) i = "0" + i;
						return i
					},
					d = function(e, t, n, i) {
						return l(e) ? i[t] : n[t]
					},
					u = "",
					p = !1;
				if (t)
					for (i = 0; e.length > i; i++)
						if (p) "'" !== e.charAt(i) || l("'") ? u += e.charAt(i) : p = !1;
						else switch (e.charAt(i)) {
							case "d":
								u += c("d", t.getDate(), 2);
								break;
							case "D":
								u += d("D", t.getDay(), a, o);
								break;
							case "o":
								u += c("o", Math.round((new Date(t.getFullYear(), t.getMonth(), t.getDate()).getTime() - new Date(t.getFullYear(), 0, 0).getTime()) / 864e5), 3);
								break;
							case "m":
								u += c("m", t.getMonth() + 1, 2);
								break;
							case "M":
								u += d("M", t.getMonth(), r, s);
								break;
							case "y":
								u += l("y") ? t.getFullYear() : (10 > t.getYear() % 100 ? "0" : "") + t.getYear() % 100;
								break;
							case "@":
								u += t.getTime();
								break;
							case "!":
								u += 1e4 * t.getTime() + this._ticksTo1970;
								break;
							case "'":
								l("'") ? u += "'" : p = !0;
								break;
							default:
								u += e.charAt(i)
						}
						return u
			},
			_possibleChars: function(e) {
				var t, n = "",
					i = !1,
					a = function(n) {
						var i = e.length > t + 1 && e.charAt(t + 1) === n;
						return i && t++, i
					};
				for (t = 0; e.length > t; t++)
					if (i) "'" !== e.charAt(t) || a("'") ? n += e.charAt(t) : i = !1;
					else switch (e.charAt(t)) {
						case "d":
						case "m":
						case "y":
						case "@":
							n += "0123456789";
							break;
						case "D":
						case "M":
							return null;
						case "'":
							a("'") ? n += "'" : i = !0;
							break;
						default:
							n += e.charAt(t)
					}
					return n
			},
			_get: function(e, n) {
				return e.settings[n] !== t ? e.settings[n] : this._defaults[n]
			},
			_setDateFromField: function(e, t) {
				if (e.input.val() !== e.lastVal) {
					var n = this._get(e, "dateFormat"),
						i = e.lastVal = e.input ? e.input.val() : null,
						a = this._getDefaultDate(e),
						o = a,
						r = this._getFormatConfig(e);
					try {
						o = this.parseDate(n, i, r) || a
					} catch (e) {
						i = t ? "" : i
					}
					e.selectedDay = o.getDate(), e.drawMonth = e.selectedMonth = o.getMonth(), e.drawYear = e.selectedYear = o.getFullYear(), e.currentDay = i ? o.getDate() : 0, e.currentMonth = i ? o.getMonth() : 0, e.currentYear = i ? o.getFullYear() : 0, this._adjustInstDate(e)
				}
			},
			_getDefaultDate: function(e) {
				return this._restrictMinMax(e, this._determineDate(e, this._get(e, "defaultDate"), new Date))
			},
			_determineDate: function(t, n, i) {
				var a = null == n || "" === n ? i : "string" == typeof n ? function(n) {
					try {
						return e.datepicker.parseDate(e.datepicker._get(t, "dateFormat"), n, e.datepicker._getFormatConfig(t))
					} catch (e) {}
					for (var i = (n.toLowerCase().match(/^c/) ? e.datepicker._getDate(t) : null) || new Date, a = i.getFullYear(), o = i.getMonth(), r = i.getDate(), s = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g, l = s.exec(n); l;) {
						switch (l[2] || "d") {
							case "d":
							case "D":
								r += parseInt(l[1], 10);
								break;
							case "w":
							case "W":
								r += 7 * parseInt(l[1], 10);
								break;
							case "m":
							case "M":
								o += parseInt(l[1], 10), r = Math.min(r, e.datepicker._getDaysInMonth(a, o));
								break;
							case "y":
							case "Y":
								a += parseInt(l[1], 10), r = Math.min(r, e.datepicker._getDaysInMonth(a, o))
						}
						l = s.exec(n)
					}
					return new Date(a, o, r)
				}(n) : "number" == typeof n ? isNaN(n) ? i : function(e) {
					var t = new Date;
					return t.setDate(t.getDate() + e), t
				}(n) : new Date(n.getTime());
				return a = a && "Invalid Date" == "" + a ? i : a, a && (a.setHours(0), a.setMinutes(0), a.setSeconds(0), a.setMilliseconds(0)), this._daylightSavingAdjust(a)
			},
			_daylightSavingAdjust: function(e) {
				return e ? (e.setHours(e.getHours() > 12 ? e.getHours() + 2 : 0), e) : null
			},
			_setDate: function(e, t, n) {
				var i = !t,
					a = e.selectedMonth,
					o = e.selectedYear,
					r = this._restrictMinMax(e, this._determineDate(e, t, new Date));
				e.selectedDay = e.currentDay = r.getDate(), e.drawMonth = e.selectedMonth = e.currentMonth = r.getMonth(), e.drawYear = e.selectedYear = e.currentYear = r.getFullYear(), a === e.selectedMonth && o === e.selectedYear || n || this._notifyChange(e), this._adjustInstDate(e), e.input && e.input.val(i ? "" : this._formatDate(e))
			},
			_getDate: function(e) {
				return !e.currentYear || e.input && "" === e.input.val() ? null : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay))
			},
			_attachHandlers: function(t) {
				var n = this._get(t, "stepMonths"),
					i = "#" + t.id.replace(/\\\\/g, "\\");
				t.dpDiv.find("[data-handler]").map(function() {
					var t = {
						prev: function() {
							e.datepicker._adjustDate(i, -n, "M")
						},
						next: function() {
							e.datepicker._adjustDate(i, +n, "M")
						},
						hide: function() {
							e.datepicker._hideDatepicker()
						},
						today: function() {
							e.datepicker._gotoToday(i)
						},
						selectDay: function() {
							return e.datepicker._selectDay(i, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this), !1
						},
						selectMonth: function() {
							return e.datepicker._selectMonthYear(i, this, "M"), !1
						},
						selectYear: function() {
							return e.datepicker._selectMonthYear(i, this, "Y"), !1
						}
					};
					e(this).bind(this.getAttribute("data-event"), t[this.getAttribute("data-handler")])
				})
			},
			_generateHTML: function(e) {
				var t, n, i, a, o, r, s, l, c, d, u, p, f, h, g, m, v, y, b, _, w, x, $, k, T, C, D, S, P, I, E, L, M, A, O, j, F, q, N, R = new Date,
					B = this._daylightSavingAdjust(new Date(R.getFullYear(), R.getMonth(), R.getDate())),
					U = this._get(e, "isRTL"),
					H = this._get(e, "showButtonPanel"),
					z = this._get(e, "hideIfNoPrevNext"),
					V = this._get(e, "navigationAsDateFormat"),
					W = this._getNumberOfMonths(e),
					Y = this._get(e, "showCurrentAtPos"),
					G = this._get(e, "stepMonths"),
					K = 1 !== W[0] || 1 !== W[1],
					Q = this._daylightSavingAdjust(e.currentDay ? new Date(e.currentYear, e.currentMonth, e.currentDay) : new Date(9999, 9, 9)),
					X = this._getMinMaxDate(e, "min"),
					Z = this._getMinMaxDate(e, "max"),
					J = e.drawMonth - Y,
					ee = e.drawYear;
				if (0 > J && (J += 12, ee--), Z)
					for (t = this._daylightSavingAdjust(new Date(Z.getFullYear(), Z.getMonth() - W[0] * W[1] + 1, Z.getDate())), t = X && X > t ? X : t; this._daylightSavingAdjust(new Date(ee, J, 1)) > t;) 0 > --J && (J = 11, ee--);
				for (e.drawMonth = J, e.drawYear = ee, n = this._get(e, "prevText"), n = V ? this.formatDate(n, this._daylightSavingAdjust(new Date(ee, J - G, 1)), this._getFormatConfig(e)) : n, i = this._canAdjustMonth(e, -1, ee, J) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "e" : "w") + "'>" + n + "</span></a>" : z ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "e" : "w") + "'>" + n + "</span></a>", a = this._get(e, "nextText"), a = V ? this.formatDate(a, this._daylightSavingAdjust(new Date(ee, J + G, 1)), this._getFormatConfig(e)) : a, o = this._canAdjustMonth(e, 1, ee, J) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='" + a + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "w" : "e") + "'>" + a + "</span></a>" : z ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + a + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "w" : "e") + "'>" + a + "</span></a>", r = this._get(e, "currentText"), s = this._get(e, "gotoCurrent") && e.currentDay ? Q : B, r = V ? this.formatDate(r, s, this._getFormatConfig(e)) : r, l = e.inline ? "" : "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(e, "closeText") + "</button>", c = H ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (U ? l : "") + (this._isInRange(e, s) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>" + r + "</button>" : "") + (U ? "" : l) + "</div>" : "", d = parseInt(this._get(e, "firstDay"), 10), d = isNaN(d) ? 0 : d, u = this._get(e, "showWeek"), p = this._get(e, "dayNames"), f = this._get(e, "dayNamesMin"), h = this._get(e, "monthNames"), g = this._get(e, "monthNamesShort"), m = this._get(e, "beforeShowDay"), v = this._get(e, "showOtherMonths"), y = this._get(e, "selectOtherMonths"), b = this._getDefaultDate(e), _ = "", x = 0; W[0] > x; x++) {
					for ($ = "", this.maxRows = 4, k = 0; W[1] > k; k++) {
						if (T = this._daylightSavingAdjust(new Date(ee, J, e.selectedDay)), C = " ui-corner-all", D = "", K) {
							if (D += "<div class='ui-datepicker-group", W[1] > 1) switch (k) {
								case 0:
									D += " ui-datepicker-group-first", C = " ui-corner-" + (U ? "right" : "left");
									break;
								case W[1] - 1:
									D += " ui-datepicker-group-last", C = " ui-corner-" + (U ? "left" : "right");
									break;
								default:
									D += " ui-datepicker-group-middle", C = ""
							}
							D += "'>"
						}
						for (D += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + C + "'>" + (/all|left/.test(C) && 0 === x ? U ? o : i : "") + (/all|right/.test(C) && 0 === x ? U ? i : o : "") + this._generateMonthYearHeader(e, J, ee, X, Z, x > 0 || k > 0, h, g) + "</div><table class='ui-datepicker-calendar'><thead><tr>", S = u ? "<th class='ui-datepicker-week-col'>" + this._get(e, "weekHeader") + "</th>" : "", w = 0; 7 > w; w++) P = (w + d) % 7, S += "<th" + ((w + d + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + "><span title='" + p[P] + "'>" + f[P] + "</span></th>";
						for (D += S + "</tr></thead><tbody>", I = this._getDaysInMonth(ee, J), ee === e.selectedYear && J === e.selectedMonth && (e.selectedDay = Math.min(e.selectedDay, I)), E = (this._getFirstDayOfMonth(ee, J) - d + 7) % 7, L = Math.ceil((E + I) / 7), M = K && this.maxRows > L ? this.maxRows : L, this.maxRows = M, A = this._daylightSavingAdjust(new Date(ee, J, 1 - E)), O = 0; M > O; O++) {
							for (D += "<tr>", j = u ? "<td class='ui-datepicker-week-col'>" + this._get(e, "calculateWeek")(A) + "</td>" : "", w = 0; 7 > w; w++) F = m ? m.apply(e.input ? e.input[0] : null, [A]) : [!0, ""], q = A.getMonth() !== J, N = q && !y || !F[0] || X && X > A || Z && A > Z, j += "<td class='" + ((w + d + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (q ? " ui-datepicker-other-month" : "") + (A.getTime() === T.getTime() && J === e.selectedMonth && e._keyEvent || b.getTime() === A.getTime() && b.getTime() === T.getTime() ? " " + this._dayOverClass : "") + (N ? " " + this._unselectableClass + " ui-state-disabled" : "") + (q && !v ? "" : " " + F[1] + (A.getTime() === Q.getTime() ? " " + this._currentClass : "") + (A.getTime() === B.getTime() ? " ui-datepicker-today" : "")) + "'" + (q && !v || !F[2] ? "" : " title='" + F[2].replace(/'/g, "&#39;") + "'") + (N ? "" : " data-handler='selectDay' data-event='click' data-month='" + A.getMonth() + "' data-year='" + A.getFullYear() + "'") + ">" + (q && !v ? "&#xa0;" : N ? "<span class='ui-state-default'>" + A.getDate() + "</span>" : "<a class='ui-state-default" + (A.getTime() === B.getTime() ? " ui-state-highlight" : "") + (A.getTime() === Q.getTime() ? " ui-state-active" : "") + (q ? " ui-priority-secondary" : "") + "' href='#'>" + A.getDate() + "</a>") + "</td>", A.setDate(A.getDate() + 1), A = this._daylightSavingAdjust(A);
							D += j + "</tr>"
						}
						J++, J > 11 && (J = 0, ee++), D += "</tbody></table>" + (K ? "</div>" + (W[0] > 0 && k === W[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : ""), $ += D
					}
					_ += $
				}
				return _ += c, e._keyEvent = !1, _
			},
			_generateMonthYearHeader: function(e, t, n, i, a, o, r, s) {
				var l, c, d, u, p, f, h, g, m = this._get(e, "changeMonth"),
					v = this._get(e, "changeYear"),
					y = this._get(e, "showMonthAfterYear"),
					b = "<div class='ui-datepicker-title'>",
					_ = "";
				if (o || !m) _ += "<span class='ui-datepicker-month'>" + r[t] + "</span>";
				else {
					for (l = i && i.getFullYear() === n, c = a && a.getFullYear() === n, _ += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>", d = 0; 12 > d; d++)(!l || d >= i.getMonth()) && (!c || a.getMonth() >= d) && (_ += "<option value='" + d + "'" + (d === t ? " selected='selected'" : "") + ">" + s[d] + "</option>");
					_ += "</select>"
				} if (y || (b += _ + (!o && m && v ? "" : "&#xa0;")), !e.yearshtml)
					if (e.yearshtml = "", o || !v) b += "<span class='ui-datepicker-year'>" + n + "</span>";
					else {
						for (u = this._get(e, "yearRange").split(":"), p = (new Date).getFullYear(), f = function(e) {
							var t = e.match(/c[+\-].*/) ? n + parseInt(e.substring(1), 10) : e.match(/[+\-].*/) ? p + parseInt(e, 10) : parseInt(e, 10);
							return isNaN(t) ? p : t
						}, h = f(u[0]), g = Math.max(h, f(u[1] || "")), h = i ? Math.max(h, i.getFullYear()) : h, g = a ? Math.min(g, a.getFullYear()) : g, e.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>"; g >= h; h++) e.yearshtml += "<option value='" + h + "'" + (h === n ? " selected='selected'" : "") + ">" + h + "</option>";
						e.yearshtml += "</select>", b += e.yearshtml, e.yearshtml = null
					}
				return b += this._get(e, "yearSuffix"), y && (b += (!o && m && v ? "" : "&#xa0;") + _), b += "</div>"
			},
			_adjustInstDate: function(e, t, n) {
				var i = e.drawYear + ("Y" === n ? t : 0),
					a = e.drawMonth + ("M" === n ? t : 0),
					o = Math.min(e.selectedDay, this._getDaysInMonth(i, a)) + ("D" === n ? t : 0),
					r = this._restrictMinMax(e, this._daylightSavingAdjust(new Date(i, a, o)));
				e.selectedDay = r.getDate(), e.drawMonth = e.selectedMonth = r.getMonth(), e.drawYear = e.selectedYear = r.getFullYear(), ("M" === n || "Y" === n) && this._notifyChange(e)
			},
			_restrictMinMax: function(e, t) {
				var n = this._getMinMaxDate(e, "min"),
					i = this._getMinMaxDate(e, "max"),
					a = n && n > t ? n : t;
				return i && a > i ? i : a
			},
			_notifyChange: function(e) {
				var t = this._get(e, "onChangeMonthYear");
				t && t.apply(e.input ? e.input[0] : null, [e.selectedYear, e.selectedMonth + 1, e])
			},
			_getNumberOfMonths: function(e) {
				var t = this._get(e, "numberOfMonths");
				return null == t ? [1, 1] : "number" == typeof t ? [1, t] : t
			},
			_getMinMaxDate: function(e, t) {
				return this._determineDate(e, this._get(e, t + "Date"), null)
			},
			_getDaysInMonth: function(e, t) {
				return 32 - this._daylightSavingAdjust(new Date(e, t, 32)).getDate()
			},
			_getFirstDayOfMonth: function(e, t) {
				return new Date(e, t, 1).getDay()
			},
			_canAdjustMonth: function(e, t, n, i) {
				var a = this._getNumberOfMonths(e),
					o = this._daylightSavingAdjust(new Date(n, i + (0 > t ? t : a[0] * a[1]), 1));
				return 0 > t && o.setDate(this._getDaysInMonth(o.getFullYear(), o.getMonth())), this._isInRange(e, o)
			},
			_isInRange: function(e, t) {
				var n, i, a = this._getMinMaxDate(e, "min"),
					o = this._getMinMaxDate(e, "max"),
					r = null,
					s = null,
					l = this._get(e, "yearRange");
				return l && (n = l.split(":"), i = (new Date).getFullYear(), r = parseInt(n[0], 10), s = parseInt(n[1], 10), n[0].match(/[+\-].*/) && (r += i), n[1].match(/[+\-].*/) && (s += i)), (!a || t.getTime() >= a.getTime()) && (!o || t.getTime() <= o.getTime()) && (!r || t.getFullYear() >= r) && (!s || s >= t.getFullYear())
			},
			_getFormatConfig: function(e) {
				var t = this._get(e, "shortYearCutoff");
				return t = "string" != typeof t ? t : (new Date).getFullYear() % 100 + parseInt(t, 10), {
					shortYearCutoff: t,
					dayNamesShort: this._get(e, "dayNamesShort"),
					dayNames: this._get(e, "dayNames"),
					monthNamesShort: this._get(e, "monthNamesShort"),
					monthNames: this._get(e, "monthNames")
				}
			},
			_formatDate: function(e, t, n, i) {
				t || (e.currentDay = e.selectedDay, e.currentMonth = e.selectedMonth, e.currentYear = e.selectedYear);
				var a = t ? "object" == typeof t ? t : this._daylightSavingAdjust(new Date(i, n, t)) : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
				return this.formatDate(this._get(e, "dateFormat"), a, this._getFormatConfig(e))
			}
		}), e.fn.datepicker = function(t) {
			if (!this.length) return this;
			e.datepicker.initialized || (e(document).mousedown(e.datepicker._checkExternalClick), e.datepicker.initialized = !0), 0 === e("#" + e.datepicker._mainDivId).length && e("body").append(e.datepicker.dpDiv);
			var n = Array.prototype.slice.call(arguments, 1);
			return "string" != typeof t || "isDisabled" !== t && "getDate" !== t && "widget" !== t ? "option" === t && 2 === arguments.length && "string" == typeof arguments[1] ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n)) : this.each(function() {
				"string" == typeof t ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this].concat(n)) : e.datepicker._attachDatepicker(this, t)
			}) : e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n))
		}, e.datepicker = new n, e.datepicker.initialized = !1, e.datepicker.uuid = (new Date).getTime(), e.datepicker.version = "1.10.3"
	}(jQuery),
	function() {
		function e(e) {
			function t(t, n, i, a, o, r) {
				for (; o >= 0 && o < r; o += e) {
					var s = a ? a[o] : o;
					i = n(i, t[s], s, t)
				}
				return i
			}
			return function(n, i, a, o) {
				i = b(i, o, 4);
				var r = !C(n) && y.keys(n),
					s = (r || n).length,
					l = e > 0 ? 0 : s - 1;
				return arguments.length < 3 && (a = n[r ? r[l] : l], l += e), t(n, i, a, r, l, s)
			}
		}

		function t(e) {
			return function(t, n, i) {
				n = _(n, i);
				for (var a = T(t), o = e > 0 ? 0 : a - 1; o >= 0 && o < a; o += e)
					if (n(t[o], o, t)) return o;
				return -1
			}
		}

		function n(e, t, n) {
			return function(i, a, o) {
				var r = 0,
					s = T(i);
				if ("number" == typeof o) e > 0 ? r = o >= 0 ? o : Math.max(o + s, r) : s = o >= 0 ? Math.min(o + 1, s) : o + s + 1;
				else if (n && o && s) return o = n(i, a), i[o] === a ? o : -1;
				if (a !== a) return o = t(d.call(i, r, s), y.isNaN), o >= 0 ? o + r : -1;
				for (o = e > 0 ? r : s - 1; o >= 0 && o < s; o += e)
					if (i[o] === a) return o;
				return -1
			}
		}

		function i(e, t) {
			var n = E.length,
				i = e.constructor,
				a = y.isFunction(i) && i.prototype || s,
				o = "constructor";
			for (y.has(e, o) && !y.contains(t, o) && t.push(o); n--;)(o = E[n]) in e && e[o] !== a[o] && !y.contains(t, o) && t.push(o)
		}
		var a = this,
			o = a._,
			r = Array.prototype,
			s = Object.prototype,
			l = Function.prototype,
			c = r.push,
			d = r.slice,
			u = s.toString,
			p = s.hasOwnProperty,
			f = Array.isArray,
			h = Object.keys,
			g = l.bind,
			m = Object.create,
			v = function() {},
			y = function(e) {
				return e instanceof y ? e : this instanceof y ? void(this._wrapped = e) : new y(e)
			};
		"undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = y), exports._ = y) : a._ = y, y.VERSION = "1.8.3";
		var b = function(e, t, n) {
				if (void 0 === t) return e;
				switch (null == n ? 3 : n) {
					case 1:
						return function(n) {
							return e.call(t, n)
						};
					case 2:
						return function(n, i) {
							return e.call(t, n, i)
						};
					case 3:
						return function(n, i, a) {
							return e.call(t, n, i, a)
						};
					case 4:
						return function(n, i, a, o) {
							return e.call(t, n, i, a, o)
						}
				}
				return function() {
					return e.apply(t, arguments)
				}
			},
			_ = function(e, t, n) {
				return null == e ? y.identity : y.isFunction(e) ? b(e, t, n) : y.isObject(e) ? y.matcher(e) : y.property(e)
			};
		y.iteratee = function(e, t) {
			return _(e, t, 1 / 0)
		};
		var w = function(e, t) {
				return function(n) {
					var i = arguments.length;
					if (i < 2 || null == n) return n;
					for (var a = 1; a < i; a++)
						for (var o = arguments[a], r = e(o), s = r.length, l = 0; l < s; l++) {
							var c = r[l];
							t && void 0 !== n[c] || (n[c] = o[c])
						}
					return n
				}
			},
			x = function(e) {
				if (!y.isObject(e)) return {};
				if (m) return m(e);
				v.prototype = e;
				var t = new v;
				return v.prototype = null, t
			},
			$ = function(e) {
				return function(t) {
					return null == t ? void 0 : t[e]
				}
			},
			k = Math.pow(2, 53) - 1,
			T = $("length"),
			C = function(e) {
				var t = T(e);
				return "number" == typeof t && t >= 0 && t <= k
			};
		y.each = y.forEach = function(e, t, n) {
			t = b(t, n);
			var i, a;
			if (C(e))
				for (i = 0, a = e.length; i < a; i++) t(e[i], i, e);
			else {
				var o = y.keys(e);
				for (i = 0, a = o.length; i < a; i++) t(e[o[i]], o[i], e)
			}
			return e
		}, y.map = y.collect = function(e, t, n) {
			t = _(t, n);
			for (var i = !C(e) && y.keys(e), a = (i || e).length, o = Array(a), r = 0; r < a; r++) {
				var s = i ? i[r] : r;
				o[r] = t(e[s], s, e)
			}
			return o
		}, y.reduce = y.foldl = y.inject = e(1), y.reduceRight = y.foldr = e(-1), y.find = y.detect = function(e, t, n) {
			var i;
			if (void 0 !== (i = C(e) ? y.findIndex(e, t, n) : y.findKey(e, t, n)) && -1 !== i) return e[i]
		}, y.filter = y.select = function(e, t, n) {
			var i = [];
			return t = _(t, n), y.each(e, function(e, n, a) {
				t(e, n, a) && i.push(e)
			}), i
		}, y.reject = function(e, t, n) {
			return y.filter(e, y.negate(_(t)), n)
		}, y.every = y.all = function(e, t, n) {
			t = _(t, n);
			for (var i = !C(e) && y.keys(e), a = (i || e).length, o = 0; o < a; o++) {
				var r = i ? i[o] : o;
				if (!t(e[r], r, e)) return !1
			}
			return !0
		}, y.some = y.any = function(e, t, n) {
			t = _(t, n);
			for (var i = !C(e) && y.keys(e), a = (i || e).length, o = 0; o < a; o++) {
				var r = i ? i[o] : o;
				if (t(e[r], r, e)) return !0
			}
			return !1
		}, y.contains = y.includes = y.include = function(e, t, n, i) {
			return C(e) || (e = y.values(e)), ("number" != typeof n || i) && (n = 0), y.indexOf(e, t, n) >= 0
		}, y.invoke = function(e, t) {
			var n = d.call(arguments, 2),
				i = y.isFunction(t);
			return y.map(e, function(e) {
				var a = i ? t : e[t];
				return null == a ? a : a.apply(e, n)
			})
		}, y.pluck = function(e, t) {
			return y.map(e, y.property(t))
		}, y.where = function(e, t) {
			return y.filter(e, y.matcher(t))
		}, y.findWhere = function(e, t) {
			return y.find(e, y.matcher(t))
		}, y.max = function(e, t, n) {
			var i, a, o = -1 / 0,
				r = -1 / 0;
			if (null == t && null != e) {
				e = C(e) ? e : y.values(e);
				for (var s = 0, l = e.length; s < l; s++)(i = e[s]) > o && (o = i)
			} else t = _(t, n), y.each(e, function(e, n, i) {
				((a = t(e, n, i)) > r || a === -1 / 0 && o === -1 / 0) && (o = e, r = a)
			});
			return o
		}, y.min = function(e, t, n) {
			var i, a, o = 1 / 0,
				r = 1 / 0;
			if (null == t && null != e) {
				e = C(e) ? e : y.values(e);
				for (var s = 0, l = e.length; s < l; s++)(i = e[s]) < o && (o = i)
			} else t = _(t, n), y.each(e, function(e, n, i) {
				((a = t(e, n, i)) < r || a === 1 / 0 && o === 1 / 0) && (o = e, r = a)
			});
			return o
		}, y.shuffle = function(e) {
			for (var t, n = C(e) ? e : y.values(e), i = n.length, a = Array(i), o = 0; o < i; o++) t = y.random(0, o), t !== o && (a[o] = a[t]), a[t] = n[o];
			return a
		}, y.sample = function(e, t, n) {
			return null == t || n ? (C(e) || (e = y.values(e)), e[y.random(e.length - 1)]) : y.shuffle(e).slice(0, Math.max(0, t))
		}, y.sortBy = function(e, t, n) {
			return t = _(t, n), y.pluck(y.map(e, function(e, n, i) {
				return {
					value: e,
					index: n,
					criteria: t(e, n, i)
				}
			}).sort(function(e, t) {
				var n = e.criteria,
					i = t.criteria;
				if (n !== i) {
					if (n > i || void 0 === n) return 1;
					if (n < i || void 0 === i) return -1
				}
				return e.index - t.index
			}), "value")
		};
		var D = function(e) {
			return function(t, n, i) {
				var a = {};
				return n = _(n, i), y.each(t, function(i, o) {
					var r = n(i, o, t);
					e(a, i, r)
				}), a
			}
		};
		y.groupBy = D(function(e, t, n) {
			y.has(e, n) ? e[n].push(t) : e[n] = [t]
		}), y.indexBy = D(function(e, t, n) {
			e[n] = t
		}), y.countBy = D(function(e, t, n) {
			y.has(e, n) ? e[n] ++ : e[n] = 1
		}), y.toArray = function(e) {
			return e ? y.isArray(e) ? d.call(e) : C(e) ? y.map(e, y.identity) : y.values(e) : []
		}, y.size = function(e) {
			return null == e ? 0 : C(e) ? e.length : y.keys(e).length
		}, y.partition = function(e, t, n) {
			t = _(t, n);
			var i = [],
				a = [];
			return y.each(e, function(e, n, o) {
				(t(e, n, o) ? i : a).push(e)
			}), [i, a]
		}, y.first = y.head = y.take = function(e, t, n) {
			if (null != e) return null == t || n ? e[0] : y.initial(e, e.length - t)
		}, y.initial = function(e, t, n) {
			return d.call(e, 0, Math.max(0, e.length - (null == t || n ? 1 : t)))
		}, y.last = function(e, t, n) {
			if (null != e) return null == t || n ? e[e.length - 1] : y.rest(e, Math.max(0, e.length - t))
		}, y.rest = y.tail = y.drop = function(e, t, n) {
			return d.call(e, null == t || n ? 1 : t)
		}, y.compact = function(e) {
			return y.filter(e, y.identity)
		};
		var S = function(e, t, n, i) {
			for (var a = [], o = 0, r = i || 0, s = T(e); r < s; r++) {
				var l = e[r];
				if (C(l) && (y.isArray(l) || y.isArguments(l))) {
					t || (l = S(l, t, n));
					var c = 0,
						d = l.length;
					for (a.length += d; c < d;) a[o++] = l[c++]
				} else n || (a[o++] = l)
			}
			return a
		};
		y.flatten = function(e, t) {
			return S(e, t, !1)
		}, y.without = function(e) {
			return y.difference(e, d.call(arguments, 1))
		}, y.uniq = y.unique = function(e, t, n, i) {
			y.isBoolean(t) || (i = n, n = t, t = !1), null != n && (n = _(n, i));
			for (var a = [], o = [], r = 0, s = T(e); r < s; r++) {
				var l = e[r],
					c = n ? n(l, r, e) : l;
				t ? (r && o === c || a.push(l), o = c) : n ? y.contains(o, c) || (o.push(c), a.push(l)) : y.contains(a, l) || a.push(l)
			}
			return a
		}, y.union = function() {
			return y.uniq(S(arguments, !0, !0))
		}, y.intersection = function(e) {
			for (var t = [], n = arguments.length, i = 0, a = T(e); i < a; i++) {
				var o = e[i];
				if (!y.contains(t, o)) {
					for (var r = 1; r < n && y.contains(arguments[r], o); r++);
					r === n && t.push(o)
				}
			}
			return t
		}, y.difference = function(e) {
			var t = S(arguments, !0, !0, 1);
			return y.filter(e, function(e) {
				return !y.contains(t, e)
			})
		}, y.zip = function() {
			return y.unzip(arguments)
		}, y.unzip = function(e) {
			for (var t = e && y.max(e, T).length || 0, n = Array(t), i = 0; i < t; i++) n[i] = y.pluck(e, i);
			return n
		}, y.object = function(e, t) {
			for (var n = {}, i = 0, a = T(e); i < a; i++) t ? n[e[i]] = t[i] : n[e[i][0]] = e[i][1];
			return n
		}, y.findIndex = t(1), y.findLastIndex = t(-1), y.sortedIndex = function(e, t, n, i) {
			n = _(n, i, 1);
			for (var a = n(t), o = 0, r = T(e); o < r;) {
				var s = Math.floor((o + r) / 2);
				n(e[s]) < a ? o = s + 1 : r = s
			}
			return o
		}, y.indexOf = n(1, y.findIndex, y.sortedIndex), y.lastIndexOf = n(-1, y.findLastIndex), y.range = function(e, t, n) {
			null == t && (t = e || 0, e = 0), n = n || 1;
			for (var i = Math.max(Math.ceil((t - e) / n), 0), a = Array(i), o = 0; o < i; o++, e += n) a[o] = e;
			return a
		};
		var P = function(e, t, n, i, a) {
			if (!(i instanceof t)) return e.apply(n, a);
			var o = x(e.prototype),
				r = e.apply(o, a);
			return y.isObject(r) ? r : o
		};
		y.bind = function(e, t) {
			if (g && e.bind === g) return g.apply(e, d.call(arguments, 1));
			if (!y.isFunction(e)) throw new TypeError("Bind must be called on a function");
			var n = d.call(arguments, 2),
				i = function() {
					return P(e, i, t, this, n.concat(d.call(arguments)))
				};
			return i
		}, y.partial = function(e) {
			var t = d.call(arguments, 1),
				n = function() {
					for (var i = 0, a = t.length, o = Array(a), r = 0; r < a; r++) o[r] = t[r] === y ? arguments[i++] : t[r];
					for (; i < arguments.length;) o.push(arguments[i++]);
					return P(e, n, this, this, o)
				};
			return n
		}, y.bindAll = function(e) {
			var t, n, i = arguments.length;
			if (i <= 1) throw new Error("bindAll must be passed function names");
			for (t = 1; t < i; t++) n = arguments[t], e[n] = y.bind(e[n], e);
			return e
		}, y.memoize = function(e, t) {
			var n = function(i) {
				var a = n.cache,
					o = "" + (t ? t.apply(this, arguments) : i);
				return y.has(a, o) || (a[o] = e.apply(this, arguments)), a[o]
			};
			return n.cache = {}, n
		}, y.delay = function(e, t) {
			var n = d.call(arguments, 2);
			return setTimeout(function() {
				return e.apply(null, n)
			}, t)
		}, y.defer = y.partial(y.delay, y, 1), y.throttle = function(e, t, n) {
			var i, a, o, r = null,
				s = 0;
			n || (n = {});
			var l = function() {
				s = !1 === n.leading ? 0 : y.now(), r = null, o = e.apply(i, a), r || (i = a = null)
			};
			return function() {
				var c = y.now();
				s || !1 !== n.leading || (s = c);
				var d = t - (c - s);
				return i = this, a = arguments, d <= 0 || d > t ? (r && (clearTimeout(r), r = null), s = c, o = e.apply(i, a), r || (i = a = null)) : r || !1 === n.trailing || (r = setTimeout(l, d)), o
			}
		}, y.debounce = function(e, t, n) {
			var i, a, o, r, s, l = function() {
				var c = y.now() - r;
				c < t && c >= 0 ? i = setTimeout(l, t - c) : (i = null, n || (s = e.apply(o, a), i || (o = a = null)))
			};
			return function() {
				o = this, a = arguments, r = y.now();
				var c = n && !i;
				return i || (i = setTimeout(l, t)), c && (s = e.apply(o, a), o = a = null), s
			}
		}, y.wrap = function(e, t) {
			return y.partial(t, e)
		}, y.negate = function(e) {
			return function() {
				return !e.apply(this, arguments)
			}
		}, y.compose = function() {
			var e = arguments,
				t = e.length - 1;
			return function() {
				for (var n = t, i = e[t].apply(this, arguments); n--;) i = e[n].call(this, i);
				return i
			}
		}, y.after = function(e, t) {
			return function() {
				if (--e < 1) return t.apply(this, arguments)
			}
		}, y.before = function(e, t) {
			var n;
			return function() {
				return --e > 0 && (n = t.apply(this, arguments)), e <= 1 && (t = null), n
			}
		}, y.once = y.partial(y.before, 2);
		var I = !{
				toString: null
			}.propertyIsEnumerable("toString"),
			E = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"];
		y.keys = function(e) {
			if (!y.isObject(e)) return [];
			if (h) return h(e);
			var t = [];
			for (var n in e) y.has(e, n) && t.push(n);
			return I && i(e, t), t
		}, y.allKeys = function(e) {
			if (!y.isObject(e)) return [];
			var t = [];
			for (var n in e) t.push(n);
			return I && i(e, t), t
		}, y.values = function(e) {
			for (var t = y.keys(e), n = t.length, i = Array(n), a = 0; a < n; a++) i[a] = e[t[a]];
			return i
		}, y.mapObject = function(e, t, n) {
			t = _(t, n);
			for (var i, a = y.keys(e), o = a.length, r = {}, s = 0; s < o; s++) i = a[s], r[i] = t(e[i], i, e);
			return r
		}, y.pairs = function(e) {
			for (var t = y.keys(e), n = t.length, i = Array(n), a = 0; a < n; a++) i[a] = [t[a], e[t[a]]];
			return i
		}, y.invert = function(e) {
			for (var t = {}, n = y.keys(e), i = 0, a = n.length; i < a; i++) t[e[n[i]]] = n[i];
			return t
		}, y.functions = y.methods = function(e) {
			var t = [];
			for (var n in e) y.isFunction(e[n]) && t.push(n);
			return t.sort()
		}, y.extend = w(y.allKeys), y.extendOwn = y.assign = w(y.keys), y.findKey = function(e, t, n) {
			t = _(t, n);
			for (var i, a = y.keys(e), o = 0, r = a.length; o < r; o++)
				if (i = a[o], t(e[i], i, e)) return i
		}, y.pick = function(e, t, n) {
			var i, a, o = {},
				r = e;
			if (null == r) return o;
			y.isFunction(t) ? (a = y.allKeys(r), i = b(t, n)) : (a = S(arguments, !1, !1, 1), i = function(e, t, n) {
				return t in n
			}, r = Object(r));
			for (var s = 0, l = a.length; s < l; s++) {
				var c = a[s],
					d = r[c];
				i(d, c, r) && (o[c] = d)
			}
			return o
		}, y.omit = function(e, t, n) {
			if (y.isFunction(t)) t = y.negate(t);
			else {
				var i = y.map(S(arguments, !1, !1, 1), String);
				t = function(e, t) {
					return !y.contains(i, t)
				}
			}
			return y.pick(e, t, n)
		}, y.defaults = w(y.allKeys, !0), y.create = function(e, t) {
			var n = x(e);
			return t && y.extendOwn(n, t), n
		}, y.clone = function(e) {
			return y.isObject(e) ? y.isArray(e) ? e.slice() : y.extend({}, e) : e
		}, y.tap = function(e, t) {
			return t(e), e
		}, y.isMatch = function(e, t) {
			var n = y.keys(t),
				i = n.length;
			if (null == e) return !i;
			for (var a = Object(e), o = 0; o < i; o++) {
				var r = n[o];
				if (t[r] !== a[r] || !(r in a)) return !1
			}
			return !0
		};
		var L = function(e, t, n, i) {
			if (e === t) return 0 !== e || 1 / e == 1 / t;
			if (null == e || null == t) return e === t;
			e instanceof y && (e = e._wrapped), t instanceof y && (t = t._wrapped);
			var a = u.call(e);
			if (a !== u.call(t)) return !1;
			switch (a) {
				case "[object RegExp]":
				case "[object String]":
					return "" + e == "" + t;
				case "[object Number]":
					return +e != +e ? +t != +t : 0 == +e ? 1 / +e == 1 / t : +e == +t;
				case "[object Date]":
				case "[object Boolean]":
					return +e == +t
			}
			var o = "[object Array]" === a;
			if (!o) {
				if ("object" != typeof e || "object" != typeof t) return !1;
				var r = e.constructor,
					s = t.constructor;
				if (r !== s && !(y.isFunction(r) && r instanceof r && y.isFunction(s) && s instanceof s) && "constructor" in e && "constructor" in t) return !1
			}
			n = n || [], i = i || [];
			for (var l = n.length; l--;)
				if (n[l] === e) return i[l] === t;
			if (n.push(e), i.push(t), o) {
				if ((l = e.length) !== t.length) return !1;
				for (; l--;)
					if (!L(e[l], t[l], n, i)) return !1
			} else {
				var c, d = y.keys(e);
				if (l = d.length, y.keys(t).length !== l) return !1;
				for (; l--;)
					if (c = d[l], !y.has(t, c) || !L(e[c], t[c], n, i)) return !1
			}
			return n.pop(), i.pop(), !0
		};
		y.isEqual = function(e, t) {
			return L(e, t)
		}, y.isEmpty = function(e) {
			return null == e || (C(e) && (y.isArray(e) || y.isString(e) || y.isArguments(e)) ? 0 === e.length : 0 === y.keys(e).length)
		}, y.isElement = function(e) {
			return !(!e || 1 !== e.nodeType)
		}, y.isArray = f || function(e) {
			return "[object Array]" === u.call(e)
		}, y.isObject = function(e) {
			var t = typeof e;
			return "function" === t || "object" === t && !!e
		}, y.each(["Arguments", "Function", "String", "Number", "Date", "RegExp", "Error"], function(e) {
			y["is" + e] = function(t) {
				return u.call(t) === "[object " + e + "]"
			}
		}), y.isArguments(arguments) || (y.isArguments = function(e) {
			return y.has(e, "callee")
		}), "function" != typeof / . / && "object" != typeof Int8Array && (y.isFunction = function(e) {
			return "function" == typeof e || !1
		}), y.isFinite = function(e) {
			return isFinite(e) && !isNaN(parseFloat(e))
		}, y.isNaN = function(e) {
			return y.isNumber(e) && e !== +e
		}, y.isBoolean = function(e) {
			return !0 === e || !1 === e || "[object Boolean]" === u.call(e)
		}, y.isNull = function(e) {
			return null === e
		}, y.isUndefined = function(e) {
			return void 0 === e
		}, y.has = function(e, t) {
			return null != e && p.call(e, t)
		}, y.noConflict = function() {
			return a._ = o, this
		}, y.identity = function(e) {
			return e
		}, y.constant = function(e) {
			return function() {
				return e
			}
		}, y.noop = function() {}, y.property = $, y.propertyOf = function(e) {
			return null == e ? function() {} : function(t) {
				return e[t]
			}
		}, y.matcher = y.matches = function(e) {
			return e = y.extendOwn({}, e),
				function(t) {
					return y.isMatch(t, e)
				}
		}, y.times = function(e, t, n) {
			var i = Array(Math.max(0, e));
			t = b(t, n, 1);
			for (var a = 0; a < e; a++) i[a] = t(a);
			return i
		}, y.random = function(e, t) {
			return null == t && (t = e, e = 0), e + Math.floor(Math.random() * (t - e + 1))
		}, y.now = Date.now || function() {
			return (new Date).getTime()
		};
		var M = {
				"&": "&amp;",
				"<": "&lt;",
				">": "&gt;",
				'"': "&quot;",
				"'": "&#x27;",
				"`": "&#x60;"
			},
			A = y.invert(M),
			O = function(e) {
				var t = function(t) {
						return e[t]
					},
					n = "(?:" + y.keys(e).join("|") + ")",
					i = RegExp(n),
					a = RegExp(n, "g");
				return function(e) {
					return e = null == e ? "" : "" + e, i.test(e) ? e.replace(a, t) : e
				}
			};
		y.escape = O(M), y.unescape = O(A), y.result = function(e, t, n) {
			var i = null == e ? void 0 : e[t];
			return void 0 === i && (i = n), y.isFunction(i) ? i.call(e) : i
		};
		var j = 0;
		y.uniqueId = function(e) {
			var t = ++j + "";
			return e ? e + t : t
		}, y.templateSettings = {
			evaluate: /<%([\s\S]+?)%>/g,
			interpolate: /<%=([\s\S]+?)%>/g,
			escape: /<%-([\s\S]+?)%>/g
		};
		var F = /(.)^/,
			q = {
				"'": "'",
				"\\": "\\",
				"\r": "r",
				"\n": "n",
				"\u2028": "u2028",
				"\u2029": "u2029"
			},
			N = /\\|'|\r|\n|\u2028|\u2029/g,
			R = function(e) {
				return "\\" + q[e]
			};
		y.template = function(e, t, n) {
			!t && n && (t = n), t = y.defaults({}, t, y.templateSettings);
			var i = RegExp([(t.escape || F).source, (t.interpolate || F).source, (t.evaluate || F).source].join("|") + "|$", "g"),
				a = 0,
				o = "__p+='";
			e.replace(i, function(t, n, i, r, s) {
				return o += e.slice(a, s).replace(N, R), a = s + t.length, n ? o += "'+\n((__t=(" + n + "))==null?'':_.escape(__t))+\n'" : i ? o += "'+\n((__t=(" + i + "))==null?'':__t)+\n'" : r && (o += "';\n" + r + "\n__p+='"), t
			}), o += "';\n", t.variable || (o = "with(obj||{}){\n" + o + "}\n"), o = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + o + "return __p;\n";
			try {
				var r = new Function(t.variable || "obj", "_", o)
			} catch (e) {
				throw e.source = o, e
			}
			var s = function(e) {
				return r.call(this, e, y)
			};
			return s.source = "function(" + (t.variable || "obj") + "){\n" + o + "}", s
		}, y.chain = function(e) {
			var t = y(e);
			return t._chain = !0, t
		};
		var B = function(e, t) {
			return e._chain ? y(t).chain() : t
		};
		y.mixin = function(e) {
			y.each(y.functions(e), function(t) {
				var n = y[t] = e[t];
				y.prototype[t] = function() {
					var e = [this._wrapped];
					return c.apply(e, arguments), B(this, n.apply(y, e))
				}
			})
		}, y.mixin(y), y.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(e) {
			var t = r[e];
			y.prototype[e] = function() {
				var n = this._wrapped;
				return t.apply(n, arguments), "shift" !== e && "splice" !== e || 0 !== n.length || delete n[0], B(this, n)
			}
		}), y.each(["concat", "join", "slice"], function(e) {
			var t = r[e];
			y.prototype[e] = function() {
				return B(this, t.apply(this._wrapped, arguments))
			}
		}), y.prototype.value = function() {
			return this._wrapped
		}, y.prototype.valueOf = y.prototype.toJSON = y.prototype.value, y.prototype.toString = function() {
			return "" + this._wrapped
		}, "function" == typeof define && define.amd && define("underscore", [], function() {
			return y
		})
	}.call(this),
	function(e, t, n) {
		"use strict";

		function i(e, t) {
			return t = t || Error,
				function() {
					var n, i, a = arguments[0],
						o = "[" + (e ? e + ":" : "") + a + "] ",
						r = arguments[1],
						s = arguments;
					for (n = o + r.replace(/\{\d+\}/g, function(e) {
						var t = +e.slice(1, -1);
						return t + 2 < s.length ? ue(s[t + 2]) : e
					}), n = n + "\nhttp://errors.angularjs.org/1.3.14/" + (e ? e + "/" : "") + a, i = 2; i < arguments.length; i++) n = n + (2 == i ? "?" : "&") + "p" + (i - 2) + "=" + encodeURIComponent(ue(arguments[i]));
					return new t(n)
				}
		}

		function a(e) {
			if (null == e || T(e)) return !1;
			var t = e.length;
			return !(e.nodeType !== gi || !t) || (_(e) || li(e) || 0 === t || "number" == typeof t && t > 0 && t - 1 in e)
		}

		function o(e, t, n) {
			var i, r;
			if (e)
				if ($(e))
					for (i in e) "prototype" == i || "length" == i || "name" == i || e.hasOwnProperty && !e.hasOwnProperty(i) || t.call(n, e[i], i, e);
				else if (li(e) || a(e)) {
				var s = "object" != typeof e;
				for (i = 0, r = e.length; i < r; i++)(s || i in e) && t.call(n, e[i], i, e)
			} else if (e.forEach && e.forEach !== o) e.forEach(t, n, e);
			else
				for (i in e) e.hasOwnProperty(i) && t.call(n, e[i], i, e);
			return e
		}

		function r(e) {
			return Object.keys(e).sort()
		}

		function s(e, t, n) {
			for (var i = r(e), a = 0; a < i.length; a++) t.call(n, e[i[a]], i[a]);
			return i
		}

		function l(e) {
			return function(t, n) {
				e(n, t)
			}
		}

		function c() {
			return ++ri
		}

		function d(e, t) {
			t ? e.$$hashKey = t : delete e.$$hashKey
		}

		function u(e) {
			for (var t = e.$$hashKey, n = 1, i = arguments.length; n < i; n++) {
				var a = arguments[n];
				if (a)
					for (var o = Object.keys(a), r = 0, s = o.length; r < s; r++) {
						var l = o[r];
						e[l] = a[l]
					}
			}
			return d(e, t), e
		}

		function p(e) {
			return parseInt(e, 10)
		}

		function f(e, t) {
			return u(Object.create(e), t)
		}

		function h() {}

		function g(e) {
			return e
		}

		function m(e) {
			return function() {
				return e
			}
		}

		function v(e) {
			return void 0 === e
		}

		function y(e) {
			return void 0 !== e
		}

		function b(e) {
			return null !== e && "object" == typeof e
		}

		function _(e) {
			return "string" == typeof e
		}

		function w(e) {
			return "number" == typeof e
		}

		function x(e) {
			return "[object Date]" === ii.call(e)
		}

		function $(e) {
			return "function" == typeof e
		}

		function k(e) {
			return "[object RegExp]" === ii.call(e)
		}

		function T(e) {
			return e && e.window === e
		}

		function C(e) {
			return e && e.$evalAsync && e.$watch
		}

		function D(e) {
			return "[object File]" === ii.call(e)
		}

		function S(e) {
			return "[object FormData]" === ii.call(e)
		}

		function P(e) {
			return "[object Blob]" === ii.call(e)
		}

		function I(e) {
			return "boolean" == typeof e
		}

		function E(e) {
			return e && $(e.then)
		}

		function L(e) {
			return !(!e || !(e.nodeName || e.prop && e.attr && e.find))
		}

		function M(e) {
			var t, n = {},
				i = e.split(",");
			for (t = 0; t < i.length; t++) n[i[t]] = !0;
			return n
		}

		function A(e) {
			return Vn(e.nodeName || e[0] && e[0].nodeName)
		}

		function O(e, t) {
			var n = e.indexOf(t);
			return n >= 0 && e.splice(n, 1), t
		}

		function j(e, t, n, i) {
			if (T(e) || C(e)) throw ai("cpws", "Can't copy! Making copies of Window or Scope instances is not supported.");
			if (t) {
				if (e === t) throw ai("cpi", "Can't copy! Source and destination are identical.");
				if (n = n || [], i = i || [], b(e)) {
					var a = n.indexOf(e);
					if (-1 !== a) return i[a];
					n.push(e), i.push(t)
				}
				var r;
				if (li(e)) {
					t.length = 0;
					for (var s = 0; s < e.length; s++) r = j(e[s], null, n, i), b(e[s]) && (n.push(e[s]), i.push(r)), t.push(r)
				} else {
					var l = t.$$hashKey;
					li(t) ? t.length = 0 : o(t, function(e, n) {
						delete t[n]
					});
					for (var c in e) e.hasOwnProperty(c) && (r = j(e[c], null, n, i), b(e[c]) && (n.push(e[c]), i.push(r)), t[c] = r);
					d(t, l)
				}
			} else if (t = e, e)
				if (li(e)) t = j(e, [], n, i);
				else if (x(e)) t = new Date(e.getTime());
			else if (k(e)) t = new RegExp(e.source, e.toString().match(/[^\/]*$/)[0]), t.lastIndex = e.lastIndex;
			else if (b(e)) {
				var u = Object.create(Object.getPrototypeOf(e));
				t = j(e, u, n, i)
			}
			return t
		}

		function F(e, t) {
			if (li(e)) {
				t = t || [];
				for (var n = 0, i = e.length; n < i; n++) t[n] = e[n]
			} else if (b(e)) {
				t = t || {};
				for (var a in e) "$" === a.charAt(0) && "$" === a.charAt(1) || (t[a] = e[a])
			}
			return t || e
		}

		function q(e, t) {
			if (e === t) return !0;
			if (null === e || null === t) return !1;
			if (e !== e && t !== t) return !0;
			var i, a, o, r = typeof e,
				s = typeof t;
			if (r == s && "object" == r) {
				if (!li(e)) {
					if (x(e)) return !!x(t) && q(e.getTime(), t.getTime());
					if (k(e) && k(t)) return e.toString() == t.toString();
					if (C(e) || C(t) || T(e) || T(t) || li(t)) return !1;
					o = {};
					for (a in e)
						if ("$" !== a.charAt(0) && !$(e[a])) {
							if (!q(e[a], t[a])) return !1;
							o[a] = !0
						}
					for (a in t)
						if (!o.hasOwnProperty(a) && "$" !== a.charAt(0) && t[a] !== n && !$(t[a])) return !1;
					return !0
				}
				if (!li(t)) return !1;
				if ((i = e.length) == t.length) {
					for (a = 0; a < i; a++)
						if (!q(e[a], t[a])) return !1;
					return !0
				}
			}
			return !1
		}

		function N(e, t, n) {
			return e.concat(ei.call(t, n))
		}

		function R(e, t) {
			return ei.call(e, t || 0)
		}

		function B(e, t) {
			var n = arguments.length > 2 ? R(arguments, 2) : [];
			return !$(t) || t instanceof RegExp ? t : n.length ? function() {
				return arguments.length ? t.apply(e, N(n, arguments, 0)) : t.apply(e, n)
			} : function() {
				return arguments.length ? t.apply(e, arguments) : t.call(e)
			}
		}

		function U(e, i) {
			var a = i;
			return "string" == typeof e && "$" === e.charAt(0) && "$" === e.charAt(1) ? a = n : T(i) ? a = "$WINDOW" : i && t === i ? a = "$DOCUMENT" : C(i) && (a = "$SCOPE"), a
		}

		function H(e, t) {
			return void 0 === e ? n : (w(t) || (t = t ? 2 : null), JSON.stringify(e, U, t))
		}

		function z(e) {
			return _(e) ? JSON.parse(e) : e
		}

		function V(e) {
			e = Xn(e).clone();
			try {
				e.empty()
			} catch (e) {}
			var t = Xn("<div>").append(e).html();
			try {
				return e[0].nodeType === mi ? Vn(t) : t.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/, function(e, t) {
					return "<" + Vn(t)
				})
			} catch (e) {
				return Vn(t)
			}
		}

		function W(e) {
			try {
				return decodeURIComponent(e)
			} catch (e) {}
		}

		function Y(e) {
			var t, n, i = {};
			return o((e || "").split("&"), function(e) {
				if (e && (t = e.replace(/\+/g, "%20").split("="), n = W(t[0]), y(n))) {
					var a = !y(t[1]) || W(t[1]);
					Wn.call(i, n) ? li(i[n]) ? i[n].push(a) : i[n] = [i[n], a] : i[n] = a
				}
			}), i
		}

		function G(e) {
			var t = [];
			return o(e, function(e, n) {
				li(e) ? o(e, function(e) {
					t.push(Q(n, !0) + (!0 === e ? "" : "=" + Q(e, !0)))
				}) : t.push(Q(n, !0) + (!0 === e ? "" : "=" + Q(e, !0)))
			}), t.length ? t.join("&") : ""
		}

		function K(e) {
			return Q(e, !0).replace(/%26/gi, "&").replace(/%3D/gi, "=").replace(/%2B/gi, "+")
		}

		function Q(e, t) {
			return encodeURIComponent(e).replace(/%40/gi, "@").replace(/%3A/gi, ":").replace(/%24/g, "$").replace(/%2C/gi, ",").replace(/%3B/gi, ";").replace(/%20/g, t ? "%20" : "+")
		}

		function X(e, t) {
			var n, i, a = pi.length;
			for (e = Xn(e), i = 0; i < a; ++i)
				if (n = pi[i] + t, _(n = e.attr(n))) return n;
			return null
		}

		function Z(e, t) {
			var n, i, a = {};
			o(pi, function(t) {
				var a = t + "app";
				!n && e.hasAttribute && e.hasAttribute(a) && (n = e, i = e.getAttribute(a))
			}), o(pi, function(t) {
				var a, o = t + "app";
				!n && (a = e.querySelector("[" + o.replace(":", "\\:") + "]")) && (n = a, i = a.getAttribute(o))
			}), n && (a.strictDi = null !== X(n, "strict-di"), t(n, i ? [i] : [], a))
		}

		function J(n, i, a) {
			b(a) || (a = {}), a = u({
				strictDi: !1
			}, a);
			var r = function() {
					if (n = Xn(n), n.injector()) {
						var e = n[0] === t ? "document" : V(n);
						throw ai("btstrpd", "App Already Bootstrapped with this Element '{0}'", e.replace(/</, "&lt;").replace(/>/, "&gt;"))
					}
					i = i || [], i.unshift(["$provide",
						function(e) {
							e.value("$rootElement", n)
						}
					]), a.debugInfoEnabled && i.push(["$compileProvider",
						function(e) {
							e.debugInfoEnabled(!0)
						}
					]), i.unshift("ng");
					var o = Ue(i, a.strictDi);
					return o.invoke(["$rootScope", "$rootElement", "$compile", "$injector",
						function(e, t, n, i) {
							e.$apply(function() {
								t.data("$injector", i), n(t)(e)
							})
						}
					]), o
				},
				s = /^NG_ENABLE_DEBUG_INFO!/,
				l = /^NG_DEFER_BOOTSTRAP!/;
			if (e && s.test(e.name) && (a.debugInfoEnabled = !0, e.name = e.name.replace(s, "")), e && !l.test(e.name)) return r();
			e.name = e.name.replace(l, ""), oi.resumeBootstrap = function(e) {
				return o(e, function(e) {
					i.push(e)
				}), r()
			}, $(oi.resumeDeferredBootstrap) && oi.resumeDeferredBootstrap()
		}

		function ee() {
			e.name = "NG_ENABLE_DEBUG_INFO!" + e.name, e.location.reload()
		}

		function te(e) {
			var t = oi.element(e).injector();
			if (!t) throw ai("test", "no injector found for element argument to getTestability");
			return t.get("$$testability")
		}

		function ne(e, t) {
			return t = t || "_", e.replace(fi, function(e, n) {
				return (n ? t : "") + e.toLowerCase()
			})
		}

		function ie(e, t, n) {
			if (!e) throw ai("areq", "Argument '{0}' is {1}", t || "?", n || "required");
			return e
		}

		function ae(e, t, n) {
			return n && li(e) && (e = e[e.length - 1]), ie($(e), t, "not a function, got " + (e && "object" == typeof e ? e.constructor.name || "Object" : typeof e)), e
		}

		function oe(e, t) {
			if ("hasOwnProperty" === e) throw ai("badname", "hasOwnProperty is not a valid {0} name", t)
		}

		function re(e, t, n) {
			if (!t) return e;
			for (var i, a = t.split("."), o = e, r = a.length, s = 0; s < r; s++) i = a[s], e && (e = (o = e)[i]);
			return !n && $(e) ? B(o, e) : e
		}

		function se(e) {
			var t = e[0],
				n = e[e.length - 1],
				i = [t];
			do {
				if (!(t = t.nextSibling)) break;
				i.push(t)
			} while (t !== n);
			return Xn(i)
		}

		function le() {
			return Object.create(null)
		}

		function ce(e) {
			function t(e, t, n) {
				return e[t] || (e[t] = n())
			}
			var n = i("$injector"),
				a = i("ng"),
				o = t(e, "angular", Object);
			return o.$$minErr = o.$$minErr || i, t(o, "module", function() {
				var e = {};
				return function(i, o, r) {
					return function(e, t) {
						if ("hasOwnProperty" === e) throw a("badname", "hasOwnProperty is not a valid {0} name", t)
					}(i, "module"), o && e.hasOwnProperty(i) && (e[i] = null), t(e, i, function() {
						function e(e, n, i, a) {
							return a || (a = t),
								function() {
									return a[i || "push"]([e, n, arguments]), c
								}
						}
						if (!o) throw n("nomod", "Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.", i);
						var t = [],
							a = [],
							s = [],
							l = e("$injector", "invoke", "push", a),
							c = {
								_invokeQueue: t,
								_configBlocks: a,
								_runBlocks: s,
								requires: o,
								name: i,
								provider: e("$provide", "provider"),
								factory: e("$provide", "factory"),
								service: e("$provide", "service"),
								value: e("$provide", "value"),
								constant: e("$provide", "constant", "unshift"),
								animation: e("$animateProvider", "register"),
								filter: e("$filterProvider", "register"),
								controller: e("$controllerProvider", "register"),
								directive: e("$compileProvider", "directive"),
								config: l,
								run: function(e) {
									return s.push(e), this
								}
							};
						return r && l(r), c
					})
				}
			})
		}

		function de(e) {
			var t = [];
			return JSON.stringify(e, function(e, n) {
				if (n = U(e, n), b(n)) {
					if (t.indexOf(n) >= 0) return "<<already seen>>";
					t.push(n)
				}
				return n
			})
		}

		function ue(e) {
			return "function" == typeof e ? e.toString().replace(/ \{[\s\S]*$/, "") : void 0 === e ? "undefined" : "string" != typeof e ? de(e) : e
		}

		function pe() {
			return ++xi
		}

		function fe(e) {
			return e.replace(Ti, function(e, t, n, i) {
				return i ? n.toUpperCase() : n
			}).replace(Ci, "Moz$1")
		}

		function he(e) {
			return !Ii.test(e)
		}

		function ge(e) {
			var t = e.nodeType;
			return t === gi || !t || t === yi
		}

		function me(e, t) {
			var n, i, a, r, s = t.createDocumentFragment(),
				l = [];
			if (he(e)) l.push(t.createTextNode(e));
			else {
				for (n = n || s.appendChild(t.createElement("div")), i = (Ei.exec(e) || ["", ""])[1].toLowerCase(), a = Mi[i] || Mi._default, n.innerHTML = a[1] + e.replace(Li, "<$1></$2>") + a[2], r = a[0]; r--;) n = n.lastChild;
				l = N(l, n.childNodes), n = s.firstChild, n.textContent = ""
			}
			return s.textContent = "", s.innerHTML = "", o(l, function(e) {
				s.appendChild(e)
			}), s
		}

		function ve(e, n) {
			n = n || t;
			var i;
			return (i = Pi.exec(e)) ? [n.createElement(i[1])] : (i = me(e, n)) ? i.childNodes : []
		}

		function ye(e) {
			if (e instanceof ye) return e;
			var t;
			if (_(e) && (e = ci(e), t = !0), !(this instanceof ye)) {
				if (t && "<" != e.charAt(0)) throw Si("nosel", "Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");
				return new ye(e)
			}
			t ? Se(this, ve(e)) : Se(this, e)
		}

		function be(e) {
			return e.cloneNode(!0)
		}

		function _e(e, t) {
			if (t || xe(e), e.querySelectorAll)
				for (var n = e.querySelectorAll("*"), i = 0, a = n.length; i < a; i++) xe(n[i])
		}

		function we(e, t, n, i) {
			if (y(i)) throw Si("offargs", "jqLite#off() does not support the `selector` argument");
			var a = $e(e),
				r = a && a.events,
				s = a && a.handle;
			if (s)
				if (t) o(t.split(" "), function(t) {
					if (y(n)) {
						var i = r[t];
						if (O(i || [], n), i && i.length > 0) return
					}
					ki(e, t, s), delete r[t]
				});
				else
					for (t in r) "$destroy" !== t && ki(e, t, s), delete r[t]
		}

		function xe(e, t) {
			var i = e.ng339,
				a = i && wi[i];
			if (a) {
				if (t) return void delete a.data[t];
				a.handle && (a.events.$destroy && a.handle({}, "$destroy"), we(e)), delete wi[i], e.ng339 = n
			}
		}

		function $e(e, t) {
			var i = e.ng339,
				a = i && wi[i];
			return t && !a && (e.ng339 = i = pe(), a = wi[i] = {
				events: {},
				data: {},
				handle: n
			}), a
		}

		function ke(e, t, n) {
			if (ge(e)) {
				var i = y(n),
					a = !i && t && !b(t),
					o = !t,
					r = $e(e, !a),
					s = r && r.data;
				if (i) s[t] = n;
				else {
					if (o) return s;
					if (a) return s && s[t];
					u(s, t)
				}
			}
		}

		function Te(e, t) {
			return !!e.getAttribute && (" " + (e.getAttribute("class") || "") + " ").replace(/[\n\t]/g, " ").indexOf(" " + t + " ") > -1
		}

		function Ce(e, t) {
			t && e.setAttribute && o(t.split(" "), function(t) {
				e.setAttribute("class", ci((" " + (e.getAttribute("class") || "") + " ").replace(/[\n\t]/g, " ").replace(" " + ci(t) + " ", " ")))
			})
		}

		function De(e, t) {
			if (t && e.setAttribute) {
				var n = (" " + (e.getAttribute("class") || "") + " ").replace(/[\n\t]/g, " ");
				o(t.split(" "), function(e) {
					e = ci(e), -1 === n.indexOf(" " + e + " ") && (n += e + " ")
				}), e.setAttribute("class", ci(n))
			}
		}

		function Se(e, t) {
			if (t)
				if (t.nodeType) e[e.length++] = t;
				else {
					var n = t.length;
					if ("number" == typeof n && t.window !== t) {
						if (n)
							for (var i = 0; i < n; i++) e[e.length++] = t[i]
					} else e[e.length++] = t
				}
		}

		function Pe(e, t) {
			return Ie(e, "$" + (t || "ngController") + "Controller")
		}

		function Ie(e, t, i) {
			e.nodeType == yi && (e = e.documentElement);
			for (var a = li(t) ? t : [t]; e;) {
				for (var o = 0, r = a.length; o < r; o++)
					if ((i = Xn.data(e, a[o])) !== n) return i;
				e = e.parentNode || e.nodeType === bi && e.host
			}
		}

		function Ee(e) {
			for (_e(e, !0); e.firstChild;) e.removeChild(e.firstChild)
		}

		function Le(e, t) {
			t || _e(e);
			var n = e.parentNode;
			n && n.removeChild(e)
		}

		function Me(t, n) {
			n = n || e, "complete" === n.document.readyState ? n.setTimeout(t) : Xn(n).on("load", t)
		}

		function Ae(e, t) {
			var n = Oi[t.toLowerCase()];
			return n && ji[A(e)] && n
		}

		function Oe(e, t) {
			var n = e.nodeName;
			return ("INPUT" === n || "TEXTAREA" === n) && Fi[t]
		}

		function je(e, t) {
			var n = function(n, i) {
				n.isDefaultPrevented = function() {
					return n.defaultPrevented
				};
				var a = t[i || n.type],
					o = a ? a.length : 0;
				if (o) {
					if (v(n.immediatePropagationStopped)) {
						var r = n.stopImmediatePropagation;
						n.stopImmediatePropagation = function() {
							n.immediatePropagationStopped = !0, n.stopPropagation && n.stopPropagation(), r && r.call(n)
						}
					}
					n.isImmediatePropagationStopped = function() {
						return !0 === n.immediatePropagationStopped
					}, o > 1 && (a = F(a));
					for (var s = 0; s < o; s++) n.isImmediatePropagationStopped() || a[s].call(e, n)
				}
			};
			return n.elem = e, n
		}

		function Fe() {
			this.$get = function() {
				return u(ye, {
					hasClass: function(e, t) {
						return e.attr && (e = e[0]), Te(e, t)
					},
					addClass: function(e, t) {
						return e.attr && (e = e[0]), De(e, t)
					},
					removeClass: function(e, t) {
						return e.attr && (e = e[0]), Ce(e, t)
					}
				})
			}
		}

		function qe(e, t) {
			var n = e && e.$$hashKey;
			if (n) return "function" == typeof n && (n = e.$$hashKey()), n;
			var i = typeof e;
			return n = "function" == i || "object" == i && null !== e ? e.$$hashKey = i + ":" + (t || c)() : i + ":" + e
		}

		function Ne(e, t) {
			if (t) {
				var n = 0;
				this.nextUid = function() {
					return ++n
				}
			}
			o(e, this.put, this)
		}

		function Re(e) {
			var t = e.toString().replace(Bi, ""),
				n = t.match(qi);
			return n ? "function(" + (n[1] || "").replace(/[\s\r\n]+/, " ") + ")" : "fn"
		}

		function Be(e, t, n) {
			var i, a, r, s;
			if ("function" == typeof e) {
				if (!(i = e.$inject)) {
					if (i = [], e.length) {
						if (t) throw _(n) && n || (n = e.name || Re(e)), Ui("strictdi", "{0} is not using explicit annotation and cannot be invoked in strict mode", n);
						a = e.toString().replace(Bi, ""), r = a.match(qi), o(r[1].split(Ni), function(e) {
							e.replace(Ri, function(e, t, n) {
								i.push(n)
							})
						})
					}
					e.$inject = i
				}
			} else li(e) ? (s = e.length - 1, ae(e[s], "fn"), i = e.slice(0, s)) : ae(e, "fn", !0);
			return i
		}

		function Ue(e, t) {
			function i(e) {
				return function(t, n) {
					if (!b(t)) return e(t, n);
					o(t, l(e))
				}
			}

			function a(e, t) {
				if (oe(e, "service"), ($(t) || li(t)) && (t = C.instantiate(t)), !t.$get) throw Ui("pget", "Provider '{0}' must define $get factory method.", e);
				return T[e + w] = t
			}

			function r(e, t) {
				return function() {
					var n = S.invoke(t, this);
					if (v(n)) throw Ui("undef", "Provider '{0}' must return a value from $get factory method.", e);
					return n
				}
			}

			function s(e, t, n) {
				return a(e, {
					$get: !1 !== n ? r(e, t) : t
				})
			}

			function c(e, t) {
				return s(e, ["$injector",
					function(e) {
						return e.instantiate(t)
					}
				])
			}

			function d(e, t) {
				return s(e, m(t), !1)
			}

			function u(e, t) {
				oe(e, "constant"), T[e] = t, D[e] = t
			}

			function p(e, t) {
				var n = C.get(e + w),
					i = n.$get;
				n.$get = function() {
					var e = S.invoke(i, n);
					return S.invoke(t, null, {
						$delegate: e
					})
				}
			}

			function f(e) {
				var t, n = [];
				return o(e, function(e) {
					function i(e) {
						var t, n;
						for (t = 0, n = e.length; t < n; t++) {
							var i = e[t],
								a = C.get(i[0]);
							a[i[1]].apply(a, i[2])
						}
					}
					if (!k.get(e)) {
						k.put(e, !0);
						try {
							_(e) ? (t = Jn(e), n = n.concat(f(t.requires)).concat(t._runBlocks), i(t._invokeQueue), i(t._configBlocks)) : $(e) ? n.push(C.invoke(e)) : li(e) ? n.push(C.invoke(e)) : ae(e, "module")
						} catch (t) {
							throw li(e) && (e = e[e.length - 1]), t.message && t.stack && -1 == t.stack.indexOf(t.message) && (t = t.message + "\n" + t.stack), Ui("modulerr", "Failed to instantiate module {0} due to:\n{1}", e, t.stack || t.message || t)
						}
					}
				}), n
			}

			function g(e, n) {
				function i(t, i) {
					if (e.hasOwnProperty(t)) {
						if (e[t] === y) throw Ui("cdep", "Circular dependency found: {0}", t + " <- " + x.join(" <- "));
						return e[t]
					}
					try {
						return x.unshift(t), e[t] = y, e[t] = n(t, i)
					} catch (n) {
						throw e[t] === y && delete e[t], n
					} finally {
						x.shift()
					}
				}

				function a(e, n, a, o) {
					"string" == typeof a && (o = a, a = null);
					var r, s, l, c = [],
						d = Ue.$$annotate(e, t, o);
					for (s = 0, r = d.length; s < r; s++) {
						if ("string" != typeof(l = d[s])) throw Ui("itkn", "Incorrect injection token! Expected service name as string, got {0}", l);
						c.push(a && a.hasOwnProperty(l) ? a[l] : i(l, o))
					}
					return li(e) && (e = e[r]), e.apply(n, c)
				}

				function o(e, t, n) {
					var i = Object.create((li(e) ? e[e.length - 1] : e).prototype || null),
						o = a(e, i, t, n);
					return b(o) || $(o) ? o : i
				}
				return {
					invoke: a,
					instantiate: o,
					get: i,
					annotate: Ue.$$annotate,
					has: function(t) {
						return T.hasOwnProperty(t + w) || e.hasOwnProperty(t)
					}
				}
			}
			t = !0 === t;
			var y = {},
				w = "Provider",
				x = [],
				k = new Ne([], !0),
				T = {
					$provide: {
						provider: i(a),
						factory: i(s),
						service: i(c),
						value: i(d),
						constant: i(u),
						decorator: p
					}
				},
				C = T.$injector = g(T, function(e, t) {
					throw oi.isString(t) && x.push(t), Ui("unpr", "Unknown provider: {0}", x.join(" <- "))
				}),
				D = {},
				S = D.$injector = g(D, function(e, t) {
					var i = C.get(e + w, t);
					return S.invoke(i.$get, i, n, e)
				});
			return o(f(e), function(e) {
				S.invoke(e || h)
			}), S
		}

		function He() {
			var e = !0;
			this.disableAutoScrolling = function() {
				e = !1
			}, this.$get = ["$window", "$location", "$rootScope",
				function(t, n, i) {
					function a(e) {
						var t = null;
						return Array.prototype.some.call(e, function(e) {
							if ("a" === A(e)) return t = e, !0
						}), t
					}

					function o() {
						var e = s.yOffset;
						if ($(e)) e = e();
						else if (L(e)) {
							var n = e[0],
								i = t.getComputedStyle(n);
							e = "fixed" !== i.position ? 0 : n.getBoundingClientRect().bottom
						} else w(e) || (e = 0);
						return e
					}

					function r(e) {
						if (e) {
							e.scrollIntoView();
							var n = o();
							if (n) {
								var i = e.getBoundingClientRect().top;
								t.scrollBy(0, i - n)
							}
						} else t.scrollTo(0, 0)
					}

					function s() {
						var e, t = n.hash();
						t ? (e = l.getElementById(t)) ? r(e) : (e = a(l.getElementsByName(t))) ? r(e) : "top" === t && r(null) : r(null)
					}
					var l = t.document;
					return e && i.$watch(function() {
						return n.hash()
					}, function(e, t) {
						e === t && "" === e || Me(function() {
							i.$evalAsync(s)
						})
					}), s
				}
			]
		}

		function ze() {
			this.$get = ["$$rAF", "$timeout",
				function(e, t) {
					return e.supported ? function(t) {
						return e(t)
					} : function(e) {
						return t(e, 0, !1)
					}
				}
			]
		}

		function Ve(e, t, i, a) {
			function r(e) {
				try {
					e.apply(null, R(arguments, 1))
				} finally {
					if (0 === --$)
						for (; k.length;) try {
							k.pop()()
						} catch (e) {
							i.error(e)
						}
				}
			}

			function s(e) {
				var t = e.indexOf("#");
				return -1 === t ? "" : e.substr(t + 1)
			}

			function l(e, t) {
				! function n() {
					o(C, function(e) {
						e()
					}), T = t(n, e)
				}()
			}

			function c() {
				d(), u()
			}

			function d() {
				D = e.history.state, D = v(D) ? null : D, q(D, A) && (D = A), A = D
			}

			function u() {
				P === f.url() && S === D || (P = f.url(), S = D, o(L, function(e) {
					e(f.url(), D)
				}))
			}

			function p(e) {
				try {
					return decodeURIComponent(e)
				} catch (t) {
					return e
				}
			}
			var f = this,
				g = t[0],
				m = e.location,
				y = e.history,
				b = e.setTimeout,
				w = e.clearTimeout,
				x = {};
			f.isMock = !1;
			var $ = 0,
				k = [];
			f.$$completeOutstandingRequest = r, f.$$incOutstandingRequestCount = function() {
				$++
			}, f.notifyWhenNoOutstandingRequests = function(e) {
				o(C, function(e) {
					e()
				}), 0 === $ ? e() : k.push(e)
			};
			var T, C = [];
			f.addPollFn = function(e) {
				return v(T) && l(100, b), C.push(e), e
			};
			var D, S, P = m.href,
				I = t.find("base"),
				E = null;
			d(), S = D, f.url = function(t, n, i) {
				if (v(i) && (i = null), m !== e.location && (m = e.location), y !== e.history && (y = e.history), t) {
					var o = S === i;
					if (P === t && (!a.history || o)) return f;
					var r = P && bt(P) === bt(t);
					return P = t, S = i, !a.history || r && o ? (r || (E = t), n ? m.replace(t) : r ? m.hash = s(t) : m.href = t) : (y[n ? "replaceState" : "pushState"](i, "", t), d(), S = D), f
				}
				return E || m.href.replace(/%27/g, "'")
			}, f.state = function() {
				return D
			};
			var L = [],
				M = !1,
				A = null;
			f.onUrlChange = function(t) {
				return M || (a.history && Xn(e).on("popstate", c), Xn(e).on("hashchange", c), M = !0), L.push(t), t
			}, f.$$checkUrlChange = u, f.baseHref = function() {
				var e = I.attr("href");
				return e ? e.replace(/^(https?\:)?\/\/[^\/]*/, "") : ""
			};
			var O = {},
				j = "",
				F = f.baseHref();
			f.cookies = function(e, t) {
				var a, o, r, s, l;
				if (!e) {
					if (g.cookie !== j)
						for (j = g.cookie, o = j.split("; "), O = {}, s = 0; s < o.length; s++) r = o[s], (l = r.indexOf("=")) > 0 && (e = p(r.substring(0, l)), O[e] === n && (O[e] = p(r.substring(l + 1))));
					return O
				}
				t === n ? g.cookie = encodeURIComponent(e) + "=;path=" + F + ";expires=Thu, 01 Jan 1970 00:00:00 GMT" : _(t) && (a = (g.cookie = encodeURIComponent(e) + "=" + encodeURIComponent(t) + ";path=" + F).length + 1) > 4096 && i.warn("Cookie '" + e + "' possibly not set or overflowed because it was too large (" + a + " > 4096 bytes)!")
			}, f.defer = function(e, t) {
				var n;
				return $++, n = b(function() {
					delete x[n], r(e)
				}, t || 0), x[n] = !0, n
			}, f.defer.cancel = function(e) {
				return !!x[e] && (delete x[e], w(e), r(h), !0)
			}
		}

		function We() {
			this.$get = ["$window", "$log", "$sniffer", "$document",
				function(e, t, n, i) {
					return new Ve(e, i, t, n)
				}
			]
		}

		function Ye() {
			this.$get = function() {
				function e(e, n) {
					function a(e) {
						e != p && (f ? f == e && (f = e.n) : f = e, o(e.n, e.p), o(e, p), p = e, p.n = null)
					}

					function o(e, t) {
						e != t && (e && (e.p = t), t && (t.n = e))
					}
					if (e in t) throw i("$cacheFactory")("iid", "CacheId '{0}' is already taken!", e);
					var r = 0,
						s = u({}, n, {
							id: e
						}),
						l = {},
						c = n && n.capacity || Number.MAX_VALUE,
						d = {},
						p = null,
						f = null;
					return t[e] = {
						put: function(e, t) {
							if (c < Number.MAX_VALUE) {
								a(d[e] || (d[e] = {
									key: e
								}))
							}
							if (!v(t)) return e in l || r++, l[e] = t, r > c && this.remove(f.key), t
						},
						get: function(e) {
							if (c < Number.MAX_VALUE) {
								var t = d[e];
								if (!t) return;
								a(t)
							}
							return l[e]
						},
						remove: function(e) {
							if (c < Number.MAX_VALUE) {
								var t = d[e];
								if (!t) return;
								t == p && (p = t.p), t == f && (f = t.n), o(t.n, t.p), delete d[e]
							}
							delete l[e], r--
						},
						removeAll: function() {
							l = {}, r = 0, d = {}, p = f = null
						},
						destroy: function() {
							l = null, s = null, d = null, delete t[e]
						},
						info: function() {
							return u({}, s, {
								size: r
							})
						}
					}
				}
				var t = {};
				return e.info = function() {
					var e = {};
					return o(t, function(t, n) {
						e[n] = t.info()
					}), e
				}, e.get = function(e) {
					return t[e]
				}, e
			}
		}

		function Ge() {
			this.$get = ["$cacheFactory",
				function(e) {
					return e("templates")
				}
			]
		}

		function Ke(e, i) {
			function a(e, t) {
				var n = /^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,
					i = {};
				return o(e, function(e, a) {
					var o = e.match(n);
					if (!o) throw Vi("iscp", "Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}", t, a, e);
					i[a] = {
						mode: o[1][0],
						collection: "*" === o[2],
						optional: "?" === o[3],
						attrName: o[4] || a
					}
				}), i
			}
			var r = {},
				s = "Directive",
				c = /^\s*directive\:\s*([\w\-]+)\s+(.*)$/,
				d = /(([\w\-]+)(?:\:([^;]+))?;?)/,
				p = M("ngSrc,ngSrcset,src,srcset"),
				v = /^(?:(\^\^?)?(\?)?(\^\^?)?)?/,
				w = /^(on[a-z]+|formaction)$/;
			this.directive = function t(n, i) {
				return oe(n, "directive"), _(n) ? (ie(i, "directiveFactory"), r.hasOwnProperty(n) || (r[n] = [], e.factory(n + s, ["$injector", "$exceptionHandler",
					function(e, t) {
						var i = [];
						return o(r[n], function(o, r) {
							try {
								var s = e.invoke(o);
								$(s) ? s = {
									compile: m(s)
								} : !s.compile && s.link && (s.compile = m(s.link)), s.priority = s.priority || 0, s.index = r, s.name = s.name || n, s.require = s.require || s.controller && s.name, s.restrict = s.restrict || "EA", b(s.scope) && (s.$$isolateBindings = a(s.scope, s.name)), i.push(s)
							} catch (e) {
								t(e)
							}
						}), i
					}
				])), r[n].push(i)) : o(n, l(t)), this
			}, this.aHrefSanitizationWhitelist = function(e) {
				return y(e) ? (i.aHrefSanitizationWhitelist(e), this) : i.aHrefSanitizationWhitelist()
			}, this.imgSrcSanitizationWhitelist = function(e) {
				return y(e) ? (i.imgSrcSanitizationWhitelist(e), this) : i.imgSrcSanitizationWhitelist()
			};
			var x = !0;
			this.debugInfoEnabled = function(e) {
				return y(e) ? (x = e, this) : x
			}, this.$get = ["$injector", "$interpolate", "$exceptionHandler", "$templateRequest", "$parse", "$controller", "$rootScope", "$document", "$sce", "$animate", "$$sanitizeUri",
				function(e, i, a, l, m, y, k, T, D, S, P) {
					function I(e, t) {
						try {
							e.addClass(t)
						} catch (e) {}
					}

					function E(e, t, n, i, a) {
						e instanceof Xn || (e = Xn(e)), o(e, function(t, n) {
							t.nodeType == mi && t.nodeValue.match(/\S+/) && (e[n] = Xn(t).wrap("<span></span>").parent()[0])
						});
						var r = M(e, t, e, n, i, a);
						E.$$addScopeClass(e);
						var s = null;
						return function(t, n, i) {
							ie(t, "scope"), i = i || {};
							var a = i.parentBoundTranscludeFn,
								o = i.transcludeControllers,
								l = i.futureParentElement;
							a && a.$$boundTransclude && (a = a.$$boundTransclude), s || (s = L(l));
							var c;
							if (c = "html" !== s ? Xn(Z(s, Xn("<div>").append(e).html())) : n ? Ai.clone.call(e) : e, o)
								for (var d in o) c.data("$" + d + "Controller", o[d].instance);
							return E.$$addScopeInfo(c, t), n && n(c, t), r && r(t, c, c, a), c
						}
					}

					function L(e) {
						var t = e && e[0];
						return t && "foreignobject" !== A(t) && t.toString().match(/SVG/) ? "svg" : "html"
					}

					function M(e, t, i, a, o, r) {
						function s(e, i, a, o) {
							var r, s, l, c, d, u, p, f, m;
							if (h) {
								var v = i.length;
								for (m = new Array(v), d = 0; d < g.length; d += 3) p = g[d], m[p] = i[p]
							} else m = i;
							for (d = 0, u = g.length; d < u;) l = m[g[d++]], r = g[d++], s = g[d++], r ? (r.scope ? (c = e.$new(), E.$$addScopeInfo(Xn(l), c)) : c = e, f = r.transcludeOnThisElement ? j(e, r.transclude, o, r.elementTranscludeOnThisElement) : !r.templateOnThisElement && o ? o : !o && t ? j(e, t) : null, r(s, c, l, a, f)) : s && s(e, l.childNodes, n, o)
						}
						for (var l, c, d, u, p, f, h, g = [], m = 0; m < e.length; m++) l = new re, c = F(e[m], [], l, 0 === m ? a : n, o), d = c.length ? U(c, e[m], l, t, i, null, [], [], r) : null, d && d.scope && E.$$addScopeClass(l.$$element), p = d && d.terminal || !(u = e[m].childNodes) || !u.length ? null : M(u, d ? (d.transcludeOnThisElement || !d.templateOnThisElement) && d.transclude : t), (d || p) && (g.push(m, d, p), f = !0, h = h || d), r = null;
						return f ? s : null
					}

					function j(e, t, n, i) {
						return function(i, a, o, r, s) {
							return i || (i = e.$new(!1, s), i.$$transcluded = !0), t(i, a, {
								parentBoundTranscludeFn: n,
								transcludeControllers: o,
								futureParentElement: r
							})
						}
					}

					function F(e, t, n, i, a) {
						var o, r, s = e.nodeType,
							l = n.$attr;
						switch (s) {
							case gi:
								z(t, Qe(A(e)), "E", i, a);
								for (var u, p, f, h, g, m, v = e.attributes, y = 0, w = v && v.length; y < w; y++) {
									var x = !1,
										$ = !1;
									u = v[y], p = u.name, g = ci(u.value), h = Qe(p), (m = ue.test(h)) && (p = p.replace(Wi, "").substr(8).replace(/_(.)/g, function(e, t) {
										return t.toUpperCase()
									}));
									var k = h.replace(/(Start|End)$/, "");
									W(k) && h === k + "Start" && (x = p, $ = p.substr(0, p.length - 5) + "end", p = p.substr(0, p.length - 6)), f = Qe(p.toLowerCase()), l[f] = p, !m && n.hasOwnProperty(f) || (n[f] = g, Ae(e, f) && (n[f] = !0)), ee(e, t, g, f, m), z(t, f, "A", i, a, x, $)
								}
								if (r = e.className, b(r) && (r = r.animVal), _(r) && "" !== r)
									for (; o = d.exec(r);) f = Qe(o[2]), z(t, f, "C", i, a) && (n[f] = ci(o[3])), r = r.substr(o.index + o[0].length);
								break;
							case mi:
								X(t, e.nodeValue);
								break;
							case vi:
								try {
									o = c.exec(e.nodeValue), o && (f = Qe(o[1]), z(t, f, "M", i, a) && (n[f] = ci(o[2])))
								} catch (e) {}
						}
						return t.sort(K), t
					}

					function N(e, t, n) {
						var i = [],
							a = 0;
						if (t && e.hasAttribute && e.hasAttribute(t))
							do {
								if (!e) throw Vi("uterdir", "Unterminated attribute, found '{0}' but no matching '{1}' found.", t, n);
								e.nodeType == gi && (e.hasAttribute(t) && a++, e.hasAttribute(n) && a--), i.push(e), e = e.nextSibling
							} while (a > 0);
						else i.push(e);
						return Xn(i)
					}

					function B(e, t, n) {
						return function(i, a, o, r, s) {
							return a = N(a[0], t, n), e(i, a, o, r, s)
						}
					}

					function U(e, r, s, l, c, d, u, p, f) {
						function h(e, t, n, i) {
							e && (n && (e = B(e, n, i)), e.require = T.require, e.directiveName = D, (A === T || T.$$isolateScope) && (e = ae(e, {
								isolateScope: !0
							})), u.push(e)), t && (n && (t = B(t, n, i)), t.require = T.require, t.directiveName = D, (A === T || T.$$isolateScope) && (t = ae(t, {
								isolateScope: !0
							})), p.push(t))
						}

						function g(e, t, n, i) {
							var a, r, s = "data",
								l = !1,
								c = n;
							if (_(t)) {
								if (r = t.match(v), t = t.substring(r[0].length), r[3] && (r[1] ? r[3] = null : r[1] = r[3]), "^" === r[1] ? s = "inheritedData" : "^^" === r[1] && (s = "inheritedData", c = n.parent()), "?" === r[2] && (l = !0), a = null, i && "data" === s && (a = i[t]) && (a = a.instance), !(a = a || c[s]("$" + t + "Controller")) && !l) throw Vi("ctreq", "Controller '{0}', required by directive '{1}', can't be found!", t, e);
								return a || null
							}
							return li(t) && (a = [], o(t, function(t) {
								a.push(g(e, t, n, i))
							})), a
						}

						function w(e, t, a, l, c) {
							function d(e, t, i) {
								var a;
								return C(e) || (i = t, t = e, e = n), W && (a = w), i || (i = W ? $.parent() : $), c(e, t, a, i, P)
							}
							var f, h, v, b, _, w, x, $, T;
							if (r === a ? (T = s, $ = s.$$element) : ($ = Xn(a), T = new re($, s)), A && (_ = t.$new(!0)), c && (x = d, x.$$boundTransclude = c), M && (k = {}, w = {}, o(M, function(e) {
								var n, i = {
									$scope: e === A || e.$$isolateScope ? _ : t,
									$element: $,
									$attrs: T,
									$transclude: x
								};
								b = e.controller, "@" == b && (b = T[e.name]), n = y(b, i, !0, e.controllerAs), w[e.name] = n, W || $.data("$" + e.name + "Controller", n.instance), k[e.name] = n
							})), A) {
								E.$$addScopeInfo($, _, !0, !(O && (O === A || O === A.$$originalDirective))), E.$$addScopeClass($, !0);
								var D = k && k[A.name],
									S = _;
								D && D.identifier && !0 === A.bindToController && (S = D.instance), o(_.$$isolateBindings = A.$$isolateBindings, function(e, n) {
									var a, o, r, s, l = e.attrName,
										c = e.optional,
										d = e.mode;
									switch (d) {
										case "@":
											T.$observe(l, function(e) {
												S[n] = e
											}), T.$$observers[l].$$scope = t, T[l] && (S[n] = i(T[l])(t));
											break;
										case "=":
											if (c && !T[l]) return;
											o = m(T[l]), s = o.literal ? q : function(e, t) {
												return e === t || e !== e && t !== t
											}, r = o.assign || function() {
												throw a = S[n] = o(t), Vi("nonassign", "Expression '{0}' used with directive '{1}' is non-assignable!", T[l], A.name)
											}, a = S[n] = o(t);
											var u = function(e) {
												return s(e, S[n]) || (s(e, a) ? r(t, e = S[n]) : S[n] = e), a = e
											};
											u.$stateful = !0;
											var p;
											p = e.collection ? t.$watchCollection(T[l], u) : t.$watch(m(T[l], u), null, o.literal), _.$on("$destroy", p);
											break;
										case "&":
											o = m(T[l]), S[n] = function(e) {
												return o(t, e)
											}
									}
								})
							}
							for (k && (o(k, function(e) {
								e()
							}), k = null), f = 0, h = u.length; f < h; f++) v = u[f], oe(v, v.isolateScope ? _ : t, $, T, v.require && g(v.directiveName, v.require, $, w), x);
							var P = t;
							for (A && (A.template || null === A.templateUrl) && (P = _), e && e(P, a.childNodes, n, c), f = p.length - 1; f >= 0; f--) v = p[f], oe(v, v.isolateScope ? _ : t, $, T, v.require && g(v.directiveName, v.require, $, w), x)
						}
						f = f || {};
						for (var x, k, T, D, S, P, I, L = -Number.MAX_VALUE, M = f.controllerDirectives, A = f.newIsolateScopeDirective, O = f.templateDirective, j = f.nonTlbTranscludeDirective, U = !1, z = !1, W = f.hasElementTranscludeDirective, K = s.$$element = Xn(r), X = d, J = l, ee = 0, ne = e.length; ee < ne; ee++) {
							T = e[ee];
							var ie = T.$$start,
								se = T.$$end;
							if (ie && (K = N(r, ie, se)), S = n, L > T.priority) break;
							if ((I = T.scope) && (T.templateUrl || (b(I) ? (Q("new/isolated scope", A || x, T, K), A = T) : Q("new/isolated scope", A, T, K)), x = x || T), D = T.name, !T.templateUrl && T.controller && (I = T.controller, M = M || {}, Q("'" + D + "' controller", M[D], T, K), M[D] = T), (I = T.transclude) && (U = !0, T.$$tlb || (Q("transclusion", j, T, K), j = T), "element" == I ? (W = !0, L = T.priority, S = K, K = s.$$element = Xn(t.createComment(" " + D + ": " + s[D] + " ")), r = K[0], te(c, R(S), r), J = E(S, l, L, X && X.name, {
								nonTlbTranscludeDirective: j
							})) : (S = Xn(be(r)).contents(), K.empty(), J = E(S, l))), T.template)
								if (z = !0, Q("template", O, T, K), O = T, I = $(T.template) ? T.template(K, s) : T.template, I = de(I), T.replace) {
									if (X = T, S = he(I) ? [] : Ze(Z(T.templateNamespace, ci(I))), r = S[0], 1 != S.length || r.nodeType !== gi) throw Vi("tplrt", "Template for directive '{0}' must have exactly one root element. {1}", D, "");
									te(c, K, r);
									var le = {
											$attr: {}
										},
										ce = F(r, [], le),
										ue = e.splice(ee + 1, e.length - (ee + 1));
									A && H(ce), e = e.concat(ce).concat(ue), Y(s, le), ne = e.length
								} else K.html(I);
							if (T.templateUrl) z = !0, Q("template", O, T, K), O = T, T.replace && (X = T), w = G(e.splice(ee, e.length - ee), K, s, c, U && J, u, p, {
								controllerDirectives: M,
								newIsolateScopeDirective: A,
								templateDirective: O,
								nonTlbTranscludeDirective: j
							}), ne = e.length;
							else if (T.compile) try {
								P = T.compile(K, s, J), $(P) ? h(null, P, ie, se) : P && h(P.pre, P.post, ie, se)
							} catch (e) {
								a(e, V(K))
							}
							T.terminal && (w.terminal = !0, L = Math.max(L, T.priority))
						}
						return w.scope = x && !0 === x.scope, w.transcludeOnThisElement = U, w.elementTranscludeOnThisElement = W, w.templateOnThisElement = z, w.transclude = J, f.hasElementTranscludeDirective = W, w
					}

					function H(e) {
						for (var t = 0, n = e.length; t < n; t++) e[t] = f(e[t], {
							$$isolateScope: !0
						})
					}

					function z(t, i, o, l, c, d, u) {
						if (i === c) return null;
						var p = null;
						if (r.hasOwnProperty(i))
							for (var h, g = e.get(i + s), m = 0, v = g.length; m < v; m++) try {
								h = g[m], (l === n || l > h.priority) && -1 != h.restrict.indexOf(o) && (d && (h = f(h, {
									$$start: d,
									$$end: u
								})), t.push(h), p = h)
							} catch (e) {
								a(e)
							}
						return p
					}

					function W(t) {
						if (r.hasOwnProperty(t))
							for (var n, i = e.get(t + s), a = 0, o = i.length; a < o; a++)
								if (n = i[a], n.multiElement) return !0;
						return !1
					}

					function Y(e, t) {
						var n = t.$attr,
							i = e.$attr,
							a = e.$$element;
						o(e, function(i, a) {
							"$" != a.charAt(0) && (t[a] && t[a] !== i && (i += ("style" === a ? ";" : " ") + t[a]), e.$set(a, i, !0, n[a]))
						}), o(t, function(t, o) {
							"class" == o ? (I(a, t), e.class = (e.class ? e.class + " " : "") + t) : "style" == o ? (a.attr("style", a.attr("style") + ";" + t), e.style = (e.style ? e.style + ";" : "") + t) : "$" == o.charAt(0) || e.hasOwnProperty(o) || (e[o] = t, i[o] = n[o])
						})
					}

					function G(e, t, n, i, a, r, s, c) {
						var d, u, p = [],
							h = t[0],
							g = e.shift(),
							m = f(g, {
								templateUrl: null,
								transclude: null,
								replace: null,
								$$originalDirective: g
							}),
							v = $(g.templateUrl) ? g.templateUrl(t, n) : g.templateUrl,
							y = g.templateNamespace;
						return t.empty(), l(D.getTrustedResourceUrl(v)).then(function(l) {
								var f, _, w, x;
								if (l = de(l), g.replace) {
									if (w = he(l) ? [] : Ze(Z(y, ci(l))), f = w[0], 1 != w.length || f.nodeType !== gi) throw Vi("tplrt", "Template for directive '{0}' must have exactly one root element. {1}", g.name, v);
									_ = {
										$attr: {}
									}, te(i, t, f);
									var $ = F(f, [], _);
									b(g.scope) && H($), e = $.concat(e), Y(n, _)
								} else f = h, t.html(l);
								for (e.unshift(m), d = U(e, f, n, a, t, g, r, s, c), o(i, function(e, n) {
									e == f && (i[n] = t[0])
								}), u = M(t[0].childNodes, a); p.length;) {
									var k = p.shift(),
										T = p.shift(),
										C = p.shift(),
										D = p.shift(),
										S = t[0];
									if (!k.$$destroyed) {
										if (T !== h) {
											var P = T.className;
											c.hasElementTranscludeDirective && g.replace || (S = be(f)), te(C, Xn(T), S), I(Xn(S), P)
										}
										x = d.transcludeOnThisElement ? j(k, d.transclude, D) : D, d(u, k, S, i, x)
									}
								}
								p = null
							}),
							function(e, t, n, i, a) {
								var o = a;
								t.$$destroyed || (p ? p.push(t, n, i, o) : (d.transcludeOnThisElement && (o = j(t, d.transclude, a)), d(u, t, n, i, o)))
							}
					}

					function K(e, t) {
						var n = t.priority - e.priority;
						return 0 !== n ? n : e.name !== t.name ? e.name < t.name ? -1 : 1 : e.index - t.index
					}

					function Q(e, t, n, i) {
						if (t) throw Vi("multidir", "Multiple directives [{0}, {1}] asking for {2} on: {3}", t.name, n.name, e, V(i))
					}

					function X(e, t) {
						var n = i(t, !0);
						n && e.push({
							priority: 0,
							compile: function(e) {
								var t = e.parent(),
									i = !!t.length;
								return i && E.$$addBindingClass(t),
									function(e, t) {
										var a = t.parent();
										i || E.$$addBindingClass(a), E.$$addBindingInfo(a, n.expressions), e.$watch(n, function(e) {
											t[0].nodeValue = e
										})
									}
							}
						})
					}

					function Z(e, n) {
						switch (e = Vn(e || "html")) {
							case "svg":
							case "math":
								var i = t.createElement("div");
								return i.innerHTML = "<" + e + ">" + n + "</" + e + ">", i.childNodes[0].childNodes;
							default:
								return n
						}
					}

					function J(e, t) {
						if ("srcdoc" == t) return D.HTML;
						var n = A(e);
						return "xlinkHref" == t || "form" == n && "action" == t || "img" != n && ("src" == t || "ngSrc" == t) ? D.RESOURCE_URL : void 0
					}

					function ee(e, t, n, a, o) {
						var r = J(e, a);
						o = p[a] || o;
						var s = i(n, !0, r, o);
						if (s) {
							if ("multiple" === a && "select" === A(e)) throw Vi("selmulti", "Binding to the 'multiple' attribute is not supported. Element: {0}", V(e));
							t.push({
								priority: 100,
								compile: function() {
									return {
										pre: function(e, t, l) {
											var c = l.$$observers || (l.$$observers = {});
											if (w.test(a)) throw Vi("nodomevents", "Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");
											var d = l[a];
											d !== n && (s = d && i(d, !0, r, o), n = d), s && (l[a] = s(e), (c[a] || (c[a] = [])).$$inter = !0, (l.$$observers && l.$$observers[a].$$scope || e).$watch(s, function(e, t) {
												"class" === a && e != t ? l.$updateClass(e, t) : l.$set(a, e)
											}))
										}
									}
								}
							})
						}
					}

					function te(e, n, i) {
						var a, o, r = n[0],
							s = n.length,
							l = r.parentNode;
						if (e)
							for (a = 0, o = e.length; a < o; a++)
								if (e[a] == r) {
									e[a++] = i;
									for (var c = a, d = c + s - 1, u = e.length; c < u; c++, d++) d < u ? e[c] = e[d] : delete e[c];
									e.length -= s - 1, e.context === r && (e.context = i);
									break
								}
						l && l.replaceChild(i, r);
						var p = t.createDocumentFragment();
						p.appendChild(r), Xn(i).data(Xn(r).data()), Zn ? (si = !0, Zn.cleanData([r])) : delete Xn.cache[r[Xn.expando]];
						for (var f = 1, h = n.length; f < h; f++) {
							var g = n[f];
							Xn(g).remove(), p.appendChild(g), delete n[f]
						}
						n[0] = i, n.length = 1
					}

					function ae(e, t) {
						return u(function() {
							return e.apply(null, arguments)
						}, e, t)
					}

					function oe(e, t, n, i, o, r) {
						try {
							e(t, n, i, o, r)
						} catch (e) {
							a(e, V(n))
						}
					}
					var re = function(e, t) {
						if (t) {
							var n, i, a, o = Object.keys(t);
							for (n = 0, i = o.length; n < i; n++) a = o[n], this[a] = t[a]
						} else this.$attr = {};
						this.$$element = e
					};
					re.prototype = {
						$normalize: Qe,
						$addClass: function(e) {
							e && e.length > 0 && S.addClass(this.$$element, e)
						},
						$removeClass: function(e) {
							e && e.length > 0 && S.removeClass(this.$$element, e)
						},
						$updateClass: function(e, t) {
							var n = Xe(e, t);
							n && n.length && S.addClass(this.$$element, n);
							var i = Xe(t, e);
							i && i.length && S.removeClass(this.$$element, i)
						},
						$set: function(e, t, i, r) {
							var s, l = this.$$element[0],
								c = Ae(l, e),
								d = Oe(l, e),
								u = e;
							if (c ? (this.$$element.prop(e, t), r = c) : d && (this[d] = t, u = d), this[e] = t, r ? this.$attr[e] = r : (r = this.$attr[e]) || (this.$attr[e] = r = ne(e, "-")), "a" === (s = A(this.$$element)) && "href" === e || "img" === s && "src" === e) this[e] = t = P(t, "src" === e);
							else if ("img" === s && "srcset" === e) {
								for (var p = "", f = ci(t), h = /(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/, g = /\s/.test(f) ? h : /(,)/, m = f.split(g), v = Math.floor(m.length / 2), y = 0; y < v; y++) {
									var b = 2 * y;
									p += P(ci(m[b]), !0), p += " " + ci(m[b + 1])
								}
								var _ = ci(m[2 * y]).split(/\s/);
								p += P(ci(_[0]), !0), 2 === _.length && (p += " " + ci(_[1])), this[e] = t = p
							}!1 !== i && (null === t || t === n ? this.$$element.removeAttr(r) : this.$$element.attr(r, t));
							var w = this.$$observers;
							w && o(w[u], function(e) {
								try {
									e(t)
								} catch (e) {
									a(e)
								}
							})
						},
						$observe: function(e, t) {
							var n = this,
								i = n.$$observers || (n.$$observers = le()),
								a = i[e] || (i[e] = []);
							return a.push(t), k.$evalAsync(function() {
									!a.$$inter && n.hasOwnProperty(e) && t(n[e])
								}),
								function() {
									O(a, t)
								}
						}
					};
					var se = i.startSymbol(),
						ce = i.endSymbol(),
						de = "{{" == se || "}}" == ce ? g : function(e) {
							return e.replace(/\{\{/g, se).replace(/}}/g, ce)
						},
						ue = /^ngAttr[A-Z]/;
					return E.$$addBindingInfo = x ? function(e, t) {
						var n = e.data("$binding") || [];
						li(t) ? n = n.concat(t) : n.push(t), e.data("$binding", n)
					} : h, E.$$addBindingClass = x ? function(e) {
						I(e, "ng-binding")
					} : h, E.$$addScopeInfo = x ? function(e, t, n, i) {
						var a = n ? i ? "$isolateScopeNoTemplate" : "$isolateScope" : "$scope";
						e.data(a, t)
					} : h, E.$$addScopeClass = x ? function(e, t) {
						I(e, t ? "ng-isolate-scope" : "ng-scope")
					} : h, E
				}
			]
		}

		function Qe(e) {
			return fe(e.replace(Wi, ""))
		}

		function Xe(e, t) {
			var n = "",
				i = e.split(/\s+/),
				a = t.split(/\s+/);
			e: for (var o = 0; o < i.length; o++) {
				for (var r = i[o], s = 0; s < a.length; s++)
					if (r == a[s]) continue e;
				n += (n.length > 0 ? " " : "") + r
			}
			return n
		}

		function Ze(e) {
			e = Xn(e);
			var t = e.length;
			if (t <= 1) return e;
			for (; t--;) {
				e[t].nodeType === vi && ti.call(e, t, 1)
			}
			return e
		}

		function Je() {
			var e = {},
				t = !1,
				a = /^(\S+)(\s+as\s+(\w+))?$/;
			this.register = function(t, n) {
				oe(t, "controller"), b(t) ? u(e, t) : e[t] = n
			}, this.allowGlobals = function() {
				t = !0
			}, this.$get = ["$injector", "$window",
				function(o, r) {
					function s(e, t, n, a) {
						if (!e || !b(e.$scope)) throw i("$controller")("noscp", "Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.", a, t);
						e.$scope[t] = n
					}
					return function(i, l, c, d) {
						var p, f, h, g;
						if (c = !0 === c, d && _(d) && (g = d), _(i)) {
							if (!(f = i.match(a))) throw Yi("ctrlfmt", "Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.", i);
							h = f[1], g = g || f[3], i = e.hasOwnProperty(h) ? e[h] : re(l.$scope, h, !0) || (t ? re(r, h, !0) : n), ae(i, h, !0)
						}
						if (c) {
							var m = (li(i) ? i[i.length - 1] : i).prototype;
							return p = Object.create(m || null), g && s(l, g, p, h || i.name), u(function() {
								return o.invoke(i, p, l, h), p
							}, {
								instance: p,
								identifier: g
							})
						}
						return p = o.instantiate(i, l, h), g && s(l, g, p, h || i.name), p
					}
				}
			]
		}

		function et() {
			this.$get = ["$window",
				function(e) {
					return Xn(e.document)
				}
			]
		}

		function tt() {
			this.$get = ["$log",
				function(e) {
					return function(t, n) {
						e.error.apply(e, arguments)
					}
				}
			]
		}

		function nt(e, t) {
			if (_(e)) {
				var n = e.replace(Zi, "").trim();
				if (n) {
					var i = t("Content-Type");
					(i && 0 === i.indexOf(Gi) || it(n)) && (e = z(n))
				}
			}
			return e
		}

		function it(e) {
			var t = e.match(Qi);
			return t && Xi[t[0]].test(e)
		}

		function at(e) {
			var t, n, i, a = le();
			return e ? (o(e.split("\n"), function(e) {
				i = e.indexOf(":"), t = Vn(ci(e.substr(0, i))), n = ci(e.substr(i + 1)), t && (a[t] = a[t] ? a[t] + ", " + n : n)
			}), a) : a
		}

		function ot(e) {
			var t = b(e) ? e : n;
			return function(n) {
				if (t || (t = at(e)), n) {
					var i = t[Vn(n)];
					return void 0 === i && (i = null), i
				}
				return t
			}
		}

		function rt(e, t, n, i) {
			return $(i) ? i(e, t, n) : (o(i, function(i) {
				e = i(e, t, n)
			}), e)
		}

		function st(e) {
			return 200 <= e && e < 300
		}

		function lt() {
			var e = this.defaults = {
					transformResponse: [nt],
					transformRequest: [
						function(e) {
							return !b(e) || D(e) || P(e) || S(e) ? e : H(e)
						}
					],
					headers: {
						common: {
							Accept: "application/json, text/plain, */*"
						},
						post: F(Ki),
						put: F(Ki),
						patch: F(Ki)
					},
					xsrfCookieName: "XSRF-TOKEN",
					xsrfHeaderName: "X-XSRF-TOKEN"
				},
				t = !1;
			this.useApplyAsync = function(e) {
				return y(e) ? (t = !!e, this) : t
			};
			var a = this.interceptors = [];
			this.$get = ["$httpBackend", "$browser", "$cacheFactory", "$rootScope", "$q", "$injector",
				function(r, l, c, d, p, f) {
					function h(t) {
						function a(e) {
							var t = u({}, e);
							return e.data ? t.data = rt(e.data, e.headers, e.status, s.transformResponse) : t.data = e.data, st(e.status) ? t : p.reject(t)
						}

						function r(e) {
							var t, n = {};
							return o(e, function(e, i) {
								$(e) ? null != (t = e()) && (n[i] = t) : n[i] = e
							}), n
						}
						if (!oi.isObject(t)) throw i("$http")("badreq", "Http request configuration must be an object.  Received: {0}", t);
						var s = u({
							method: "get",
							transformRequest: e.transformRequest,
							transformResponse: e.transformResponse
						}, t);
						s.headers = function(t) {
							var n, i, a, o = e.headers,
								s = u({}, t.headers);
							o = u({}, o.common, o[Vn(t.method)]);
							e: for (n in o) {
								i = Vn(n);
								for (a in s)
									if (Vn(a) === i) continue e;
								s[n] = o[n]
							}
							return r(s)
						}(t), s.method = Yn(s.method);
						var l = function(t) {
								var i = t.headers,
									r = rt(t.data, ot(i), n, t.transformRequest);
								return v(r) && o(i, function(e, t) {
									"content-type" === Vn(t) && delete i[t]
								}), v(t.withCredentials) && !v(e.withCredentials) && (t.withCredentials = e.withCredentials), g(t, r).then(a, a)
							},
							c = [l, n],
							d = p.when(s);
						for (o(k, function(e) {
							(e.request || e.requestError) && c.unshift(e.request, e.requestError), (e.response || e.responseError) && c.push(e.response, e.responseError)
						}); c.length;) {
							var f = c.shift(),
								h = c.shift();
							d = d.then(f, h)
						}
						return d.success = function(e) {
							return d.then(function(t) {
								e(t.data, t.status, t.headers, s)
							}), d
						}, d.error = function(e) {
							return d.then(null, function(t) {
								e(t.data, t.status, t.headers, s)
							}), d
						}, d
					}

					function g(i, a) {
						function o(e, n, i, a) {
							function o() {
								s(n, e, i, a)
							}
							f && (st(e) ? f.put(k, [e, n, at(i), a]) : f.remove(k)), t ? d.$applyAsync(o) : (o(), d.$$phase || d.$apply())
						}

						function s(e, t, n, a) {
							t = Math.max(t, 0), (st(t) ? _.resolve : _.reject)({
								data: e,
								status: t,
								headers: ot(n),
								config: i,
								statusText: a
							})
						}

						function c(e) {
							s(e.data, e.status, F(e.headers()), e.statusText)
						}

						function u() {
							var e = h.pendingRequests.indexOf(i); - 1 !== e && h.pendingRequests.splice(e, 1)
						}
						var f, g, _ = p.defer(),
							x = _.promise,
							$ = i.headers,
							k = m(i.url, i.params);
						if (h.pendingRequests.push(i), x.then(u, u), !i.cache && !e.cache || !1 === i.cache || "GET" !== i.method && "JSONP" !== i.method || (f = b(i.cache) ? i.cache : b(e.cache) ? e.cache : w), f && (g = f.get(k), y(g) ? E(g) ? g.then(c, c) : li(g) ? s(g[1], g[0], F(g[2]), g[3]) : s(g, 200, {}, "OK") : f.put(k, x)), v(g)) {
							var T = nn(i.url) ? l.cookies()[i.xsrfCookieName || e.xsrfCookieName] : n;
							T && ($[i.xsrfHeaderName || e.xsrfHeaderName] = T), r(i.method, k, a, o, $, i.timeout, i.withCredentials, i.responseType)
						}
						return x
					}

					function m(e, t) {
						if (!t) return e;
						var n = [];
						return s(t, function(e, t) {
							null === e || v(e) || (li(e) || (e = [e]), o(e, function(e) {
								b(e) && (e = x(e) ? e.toISOString() : H(e)), n.push(Q(t) + "=" + Q(e))
							}))
						}), n.length > 0 && (e += (-1 == e.indexOf("?") ? "?" : "&") + n.join("&")), e
					}
					var w = c("$http"),
						k = [];
					return o(a, function(e) {
							k.unshift(_(e) ? f.get(e) : f.invoke(e))
						}), h.pendingRequests = [],
						function(e) {
							o(arguments, function(e) {
								h[e] = function(t, n) {
									return h(u(n || {}, {
										method: e,
										url: t
									}))
								}
							})
						}("get", "delete", "head", "jsonp"),
						function(e) {
							o(arguments, function(e) {
								h[e] = function(t, n, i) {
									return h(u(i || {}, {
										method: e,
										url: t,
										data: n
									}))
								}
							})
						}("post", "put", "patch"), h.defaults = e, h
				}
			]
		}

		function ct() {
			return new e.XMLHttpRequest
		}

		function dt() {
			this.$get = ["$browser", "$window", "$document",
				function(e, t, n) {
					return ut(e, ct, e.defer, t.angular.callbacks, n[0])
				}
			]
		}

		function ut(e, t, i, a, r) {
			function s(e, t, n) {
				var i = r.createElement("script"),
					o = null;
				return i.type = "text/javascript", i.src = e, i.async = !0, o = function(e) {
					ki(i, "load", o), ki(i, "error", o), r.body.removeChild(i), i = null;
					var s = -1,
						l = "unknown";
					e && ("load" !== e.type || a[t].called || (e = {
						type: "error"
					}), l = e.type, s = "error" === e.type ? 404 : 200), n && n(s, l)
				}, $i(i, "load", o), $i(i, "error", o), r.body.appendChild(i), o
			}
			return function(r, l, c, d, u, p, f, g) {
				function m() {
					_ && _(), w && w.abort()
				}

				function v(t, a, o, r, s) {
					$ !== n && i.cancel($), _ = w = null, t(a, o, r, s), e.$$completeOutstandingRequest(h)
				}
				if (e.$$incOutstandingRequestCount(), l = l || e.url(), "jsonp" == Vn(r)) {
					var b = "_" + (a.counter++).toString(36);
					a[b] = function(e) {
						a[b].data = e, a[b].called = !0
					};
					var _ = s(l.replace("JSON_CALLBACK", "angular.callbacks." + b), b, function(e, t) {
						v(d, e, a[b].data, "", t), a[b] = h
					})
				} else {
					var w = t();
					w.open(r, l, !0), o(u, function(e, t) {
						y(e) && w.setRequestHeader(t, e)
					}), w.onload = function() {
						var e = w.statusText || "",
							t = "response" in w ? w.response : w.responseText,
							n = 1223 === w.status ? 204 : w.status;
						0 === n && (n = t ? 200 : "file" == tn(l).protocol ? 404 : 0), v(d, n, t, w.getAllResponseHeaders(), e)
					};
					var x = function() {
						v(d, -1, null, null, "")
					};
					if (w.onerror = x, w.onabort = x, f && (w.withCredentials = !0), g) try {
						w.responseType = g
					} catch (e) {
						if ("json" !== g) throw e
					}
					w.send(c || null)
				} if (p > 0) var $ = i(m, p);
				else E(p) && p.then(m)
			}
		}

		function pt() {
			var e = "{{",
				t = "}}";
			this.startSymbol = function(t) {
				return t ? (e = t, this) : e
			}, this.endSymbol = function(e) {
				return e ? (t = e, this) : t
			}, this.$get = ["$parse", "$exceptionHandler", "$sce",
				function(n, i, a) {
					function o(e) {
						return "\\\\\\" + e
					}

					function r(o, r, p, f) {
						function h(n) {
							return n.replace(c, e).replace(d, t)
						}

						function g(e) {
							try {
								return e = P(e), f && !y(e) ? e : I(e)
							} catch (e) {
								var t = Ji("interr", "Can't interpolate: {0}\n{1}", o, e.toString());
								i(t)
							}
						}
						f = !!f;
						for (var m, b, _, w = 0, x = [], k = [], T = o.length, C = [], D = []; w < T;) {
							if (-1 == (m = o.indexOf(e, w)) || -1 == (b = o.indexOf(t, m + s))) {
								w !== T && C.push(h(o.substring(w)));
								break
							}
							w !== m && C.push(h(o.substring(w, m))), _ = o.substring(m + s, b), x.push(_), k.push(n(_, g)), w = b + l, D.push(C.length), C.push("")
						}
						if (p && C.length > 1) throw Ji("noconcat", "Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce", o);
						if (!r || x.length) {
							var S = function(e) {
									for (var t = 0, n = x.length; t < n; t++) {
										if (f && v(e[t])) return;
										C[D[t]] = e[t]
									}
									return C.join("")
								},
								P = function(e) {
									return p ? a.getTrusted(p, e) : a.valueOf(e)
								},
								I = function(e) {
									if (null == e) return "";
									switch (typeof e) {
										case "string":
											break;
										case "number":
											e = "" + e;
											break;
										default:
											e = H(e)
									}
									return e
								};
							return u(function(e) {
								var t = 0,
									n = x.length,
									a = new Array(n);
								try {
									for (; t < n; t++) a[t] = k[t](e);
									return S(a)
								} catch (e) {
									var r = Ji("interr", "Can't interpolate: {0}\n{1}", o, e.toString());
									i(r)
								}
							}, {
								exp: o,
								expressions: x,
								$$watchDelegate: function(e, t, n) {
									var i;
									return e.$watchGroup(k, function(n, a) {
										var o = S(n);
										$(t) && t.call(this, o, n !== a ? i : o, e), i = o
									}, n)
								}
							})
						}
					}
					var s = e.length,
						l = t.length,
						c = new RegExp(e.replace(/./g, o), "g"),
						d = new RegExp(t.replace(/./g, o), "g");
					return r.startSymbol = function() {
						return e
					}, r.endSymbol = function() {
						return t
					}, r
				}
			]
		}

		function ft() {
			this.$get = ["$rootScope", "$window", "$q", "$$q",
				function(e, t, n, i) {
					function a(a, r, s, l) {
						var c = t.setInterval,
							d = t.clearInterval,
							u = 0,
							p = y(l) && !l,
							f = (p ? i : n).defer(),
							h = f.promise;
						return s = y(s) ? s : 0, h.then(null, null, a), h.$$intervalId = c(function() {
							f.notify(u++), s > 0 && u >= s && (f.resolve(u), d(h.$$intervalId), delete o[h.$$intervalId]), p || e.$apply()
						}, r), o[h.$$intervalId] = f, h
					}
					var o = {};
					return a.cancel = function(e) {
						return !!(e && e.$$intervalId in o) && (o[e.$$intervalId].reject("canceled"), t.clearInterval(e.$$intervalId), delete o[e.$$intervalId], !0)
					}, a
				}
			]
		}

		function ht() {
			this.$get = function() {
				return {
					id: "en-us",
					NUMBER_FORMATS: {
						DECIMAL_SEP: ".",
						GROUP_SEP: ",",
						PATTERNS: [{
							minInt: 1,
							minFrac: 0,
							maxFrac: 3,
							posPre: "",
							posSuf: "",
							negPre: "-",
							negSuf: "",
							gSize: 3,
							lgSize: 3
						}, {
							minInt: 1,
							minFrac: 2,
							maxFrac: 2,
							posPre: "¤",
							posSuf: "",
							negPre: "(¤",
							negSuf: ")",
							gSize: 3,
							lgSize: 3
						}],
						CURRENCY_SYM: "$"
					},
					DATETIME_FORMATS: {
						MONTH: "January,February,March,April,May,June,July,August,September,October,November,December".split(","),
						SHORTMONTH: "Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),
						DAY: "Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),
						SHORTDAY: "Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),
						AMPMS: ["AM", "PM"],
						medium: "MMM d, y h:mm:ss a",
						short: "M/d/yy h:mm a",
						fullDate: "EEEE, MMMM d, y",
						longDate: "MMMM d, y",
						mediumDate: "MMM d, y",
						shortDate: "M/d/yy",
						mediumTime: "h:mm:ss a",
						shortTime: "h:mm a"
					},
					pluralCat: function(e) {
						return 1 === e ? "one" : "other"
					}
				}
			}
		}

		function gt(e) {
			for (var t = e.split("/"), n = t.length; n--;) t[n] = K(t[n]);
			return t.join("/")
		}

		function mt(e, t) {
			var n = tn(e);
			t.$$protocol = n.protocol, t.$$host = n.hostname, t.$$port = p(n.port) || ta[n.protocol] || null
		}

		function vt(e, t) {
			var n = "/" !== e.charAt(0);
			n && (e = "/" + e);
			var i = tn(e);
			t.$$path = decodeURIComponent(n && "/" === i.pathname.charAt(0) ? i.pathname.substring(1) : i.pathname), t.$$search = Y(i.search), t.$$hash = decodeURIComponent(i.hash), t.$$path && "/" != t.$$path.charAt(0) && (t.$$path = "/" + t.$$path)
		}

		function yt(e, t) {
			if (0 === t.indexOf(e)) return t.substr(e.length)
		}

		function bt(e) {
			var t = e.indexOf("#");
			return -1 == t ? e : e.substr(0, t)
		}

		function _t(e) {
			return e.replace(/(#.+)|#$/, "$1")
		}

		function wt(e) {
			return e.substr(0, bt(e).lastIndexOf("/") + 1)
		}

		function xt(e) {
			return e.substring(0, e.indexOf("/", e.indexOf("//") + 2))
		}

		function $t(e, t) {
			this.$$html5 = !0, t = t || "";
			var i = wt(e);
			mt(e, this), this.$$parse = function(e) {
				var t = yt(i, e);
				if (!_(t)) throw na("ipthprfx", 'Invalid url "{0}", missing path prefix "{1}".', e, i);
				vt(t, this), this.$$path || (this.$$path = "/"), this.$$compose()
			}, this.$$compose = function() {
				var e = G(this.$$search),
					t = this.$$hash ? "#" + K(this.$$hash) : "";
				this.$$url = gt(this.$$path) + (e ? "?" + e : "") + t, this.$$absUrl = i + this.$$url.substr(1)
			}, this.$$parseLinkUrl = function(a, o) {
				if (o && "#" === o[0]) return this.hash(o.slice(1)), !0;
				var r, s, l;
				return (r = yt(e, a)) !== n ? (s = r, l = (r = yt(t, r)) !== n ? i + (yt("/", r) || r) : e + s) : (r = yt(i, a)) !== n ? l = i + r : i == a + "/" && (l = i), l && this.$$parse(l), !!l
			}
		}

		function kt(e, t) {
			var n = wt(e);
			mt(e, this), this.$$parse = function(i) {
				var a, o = yt(e, i) || yt(n, i);
				"#" === o.charAt(0) ? (a = yt(t, o), v(a) && (a = o)) : a = this.$$html5 ? o : "", vt(a, this), this.$$path = function(e, t, n) {
					var i, a = /^\/[A-Z]:(\/.*)/;
					return 0 === t.indexOf(n) && (t = t.replace(n, "")), a.exec(t) ? e : (i = a.exec(e), i ? i[1] : e)
				}(this.$$path, a, e), this.$$compose()
			}, this.$$compose = function() {
				var n = G(this.$$search),
					i = this.$$hash ? "#" + K(this.$$hash) : "";
				this.$$url = gt(this.$$path) + (n ? "?" + n : "") + i, this.$$absUrl = e + (this.$$url ? t + this.$$url : "")
			}, this.$$parseLinkUrl = function(t, n) {
				return bt(e) == bt(t) && (this.$$parse(t), !0)
			}
		}

		function Tt(e, t) {
			this.$$html5 = !0, kt.apply(this, arguments);
			var n = wt(e);
			this.$$parseLinkUrl = function(i, a) {
				if (a && "#" === a[0]) return this.hash(a.slice(1)), !0;
				var o, r;
				return e == bt(i) ? o = i : (r = yt(n, i)) ? o = e + t + r : n === i + "/" && (o = n), o && this.$$parse(o), !!o
			}, this.$$compose = function() {
				var n = G(this.$$search),
					i = this.$$hash ? "#" + K(this.$$hash) : "";
				this.$$url = gt(this.$$path) + (n ? "?" + n : "") + i, this.$$absUrl = e + t + this.$$url
			}
		}

		function Ct(e) {
			return function() {
				return this[e]
			}
		}

		function Dt(e, t) {
			return function(n) {
				return v(n) ? this[e] : (this[e] = t(n), this.$$compose(), this)
			}
		}

		function St() {
			var e = "",
				t = {
					enabled: !1,
					requireBase: !0,
					rewriteLinks: !0
				};
			this.hashPrefix = function(t) {
				return y(t) ? (e = t, this) : e
			}, this.html5Mode = function(e) {
				return I(e) ? (t.enabled = e, this) : b(e) ? (I(e.enabled) && (t.enabled = e.enabled), I(e.requireBase) && (t.requireBase = e.requireBase), I(e.rewriteLinks) && (t.rewriteLinks = e.rewriteLinks), this) : t
			}, this.$get = ["$rootScope", "$browser", "$sniffer", "$rootElement", "$window",
				function(n, i, a, o, r) {
					function s(e, t, n) {
						var a = c.url(),
							o = c.$$state;
						try {
							i.url(e, t, n), c.$$state = i.state()
						} catch (e) {
							throw c.url(a), c.$$state = o, e
						}
					}

					function l(e, t) {
						n.$broadcast("$locationChangeSuccess", c.absUrl(), e, c.$$state, t)
					}
					var c, d, u, p = i.baseHref(),
						f = i.url();
					if (t.enabled) {
						if (!p && t.requireBase) throw na("nobase", "$location in HTML5 mode requires a <base> tag to be present!");
						u = xt(f) + (p || "/"), d = a.history ? $t : Tt
					} else u = bt(f), d = kt;
					c = new d(u, "#" + e), c.$$parseLinkUrl(f, f), c.$$state = i.state();
					var h = /^\s*(javascript|mailto):/i;
					o.on("click", function(e) {
						if (t.rewriteLinks && !e.ctrlKey && !e.metaKey && !e.shiftKey && 2 != e.which && 2 != e.button) {
							for (var a = Xn(e.target);
								"a" !== A(a[0]);)
								if (a[0] === o[0] || !(a = a.parent())[0]) return;
							var s = a.prop("href"),
								l = a.attr("href") || a.attr("xlink:href");
							b(s) && "[object SVGAnimatedString]" === s.toString() && (s = tn(s.animVal).href), h.test(s) || !s || a.attr("target") || e.isDefaultPrevented() || c.$$parseLinkUrl(s, l) && (e.preventDefault(), c.absUrl() != i.url() && (n.$apply(), r.angular["ff-684208-preventDefault"] = !0))
						}
					}), _t(c.absUrl()) != _t(f) && i.url(c.absUrl(), !0);
					var g = !0;
					return i.onUrlChange(function(e, t) {
						n.$evalAsync(function() {
							var i, a = c.absUrl(),
								o = c.$$state;
							c.$$parse(e), c.$$state = t, i = n.$broadcast("$locationChangeStart", e, a, t, o).defaultPrevented, c.absUrl() === e && (i ? (c.$$parse(a), c.$$state = o, s(a, !1, o)) : (g = !1, l(a, o)))
						}), n.$$phase || n.$digest()
					}), n.$watch(function() {
						var e = _t(i.url()),
							t = _t(c.absUrl()),
							o = i.state(),
							r = c.$$replace,
							d = e !== t || c.$$html5 && a.history && o !== c.$$state;
						(g || d) && (g = !1, n.$evalAsync(function() {
							var t = c.absUrl(),
								i = n.$broadcast("$locationChangeStart", t, e, c.$$state, o).defaultPrevented;
							c.absUrl() === t && (i ? (c.$$parse(e), c.$$state = o) : (d && s(t, r, o === c.$$state ? null : c.$$state), l(e, o)))
						})), c.$$replace = !1
					}), c
				}
			]
		}

		function Pt() {
			var e = !0,
				t = this;
			this.debugEnabled = function(t) {
				return y(t) ? (e = t, this) : e
			}, this.$get = ["$window",
				function(n) {
					function i(e) {
						return e instanceof Error && (e.stack ? e = e.message && -1 === e.stack.indexOf(e.message) ? "Error: " + e.message + "\n" + e.stack : e.stack : e.sourceURL && (e = e.message + "\n" + e.sourceURL + ":" + e.line)), e
					}

					function a(e) {
						var t = n.console || {},
							a = t[e] || t.log || h,
							r = !1;
						try {
							r = !!a.apply
						} catch (e) {}
						return r ? function() {
							var e = [];
							return o(arguments, function(t) {
								e.push(i(t))
							}), a.apply(t, e)
						} : function(e, t) {
							a(e, null == t ? "" : t)
						}
					}
					return {
						log: a("log"),
						info: a("info"),
						warn: a("warn"),
						error: a("error"),
						debug: function() {
							var n = a("debug");
							return function() {
								e && n.apply(t, arguments)
							}
						}()
					}
				}
			]
		}

		function It(e, t) {
			if ("__defineGetter__" === e || "__defineSetter__" === e || "__lookupGetter__" === e || "__lookupSetter__" === e || "__proto__" === e) throw aa("isecfld", "Attempting to access a disallowed field in Angular expressions! Expression: {0}", t);
			return e
		}

		function Et(e, t) {
			if (e) {
				if (e.constructor === e) throw aa("isecfn", "Referencing Function in Angular expressions is disallowed! Expression: {0}", t);
				if (e.window === e) throw aa("isecwindow", "Referencing the Window in Angular expressions is disallowed! Expression: {0}", t);
				if (e.children && (e.nodeName || e.prop && e.attr && e.find)) throw aa("isecdom", "Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}", t);
				if (e === Object) throw aa("isecobj", "Referencing Object in Angular expressions is disallowed! Expression: {0}", t)
			}
			return e
		}

		function Lt(e, t) {
			if (e) {
				if (e.constructor === e) throw aa("isecfn", "Referencing Function in Angular expressions is disallowed! Expression: {0}", t);
				if (e === oa || e === ra || e === sa) throw aa("isecff", "Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}", t)
			}
		}

		function Mt(e) {
			return e.constant
		}

		function At(e, t, n, i, a) {
			Et(e, a), Et(t, a);
			for (var o, r = n.split("."), s = 0; r.length > 1; s++) {
				o = It(r.shift(), a);
				var l = 0 === s && t && t[o] || e[o];
				l || (l = {}, e[o] = l), e = Et(l, a)
			}
			return o = It(r.shift(), a), Et(e[o], a), e[o] = i, i
		}

		function Ot(e) {
			return "constructor" == e
		}

		function jt(e, t, i, a, o, r, s) {
			It(e, r), It(t, r), It(i, r), It(a, r), It(o, r);
			var l = function(e) {
					return Et(e, r)
				},
				c = s || Ot(e) ? l : g,
				d = s || Ot(t) ? l : g,
				u = s || Ot(i) ? l : g,
				p = s || Ot(a) ? l : g,
				f = s || Ot(o) ? l : g;
			return function(r, s) {
				var l = s && s.hasOwnProperty(e) ? s : r;
				return null == l ? l : (l = c(l[e]), t ? null == l ? n : (l = d(l[t]), i ? null == l ? n : (l = u(l[i]), a ? null == l ? n : (l = p(l[a]), o ? null == l ? n : l = f(l[o]) : l) : l) : l) : l)
			}
		}

		function Ft(e, t) {
			return function(n, i) {
				return e(n, i, Et, t)
			}
		}

		function qt(e, t, i) {
			var a = t.expensiveChecks,
				r = a ? ha : fa,
				s = r[e];
			if (s) return s;
			var l = e.split("."),
				c = l.length;
			if (t.csp) s = c < 6 ? jt(l[0], l[1], l[2], l[3], l[4], i, a) : function(e, t) {
				var o, r = 0;
				do {
					o = jt(l[r++], l[r++], l[r++], l[r++], l[r++], i, a)(e, t), t = n, e = o
				} while (r < c);
				return o
			};
			else {
				var d = "";
				a && (d += "s = eso(s, fe);\nl = eso(l, fe);\n");
				var u = a;
				o(l, function(e, t) {
					It(e, i);
					var n = (t ? "s" : '((l&&l.hasOwnProperty("' + e + '"))?l:s)') + "." + e;
					(a || Ot(e)) && (n = "eso(" + n + ", fe)", u = !0), d += "if(s == null) return undefined;\ns=" + n + ";\n"
				}), d += "return s;";
				var p = new Function("s", "l", "eso", "fe", d);
				p.toString = m(d), u && (p = Ft(p, i)), s = p
			}
			return s.sharedGetter = !0, s.assign = function(t, n, i) {
				return At(t, i, e, n, e)
			}, r[e] = s, s
		}

		function Nt(e) {
			return $(e.valueOf) ? e.valueOf() : ga.call(e)
		}

		function Rt() {
			var e = le(),
				t = le();
			this.$get = ["$filter", "$sniffer",
				function(n, i) {
					function a(e) {
						var t = e;
						return e.sharedGetter && (t = function(t, n) {
							return e(t, n)
						}, t.literal = e.literal, t.constant = e.constant, t.assign = e.assign), t
					}

					function r(e, t) {
						for (var n = 0, i = e.length; n < i; n++) {
							var a = e[n];
							a.constant || (a.inputs ? r(a.inputs, t) : -1 === t.indexOf(a) && t.push(a))
						}
						return t
					}

					function s(e, t) {
						return null == e || null == t ? e === t : ("object" != typeof e || "object" != typeof(e = Nt(e))) && (e === t || e !== e && t !== t)
					}

					function l(e, t, n, i) {
						var a, o = i.$$inputs || (i.$$inputs = r(i.inputs, []));
						if (1 === o.length) {
							var l = s;
							return o = o[0], e.$watch(function(e) {
								var t = o(e);
								return s(t, l) || (a = i(e), l = t && Nt(t)), a
							}, t, n)
						}
						for (var c = [], d = 0, u = o.length; d < u; d++) c[d] = s;
						return e.$watch(function(e) {
							for (var t = !1, n = 0, r = o.length; n < r; n++) {
								var l = o[n](e);
								(t || (t = !s(l, c[n]))) && (c[n] = l && Nt(l))
							}
							return t && (a = i(e)), a
						}, t, n)
					}

					function c(e, t, n, i) {
						var a, o;
						return a = e.$watch(function(e) {
							return i(e)
						}, function(e, n, i) {
							o = e, $(t) && t.apply(this, arguments), y(e) && i.$$postDigest(function() {
								y(o) && a()
							})
						}, n)
					}

					function d(e, t, n, i) {
						function a(e) {
							var t = !0;
							return o(e, function(e) {
								y(e) || (t = !1)
							}), t
						}
						var r, s;
						return r = e.$watch(function(e) {
							return i(e)
						}, function(e, n, i) {
							s = e, $(t) && t.call(this, e, n, i), a(e) && i.$$postDigest(function() {
								a(s) && r()
							})
						}, n)
					}

					function u(e, t, n, i) {
						var a;
						return a = e.$watch(function(e) {
							return i(e)
						}, function(e, n, i) {
							$(t) && t.apply(this, arguments), a()
						}, n)
					}

					function p(e, t) {
						if (!t) return e;
						var n = e.$$watchDelegate,
							i = n !== d && n !== c,
							a = i ? function(n, i) {
								var a = e(n, i);
								return t(a, n, i)
							} : function(n, i) {
								var a = e(n, i),
									o = t(a, n, i);
								return y(a) ? o : a
							};
						return e.$$watchDelegate && e.$$watchDelegate !== l ? a.$$watchDelegate = e.$$watchDelegate : t.$stateful || (a.$$watchDelegate = l, a.inputs = [e]), a
					}
					var f = {
							csp: i.csp,
							expensiveChecks: !1
						},
						g = {
							csp: i.csp,
							expensiveChecks: !0
						};
					return function(i, o, r) {
						var s, m, v;
						switch (typeof i) {
							case "string":
								v = i = i.trim();
								var y = r ? t : e;
								if (!(s = y[v])) {
									":" === i.charAt(0) && ":" === i.charAt(1) && (m = !0, i = i.substring(2));
									var b = r ? g : f,
										_ = new ua(b);
									s = new pa(_, n, b).parse(i), s.constant ? s.$$watchDelegate = u : m ? (s = a(s), s.$$watchDelegate = s.literal ? d : c) : s.inputs && (s.$$watchDelegate = l), y[v] = s
								}
								return p(s, o);
							case "function":
								return p(i, o);
							default:
								return p(h, o)
						}
					}
				}
			]
		}

		function Bt() {
			this.$get = ["$rootScope", "$exceptionHandler",
				function(e, t) {
					return Ht(function(t) {
						e.$evalAsync(t)
					}, t)
				}
			]
		}

		function Ut() {
			this.$get = ["$browser", "$exceptionHandler",
				function(e, t) {
					return Ht(function(t) {
						e.defer(t)
					}, t)
				}
			]
		}

		function Ht(e, t) {
			function a(e, t, n) {
				function i(t) {
					return function(n) {
						a || (a = !0, t.call(e, n))
					}
				}
				var a = !1;
				return [i(t), i(n)]
			}

			function r() {
				this.$$state = {
					status: 0
				}
			}

			function s(e, t) {
				return function(n) {
					t.call(e, n)
				}
			}

			function l(e) {
				var i, a, o;
				o = e.pending, e.processScheduled = !1, e.pending = n;
				for (var r = 0, s = o.length; r < s; ++r) {
					a = o[r][0], i = o[r][e.status];
					try {
						$(i) ? a.resolve(i(e.value)) : 1 === e.status ? a.resolve(e.value) : a.reject(e.value)
					} catch (e) {
						a.reject(e), t(e)
					}
				}
			}

			function c(t) {
				!t.processScheduled && t.pending && (t.processScheduled = !0, e(function() {
					l(t)
				}))
			}

			function d() {
				this.promise = new r, this.resolve = s(this, this.resolve), this.reject = s(this, this.reject), this.notify = s(this, this.notify)
			}

			function u(e) {
				var t = new d,
					n = 0,
					i = li(e) ? [] : {};
				return o(e, function(e, a) {
					n++, v(e).then(function(e) {
						i.hasOwnProperty(a) || (i[a] = e, --n || t.resolve(i))
					}, function(e) {
						i.hasOwnProperty(a) || t.reject(e)
					})
				}), 0 === n && t.resolve(i), t.promise
			}
			var p = i("$q", TypeError),
				f = function() {
					return new d
				};
			r.prototype = {
				then: function(e, t, n) {
					var i = new d;
					return this.$$state.pending = this.$$state.pending || [], this.$$state.pending.push([i, e, t, n]), this.$$state.status > 0 && c(this.$$state), i.promise
				},
				catch: function(e) {
					return this.then(null, e)
				},
				finally: function(e, t) {
					return this.then(function(t) {
						return m(t, !0, e)
					}, function(t) {
						return m(t, !1, e)
					}, t)
				}
			}, d.prototype = {
				resolve: function(e) {
					this.promise.$$state.status || (e === this.promise ? this.$$reject(p("qcycle", "Expected promise to be resolved with value other than itself '{0}'", e)) : this.$$resolve(e))
				},
				$$resolve: function(e) {
					var n, i;
					i = a(this, this.$$resolve, this.$$reject);
					try {
						(b(e) || $(e)) && (n = e && e.then), $(n) ? (this.promise.$$state.status = -1, n.call(e, i[0], i[1], this.notify)) : (this.promise.$$state.value = e, this.promise.$$state.status = 1, c(this.promise.$$state))
					} catch (e) {
						i[1](e), t(e)
					}
				},
				reject: function(e) {
					this.promise.$$state.status || this.$$reject(e)
				},
				$$reject: function(e) {
					this.promise.$$state.value = e, this.promise.$$state.status = 2, c(this.promise.$$state)
				},
				notify: function(n) {
					var i = this.promise.$$state.pending;
					this.promise.$$state.status <= 0 && i && i.length && e(function() {
						for (var e, a, o = 0, r = i.length; o < r; o++) {
							a = i[o][0], e = i[o][3];
							try {
								a.notify($(e) ? e(n) : n)
							} catch (e) {
								t(e)
							}
						}
					})
				}
			};
			var h = function(e) {
					var t = new d;
					return t.reject(e), t.promise
				},
				g = function(e, t) {
					var n = new d;
					return t ? n.resolve(e) : n.reject(e), n.promise
				},
				m = function(e, t, n) {
					var i = null;
					try {
						$(n) && (i = n())
					} catch (e) {
						return g(e, !1)
					}
					return E(i) ? i.then(function() {
						return g(e, t)
					}, function(e) {
						return g(e, !1)
					}) : g(e, t)
				},
				v = function(e, t, n, i) {
					var a = new d;
					return a.resolve(e), a.promise.then(t, n, i)
				},
				y = function e(t) {
					function n(e) {
						a.resolve(e)
					}

					function i(e) {
						a.reject(e)
					}
					if (!$(t)) throw p("norslvr", "Expected resolverFn, got '{0}'", t);
					if (!(this instanceof e)) return new e(t);
					var a = new d;
					return t(n, i), a.promise
				};
			return y.defer = f, y.reject = h, y.when = v, y.all = u, y
		}

		function zt() {
			this.$get = ["$window", "$timeout",
				function(e, t) {
					var n = e.requestAnimationFrame || e.webkitRequestAnimationFrame,
						i = e.cancelAnimationFrame || e.webkitCancelAnimationFrame || e.webkitCancelRequestAnimationFrame,
						a = !!n,
						o = a ? function(e) {
							var t = n(e);
							return function() {
								i(t)
							}
						} : function(e) {
							var n = t(e, 16.66, !1);
							return function() {
								t.cancel(n)
							}
						};
					return o.supported = a, o
				}
			]
		}

		function Vt() {
			var e = 10,
				t = i("$rootScope"),
				n = null,
				r = null;
			this.digestTtl = function(t) {
				return arguments.length && (e = t), e
			}, this.$get = ["$injector", "$exceptionHandler", "$parse", "$browser",
				function(i, s, l, d) {
					function u() {
						this.$id = c(), this.$$phase = this.$parent = this.$$watchers = this.$$nextSibling = this.$$prevSibling = this.$$childHead = this.$$childTail = null, this.$root = this, this.$$destroyed = !1, this.$$listeners = {}, this.$$listenerCount = {}, this.$$isolateBindings = null
					}

					function p(e) {
						if (w.$$phase) throw t("inprog", "{0} already in progress", w.$$phase);
						w.$$phase = e
					}

					function f() {
						w.$$phase = null
					}

					function g(e, t, n) {
						do {
							e.$$listenerCount[n] -= t, 0 === e.$$listenerCount[n] && delete e.$$listenerCount[n]
						} while (e = e.$parent)
					}

					function m() {}

					function y() {
						for (; T.length;) try {
							T.shift()()
						} catch (e) {
							s(e)
						}
						r = null
					}

					function _() {
						null === r && (r = d.defer(function() {
							w.$apply(y)
						}))
					}
					u.prototype = {
						constructor: u,
						$new: function(e, t) {
							function n() {
								i.$$destroyed = !0
							}
							var i;
							return t = t || this, e ? (i = new u, i.$root = this.$root) : (this.$$ChildScope || (this.$$ChildScope = function() {
								this.$$watchers = this.$$nextSibling = this.$$childHead = this.$$childTail = null, this.$$listeners = {}, this.$$listenerCount = {}, this.$id = c(), this.$$ChildScope = null
							}, this.$$ChildScope.prototype = this), i = new this.$$ChildScope), i.$parent = t, i.$$prevSibling = t.$$childTail, t.$$childHead ? (t.$$childTail.$$nextSibling = i, t.$$childTail = i) : t.$$childHead = t.$$childTail = i, (e || t != this) && i.$on("$destroy", n), i
						},
						$watch: function(e, t, i) {
							var a = l(e);
							if (a.$$watchDelegate) return a.$$watchDelegate(this, t, i, a);
							var o = this,
								r = o.$$watchers,
								s = {
									fn: t,
									last: m,
									get: a,
									exp: e,
									eq: !!i
								};
							return n = null, $(t) || (s.fn = h), r || (r = o.$$watchers = []), r.unshift(s),
								function() {
									O(r, s), n = null
								}
						},
						$watchGroup: function(e, t) {
							function n() {
								l = !1, c ? (c = !1, t(a, a, s)) : t(a, i, s)
							}
							var i = new Array(e.length),
								a = new Array(e.length),
								r = [],
								s = this,
								l = !1,
								c = !0;
							if (!e.length) {
								var d = !0;
								return s.$evalAsync(function() {
										d && t(a, a, s)
									}),
									function() {
										d = !1
									}
							}
							return 1 === e.length ? this.$watch(e[0], function(e, n, o) {
								a[0] = e, i[0] = n, t(a, e === n ? a : i, o)
							}) : (o(e, function(e, t) {
								var o = s.$watch(e, function(e, o) {
									a[t] = e, i[t] = o, l || (l = !0, s.$evalAsync(n))
								});
								r.push(o)
							}), function() {
								for (; r.length;) r.shift()()
							})
						},
						$watchCollection: function(e, t) {
							function n(e) {
								o = e;
								var t, n, i, s;
								if (!v(o)) {
									if (b(o))
										if (a(o)) {
											r !== f && (r = f, m = r.length = 0, u++), t = o.length, m !== t && (u++, r.length = m = t);
											for (var l = 0; l < t; l++) s = r[l], i = o[l], s !== s && i !== i || s === i || (u++, r[l] = i)
										} else {
											r !== h && (r = h = {}, m = 0, u++), t = 0;
											for (n in o) o.hasOwnProperty(n) && (t++, i = o[n], s = r[n], n in r ? s !== s && i !== i || s === i || (u++, r[n] = i) : (m++, r[n] = i, u++));
											if (m > t) {
												u++;
												for (n in r) o.hasOwnProperty(n) || (m--, delete r[n])
											}
										} else r !== o && (r = o, u++);
									return u
								}
							}

							function i() {
								if (g ? (g = !1, t(o, o, c)) : t(o, s, c), d)
									if (b(o))
										if (a(o)) {
											s = new Array(o.length);
											for (var e = 0; e < o.length; e++) s[e] = o[e]
										} else {
											s = {};
											for (var n in o) Wn.call(o, n) && (s[n] = o[n])
										} else s = o
							}
							n.$stateful = !0;
							var o, r, s, c = this,
								d = t.length > 1,
								u = 0,
								p = l(e, n),
								f = [],
								h = {},
								g = !0,
								m = 0;
							return this.$watch(p, i)
						},
						$digest: function() {
							var i, a, o, l, c, u, h, g, v, b, _ = e,
								T = this,
								C = [];
							p("$digest"), d.$$checkUrlChange(), this === w && null !== r && (d.defer.cancel(r), y()), n = null;
							do {
								for (u = !1, g = T; x.length;) {
									try {
										b = x.shift(), b.scope.$eval(b.expression, b.locals)
									} catch (e) {
										s(e)
									}
									n = null
								}
								e: do {
									if (l = g.$$watchers)
										for (c = l.length; c--;) try {
											if (i = l[c])
												if ((a = i.get(g)) === (o = i.last) || (i.eq ? q(a, o) : "number" == typeof a && "number" == typeof o && isNaN(a) && isNaN(o))) {
													if (i === n) {
														u = !1;
														break e
													}
												} else u = !0, n = i, i.last = i.eq ? j(a, null) : a, i.fn(a, o === m ? a : o, g), _ < 5 && (v = 4 - _, C[v] || (C[v] = []), C[v].push({
													msg: $(i.exp) ? "fn: " + (i.exp.name || i.exp.toString()) : i.exp,
													newVal: a,
													oldVal: o
												}))
										} catch (e) {
											s(e)
										}
									if (!(h = g.$$childHead || g !== T && g.$$nextSibling))
										for (; g !== T && !(h = g.$$nextSibling);) g = g.$parent
								} while (g = h);
								if ((u || x.length) && !_--) throw f(), t("infdig", "{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}", e, C)
							} while (u || x.length);
							for (f(); k.length;) try {
								k.shift()()
							} catch (e) {
								s(e)
							}
						},
						$destroy: function() {
							if (!this.$$destroyed) {
								var e = this.$parent;
								if (this.$broadcast("$destroy"), this.$$destroyed = !0, this !== w) {
									for (var t in this.$$listenerCount) g(this, this.$$listenerCount[t], t);
									e.$$childHead == this && (e.$$childHead = this.$$nextSibling), e.$$childTail == this && (e.$$childTail = this.$$prevSibling), this.$$prevSibling && (this.$$prevSibling.$$nextSibling = this.$$nextSibling), this.$$nextSibling && (this.$$nextSibling.$$prevSibling = this.$$prevSibling), this.$destroy = this.$digest = this.$apply = this.$evalAsync = this.$applyAsync = h, this.$on = this.$watch = this.$watchGroup = function() {
										return h
									}, this.$$listeners = {}, this.$parent = this.$$nextSibling = this.$$prevSibling = this.$$childHead = this.$$childTail = this.$root = this.$$watchers = null
								}
							}
						},
						$eval: function(e, t) {
							return l(e)(this, t)
						},
						$evalAsync: function(e, t) {
							w.$$phase || x.length || d.defer(function() {
								x.length && w.$digest()
							}), x.push({
								scope: this,
								expression: e,
								locals: t
							})
						},
						$$postDigest: function(e) {
							k.push(e)
						},
						$apply: function(e) {
							try {
								return p("$apply"), this.$eval(e)
							} catch (e) {
								s(e)
							} finally {
								f();
								try {
									w.$digest()
								} catch (e) {
									throw s(e), e
								}
							}
						},
						$applyAsync: function(e) {
							function t() {
								n.$eval(e)
							}
							var n = this;
							e && T.push(t), _()
						},
						$on: function(e, t) {
							var n = this.$$listeners[e];
							n || (this.$$listeners[e] = n = []), n.push(t);
							var i = this;
							do {
								i.$$listenerCount[e] || (i.$$listenerCount[e] = 0), i.$$listenerCount[e] ++
							} while (i = i.$parent);
							var a = this;
							return function() {
								var i = n.indexOf(t); - 1 !== i && (n[i] = null, g(a, 1, e))
							}
						},
						$emit: function(e, t) {
							var n, i, a, o = [],
								r = this,
								l = !1,
								c = {
									name: e,
									targetScope: r,
									stopPropagation: function() {
										l = !0
									},
									preventDefault: function() {
										c.defaultPrevented = !0
									},
									defaultPrevented: !1
								},
								d = N([c], arguments, 1);
							do {
								for (n = r.$$listeners[e] || o, c.currentScope = r, i = 0, a = n.length; i < a; i++)
									if (n[i]) try {
										n[i].apply(null, d)
									} catch (e) {
										s(e)
									} else n.splice(i, 1), i--, a--;
								if (l) return c.currentScope = null, c;
								r = r.$parent
							} while (r);
							return c.currentScope = null, c
						},
						$broadcast: function(e, t) {
							var n = this,
								i = n,
								a = n,
								o = {
									name: e,
									targetScope: n,
									preventDefault: function() {
										o.defaultPrevented = !0
									},
									defaultPrevented: !1
								};
							if (!n.$$listenerCount[e]) return o;
							for (var r, l, c, d = N([o], arguments, 1); i = a;) {
								for (o.currentScope = i, r = i.$$listeners[e] || [], l = 0, c = r.length; l < c; l++)
									if (r[l]) try {
										r[l].apply(null, d)
									} catch (e) {
										s(e)
									} else r.splice(l, 1), l--, c--;
								if (!(a = i.$$listenerCount[e] && i.$$childHead || i !== n && i.$$nextSibling))
									for (; i !== n && !(a = i.$$nextSibling);) i = i.$parent
							}
							return o.currentScope = null, o
						}
					};
					var w = new u,
						x = w.$$asyncQueue = [],
						k = w.$$postDigestQueue = [],
						T = w.$$applyAsyncQueue = [];
					return w
				}
			]
		}

		function Wt() {
			var e = /^\s*(https?|ftp|mailto|tel|file):/,
				t = /^\s*((https?|ftp|file|blob):|data:image\/)/;
			this.aHrefSanitizationWhitelist = function(t) {
				return y(t) ? (e = t, this) : e
			}, this.imgSrcSanitizationWhitelist = function(e) {
				return y(e) ? (t = e, this) : t
			}, this.$get = function() {
				return function(n, i) {
					var a, o = i ? t : e;
					return a = tn(n).href, "" === a || a.match(o) ? n : "unsafe:" + a
				}
			}
		}

		function Yt(e) {
			if ("self" === e) return e;
			if (_(e)) {
				if (e.indexOf("***") > -1) throw ma("iwcard", "Illegal sequence *** in string matcher.  String: {0}", e);
				return e = di(e).replace("\\*\\*", ".*").replace("\\*", "[^:/.?&;]*"), new RegExp("^" + e + "$")
			}
			if (k(e)) return new RegExp("^" + e.source + "$");
			throw ma("imatcher", 'Matchers may only be "self", string patterns or RegExp objects')
		}

		function Gt(e) {
			var t = [];
			return y(e) && o(e, function(e) {
				t.push(Yt(e))
			}), t
		}

		function Kt() {
			this.SCE_CONTEXTS = va;
			var e = ["self"],
				t = [];
			this.resourceUrlWhitelist = function(t) {
				return arguments.length && (e = Gt(t)), e
			}, this.resourceUrlBlacklist = function(e) {
				return arguments.length && (t = Gt(e)), t
			}, this.$get = ["$injector",
				function(i) {
					function a(e, t) {
						return "self" === e ? nn(t) : !!e.exec(t.href)
					}

					function o(n) {
						var i, o, r = tn(n.toString()),
							s = !1;
						for (i = 0, o = e.length; i < o; i++)
							if (a(e[i], r)) {
								s = !0;
								break
							}
						if (s)
							for (i = 0, o = t.length; i < o; i++)
								if (a(t[i], r)) {
									s = !1;
									break
								}
						return s
					}

					function r(e) {
						var t = function(e) {
							this.$$unwrapTrustedValue = function() {
								return e
							}
						};
						return e && (t.prototype = new e), t.prototype.valueOf = function() {
							return this.$$unwrapTrustedValue()
						}, t.prototype.toString = function() {
							return this.$$unwrapTrustedValue().toString()
						}, t
					}

					function s(e, t) {
						var i = p.hasOwnProperty(e) ? p[e] : null;
						if (!i) throw ma("icontext", "Attempted to trust a value in invalid context. Context: {0}; Value: {1}", e, t);
						if (null === t || t === n || "" === t) return t;
						if ("string" != typeof t) throw ma("itype", "Attempted to trust a non-string value in a content requiring a string: Context: {0}", e);
						return new i(t)
					}

					function l(e) {
						return e instanceof u ? e.$$unwrapTrustedValue() : e
					}

					function c(e, t) {
						if (null === t || t === n || "" === t) return t;
						var i = p.hasOwnProperty(e) ? p[e] : null;
						if (i && t instanceof i) return t.$$unwrapTrustedValue();
						if (e === va.RESOURCE_URL) {
							if (o(t)) return t;
							throw ma("insecurl", "Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}", t.toString())
						}
						if (e === va.HTML) return d(t);
						throw ma("unsafe", "Attempting to use an unsafe value in a safe context.")
					}
					var d = function(e) {
						throw ma("unsafe", "Attempting to use an unsafe value in a safe context.")
					};
					i.has("$sanitize") && (d = i.get("$sanitize"));
					var u = r(),
						p = {};
					return p[va.HTML] = r(u), p[va.CSS] = r(u), p[va.URL] = r(u), p[va.JS] = r(u), p[va.RESOURCE_URL] = r(p[va.URL]), {
						trustAs: s,
						getTrusted: c,
						valueOf: l
					}
				}
			]
		}

		function Qt() {
			var e = !0;
			this.enabled = function(t) {
				return arguments.length && (e = !!t), e
			}, this.$get = ["$parse", "$sceDelegate",
				function(t, n) {
					if (e && Qn < 8) throw ma("iequirks", "Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");
					var i = F(va);
					i.isEnabled = function() {
						return e
					}, i.trustAs = n.trustAs, i.getTrusted = n.getTrusted, i.valueOf = n.valueOf, e || (i.trustAs = i.getTrusted = function(e, t) {
						return t
					}, i.valueOf = g), i.parseAs = function(e, n) {
						var a = t(n);
						return a.literal && a.constant ? a : t(n, function(t) {
							return i.getTrusted(e, t)
						})
					};
					var a = i.parseAs,
						r = i.getTrusted,
						s = i.trustAs;
					return o(va, function(e, t) {
						var n = Vn(t);
						i[fe("parse_as_" + n)] = function(t) {
							return a(e, t)
						}, i[fe("get_trusted_" + n)] = function(t) {
							return r(e, t)
						}, i[fe("trust_as_" + n)] = function(t) {
							return s(e, t)
						}
					}), i
				}
			]
		}

		function Xt() {
			this.$get = ["$window", "$document",
				function(e, t) {
					var n, i, a = {},
						o = p((/android (\d+)/.exec(Vn((e.navigator || {}).userAgent)) || [])[1]),
						r = /Boxee/i.test((e.navigator || {}).userAgent),
						s = t[0] || {},
						l = /^(Moz|webkit|ms)(?=[A-Z])/,
						c = s.body && s.body.style,
						d = !1,
						u = !1;
					if (c) {
						for (var f in c)
							if (i = l.exec(f)) {
								n = i[0], n = n.substr(0, 1).toUpperCase() + n.substr(1);
								break
							}
						n || (n = "WebkitOpacity" in c && "webkit"), d = !!("transition" in c || n + "Transition" in c), u = !!("animation" in c || n + "Animation" in c), !o || d && u || (d = _(s.body.style.webkitTransition), u = _(s.body.style.webkitAnimation))
					}
					return {
						history: !(!e.history || !e.history.pushState || o < 4 || r),
						hasEvent: function(e) {
							if ("input" === e && Qn <= 11) return !1;
							if (v(a[e])) {
								var t = s.createElement("div");
								a[e] = "on" + e in t
							}
							return a[e]
						},
						csp: ui(),
						vendorPrefix: n,
						transitions: d,
						animations: u,
						android: o
					}
				}
			]
		}

		function Zt() {
			this.$get = ["$templateCache", "$http", "$q",
				function(e, t, n) {
					function i(a, o) {
						function r(e) {
							if (!o) throw Vi("tpload", "Failed to load template: {0}", a);
							return n.reject(e)
						}
						i.totalPendingRequests++;
						var s = t.defaults && t.defaults.transformResponse;
						li(s) ? s = s.filter(function(e) {
							return e !== nt
						}) : s === nt && (s = null);
						var l = {
							cache: e,
							transformResponse: s
						};
						return t.get(a, l).finally(function() {
							i.totalPendingRequests--
						}).then(function(e) {
							return e.data
						}, r)
					}
					return i.totalPendingRequests = 0, i
				}
			]
		}

		function Jt() {
			this.$get = ["$rootScope", "$browser", "$location",
				function(e, t, n) {
					var i = {};
					return i.findBindings = function(e, t, n) {
						var i = e.getElementsByClassName("ng-binding"),
							a = [];
						return o(i, function(e) {
							var i = oi.element(e).data("$binding");
							i && o(i, function(i) {
								if (n) {
									new RegExp("(^|\\s)" + di(t) + "(\\s|\\||$)").test(i) && a.push(e)
								} else -1 != i.indexOf(t) && a.push(e)
							})
						}), a
					}, i.findModels = function(e, t, n) {
						for (var i = ["ng-", "data-ng-", "ng\\:"], a = 0; a < i.length; ++a) {
							var o = n ? "=" : "*=",
								r = "[" + i[a] + "model" + o + '"' + t + '"]',
								s = e.querySelectorAll(r);
							if (s.length) return s
						}
					}, i.getLocation = function() {
						return n.url()
					}, i.setLocation = function(t) {
						t !== n.url() && (n.url(t), e.$digest())
					}, i.whenStable = function(e) {
						t.notifyWhenNoOutstandingRequests(e)
					}, i
				}
			]
		}

		function en() {
			this.$get = ["$rootScope", "$browser", "$q", "$$q", "$exceptionHandler",
				function(e, t, n, i, a) {
					function o(o, s, l) {
						var c, d = y(l) && !l,
							u = (d ? i : n).defer(),
							p = u.promise;
						return c = t.defer(function() {
							try {
								u.resolve(o())
							} catch (e) {
								u.reject(e), a(e)
							} finally {
								delete r[p.$$timeoutId]
							}
							d || e.$apply()
						}, s), p.$$timeoutId = c, r[c] = u, p
					}
					var r = {};
					return o.cancel = function(e) {
						return !!(e && e.$$timeoutId in r) && (r[e.$$timeoutId].reject("canceled"), delete r[e.$$timeoutId], t.defer.cancel(e.$$timeoutId))
					}, o
				}
			]
		}

		function tn(e) {
			var t = e;
			return Qn && (ya.setAttribute("href", t), t = ya.href), ya.setAttribute("href", t), {
				href: ya.href,
				protocol: ya.protocol ? ya.protocol.replace(/:$/, "") : "",
				host: ya.host,
				search: ya.search ? ya.search.replace(/^\?/, "") : "",
				hash: ya.hash ? ya.hash.replace(/^#/, "") : "",
				hostname: ya.hostname,
				port: ya.port,
				pathname: "/" === ya.pathname.charAt(0) ? ya.pathname : "/" + ya.pathname
			}
		}

		function nn(e) {
			var t = _(e) ? tn(e) : e;
			return t.protocol === ba.protocol && t.host === ba.host
		}

		function an() {
			this.$get = m(e)
		}

		function on(e) {
			function t(i, a) {
				if (b(i)) {
					var r = {};
					return o(i, function(e, n) {
						r[n] = t(n, e)
					}), r
				}
				return e.factory(i + n, a)
			}
			var n = "Filter";
			this.register = t, this.$get = ["$injector",
				function(e) {
					return function(t) {
						return e.get(t + n)
					}
				}
			], t("currency", cn), t("date", _n), t("filter", rn), t("json", wn), t("limitTo", xn), t("lowercase", ka), t("number", dn), t("orderBy", $n), t("uppercase", Ta)
		}

		function rn() {
			return function(e, t, n) {
				if (!li(e)) return e;
				var i, a;
				switch (typeof t) {
					case "function":
						i = t;
						break;
					case "boolean":
					case "number":
					case "string":
						a = !0;
					case "object":
						i = sn(t, n, a);
						break;
					default:
						return e
				}
				return e.filter(i)
			}
		}

		function sn(e, t, n) {
			var i = b(e) && "$" in e;
			return !0 === t ? t = q : $(t) || (t = function(e, t) {
					return !b(e) && !b(t) && (e = Vn("" + e), t = Vn("" + t), -1 !== e.indexOf(t))
				}),
				function(a) {
					return i && !b(a) ? ln(a, e.$, t, !1) : ln(a, e, t, n)
				}
		}

		function ln(e, t, n, i, a) {
			var o = typeof e,
				r = typeof t;
			if ("string" === r && "!" === t.charAt(0)) return !ln(e, t.substring(1), n, i);
			if (li(e)) return e.some(function(e) {
				return ln(e, t, n, i)
			});
			switch (o) {
				case "object":
					var s;
					if (i) {
						for (s in e)
							if ("$" !== s.charAt(0) && ln(e[s], t, n, !0)) return !0;
						return !a && ln(e, t, n, !1)
					}
					if ("object" === r) {
						for (s in t) {
							var l = t[s];
							if (!$(l)) {
								var c = "$" === s;
								if (!ln(c ? e : e[s], l, n, c, c)) return !1
							}
						}
						return !0
					}
					return n(e, t);
				case "function":
					return !1;
				default:
					return n(e, t)
			}
		}

		function cn(e) {
			var t = e.NUMBER_FORMATS;
			return function(e, n, i) {
				return v(n) && (n = t.CURRENCY_SYM), v(i) && (i = t.PATTERNS[1].maxFrac), null == e ? e : un(e, t.PATTERNS[1], t.GROUP_SEP, t.DECIMAL_SEP, i).replace(/\u00A4/g, n)
			}
		}

		function dn(e) {
			var t = e.NUMBER_FORMATS;
			return function(e, n) {
				return null == e ? e : un(e, t.PATTERNS[0], t.GROUP_SEP, t.DECIMAL_SEP, n)
			}
		}

		function un(e, t, n, i, a) {
			if (!isFinite(e) || b(e)) return "";
			var o = e < 0;
			e = Math.abs(e);
			var r = e + "",
				s = "",
				l = [],
				c = !1;
			if (-1 !== r.indexOf("e")) {
				var d = r.match(/([\d\.]+)e(-?)(\d+)/);
				d && "-" == d[2] && d[3] > a + 1 ? e = 0 : (s = r, c = !0)
			}
			if (c) a > 0 && e < 1 && (s = e.toFixed(a), e = parseFloat(s));
			else {
				var u = (r.split(_a)[1] || "").length;
				v(a) && (a = Math.min(Math.max(t.minFrac, u), t.maxFrac)), e = +(Math.round(+(e.toString() + "e" + a)).toString() + "e" + -a);
				var p = ("" + e).split(_a),
					f = p[0];
				p = p[1] || "";
				var h, g = 0,
					m = t.lgSize,
					y = t.gSize;
				if (f.length >= m + y)
					for (g = f.length - m, h = 0; h < g; h++)(g - h) % y == 0 && 0 !== h && (s += n), s += f.charAt(h);
				for (h = g; h < f.length; h++)(f.length - h) % m == 0 && 0 !== h && (s += n), s += f.charAt(h);
				for (; p.length < a;) p += "0";
				a && "0" !== a && (s += i + p.substr(0, a))
			}
			return 0 === e && (o = !1), l.push(o ? t.negPre : t.posPre, s, o ? t.negSuf : t.posSuf), l.join("")
		}

		function pn(e, t, n) {
			var i = "";
			for (e < 0 && (i = "-", e = -e), e = "" + e; e.length < t;) e = "0" + e;
			return n && (e = e.substr(e.length - t)), i + e
		}

		function fn(e, t, n, i) {
			return n = n || 0,
				function(a) {
					var o = a["get" + e]();
					return (n > 0 || o > -n) && (o += n), 0 === o && -12 == n && (o = 12), pn(o, t, i)
				}
		}

		function hn(e, t) {
			return function(n, i) {
				var a = n["get" + e]();
				return i[Yn(t ? "SHORT" + e : e)][a]
			}
		}

		function gn(e) {
			var t = -1 * e.getTimezoneOffset(),
				n = t >= 0 ? "+" : "";
			return n += pn(Math[t > 0 ? "floor" : "ceil"](t / 60), 2) + pn(Math.abs(t % 60), 2)
		}

		function mn(e) {
			var t = new Date(e, 0, 1).getDay();
			return new Date(e, 0, (t <= 4 ? 5 : 12) - t)
		}

		function vn(e) {
			return new Date(e.getFullYear(), e.getMonth(), e.getDate() + (4 - e.getDay()))
		}

		function yn(e) {
			return function(t) {
				var n = mn(t.getFullYear()),
					i = vn(t),
					a = +i - +n;
				return pn(1 + Math.round(a / 6048e5), e)
			}
		}

		function bn(e, t) {
			return e.getHours() < 12 ? t.AMPMS[0] : t.AMPMS[1]
		}

		function _n(e) {
			function t(e) {
				var t;
				if (t = e.match(n)) {
					var i = new Date(0),
						a = 0,
						o = 0,
						r = t[8] ? i.setUTCFullYear : i.setFullYear,
						s = t[8] ? i.setUTCHours : i.setHours;
					t[9] && (a = p(t[9] + t[10]), o = p(t[9] + t[11])), r.call(i, p(t[1]), p(t[2]) - 1, p(t[3]));
					var l = p(t[4] || 0) - a,
						c = p(t[5] || 0) - o,
						d = p(t[6] || 0),
						u = Math.round(1e3 * parseFloat("0." + (t[7] || 0)));
					return s.call(i, l, c, d, u), i
				}
				return e
			}
			var n = /^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
			return function(n, i, a) {
				var r, s, l = "",
					c = [];
				if (i = i || "mediumDate", i = e.DATETIME_FORMATS[i] || i, _(n) && (n = $a.test(n) ? p(n) : t(n)), w(n) && (n = new Date(n)), !x(n)) return n;
				for (; i;) s = xa.exec(i), s ? (c = N(c, s, 1), i = c.pop()) : (c.push(i), i = null);
				return a && "UTC" === a && (n = new Date(n.getTime()), n.setMinutes(n.getMinutes() + n.getTimezoneOffset())), o(c, function(t) {
					r = wa[t], l += r ? r(n, e.DATETIME_FORMATS) : t.replace(/(^'|'$)/g, "").replace(/''/g, "'")
				}), l
			}
		}

		function wn() {
			return function(e, t) {
				return v(t) && (t = 2), H(e, t)
			}
		}

		function xn() {
			return function(e, t) {
				return w(e) && (e = e.toString()), li(e) || _(e) ? (t = Math.abs(Number(t)) === 1 / 0 ? Number(t) : p(t), t ? t > 0 ? e.slice(0, t) : e.slice(t) : _(e) ? "" : []) : e
			}
		}

		function $n(e) {
			return function(t, n, i) {
				function o(e, t) {
					for (var i = 0; i < n.length; i++) {
						var a = n[i](e, t);
						if (0 !== a) return a
					}
					return 0
				}

				function r(e, t) {
					return t ? function(t, n) {
						return e(n, t)
					} : e
				}

				function s(e) {
					switch (typeof e) {
						case "number":
						case "boolean":
						case "string":
							return !0;
						default:
							return !1
					}
				}

				function l(e) {
					return null === e ? "null" : "function" == typeof e.valueOf && (e = e.valueOf(), s(e)) ? e : "function" == typeof e.toString && (e = e.toString(), s(e)) ? e : ""
				}

				function c(e, t) {
					var n = typeof e,
						i = typeof t;
					return n === i && "object" === n && (e = l(e), t = l(t)), n === i ? ("string" === n && (e = e.toLowerCase(), t = t.toLowerCase()), e === t ? 0 : e < t ? -1 : 1) : n < i ? -1 : 1
				}
				return a(t) ? (n = li(n) ? n : [n], 0 === n.length && (n = ["+"]), n = n.map(function(t) {
					var n = !1,
						i = t || g;
					if (_(t)) {
						if ("+" != t.charAt(0) && "-" != t.charAt(0) || (n = "-" == t.charAt(0), t = t.substring(1)), "" === t) return r(c, n);
						if (i = e(t), i.constant) {
							var a = i();
							return r(function(e, t) {
								return c(e[a], t[a])
							}, n)
						}
					}
					return r(function(e, t) {
						return c(i(e), i(t))
					}, n)
				}), ei.call(t).sort(r(o, i))) : t
			}
		}

		function kn(e) {
			return $(e) && (e = {
				link: e
			}), e.restrict = e.restrict || "AC", m(e)
		}

		function Tn(e, t) {
			e.$name = t
		}

		function Cn(e, t, i, a, r) {
			var s = this,
				l = [],
				c = s.$$parentForm = e.parent().controller("form") || Sa;
			s.$error = {}, s.$$success = {}, s.$pending = n, s.$name = r(t.name || t.ngForm || "")(i), s.$dirty = !1, s.$pristine = !0, s.$valid = !0, s.$invalid = !1, s.$submitted = !1, c.$addControl(s), s.$rollbackViewValue = function() {
				o(l, function(e) {
					e.$rollbackViewValue()
				})
			}, s.$commitViewValue = function() {
				o(l, function(e) {
					e.$commitViewValue()
				})
			}, s.$addControl = function(e) {
				oe(e.$name, "input"), l.push(e), e.$name && (s[e.$name] = e)
			}, s.$$renameControl = function(e, t) {
				var n = e.$name;
				s[n] === e && delete s[n], s[t] = e, e.$name = t
			}, s.$removeControl = function(e) {
				e.$name && s[e.$name] === e && delete s[e.$name], o(s.$pending, function(t, n) {
					s.$setValidity(n, null, e)
				}), o(s.$error, function(t, n) {
					s.$setValidity(n, null, e)
				}), o(s.$$success, function(t, n) {
					s.$setValidity(n, null, e)
				}), O(l, e)
			}, Bn({
				ctrl: this,
				$element: e,
				set: function(e, t, n) {
					var i = e[t];
					if (i) {
						-1 === i.indexOf(n) && i.push(n)
					} else e[t] = [n]
				},
				unset: function(e, t, n) {
					var i = e[t];
					i && (O(i, n), 0 === i.length && delete e[t])
				},
				parentForm: c,
				$animate: a
			}), s.$setDirty = function() {
				a.removeClass(e, uo), a.addClass(e, po), s.$dirty = !0, s.$pristine = !1, c.$setDirty()
			}, s.$setPristine = function() {
				a.setClass(e, uo, po + " " + Pa), s.$dirty = !1, s.$pristine = !0, s.$submitted = !1, o(l, function(e) {
					e.$setPristine()
				})
			}, s.$setUntouched = function() {
				o(l, function(e) {
					e.$setUntouched()
				})
			}, s.$setSubmitted = function() {
				a.addClass(e, Pa), s.$submitted = !0, c.$setSubmitted()
			}
		}

		function Dn(e) {
			e.$formatters.push(function(t) {
				return e.$isEmpty(t) ? t : t.toString()
			})
		}

		function Sn(e, t, n, i, a, o) {
			Pn(e, t, n, i, a, o), Dn(i)
		}

		function Pn(e, t, n, i, a, o) {
			var r = Vn(t[0].type);
			if (!a.android) {
				var s = !1;
				t.on("compositionstart", function(e) {
					s = !0
				}), t.on("compositionend", function() {
					s = !1, l()
				})
			}
			var l = function(e) {
				if (c && (o.defer.cancel(c), c = null), !s) {
					var a = t.val(),
						l = e && e.type;
					"password" === r || n.ngTrim && "false" === n.ngTrim || (a = ci(a)), (i.$viewValue !== a || "" === a && i.$$hasNativeValidators) && i.$setViewValue(a, l)
				}
			};
			if (a.hasEvent("input")) t.on("input", l);
			else {
				var c, d = function(e, t, n) {
					c || (c = o.defer(function() {
						c = null, t && t.value === n || l(e)
					}))
				};
				t.on("keydown", function(e) {
					var t = e.keyCode;
					91 === t || 15 < t && t < 19 || 37 <= t && t <= 40 || d(e, this, this.value)
				}), a.hasEvent("paste") && t.on("paste cut", d)
			}
			t.on("change", l), i.$render = function() {
				t.val(i.$isEmpty(i.$viewValue) ? "" : i.$viewValue)
			}
		}

		function In(e, t) {
			if (x(e)) return e;
			if (_(e)) {
				Na.lastIndex = 0;
				var n = Na.exec(e);
				if (n) {
					var i = +n[1],
						a = +n[2],
						o = 0,
						r = 0,
						s = 0,
						l = 0,
						c = mn(i),
						d = 7 * (a - 1);
					return t && (o = t.getHours(), r = t.getMinutes(), s = t.getSeconds(), l = t.getMilliseconds()), new Date(i, 0, c.getDate() + d, o, r, s, l)
				}
			}
			return NaN
		}

		function En(e, t) {
			return function(n, i) {
				var a, r;
				if (x(n)) return n;
				if (_(n)) {
					if ('"' == n.charAt(0) && '"' == n.charAt(n.length - 1) && (n = n.substring(1, n.length - 1)), Ma.test(n)) return new Date(n);
					if (e.lastIndex = 0, a = e.exec(n)) return a.shift(), r = i ? {
						yyyy: i.getFullYear(),
						MM: i.getMonth() + 1,
						dd: i.getDate(),
						HH: i.getHours(),
						mm: i.getMinutes(),
						ss: i.getSeconds(),
						sss: i.getMilliseconds() / 1e3
					} : {
						yyyy: 1970,
						MM: 1,
						dd: 1,
						HH: 0,
						mm: 0,
						ss: 0,
						sss: 0
					}, o(a, function(e, n) {
						n < t.length && (r[t[n]] = +e)
					}), new Date(r.yyyy, r.MM - 1, r.dd, r.HH, r.mm, r.ss || 0, 1e3 * r.sss || 0)
				}
				return NaN
			}
		}

		function Ln(e, t, i, a) {
			return function(o, r, s, l, c, d, u) {
				function p(e) {
					return e && !(e.getTime && e.getTime() !== e.getTime())
				}

				function f(e) {
					return y(e) ? x(e) ? e : i(e) : n
				}
				Mn(o, r, s, l), Pn(o, r, s, l, c, d);
				var h, g = l && l.$options && l.$options.timezone;
				if (l.$$parserName = e, l.$parsers.push(function(e) {
					if (l.$isEmpty(e)) return null;
					if (t.test(e)) {
						var a = i(e, h);
						return "UTC" === g && a.setMinutes(a.getMinutes() - a.getTimezoneOffset()), a
					}
					return n
				}), l.$formatters.push(function(e) {
					if (e && !x(e)) throw ho("datefmt", "Expected `{0}` to be a date", e);
					if (p(e)) {
						if ((h = e) && "UTC" === g) {
							var t = 6e4 * h.getTimezoneOffset();
							h = new Date(h.getTime() + t)
						}
						return u("date")(e, a, g)
					}
					return h = null, ""
				}), y(s.min) || s.ngMin) {
					var m;
					l.$validators.min = function(e) {
						return !p(e) || v(m) || i(e) >= m
					}, s.$observe("min", function(e) {
						m = f(e), l.$validate()
					})
				}
				if (y(s.max) || s.ngMax) {
					var b;
					l.$validators.max = function(e) {
						return !p(e) || v(b) || i(e) <= b
					}, s.$observe("max", function(e) {
						b = f(e), l.$validate()
					})
				}
			}
		}

		function Mn(e, t, i, a) {
			var o = t[0];
			(a.$$hasNativeValidators = b(o.validity)) && a.$parsers.push(function(e) {
				var i = t.prop(zn) || {};
				return i.badInput && !i.typeMismatch ? n : e
			})
		}

		function An(e, t, i, a, o, r) {
			if (Mn(e, t, i, a), Pn(e, t, i, a, o, r), a.$$parserName = "number", a.$parsers.push(function(e) {
				return a.$isEmpty(e) ? null : ja.test(e) ? parseFloat(e) : n
			}), a.$formatters.push(function(e) {
				if (!a.$isEmpty(e)) {
					if (!w(e)) throw ho("numfmt", "Expected `{0}` to be a number", e);
					e = e.toString()
				}
				return e
			}), y(i.min) || i.ngMin) {
				var s;
				a.$validators.min = function(e) {
					return a.$isEmpty(e) || v(s) || e >= s
				}, i.$observe("min", function(e) {
					y(e) && !w(e) && (e = parseFloat(e, 10)), s = w(e) && !isNaN(e) ? e : n, a.$validate()
				})
			}
			if (y(i.max) || i.ngMax) {
				var l;
				a.$validators.max = function(e) {
					return a.$isEmpty(e) || v(l) || e <= l
				}, i.$observe("max", function(e) {
					y(e) && !w(e) && (e = parseFloat(e, 10)), l = w(e) && !isNaN(e) ? e : n, a.$validate()
				})
			}
		}

		function On(e, t, n, i, a, o) {
			Pn(e, t, n, i, a, o), Dn(i), i.$$parserName = "url", i.$validators.url = function(e, t) {
				var n = e || t;
				return i.$isEmpty(n) || Aa.test(n)
			}
		}

		function jn(e, t, n, i, a, o) {
			Pn(e, t, n, i, a, o), Dn(i), i.$$parserName = "email", i.$validators.email = function(e, t) {
				var n = e || t;
				return i.$isEmpty(n) || Oa.test(n)
			}
		}

		function Fn(e, t, n, i) {
			v(n.name) && t.attr("name", c());
			var a = function(e) {
				t[0].checked && i.$setViewValue(n.value, e && e.type)
			};
			t.on("click", a), i.$render = function() {
				var e = n.value;
				t[0].checked = e == i.$viewValue
			}, n.$observe("value", i.$render)
		}

		function qn(e, t, n, a, o) {
			var r;
			if (y(a)) {
				if (r = e(a), !r.constant) throw i("ngModel")("constexpr", "Expected constant expression for `{0}`, but saw `{1}`.", n, a);
				return r(t)
			}
			return o
		}

		function Nn(e, t, n, i, a, o, r, s) {
			var l = qn(s, e, "ngTrueValue", n.ngTrueValue, !0),
				c = qn(s, e, "ngFalseValue", n.ngFalseValue, !1),
				d = function(e) {
					i.$setViewValue(t[0].checked, e && e.type)
				};
			t.on("click", d), i.$render = function() {
				t[0].checked = i.$viewValue
			}, i.$isEmpty = function(e) {
				return !1 === e
			}, i.$formatters.push(function(e) {
				return q(e, l)
			}), i.$parsers.push(function(e) {
				return e ? l : c
			})
		}

		function Rn(e, t) {
			return e = "ngClass" + e, ["$animate",
				function(n) {
					function i(e, t) {
						var n = [];
						e: for (var i = 0; i < e.length; i++) {
							for (var a = e[i], o = 0; o < t.length; o++)
								if (a == t[o]) continue e;
							n.push(a)
						}
						return n
					}

					function a(e) {
						if (li(e)) return e;
						if (_(e)) return e.split(" ");
						if (b(e)) {
							var t = [];
							return o(e, function(e, n) {
								e && (t = t.concat(n.split(" ")))
							}), t
						}
						return e
					}
					return {
						restrict: "AC",
						link: function(r, s, l) {
							function c(e) {
								var t = u(e, 1);
								l.$addClass(t)
							}

							function d(e) {
								var t = u(e, -1);
								l.$removeClass(t)
							}

							function u(e, t) {
								var n = s.data("$classCounts") || {},
									i = [];
								return o(e, function(e) {
									(t > 0 || n[e]) && (n[e] = (n[e] || 0) + t, n[e] === +(t > 0) && i.push(e))
								}), s.data("$classCounts", n), i.join(" ")
							}

							function p(e, t) {
								var a = i(t, e),
									o = i(e, t);
								a = u(a, 1), o = u(o, -1), a && a.length && n.addClass(s, a), o && o.length && n.removeClass(s, o)
							}

							function f(e) {
								if (!0 === t || r.$index % 2 === t) {
									var n = a(e || []);
									if (h) {
										if (!q(e, h)) {
											var i = a(h);
											p(i, n)
										}
									} else c(n)
								}
								h = F(e)
							}
							var h;
							r.$watch(l[e], f, !0), l.$observe("class", function(t) {
								f(r.$eval(l[e]))
							}), "ngClass" !== e && r.$watch("$index", function(n, i) {
								var o = 1 & n;
								if (o !== (1 & i)) {
									var s = a(r.$eval(l[e]));
									o === t ? c(s) : d(s)
								}
							})
						}
					}
				}
			]
		}

		function Bn(e) {
			function t(e, t, l) {
				t === n ? i("$pending", e, l) : a("$pending", e, l), I(t) ? t ? (u(s.$error, e, l), d(s.$$success, e, l)) : (d(s.$error, e, l), u(s.$$success, e, l)) : (u(s.$error, e, l), u(s.$$success, e, l)), s.$pending ? (o(fo, !0), s.$valid = s.$invalid = n, r("", null)) : (o(fo, !1), s.$valid = Un(s.$error), s.$invalid = !s.$valid, r("", s.$valid));
				var c;
				c = s.$pending && s.$pending[e] ? n : !s.$error[e] && (!!s.$$success[e] || null), r(e, c), p.$setValidity(e, c, s)
			}

			function i(e, t, n) {
				s[e] || (s[e] = {}), d(s[e], t, n)
			}

			function a(e, t, i) {
				s[e] && u(s[e], t, i), Un(s[e]) && (s[e] = n)
			}

			function o(e, t) {
				t && !c[e] ? (f.addClass(l, e), c[e] = !0) : !t && c[e] && (f.removeClass(l, e), c[e] = !1)
			}

			function r(e, t) {
				e = e ? "-" + ne(e, "-") : "", o(lo + e, !0 === t), o(co + e, !1 === t)
			}
			var s = e.ctrl,
				l = e.$element,
				c = {},
				d = e.set,
				u = e.unset,
				p = e.parentForm,
				f = e.$animate;
			c[co] = !(c[lo] = l.hasClass(lo)), s.$setValidity = t
		}

		function Un(e) {
			if (e)
				for (var t in e) return !1;
			return !0
		}
		var Hn = /^\/(.+)\/([a-z]*)$/,
			zn = "validity",
			Vn = function(e) {
				return _(e) ? e.toLowerCase() : e
			},
			Wn = Object.prototype.hasOwnProperty,
			Yn = function(e) {
				return _(e) ? e.toUpperCase() : e
			},
			Gn = function(e) {
				return _(e) ? e.replace(/[A-Z]/g, function(e) {
					return String.fromCharCode(32 | e.charCodeAt(0))
				}) : e
			},
			Kn = function(e) {
				return _(e) ? e.replace(/[a-z]/g, function(e) {
					return String.fromCharCode(-33 & e.charCodeAt(0))
				}) : e
			};
		"i" !== "I".toLowerCase() && (Vn = Gn, Yn = Kn);
		var Qn, Xn, Zn, Jn, ei = [].slice,
			ti = [].splice,
			ni = [].push,
			ii = Object.prototype.toString,
			ai = i("ng"),
			oi = e.angular || (e.angular = {}),
			ri = 0;
		Qn = t.documentMode, h.$inject = [], g.$inject = [];
		var si, li = Array.isArray,
			ci = function(e) {
				return _(e) ? e.trim() : e
			},
			di = function(e) {
				return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g, "\\$1").replace(/\x08/g, "\\x08")
			},
			ui = function() {
				if (y(ui.isActive_)) return ui.isActive_;
				var e = !(!t.querySelector("[ng-csp]") && !t.querySelector("[data-ng-csp]"));
				if (!e) try {
					new Function("")
				} catch (t) {
					e = !0
				}
				return ui.isActive_ = e
			},
			pi = ["ng-", "data-ng-", "ng:", "x-ng-"],
			fi = /[A-Z]/g,
			hi = !1,
			gi = 1,
			mi = 3,
			vi = 8,
			yi = 9,
			bi = 11,
			_i = {
				full: "1.3.14",
				major: 1,
				minor: 3,
				dot: 14,
				codeName: "instantaneous-browserification"
			};
		ye.expando = "ng339";
		var wi = ye.cache = {},
			xi = 1,
			$i = function(e, t, n) {
				e.addEventListener(t, n, !1)
			},
			ki = function(e, t, n) {
				e.removeEventListener(t, n, !1)
			};
		ye._data = function(e) {
			return this.cache[e[this.expando]] || {}
		};
		var Ti = /([\:\-\_]+(.))/g,
			Ci = /^moz([A-Z])/,
			Di = {
				mouseleave: "mouseout",
				mouseenter: "mouseover"
			},
			Si = i("jqLite"),
			Pi = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
			Ii = /<|&#?\w+;/,
			Ei = /<([\w:]+)/,
			Li = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
			Mi = {
				option: [1, '<select multiple="multiple">', "</select>"],
				thead: [1, "<table>", "</table>"],
				col: [2, "<table><colgroup>", "</colgroup></table>"],
				tr: [2, "<table><tbody>", "</tbody></table>"],
				td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
				_default: [0, "", ""]
			};
		Mi.optgroup = Mi.option, Mi.tbody = Mi.tfoot = Mi.colgroup = Mi.caption = Mi.thead, Mi.th = Mi.td;
		var Ai = ye.prototype = {
				ready: function(n) {
					function i() {
						a || (a = !0, n())
					}
					var a = !1;
					"complete" === t.readyState ? setTimeout(i) : (this.on("DOMContentLoaded", i), ye(e).on("load", i))
				},
				toString: function() {
					var e = [];
					return o(this, function(t) {
						e.push("" + t)
					}), "[" + e.join(", ") + "]"
				},
				eq: function(e) {
					return Xn(e >= 0 ? this[e] : this[this.length + e])
				},
				length: 0,
				push: ni,
				sort: [].sort,
				splice: [].splice
			},
			Oi = {};
		o("multiple,selected,checked,disabled,readOnly,required,open".split(","), function(e) {
			Oi[Vn(e)] = e
		});
		var ji = {};
		o("input,select,option,textarea,button,form,details".split(","), function(e) {
			ji[e] = !0
		});
		var Fi = {
			ngMinlength: "minlength",
			ngMaxlength: "maxlength",
			ngMin: "min",
			ngMax: "max",
			ngPattern: "pattern"
		};
		o({
			data: ke,
			removeData: xe
		}, function(e, t) {
			ye[t] = e
		}), o({
			data: ke,
			inheritedData: Ie,
			scope: function(e) {
				return Xn.data(e, "$scope") || Ie(e.parentNode || e, ["$isolateScope", "$scope"])
			},
			isolateScope: function(e) {
				return Xn.data(e, "$isolateScope") || Xn.data(e, "$isolateScopeNoTemplate")
			},
			controller: Pe,
			injector: function(e) {
				return Ie(e, "$injector")
			},
			removeAttr: function(e, t) {
				e.removeAttribute(t)
			},
			hasClass: Te,
			css: function(e, t, n) {
				if (t = fe(t), !y(n)) return e.style[t];
				e.style[t] = n
			},
			attr: function(e, t, i) {
				var a = Vn(t);
				if (Oi[a]) {
					if (!y(i)) return e[t] || (e.attributes.getNamedItem(t) || h).specified ? a : n;
					i ? (e[t] = !0, e.setAttribute(t, a)) : (e[t] = !1, e.removeAttribute(a))
				} else if (y(i)) e.setAttribute(t, i);
				else if (e.getAttribute) {
					var o = e.getAttribute(t, 2);
					return null === o ? n : o
				}
			},
			prop: function(e, t, n) {
				if (!y(n)) return e[t];
				e[t] = n
			},
			text: function() {
				function e(e, t) {
					if (v(t)) {
						var n = e.nodeType;
						return n === gi || n === mi ? e.textContent : ""
					}
					e.textContent = t
				}
				return e.$dv = "", e
			}(),
			val: function(e, t) {
				if (v(t)) {
					if (e.multiple && "select" === A(e)) {
						var n = [];
						return o(e.options, function(e) {
							e.selected && n.push(e.value || e.text)
						}), 0 === n.length ? null : n
					}
					return e.value
				}
				e.value = t
			},
			html: function(e, t) {
				if (v(t)) return e.innerHTML;
				_e(e, !0), e.innerHTML = t
			},
			empty: Ee
		}, function(e, t) {
			ye.prototype[t] = function(t, i) {
				var a, o, r = this.length;
				if (e !== Ee && (2 == e.length && e !== Te && e !== Pe ? t : i) === n) {
					if (b(t)) {
						for (a = 0; a < r; a++)
							if (e === ke) e(this[a], t);
							else
								for (o in t) e(this[a], o, t[o]);
						return this
					}
					for (var s = e.$dv, l = s === n ? Math.min(r, 1) : r, c = 0; c < l; c++) {
						var d = e(this[c], t, i);
						s = s ? s + d : d
					}
					return s
				}
				for (a = 0; a < r; a++) e(this[a], t, i);
				return this
			}
		}), o({
			removeData: xe,
			on: function e(t, n, i, a) {
				if (y(a)) throw Si("onargs", "jqLite#on() does not support the `selector` or `eventData` parameters");
				if (ge(t)) {
					var o = $e(t, !0),
						r = o.events,
						s = o.handle;
					s || (s = o.handle = je(t, r));
					for (var l = n.indexOf(" ") >= 0 ? n.split(" ") : [n], c = l.length; c--;) {
						n = l[c];
						var d = r[n];
						d || (r[n] = [], "mouseenter" === n || "mouseleave" === n ? e(t, Di[n], function(e) {
							var t = this,
								i = e.relatedTarget;
							i && (i === t || t.contains(i)) || s(e, n)
						}) : "$destroy" !== n && $i(t, n, s), d = r[n]), d.push(i)
					}
				}
			},
			off: we,
			one: function(e, t, n) {
				e = Xn(e), e.on(t, function i() {
					e.off(t, n), e.off(t, i)
				}), e.on(t, n)
			},
			replaceWith: function(e, t) {
				var n, i = e.parentNode;
				_e(e), o(new ye(t), function(t) {
					n ? i.insertBefore(t, n.nextSibling) : i.replaceChild(t, e), n = t
				})
			},
			children: function(e) {
				var t = [];
				return o(e.childNodes, function(e) {
					e.nodeType === gi && t.push(e)
				}), t
			},
			contents: function(e) {
				return e.contentDocument || e.childNodes || []
			},
			append: function(e, t) {
				var n = e.nodeType;
				if (n === gi || n === bi) {
					t = new ye(t);
					for (var i = 0, a = t.length; i < a; i++) {
						var o = t[i];
						e.appendChild(o)
					}
				}
			},
			prepend: function(e, t) {
				if (e.nodeType === gi) {
					var n = e.firstChild;
					o(new ye(t), function(t) {
						e.insertBefore(t, n)
					})
				}
			},
			wrap: function(e, t) {
				t = Xn(t).eq(0).clone()[0];
				var n = e.parentNode;
				n && n.replaceChild(t, e), t.appendChild(e)
			},
			remove: Le,
			detach: function(e) {
				Le(e, !0)
			},
			after: function(e, t) {
				var n = e,
					i = e.parentNode;
				t = new ye(t);
				for (var a = 0, o = t.length; a < o; a++) {
					var r = t[a];
					i.insertBefore(r, n.nextSibling), n = r
				}
			},
			addClass: De,
			removeClass: Ce,
			toggleClass: function(e, t, n) {
				t && o(t.split(" "), function(t) {
					var i = n;
					v(i) && (i = !Te(e, t)), (i ? De : Ce)(e, t)
				})
			},
			parent: function(e) {
				var t = e.parentNode;
				return t && t.nodeType !== bi ? t : null
			},
			next: function(e) {
				return e.nextElementSibling
			},
			find: function(e, t) {
				return e.getElementsByTagName ? e.getElementsByTagName(t) : []
			},
			clone: be,
			triggerHandler: function(e, t, n) {
				var i, a, r, s = t.type || t,
					l = $e(e),
					c = l && l.events,
					d = c && c[s];
				d && (i = {
					preventDefault: function() {
						this.defaultPrevented = !0
					},
					isDefaultPrevented: function() {
						return !0 === this.defaultPrevented
					},
					stopImmediatePropagation: function() {
						this.immediatePropagationStopped = !0
					},
					isImmediatePropagationStopped: function() {
						return !0 === this.immediatePropagationStopped
					},
					stopPropagation: h,
					type: s,
					target: e
				}, t.type && (i = u(i, t)), a = F(d), r = n ? [i].concat(n) : [i], o(a, function(t) {
					i.isImmediatePropagationStopped() || t.apply(e, r)
				}))
			}
		}, function(e, t) {
			ye.prototype[t] = function(t, n, i) {
				for (var a, o = 0, r = this.length; o < r; o++) v(a) ? (a = e(this[o], t, n, i), y(a) && (a = Xn(a))) : Se(a, e(this[o], t, n, i));
				return y(a) ? a : this
			}, ye.prototype.bind = ye.prototype.on, ye.prototype.unbind = ye.prototype.off
		}), Ne.prototype = {
			put: function(e, t) {
				this[qe(e, this.nextUid)] = t
			},
			get: function(e) {
				return this[qe(e, this.nextUid)]
			},
			remove: function(e) {
				var t = this[e = qe(e, this.nextUid)];
				return delete this[e], t
			}
		};
		var qi = /^function\s*[^\(]*\(\s*([^\)]*)\)/m,
			Ni = /,/,
			Ri = /^\s*(_?)(\S+?)\1\s*$/,
			Bi = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,
			Ui = i("$injector");
		Ue.$$annotate = Be;
		var Hi = i("$animate"),
			zi = ["$provide",
				function(e) {
					this.$$selectors = {}, this.register = function(t, n) {
						var i = t + "-animation";
						if (t && "." != t.charAt(0)) throw Hi("notcsel", "Expecting class selector starting with '.' got '{0}'.", t);
						this.$$selectors[t.substr(1)] = i, e.factory(i, n)
					}, this.classNameFilter = function(e) {
						return 1 === arguments.length && (this.$$classNameFilter = e instanceof RegExp ? e : null), this.$$classNameFilter
					}, this.$get = ["$$q", "$$asyncCallback", "$rootScope",
						function(e, t, n) {
							function i(t) {
								var i, a = e.defer();
								return a.promise.$$cancelFn = function() {
									i && i()
								}, n.$$postDigest(function() {
									i = t(function() {
										a.resolve()
									})
								}), a.promise
							}

							function a(e, t) {
								var n = [],
									i = [],
									a = le();
								return o((e.attr("class") || "").split(/\s+/), function(e) {
									a[e] = !0
								}), o(t, function(e, t) {
									var o = a[t];
									!1 === e && o ? i.push(t) : !0 !== e || o || n.push(t)
								}), n.length + i.length > 0 && [n.length ? n : null, i.length ? i : null]
							}

							function r(e, t, n) {
								for (var i = 0, a = t.length; i < a; ++i) {
									e[t[i]] = n
								}
							}

							function s() {
								return c || (c = e.defer(), t(function() {
									c.resolve(), c = null
								})), c.promise
							}

							function l(e, t) {
								if (oi.isObject(t)) {
									var n = u(t.from || {}, t.to || {});
									e.css(n)
								}
							}
							var c;
							return {
								animate: function(e, t, n) {
									return l(e, {
										from: t,
										to: n
									}), s()
								},
								enter: function(e, t, n, i) {
									return l(e, i), n ? n.after(e) : t.prepend(e), s()
								},
								leave: function(e, t) {
									return e.remove(), s()
								},
								move: function(e, t, n, i) {
									return this.enter(e, t, n, i)
								},
								addClass: function(e, t, n) {
									return this.setClass(e, t, [], n)
								},
								$$addClassImmediately: function(e, t, n) {
									return e = Xn(e), t = _(t) ? t : li(t) ? t.join(" ") : "", o(e, function(e) {
										De(e, t)
									}), l(e, n), s()
								},
								removeClass: function(e, t, n) {
									return this.setClass(e, [], t, n)
								},
								$$removeClassImmediately: function(e, t, n) {
									return e = Xn(e), t = _(t) ? t : li(t) ? t.join(" ") : "", o(e, function(e) {
										Ce(e, t)
									}), l(e, n), s()
								},
								setClass: function(e, t, n, o) {
									var s = this,
										l = !1;
									e = Xn(e);
									var c = e.data("$$animateClasses");
									c ? o && c.options && (c.options = oi.extend(c.options || {}, o)) : (c = {
										classes: {},
										options: o
									}, l = !0);
									var d = c.classes;
									return t = li(t) ? t : t.split(" "), n = li(n) ? n : n.split(" "), r(d, t, !0), r(d, n, !1), l && (c.promise = i(function(t) {
										var n = e.data("$$animateClasses");
										if (e.removeData("$$animateClasses"), n) {
											var i = a(e, n.classes);
											i && s.$$setClassImmediately(e, i[0], i[1], n.options)
										}
										t()
									}), e.data("$$animateClasses", c)), c.promise
								},
								$$setClassImmediately: function(e, t, n, i) {
									return t && this.$$addClassImmediately(e, t), n && this.$$removeClassImmediately(e, n), l(e, i), s()
								},
								enabled: h,
								cancel: h
							}
						}
					]
				}
			],
			Vi = i("$compile");
		Ke.$inject = ["$provide", "$$sanitizeUriProvider"];
		var Wi = /^((?:x|data)[\:\-_])/i,
			Yi = i("$controller"),
			Gi = "application/json",
			Ki = {
				"Content-Type": Gi + ";charset=utf-8"
			},
			Qi = /^\[|^\{(?!\{)/,
			Xi = {
				"[": /]$/,
				"{": /}$/
			},
			Zi = /^\)\]\}',?\n/,
			Ji = i("$interpolate"),
			ea = /^([^\?#]*)(\?([^#]*))?(#(.*))?$/,
			ta = {
				http: 80,
				https: 443,
				ftp: 21
			},
			na = i("$location"),
			ia = {
				$$html5: !1,
				$$replace: !1,
				absUrl: Ct("$$absUrl"),
				url: function(e) {
					if (v(e)) return this.$$url;
					var t = ea.exec(e);
					return (t[1] || "" === e) && this.path(decodeURIComponent(t[1])), (t[2] || t[1] || "" === e) && this.search(t[3] || ""), this.hash(t[5] || ""), this
				},
				protocol: Ct("$$protocol"),
				host: Ct("$$host"),
				port: Ct("$$port"),
				path: Dt("$$path", function(e) {
					return e = null !== e ? e.toString() : "", "/" == e.charAt(0) ? e : "/" + e
				}),
				search: function(e, t) {
					switch (arguments.length) {
						case 0:
							return this.$$search;
						case 1:
							if (_(e) || w(e)) e = e.toString(), this.$$search = Y(e);
							else {
								if (!b(e)) throw na("isrcharg", "The first argument of the `$location#search()` call must be a string or an object.");
								e = j(e, {}), o(e, function(t, n) {
									null == t && delete e[n]
								}), this.$$search = e
							}
							break;
						default:
							v(t) || null === t ? delete this.$$search[e] : this.$$search[e] = t
					}
					return this.$$compose(), this
				},
				hash: Dt("$$hash", function(e) {
					return null !== e ? e.toString() : ""
				}),
				replace: function() {
					return this.$$replace = !0, this
				}
			};
		o([Tt, kt, $t], function(e) {
			e.prototype = Object.create(ia), e.prototype.state = function(t) {
				if (!arguments.length) return this.$$state;
				if (e !== $t || !this.$$html5) throw na("nostate", "History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");
				return this.$$state = v(t) ? null : t, this
			}
		});
		var aa = i("$parse"),
			oa = Function.prototype.call,
			ra = Function.prototype.apply,
			sa = Function.prototype.bind,
			la = le();
		o({
			null: function() {
				return null
			},
			true: function() {
				return !0
			},
			false: function() {
				return !1
			},
			undefined: function() {}
		}, function(e, t) {
			e.constant = e.literal = e.sharedGetter = !0, la[t] = e
		}), la.this = function(e) {
			return e
		}, la.this.sharedGetter = !0;
		var ca = u(le(), {
				"+": function(e, t, i, a) {
					return i = i(e, t), a = a(e, t), y(i) ? y(a) ? i + a : i : y(a) ? a : n
				},
				"-": function(e, t, n, i) {
					return n = n(e, t), i = i(e, t), (y(n) ? n : 0) - (y(i) ? i : 0)
				},
				"*": function(e, t, n, i) {
					return n(e, t) * i(e, t)
				},
				"/": function(e, t, n, i) {
					return n(e, t) / i(e, t)
				},
				"%": function(e, t, n, i) {
					return n(e, t) % i(e, t)
				},
				"===": function(e, t, n, i) {
					return n(e, t) === i(e, t)
				},
				"!==": function(e, t, n, i) {
					return n(e, t) !== i(e, t)
				},
				"==": function(e, t, n, i) {
					return n(e, t) == i(e, t)
				},
				"!=": function(e, t, n, i) {
					return n(e, t) != i(e, t)
				},
				"<": function(e, t, n, i) {
					return n(e, t) < i(e, t)
				},
				">": function(e, t, n, i) {
					return n(e, t) > i(e, t)
				},
				"<=": function(e, t, n, i) {
					return n(e, t) <= i(e, t)
				},
				">=": function(e, t, n, i) {
					return n(e, t) >= i(e, t)
				},
				"&&": function(e, t, n, i) {
					return n(e, t) && i(e, t)
				},
				"||": function(e, t, n, i) {
					return n(e, t) || i(e, t)
				},
				"!": function(e, t, n) {
					return !n(e, t)
				},
				"=": !0,
				"|": !0
			}),
			da = {
				n: "\n",
				f: "\f",
				r: "\r",
				t: "\t",
				v: "\v",
				"'": "'",
				'"': '"'
			},
			ua = function(e) {
				this.options = e
			};
		ua.prototype = {
			constructor: ua,
			lex: function(e) {
				for (this.text = e, this.index = 0, this.tokens = []; this.index < this.text.length;) {
					var t = this.text.charAt(this.index);
					if ('"' === t || "'" === t) this.readString(t);
					else if (this.isNumber(t) || "." === t && this.isNumber(this.peek())) this.readNumber();
					else if (this.isIdent(t)) this.readIdent();
					else if (this.is(t, "(){}[].,;:?")) this.tokens.push({
						index: this.index,
						text: t
					}), this.index++;
					else if (this.isWhitespace(t)) this.index++;
					else {
						var n = t + this.peek(),
							i = n + this.peek(2),
							a = ca[t],
							o = ca[n],
							r = ca[i];
						if (a || o || r) {
							var s = r ? i : o ? n : t;
							this.tokens.push({
								index: this.index,
								text: s,
								operator: !0
							}), this.index += s.length
						} else this.throwError("Unexpected next character ", this.index, this.index + 1)
					}
				}
				return this.tokens
			},
			is: function(e, t) {
				return -1 !== t.indexOf(e)
			},
			peek: function(e) {
				var t = e || 1;
				return this.index + t < this.text.length && this.text.charAt(this.index + t)
			},
			isNumber: function(e) {
				return "0" <= e && e <= "9" && "string" == typeof e
			},
			isWhitespace: function(e) {
				return " " === e || "\r" === e || "\t" === e || "\n" === e || "\v" === e || " " === e
			},
			isIdent: function(e) {
				return "a" <= e && e <= "z" || "A" <= e && e <= "Z" || "_" === e || "$" === e
			},
			isExpOperator: function(e) {
				return "-" === e || "+" === e || this.isNumber(e)
			},
			throwError: function(e, t, n) {
				n = n || this.index;
				var i = y(t) ? "s " + t + "-" + this.index + " [" + this.text.substring(t, n) + "]" : " " + n;
				throw aa("lexerr", "Lexer Error: {0} at column{1} in expression [{2}].", e, i, this.text)
			},
			readNumber: function() {
				for (var e = "", t = this.index; this.index < this.text.length;) {
					var n = Vn(this.text.charAt(this.index));
					if ("." == n || this.isNumber(n)) e += n;
					else {
						var i = this.peek();
						if ("e" == n && this.isExpOperator(i)) e += n;
						else if (this.isExpOperator(n) && i && this.isNumber(i) && "e" == e.charAt(e.length - 1)) e += n;
						else {
							if (!this.isExpOperator(n) || i && this.isNumber(i) || "e" != e.charAt(e.length - 1)) break;
							this.throwError("Invalid exponent")
						}
					}
					this.index++
				}
				this.tokens.push({
					index: t,
					text: e,
					constant: !0,
					value: Number(e)
				})
			},
			readIdent: function() {
				for (var e = this.index; this.index < this.text.length;) {
					var t = this.text.charAt(this.index);
					if (!this.isIdent(t) && !this.isNumber(t)) break;
					this.index++
				}
				this.tokens.push({
					index: e,
					text: this.text.slice(e, this.index),
					identifier: !0
				})
			},
			readString: function(e) {
				var t = this.index;
				this.index++;
				for (var n = "", i = e, a = !1; this.index < this.text.length;) {
					var o = this.text.charAt(this.index);
					if (i += o, a) {
						if ("u" === o) {
							var r = this.text.substring(this.index + 1, this.index + 5);
							r.match(/[\da-f]{4}/i) || this.throwError("Invalid unicode escape [\\u" + r + "]"), this.index += 4, n += String.fromCharCode(parseInt(r, 16))
						} else {
							n += da[o] || o
						}
						a = !1
					} else if ("\\" === o) a = !0;
					else {
						if (o === e) return this.index++, void this.tokens.push({
							index: t,
							text: i,
							constant: !0,
							value: n
						});
						n += o
					}
					this.index++
				}
				this.throwError("Unterminated quote", t)
			}
		};
		var pa = function(e, t, n) {
			this.lexer = e, this.$filter = t, this.options = n
		};
		pa.ZERO = u(function() {
			return 0
		}, {
			sharedGetter: !0,
			constant: !0
		}), pa.prototype = {
			constructor: pa,
			parse: function(e) {
				this.text = e, this.tokens = this.lexer.lex(e);
				var t = this.statements();
				return 0 !== this.tokens.length && this.throwError("is an unexpected token", this.tokens[0]), t.literal = !!t.literal, t.constant = !!t.constant, t
			},
			primary: function() {
				var e;
				this.expect("(") ? (e = this.filterChain(), this.consume(")")) : this.expect("[") ? e = this.arrayDeclaration() : this.expect("{") ? e = this.object() : this.peek().identifier && this.peek().text in la ? e = la[this.consume().text] : this.peek().identifier ? e = this.identifier() : this.peek().constant ? e = this.constant() : this.throwError("not a primary expression", this.peek());
				for (var t, n; t = this.expect("(", "[", ".");) "(" === t.text ? (e = this.functionCall(e, n), n = null) : "[" === t.text ? (n = e, e = this.objectIndex(e)) : "." === t.text ? (n = e, e = this.fieldAccess(e)) : this.throwError("IMPOSSIBLE");
				return e
			},
			throwError: function(e, t) {
				throw aa("syntax", "Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].", t.text, e, t.index + 1, this.text, this.text.substring(t.index))
			},
			peekToken: function() {
				if (0 === this.tokens.length) throw aa("ueoe", "Unexpected end of expression: {0}", this.text);
				return this.tokens[0]
			},
			peek: function(e, t, n, i) {
				return this.peekAhead(0, e, t, n, i)
			},
			peekAhead: function(e, t, n, i, a) {
				if (this.tokens.length > e) {
					var o = this.tokens[e],
						r = o.text;
					if (r === t || r === n || r === i || r === a || !t && !n && !i && !a) return o
				}
				return !1
			},
			expect: function(e, t, n, i) {
				var a = this.peek(e, t, n, i);
				return !!a && (this.tokens.shift(), a)
			},
			consume: function(e) {
				if (0 === this.tokens.length) throw aa("ueoe", "Unexpected end of expression: {0}", this.text);
				var t = this.expect(e);
				return t || this.throwError("is unexpected, expecting [" + e + "]", this.peek()), t
			},
			unaryFn: function(e, t) {
				var n = ca[e];
				return u(function(e, i) {
					return n(e, i, t)
				}, {
					constant: t.constant,
					inputs: [t]
				})
			},
			binaryFn: function(e, t, n, i) {
				var a = ca[t];
				return u(function(t, i) {
					return a(t, i, e, n)
				}, {
					constant: e.constant && n.constant,
					inputs: !i && [e, n]
				})
			},
			identifier: function() {
				for (var e = this.consume().text; this.peek(".") && this.peekAhead(1).identifier && !this.peekAhead(2, "(");) e += this.consume().text + this.consume().text;
				return qt(e, this.options, this.text)
			},
			constant: function() {
				var e = this.consume().value;
				return u(function() {
					return e
				}, {
					constant: !0,
					literal: !0
				})
			},
			statements: function() {
				for (var e = [];;)
					if (this.tokens.length > 0 && !this.peek("}", ")", ";", "]") && e.push(this.filterChain()), !this.expect(";")) return 1 === e.length ? e[0] : function(t, n) {
						for (var i, a = 0, o = e.length; a < o; a++) i = e[a](t, n);
						return i
					}
			},
			filterChain: function() {
				for (var e = this.expression(); this.expect("|");) e = this.filter(e);
				return e
			},
			filter: function(e) {
				var t, i, a = this.$filter(this.consume().text);
				if (this.peek(":"))
					for (t = [], i = []; this.expect(":");) t.push(this.expression());
				var o = [e].concat(t || []);
				return u(function(o, r) {
					var s = e(o, r);
					if (i) {
						i[0] = s;
						for (var l = t.length; l--;) i[l + 1] = t[l](o, r);
						return a.apply(n, i)
					}
					return a(s)
				}, {
					constant: !a.$stateful && o.every(Mt),
					inputs: !a.$stateful && o
				})
			},
			expression: function() {
				return this.assignment()
			},
			assignment: function() {
				var e, t, n = this.ternary();
				return (t = this.expect("=")) ? (n.assign || this.throwError("implies assignment but [" + this.text.substring(0, t.index) + "] can not be assigned to", t), e = this.ternary(), u(function(t, i) {
					return n.assign(t, e(t, i), i)
				}, {
					inputs: [n, e]
				})) : n
			},
			ternary: function() {
				var e, t = this.logicalOR();
				if (this.expect("?") && (e = this.assignment(), this.consume(":"))) {
					var n = this.assignment();
					return u(function(i, a) {
						return t(i, a) ? e(i, a) : n(i, a)
					}, {
						constant: t.constant && e.constant && n.constant
					})
				}
				return t
			},
			logicalOR: function() {
				for (var e, t = this.logicalAND(); e = this.expect("||");) t = this.binaryFn(t, e.text, this.logicalAND(), !0);
				return t
			},
			logicalAND: function() {
				for (var e, t = this.equality(); e = this.expect("&&");) t = this.binaryFn(t, e.text, this.equality(), !0);
				return t
			},
			equality: function() {
				for (var e, t = this.relational(); e = this.expect("==", "!=", "===", "!==");) t = this.binaryFn(t, e.text, this.relational());
				return t
			},
			relational: function() {
				for (var e, t = this.additive(); e = this.expect("<", ">", "<=", ">=");) t = this.binaryFn(t, e.text, this.additive());
				return t
			},
			additive: function() {
				for (var e, t = this.multiplicative(); e = this.expect("+", "-");) t = this.binaryFn(t, e.text, this.multiplicative());
				return t
			},
			multiplicative: function() {
				for (var e, t = this.unary(); e = this.expect("*", "/", "%");) t = this.binaryFn(t, e.text, this.unary());
				return t
			},
			unary: function() {
				var e;
				return this.expect("+") ? this.primary() : (e = this.expect("-")) ? this.binaryFn(pa.ZERO, e.text, this.unary()) : (e = this.expect("!")) ? this.unaryFn(e.text, this.unary()) : this.primary()
			},
			fieldAccess: function(e) {
				var t = this.identifier();
				return u(function(i, a, o) {
					var r = o || e(i, a);
					return null == r ? n : t(r)
				}, {
					assign: function(n, i, a) {
						var o = e(n, a);
						return o || e.assign(n, o = {}, a), t.assign(o, i)
					}
				})
			},
			objectIndex: function(e) {
				var t = this.text,
					i = this.expression();
				return this.consume("]"), u(function(a, o) {
					var r = e(a, o),
						s = i(a, o);
					return It(s, t), r ? Et(r[s], t) : n
				}, {
					assign: function(n, a, o) {
						var r = It(i(n, o), t),
							s = Et(e(n, o), t);
						return s || e.assign(n, s = {}, o), s[r] = a
					}
				})
			},
			functionCall: function(e, t) {
				var i = [];
				if (")" !== this.peekToken().text)
					do {
						i.push(this.expression())
					} while (this.expect(","));
				this.consume(")");
				var a = this.text,
					o = i.length ? [] : null;
				return function(r, s) {
					var l = t ? t(r, s) : y(t) ? n : r,
						c = e(r, s, l) || h;
					if (o)
						for (var d = i.length; d--;) o[d] = Et(i[d](r, s), a);
					Et(l, a), Lt(c, a);
					var u = c.apply ? c.apply(l, o) : c(o[0], o[1], o[2], o[3], o[4]);
					return o && (o.length = 0), Et(u, a)
				}
			},
			arrayDeclaration: function() {
				var e = [];
				if ("]" !== this.peekToken().text)
					do {
						if (this.peek("]")) break;
						e.push(this.expression())
					} while (this.expect(","));
				return this.consume("]"), u(function(t, n) {
					for (var i = [], a = 0, o = e.length; a < o; a++) i.push(e[a](t, n));
					return i
				}, {
					literal: !0,
					constant: e.every(Mt),
					inputs: e
				})
			},
			object: function() {
				var e = [],
					t = [];
				if ("}" !== this.peekToken().text)
					do {
						if (this.peek("}")) break;
						var n = this.consume();
						n.constant ? e.push(n.value) : n.identifier ? e.push(n.text) : this.throwError("invalid key", n), this.consume(":"), t.push(this.expression())
					} while (this.expect(","));
				return this.consume("}"), u(function(n, i) {
					for (var a = {}, o = 0, r = t.length; o < r; o++) a[e[o]] = t[o](n, i);
					return a
				}, {
					literal: !0,
					constant: t.every(Mt),
					inputs: t
				})
			}
		};
		var fa = le(),
			ha = le(),
			ga = Object.prototype.valueOf,
			ma = i("$sce"),
			va = {
				HTML: "html",
				CSS: "css",
				URL: "url",
				RESOURCE_URL: "resourceUrl",
				JS: "js"
			},
			Vi = i("$compile"),
			ya = t.createElement("a"),
			ba = tn(e.location.href);
		on.$inject = ["$provide"], cn.$inject = ["$locale"], dn.$inject = ["$locale"];
		var _a = ".",
			wa = {
				yyyy: fn("FullYear", 4),
				yy: fn("FullYear", 2, 0, !0),
				y: fn("FullYear", 1),
				MMMM: hn("Month"),
				MMM: hn("Month", !0),
				MM: fn("Month", 2, 1),
				M: fn("Month", 1, 1),
				dd: fn("Date", 2),
				d: fn("Date", 1),
				HH: fn("Hours", 2),
				H: fn("Hours", 1),
				hh: fn("Hours", 2, -12),
				h: fn("Hours", 1, -12),
				mm: fn("Minutes", 2),
				m: fn("Minutes", 1),
				ss: fn("Seconds", 2),
				s: fn("Seconds", 1),
				sss: fn("Milliseconds", 3),
				EEEE: hn("Day"),
				EEE: hn("Day", !0),
				a: bn,
				Z: gn,
				ww: yn(2),
				w: yn(1)
			},
			xa = /((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,
			$a = /^\-?\d+$/;
		_n.$inject = ["$locale"];
		var ka = m(Vn),
			Ta = m(Yn);
		$n.$inject = ["$parse"];
		var Ca = m({
				restrict: "E",
				compile: function(e, t) {
					if (!t.href && !t.xlinkHref && !t.name) return function(e, t) {
						if ("a" === t[0].nodeName.toLowerCase()) {
							var n = "[object SVGAnimatedString]" === ii.call(t.prop("href")) ? "xlink:href" : "href";
							t.on("click", function(e) {
								t.attr(n) || e.preventDefault()
							})
						}
					}
				}
			}),
			Da = {};
		o(Oi, function(e, t) {
			if ("multiple" != e) {
				var n = Qe("ng-" + t);
				Da[n] = function() {
					return {
						restrict: "A",
						priority: 100,
						link: function(e, i, a) {
							e.$watch(a[n], function(e) {
								a.$set(t, !!e)
							})
						}
					}
				}
			}
		}), o(Fi, function(e, t) {
			Da[t] = function() {
				return {
					priority: 100,
					link: function(e, n, i) {
						if ("ngPattern" === t && "/" == i.ngPattern.charAt(0)) {
							var a = i.ngPattern.match(Hn);
							if (a) return void i.$set("ngPattern", new RegExp(a[1], a[2]))
						}
						e.$watch(i[t], function(e) {
							i.$set(t, e)
						})
					}
				}
			}
		}), o(["src", "srcset", "href"], function(e) {
			var t = Qe("ng-" + e);
			Da[t] = function() {
				return {
					priority: 99,
					link: function(n, i, a) {
						var o = e,
							r = e;
						"href" === e && "[object SVGAnimatedString]" === ii.call(i.prop("href")) && (r = "xlinkHref", a.$attr[r] = "xlink:href", o = null), a.$observe(t, function(t) {
							if (!t) return void("href" === e && a.$set(r, null));
							a.$set(r, t), Qn && o && i.prop(o, a[r])
						})
					}
				}
			}
		});
		var Sa = {
				$addControl: h,
				$$renameControl: Tn,
				$removeControl: h,
				$setValidity: h,
				$setDirty: h,
				$setPristine: h,
				$setSubmitted: h
			},
			Pa = "ng-submitted";
		Cn.$inject = ["$element", "$attrs", "$scope", "$animate", "$interpolate"];
		var Ia = function(e) {
				return ["$timeout",
					function(t) {
						return {
							name: "form",
							restrict: e ? "EAC" : "E",
							controller: Cn,
							compile: function(e) {
								return e.addClass(uo).addClass(lo), {
									pre: function(e, i, a, o) {
										if (!("action" in a)) {
											var r = function(t) {
												e.$apply(function() {
													o.$commitViewValue(), o.$setSubmitted()
												}), t.preventDefault()
											};
											$i(i[0], "submit", r), i.on("$destroy", function() {
												t(function() {
													ki(i[0], "submit", r)
												}, 0, !1)
											})
										}
										var s = o.$$parentForm,
											l = o.$name;
										l && (At(e, null, l, o, l), a.$observe(a.name ? "name" : "ngForm", function(t) {
											l !== t && (At(e, null, l, n, l), l = t, At(e, null, l, o, l), s.$$renameControl(o, l))
										})), i.on("$destroy", function() {
											s.$removeControl(o), l && At(e, null, l, n, l), u(o, Sa)
										})
									}
								}
							}
						}
					}
				]
			},
			Ea = Ia(),
			La = Ia(!0),
			Ma = /\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,
			Aa = /^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,
			Oa = /^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,
			ja = /^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,
			Fa = /^(\d{4})-(\d{2})-(\d{2})$/,
			qa = /^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,
			Na = /^(\d{4})-W(\d\d)$/,
			Ra = /^(\d{4})-(\d\d)$/,
			Ba = /^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,
			Ua = {
				text: Sn,
				date: Ln("date", Fa, En(Fa, ["yyyy", "MM", "dd"]), "yyyy-MM-dd"),
				"datetime-local": Ln("datetimelocal", qa, En(qa, ["yyyy", "MM", "dd", "HH", "mm", "ss", "sss"]), "yyyy-MM-ddTHH:mm:ss.sss"),
				time: Ln("time", Ba, En(Ba, ["HH", "mm", "ss", "sss"]), "HH:mm:ss.sss"),
				week: Ln("week", Na, In, "yyyy-Www"),
				month: Ln("month", Ra, En(Ra, ["yyyy", "MM"]), "yyyy-MM"),
				number: An,
				url: On,
				email: jn,
				radio: Fn,
				checkbox: Nn,
				hidden: h,
				button: h,
				submit: h,
				reset: h,
				file: h
			},
			Ha = ["$browser", "$sniffer", "$filter", "$parse",
				function(e, t, n, i) {
					return {
						restrict: "E",
						require: ["?ngModel"],
						link: {
							pre: function(a, o, r, s) {
								s[0] && (Ua[Vn(r.type)] || Ua.text)(a, o, r, s[0], t, e, n, i)
							}
						}
					}
				}
			],
			za = /^(true|false|\d+)$/,
			Va = function() {
				return {
					restrict: "A",
					priority: 100,
					compile: function(e, t) {
						return za.test(t.ngValue) ? function(e, t, n) {
							n.$set("value", e.$eval(n.ngValue))
						} : function(e, t, n) {
							e.$watch(n.ngValue, function(e) {
								n.$set("value", e)
							})
						}
					}
				}
			},
			Wa = ["$compile",
				function(e) {
					return {
						restrict: "AC",
						compile: function(t) {
							return e.$$addBindingClass(t),
								function(t, i, a) {
									e.$$addBindingInfo(i, a.ngBind), i = i[0], t.$watch(a.ngBind, function(e) {
										i.textContent = e === n ? "" : e
									})
								}
						}
					}
				}
			],
			Ya = ["$interpolate", "$compile",
				function(e, t) {
					return {
						compile: function(i) {
							return t.$$addBindingClass(i),
								function(i, a, o) {
									var r = e(a.attr(o.$attr.ngBindTemplate));
									t.$$addBindingInfo(a, r.expressions), a = a[0], o.$observe("ngBindTemplate", function(e) {
										a.textContent = e === n ? "" : e
									})
								}
						}
					}
				}
			],
			Ga = ["$sce", "$parse", "$compile",
				function(e, t, n) {
					return {
						restrict: "A",
						compile: function(i, a) {
							var o = t(a.ngBindHtml),
								r = t(a.ngBindHtml, function(e) {
									return (e || "").toString()
								});
							return n.$$addBindingClass(i),
								function(t, i, a) {
									n.$$addBindingInfo(i, a.ngBindHtml), t.$watch(r, function() {
										i.html(e.getTrustedHtml(o(t)) || "")
									})
								}
						}
					}
				}
			],
			Ka = m({
				restrict: "A",
				require: "ngModel",
				link: function(e, t, n, i) {
					i.$viewChangeListeners.push(function() {
						e.$eval(n.ngChange)
					})
				}
			}),
			Qa = Rn("", !0),
			Xa = Rn("Odd", 0),
			Za = Rn("Even", 1),
			Ja = kn({
				compile: function(e, t) {
					t.$set("ngCloak", n), e.removeClass("ng-cloak")
				}
			}),
			eo = [
				function() {
					return {
						restrict: "A",
						scope: !0,
						controller: "@",
						priority: 500
					}
				}
			],
			to = {},
			no = {
				blur: !0,
				focus: !0
			};
		o("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "), function(e) {
			var t = Qe("ng-" + e);
			to[t] = ["$parse", "$rootScope",
				function(n, i) {
					return {
						restrict: "A",
						compile: function(a, o) {
							var r = n(o[t], null, !0);
							return function(t, n) {
								n.on(e, function(n) {
									var a = function() {
										r(t, {
											$event: n
										})
									};
									no[e] && i.$$phase ? t.$evalAsync(a) : t.$apply(a)
								})
							}
						}
					}
				}
			]
		});
		var io = ["$animate",
				function(e) {
					return {
						multiElement: !0,
						transclude: "element",
						priority: 600,
						terminal: !0,
						restrict: "A",
						$$tlb: !0,
						link: function(n, i, a, o, r) {
							var s, l, c;
							n.$watch(a.ngIf, function(n) {
								n ? l || r(function(n, o) {
									l = o, n[n.length++] = t.createComment(" end ngIf: " + a.ngIf + " "), s = {
										clone: n
									}, e.enter(n, i.parent(), i)
								}) : (c && (c.remove(), c = null), l && (l.$destroy(), l = null), s && (c = se(s.clone), e.leave(c).then(function() {
									c = null
								}), s = null))
							})
						}
					}
				}
			],
			ao = ["$templateRequest", "$anchorScroll", "$animate", "$sce",
				function(e, t, n, i) {
					return {
						restrict: "ECA",
						priority: 400,
						terminal: !0,
						transclude: "element",
						controller: oi.noop,
						compile: function(a, o) {
							var r = o.ngInclude || o.src,
								s = o.onload || "",
								l = o.autoscroll;
							return function(a, o, c, d, u) {
								var p, f, h, g = 0,
									m = function() {
										f && (f.remove(), f = null), p && (p.$destroy(), p = null), h && (n.leave(h).then(function() {
											f = null
										}), f = h, h = null)
									};
								a.$watch(i.parseAsResourceUrl(r), function(i) {
									var r = function() {
											!y(l) || l && !a.$eval(l) || t()
										},
										c = ++g;
									i ? (e(i, !0).then(function(e) {
										if (c === g) {
											var t = a.$new();
											d.template = e;
											var l = u(t, function(e) {
												m(), n.enter(e, null, o).then(r)
											});
											p = t, h = l, p.$emit("$includeContentLoaded", i), a.$eval(s)
										}
									}, function() {
										c === g && (m(), a.$emit("$includeContentError", i))
									}), a.$emit("$includeContentRequested", i)) : (m(), d.template = null)
								})
							}
						}
					}
				}
			],
			oo = ["$compile",
				function(e) {
					return {
						restrict: "ECA",
						priority: -400,
						require: "ngInclude",
						link: function(n, i, a, o) {
							if (/SVG/.test(i[0].toString())) return i.empty(), void e(me(o.template, t).childNodes)(n, function(e) {
								i.append(e)
							}, {
								futureParentElement: i
							});
							i.html(o.template), e(i.contents())(n)
						}
					}
				}
			],
			ro = kn({
				priority: 450,
				compile: function() {
					return {
						pre: function(e, t, n) {
							e.$eval(n.ngInit)
						}
					}
				}
			}),
			so = function() {
				return {
					restrict: "A",
					priority: 100,
					require: "ngModel",
					link: function(e, t, i, a) {
						var r = t.attr(i.$attr.ngList) || ", ",
							s = "false" !== i.ngTrim,
							l = s ? ci(r) : r,
							c = function(e) {
								if (!v(e)) {
									var t = [];
									return e && o(e.split(l), function(e) {
										e && t.push(s ? ci(e) : e)
									}), t
								}
							};
						a.$parsers.push(c), a.$formatters.push(function(e) {
							return li(e) ? e.join(r) : n
						}), a.$isEmpty = function(e) {
							return !e || !e.length
						}
					}
				}
			},
			lo = "ng-valid",
			co = "ng-invalid",
			uo = "ng-pristine",
			po = "ng-dirty",
			fo = "ng-pending",
			ho = new i("ngModel"),
			go = ["$scope", "$exceptionHandler", "$attrs", "$element", "$parse", "$animate", "$timeout", "$rootScope", "$q", "$interpolate",
				function(e, t, i, a, r, s, l, c, d, u) {
					this.$viewValue = Number.NaN, this.$modelValue = Number.NaN, this.$$rawModelValue = n, this.$validators = {}, this.$asyncValidators = {}, this.$parsers = [], this.$formatters = [], this.$viewChangeListeners = [], this.$untouched = !0, this.$touched = !1, this.$pristine = !0, this.$dirty = !1, this.$valid = !0, this.$invalid = !1, this.$error = {}, this.$$success = {}, this.$pending = n, this.$name = u(i.name || "", !1)(e);
					var p, f = r(i.ngModel),
						g = f.assign,
						m = f,
						b = g,
						_ = null,
						x = this;
					this.$$setOptions = function(e) {
						if (x.$options = e, e && e.getterSetter) {
							var t = r(i.ngModel + "()"),
								n = r(i.ngModel + "($$$p)");
							m = function(e) {
								var n = f(e);
								return $(n) && (n = t(e)), n
							}, b = function(e, t) {
								$(f(e)) ? n(e, {
									$$$p: x.$modelValue
								}) : g(e, x.$modelValue)
							}
						} else if (!f.assign) throw ho("nonassign", "Expression '{0}' is non-assignable. Element: {1}", i.ngModel, V(a))
					}, this.$render = h, this.$isEmpty = function(e) {
						return v(e) || "" === e || null === e || e !== e
					};
					var k = a.inheritedData("$formController") || Sa,
						T = 0;
					Bn({
						ctrl: this,
						$element: a,
						set: function(e, t) {
							e[t] = !0
						},
						unset: function(e, t) {
							delete e[t]
						},
						parentForm: k,
						$animate: s
					}), this.$setPristine = function() {
						x.$dirty = !1, x.$pristine = !0, s.removeClass(a, po), s.addClass(a, uo)
					}, this.$setDirty = function() {
						x.$dirty = !0, x.$pristine = !1, s.removeClass(a, uo), s.addClass(a, po), k.$setDirty()
					}, this.$setUntouched = function() {
						x.$touched = !1, x.$untouched = !0, s.setClass(a, "ng-untouched", "ng-touched")
					}, this.$setTouched = function() {
						x.$touched = !0, x.$untouched = !1, s.setClass(a, "ng-touched", "ng-untouched")
					}, this.$rollbackViewValue = function() {
						l.cancel(_), x.$viewValue = x.$$lastCommittedViewValue, x.$render()
					}, this.$validate = function() {
						if (!w(x.$modelValue) || !isNaN(x.$modelValue)) {
							var e = x.$$lastCommittedViewValue,
								t = x.$$rawModelValue,
								i = x.$valid,
								a = x.$modelValue,
								o = x.$options && x.$options.allowInvalid;
							x.$$runValidators(t, e, function(e) {
								o || i === e || (x.$modelValue = e ? t : n, x.$modelValue !== a && x.$$writeModelToScope())
							})
						}
					}, this.$$runValidators = function(e, t, i) {
						function a(e, t) {
							s === T && x.$setValidity(e, t)
						}

						function r(e) {
							s === T && i(e)
						}
						T++;
						var s = T;
						return function() {
							var e = x.$$parserName || "parse";
							return p !== n ? (p || (o(x.$validators, function(e, t) {
								a(t, null)
							}), o(x.$asyncValidators, function(e, t) {
								a(t, null)
							})), a(e, p), p) : (a(e, null), !0)
						}() && function() {
							var n = !0;
							return o(x.$validators, function(i, o) {
								var r = i(e, t);
								n = n && r, a(o, r)
							}), !!n || (o(x.$asyncValidators, function(e, t) {
								a(t, null)
							}), !1)
						}() ? void
						function() {
							var i = [],
								s = !0;
							o(x.$asyncValidators, function(o, r) {
								var l = o(e, t);
								if (!E(l)) throw ho("$asyncValidators", "Expected asynchronous validator to return a promise but got '{0}' instead.", l);
								a(r, n), i.push(l.then(function() {
									a(r, !0)
								}, function(e) {
									s = !1, a(r, !1)
								}))
							}), i.length ? d.all(i).then(function() {
								r(s)
							}, h) : r(!0)
						}(): void r(!1)
					}, this.$commitViewValue = function() {
						var e = x.$viewValue;
						l.cancel(_), (x.$$lastCommittedViewValue !== e || "" === e && x.$$hasNativeValidators) && (x.$$lastCommittedViewValue = e, x.$pristine && this.$setDirty(), this.$$parseAndValidate())
					}, this.$$parseAndValidate = function() {
						function t() {
							x.$modelValue !== r && x.$$writeModelToScope()
						}
						var i = x.$$lastCommittedViewValue,
							a = i;
						if (p = !v(a) || n)
							for (var o = 0; o < x.$parsers.length; o++)
								if (a = x.$parsers[o](a), v(a)) {
									p = !1;
									break
								}
						w(x.$modelValue) && isNaN(x.$modelValue) && (x.$modelValue = m(e));
						var r = x.$modelValue,
							s = x.$options && x.$options.allowInvalid;
						x.$$rawModelValue = a, s && (x.$modelValue = a, t()), x.$$runValidators(a, x.$$lastCommittedViewValue, function(e) {
							s || (x.$modelValue = e ? a : n, t())
						})
					}, this.$$writeModelToScope = function() {
						b(e, x.$modelValue), o(x.$viewChangeListeners, function(e) {
							try {
								e()
							} catch (e) {
								t(e)
							}
						})
					}, this.$setViewValue = function(e, t) {
						x.$viewValue = e, x.$options && !x.$options.updateOnDefault || x.$$debounceViewValueCommit(t)
					}, this.$$debounceViewValueCommit = function(t) {
						var n, i = 0,
							a = x.$options;
						a && y(a.debounce) && (n = a.debounce, w(n) ? i = n : w(n[t]) ? i = n[t] : w(n.default) && (i = n.default)), l.cancel(_), i ? _ = l(function() {
							x.$commitViewValue()
						}, i) : c.$$phase ? x.$commitViewValue() : e.$apply(function() {
							x.$commitViewValue()
						})
					}, e.$watch(function() {
						var t = m(e);
						if (t !== x.$modelValue) {
							x.$modelValue = x.$$rawModelValue = t, p = n;
							for (var i = x.$formatters, a = i.length, o = t; a--;) o = i[a](o);
							x.$viewValue !== o && (x.$viewValue = x.$$lastCommittedViewValue = o, x.$render(), x.$$runValidators(t, o, h))
						}
						return t
					})
				}
			],
			mo = ["$rootScope",
				function(e) {
					return {
						restrict: "A",
						require: ["ngModel", "^?form", "^?ngModelOptions"],
						controller: go,
						priority: 1,
						compile: function(t) {
							return t.addClass(uo).addClass("ng-untouched").addClass(lo), {
								pre: function(e, t, n, i) {
									var a = i[0],
										o = i[1] || Sa;
									a.$$setOptions(i[2] && i[2].$options), o.$addControl(a), n.$observe("name", function(e) {
										a.$name !== e && o.$$renameControl(a, e)
									}), e.$on("$destroy", function() {
										o.$removeControl(a)
									})
								},
								post: function(t, n, i, a) {
									var o = a[0];
									o.$options && o.$options.updateOn && n.on(o.$options.updateOn, function(e) {
										o.$$debounceViewValueCommit(e && e.type)
									}), n.on("blur", function(n) {
										o.$touched || (e.$$phase ? t.$evalAsync(o.$setTouched) : t.$apply(o.$setTouched))
									})
								}
							}
						}
					}
				}
			],
			vo = /(\s+|^)default(\s+|$)/,
			yo = function() {
				return {
					restrict: "A",
					controller: ["$scope", "$attrs",
						function(e, t) {
							var i = this;
							this.$options = e.$eval(t.ngModelOptions), this.$options.updateOn !== n ? (this.$options.updateOnDefault = !1, this.$options.updateOn = ci(this.$options.updateOn.replace(vo, function() {
								return i.$options.updateOnDefault = !0, " "
							}))) : this.$options.updateOnDefault = !0
						}
					]
				}
			},
			bo = kn({
				terminal: !0,
				priority: 1e3
			}),
			_o = ["$locale", "$interpolate",
				function(e, t) {
					var n = /{}/g,
						i = /^when(Minus)?(.+)$/;
					return {
						restrict: "EA",
						link: function(a, r, s) {
							function l(e) {
								r.text(e || "")
							}
							var c, d = s.count,
								u = s.$attr.when && r.attr(s.$attr.when),
								p = s.offset || 0,
								f = a.$eval(u) || {},
								h = {},
								g = t.startSymbol(),
								m = t.endSymbol(),
								v = g + d + "-" + p + m,
								y = oi.noop;
							o(s, function(e, t) {
								var n = i.exec(t);
								if (n) {
									var a = (n[1] ? "-" : "") + Vn(n[2]);
									f[a] = r.attr(s.$attr[t])
								}
							}), o(f, function(e, i) {
								h[i] = t(e.replace(n, v))
							}), a.$watch(d, function(t) {
								var n = parseFloat(t),
									i = isNaN(n);
								i || n in f || (n = e.pluralCat(n - p)), n === c || i && isNaN(c) || (y(), y = a.$watch(h[n], l), c = n)
							})
						}
					}
				}
			],
			wo = ["$parse", "$animate",
				function(e, r) {
					var s = i("ngRepeat"),
						l = function(e, t, n, i, a, o, r) {
							e[n] = i, a && (e[a] = o), e.$index = t, e.$first = 0 === t, e.$last = t === r - 1, e.$middle = !(e.$first || e.$last), e.$odd = !(e.$even = 0 == (1 & t))
						},
						c = function(e) {
							return e.clone[0]
						},
						d = function(e) {
							return e.clone[e.clone.length - 1]
						};
					return {
						restrict: "A",
						multiElement: !0,
						transclude: "element",
						priority: 1e3,
						terminal: !0,
						$$tlb: !0,
						compile: function(i, u) {
							var p = u.ngRepeat,
								f = t.createComment(" end ngRepeat: " + p + " "),
								h = p.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);
							if (!h) throw s("iexp", "Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.", p);
							var g = h[1],
								m = h[2],
								v = h[3],
								y = h[4];
							if (!(h = g.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/))) throw s("iidexp", "'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.", g);
							var b = h[3] || h[1],
								_ = h[2];
							if (v && (!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(v) || /^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(v))) throw s("badident", "alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.", v);
							var w, x, $, k, T = {
								$id: qe
							};
							return y ? w = e(y) : ($ = function(e, t) {
									return qe(t)
								}, k = function(e) {
									return e
								}),
								function(e, t, i, u, h) {
									w && (x = function(t, n, i) {
										return _ && (T[_] = t), T[b] = n, T.$index = i, w(e, T)
									});
									var g = le();
									e.$watchCollection(m, function(i) {
										var u, m, y, w, T, C, D, S, P, I, E, L, M = t[0],
											A = le();
										if (v && (e[v] = i), a(i)) P = i, S = x || $;
										else {
											S = x || k, P = [];
											for (var O in i) i.hasOwnProperty(O) && "$" != O.charAt(0) && P.push(O);
											P.sort()
										}
										for (w = P.length, E = new Array(w), u = 0; u < w; u++)
											if (T = i === P ? u : P[u], C = i[T], D = S(T, C, u), g[D]) I = g[D], delete g[D], A[D] = I, E[u] = I;
											else {
												if (A[D]) throw o(E, function(e) {
													e && e.scope && (g[e.id] = e)
												}), s("dupes", "Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}", p, D, C);
												E[u] = {
													id: D,
													scope: n,
													clone: n
												}, A[D] = !0
											}
										for (var j in g) {
											if (I = g[j], L = se(I.clone), r.leave(L), L[0].parentNode)
												for (u = 0, m = L.length; u < m; u++) L[u].$$NG_REMOVED = !0;
											I.scope.$destroy()
										}
										for (u = 0; u < w; u++)
											if (T = i === P ? u : P[u], C = i[T], I = E[u], I.scope) {
												y = M;
												do {
													y = y.nextSibling
												} while (y && y.$$NG_REMOVED);
												c(I) != y && r.move(se(I.clone), null, Xn(M)), M = d(I), l(I.scope, u, b, C, _, T, w)
											} else h(function(e, t) {
												I.scope = t;
												var n = f.cloneNode(!1);
												e[e.length++] = n, r.enter(e, null, Xn(M)), M = n, I.clone = e, A[I.id] = I, l(I.scope, u, b, C, _, T, w)
											});
										g = A
									})
								}
						}
					}
				}
			],
			xo = ["$animate",
				function(e) {
					return {
						restrict: "A",
						multiElement: !0,
						link: function(t, n, i) {
							t.$watch(i.ngShow, function(t) {
								e[t ? "removeClass" : "addClass"](n, "ng-hide", {
									tempClasses: "ng-hide-animate"
								})
							})
						}
					}
				}
			],
			$o = ["$animate",
				function(e) {
					return {
						restrict: "A",
						multiElement: !0,
						link: function(t, n, i) {
							t.$watch(i.ngHide, function(t) {
								e[t ? "addClass" : "removeClass"](n, "ng-hide", {
									tempClasses: "ng-hide-animate"
								})
							})
						}
					}
				}
			],
			ko = kn(function(e, t, n) {
				e.$watchCollection(n.ngStyle, function(e, n) {
					n && e !== n && o(n, function(e, n) {
						t.css(n, "")
					}), e && t.css(e)
				})
			}),
			To = ["$animate",
				function(e) {
					return {
						restrict: "EA",
						require: "ngSwitch",
						controller: ["$scope",
							function() {
								this.cases = {}
							}
						],
						link: function(n, i, a, r) {
							var s = a.ngSwitch || a.on,
								l = [],
								c = [],
								d = [],
								u = [],
								p = function(e, t) {
									return function() {
										e.splice(t, 1)
									}
								};
							n.$watch(s, function(n) {
								var i, a;
								for (i = 0, a = d.length; i < a; ++i) e.cancel(d[i]);
								for (d.length = 0, i = 0, a = u.length; i < a; ++i) {
									var s = se(c[i].clone);
									u[i].$destroy();
									(d[i] = e.leave(s)).then(p(d, i))
								}
								c.length = 0, u.length = 0, (l = r.cases["!" + n] || r.cases["?"]) && o(l, function(n) {
									n.transclude(function(i, a) {
										u.push(a);
										var o = n.element;
										i[i.length++] = t.createComment(" end ngSwitchWhen: ");
										var r = {
											clone: i
										};
										c.push(r), e.enter(i, o.parent(), o)
									})
								})
							})
						}
					}
				}
			],
			Co = kn({
				transclude: "element",
				priority: 1200,
				require: "^ngSwitch",
				multiElement: !0,
				link: function(e, t, n, i, a) {
					i.cases["!" + n.ngSwitchWhen] = i.cases["!" + n.ngSwitchWhen] || [], i.cases["!" + n.ngSwitchWhen].push({
						transclude: a,
						element: t
					})
				}
			}),
			Do = kn({
				transclude: "element",
				priority: 1200,
				require: "^ngSwitch",
				multiElement: !0,
				link: function(e, t, n, i, a) {
					i.cases["?"] = i.cases["?"] || [], i.cases["?"].push({
						transclude: a,
						element: t
					})
				}
			}),
			So = kn({
				restrict: "EAC",
				link: function(e, t, n, a, o) {
					if (!o) throw i("ngTransclude")("orphan", "Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}", V(t));
					o(function(e) {
						t.empty(), t.append(e)
					})
				}
			}),
			Po = ["$templateCache",
				function(e) {
					return {
						restrict: "E",
						terminal: !0,
						compile: function(t, n) {
							if ("text/ng-template" == n.type) {
								var i = n.id,
									a = t[0].text;
								e.put(i, a)
							}
						}
					}
				}
			],
			Io = i("ngOptions"),
			Eo = m({
				restrict: "A",
				terminal: !0
			}),
			Lo = ["$compile", "$parse",
				function(e, i) {
					var a = /^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
						s = {
							$setViewValue: h
						};
					return {
						restrict: "E",
						require: ["select", "?ngModel"],
						controller: ["$element", "$scope", "$attrs",
							function(e, t, n) {
								var i, a, o = this,
									r = {},
									l = s;
								o.databound = n.ngModel, o.init = function(e, t, n) {
									l = e, i = t, a = n
								}, o.addOption = function(t, n) {
									oe(t, '"option value"'), r[t] = !0, l.$viewValue == t && (e.val(t), a.parent() && a.remove()), n && n[0].hasAttribute("selected") && (n[0].selected = !0)
								}, o.removeOption = function(e) {
									this.hasOption(e) && (delete r[e], l.$viewValue === e && this.renderUnknownOption(e))
								}, o.renderUnknownOption = function(t) {
									var n = "? " + qe(t) + " ?";
									a.val(n), e.prepend(a), e.val(n), a.prop("selected", !0)
								}, o.hasOption = function(e) {
									return r.hasOwnProperty(e)
								}, t.$on("$destroy", function() {
									o.renderUnknownOption = h
								})
							}
						],
						link: function(s, l, c, d) {
							if (d[1]) {
								for (var u, p = d[0], f = d[1], h = c.multiple, g = c.ngOptions, m = !1, b = !1, _ = Xn(t.createElement("option")), w = Xn(t.createElement("optgroup")), x = _.clone(), $ = 0, k = l.children(), T = k.length; $ < T; $++)
									if ("" === k[$].value) {
										u = m = k.eq($);
										break
									}
								p.init(f, m, x), h && (f.$isEmpty = function(e) {
									return !e || 0 === e.length
								}), g ? function(t, s, l) {
									function c(e, n, i) {
										return q[D] = i, I && (q[I] = n), e(t, q)
									}

									function d() {
										t.$apply(function() {
											var e, n = M(t) || [];
											if (h) e = [], o(s.val(), function(t) {
												t = O ? j[t] : t, e.push(u(t, n[t]))
											});
											else {
												var i = O ? j[s.val()] : s.val();
												e = u(i, n[i])
											}
											l.$setViewValue(e), k()
										})
									}

									function u(e, t) {
										return "?" === e ? n : "" === e ? null : c(P || L, e, t)
									}

									function f() {
										var e, n = M(t);
										if (n && li(n)) {
											e = new Array(n.length);
											for (var i = 0, a = n.length; i < a; i++) e[i] = c(C, i, n[i]);
											return e
										}
										if (n) {
											e = {};
											for (var o in n) n.hasOwnProperty(o) && (e[o] = c(C, o, n[o]))
										}
										return e
									}

									function v(e) {
										var t;
										if (h)
											if (O && li(e)) {
												t = new Ne([]);
												for (var n = 0; n < e.length; n++) t.put(c(O, null, e[n]), !0)
											} else t = new Ne(e);
										else O && (e = c(O, null, e));
										return function(n, i) {
											var a;
											return a = O || P || L, h ? y(t.remove(c(a, n, i))) : e === c(a, n, i)
										}
									}

									function x() {
										b || (t.$$postDigest(k), b = !0)
									}

									function $(e, t, n) {
										e[t] = e[t] || 0, e[t] += n ? 1 : -1
									}

									function k() {
										b = !1;
										var e, n, i, a, d, u, f, g, x, k, T, D, S, P, L, A, N, R = {
												"": []
											},
											B = [""],
											U = l.$viewValue,
											H = M(t) || [],
											z = I ? r(H) : H,
											V = {},
											W = v(U),
											Y = !1;
										for (j = {}, D = 0; k = z.length, D < k; D++) f = D, I && (f = z[D], "$" === f.charAt(0)) || (g = H[f], e = c(E, f, g) || "", (n = R[e]) || (n = R[e] = [], B.push(e)), S = W(f, g), Y = Y || S, A = c(C, f, g), A = y(A) ? A : "", N = O ? O(t, q) : I ? z[D] : D, O && (j[N] = f), n.push({
											id: N,
											label: A,
											selected: S
										}));
										for (h || (m || null === U ? R[""].unshift({
											id: "",
											label: "",
											selected: !Y
										}) : Y || R[""].unshift({
											id: "?",
											label: "",
											selected: !0
										})), T = 0, x = B.length; T < x; T++) {
											for (e = B[T], n = R[e], F.length <= T ? (a = {
												element: w.clone().attr("label", e),
												label: n.label
											}, d = [a], F.push(d), s.append(a.element)) : (d = F[T], a = d[0], a.label != e && a.element.attr("label", a.label = e)), P = null, D = 0, k = n.length; D < k; D++) i = n[D], (u = d[D + 1]) ? (P = u.element, u.label !== i.label && ($(V, u.label, !1), $(V, i.label, !0), P.text(u.label = i.label), P.prop("label", u.label)), u.id !== i.id && P.val(u.id = i.id), P[0].selected !== i.selected && (P.prop("selected", u.selected = i.selected), Qn && P.prop("selected", u.selected))) : ("" === i.id && m ? L = m : (L = _.clone()).val(i.id).prop("selected", i.selected).attr("selected", i.selected).prop("label", i.label).text(i.label), d.push(u = {
												element: L,
												label: i.label,
												id: i.id,
												selected: i.selected
											}), $(V, i.label, !0), P ? P.after(L) : a.element.append(L), P = L);
											for (D++; d.length > D;) i = d.pop(), $(V, i.label, !1), i.element.remove()
										}
										for (; F.length > T;) {
											for (n = F.pop(), D = 1; D < n.length; ++D) $(V, n[D].label, !1);
											n[0].element.remove()
										}
										o(V, function(e, t) {
											e > 0 ? p.addOption(t) : e < 0 && p.removeOption(t)
										})
									}
									var T;
									if (!(T = g.match(a))) throw Io("iexp", "Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}", g, V(s));
									var C = i(T[2] || T[1]),
										D = T[4] || T[6],
										S = / as /.test(T[0]) && T[1],
										P = S ? i(S) : null,
										I = T[5],
										E = i(T[3] || ""),
										L = i(T[2] ? T[1] : D),
										M = i(T[7]),
										A = T[8],
										O = A ? i(T[8]) : null,
										j = {},
										F = [
											[{
												element: s,
												label: ""
											}]
										],
										q = {};
									m && (e(m)(t), m.removeClass("ng-scope"), m.remove()), s.empty(), s.on("change", d), l.$render = k, t.$watchCollection(M, x), t.$watchCollection(f, x), h && t.$watchCollection(function() {
										return l.$modelValue
									}, x)
								}(s, l, f) : h ? function(e, t, n) {
									var i;
									n.$render = function() {
										var e = new Ne(n.$viewValue);
										o(t.find("option"), function(t) {
											t.selected = y(e.get(t.value))
										})
									}, e.$watch(function() {
										q(i, n.$viewValue) || (i = F(n.$viewValue), n.$render())
									}), t.on("change", function() {
										e.$apply(function() {
											var e = [];
											o(t.find("option"), function(t) {
												t.selected && e.push(t.value)
											}), n.$setViewValue(e)
										})
									})
								}(s, l, f) : function(e, t, n, i) {
									n.$render = function() {
										var e = n.$viewValue;
										i.hasOption(e) ? (x.parent() && x.remove(), t.val(e), "" === e && u.prop("selected", !0)) : v(e) && u ? t.val("") : i.renderUnknownOption(e)
									}, t.on("change", function() {
										e.$apply(function() {
											x.parent() && x.remove(), n.$setViewValue(t.val())
										})
									})
								}(s, l, f, p)
							}
						}
					}
				}
			],
			Mo = ["$interpolate",
				function(e) {
					var t = {
						addOption: h,
						removeOption: h
					};
					return {
						restrict: "E",
						priority: 100,
						compile: function(n, i) {
							if (v(i.value)) {
								var a = e(n.text(), !0);
								a || i.$set("value", n.text())
							}
							return function(e, n, i) {
								var o = n.parent(),
									r = o.data("$selectController") || o.parent().data("$selectController");
								r && r.databound || (r = t), a ? e.$watch(a, function(e, t) {
									i.$set("value", e), t !== e && r.removeOption(t), r.addOption(e, n)
								}) : r.addOption(i.value, n), n.on("$destroy", function() {
									r.removeOption(i.value)
								})
							}
						}
					}
				}
			],
			Ao = m({
				restrict: "E",
				terminal: !1
			}),
			Oo = function() {
				return {
					restrict: "A",
					require: "?ngModel",
					link: function(e, t, n, i) {
						i && (n.required = !0, i.$validators.required = function(e, t) {
							return !n.required || !i.$isEmpty(t)
						}, n.$observe("required", function() {
							i.$validate()
						}))
					}
				}
			},
			jo = function() {
				return {
					restrict: "A",
					require: "?ngModel",
					link: function(e, t, a, o) {
						if (o) {
							var r, s = a.ngPattern || a.pattern;
							a.$observe("pattern", function(e) {
								if (_(e) && e.length > 0 && (e = new RegExp("^" + e + "$")), e && !e.test) throw i("ngPattern")("noregexp", "Expected {0} to be a RegExp but was {1}. Element: {2}", s, e, V(t));
								r = e || n, o.$validate()
							}), o.$validators.pattern = function(e) {
								return o.$isEmpty(e) || v(r) || r.test(e)
							}
						}
					}
				}
			},
			Fo = function() {
				return {
					restrict: "A",
					require: "?ngModel",
					link: function(e, t, n, i) {
						if (i) {
							var a = -1;
							n.$observe("maxlength", function(e) {
								var t = p(e);
								a = isNaN(t) ? -1 : t, i.$validate()
							}), i.$validators.maxlength = function(e, t) {
								return a < 0 || i.$isEmpty(t) || t.length <= a
							}
						}
					}
				}
			},
			qo = function() {
				return {
					restrict: "A",
					require: "?ngModel",
					link: function(e, t, n, i) {
						if (i) {
							var a = 0;
							n.$observe("minlength", function(e) {
								a = p(e) || 0, i.$validate()
							}), i.$validators.minlength = function(e, t) {
								return i.$isEmpty(t) || t.length >= a
							}
						}
					}
				}
			};
		if (e.angular.bootstrap) return void console.log("WARNING: Tried to load angular more than once.");
		! function() {
			var t;
			hi || (Zn = e.jQuery, Zn && Zn.fn.on ? (Xn = Zn, u(Zn.fn, {
				scope: Ai.scope,
				isolateScope: Ai.isolateScope,
				controller: Ai.controller,
				injector: Ai.injector,
				inheritedData: Ai.inheritedData
			}), t = Zn.cleanData, Zn.cleanData = function(e) {
				var n;
				if (si) si = !1;
				else
					for (var i, a = 0; null != (i = e[a]); a++)(n = Zn._data(i, "events")) && n.$destroy && Zn(i).triggerHandler("$destroy");
				t(e)
			}) : Xn = ye, oi.element = Xn, hi = !0)
		}(),
		function(t) {
			u(t, {
				bootstrap: J,
				copy: j,
				extend: u,
				equals: q,
				element: Xn,
				forEach: o,
				injector: Ue,
				noop: h,
				bind: B,
				toJson: H,
				fromJson: z,
				identity: g,
				isUndefined: v,
				isDefined: y,
				isString: _,
				isFunction: $,
				isObject: b,
				isNumber: w,
				isElement: L,
				isArray: li,
				version: _i,
				isDate: x,
				lowercase: Vn,
				uppercase: Yn,
				callbacks: {
					counter: 0
				},
				getTestability: te,
				$$minErr: i,
				$$csp: ui,
				reloadWithDebugInfo: ee
			}), Jn = ce(e);
			try {
				Jn("ngLocale")
			} catch (e) {
				Jn("ngLocale", []).provider("$locale", ht)
			}
			Jn("ng", ["ngLocale"], ["$provide",
				function(e) {
					e.provider({
						$$sanitizeUri: Wt
					}), e.provider("$compile", Ke).directive({
						a: Ca,
						input: Ha,
						textarea: Ha,
						form: Ea,
						script: Po,
						select: Lo,
						style: Ao,
						option: Mo,
						ngBind: Wa,
						ngBindHtml: Ga,
						ngBindTemplate: Ya,
						ngClass: Qa,
						ngClassEven: Za,
						ngClassOdd: Xa,
						ngCloak: Ja,
						ngController: eo,
						ngForm: La,
						ngHide: $o,
						ngIf: io,
						ngInclude: ao,
						ngInit: ro,
						ngNonBindable: bo,
						ngPluralize: _o,
						ngRepeat: wo,
						ngShow: xo,
						ngStyle: ko,
						ngSwitch: To,
						ngSwitchWhen: Co,
						ngSwitchDefault: Do,
						ngOptions: Eo,
						ngTransclude: So,
						ngModel: mo,
						ngList: so,
						ngChange: Ka,
						pattern: jo,
						ngPattern: jo,
						required: Oo,
						ngRequired: Oo,
						minlength: qo,
						ngMinlength: qo,
						maxlength: Fo,
						ngMaxlength: Fo,
						ngValue: Va,
						ngModelOptions: yo
					}).directive({
						ngInclude: oo
					}).directive(Da).directive(to), e.provider({
						$anchorScroll: He,
						$animate: zi,
						$browser: We,
						$cacheFactory: Ye,
						$controller: Je,
						$document: et,
						$exceptionHandler: tt,
						$filter: on,
						$interpolate: pt,
						$interval: ft,
						$http: lt,
						$httpBackend: dt,
						$location: St,
						$log: Pt,
						$parse: Rt,
						$rootScope: Vt,
						$q: Bt,
						$$q: Ut,
						$sce: Qt,
						$sceDelegate: Kt,
						$sniffer: Xt,
						$templateCache: Ge,
						$templateRequest: Zt,
						$$testability: Jt,
						$timeout: en,
						$window: an,
						$$rAF: zt,
						$$asyncCallback: ze,
						$$jqLite: Fe
					})
				}
			])
		}(oi), Xn(t).ready(function() {
			Z(t, J)
		})
	}(window, document), !window.angular.$$csp() && window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>'),
	function(e, t, n) {
		"use strict";
		t.module("ui.sortable", []).value("uiSortableConfig", {}).directive("uiSortable", ["uiSortableConfig", "$timeout", "$log",
			function(e, n, i) {
				return {
					require: "?ngModel",
					scope: {
						ngModel: "=",
						uiSortable: "="
					},
					link: function(a, o, r, s) {
						function l(e, t) {
							return t && "function" == typeof t ? function(n, i) {
								e(n, i), t(n, i)
							} : e
						}

						function c(e) {
							var t = e.data("ui-sortable");
							return t && "object" == typeof t && "ui-sortable" === t.widgetFullName ? t : null
						}

						function d(e, t) {
							var n = e.sortable("option", "helper");
							return "clone" === n || "function" == typeof n && t.item.sortable.isCustomHelperUsed()
						}

						function u(e) {
							return /left|right/.test(e.css("float")) || /inline|table-cell/.test(e.css("display"))
						}

						function p(e, t) {
							for (var n = null, i = 0; i < e.length; i++) {
								var a = e[i];
								if (a.element[0] === t[0]) {
									n = a.scope;
									break
								}
							}
							return n
						}

						function f(e, t) {
							t.item.sortable._destroy()
						}
						var h, g = {},
							m = {
								"ui-floating": void 0
							},
							v = {
								receive: null,
								remove: null,
								start: null,
								stop: null,
								update: null
							},
							y = {
								helper: null
							};
						if (t.extend(g, m, e, a.uiSortable), !t.element.fn || !t.element.fn.jquery) return void i.error("ui.sortable: jQuery should be included before AngularJS!");
						s ? (a.$watch("ngModel.length", function() {
							n(function() {
								c(o) && o.sortable("refresh")
							}, 0, !1)
						}), v.start = function(e, n) {
							if ("auto" === g["ui-floating"]) {
								var i = n.item.siblings();
								c(t.element(e.target)).floating = u(i)
							}
							n.item.sortable = {
								model: s.$modelValue[n.item.index()],
								index: n.item.index(),
								source: n.item.parent(),
								sourceModel: s.$modelValue,
								cancel: function() {
									n.item.sortable._isCanceled = !0
								},
								isCanceled: function() {
									return n.item.sortable._isCanceled
								},
								isCustomHelperUsed: function() {
									return !!n.item.sortable._isCustomHelperUsed
								},
								_isCanceled: !1,
								_isCustomHelperUsed: n.item.sortable._isCustomHelperUsed,
								_destroy: function() {
									t.forEach(n.item.sortable, function(e, t) {
										n.item.sortable[t] = void 0
									})
								}
							}
						}, v.activate = function(e, n) {
							h = o.contents();
							var i = o.sortable("option", "placeholder");
							if (i && i.element && "function" == typeof i.element) {
								var r = i.element();
								r = t.element(r);
								var s = o.find('[class="' + r.attr("class") + '"]:not([ng-repeat], [data-ng-repeat])');
								h = h.not(s)
							}
							var l = n.item.sortable._connectedSortables || [];
							l.push({
								element: o,
								scope: a
							}), n.item.sortable._connectedSortables = l
						}, v.update = function(e, t) {
							if (!t.item.sortable.received) {
								t.item.sortable.dropindex = t.item.index();
								var n = t.item.parent();
								t.item.sortable.droptarget = n;
								var i = p(t.item.sortable._connectedSortables, n);
								t.item.sortable.droptargetModel = i.ngModel, o.sortable("cancel")
							}
							d(o, t) && !t.item.sortable.received && "parent" === o.sortable("option", "appendTo") && (h = h.not(h.last())), h.appendTo(o), t.item.sortable.received && (h = null), t.item.sortable.received && !t.item.sortable.isCanceled() && a.$apply(function() {
								s.$modelValue.splice(t.item.sortable.dropindex, 0, t.item.sortable.moved)
							})
						}, v.stop = function(e, t) {
							!t.item.sortable.received && "dropindex" in t.item.sortable && !t.item.sortable.isCanceled() ? a.$apply(function() {
								s.$modelValue.splice(t.item.sortable.dropindex, 0, s.$modelValue.splice(t.item.sortable.index, 1)[0])
							}) : "dropindex" in t.item.sortable && !t.item.sortable.isCanceled() || d(o, t) || h.appendTo(o), h = null
						}, v.receive = function(e, t) {
							t.item.sortable.received = !0
						}, v.remove = function(e, t) {
							"dropindex" in t.item.sortable || (o.sortable("cancel"), t.item.sortable.cancel()), t.item.sortable.isCanceled() || a.$apply(function() {
								t.item.sortable.moved = s.$modelValue.splice(t.item.sortable.index, 1)[0]
							})
						}, y.helper = function(e) {
							return e && "function" == typeof e ? function(t, n) {
								var i = e(t, n);
								return n.sortable._isCustomHelperUsed = n !== i, i
							} : e
						}, a.$watch("uiSortable", function(e) {
							var n = c(o);
							n && t.forEach(e, function(e, t) {
								if (t in m) return "ui-floating" !== t || !1 !== e && !0 !== e || (n.floating = e), void(g[t] = e);
								v[t] ? ("stop" === t && (e = l(e, function() {
									a.$apply()
								}), e = l(e, f)), e = l(v[t], e)) : y[t] && (e = y[t](e)), g[t] = e, o.sortable("option", t, e)
							})
						}, !0), t.forEach(v, function(e, t) {
							g[t] = l(e, g[t]), "stop" === t && (g[t] = l(g[t], f))
						})) : i.info("ui.sortable: ngModel not provided!", o), o.sortable(g)
					}
				}
			}
		])
	}(window, window.angular),
	function(e, t) {
		! function(e, t) {
			"use strict";
			var n, i = e.module("ngDialog", []),
				a = e.element,
				o = e.isDefined,
				r = (document.body || document.documentElement).style,
				s = o(r.animation) || o(r.WebkitAnimation) || o(r.MozAnimation) || o(r.MsAnimation) || o(r.OAnimation),
				l = "animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",
				c = !1;
			i.provider("ngDialog", function() {
				var t = this.defaults = {
					className: "ngdialog-theme-default",
					plain: !1,
					showClose: !0,
					closeByDocument: !0,
					closeByEscape: !0,
					closeByNavigation: !1,
					appendTo: !1,
					preCloseCallback: !1,
					overlay: !0,
					cache: !0
				};
				this.setForceBodyReload = function(e) {
					c = e || !1
				}, this.setDefaults = function(n) {
					e.extend(t, n)
				};
				var i, o = 0,
					r = 0,
					d = {};
				this.$get = ["$document", "$templateCache", "$compile", "$q", "$http", "$rootScope", "$timeout", "$window", "$controller",
					function(u, p, f, h, g, m, v, y, b) {
						var _ = u.find("body");
						c && m.$on("$locationChangeSuccess", function() {
							_ = u.find("body")
						});
						var w = {
								onDocumentKeydown: function(e) {
									27 === e.keyCode && x.close("$escape")
								},
								setBodyPadding: function(e) {
									var t = parseInt(_.css("padding-right") || 0, 10);
									_.css("padding-right", t + e + "px"), _.data("ng-dialog-original-padding", t)
								},
								resetBodyPadding: function() {
									var e = _.data("ng-dialog-original-padding");
									e ? _.css("padding-right", e + "px") : _.css("padding-right", "")
								},
								performCloseDialog: function(e, t) {
									var a = e.attr("id");
									if (void 0 !== y.Hammer) {
										var o = n.hammerTime;
										o.off("tap", i), o.destroy && o.destroy(), delete n.hammerTime
									} else e.unbind("click");
									1 === r && _.unbind("keydown"), e.hasClass("ngdialog-closing") || (r -= 1), m.$broadcast("ngDialog.closing", e), r = r < 0 ? 0 : r, s ? (n.$destroy(), e.unbind(l).bind(l, function() {
										e.remove(), 0 === r && (_.removeClass("ngdialog-open"), w.resetBodyPadding()), m.$broadcast("ngDialog.closed", e)
									}).addClass("ngdialog-closing")) : (n.$destroy(), e.remove(), 0 === r && (_.removeClass("ngdialog-open"), w.resetBodyPadding()), m.$broadcast("ngDialog.closed", e)), d[a] && (d[a].resolve({
										id: a,
										value: t,
										$dialog: e,
										remainingDialogs: r
									}), delete d[a])
								},
								closeDialog: function(t, n) {
									var i = t.data("$ngDialogPreCloseCallback");
									if (i && e.isFunction(i)) {
										var a = i.call(t, n);
										e.isObject(a) ? a.closePromise ? a.closePromise.then(function() {
											w.performCloseDialog(t, n)
										}) : a.then(function() {
											w.performCloseDialog(t, n)
										}, function() {}) : !1 !== a && w.performCloseDialog(t, n)
									} else w.performCloseDialog(t, n)
								}
							},
							x = {
								open: function(s) {
									function l(e, t) {
										return g.get(e, t || {}).then(function(e) {
											return e.data || ""
										})
									}
									var c = this,
										u = e.copy(t);
									s = s || {}, e.extend(u, s), o += 1, c.latestID = "ngdialog" + o;
									var $;
									d[c.latestID] = $ = h.defer(), n = e.isObject(u.scope) ? u.scope.$new() : m.$new();
									var k, T;
									return h.when(function(t) {
										return t ? e.isString(t) && u.plain ? t : "boolean" != typeof u.cache || u.cache ? p.get(t) || l(t, {
											cache: !0
										}) : l(t, {
											cache: !1
										}) : "Empty template"
									}(u.template || u.templateUrl)).then(function(t) {
										if (p.put(u.template || u.templateUrl, t), u.showClose && (t += '<div class="ngdialog-close"></div>'), c.$result = k = a('<div id="ngdialog' + o + '" class="ngdialog"></div>'), k.html(u.overlay ? '<div class="ngdialog-overlay"></div><div class="ngdialog-content">' + t + "</div>" : '<div class="ngdialog-content">' + t + "</div>"), u.data && e.isString(u.data)) {
											var s = u.data.replace(/^\s*/, "")[0];
											n.ngDialogData = "{" === s || "[" === s ? e.fromJson(u.data) : u.data
										} else u.data && e.isObject(u.data) && (n.ngDialogData = u.data); if (u.controller && (e.isString(u.controller) || e.isArray(u.controller) || e.isFunction(u.controller))) {
											var l = b(u.controller, {
												$scope: n,
												$element: k
											});
											k.data("$ngDialogControllerController", l)
										}
										if (u.className && k.addClass(u.className), T = u.appendTo && e.isString(u.appendTo) ? e.element(document.querySelector(u.appendTo)) : _, u.preCloseCallback) {
											var d;
											e.isFunction(u.preCloseCallback) ? d = u.preCloseCallback : e.isString(u.preCloseCallback) && n && (e.isFunction(n[u.preCloseCallback]) ? d = n[u.preCloseCallback] : n.$parent && e.isFunction(n.$parent[u.preCloseCallback]) ? d = n.$parent[u.preCloseCallback] : m && e.isFunction(m[u.preCloseCallback]) && (d = m[u.preCloseCallback])), d && k.data("$ngDialogPreCloseCallback", d)
										}
										if (n.closeThisDialog = function(e) {
											w.closeDialog(k, e)
										}, v(function() {
											f(k)(n);
											var e = y.innerWidth - _.prop("clientWidth");
											_.addClass("ngdialog-open");
											var t = e - (y.innerWidth - _.prop("clientWidth"));
											t > 0 && w.setBodyPadding(t), T.append(k), u.name ? m.$broadcast("ngDialog.opened", {
												dialog: k,
												name: u.name
											}) : m.$broadcast("ngDialog.opened", k)
										}), u.closeByEscape && _.bind("keydown", w.onDocumentKeydown), u.closeByNavigation && m.$on("$locationChangeSuccess", function() {
											w.closeDialog(k)
										}), i = function(e) {
											var t = !!u.closeByDocument && a(e.target).hasClass("ngdialog-overlay"),
												n = a(e.target).hasClass("ngdialog-close");
											(t || n) && x.close(k.attr("id"), n ? "$closeButton" : "$document")
										}, void 0 !== y.Hammer) {
											(n.hammerTime = y.Hammer(k[0])).on("tap", i)
										} else k.bind("click", i);
										return r += 1, x
									}), {
										id: "ngdialog" + o,
										closePromise: $.promise,
										close: function(e) {
											w.closeDialog(k, e)
										}
									}
								},
								openConfirm: function(t) {
									var n = h.defer(),
										i = {
											closeByEscape: !1,
											closeByDocument: !1
										};
									e.extend(i, t), i.scope = e.isObject(i.scope) ? i.scope.$new() : m.$new(), i.scope.confirm = function(e) {
										n.resolve(e);
										var t = a(document.getElementById(o.id));
										w.performCloseDialog(t, e)
									};
									var o = x.open(i);
									return o.closePromise.then(function(e) {
										return e ? n.reject(e.value) : n.reject()
									}), n.promise
								},
								close: function(e, t) {
									var n = a(document.getElementById(e));
									return n.length ? w.closeDialog(n, t) : x.closeAll(t), x
								},
								closeAll: function(t) {
									var n = document.querySelectorAll(".ngdialog");
									e.forEach(n, function(e) {
										w.closeDialog(a(e), t)
									})
								},
								getDefaults: function() {
									return t
								}
							};
						return x
					}
				]
			}), i.directive("ngDialog", ["ngDialog",
				function(t) {
					return {
						restrict: "A",
						scope: {
							ngDialogScope: "="
						},
						link: function(n, i, a) {
							i.on("click", function(i) {
								i.preventDefault();
								var o = e.isDefined(n.ngDialogScope) ? n.ngDialogScope : "noScope";
								e.isDefined(a.ngDialogClosePrevious) && t.close(a.ngDialogClosePrevious);
								var r = t.getDefaults();
								t.open({
									template: a.ngDialog,
									className: a.ngDialogClass || r.className,
									controller: a.ngDialogController,
									scope: o,
									data: a.ngDialogData,
									showClose: "false" !== a.ngDialogShowClose && ("true" === a.ngDialogShowClose || r.showClose),
									closeByDocument: "false" !== a.ngDialogCloseByDocument && ("true" === a.ngDialogCloseByDocument || r.closeByDocument),
									closeByEscape: "false" !== a.ngDialogCloseByEscape && ("true" === a.ngDialogCloseByEscape || r.closeByEscape),
									preCloseCallback: a.ngDialogPreCloseCallback || r.preCloseCallback
								})
							})
						}
					}
				}
			])
		}(e.angular)
	}(this);
var $sanitizeMinErr = angular.$$minErr("$sanitize"),
	START_TAG_REGEXP = /^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,
	END_TAG_REGEXP = /^<\/\s*([\w:-]+)[^>]*>/,
	ATTR_REGEXP = /([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,
	BEGIN_TAG_REGEXP = /^</,
	BEGING_END_TAGE_REGEXP = /^<\//,
	COMMENT_REGEXP = /<!--(.*?)-->/g,
	DOCTYPE_REGEXP = /<!DOCTYPE([^>]*?)>/i,
	CDATA_REGEXP = /<!\[CDATA\[(.*?)]]>/g,
	SURROGATE_PAIR_REGEXP = /[\uD800-\uDBFF][\uDC00-\uDFFF]/g,
	NON_ALPHANUMERIC_REGEXP = /([^\#-~| |!])/g,
	voidElements = makeMap("area,br,col,hr,img,wbr"),
	optionalEndTagBlockElements = makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),
	optionalEndTagInlineElements = makeMap("rp,rt"),
	optionalEndTagElements = angular.extend({}, optionalEndTagInlineElements, optionalEndTagBlockElements),
	blockElements = angular.extend({}, optionalEndTagBlockElements, makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),
	inlineElements = angular.extend({}, optionalEndTagInlineElements, makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),
	svgElements = makeMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan,use"),
	specialElements = makeMap("script,style"),
	validElements = angular.extend({}, voidElements, blockElements, inlineElements, optionalEndTagElements, svgElements),
	uriAttrs = makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),
	htmlAttrs = makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),
	svgAttrs = makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan", !0),
	validAttrs = angular.extend({}, uriAttrs, svgAttrs, htmlAttrs),
	hiddenPre = document.createElement("pre");
angular.module("ngSanitize", []).provider("$sanitize", $SanitizeProvider);
var QRCode;
! function() {
	function e(e) {
		this.mode = l.MODE_8BIT_BYTE, this.data = e, this.parsedData = [];
		for (var t = 0, n = this.data.length; t < n; t++) {
			var i = [],
				a = this.data.charCodeAt(t);
			a > 65536 ? (i[0] = 240 | (1835008 & a) >>> 18, i[1] = 128 | (258048 & a) >>> 12, i[2] = 128 | (4032 & a) >>> 6, i[3] = 128 | 63 & a) : a > 2048 ? (i[0] = 224 | (61440 & a) >>> 12, i[1] = 128 | (4032 & a) >>> 6, i[2] = 128 | 63 & a) : a > 128 ? (i[0] = 192 | (1984 & a) >>> 6, i[1] = 128 | 63 & a) : i[0] = a, this.parsedData.push(i)
		}
		this.parsedData = Array.prototype.concat.apply([], this.parsedData), this.parsedData.length != this.data.length && (this.parsedData.unshift(191), this.parsedData.unshift(187), this.parsedData.unshift(239))
	}

	function t(e, t) {
		this.typeNumber = e, this.errorCorrectLevel = t, this.modules = null, this.moduleCount = 0, this.dataCache = null, this.dataList = []
	}

	function n(e, t) {
		if (void 0 == e.length) throw new Error(e.length + "/" + t);
		for (var n = 0; n < e.length && 0 == e[n];) n++;
		this.num = new Array(e.length - n + t);
		for (var i = 0; i < e.length - n; i++) this.num[i] = e[i + n]
	}

	function i(e, t) {
		this.totalCount = e, this.dataCount = t
	}

	function a() {
		this.buffer = [], this.length = 0
	}

	function o() {
		var e = !1,
			t = navigator.userAgent;
		if (/android/i.test(t)) {
			e = !0;
			var n = t.toString().match(/android ([0-9]\.[0-9])/i);
			n && n[1] && (e = parseFloat(n[1]))
		}
		return e
	}

	function r(e, t) {
		for (var n = 1, i = s(e), a = 0, o = h.length; a <= o; a++) {
			var r = 0;
			switch (t) {
				case c.L:
					r = h[a][0];
					break;
				case c.M:
					r = h[a][1];
					break;
				case c.Q:
					r = h[a][2];
					break;
				case c.H:
					r = h[a][3]
			}
			if (i <= r) break;
			n++
		}
		if (n > h.length) throw new Error("Too long data");
		return n
	}

	function s(e) {
		var t = encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g, "a");
		return t.length + (t.length != e ? 3 : 0)
	}
	e.prototype = {
		getLength: function(e) {
			return this.parsedData.length
		},
		write: function(e) {
			for (var t = 0, n = this.parsedData.length; t < n; t++) e.put(this.parsedData[t], 8)
		}
	}, t.prototype = {
		addData: function(t) {
			var n = new e(t);
			this.dataList.push(n), this.dataCache = null
		},
		isDark: function(e, t) {
			if (e < 0 || this.moduleCount <= e || t < 0 || this.moduleCount <= t) throw new Error(e + "," + t);
			return this.modules[e][t]
		},
		getModuleCount: function() {
			return this.moduleCount
		},
		make: function() {
			this.makeImpl(!1, this.getBestMaskPattern())
		},
		makeImpl: function(e, n) {
			this.moduleCount = 4 * this.typeNumber + 17, this.modules = new Array(this.moduleCount);
			for (var i = 0; i < this.moduleCount; i++) {
				this.modules[i] = new Array(this.moduleCount);
				for (var a = 0; a < this.moduleCount; a++) this.modules[i][a] = null
			}
			this.setupPositionProbePattern(0, 0), this.setupPositionProbePattern(this.moduleCount - 7, 0), this.setupPositionProbePattern(0, this.moduleCount - 7), this.setupPositionAdjustPattern(), this.setupTimingPattern(), this.setupTypeInfo(e, n), this.typeNumber >= 7 && this.setupTypeNumber(e), null == this.dataCache && (this.dataCache = t.createData(this.typeNumber, this.errorCorrectLevel, this.dataList)), this.mapData(this.dataCache, n)
		},
		setupPositionProbePattern: function(e, t) {
			for (var n = -1; n <= 7; n++)
				if (!(e + n <= -1 || this.moduleCount <= e + n))
					for (var i = -1; i <= 7; i++) t + i <= -1 || this.moduleCount <= t + i || (this.modules[e + n][t + i] = 0 <= n && n <= 6 && (0 == i || 6 == i) || 0 <= i && i <= 6 && (0 == n || 6 == n) || 2 <= n && n <= 4 && 2 <= i && i <= 4)
		},
		getBestMaskPattern: function() {
			for (var e = 0, t = 0, n = 0; n < 8; n++) {
				this.makeImpl(!0, n);
				var i = u.getLostPoint(this);
				(0 == n || e > i) && (e = i, t = n)
			}
			return t
		},
		createMovieClip: function(e, t, n) {
			var i = e.createEmptyMovieClip(t, n);
			this.make();
			for (var a = 0; a < this.modules.length; a++)
				for (var o = 1 * a, r = 0; r < this.modules[a].length; r++) {
					var s = 1 * r,
						l = this.modules[a][r];
					l && (i.beginFill(0, 100), i.moveTo(s, o), i.lineTo(s + 1, o), i.lineTo(s + 1, o + 1), i.lineTo(s, o + 1), i.endFill())
				}
			return i
		},
		setupTimingPattern: function() {
			for (var e = 8; e < this.moduleCount - 8; e++) null == this.modules[e][6] && (this.modules[e][6] = e % 2 == 0);
			for (var t = 8; t < this.moduleCount - 8; t++) null == this.modules[6][t] && (this.modules[6][t] = t % 2 == 0)
		},
		setupPositionAdjustPattern: function() {
			for (var e = u.getPatternPosition(this.typeNumber), t = 0; t < e.length; t++)
				for (var n = 0; n < e.length; n++) {
					var i = e[t],
						a = e[n];
					if (null == this.modules[i][a])
						for (var o = -2; o <= 2; o++)
							for (var r = -2; r <= 2; r++) this.modules[i + o][a + r] = -2 == o || 2 == o || -2 == r || 2 == r || 0 == o && 0 == r
				}
		},
		setupTypeNumber: function(e) {
			for (var t = u.getBCHTypeNumber(this.typeNumber), n = 0; n < 18; n++) {
				var i = !e && 1 == (t >> n & 1);
				this.modules[Math.floor(n / 3)][n % 3 + this.moduleCount - 8 - 3] = i
			}
			for (var n = 0; n < 18; n++) {
				var i = !e && 1 == (t >> n & 1);
				this.modules[n % 3 + this.moduleCount - 8 - 3][Math.floor(n / 3)] = i
			}
		},
		setupTypeInfo: function(e, t) {
			for (var n = this.errorCorrectLevel << 3 | t, i = u.getBCHTypeInfo(n), a = 0; a < 15; a++) {
				var o = !e && 1 == (i >> a & 1);
				a < 6 ? this.modules[a][8] = o : a < 8 ? this.modules[a + 1][8] = o : this.modules[this.moduleCount - 15 + a][8] = o
			}
			for (var a = 0; a < 15; a++) {
				var o = !e && 1 == (i >> a & 1);
				a < 8 ? this.modules[8][this.moduleCount - a - 1] = o : a < 9 ? this.modules[8][15 - a - 1 + 1] = o : this.modules[8][15 - a - 1] = o
			}
			this.modules[this.moduleCount - 8][8] = !e
		},
		mapData: function(e, t) {
			for (var n = -1, i = this.moduleCount - 1, a = 7, o = 0, r = this.moduleCount - 1; r > 0; r -= 2)
				for (6 == r && r--;;) {
					for (var s = 0; s < 2; s++)
						if (null == this.modules[i][r - s]) {
							var l = !1;
							o < e.length && (l = 1 == (e[o] >>> a & 1));
							var c = u.getMask(t, i, r - s);
							c && (l = !l), this.modules[i][r - s] = l, a--, -1 == a && (o++, a = 7)
						}
					if ((i += n) < 0 || this.moduleCount <= i) {
						i -= n, n = -n;
						break
					}
				}
		}
	}, t.PAD0 = 236, t.PAD1 = 17, t.createData = function(e, n, o) {
		for (var r = i.getRSBlocks(e, n), s = new a, l = 0; l < o.length; l++) {
			var c = o[l];
			s.put(c.mode, 4), s.put(c.getLength(), u.getLengthInBits(c.mode, e)), c.write(s)
		}
		for (var d = 0, l = 0; l < r.length; l++) d += r[l].dataCount;
		if (s.getLengthInBits() > 8 * d) throw new Error("code length overflow. (" + s.getLengthInBits() + ">" + 8 * d + ")");
		for (s.getLengthInBits() + 4 <= 8 * d && s.put(0, 4); s.getLengthInBits() % 8 != 0;) s.putBit(!1);
		for (;;) {
			if (s.getLengthInBits() >= 8 * d) break;
			if (s.put(t.PAD0, 8), s.getLengthInBits() >= 8 * d) break;
			s.put(t.PAD1, 8)
		}
		return t.createBytes(s, r)
	}, t.createBytes = function(e, t) {
		for (var i = 0, a = 0, o = 0, r = new Array(t.length), s = new Array(t.length), l = 0; l < t.length; l++) {
			var c = t[l].dataCount,
				d = t[l].totalCount - c;
			a = Math.max(a, c), o = Math.max(o, d), r[l] = new Array(c);
			for (var p = 0; p < r[l].length; p++) r[l][p] = 255 & e.buffer[p + i];
			i += c;
			var f = u.getErrorCorrectPolynomial(d),
				h = new n(r[l], f.getLength() - 1),
				g = h.mod(f);
			s[l] = new Array(f.getLength() - 1);
			for (var p = 0; p < s[l].length; p++) {
				var m = p + g.getLength() - s[l].length;
				s[l][p] = m >= 0 ? g.get(m) : 0
			}
		}
		for (var v = 0, p = 0; p < t.length; p++) v += t[p].totalCount;
		for (var y = new Array(v), b = 0, p = 0; p < a; p++)
			for (var l = 0; l < t.length; l++) p < r[l].length && (y[b++] = r[l][p]);
		for (var p = 0; p < o; p++)
			for (var l = 0; l < t.length; l++) p < s[l].length && (y[b++] = s[l][p]);
		return y
	};
	for (var l = {
		MODE_NUMBER: 1,
		MODE_ALPHA_NUM: 2,
		MODE_8BIT_BYTE: 4,
		MODE_KANJI: 8
	}, c = {
		L: 1,
		M: 0,
		Q: 3,
		H: 2
	}, d = {
		PATTERN000: 0,
		PATTERN001: 1,
		PATTERN010: 2,
		PATTERN011: 3,
		PATTERN100: 4,
		PATTERN101: 5,
		PATTERN110: 6,
		PATTERN111: 7
	}, u = {
		PATTERN_POSITION_TABLE: [
			[],
			[6, 18],
			[6, 22],
			[6, 26],
			[6, 30],
			[6, 34],
			[6, 22, 38],
			[6, 24, 42],
			[6, 26, 46],
			[6, 28, 50],
			[6, 30, 54],
			[6, 32, 58],
			[6, 34, 62],
			[6, 26, 46, 66],
			[6, 26, 48, 70],
			[6, 26, 50, 74],
			[6, 30, 54, 78],
			[6, 30, 56, 82],
			[6, 30, 58, 86],
			[6, 34, 62, 90],
			[6, 28, 50, 72, 94],
			[6, 26, 50, 74, 98],
			[6, 30, 54, 78, 102],
			[6, 28, 54, 80, 106],
			[6, 32, 58, 84, 110],
			[6, 30, 58, 86, 114],
			[6, 34, 62, 90, 118],
			[6, 26, 50, 74, 98, 122],
			[6, 30, 54, 78, 102, 126],
			[6, 26, 52, 78, 104, 130],
			[6, 30, 56, 82, 108, 134],
			[6, 34, 60, 86, 112, 138],
			[6, 30, 58, 86, 114, 142],
			[6, 34, 62, 90, 118, 146],
			[6, 30, 54, 78, 102, 126, 150],
			[6, 24, 50, 76, 102, 128, 154],
			[6, 28, 54, 80, 106, 132, 158],
			[6, 32, 58, 84, 110, 136, 162],
			[6, 26, 54, 82, 110, 138, 166],
			[6, 30, 58, 86, 114, 142, 170]
		],
		G15: 1335,
		G18: 7973,
		G15_MASK: 21522,
		getBCHTypeInfo: function(e) {
			for (var t = e << 10; u.getBCHDigit(t) - u.getBCHDigit(u.G15) >= 0;) t ^= u.G15 << u.getBCHDigit(t) - u.getBCHDigit(u.G15);
			return (e << 10 | t) ^ u.G15_MASK
		},
		getBCHTypeNumber: function(e) {
			for (var t = e << 12; u.getBCHDigit(t) - u.getBCHDigit(u.G18) >= 0;) t ^= u.G18 << u.getBCHDigit(t) - u.getBCHDigit(u.G18);
			return e << 12 | t
		},
		getBCHDigit: function(e) {
			for (var t = 0; 0 != e;) t++, e >>>= 1;
			return t
		},
		getPatternPosition: function(e) {
			return u.PATTERN_POSITION_TABLE[e - 1]
		},
		getMask: function(e, t, n) {
			switch (e) {
				case d.PATTERN000:
					return (t + n) % 2 == 0;
				case d.PATTERN001:
					return t % 2 == 0;
				case d.PATTERN010:
					return n % 3 == 0;
				case d.PATTERN011:
					return (t + n) % 3 == 0;
				case d.PATTERN100:
					return (Math.floor(t / 2) + Math.floor(n / 3)) % 2 == 0;
				case d.PATTERN101:
					return t * n % 2 + t * n % 3 == 0;
				case d.PATTERN110:
					return (t * n % 2 + t * n % 3) % 2 == 0;
				case d.PATTERN111:
					return (t * n % 3 + (t + n) % 2) % 2 == 0;
				default:
					throw new Error("bad maskPattern:" + e)
			}
		},
		getErrorCorrectPolynomial: function(e) {
			for (var t = new n([1], 0), i = 0; i < e; i++) t = t.multiply(new n([1, p.gexp(i)], 0));
			return t
		},
		getLengthInBits: function(e, t) {
			if (1 <= t && t < 10) switch (e) {
				case l.MODE_NUMBER:
					return 10;
				case l.MODE_ALPHA_NUM:
					return 9;
				case l.MODE_8BIT_BYTE:
				case l.MODE_KANJI:
					return 8;
				default:
					throw new Error("mode:" + e)
			} else if (t < 27) switch (e) {
				case l.MODE_NUMBER:
					return 12;
				case l.MODE_ALPHA_NUM:
					return 11;
				case l.MODE_8BIT_BYTE:
					return 16;
				case l.MODE_KANJI:
					return 10;
				default:
					throw new Error("mode:" + e)
			} else {
				if (!(t < 41)) throw new Error("type:" + t);
				switch (e) {
					case l.MODE_NUMBER:
						return 14;
					case l.MODE_ALPHA_NUM:
						return 13;
					case l.MODE_8BIT_BYTE:
						return 16;
					case l.MODE_KANJI:
						return 12;
					default:
						throw new Error("mode:" + e)
				}
			}
		},
		getLostPoint: function(e) {
			for (var t = e.getModuleCount(), n = 0, i = 0; i < t; i++)
				for (var a = 0; a < t; a++) {
					for (var o = 0, r = e.isDark(i, a), s = -1; s <= 1; s++)
						if (!(i + s < 0 || t <= i + s))
							for (var l = -1; l <= 1; l++) a + l < 0 || t <= a + l || 0 == s && 0 == l || r == e.isDark(i + s, a + l) && o++;
					o > 5 && (n += 3 + o - 5)
				}
			for (var i = 0; i < t - 1; i++)
				for (var a = 0; a < t - 1; a++) {
					var c = 0;
					e.isDark(i, a) && c++, e.isDark(i + 1, a) && c++, e.isDark(i, a + 1) && c++, e.isDark(i + 1, a + 1) && c++, 0 != c && 4 != c || (n += 3)
				}
			for (var i = 0; i < t; i++)
				for (var a = 0; a < t - 6; a++) e.isDark(i, a) && !e.isDark(i, a + 1) && e.isDark(i, a + 2) && e.isDark(i, a + 3) && e.isDark(i, a + 4) && !e.isDark(i, a + 5) && e.isDark(i, a + 6) && (n += 40);
			for (var a = 0; a < t; a++)
				for (var i = 0; i < t - 6; i++) e.isDark(i, a) && !e.isDark(i + 1, a) && e.isDark(i + 2, a) && e.isDark(i + 3, a) && e.isDark(i + 4, a) && !e.isDark(i + 5, a) && e.isDark(i + 6, a) && (n += 40);
			for (var d = 0, a = 0; a < t; a++)
				for (var i = 0; i < t; i++) e.isDark(i, a) && d++;
			return n += Math.abs(100 * d / t / t - 50) / 5 * 10
		}
	}, p = {
		glog: function(e) {
			if (e < 1) throw new Error("glog(" + e + ")");
			return p.LOG_TABLE[e]
		},
		gexp: function(e) {
			for (; e < 0;) e += 255;
			for (; e >= 256;) e -= 255;
			return p.EXP_TABLE[e]
		},
		EXP_TABLE: new Array(256),
		LOG_TABLE: new Array(256)
	}, f = 0; f < 8; f++) p.EXP_TABLE[f] = 1 << f;
	for (var f = 8; f < 256; f++) p.EXP_TABLE[f] = p.EXP_TABLE[f - 4] ^ p.EXP_TABLE[f - 5] ^ p.EXP_TABLE[f - 6] ^ p.EXP_TABLE[f - 8];
	for (var f = 0; f < 255; f++) p.LOG_TABLE[p.EXP_TABLE[f]] = f;
	n.prototype = {
		get: function(e) {
			return this.num[e]
		},
		getLength: function() {
			return this.num.length
		},
		multiply: function(e) {
			for (var t = new Array(this.getLength() + e.getLength() - 1), i = 0; i < this.getLength(); i++)
				for (var a = 0; a < e.getLength(); a++) t[i + a] ^= p.gexp(p.glog(this.get(i)) + p.glog(e.get(a)));
			return new n(t, 0)
		},
		mod: function(e) {
			if (this.getLength() - e.getLength() < 0) return this;
			for (var t = p.glog(this.get(0)) - p.glog(e.get(0)), i = new Array(this.getLength()), a = 0; a < this.getLength(); a++) i[a] = this.get(a);
			for (var a = 0; a < e.getLength(); a++) i[a] ^= p.gexp(p.glog(e.get(a)) + t);
			return new n(i, 0).mod(e)
		}
	}, i.RS_BLOCK_TABLE = [
		[1, 26, 19],
		[1, 26, 16],
		[1, 26, 13],
		[1, 26, 9],
		[1, 44, 34],
		[1, 44, 28],
		[1, 44, 22],
		[1, 44, 16],
		[1, 70, 55],
		[1, 70, 44],
		[2, 35, 17],
		[2, 35, 13],
		[1, 100, 80],
		[2, 50, 32],
		[2, 50, 24],
		[4, 25, 9],
		[1, 134, 108],
		[2, 67, 43],
		[2, 33, 15, 2, 34, 16],
		[2, 33, 11, 2, 34, 12],
		[2, 86, 68],
		[4, 43, 27],
		[4, 43, 19],
		[4, 43, 15],
		[2, 98, 78],
		[4, 49, 31],
		[2, 32, 14, 4, 33, 15],
		[4, 39, 13, 1, 40, 14],
		[2, 121, 97],
		[2, 60, 38, 2, 61, 39],
		[4, 40, 18, 2, 41, 19],
		[4, 40, 14, 2, 41, 15],
		[2, 146, 116],
		[3, 58, 36, 2, 59, 37],
		[4, 36, 16, 4, 37, 17],
		[4, 36, 12, 4, 37, 13],
		[2, 86, 68, 2, 87, 69],
		[4, 69, 43, 1, 70, 44],
		[6, 43, 19, 2, 44, 20],
		[6, 43, 15, 2, 44, 16],
		[4, 101, 81],
		[1, 80, 50, 4, 81, 51],
		[4, 50, 22, 4, 51, 23],
		[3, 36, 12, 8, 37, 13],
		[2, 116, 92, 2, 117, 93],
		[6, 58, 36, 2, 59, 37],
		[4, 46, 20, 6, 47, 21],
		[7, 42, 14, 4, 43, 15],
		[4, 133, 107],
		[8, 59, 37, 1, 60, 38],
		[8, 44, 20, 4, 45, 21],
		[12, 33, 11, 4, 34, 12],
		[3, 145, 115, 1, 146, 116],
		[4, 64, 40, 5, 65, 41],
		[11, 36, 16, 5, 37, 17],
		[11, 36, 12, 5, 37, 13],
		[5, 109, 87, 1, 110, 88],
		[5, 65, 41, 5, 66, 42],
		[5, 54, 24, 7, 55, 25],
		[11, 36, 12],
		[5, 122, 98, 1, 123, 99],
		[7, 73, 45, 3, 74, 46],
		[15, 43, 19, 2, 44, 20],
		[3, 45, 15, 13, 46, 16],
		[1, 135, 107, 5, 136, 108],
		[10, 74, 46, 1, 75, 47],
		[1, 50, 22, 15, 51, 23],
		[2, 42, 14, 17, 43, 15],
		[5, 150, 120, 1, 151, 121],
		[9, 69, 43, 4, 70, 44],
		[17, 50, 22, 1, 51, 23],
		[2, 42, 14, 19, 43, 15],
		[3, 141, 113, 4, 142, 114],
		[3, 70, 44, 11, 71, 45],
		[17, 47, 21, 4, 48, 22],
		[9, 39, 13, 16, 40, 14],
		[3, 135, 107, 5, 136, 108],
		[3, 67, 41, 13, 68, 42],
		[15, 54, 24, 5, 55, 25],
		[15, 43, 15, 10, 44, 16],
		[4, 144, 116, 4, 145, 117],
		[17, 68, 42],
		[17, 50, 22, 6, 51, 23],
		[19, 46, 16, 6, 47, 17],
		[2, 139, 111, 7, 140, 112],
		[17, 74, 46],
		[7, 54, 24, 16, 55, 25],
		[34, 37, 13],
		[4, 151, 121, 5, 152, 122],
		[4, 75, 47, 14, 76, 48],
		[11, 54, 24, 14, 55, 25],
		[16, 45, 15, 14, 46, 16],
		[6, 147, 117, 4, 148, 118],
		[6, 73, 45, 14, 74, 46],
		[11, 54, 24, 16, 55, 25],
		[30, 46, 16, 2, 47, 17],
		[8, 132, 106, 4, 133, 107],
		[8, 75, 47, 13, 76, 48],
		[7, 54, 24, 22, 55, 25],
		[22, 45, 15, 13, 46, 16],
		[10, 142, 114, 2, 143, 115],
		[19, 74, 46, 4, 75, 47],
		[28, 50, 22, 6, 51, 23],
		[33, 46, 16, 4, 47, 17],
		[8, 152, 122, 4, 153, 123],
		[22, 73, 45, 3, 74, 46],
		[8, 53, 23, 26, 54, 24],
		[12, 45, 15, 28, 46, 16],
		[3, 147, 117, 10, 148, 118],
		[3, 73, 45, 23, 74, 46],
		[4, 54, 24, 31, 55, 25],
		[11, 45, 15, 31, 46, 16],
		[7, 146, 116, 7, 147, 117],
		[21, 73, 45, 7, 74, 46],
		[1, 53, 23, 37, 54, 24],
		[19, 45, 15, 26, 46, 16],
		[5, 145, 115, 10, 146, 116],
		[19, 75, 47, 10, 76, 48],
		[15, 54, 24, 25, 55, 25],
		[23, 45, 15, 25, 46, 16],
		[13, 145, 115, 3, 146, 116],
		[2, 74, 46, 29, 75, 47],
		[42, 54, 24, 1, 55, 25],
		[23, 45, 15, 28, 46, 16],
		[17, 145, 115],
		[10, 74, 46, 23, 75, 47],
		[10, 54, 24, 35, 55, 25],
		[19, 45, 15, 35, 46, 16],
		[17, 145, 115, 1, 146, 116],
		[14, 74, 46, 21, 75, 47],
		[29, 54, 24, 19, 55, 25],
		[11, 45, 15, 46, 46, 16],
		[13, 145, 115, 6, 146, 116],
		[14, 74, 46, 23, 75, 47],
		[44, 54, 24, 7, 55, 25],
		[59, 46, 16, 1, 47, 17],
		[12, 151, 121, 7, 152, 122],
		[12, 75, 47, 26, 76, 48],
		[39, 54, 24, 14, 55, 25],
		[22, 45, 15, 41, 46, 16],
		[6, 151, 121, 14, 152, 122],
		[6, 75, 47, 34, 76, 48],
		[46, 54, 24, 10, 55, 25],
		[2, 45, 15, 64, 46, 16],
		[17, 152, 122, 4, 153, 123],
		[29, 74, 46, 14, 75, 47],
		[49, 54, 24, 10, 55, 25],
		[24, 45, 15, 46, 46, 16],
		[4, 152, 122, 18, 153, 123],
		[13, 74, 46, 32, 75, 47],
		[48, 54, 24, 14, 55, 25],
		[42, 45, 15, 32, 46, 16],
		[20, 147, 117, 4, 148, 118],
		[40, 75, 47, 7, 76, 48],
		[43, 54, 24, 22, 55, 25],
		[10, 45, 15, 67, 46, 16],
		[19, 148, 118, 6, 149, 119],
		[18, 75, 47, 31, 76, 48],
		[34, 54, 24, 34, 55, 25],
		[20, 45, 15, 61, 46, 16]
	], i.getRSBlocks = function(e, t) {
		var n = i.getRsBlockTable(e, t);
		if (void 0 == n) throw new Error("bad rs block @ typeNumber:" + e + "/errorCorrectLevel:" + t);
		for (var a = n.length / 3, o = [], r = 0; r < a; r++)
			for (var s = n[3 * r + 0], l = n[3 * r + 1], c = n[3 * r + 2], d = 0; d < s; d++) o.push(new i(l, c));
		return o
	}, i.getRsBlockTable = function(e, t) {
		switch (t) {
			case c.L:
				return i.RS_BLOCK_TABLE[4 * (e - 1) + 0];
			case c.M:
				return i.RS_BLOCK_TABLE[4 * (e - 1) + 1];
			case c.Q:
				return i.RS_BLOCK_TABLE[4 * (e - 1) + 2];
			case c.H:
				return i.RS_BLOCK_TABLE[4 * (e - 1) + 3];
			default:
				return
		}
	}, a.prototype = {
		get: function(e) {
			var t = Math.floor(e / 8);
			return 1 == (this.buffer[t] >>> 7 - e % 8 & 1)
		},
		put: function(e, t) {
			for (var n = 0; n < t; n++) this.putBit(1 == (e >>> t - n - 1 & 1))
		},
		getLengthInBits: function() {
			return this.length
		},
		putBit: function(e) {
			var t = Math.floor(this.length / 8);
			this.buffer.length <= t && this.buffer.push(0), e && (this.buffer[t] |= 128 >>> this.length % 8), this.length++
		}
	};
	var h = [
			[17, 14, 11, 7],
			[32, 26, 20, 14],
			[53, 42, 32, 24],
			[78, 62, 46, 34],
			[106, 84, 60, 44],
			[134, 106, 74, 58],
			[154, 122, 86, 64],
			[192, 152, 108, 84],
			[230, 180, 130, 98],
			[271, 213, 151, 119],
			[321, 251, 177, 137],
			[367, 287, 203, 155],
			[425, 331, 241, 177],
			[458, 362, 258, 194],
			[520, 412, 292, 220],
			[586, 450, 322, 250],
			[644, 504, 364, 280],
			[718, 560, 394, 310],
			[792, 624, 442, 338],
			[858, 666, 482, 382],
			[929, 711, 509, 403],
			[1003, 779, 565, 439],
			[1091, 857, 611, 461],
			[1171, 911, 661, 511],
			[1273, 997, 715, 535],
			[1367, 1059, 751, 593],
			[1465, 1125, 805, 625],
			[1528, 1190, 868, 658],
			[1628, 1264, 908, 698],
			[1732, 1370, 982, 742],
			[1840, 1452, 1030, 790],
			[1952, 1538, 1112, 842],
			[2068, 1628, 1168, 898],
			[2188, 1722, 1228, 958],
			[2303, 1809, 1283, 983],
			[2431, 1911, 1351, 1051],
			[2563, 1989, 1423, 1093],
			[2699, 2099, 1499, 1139],
			[2809, 2213, 1579, 1219],
			[2953, 2331, 1663, 1273]
		],
		g = function() {
			var e = function(e, t) {
				this._el = e, this._htOption = t
			};
			return e.prototype.draw = function(e) {
				function t(e, t) {
					var n = document.createElementNS("http://www.w3.org/2000/svg", e);
					for (var i in t) t.hasOwnProperty(i) && n.setAttribute(i, t[i]);
					return n
				}
				var n = this._htOption,
					i = this._el,
					a = e.getModuleCount();
				Math.floor(n.width / a), Math.floor(n.height / a);
				this.clear();
				var o = t("svg", {
					viewBox: "0 0 " + String(a) + " " + String(a),
					width: "100%",
					height: "100%",
					fill: n.colorLight
				});
				o.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:xlink", "http://www.w3.org/1999/xlink"), i.appendChild(o), o.appendChild(t("rect", {
					fill: n.colorLight,
					width: "100%",
					height: "100%"
				})), o.appendChild(t("rect", {
					fill: n.colorDark,
					width: "1",
					height: "1",
					id: "template"
				}));
				for (var r = 0; r < a; r++)
					for (var s = 0; s < a; s++)
						if (e.isDark(r, s)) {
							var l = t("use", {
								x: String(s),
								y: String(r)
							});
							l.setAttributeNS("http://www.w3.org/1999/xlink", "href", "#template"), o.appendChild(l)
						}
			}, e.prototype.clear = function() {
				for (; this._el.hasChildNodes();) this._el.removeChild(this._el.lastChild)
			}, e
		}(),
		m = "svg" === document.documentElement.tagName.toLowerCase(),
		v = m ? g : function() {
			return "undefined" != typeof CanvasRenderingContext2D
		}() ? function() {
			function e() {
				this._elImage.src = this._elCanvas.toDataURL("image/png"), this._elImage.style.display = "block", this._elCanvas.style.display = "none"
			}

			function t(e, t) {
				var n = this;
				if (n._fFail = t, n._fSuccess = e, null === n._bSupportDataURI) {
					var i = document.createElement("img"),
						a = function() {
							n._bSupportDataURI = !1, n._fFail && n._fFail.call(n)
						},
						o = function() {
							n._bSupportDataURI = !0, n._fSuccess && n._fSuccess.call(n)
						};
					return i.onabort = a, i.onerror = a, i.onload = o, void(i.src = "data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")
				}!0 === n._bSupportDataURI && n._fSuccess ? n._fSuccess.call(n) : !1 === n._bSupportDataURI && n._fFail && n._fFail.call(n)
			}
			if (this._android && this._android <= 2.1) {
				var n = 1 / window.devicePixelRatio,
					i = CanvasRenderingContext2D.prototype.drawImage;
				CanvasRenderingContext2D.prototype.drawImage = function(e, t, a, o, r, s, l, c, d) {
					if ("nodeName" in e && /img/i.test(e.nodeName))
						for (var u = arguments.length - 1; u >= 1; u--) arguments[u] = arguments[u] * n;
					else void 0 === c && (arguments[1] *= n, arguments[2] *= n, arguments[3] *= n, arguments[4] *= n);
					i.apply(this, arguments)
				}
			}
			var a = function(e, t) {
				this._bIsPainted = !1, this._android = o(), this._htOption = t, this._elCanvas = document.createElement("canvas"), this._elCanvas.width = t.width, this._elCanvas.height = t.height, e.appendChild(this._elCanvas), this._el = e, this._oContext = this._elCanvas.getContext("2d"), this._bIsPainted = !1, this._elImage = document.createElement("img"), this._elImage.alt = "Scan me!", this._elImage.style.display = "none", this._el.appendChild(this._elImage), this._bSupportDataURI = null
			};
			return a.prototype.draw = function(e) {
				var t = this._elImage,
					n = this._oContext,
					i = this._htOption,
					a = e.getModuleCount(),
					o = i.width / a,
					r = i.height / a,
					s = Math.round(o),
					l = Math.round(r);
				t.style.display = "none", this.clear();
				for (var c = 0; c < a; c++)
					for (var d = 0; d < a; d++) {
						var u = e.isDark(c, d),
							p = d * o,
							f = c * r;
						n.strokeStyle = u ? i.colorDark : i.colorLight, n.lineWidth = 1, n.fillStyle = u ? i.colorDark : i.colorLight, n.fillRect(p, f, o, r), n.strokeRect(Math.floor(p) + .5, Math.floor(f) + .5, s, l), n.strokeRect(Math.ceil(p) - .5, Math.ceil(f) - .5, s, l)
					}
				this._bIsPainted = !0
			}, a.prototype.makeImage = function() {
				this._bIsPainted && t.call(this, e)
			}, a.prototype.isPainted = function() {
				return this._bIsPainted
			}, a.prototype.clear = function() {
				this._oContext.clearRect(0, 0, this._elCanvas.width, this._elCanvas.height), this._bIsPainted = !1
			}, a.prototype.round = function(e) {
				return e ? Math.floor(1e3 * e) / 1e3 : e
			}, a
		}() : function() {
			var e = function(e, t) {
				this._el = e, this._htOption = t
			};
			return e.prototype.draw = function(e) {
				for (var t = this._htOption, n = this._el, i = e.getModuleCount(), a = Math.floor(t.width / i), o = Math.floor(t.height / i), r = ['<table style="border:0;border-collapse:collapse;">'], s = 0; s < i; s++) {
					r.push("<tr>");
					for (var l = 0; l < i; l++) r.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:' + a + "px;height:" + o + "px;background-color:" + (e.isDark(s, l) ? t.colorDark : t.colorLight) + ';"></td>');
					r.push("</tr>")
				}
				r.push("</table>"), n.innerHTML = r.join("");
				var c = n.childNodes[0],
					d = (t.width - c.offsetWidth) / 2,
					u = (t.height - c.offsetHeight) / 2;
				d > 0 && u > 0 && (c.style.margin = u + "px " + d + "px")
			}, e.prototype.clear = function() {
				this._el.innerHTML = ""
			}, e
		}();
	QRCode = function(e, t) {
		if (this._htOption = {
			width: 256,
			height: 256,
			typeNumber: 4,
			colorDark: "#000000",
			colorLight: "#ffffff",
			correctLevel: c.H
		}, "string" == typeof t && (t = {
			text: t
		}), t)
			for (var n in t) this._htOption[n] = t[n];
		"string" == typeof e && (e = document.getElementById(e)), this._htOption.useSVG && (v = g), this._android = o(), this._el = e, this._oQRCode = null, this._oDrawing = new v(this._el, this._htOption), this._htOption.text && this.makeCode(this._htOption.text)
	}, QRCode.prototype.makeCode = function(e) {
		this._oQRCode = new t(r(e, this._htOption.correctLevel), this._htOption.correctLevel), this._oQRCode.addData(e), this._oQRCode.make(), this._el.title = e, this._oDrawing.draw(this._oQRCode), this.makeImage()
	}, QRCode.prototype.makeImage = function() {
		"function" == typeof this._oDrawing.makeImage && (!this._android || this._android >= 3) && this._oDrawing.makeImage()
	}, QRCode.prototype.clear = function() {
		this._oDrawing.clear()
	}, QRCode.CorrectLevel = c
}(),
function(e, t) {
	"use strict";
	var n = !1,
		i = window.__plan_init_data__,
		a = 1 == i.isFellowHeart,
		o = i.is_self,
		r = i.plan_id,
		s = i.cover,
		l = i.friends_code,
		c = i.codeplan_id,
		d = !!i.isAutoPlan,
		u = !!i.planSurvey,
		p = i.planner_name,
		f = i.start_time.split("-").map(function(e, t) {
			return 1 === t ? e - 1 : e
		}),
		h = i.start_time ? new Date(f[0], f[1], f[2]) : null,
		g = i.currency_list,
		m = {},
		v = {
			getPlanId: function() {
				return r
			},
			getCodePlanId: function() {
				return c
			},
			getFriendsCode: function() {
				return l
			},
			isShowSurvey: function() {
				return u
			},
			isAutoPlan: function() {
				return d
			},
			isDoHeartBeat: function() {
				return a
			},
			isSelf: function() {
				return o
			},
			getPlanTitle: function() {
				return p
			},
			setPlanTitle: function(e) {
				p = e
			},
			getPlanCover: function() {
				return s || "//common3.qyerstatic.com/plan/desktop/preview/img/default_1100x576.png"
			},
			setPlanCover: function(e) {
				s = e
			},
			getStartDate: function() {
				return h ? new Date(h.getTime()) : null
			},
			setStartDate: function(e) {
				h = e
			},
			getCurrencyList: function() {
				return g
			},
			getExchangeRate: function(e) {
				return m.hasOwnProperty(e) ? parseFloat(m[e].exchange_rate) : 1
			},
			doHeartBeat: "/api/fellow/synergy",
			getDayList: "/api/v3/oneday/getdaylist",
			reorderDays: "/api/v3/oneday/reorderdays",
			deleteDay: "/api/v3/oneday/deleteday",
			insertDay: "/api/v3/oneday/insertday",
			getDayDetails: "/api/v3/oneday/getdaydetails",
			getPlayHours: "/api/v3/oneday/getplayhours",
			getTraffic: "/api/v3/directions/getp2p",
			getPoiTraffic: "/api/traffic.php?action=getTrafficDetails",
			getFormattedPoiTraffic: "/api/traffic.php?action=formatTrafficDetails",
			setPoiTraffic: "/api/v3/traffic/setpoints",
			deletePoiTraffic: "/api/v3/traffic/unsetpoints",
			searchCity: "/api/v3/search/city",
			updateCityList: "/api/v3/oneday/updatecitylist",
			reorderEvents: "/api/v3/oneday/reorderevents",
			moveEvents: "/api/v3/oneday/moveevents",
			removeEvents: "/api/v3/oneday/removeevents",
			addNote: "/api/v3/note/add",
			editNote: "/api/v3/note/edit",
			deleteNote: "/api/v3/note/delete",
			searchPOI: "/api/v3/search/poi",
			addPOI: "/api/v3/poi/add",
			searchHotel: "/api/v3/search/hotel",
			getAirbnbHotel: "/api/v3/airbnb/search",
			addHotel: "/api/v3/hotel/add",
			searchStation: "/api/v3/search/station",
			addTraffic: "/api/v3/traffic/add",
			getFlightList: "/api/flight.php?action=lists",
			getTopFiveCities: "/api/v3/recommend/getcities",
			getRecommendRoutes: "/api/v3/recommend/getroutes",
			addRouteToPlan: "/api/v3/route/insertonedaypoi2plan",
			getRecommendPois: "/api/v3/recommend/getpoilist",
			getRecommendLms: "/api/v3/lastminute/getList",
			getPoiDetails: "/api/v3/poi/getpoidetail",
			getLmDetails: "/api/v3/lastminute/getlastminutedetail",
			getPoiEventDetails: "/api/v3/poi/getdetail",
			setPoiEventDetails: "/api/v3/poi/edit",
			getPoiComments: "/api/v3/poi/getcomments",
			addPoiComment: "/api/v3/poi/addcomment",
			delPoiComment: "/api/v3/poi/delcomment",
			editPoiComment: "/api/v3/poi/addcomment",
			getRecommendHotelAreas: "/api/v3/recommend/getHotelAreaList",
			getRecommendHotels: "/api/v3/recommend/gethotels",
			getHotelEventDetails: "/api/v3/hotel/getdetail",
			setHotelEventDetails: "/api/v3/hotel/edit",
			getTrafficEventDetails: "/api/v3/traffic/get",
			setTrafficEventDetails: "/api/v3/traffic/edit",
			getRecommendTraffics: "/api/v3/recommend/gettraffics",
			getRecommendTimeTable: "/api/v3/traffic/intercity/default",
			getRecommendGoeuroDetails: "/api/v3/traffic/intercity/goeurotripdetail",
			getRecommendFlightTimeTable: "/api/v3/recommend/flightlist",
			getRecommendFlightDetails: "/api/v3/recommend/getFlightInfo",
			city2citytraffic: "/api/ra.php?action=city2citytraffic",
			getAlternatives: "/ajax.php?action=getplanstuff",
			removeAlternative: "/ajax.php?action=delplanstuff",
			optimizeFill: "/api/route.php?action=autoFillPlan",
			optimizeOneDay: "/api/v3/ra/optimizeevent",
			optimizeHotel: "/api/hotel.php?action=recommendhotel",
			optimizeHotelAutoSelect: "/api/hotel.php?action=recommendhotelauto",
			optimizeHotelSelect: "/api/hotel.php?action=addrecommendhotel",
			optimizePlan: "/api/v3/ra/optimizeallevent",
			optimizePlanApply: "/api/v3/poi/upOptimizePlan",
			savePlanSetting: "/api/route.php?action=saveplan",
			getPrivacySetting: "/api/fellow/getplanfellow",
			setPrivacySetting: "/api/route.php?action=setPrivateSeting",
			setPrivilege: "/api/fellow/addprivilege",
			searchUser: "/api/v3/search/fellow",
			addColleague: "/api/fellow/addplanfellow",
			removeColleague: "/api/fellow/delplanfellow",
			exitColleague: "/planapi_action_quitplanfellow",
			getCalendarData: "/api/v3/tools/getcalendar",
			getWidget: "/api/v3/tools/getwidget",
			addWidget: "/api/v3/tools/setWidgetBind",
			removeWidget: "/api/v3/tools/setWidgetUnbind",
			sortWidget: "/api/v3/tools/movewidget",
			getBudget: "/api/budget.php?action=getlist",
			saveBudget: "/api/budget.php?action=savebudget",
			getCartStatus: "/api/v3/orders/cart",
			getOrderList: "/api/v3/orders/list",
			modifyCustomLink: "/api/v3/orders/editproducturl",
			saveOrderList: "/api/v3/orders/save",
			editisaudit: "/api/v3/orders/editisaudit",
			saveOrderNumber: "/api/v3/orders/upqyerno",
			saveNote: "/api/v3/orders/upqyerno",
			payOrder: "/api/v3/orders/pay",
			getMapInfo: "/api/v3/map/getpoimapinfo",
			downgradeToV2: "/api/v3/version/update",
			feedback: "/api/v3/feedback/add",
			shareWithEmail: "/api/fellow/emailplanfellow",
			sendOrder: "/api/v3/custom/add",
			checkInsurance: "/api/insurerecom",
			getDirection: "/api/v3/directions/get",
			setDirection: "/api/v3/directions/set",
			unsetDirection: "/api/v3/directions/unset"
		},
		y = {};
	y.V2ToV3State = parseInt(window.__plan_init_data__.V2ToV3State), y.qrcode = window.__plan_init_data__.qrcode, y.isFirst = window.__plan_init_data__.isFirst, g.forEach(function(e) {
		m[e.unit_name] = e
	});
	for (var b in v) y[b] = "string" == typeof v[b] ? function(i, a) {
		return function(o) {
			n && (o.testData = e.extend(!0, {}, testData[i])), o.posturl = a, t(o)
		}
	}(b, v[b]) : v[b];
	angular.module("planner-api", []).factory("$api", function() {
		return y
	})
}(jQuery, window.qyerUtil.doAjax),
function(e) {
	"use strict";

	function t() {
		var t, n, i = e(window).width(),
			a = e(window).height(),
			o = e("#recommend-map").is(":visible");
		if (o && i >= 1170) e(".planner-day-list").addClass("planner-day-list--small").css("width", ""), e(".scroll-wrapper").css("left", "110px"), e(".planner-day-details").css("width", "275px"), e(".scroll-wrapper").css("width", "275px"), e(".day-note").css("width", "235px"), t = Math.floor(137.5) - 1, n = 275 - t - 2, e(".details-footer > a").eq(0).css("width", t + "px").end().eq(1).css("width", n + "px"), e(".planner-recommends").css("width", i - 480 + "px");
		else if (o ? e(".planner-day-list").addClass("planner-day-list--small").css("width", "") : e(".planner-day-list").removeClass("planner-day-list--small"), e(".planner-recommends").removeAttr("style"), i >= 1370) e(".planner-day-list, .scroll-wrapper").removeAttr("style"), i >= 1870 ? (e(".planner-day-details").css("width", i - 1144 + "px"), e(".scroll-wrapper").css("width", i - 1144 + "px"), t = Math.floor((i - 1144 - 50) / 2) - 1, n = i - 1144 - 50 - t - 2, e(".details-footer > a").eq(0).css("width", t + "px").end().eq(1).css("width", n + "px"), e(".day-note").css("width", i - 1184 + "px")) : (e(".planner-day-details").css("width", i - 904 + "px"), e(".scroll-wrapper").css("width", i - 904 + "px"), t = Math.floor((i - 904 - 50) / 2) - 1, n = i - 904 - 50 - t - 2, e(".details-footer > a").eq(0).css("width", t + "px").end().eq(1).css("width", n + "px"), e(".day-note").css("width", i - 944 + "px"));
		else if (i <= 970) e(".planner-day-list, .planner-day-details, .day-note, .scroll-wrapper").removeAttr("style"), o && e(".scroll-wrapper").css("left", "110px");
		else {
			var r = o ? 80 : 280 - Math.floor(.35 * (1370 - i)),
				s = o ? 275 : i - 625 - r,
				l = r + 30;
			o ? e(".planner-recommends").css("width", i - 480 + "px") : e(".planner-day-list").css("width", r + "px"), e(".scroll-wrapper").css("left", l + "px"), e(".planner-day-details").css("width", s + "px"), e(".scroll-wrapper").css("width", s + "px"), t = Math.floor((s - 50) / 2) - 1, n = s - 50 - t - 2, e(".details-footer > a").eq(0).css("width", t + "px").end().eq(1).css("width", n + "px"), e(".day-note").css("width", s - 40 + "px")
		}
		e(".scroll-wrapper").css("height", a - 105 + "px")
	}
	angular.module("planner", ["ngDialog", "common-checkbox", "common-dropdown", "common-services", "planner-header", "planner-toolbar", "planner-day-list", "planner-day-details", "planner-recommends", "planner-slides", "planner-popup"]).config(["$sceDelegateProvider",
			function(e) {
				e.resourceUrlWhitelist(["self", "//common1.qyerstatic.com/**", "//common2.qyerstatic.com/**", "//common3.qyerstatic.com/**", "//common4.qyerstatic.com/**"])
			}
		]).constant("templatePath", "//common1.qyerstatic.com/plan/desktop/edit3/templates/").controller("Planner", ["$scope", "$api", "plannerService",
			function(e, t, n) {
				e.service = n
			}
		]), e(window).resize(function() {
			t()
		}), t(), window._googlemaploaded_ = !1, window.initialize = function() {
			window._googlemaploaded_ = !0, e(window).trigger("googlemaploaded")
		},
		function() {
			var e = document.createElement("script");
			e.type = "text/javascript", e.src = "http://maps.google.cn/maps/api/js?libraries=geometry&sensor=false&key=AIzaSyCFyj9mrzuoTWACoSqRy77qYr9i8O6gi9s&callback=initialize", document.body.appendChild(e)
		}(),
		function(e) {
			var t = ["//common3.qyerstatic.com/plan/desktop/edit3/img/background.png", "//common3.qyerstatic.com/plan/desktop/edit3/img/header.png"],
				n = 0,
				i = function() {
					(n += 1) === t.length && e()
				};
			t.forEach(function(e, t) {
				var n = new Image;
				n.onload = i, n.src = e
			})
		}(function() {
			e("body, #wrapper > header").css("background-image", "url(//common3.qyerstatic.com/plan/desktop/edit3/img/background.png)"), e("#wrapper > header > .inner").css("background-image", "url(//common3.qyerstatic.com/plan/desktop/edit3/img/header.png)")
		})
}(jQuery),
function(e) {
	"use strict";
	angular.module("common-checkbox", []).directive("checkbox", function() {
		return {
			restrict: "A",
			require: "ngModel",
			link: function(t, n, i, a) {
				var o = e(n),
					r = e("<a>", {
						href: "#",
						class: "checkbox" + (o.attr("disabled") ? " disabled" : "")
					}).click(function() {
						var n;
						o.attr("disabled") || (e(this).toggleClass("checked"), n = e(this).hasClass("checked"), o.prop("checked", n).trigger("change"), t.$apply(function() {
							a.$setViewValue(n)
						}))
					}).insertAfter(o);
				t.$watch(o.attr("ng-model"), function() {
					r[n[0].checked ? "addClass" : "removeClass"]("checked")
				}), o.hide(), o.prop("checked") && r.addClass("checked")
			}
		}
	})
}(jQuery),
function(e) {
	"use strict";

	function t(t, n, o) {
		var s;
		r.empty(), s = "function" == typeof n ? n.call(t, o) : n, angular.forEach(s, function(n) {
			if ("-" === n.label) e("<li>", {
				class: "sep"
			}).appendTo(r);
			else if (n.submenu) {
				var s, l;
				l = "function" == typeof n.submenu ? n.submenu.call(t, o) : n.submenu, s = e("<ul>", {
					class: "submenu"
				}), e.each(l, function(n, r) {
					var l = e("<li>", {
						text: r.label
					}).appendTo(s);
					r.disabled ? l.addClass("disabled") : l.one("click", function() {
						r.action.call(t, o), a.slideUp(), i = null
					})
				}), e("<li>", e.extend({
					text: n.label,
					class: n.icon
				}, n.attrs)).append(e("<span>", {
					class: "more"
				})).append(s).appendTo(r)
			} else {
				var c = e("<li>", e.extend({
					text: n.label,
					class: n.icon
				}, n.attrs)).appendTo(r);
				n.disabled ? c.addClass("disabled") : c.one("click", function() {
					n.action.call(t, o), a.slideUp(), i = null
				})
			}
		})
	}

	function n() {
		a.slideUp(function() {
			i = null
		})
	}
	var i = null,
		a = e("<div>", {
			class: "dropdown"
		}).appendTo(document.body),
		o = e("<h3>").appendTo(a),
		r = e("<ul>").appendTo(a),
		s = null;
	e("<a>", {
		class: "close",
		href: "#",
		text: "关闭"
	}).appendTo(a).click(function(e) {
		e.preventDefault(), a.slideUp(), i = null, s && (qyerUtil.doTrackCode(s), s = null)
	}), angular.module("common-dropdown", []).directive("slideDropdown", function() {
		return {
			restrict: "A",
			link: function(n, l, c) {
				var d = n[c.slideDropdown];
				e(l).click(function(n) {
					if (n.preventDefault(), i === l) return void a.slideUp(function() {
						i = null
					});
					var u, p, f, h, g = e(l),
						m = g.offset(),
						v = g.outerWidth(),
						y = g.outerHeight();
					i = l, g.is(":disabled, .disabled") || (d.small ? r.addClass("small") : r.removeClass("small"), a.is(":visible") && a.clone().prependTo(document.body).slideUp(function() {
						e(this).remove()
					}), t(l, d.menu, c), u = m.top + (d.offsetY || 0) + y + 10, p = m.left + (d.offsetX || 0) + v - 200, f = a.height(), h = g.closest(".scroll-wrapper").size() > 0 ? e(window).scrollTop() : 0, p < 10 && (p = 10), f + u - h > e(window).height() && (u = u - f - 10), a.hide().css({
						top: u,
						left: p
					}), o.text(d.title), a.slideDown(), s = d.closeTrackCode || null)
				})
			}
		}
	}), window._hideMenus = n
}(jQuery),
function(e) {
	"use strict";
	angular.module("common-services", []).filter("limitToNum", function() {
		return function(e, t) {
			return e.length > t && (e = e.substring(0, t) + "..."), e
		}
	}).factory("plannerService", ["$rootScope", "$api", "templatePath", "ngDialog",
		function(t, n, i, a) {
			var o = {
					mode: "standard",
					allDays: null,
					selectedDay: {
						index: 0,
						object: null,
						notes: [],
						place_list: []
					},
					place_list: [],
					recommendType: "normal",
					recommendKeyword: null,
					navType: "edit",
					selectedCity: null,
					selectedRecommendTab: "pois",
					selectedNote: null,
					selectedRoute: null,
					selectedEventId: null,
					selectedGroupId: null,
					selectedPoiId: null,
					selectedTraffic: null,
					slideType: "view",
					slideName: null,
					poiFilter: "0",
					lmFilter: "0",
					hotelFilter: {
						type: 0,
						grade: 0,
						order: 0
					},
					isLogin: window.QYER.uid > 0
				},
				r = {
					url: "//common3.qyerstatic.com/plan/desktop/edit3/img/cross-pin.png",
					size: {
						w: 24,
						h: 38
					},
					point: {
						x: 0,
						y: 0
					}
				},
				s = null;
			return o.isSelectedTrafficData = !1, o.broadcast = function(e, n) {
				t.$broadcast(e, n)
			}, o.QuestLoading = !1, o.question = {
				title: "",
				content: "",
				target: "",
				bbsval: ""
			}, o.setMode = function(n) {
				this.mode = n, "map" !== n && (this.selectedTraffic = null, this.selectedPoi = null, this.selectedHotel = null, e(".recommends-tabs").css("top", ""), e(".recommends-body .range").attr("style", "")), t.$broadcast("mode-changed", n)
			}, o.setAllDays = function(e, n) {
				this.allDays = e, !1 !== n && t.$broadcast("all-days-updated")
			}, o.setSelectedDay = function(e, n) {
				var i = !1;
				void 0 !== e && void 0 !== n && (this.selectedDay.index = e, this.selectedDay.object = n, this.selectedDay.notes = [], this.updateSelectedCity(), i = !0), t.$broadcast("selected-day-changed", {
					isDayChanged: i
				})
			}, o.updateSelectedCity = function(e) {
				if (e) this.selectedCity = e;
				else {
					var n, i = null;
					if (this.selectedDay.object.city_list && this.selectedDay.object.city_list.length)
						for (var a = this.selectedDay.object.city_list.length - 1; a >= 0; a--)
							if (n = this.selectedDay.object.city_list[a], n.tagid > 0) {
								i = n;
								break
							}
					this.selectedCity = i
				}
				t.$broadcast("selected-city-changed")
			}, o.getAllCities = function() {
				var e = [],
					t = {};
				return this.selectedDay.object && this.selectedDay.object.city_list && this.selectedDay.object.city_list.forEach(function(n) {
					n.tagid > 0 && !t[n.tagid] && (e.push(n), t[n.tagid] = !0)
				}), this.allDays && this.allDays.forEach(function(n) {
					n.city_list && n.city_list.forEach(function(n) {
						n.tagid > 0 && !t[n.tagid] && (e.push(n), t[n.tagid] = !0)
					})
				}), e
			}, o.setSelectedDayNotes = function(e) {
				this.selectedDay.notes = e || [], t.$broadcast("selected-day-notes-loaded")
			}, o.addSelectedDayEvent = function(e) {
				t.$broadcast("day-details-event-added", e)
			}, o.changeSelectedDayEvent = function(e) {
				t.$broadcast("day-details-event-changed", e)
			}, o.addSelectedDayNote = function(e) {
				this.selectedDay.notes.push(e)
			}, o.updateSelectedNote = function(e) {
				var n = this,
					i = JSON.parse(e);
				this.selectedDay.notes.forEach(function(e) {
					if (e === n.selectedNote) return e.message = i.message, e.images = i.images, t.$broadcast("selected-day-notes-updated"), !1
				})
			}, o.deleteNote = function(e) {
				for (var n = this.selectedDay.notes.length - 1; n >= 0; n--)
					if (this.selectedDay.notes[n] === e) {
						this.selectedDay.notes.splice(n, 1), t.$broadcast("selected-day-notes-updated");
						break
					}
			}, o.showPopup = function(t, n) {
				window._hideMenus(), e(".scroll-wrapper").css({
					overflow: "hidden",
					position: "fixed",
					height: "100%"
				}), e("#wrapper").addClass("blur"), a.open({
					template: t,
					plain: !0,
					closeByDocument: !1
				}).closePromise.then(function(t) {
					e(".scroll-wrapper").removeAttr("style"), e("#wrapper").removeClass("blur"), t.$dialog.remove(), e(window).resize(), n && n.afterClose && n.afterClose(), n && n.closeTrackCode && "$closeButton" === t.value && !t.$dialog.find(">.ngdialog-content>.ngdialog-close").attr("data-bn-ipg") && qyerUtil.doTrackCode(n.closeTrackCode)
				})
			}, o.resizePopup = function(t) {
				var n = e(".ngdialog"),
					i = n.find(".ngdialog-content"),
					a = i.height() + (t || 0),
					o = e(window).height();
				a > o ? i.css("top", 0) : i.css("top", (o - a) / 2 + "px")
			}, o.showSlide = function(n, i) {
				this.slideName = n, this.hideDropdown(), i && t.$apply(), e(".slider-wrapper").show(), setTimeout(function() {
					e(".slider-wrapper").on("click", function(t) {
						e(t.target).hasClass("slider-wrapper") && (o.hideSlide(), e(this).off("click"))
					})
				}, 500), setTimeout(function() {
					e(".planner-slider").addClass("open")
				}, 10)
			}, o.hideSlide = function(n) {
				var i = this;
				e(".planner-slider").removeClass("open"), _.each(o.place_list, function(e) {
					e.active = !1
				}), setTimeout(function() {
					e(".slider-wrapper").hide(), t.$broadcast("slide-closed:" + i.slideName), t.$apply(function() {
						i.slideName = null, i.selectedLastminute = null
					})
				}, 250), n && n.preventDefault()
			}, t.$on("ngDialog.opened", function() {
				o.resizePopup()
			}), o.hideDropdown = function() {
				e(".dropdown").slideUp()
			}, o.changeRecommendTab = function(e) {
				this.selectedRecommendTab = e, t.$broadcast("recommend-tab-changed")
			}, o.changeRecommendType = function(n, i) {
				this.recommendType === n && this.recommendKeyword === i || (e(".planner-recommends .recommends-tabs").css("top", ""), e(".planner-recommends .range").removeAttr("style")), this.recommendType !== n && (this.recommendType = n, t.$broadcast("recommend-type-changed")), this.recommendKeyword !== i && (this.recommendKeyword = i, t.$broadcast("recommend-keyword-changed"))
			}, o.searchRecommendResultCount = {
				city_count: 0,
				global_count: 0
			}, o.changePoiFilter = function(e) {
				this.poiFilter = e, t.$broadcast("poi-filter-changed")
			}, o.changeLmFilter = function(e) {
				this.lmFilter = e, "" === e && (this.lmFilter = "-1"), t.$broadcast("lm-filter-changed")
			}, o.changeHotelFilter = function(e) {
				this.hotelFilter = e, t.$broadcast("hotel-filter-changed")
			}, o.changeNavType = function(e) {
				this.navType = e, t.$broadcast("nav-type-changed")
			}, o.updateStartDate = function(e) {
				n.setStartDate(e), t.$broadcast("start-date-changed")
			}, o.addCityToPlan = function(e) {
				t.$broadcast("add-city-to-plan", e)
			}, o.startPinAnimation = function(e, n) {
				t.$broadcast("start-pin-animation", n)
			}, o.stopPinAnimation = function(e, n) {
				t.$broadcast("stop-pin-animation", n)
			}, o.showLoadingTip = function(t) {
				o.$loadingTip ? (o.$loadingTip.find(".qui-tip-textContent").text(t).end().css({
					opacity: 0,
					transform: "scale(0.1, 1)"
				}).appendTo(document.body).show(), setTimeout(function() {
					o.$loadingTip.css({
						opacity: 1,
						transform: "scale(1, 1)"
					})
				}, 0)) : require(["web_qui_quitip"], function() {
					o.$loadingTip = e("<div>", {
						id: "loading-tip",
						class: "qui-tip",
						css: {
							zIndex: 1500,
							textAlign: "center",
							top: 0,
							display: "block"
						}
					}).append(e("<div>", {
						class: "qui-tip-box",
						css: {
							marginLeft: 0,
							marginRight: 0
						}
					}).append(e("<span>", {
						class: "qui-tip-text fontYaHei",
						css: {
							paddingLeft: "34px"
						}
					}).append(e("<span>", {
						class: "qui-tip-textIcon",
						css: {
							display: "block"
						}
					})).append(e("<span>", {
						class: "qui-tip-textContent"
					})))), o.showLoadingTip(t)
				})
			}, o.hideLoadingTip = function(e) {
				o.$loadingTip && (o.$loadingTip.css({
					opacity: 0,
					transform: "scale(0.1, 1)"
				}), setTimeout(function() {
					o.$loadingTip.hide(), e && e()
				}, 300))
			}, o.showTip = function(e, t, n) {
				s ? (t || (t = "warning"), s.show({
					text: e,
					type: t
				})) : require(["web_qui_quitip"], function(i) {
					s = new i({
						time: n || 2e3,
						top: 0
					}), o.showTip(e, t)
				})
			}, o.showConfirm = function(e, t, n, i) {
				requirejs(["web_old_slidconfirm"], function(a) {
					a.confirm({
						text: e,
						target: t,
						onOK: n,
						onCancel: i
					})
				})
			}, o.showConfirm2 = function(t, n, i) {
				function a() {
					s.off("click"), l.off("click"), o.remove(), r.remove()
				}
				var o = e('<div class="mask"></div>').appendTo(document.body),
					r = e('<div class="ngdialog-content confirm2"></div>').appendTo(document.body),
					t = e("<h5>" + t + "</h5>").appendTo(r),
					s = e('<a href="#" class="button primary">确定</a>').appendTo(r),
					l = e('<a href="#" class="ngdialog-close close">关闭</a>').appendTo(r);
				o.css("z-index", 1050), r.css("z-index", 1051), s.on("click", function() {
					a(), n && n()
				}), l.on("click", function() {
					a(), i && i()
				})
			}, o.createSelectMarker = function(t, n, i, a) {
				requirejs(["web_qui_quiselectmarker"], function(s) {
					var l = (o.selectedCity, new s({
						container: "#" + t,
						icon: r,
						callback: i
					}));
					e("#" + t).find(".searchIcon").append(e("<em>", {
						class: "magnify icon"
					})).prev().attr("placeholder", "").end().closest(".search").prepend(e("<div>", {
						class: "label",
						text: "搜索地址："
					})).append(e('<div class="tips">或拖动<em class="icon small-red-pin"></em>直接在地图上标记位置</div>')).parent().append(e('<a href="#" class="primary button mark-button">手动标记</a>').click(function() {
						var t = e(this),
							n = l.map.getCenter();
						t.hasClass("primary") ? (t.removeClass("primary").text("取消标记"), l.reset(n.lat(), n.lng())) : (t.addClass("primary").text("手动标记"), l.clear()), i && i()
					})), a && a.lat && a.lng && (l.map.setCenter(new google.maps.LatLng(a.lat, a.lng)), l.map.setZoom(13)), l.map.setOptions({
						scrollwheel: !1
					}), n(l)
				})
			}, e(window).resize(function() {
				o.resizePopup()
			}), o.showLargePic = function() {
				e("body").on("mouseenter", "img[data-datalarge]", function() {
					var t = e(this),
						n = t.offset(),
						i = n.left,
						a = n.top,
						o = e(window).width(),
						r = e(window).height(),
						s = e(window).scrollTop();
					i = 300 + i > parseInt(o, 10) ? i - 220 : i, a = 280 + a > parseInt(r + s, 10) ? a - 216 : a + 58, e('<div class="poiDet-largePic"><img src="' + t.attr("data-datalarge") + '"/></div>').css({
						"z-index": 99999,
						left: i,
						top: a
					}).appendTo("body")
				}).on("mouseleave", "img[data-datalarge]", function() {
					e(".poiDet-largePic").remove()
				})
			}, o.showLargePic(), o.uploadPic = function(e, t, n) {
				require(["web_qui_quiupload"], function(i) {
					new i({
						browse_button: e,
						container: t,
						drop_element: t,
						init: {
							FilesAdded: function(e, t) {},
							BeforeUpload: function(e, t) {},
							UploadProgress: function(e, t) {},
							UploadComplete: function() {},
							FileUploaded: function(e, t, i) {
								n(JSON.parse(i))
							},
							Error: function(e, t, n) {}
						}
					})
				})
			}, o.uploadPlanPic = function(e) {
				require(["web_qui_quiupload"], function(t) {
					new t({
						browse_button: e.browse_button,
						container: e.container,
						drop_element: e.container,
						paths: e.paths || !1,
						max_file_size: "10mb",
						multi_selection: !1,
						filters: {
							mime_types: [{
								title: "Image files",
								extensions: "jpg,png,bmp,jpeg"
							}]
						},
						init: {
							FilesAdded: function(e, t) {},
							BeforeUpload: function(t, n) {
								e.BeforeUpload && e.BeforeUpload()
							},
							UploadProgress: function(e, t) {},
							UploadComplete: function() {
								e.UploadComplete && e.UploadComplete()
							},
							FileUploaded: function(t, n, i) {
								e.FileUploaded && e.FileUploaded(JSON.parse(i), n, i)
							},
							Error: function(t, n, i) {
								-600 === n.code && o.showTip("上传文件大小限制 10M 以内", "error"), e.UploadError && e.UploadError()
							}
						}
					})
				})
			}, o.HTML_DECODE = {
				"&lt;": "<",
				"&gt;": ">",
				"&amp;": "&",
				"&nbsp;": " ",
				"&quot;": '"',
				"©": ""
			}, o.encodeHTML = function(e) {
				return e = e || "", "string" != typeof e ? "" : e.replace(/"|&|'|<|>|[\x00-\x20]|[\x7F-\xFF]|[\u0100-\u2700]/g, function(e) {
					var t = e.charCodeAt(0),
						n = ["&#"];
					return t = 32 == t ? 160 : t, n.push(t), n.push(";"), n.join("")
				})
			}, o.decodeHTML = function(e) {
				var t = o.HTML_DECODE;
				return e = e || "", "string" != typeof e ? "" : e.replace(/&\w+;|&#(\d+);/g, function(e, n) {
					var i = t[e];
					return i || (i = isNaN(n) ? e : String.fromCharCode(160 == n ? 32 : n)), i
				})
			}, o.textareaTurn = function(t) {
				var n, i = t.scope,
					a = t.save;
				i.textarea = {}, i.textarea.btnShow = 0, i.textarea.focus = 0;
				var o = function(t) {
					e(t.target).closest(".textarea-box").find("textarea:eq(0)").scrollTop(0)
				};
				i.textarea.cancel = function(e) {
					n = "poi" == t.type ? i.event.note : i, n.content = i.content_bak, o(e), i.textarea.btnShow = i.textarea.focus = 0
				}, i.textarea.save = function(e) {
					n = "poi" == t.type ? i.event.note : i, i.dirtyFlag && a(), o(e), i.textarea.btnShow = i.textarea.focus = 0
				}, i.textarea.focusFun = function() {
					i.textarea.btnShow = i.textarea.focus = 1
				}, i.textarea.blurFun = function() {
					i.textarea.focus = 0
				}
			}, o.showBigPicture = function() {
				var t = {};
				t.body = e("body"), t.body.on("click.srcbig", ".upload-pic-box [data-bigsrc]", function() {
					var n = e('<div class="qui-show-big-picture"><div class="pic-box"><div class="pic-wrap"></div></div><div class="pic-loading"></div><div class="pic-close iconfont">&#58963;</div></div>'),
						i = e(this).data("bigsrc");
					t.tmpObj = n, t.tmpObj.appendTo("body"), t.setImageLoad(i), t.addEventShowImage()
				}), t.setImageLoad = function(e) {
					var n = new Image;
					if (t.img = n, n.src = e, n.complete) return void t.setImageShow(n);
					n.onload = function() {
						t.setImageShow(n)
					}
				}, t.setImageShow = function(n) {
					var i = e(window),
						a = i.width(),
						o = i.height(),
						r = e(n),
						s = n.width,
						l = n.height;
					s <= a && l <= o ? r.css({
						width: "auto",
						height: "auto"
					}) : s > a && l <= o ? r.css({
						width: a,
						height: "auto"
					}) : s <= a && l > o ? r.css({
						width: "auto",
						height: o
					}) : s / l < a / o ? r.css({
						width: "auto",
						height: o
					}) : r.css({
						width: a,
						height: "auto"
					}), t.tmpObj.find(".pic-loading").hide(), t.tmpObj.find(".pic-wrap").html(r), t.tmpObj.find(".pic-box").animate({
						opacity: 1
					}, 200)
				}, t.removeImage = function() {
					t.tmpObj.animate({
						opacity: 0
					}, 200, function() {
						t.img.onload = null, t.removeEventShowImage(), t.tmpObj.remove()
					})
				}, t.addEventShowImage = function() {
					t.tmpObj.on("click.bigsrc", ".pic-close", t.removeImage), e(document).on("keyup.bigsrc", function(e) {
						27 === (e.keyCode || e.which) && t.removeImage()
					})
				}, t.removeEventShowImage = function() {
					t.tmpObj.off("click.bigsrc"), e(document).off("keyup.bigsrc")
				}
			}, o.showBigPicture(), o.getPoiDefaultPic = function(e, t) {
				var n = [{
						0: "poi_default",
						32: "poi_poi",
						77: "poi_traffic",
						78: "poi_cate",
						147: "poi_shopping",
						148: "poi_play",
						1e3: "poi_default"
					}, "hotel_default", ["traffic_default", "traffic_plane", "traffic_train", "traffic_bus", "traffic_car", "traffic_ship", "traffic_default", "traffic_car"], "sale_default"],
					i = "",
					t = t || "400x";
				return i = 1 == e.type ? n[e.type - 1][e.catetypeid] || n[0][0] : 3 == e.type ? n[e.type - 1][e.tripmode] || n[2][0] : n[e.type - 1], i = "//common3.qyerstatic.com/plan/mobile/shared/img/default_pic/" + t + "/" + i + ".jpg"
			}, o
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-day-list", ["ui.sortable", "planner-api"]).directive("plannerDayList", [
		function() {
			return {
				restrict: "C",
				template: '\x3c!-- <div class="inner-header"></div> --\x3e<div ng-controller="DayListController" class="inner"><ul ui-sortable="sortableOptions" ng-model="days"><li ng-repeat="day in days" ng-click="changeDay($event, $index, day)" ng-class="{\'true\':\'active\', \'false\':\'\'}[(index === $index)]" data-help-index="{{{true: 12}[$index == 0]}}" data-help-direction="{{{true: \'right\'}[$index == 0]}}" data-help-content="{{{true: \'拖拽住即可调序哦，景点也是\'}[$index == 0]}}"><h2>D{{$index + 1}}</h2><div class="text-container"><div><p class="date">{{getDate($index) | date:\'M月d日\'}} {{getDate($index) | date:\'EEE\' | week}}</p><p class="places" title="{{getTitle(day)}}"><span ng-repeat="city in day.city_list">{{city.name}}</span><span ng-if="!day.city_list || day.city_list.length === 0">暂无安排</span></p></div></div><div class="more iconfont" slide-dropdown="dropdownOptions" data-index="{{$index}}" data-dayid="{{day.id}}">        &#59015;      </div></li></ul><div class="addlast" ng-if="days.length < 50" ng-click="addLast()"><span class="iconfont">&#58943;</span>增加一天</div></div>\x3c!-- <div class="inner-footer"></div> --\x3e'
			}
		}
	]).filter("week", function() {
		var e = {
			MON: "周一",
			TUE: "周二",
			WED: "周三",
			THU: "周四",
			FRI: "周五",
			SAT: "周六",
			SUN: "周日"
		};
		return function(t) {
			return e[angular.uppercase(t)]
		}
	}).controller("DayListController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			function o(i) {
				n.deleteDay({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.dayId
					},
					onSuccess: function() {
						e(".planner-day-list ul > li").eq(i.index).slideUp(250, function() {
							t.$apply(function() {
								t.days.splice(i.index, 1), a.setAllDays(t.days), i.index === t.index && (i.index === t.days.length && i.index > 0 ? t.changeDay(null, i.index - 1, t.days[i.index - 1]) : t.changeDay(null, i.index, t.days[i.index]))
							}), a.showTip("删除成功！", "ok")
						})
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				})
			}

			function r(e) {
				var t;
				e.list.forEach(function(e) {
					var n = "number" == typeof e.id ? e.id : e.id.id;
					3 == e.type && (t = n)
				}), t ? n.getTrafficEventDetails({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: e.dayId,
						trafficid: t
					},
					onSuccess: function(t) {
						var n = t.data.traffics.map(function(e) {
							return e.fromplace + " > " + e.toplace
						}).join("<br>");
						requirejs(["web_old_slidconfirm"], function(t) {
							t.confirm({
								text: "将一并删除关联的交通信息，是否继续?<br>" + n,
								target: e.target,
								onOK: function() {
									o(e)
								}
							})
						})
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				}) : o(e)
			}
			var s = null,
				l = null;
			t.index = 0, t.days = [{}], a.setAllDays(t.days, !1), t.getDate = function(e) {
				var t = n.getStartDate();
				if (t) {
					var i = new Date(t.getTime());
					return i.setDate(i.getDate() + e), i
				}
				return "暂无出发日期"
			}, t.changeDay = function(o, r, s) {
				if (!o || !e(o.target).hasClass("more")) {
					o && qyerUtil.doTrackCode("Planv3-left-clickday"), t.index = r, a.hideDropdown(), a.setSelectedDay(r, s);
					var l = i("date"),
						c = n.getStartDate();
					if (c) {
						var d = new Date(c.getTime() + 864e5 * t.index);
						a.broadcast("start-date-updated", l(d, "yyyy-MM-dd")), a.startDateUpdated = d
					}
					a.tmpTraffic = null
				}
			}, n.getDayList({
				data: {
					plan_id: n.getPlanId()
				},
				onSuccess: function(e) {
					t.$apply(function() {
						t.days = e.data, _.each(t.days, function(e) {
							_.each(e.city_list, function(e) {
								e.name = a.decodeHTML(e.name)
							})
						}), a.setAllDays(t.days)
					}), t.changeDay(null, 0, t.days[0])
				},
				onError: function(e) {
					a.showTip(e.data.msg, "error")
				}
			}), t._sortableTmp = null, t.sortableOptions = {
				start: function() {
					l = t.days[t.index].id, a.hideDropdown(), t._sortableTmp = t.days.map(function(e, t) {
						return e.id
					})
				},
				stop: function(e, i) {
					if (s = null, t._sortableTmp.join("-") != t.days.map(function(e) {
						return e.id
					}).join("-")) {
						var o = t.days.map(function(e, n) {
							return e.id == l && (t.index = n, l = null), e.id
						});
						n.reorderDays({
							data: {
								plan_id: n.getPlanId(),
								day_list: o
							},
							onSuccess: function() {
								a.showTip("保存成功！", "ok")
							},
							onError: function(e) {
								a.showTip(e.data.msg, "error")
							}
						})
					}
				},
				scroll: !0,
				helper: "clone",
				axis: "y",
				appendTo: "section.planner-day-list"
			}, t.addLast = function() {
				var i = e(".planner-day-list ul li").length;
				n.insertDay({
					data: {
						plan_id: n.getPlanId(),
						index: i
					},
					onSuccess: function(e) {
						t.$apply(function() {
							e.data.city_list.forEach(function(e) {
								e.tagid = e.id
							}), t.days.splice(i, 0, e.data), a.setAllDays(t.days), t.changeDay(null, i, e.data)
						}), a.showTip("添加成功！", "ok")
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				}), qyerUtil.doTrackCode("Planv3-left-day-addafter")
			}, t.dropdownOptions = {
				title: "操作",
				menu: function() {
					return [{
						label: "之前插入一天",
						icon: "add",
						action: function(e) {
							var i = parseInt(e.index);
							n.insertDay({
								data: {
									plan_id: n.getPlanId(),
									index: i
								},
								onSuccess: function(e) {
									t.$apply(function() {
										e.data.city_list.forEach(function(e) {
											e.tagid = e.id
										}), t.days.splice(i, 0, e.data), a.setAllDays(t.days), t.changeDay(null, i, e.data)
									}), a.showTip("添加成功！", "ok")
								},
								onError: function(e) {
									a.showTip(e.data.msg, "error")
								}
							}), qyerUtil.doTrackCode("Planv3-left-day-addbefore")
						}
					}, {
						label: "之后插入一天",
						icon: "add",
						action: function(e) {
							var i = parseInt(e.index) + 1;
							n.insertDay({
								data: {
									plan_id: n.getPlanId(),
									index: i
								},
								onSuccess: function(e) {
									t.$apply(function() {
										e.data.city_list.forEach(function(e) {
											e.tagid = e.id
										}), t.days.splice(i, 0, e.data), a.setAllDays(t.days), t.changeDay(null, i, e.data)
									}), a.showTip("添加成功！", "ok")
								},
								onError: function(e) {
									a.showTip(e.data.msg, "error")
								}
							}), qyerUtil.doTrackCode("Planv3-left-day-addafter")
						}
					}, {
						label: "删除该日",
						icon: "trash-bin",
						disabled: 1 === t.days.length,
						action: function(t) {
							var i = e(this).closest("li").find("p.places"),
								o = parseInt(t.index);
							requirejs(["web_old_slidconfirm"], function(e) {
								e.confirm({
									text: "确认要删除这一天？",
									target: i,
									onOK: function() {
										t.dayid == a.selectedDay.object.id ? r({
											dayId: t.dayid,
											index: o,
											list: a.place_list,
											target: i
										}) : n.getDayDetails({
											data: {
												plan_id: n.getPlanId(),
												oneday_id: t.dayid
											},
											onSuccess: function(e) {
												r({
													dayId: t.dayid,
													index: o,
													list: e.data.event_list,
													target: i
												})
											},
											onError: function(e) {
												a.showTip(e.data.msg, "error")
											}
										})
									}
								})
							}), qyerUtil.doTrackCode("Planv3-left-day-delete")
						}
					}]
				}
			}, t.$on("start-date-changed", function() {
				t.$apply()
			}), "webkit" == function() {
				for (var e = document.body || document.documentElement, t = e.style, n = ["webkit", "khtml", "moz", "ms", "o"], i = 0; i < n.length;) {
					if ("string" == typeof t[n[i] + "Transition"]) return n[i];
					i++
				}
			}() && (e(".planner-day-list").addClass("scroll_top"), e(".planner-day-list").scroll(function() {
				var t = e(this).height() + e(this).scrollTop() == e(".planner-day-list .inner").height();
				0 == e(this).scrollTop() ? e(this).addClass("scroll_top") : t ? e(this).addClass("scroll_bot") : e(this).removeClass("scroll_top scroll_bot")
			})), t.getTitle = function(e) {
				return e.city_list ? e.city_list.map(function(e) {
					return e.name
				}).join("-") : ""
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-day-details.add-hotel", []).controller("AddHotelController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			var o;
			t.isShowMap = !1, a.selectedHotel ? (t.hotel = a.selectedHotel, t.hotel.hotel_id = t.hotel.id, t.price = parseFloat(a.selectedHotel.reference_price) || 0, t.inputState = !1, a.selectedHotel = null) : (t.hotel = {}, t.price = 0, t.inputState = !0), t.headTab = "default", t.airbnbInputState = "edit", t.airbnbLoading, t.results = [], t.days = a.allDays, t.currentDayIndex = a.selectedDay.index, t.checkinDay = t.currentDayIndex, t.currencyList = n.getCurrencyList(), t.note = {}, t.imgStatusCustom = "default", t.hotelImgCustom = "", t.resetAirbnbInput = function() {
				document.getElementById("airbnbInput").value = "", t.airbnbInputState = "edit"
			}, t.submitAirbnbInput = function() {
				t.airbnbLoading = !0;
				var e = {};
				e.url = document.getElementById("airbnbInput").value, n.getAirbnbHotel({
					data: e,
					onSuccess: function(n) {
						t.$apply(function() {
							t.hotel = n.data, t.hotel.url = e.url, t.airbnbInputState = "view", t.airbnbLoading = !1
						})
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error"), t.$apply(function() {
							t.airbnbLoading = !1, t.airbnbInputState = "edit"
						})
					}
				})
			}, t.changeHotelType = function(n) {
				t.headTab = n, t.hotel = {}, t.price = 0, t.inputState = !0, t.airbnbInputState = "edit", t.hotelCustom = !1, e("#hotelInput").val(""), e("#airbnbInput").val(""), "airbnb" == n ? qyerUtil.doTrackCode("Planv3-mid-edit-addhotel-airbnb") : qyerUtil.doTrackCode("Planv3-mid-edit-addhotel-hotel")
			}, t.changeAirbnbInput = function() {
				t.airbnbInputState = "edit", t.hotel = {}, t.price = 0
			}, t.changeAirbnbLink = function() {
				t.hotel = {}, t.price = 0
			}, t.getDayString = function(e, t) {
				var a, o, r = i("date"),
					s = n.getStartDate(),
					l = "第" + (e + 1) + "天";
				return s ? (o = new Date(s.getTime() + 864e5 * e), l = "(" + r(o, "M.d") + ") ") : l += " ", a = t.city_list && t.city_list.length > 0 ? t.city_list.map(function(e) {
					return e.name
				}).join("，") : "暂无城市安排", l + a
			}, t.changeHotel = function(n) {
				var i = e(n.target).siblings("input").val(t.hotel.cn_name + " " + t.hotel.en_name);
				t.inputState = !0, setTimeout(function() {
					i.focus().select()
				}, 1)
			}, t.getNextIndex = function() {
				var e = a.allDays,
					n = e[t.currentDayIndex].city_list;
				if (e.length <= 1 || !n || !n.length) return t.currentDayIndex;
				var i, o = n[n.length - 1].tagid,
					r = t.currentDayIndex + 1;
				if (r < e.length)
					for (var s = r; s < e.length && ((i = e[s].city_list) && i.length && i[0].tagid == o); s++) r = s;
				else r--;
				return r
			}, t.checkoutDay = t.getNextIndex(), t.submit = function(e) {
				if (e.preventDefault(), void 0 === t.hotel.hotel_id) return void a.showTip("请输入酒店名称！");
				if (t.checkoutDay <= t.checkinDay) return void a.showTip("退房时间必须在入住时间之后！");
				if (t.submiting) return void a.showTip("正在保存，请勿重复提交!");
				t.submiting = !0, t.price = parseFloat(t.price).toFixed(2);
				var i = {
						pid: t.hotel.hotel_id,
						cn_name: t.hotel.cn_name,
						en_name: t.hotel.en_name,
						pic: t.hotel.image,
						inDay: t.days[t.checkinDay].id,
						outDay: t.days[t.checkoutDay].id,
						currency: t.currency,
						counts: t.count,
						spend: t.price,
						position_type: t.hotel.hotel_id > 0 ? 1 : 2,
						lat: t.hotel.hotel_id > 0 ? null : t.lat,
						lng: t.hotel.hotel_id > 0 ? null : t.lng,
						useraddress: t.useraddress
					},
					o = a.rafill_reason;
				a.rafill_reason = null, n.addHotel({
					data: {
						plan_id: n.getPlanId(),
						cover: t.hotelImgCustom,
						oneday_id: a.selectedDay.object.id,
						rafill_reason: o,
						hotel: i,
						note: {
							content: t.note.content,
							images: []
						}
					},
					onSuccess: function(e) {
						a.scrBottom = !0, a.selectedDay.index >= t.checkinDay && a.selectedDay.index < t.checkoutDay && (a.setSelectedDay(), a.addHotelCallback && a.addHotelCallback(e.data)), t.closeThisDialog()
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error"), t.$apply(function() {
							t.submiting = !1
						})
					}
				})
			}, t.showMap = function(n) {
				e(n.target).hasClass("disabled") || (t.isShowMap = !0, e("#add-hotel-map").show(), o || a.createSelectMarker("add-hotel-map", function(e) {
					o = e, a.resizePopup()
				}, function() {
					var e = o.getData();
					t.$apply(function() {
						t.lat = e.lat, t.lng = e.lng, t.useraddress = e.address
					})
				}, {
					lat: a.selectedCity.lat,
					lng: a.selectedCity.lng
				}), a.resizePopup(), qyerUtil.doTrackCode("Planv3-popup-addhotel-markmap"), n.preventDefault())
			}, t.hideMap = function(n) {
				t.isShowMap = !1, e("#add-hotel-map").hide(), a.resizePopup(), n.preventDefault()
			}, requirejs(["web_qui_quiselect", "web_old_textarea", "web_old_inputautocomplete"], function(i) {
				var o = (new i({
					target: "#hotel-start-date-select",
					exClassName: "full",
					onChange: function(n) {
						t.checkinDay = parseInt(e(n).attr("data-value"))
					}
				}), new i({
					target: "#hotel-end-date-select",
					exClassName: "full",
					onChange: function(n) {
						t.checkoutDay = parseInt(e(n).attr("data-value"))
					}
				}), new i({
					target: "#hotel-currency-select",
					exClassName: "currency",
					template: '<li class="qui-select-item{{if data.selected}} qui-select-item-active{{/if}}" data-value="{{data.value}}" data-text="{{data.text}}" title="{{data.text}}">{{data.text}}</li>'
				}), new i({
					target: "#hotel-room-count-select",
					exClassName: "room-count"
				}), e(".add-hotel #hotelInput"));
				o.qyerAutocomplete({
					isAllowEmptySeach: !0,
					isFocusedSeach: !0,
					autoSelect: !0,
					isBlurSelect: !0,
					onSearch: function() {
						var i = e.trim(this.value),
							r = a.selectedDay.object.city_list;
						n.searchHotel({
							data: {
								plan_id: n.getPlanId(),
								oneday_id: a.selectedDay.object.id,
								city_id: r.length > 0 ? r[r.length - 1].tagid : null,
								keyword: i
							},
							onSuccess: function(e) {
								var n = ['<div class="search-hotel-list">'];
								i || n.push('<div class="search-title">为您推荐</div>'), n.push('<ul class="qui-inputAutocomplete-ul">'), e.data.forEach(function(e, t) {
									var i = '<li data-index="' + t + '"><span>' + [e.en_name, e.cn_name].join(" ") + '</span><span class="right">' + e.city_name + "酒店</span></li>";
									n.push(i)
								}), t.results = e.data, i && n.push('<li class="custom" data-index="-1" data-name="' + i + '">创建自定义酒店“' + a.encodeHTML(i) + "”</li>"), n.push("</ul>"), n.push("</div>"), o.qyerAutocomplete("pushHTML", n.join(""))
							},
							onError: function(e) {
								var t, n = ['<div class="search-hotel-list">'];
								t = e.data && e.data.msg ? e.data.msg : "搜索无结果", n.push('<div class="search-title">' + t + "</div>"), n.push('<ul class="qui-inputAutocomplete-ul">'), i && n.push('<li class="custom" data-id="-1" data-name="' + i + '">创建自定义酒店“' + i + "”</li>"), n.push("</ul>"), n.push("</div>"), o.qyerAutocomplete("pushHTML", n.join(""))
							}
						})
					},
					onSelect: function(n) {
						var i = parseInt(n.getAttribute("data-index"));
						i > -1 ? (t.hotelCustom = !1, t.hotel = t.results[i]) : (t.hotelCustom = !0, t.addImageCustom = function() {
							e("#hotel_cover").trigger("click")
						}, t.hotel = {
							hotel_id: 0,
							cn_name: n.getAttribute("data-name"),
							en_name: "",
							cover: t.customHotelKey
						}), t.$apply(function() {
							t.inputState = !1
						})
					}
				}), e("#hotel-currency-select").change(function() {
					console.log(this.value)
				}), e(".add-hotel .textarea-wrapper").qyerTextArea({
					max: 3e3
				}), a.resizePopup(), t.pricekeyup = function(n) {
					var i = e(n.target);
					if (i.val()) {
						var a = i.val().replace(/([0-9]+\.[0-9]{2})[0-9]*/, "$1");
						a = a.replace(/[\u4e00-\u9fa5]/gi, ""), i.val(a), t.price = i.val()
					}
				}, t.$on("$destroy", function() {
					a.rafill_reason = null, a.addHotelCallback = null
				})
			}), a.tmpSearchHotelKeyword && (t.hotel = {
				hotel_id: 0,
				cn_name: a.tmpSearchHotelKeyword,
				en_name: ""
			}, t.hotelCustom = !0, t.addImageCustom = function() {
				e("#hotel_cover").trigger("click")
			}, t.$apply(function() {
				t.inputState = !1
			}), a.tmpSearchHotelKeyword = null), t.hotelImgCustomShow = function() {
				return t.hotelImgCustom ? t.hotelImgCustom + "/80x80" : "//common3.qyerstatic.com/plan/desktop/edit3/img/hotelcustom.png"
			};
			var r = function() {
					t.$apply(function() {
						t.imgStatusCustom = "loading"
					})
				},
				s = function(e) {
					var n = new Image;
					n.src = e.origin_url + "/80x80", n.onload = function() {
						t.$apply(function() {
							t.hotelImgCustom = e.origin_url, t.imgStatusCustom = "default"
						})
					}
				},
				l = function() {
					t.$apply(function() {
						t.imgStatusCustom = "error"
					})
				};
			a.uploadPlanPic({
				browse_button: "hotel_cover",
				container: "add-hotel",
				paths: ["plan", "custom", "hotel", "cover"],
				BeforeUpload: r,
				FileUploaded: s,
				UploadError: l
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-day-details.add-note", []).controller("AddNoteController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			t.service = i, t.message = "", t.images = [], t.imgStatus = "default", t.isLogin = i.isLogin, t.submit = function(a) {
				var o = e.trim(e(".add-note textarea").val());
				return "" == o ? (i.showTip("笔记内容不能为空!"), !1) : t.submiting ? void i.showTip("正在保存，请勿重复提交!") : (t.submiting = !0, n.addNote({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						message: o,
						images: t.images
					},
					onSuccess: function(n) {
						setTimeout(function() {
							e(".scroll-wrapper").animate({
								scrollTop: "1000000px"
							})
						}, 100), i.addSelectedDayNote({
							id: n.data.id,
							message: n.data.message,
							images: n.data.images
						}), t.closeThisDialog(), setTimeout(function() {
							e(window).resize()
						}, 0)
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error"), t.$apply(function() {
							t.submiting = !1
						})
					}
				}), void a.preventDefault())
			}, requirejs(["web_old_textarea"], function() {
				e(".add-note .textarea-wrapper").qyerTextArea({
					max: 3e3
				}), setTimeout(function() {
					i.resizePopup()
				}, 0)
			}), t.addImage = function() {
				e("#uploadImg").trigger("click")
			}, t.delImage = function(e, n) {
				requirejs(["web_old_slidconfirm"], function(i) {
					i.confirm({
						text: "确认删除图片",
						target: n.target,
						onOK: function() {
							t.$apply(function() {
								t.images.splice(e, 1), t.dirtyFlag = 1
							})
						}
					})
				}), n.preventDefault()
			};
			var a = function() {
					t.$apply(function() {
						t.imgStatus = "loading"
					})
				},
				o = function(e) {
					var n = new Image;
					n.src = e.origin_url + "/80x80", n.onload = function() {
						t.$apply(function() {
							var n = {
								url: e.origin_url
							};
							t.images.push(n), t.imgStatus = "default"
						})
					}
				},
				r = function() {
					t.$apply(function() {
						t.imgStatus = "error"
					})
				};
			i.uploadPlanPic({
				browse_button: "uploadImg",
				container: "add-note",
				paths: ["plan", "day", "note"],
				BeforeUpload: a,
				FileUploaded: o,
				UploadError: r
			}), t.showPic = function(e) {
				t.service.popData = e, t.service.popShow("showPic")
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-day-details.add-poi", []).controller("AddPOIController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			var a;
			i.selectedPoi ? (t.inputState = !1, t.poi = i.selectedPoi, i.selectedPoi = null) : (t.inputState = !0, t.poi = {}), t.imgStatusCustom = "default", t.isShowMap = !1, t.results = [], t.currencyList = n.getCurrencyList(), t.starthours = -1, t.startminutes = -1, t.endhours = -1, t.endminutes = -1, t.imgCustom = "", t.submit = function(e) {
				if (e.preventDefault(), void 0 === t.poi.id) return void i.showTip("请输入目的地！");
				if (t.submiting) return void i.showTip("正在保存，请勿重复提交!");
				t.submiting = !0;
				var a = {
					pid: t.poi.id,
					cn_name: t.poi.cn_name,
					en_name: t.poi.en_name,
					address: "",
					catetypeid: parseInt(t.poi.cateid || t.poi.catetypeid),
					starthours: t.starthours,
					startminutes: t.startminutes,
					endhours: t.endhours,
					endminutes: t.endminutes,
					spend: t.spend,
					currency: t.currency,
					counts: parseInt(t.counts),
					positiontype: t.poi.id > 0 ? 1 : 2,
					useraddress: t.useraddress,
					lat: t.poi.id > 0 ? null : t.lat,
					lng: t.poi.id > 0 ? null : t.lng
				};
				n.addPOI({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						poi: a,
						cover: t.imgCustom,
						note: {
							content: t.content,
							images: []
						}
					},
					onSuccess: function(e) {
						i.setSelectedDay(), e.data.city && i.broadcast("auto-add-city", e.data.city), t.closeThisDialog()
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error"), t.$apply(function() {
							t.submiting = !1
						})
					}
				})
			}, t.changePOI = function(n) {
				var i = e(n.target).siblings("input").val(t.poi.cn_name + " " + t.poi.en_name);
				t.inputState = !0, setTimeout(function() {
					i.focus().select()
				}, 1)
			}, t.showEndTime = function(t) {
				requirejs(["web_qui_quiselect"], function(n) {
					e(t.target).closest(".label").hide().siblings().show();
					new n({
						target: "#poi-end-hour-select",
						exClassName: "half"
					}), new n({
						target: "#poi-end-minute-select",
						exClassName: "half"
					});
					i.resizePopup()
				}), t.preventDefault()
			}, t.showMap = function(n) {
				e(n.target).hasClass("disabled") || (t.isShowMap = !0, e("#add-poi-map").show(), a || i.createSelectMarker("add-poi-map", function(e) {
					a = e, i.resizePopup()
				}, function() {
					var e = a.getData();
					t.$apply(function() {
						t.lat = e.lat, t.lng = e.lng, t.useraddress = e.address
					})
				}, {
					lat: i.selectedCity.lat,
					lng: i.selectedCity.lng
				}), i.resizePopup(), qyerUtil.doTrackCode("Planv3-popup-addpoi-markmap"), n.preventDefault())
			}, t.hideMap = function(n) {
				t.isShowMap = !1, e("#add-poi-map").hide(), i.resizePopup(), n.preventDefault()
			}, requirejs(["web_qui_quiselect", "web_old_textarea", "web_old_inputautocomplete"], function(a) {
				var o, r, s = new a({
						target: "#poi-type-select",
						exClassName: "full",
						disabled: !0,
						template: '<li class="qui-select-item{{if data.selected}} qui-select-item-active{{/if}}"data-value="{{data.value}}" data-text="{{data.text}}"><em class="icon {{data.class}}-small"></em>{{data.text}}</li>'
					}),
					l = (new a({
						target: "#poi-start-hour-select",
						exClassName: "half"
					}), new a({
						target: "#poi-start-minute-select",
						exClassName: "half"
					}), new a({
						target: "#poi-currency-select",
						exClassName: "currency"
					}), new a({
						target: "#poi-ticket-count-select",
						exClassName: "ticket-count"
					}), e(".add-poi .head input"));
				s.setConfig({
					disabled: !0
				}), l.qyerAutocomplete({
					isAllowEmptySeach: !0,
					isFocusedSeach: !0,
					autoSelect: !0,
					isBlurSelect: !0,
					onSearch: function() {
						var a, s = e.trim(this.value);
						clearTimeout(o), o = setTimeout(function() {
							r = a = (new Date).getTime(), n.searchPOI({
								data: {
									plan_id: n.getPlanId(),
									oneday_id: i.selectedDay.object.id,
									city_id: (i.selectedDay.object.city_list || []).map(function(e) {
										return e.tagid
									}),
									keyword: s
								},
								onSuccess: function(e) {
									if (a == r) {
										e.data || (e.data = []);
										var n = ['<div class="search-poi-list">'];
										s || n.push('<div class="search-title">猜你想去</div>'), n.push('<ul class="qui-inputAutocomplete-ul">'), e.data.forEach(function(e, t) {
											var i = '<li data-index="' + t + '"><span>' + [e.cn_name, e.en_name].join(" ") + '</span><span class="right">' + e.city_name + "景点</span></li>";
											n.push(i)
										}), t.results = e.data, s && n.push('<li class="custom" data-index="-1" data-name="' + s + '">创建自定义游玩“' + i.encodeHTML(s) + "”</li>"), n.push("</ul>"), n.push("</div>"), l.qyerAutocomplete("pushHTML", n.join(""))
									}
								}
							})
						}, 100)
					},
					onSelect: function(n) {
						if (n) {
							var i = parseInt(n.getAttribute("data-index"));
							i > -1 ? (t.poi = t.results[i], t.poiCustom = !1, s._$title.text({
								32: "景点",
								78: "美食",
								147: "购物",
								148: "体验",
								77: "交通"
							}[t.poi.cateid || t.poi.catetypeid] || "景点").attr("data-value", t.poi.cateid || t.poi.catetypeid), s.setConfig({
								disabled: !0
							})) : (s.setConfig({
								disabled: !1
							}), t.poiCustom = !0, t.addImageCustom = function() {
								e("#poi_cover").trigger("click")
							}, t.poi = {
								id: 0,
								cn_name: n.getAttribute("data-name"),
								en_name: "",
								image: "",
								lat: 0,
								lng: 0,
								cateid: 32
							}, s._$title.text("景点").attr("data-value", 32)), t.$apply(function() {
								t.inputState = !1
							})
						}
					}
				}), e(".add-poi .textarea-wrapper").qyerTextArea({
					max: 3e3
				}), i.resizePopup(), i.tmpSearchPoiKeyword && (s.setConfig({
					disabled: !1
				}), s._$title.text("景点").attr("data-value", 32), t.poi = {
					id: 0,
					cn_name: i.tmpSearchPoiKeyword,
					en_name: "",
					image: "",
					lat: 0,
					lng: 0,
					cateid: 32
				}, t.poiCustom = !0, t.addImageCustom = function() {
					e("#poi_cover").trigger("click")
				}, t.$apply(function() {
					t.inputState = !1
				}), i.tmpSearchPoiKeyword = null)
			}), t.spendkeyup = function(n) {
				var i = e(n.target);
				if (i.val()) {
					var a = i.val().replace(/([0-9]+\.[0-9]{2})[0-9]*/, "$1");
					a = a.replace(/[\u4e00-\u9fa5]/gi, ""), i.val(a), t.spend = i.val()
				}
			}, t.imgCustomShow = function() {
				return t.imgCustom ? t.imgCustom + "/80x80" : "//common3.qyerstatic.com/plan/desktop/edit3/img/poicustom.png"
			};
			var o = function() {
					t.$apply(function() {
						t.imgStatusCustom = "loading"
					})
				},
				r = function(e) {
					var n = new Image;
					n.src = e.origin_url + "/80x80", n.onload = function() {
						t.$apply(function() {
							t.imgCustom = e.origin_url, t.imgStatusCustom = "default"
						})
					}
				},
				s = function() {
					t.$apply(function() {
						t.imgStatusCustom = "error"
					})
				};
			i.uploadPlanPic({
				browse_button: "poi_cover",
				container: "add-poi",
				paths: ["plan", "custom", "poi", "cover"],
				BeforeUpload: o,
				FileUploaded: r,
				UploadError: s
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-day-details.add-traffic", []).controller("AddTrafficController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			function o(i) {
				var o = e(".add-traffic");
				requirejs(["web_qui_quiselect", "web_old_inputautocomplete"], function(r) {
					o.find(".start-city-input, .end-city-input").each(function() {
							var i = e(this),
								o = a.selectedDay.object.city_list;
							i.data("inited") || (i.data("inited", !0), i.qyerAutocomplete({
								isAllowEmptySeach: !0,
								isFocusedSeach: !0,
								autoSelect: !0,
								onSearch: function() {
									var t = e.trim(this.value);
									if (t) n.searchCity({
										data: {
											plan_id: n.getPlanId(),
											oneday_id: a.selectedDay.object.id,
											city_id: null,
											keyword: t
										},
										onSuccess: function(e) {
											var n = ['<div class="search-city-list full">'];
											n.push('<ul class="qui-inputAutocomplete-ul">'), e.data.forEach(function(e) {
												var t = '<li data-id="' + e.city_id + '" data-name="' + e.city_name + '"><span>' + a.encodeHTML(e.city_name) + "</span></li>";
												n.push(t)
											}), t && n.push('<li class="custom" data-id="-1" data-name="' + t + '">创建自定义城市“' + a.encodeHTML(t) + "”</li>"), n.push("</ul>"), n.push("</div>"), i.qyerAutocomplete("pushHTML", n.join(""))
										},
										onError: function(e) {
											var n, o = ['<div class="search-city-list">'];
											n = e.data && e.data.msg ? e.data.msg : "搜索无结果", o.push('<div class="search-title">' + n + "</div>"), o.push('<ul class="qui-inputAutocomplete-ul">'), t && o.push('<li class="custom" data-id="-1" data-name="' + t + '">创建自定义城市“' + a.encodeHTML(t) + "”</li>"), o.push("</ul>"), o.push("</div>"), i.qyerAutocomplete("pushHTML", o.join(""))
										}
									});
									else {
										var o = ['<div class="search-city-list full">'];
										o.push('<ul class="qui-inputAutocomplete-ul">'), a.getAllCities().forEach(function(e) {
											var t = '<li data-id="' + e.tagid + '" data-name="' + e.name + '"><span>' + e.name + "</span></li>";
											o.push(t)
										}), o.push("</ul>"), o.push("</div>"), i.qyerAutocomplete("pushHTML", o.join(""))
									}
								},
								onSelect: function(r) {
									var s, l = e.trim(this.value),
										c = r.getAttribute("data-id"),
										d = r.getAttribute("data-name");
									if (this.value = d, i.hasClass("start-city-input")) {
										if (s = parseInt(i.attr("id").replace("start-city-input-", "")), t.$apply(function() {
											t.traffics[s].fromplaceid = c, t.traffics[s].fromplace = d
										}), o && o.length)
											for (var u = 0; u < o.length; u++)
												if (o[u].tagid == c && u != o.length) {
													s = parseInt(e(".end-city-input").eq(0).attr("id").replace("end-city-input-", "")), t.$apply(function() {
														t.traffics[s].toplaceid = o[u + 1].tagid, t.traffics[s].toplace = o[u + 1].name
													});
													break
												}
									} else s = parseInt(i.attr("id").replace("end-city-input-", "")), t.$apply(function() {
										t.traffics[s].toplaceid = c, t.traffics[s].toplace = d
									});
									l && n.city2citytraffic({
										data: {
											from_cityid: t.traffics[s].fromplaceid,
											from_cityname: t.traffics[s].fromplace,
											to_cityid: t.traffics[s].toplaceid,
											to_cityname: t.traffics[s].toplace
										},
										onSuccess: function(e) {
											t.$apply(function() {
												t.traffics[s].recommendTraffics = e.data || []
											})
										},
										onError: function(e) {
											a.showTip(e.data.msg, "error")
										}
									})
								}
							}), u.push(i))
						}), o.find(".start-poi-input, .end-poi-input").each(function() {
							var i, o = e(this);
							o.data("inited") || (o.data("inited", !0), o.qyerAutocomplete({
								isAllowEmptySeach: !0,
								isFocusedSeach: !0,
								autoSelect: !0,
								onSearch: function() {
									var r = e.trim(this.value),
										s = e(this).attr("data-cityid");
									i = o.hasClass("start-poi-input") ? o.attr("id").replace("start-poi-input-", "") : o.attr("id").replace("end-poi-input-", ""), n.searchStation({
										data: {
											plan_id: n.getPlanId(),
											oneday_id: a.selectedDay.object.id,
											city_id: s,
											keyword: r,
											tripmode: t.traffics[i].tripmode
										},
										onSuccess: function(e) {
											var t = ['<div class="search-station-list">'];
											r || t.push('<div class="search-title">猜你想去</div>'), t.push('<ul class="qui-inputAutocomplete-ul">'), e.data.forEach(function(e) {
												var n = '<li data-id="' + e.id + '" data-enname="' + e.en_name + '" data-cnname="' + e.cn_name + '"><span>' + a.encodeHTML(e.cn_name) + "</span></li>";
												t.push(n)
											}), r && t.push('<li class="custom" data-id="-1" data-cnname="' + r + '">创建自定义地点“' + a.encodeHTML(r) + "”</li>"), t.push("</ul>"), t.push("</div>"), o.qyerAutocomplete("pushHTML", t.join(""))
										},
										onError: function(e) {
											var t, n = ['<div class="search-station-list">'];
											t = e.data && e.data.msg ? e.data.msg : "搜索无结果", n.push('<div class="search-title">' + t + "</div>"), n.push('<ul class="qui-inputAutocomplete-ul">'), r && n.push('<li class="custom" data-id="-1" data-cnname="' + r + '">创建自定义地点“' + a.encodeHTML(r) + "”</li>"), n.push("</ul>"), n.push("</div>"), o.qyerAutocomplete("pushHTML", n.join(""))
										}
									})
								},
								onSelect: function(e) {
									var n, i = e.getAttribute("data-id"),
										a = e.getAttribute("data-cnname");
									e.getAttribute("data-enname");
									o.hasClass("start-poi-input") ? (n = o.attr("id").replace("start-poi-input-", ""), t.traffics[n].frompoiid = i, t.traffics[n].frompoi = a, t.traffics[n].frompositiontype = -1 == i ? 2 : 1) : (n = o.attr("id").replace("end-poi-input-", ""), t.traffics[n].topoiid = i, t.traffics[n].topoi = a, t.traffics[n].topositiontype = -1 == i ? 2 : 1), o.val(a), t.$apply()
								}
							}), u.push(o))
						}), o.find(".traffic-type-select:visible").each(function(t, n) {
							var i = new r({
								target: "#" + n.id,
								exClassName: "full"
							});
							e(n).data("control", i)
						}), o.find(".start-day-select:visible, .end-day-select:visible").each(function(t, n) {
							var i = new r({
								target: "#" + n.id,
								exClassName: "half"
							});
							e(n).data("control", i)
						}),
						o.find(".start-hour-select:visible, .start-minute-select:visible, .end-hour-select:visible, .end-minute-select:visible").each(function(t, n) {
							var i = new r({
								target: "#" + n.id,
								exClassName: "quarter"
							});
							e(n).data("control", i)
						}), i && i()
				})
			}

			function r() {
				return !0
			}

			function s(t, i, o) {
				var r = a.allDays.length;
				n.insertDay({
					data: {
						plan_id: n.getPlanId(),
						index: r
					},
					onSuccess: function(r) {
						0 === r.data.city_list.length && r.data.city_list[0].id == i.id ? r.data.city_list[0].tagid = r.data.city_list[0].id : (r.data.city_list = [e.extend({}, i)], n.updateCityList({
							data: {
								plan_id: n.getPlanId(),
								oneday_id: r.data.id,
								truncate: 0,
								citys: [{
									tagid: i.tagid,
									name: i.name,
									type: 1
								}]
							}
						})), a.allDays.push(r.data), 1 === t ? o && o() : s(t - 1, i, o)
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error"), o && o()
					}
				})
			}

			function l(e, n) {
				t.traffic.today = a.allDays[e].id;
				var i = t.traffic_dom.find(".end-day-select").children().eq(e).text();
				t.traffic_dom.find(".end-day-select").next().find(".qui-select-title").text(i).next().find(".qui-select-item").eq(e).addClass("qui-select-item-active").siblings().removeClass("qui-select-item-active")
			}
			var c, d, u = [];
			t.service = a, t.currencyList = n.getCurrencyList(), t.currency = t.currencyList[0].unit_name, a.selectedTrafficData && a.isSelectedTrafficData ? (t.traffics = a.selectedTrafficData.traffics.map(function(t) {
					return e.extend({}, t, {
						starthours: parseInt(t.starthours),
						startminutes: parseInt(t.startminutes),
						endhours: parseInt(t.endhours),
						endminutes: parseInt(t.endminutes)
					})
				}), t.currency = a.selectedTrafficData.currency, t.cost = a.selectedTrafficData.price) : t.traffics = [{}], t.selectedDayId = a.selectedDay.object.id, t.getTimeString = function(e) {
					return e ? 0 == e || "0.00" == e ? "" : e < 60 ? "，平均用时" + e + "分钟" : "，平均用时" + (e / 60).toFixed(1) + "小时" : ""
				},
				function() {
					if (!a.isSelectedTrafficData && !a.selectedTrafficData) {
						var e = a.selectedDay.object.city_list;
						if (e && e.length && e.length > 1) {
							if (e[0].type == e[1].type == 1) {
								var i = t.traffics[0];
								i.fromplaceid = e[0].tagid, i.fromplace = e[0].name, i.toplaceid = e[1].tagid, i.toplace = e[1].name, n.city2citytraffic({
									data: {
										from_cityid: e[0].tagid,
										from_cityname: e[0].name,
										to_cityid: e[1].tagid,
										to_cityname: e[1].name
									},
									onSuccess: function(e) {
										t.$apply(function() {
											t.traffics[0].recommendTraffics = e.data || []
										})
									},
									onError: function(e) {
										a.showTip(e.data.msg, "error")
									}
								})
							}
						} else if (e && e.length && 1 == e.length) {
							var i = t.traffics[0];
							i.fromplaceid = e[0].tagid, i.fromplace = e[0].name
						}
					}
					a.selectedTrafficData && _.each(a.selectedTrafficData.traffics, function(e, i) {
						var o = a.selectedDay.object.city_list;
						if (o && o.length > 1 && "1" != a.selectedTrafficData.traffics[i].tripmode) {
							var r = t.traffics[0];
							r.fromplaceid && r.fromplace || r.toplaceid && r.toplace || o[0].type == o[1].type != 1 || (r.fromplaceid = o[0].tagid, r.fromplace = o[0].name, r.toplaceid = o[1].tagid, r.toplace = o[1].name), n.city2citytraffic({
								data: {
									from_cityid: r.fromplaceid,
									from_cityname: r.fromplace,
									to_cityid: r.toplaceid,
									to_cityname: r.toplace
								},
								onSuccess: function(e) {
									t.$apply(function() {
										t.traffics[i].recommendTraffics = e.data || []
									})
								},
								onError: function(e) {
									a.showTip(e.data.msg, "error")
								}
							})
						} else
							for (var r = 0; r < a.selectedTrafficData.traffics.length; r++) n.city2citytraffic({
								data: {
									from_cityid: a.selectedTrafficData.traffics[r].fromplaceid,
									from_cityname: a.selectedTrafficData.traffics[r].fromplace,
									to_cityid: a.selectedTrafficData.traffics[r].toplaceid,
									to_cityname: a.selectedTrafficData.traffics[r].toplace
								},
								onSuccess: function(e) {
									t.$apply(function() {
										t.traffics[i].recommendTraffics = e.data || []
									})
								},
								onError: function(e) {
									a.showTip(e.data.msg, "error")
								}
							})
					})
				}(), t.getDateString = function(e) {
					var t, o, r = n.getStartDate(),
						s = i("date");
					return r ? (o = new Date(r.getTime() + 864e5 * e), t = s(o, "M月d日") + "(" + ["日", "一", "二", "三", "四", "五", "六"][o.getDay()] + ")") : t = "第" + (e + 1) + "天", t + " " + a.allDays[e].city_list.map(function(e) {
						return e.name
					}).join("，")
				}, t.showMap = function(n, i, o) {
					var r, s, l, u, p = t.traffics[i];
					d = {
						traffic: p,
						type: o
					}, r = {
						lat: a.selectedCity.lat,
						lng: a.selectedCity.lng
					}, s = p[o + "poilat"] || r.lat, l = p[o + "poilng"] || r.lng, u = p[o + "poiaddress"] || "", c ? (e(n.target).closest(".row").next().is("#add-traffic-map") ? e("#add-traffic-map").toggle() : (e(n.target).closest(".row").after(e("#add-traffic-map").show()), c.reset(s, l, u)), a.resizePopup()) : (e(n.target).closest(".row").after(e("#add-traffic-map").show()), a.createSelectMarker("add-traffic-map", function(e) {
						c = e, void 0 === p[d.type + "poilat"] && void 0 === d.traffic[d.type + "poilng"] && (d.traffic[d.type + "poilat"] = c.lat, d.traffic[d.type + "poilng"] = c.lng, d.traffic[d.type + "poiaddress"] = c.address), a.resizePopup()
					}, function() {
						var e = c.getData();
						d.traffic[d.type + "poilat"] = e.lat, d.traffic[d.type + "poilng"] = e.lng, d.traffic[d.type + "poiaddress"] = e.address
					}, r))
				}, t.submit = function(e) {
					if (e.preventDefault(), r()) {
						if (t.submiting) return void a.showTip("正在保存，请勿重复提交!");
						t.submiting = !0, n.addTraffic({
							data: {
								plan_id: n.getPlanId(),
								oneday_id: a.selectedDay.object.id,
								currency: t.currency,
								price: t.cost,
								count: t.count,
								traffics: t.traffics,
								rafill_reason: a.rafill_reason,
								note: {
									images: [],
									content: t.content
								}
							},
							onSuccess: function(e) {
								a.scrBottom = !0, a.setSelectedDay(), t.closeThisDialog()
							},
							onError: function(e) {
								a.showTip(e.data.msg, "error"), t.$apply(function() {
									t.submiting = !1
								})
							}
						})
					}
				}, t.addTrafficItem = function(e) {
					if (e.preventDefault(), t.traffics && t.traffics.length >= 5) return void a.showTip("最多添加5段交通", "error");
					var n = t.traffics[t.traffics.length - 1];
					t.traffics.push({
						fromplaceid: n.toplaceid || "",
						fromplace: n.toplace || "",
						toplaceid: "",
						toplace: "",
						fromday: n.today,
						today: n.today
					}), setTimeout(function() {
						o(), a.resizePopup()
					}, 0)
				}, t.removeTrafficItem = function(e, n) {
					e.preventDefault(), t.traffics.splice(n, 1), setTimeout(function() {
						o(), a.resizePopup()
					}, 0)
				}, requirejs(["web_qui_quiselect", "web_old_textarea"], function(t) {
					new t({
						target: "#traffic-currency-select",
						exClassName: "currency"
					}), new t({
						target: "#traffic-ticket-count-select",
						exClassName: "ticket-count"
					});
					e(".add-traffic .textarea-wrapper").qyerTextArea({
						max: 3e3
					}), o(), a.resizePopup()
				}), t.traffic_dom = "", t.traffic = "", t.service.setTrafficFlightItem = function(n) {
					var n = n,
						i = t.traffic_dom,
						r = n.departure.time.split(":"),
						c = n.arrival.time.split(":"),
						d = null;
					t.traffic.traffic_number = n.flight, t.traffic.fromplaceid = n.departure.id, t.traffic.fromplace = n.departure.city, t.traffic.frompoiid = n.departure.poi_id, t.traffic.frompoi = n.departure.poiname, t.traffic.frompoilat = n.departure.lat, t.traffic.frompoilng = n.departure.lng, t.traffic.frompositiontype = n.departure.poi_id > 0 ? 1 : 2, t.traffic.starthours = parseInt(r[0]), t.traffic.startminutes = parseInt(r[1]), t.traffic.toplaceid = n.arrival.id, t.traffic.toplace = n.arrival.city, t.traffic.topoiid = n.arrival.poi_id, t.traffic.topoi = n.arrival.poiname, t.traffic.topoilat = n.arrival.lat, t.traffic.topoilng = n.arrival.lng, t.traffic.topositiontype = n.departure.poi_id > 0 ? 1 : 2, t.traffic.endhours = parseInt(c[0]), t.traffic.endminutes = parseInt(c[1]), i.find(".start-hour-select").next().find(".qui-select-title").text(r[0]), i.find(".start-minute-select").next().find(".qui-select-title").text(r[1]), i.find(".end-hour-select").next().find(".qui-select-title").text(c[0]), i.find(".end-minute-select").next().find(".qui-select-title").text(c[1]), n.arrival.day > 0 ? (a.allDays.forEach(function(e, n) {
						e.id == t.traffic.fromday && (d = n)
					}), null !== d && (d += n.arrival.day, d > a.allDays.length - 1 ? a.showConfirm2("到达日期已超出行程，将该日添加到行程中", function() {
						var i = d - a.allDays.length + 1,
							r = e("<div>", {
								class: "mask",
								style: "z-index:100;background:none"
							}).appendTo(document.body);
						a.showLoadingTip("正在添加中..."), s(i, {
							tagid: n.arrival.id,
							name: n.arrival.city,
							type: 1,
							lat: n.arrival.lat,
							lng: n.arrival.lng
						}, function() {
							t.$apply(), e(".add-traffic .end-day-select, .add-traffic .start-day-select").show().next().remove(), o(function() {
								l(d)
							}), a.hideLoadingTip(), r.remove()
						})
					}, function() {
						l(a.allDays.length - 1)
					}) : l(d))) : t.traffic.today = t.traffic.fromday
				}, e(document.body).on("change.flight-number", ".add-traffic input.flight-number", function(o) {
					var r = o.target,
						s = e.trim(this.value),
						l = n.getStartDate(),
						c = i("date"),
						d = null;
					t.traffic_dom = e(r).closest(".traffic-item"), s && (l && (d = new Date(l.getTime() + 864e5 * a.selectedDay.index)), t.traffic = t.traffics[e(r).attr("data-index")], "1" == t.traffic.tripmode && n.getFlightList({
						data: {
							flight_no: s,
							date: d ? c(d, "y-M-d") : null
						},
						onSuccess: function(e) {
							e.data.length > 1 ? t.$apply(function() {
								t.service.popData = e.data, t.service.popShow("flight")
							}) : t.$apply(function() {
								t.service.setTrafficFlightItem(e.data[0])
							})
						},
						onError: function(e) {}
					}))
				}), t.$on("$destroy", function() {
					for (a.rafill_reason = null; u.length;) try {
						u.shift().qyerAutocomplete("destroy")
					} catch (e) {
						console.log(e)
					}
					e(document.body).off("change.flight-number")
				}), t.costkeyup = function(n) {
					var i = e(n.target);
					if (i.val()) {
						var a = i.val().replace(/([0-9]+\.[0-9]{2})[0-9]*/, "$1");
						a = a.replace(/[\u4e00-\u9fa5]/gi, ""), i.val(a), t.cost = i.val()
					}
				}
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-day-details", ["ui.sortable", "ngSanitize", "planner-api", "planner-day-details.notes", "planner-day-details.add-note", "planner-day-details.add-poi", "planner-day-details.add-hotel", "planner-day-details.add-traffic", "planner-day-details.optimize-fill", "planner-day-details.optimize-one-day", "planner-day-details.optimize-hotel", "planner-day-details.optimize-plan"]).directive("plannerDayDetails", [
		function() {
			return {
				restrict: "C",
				template: '<div ng-controller="DayDetailsController" class="inner"><div class="loading-mask" ng-if="loading">操作中, 请稍后...</div><div class="details-header"><h2><a id="header-date-picker" href="#" data-help-index="10" data-help-direction="right" data-help-content="点击这里修改行程日期">{{getDate() | date:\'M月d日\'}}</a></h2><div class="cities clearfix" ng-model="day.city_list" ui-sortable="citySortableOptions"><div class="item" ng-repeat="city in day.city_list" ng-class="getCityClass($last, (city.tagid <= 0))" data-id="{{city.tagid}}" data-name="{{city.name}}" style="{{ city.type==0?\'cursor:default;\':\'\' }}"><span ng-click="changeSelectedCity(city)">{{city.name}}</span><div class="delimiter" ng-mouseover="showRecommendTraffic($event)" ng-mouseout="hideRecommendTraffic($event)">&gt;</div><a href="#" class="close" ng-click="removeCity($index)">删除城市</a></div><span class="empty" ng-if="!day.city_list || day.city_list.length === 0">暂无城市安排</span><div class="item add-city" ng-if="day.city_list.length < 10"><span ng-click="addCity($event)" ng-show="day.city_list&&day.city_list.length<10" data-help-index="1" data-help-direction="right" data-help-content="点击这里添加城市，将鼠标移到城市上，可以删除城市，拖动城市可以换序">+增加城市</span><input class="input-city" placeholder="请输入城市..." type="text"></div></div><div class="controls" ng-class="{true:\'mini\'}[service.mode == \'map\']"><div class="hours" ng-if="total_hours == 0"></div><div id="js_total_hoursBgCss" class="hours" ng-if="total_hours > 0" >{{total_hours}}h</div><div class="status" ng-if="total_hours >= 11">紧凑</div><div class="status" ng-if="total_hours >= 7 && total_hours < 11">适中</div><div class="status" ng-if="total_hours < 7">宽松</div><a class="edit iconfont" href="#" slide-dropdown="editOptions" data-bn-ipg="Planv3-mid-edit" alt="编辑" data-help-index="7" data-help-direction="right" data-help-content="点击这里直接手动添加，可以自定义哦">&#59019;</a><a class="recommend hotel-first" href="#" ng-click="optimizeHotel()" data-bn-ipg="Planv3-mid-recommend-hotel"><em class="iconfont">&#xe65a;</em><span>智能推荐酒店</span></a><a class="recommend optimize-menu" href="#" slide-dropdown="recommendOptions" data-bn-ipg="Planv3-mid-recommend"><em class="iconfont">&#xe65b;</em><span>智能优化</span><i class="triangle"></i></a><a class="recommend hotel-last" href="#" ng-click="optimizeHotel()" data-bn-ipg="Planv3-mid-recommend-hotel"><em class="iconfont">&#xe65a;</em><span>智能推荐酒店</span></a></div><div class="recommend-traffic" ><p><span ng-if="recommendTraffics[0].distance || recommendTraffics[0].distance == \'0\'">距离{{recommendTraffics[0].distance}}KM</span><span ng-if="recommendTraffics[0].percent">，{{recommendTraffics[0].percent}} %用户选择了{{[\'\', \'飞机\', \'火车\', \'大巴\', \'租车\', \'轮船\', \'其他\'][recommendTraffics[0].tripmode]}}</span></p><ul><li ng-repeat="traffic in recommendTraffics"><p ng-if="traffic.percent"><span class="icon" ng-class="[\'\', \'plane-blue\', \'train-blue\', \'bus-blue\', \'car-blue\', \'boat-blue\', \'other-blue\'][traffic.tripmode]" ng-if="traffic.tripmode"></span><span>{{traffic.percent}}%用户选择了{{[\'\', \'飞机\', \'火车\', \'大巴\', \'租车\', \'轮船\', \'其他\'][traffic.tripmode]}} {{getTimeString(traffic.avg_time)}} {{traffic.avg_spend?("，花费"+ traffic.avg_spend +"人民币"):""}}</span></p></li></ul></div>\x3c!-- <div class="recommend-traffic" ng-if="recommendTraffics.length==0"><p>坐标位置缺失。</p></div> --\x3e</div><div class="details-empty" ng-if="(!service.place_list || service.place_list.length === 0) && !loading_details">本日还未安排行程</div><div class="details-empty" ng-if="(!service.place_list || service.place_list.length === 0) && loading_details">{{loading_text}}</div><div class="details-body" ng-if="service.place_list.length > 0"><div class="select-all"><a href="#" class="checkbox">全选</a><span>全选</span></div><div ng-if="service.yesterday_hotel && !service.yesterday_hotel.href" class="hotel-card"><div class="box">前晚<br>住宿</div><span>{{service.yesterday_hotel.cn_name || service.yesterday_hotel.en_name}}</span><div class="dotted" style="left: 34px; bottom: 8px;"></div></div><a ng-if="service.yesterday_hotel && service.yesterday_hotel.href" href="{{service.yesterday_hotel.href}}" target="_blank" class="hotel-card"><div class="box">前晚<br>住宿</div><span>{{service.yesterday_hotel.cn_name || service.yesterday_hotel.en_name}}</span><div class="dotted" style="left: 34px; bottom: 8px;"></div></a>\x3c!-- @@@@@ 前晚住宿的交通 @@@@@ --\x3e<div class="traffic hotel-traffic" ng-if="service.yesterday_hotel && hotel_traffic[0] && !hotel_traffic[0].empty"        ng-click="viewPath(-1)" ng-class="{active: viewPathIndex == -1}" data-bn-ipg="Planv3-mid-p2p-click" data-help-index="6" data-help-direction="right" data-help-content="大力点这里哦。（位置缺失的情况下，无法查询交通方案）" data-help-left-offset="-20"><div class="icon">{{{walking: \'&#xe6c7;\', driving: \'&#xe6c6;\', transit: \'&#xe6c5;\'}[hotel_traffic[0].tripmode] || \'&#58884;\'}}</div><span ng-if="hotel_traffic[0].distance">{{hotel_traffic[0].distance}}km</span><span ng-if="!hotel_traffic[0].distance">暂无数据</span><span class="right">选择交通方案</span></div><div class="traffic hotel-traffic" ng-if="service.yesterday_hotel && hotel_traffic[0] && hotel_traffic[0].empty" data-help-index="6" data-help-direction="right" data-help-content="大力点这里哦。（位置缺失的情况下，无法查询交通方案）" data-help-left-offset="-20"><span class="icon">&#58884;</span><span>地理位置信息缺失</span></div><div class="traffic hotel-traffic" ng-if="service.yesterday_hotel && !hotel_traffic[0]" data-help-index="6" data-help-direction="right" data-help-content="大力点这里哦。（位置缺失的情况下，无法查询交通方案）" data-help-left-offset="-20"><span class="icon">&#58884;</span><span>正在计算中...</span></div>\x3c!-- ##### 前晚住宿的交通 ##### --\x3e<div class="places" ng-model="service.place_list" ui-sortable="placeSortableOptions"><div class="place-wrapper" ng-repeat="place in service.place_list"><div class="checkbox-wrapper"><a href="#" class="checkbox" data-id="{{place.id}}" data-type="{{place.type}}" data-index="{{$index}}">选择</a></div><a class="place" ng-click="viewDetails($event, place, \'view\', (place.type == 2 && place.pid > 0))" href="{{place.href || \'#\'}}" data-bnb="{{place.source}}" target="_blank" ng-mouseenter="service.startPinAnimation($event, place.id)" ng-mouseleave="service.stopPinAnimation($event, place.id)" ng-class="{true:\'active\'}[place.active]"><div class="pin" ng-class="getCardIconClass(place.type,place.tripmode,place.cateid)" ><div class="dotted" style="top: -16px;" ng-if="!$first"></div><div class="iconfont" ng-class="{false: \'black\'}[place.tripmode == 7  || place.sameday]" ng-bind-html="getCardIcon(place)"></div><div class="dotted" style="bottom: -18px;" ng-if="!$last"></div></div><div ng-if="place.type === 3 && place.tripmode !== 7" class="place__traffic"><div class="start" ng-class="{\'@all\':\'current\',\'from\':\'current\'}[place.display]"><div ng-if="place.from.starthours > -1 || place.from.startminutes > -1">{{getEventTimeString(place.from.starthours,place.from.startminutes)}}</div><div ng-bind-html="place.from.cn_name || place.from.en_name" class="name"></div><div ng-if="place.from.traffic_poiname" ng-bind-html="place.from.traffic_poiname"></div></div><div class="mid"><div class="iconfont" ng-bind-html="getTrafficIco(place.tripmode)"></div><div ng-if="mode != \'map\' && place.traffic_number" ng-bind-html="place.traffic_number"></div></div><div class="end" ng-class="{\'@all\':\'current\',\'to\':\'current\'}[place.display]"><div ng-if="place.to.endhours > -1 || place.to.endminutes > -1">{{getEventTimeString(place.to.endhours,place.to.endminutes)}}</div><div ng-bind-html="place.to.cn_name || place.to.en_name" class="name"></div><div ng-if="place.to.traffic_poiname" ng-bind-html="place.to.traffic_poiname"></div></div></div><h3 ng-if="place.type === 3 && place.tripmode === 7 && place.display == \'from\'" ng-class="{true: \'one-line\'}[place.from.starthours == -1 && place.from.startminutes == -1]" ><span>取车：</span><span ng-bind-html="place.from.cn_name || place.from.en_name"></span><span ng-if="place.from.traffic_poiname">&nbsp;(</span><span ng-if="place.from.traffic_poiname" ng-bind-html="place.from.traffic_poiname"></span><span ng-if="place.from.traffic_poiname">)</span></h3><h3 ng-if="place.type === 3 && place.tripmode === 7 && place.display == \'to\'" ng-class="{true: \'one-line\'}[place.to.endhours < 0 && place.to.endminutes < 0]" ><span>还车：</span><span ng-bind-html="place.to.cn_name || place.to.en_name"></span><span ng-if="place.to.traffic_poiname">&nbsp;(</span><span ng-if="place.to.traffic_poiname" ng-bind-html="place.to.traffic_poiname"></span><span ng-if="place.to.traffic_poiname">)</span></h3><p ng-if="place.type === 3 && place.tripmode === 7 && (place.display == \'from\') && !(place.from.starthours == -1 && place.from.startminutes == -1)"><span>取车时间：</span><span>{{getEventTimeString(place.from.starthours,place.from.startminutes)}}</span></p><p ng-if="place.type === 3 && place.tripmode === 7 && (place.display == \'to\') && !(place.to.endhours == -1 && place.to.endminutes == -1)"><span>还车时间：</span><span>{{getEventTimeString(place.to.endhours,place.to.endminutes)}}</span></p><h3 ng-if="place.type !== 3" ng-class="{true: \'one-line\'}[place.starthours < 0 && place.endhours < 0 && !place.spend && place.cateid!=1000]"><span ng-if="place.type == 3 && place.pair_id == 0">出发：</span><span ng-if="place.type == 3 && place.pair_id &gt; 0">到达：</span><span ng-bind-html="place.cn_name || place.en_name"></span><span ng-if="place.traffic_poiname">&nbsp;(</span><span ng-if="place.traffic_poiname" ng-bind-html="place.traffic_poiname"></span><span ng-if="place.traffic_poiname">)</span><em class="notes" ng-if="place.textsids">备注</em></h3><p ng-if="place.type !== 3" ><span ng-if="place.type == 1 && (place.starthours > -1 || place.startminutes > -1)">游玩时间：</span><span ng-if="place.type == 3 && (place.starthours > -1 || place.startminutes > -1)">取车时间：</span><span ng-if="place.starthours &gt; -1">{{place.starthours<10?("0"+place.starthours):place.starthours}}:{{place.startminutes > -1 ? (place.startminutes<10?("0"+place.startminutes):place.startminutes) : \'00\'}}</span><span ng-if="place.starthours == -1 && place.startminutes > -1">00:{{(place.startminutes < 10 ? \'0\' : \'\') + place.startminutes}}</span><span ng-if="place.type == 1 && (place.starthours > -1 || place.startminutes > -1) && (place.endhours > -1 || place.endminutes > -1)">-</span><span ng-if="place.type == 3 && place.endhours &gt; -1">还车时间：</span><span ng-if="place.endhours &gt; -1">{{place.endhours<10?("0"+place.endhours):place.endhours}}:{{place.endminutes > -1 ? (place.endminutes<10?("0"+place.endminutes):place.endminutes) : \'00\'}}</span><span ng-if="place.endhours == -1 && place.endminutes > -1">00:{{(place.endminutes < 10 ? \'0\' : \'\') + place.endminutes}}</span><span ng-if="(place.starthours &gt; -1 || (place.type == 3 && place.endhours &gt; -1)) && place.price">｜</span><span ng-if="place.spend && place.cateid != 1000 && place.type == 2">花费：{{place.currency}}{{place.spend}}</span><span ng-if="place.price && (place.cateid == 1000 || place.category == 1000)"><span class="list_price" ng-if="place.list_price">{{place.list_price}}</span><span class="spend_color">{{place.price}}</span>元起</span><span ng-if="place.ticketcount &gt; 1">×{{place.ticketcount}}</span></p><span class="delete iconfont" ng-click="deletePlace($event, $index)">&#59063;</span><div data-id="{{place.id}}" data-type="{{place.type}}" data-index="{{$index}}" class="edit iconfont" slide-dropdown="placeOptions" ng-if="$index > 0">&#59064;</div><div data-id="{{place.id}}" data-type="{{place.type}}" data-index="{{$index}}" class="edit iconfont" slide-dropdown="placeOptions" ng-if="$index == 0" data-help-index="8|11" data-help-step="2|1" data-help-direction="right|right" data-help-content="点击这里，然后选择“添加备注”|点击这里，然后选择“移动到”">&#59064;</div></a><div class="traffic" ng-if="!$last && traffic_list.length &gt; 0 && !traffic_list[$index].empty"          ng-click="viewPath($index)" ng-class="{active: viewPathIndex == $index, disabled: place.type == 3 && place.tripmode != 4 && place.tripmode != 7 && service.place_list[$index + 1].type == 3 && service.place_list[$index + 1].tripmode != 4 && service.place_list[$index + 1].tripmode != 7}" data-bn-ipg="Planv3-mid-p2p-click"  data-help-index="{{{true: 6}[$index==0 && !service.yesterday_hotel]}}" data-help-direction="{{{true:\'right\'}[$index==0 && !service.yesterday_hotel]}}" data-help-content="{{{true:\'大力点这里哦。（位置缺失的情况下，无法查询交通方案）\'}[$index==0 && !service.yesterday_hotel]}}" data-help-left-offset="{{{true: -20}[$index==0 && !service.yesterday_hotel]}}"><div class="icon">{{{walking: \'&#xe6c7;\', driving: \'&#xe6c6;\', transit: \'&#xe6c5;\'}[traffic_list[$index].tripmode] || \'&#58884;\'}}</div><span ng-if="traffic_list[$index].distance">{{traffic_list[$index].distance}}km</span><span ng-if="!traffic_list[$index].distance">暂无数据</span><span class="right">选择交通方案</span></div><div class="traffic" ng-if="!$last && traffic_list.length &gt; 0 && traffic_list[$index].empty"  data-help-index="{{{true: 6}[$index==0 && !service.yesterday_hotel]}}" data-help-direction="{{{true:\'right\'}[$index==0 && !service.yesterday_hotel]}}" data-help-content="{{{true:\'大力点这里哦。（位置缺失的情况下，无法查询交通方案）\'}[$index==0 && !service.yesterday_hotel]}}" data-help-left-offset="{{{true: -20}[$index==0 && !service.yesterday_hotel]}}"><span class="icon">&#58884;</span><span>地理位置信息缺失</span></div><div class="traffic" ng-if="!$last && traffic_list.length === 0"  data-help-index="{{{true: 6}[$index==0 && !service.yesterday_hotel]}}" data-help-direction="{{{true:\'right\'}[$index==0 && !service.yesterday_hotel]}}" data-help-content="{{{true:\'大力点这里哦。（位置缺失的情况下，无法查询交通方案）\'}[$index==0 && !service.yesterday_hotel]}}" data-help-left-offset="{{{true: -20}[$index==0 && !service.yesterday_hotel]}}"><span class="icon">&#58884;</span><span>正在计算中...</span></div></div></div>\x3c!-- @@@@@ 当晚住宿的交通 @@@@@ --\x3e<div class="traffic hotel-traffic" ng-if="service.today_hotel && hotel_traffic[1] && !hotel_traffic[1].empty"        ng-click="viewPath(-2)" ng-class="{active: viewPathIndex == -2}" data-bn-ipg="Planv3-mid-p2p-click" data-help-index="{{{true: 6}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-direction="{{{true:\'right\'}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-content="{{{true:\'大力点这里哦。（位置缺失的情况下，无法查询交通方案）\'}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-left-offset="{{{true: -20}[service.place_list.length < 2 && !service.yesterday_hotel]}}"><div class="icon">{{{walking: \'&#xe6c7;\', driving: \'&#xe6c6;\', transit: \'&#xe6c5;\'}[hotel_traffic[1].tripmode] || \'&#58884;\'}}</div><span ng-if="hotel_traffic[1].distance">{{hotel_traffic[1].distance}}km</span><span ng-if="!hotel_traffic[1].distance">暂无数据</span><span class="right">选择交通方案</span></div><div class="traffic hotel-traffic" ng-if="service.today_hotel && hotel_traffic[1] && hotel_traffic[1].empty" data-help-index="{{{true: 6}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-direction="{{{true:\'right\'}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-content="{{{true:\'大力点这里哦。（位置缺失的情况下，无法查询交通方案）\'}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-left-offset="{{{true: -20}[service.place_list.length < 2 && !service.yesterday_hotel]}}"><span class="icon">&#58884;</span><span>地理位置信息缺失</span></div><div class="traffic hotel-traffic" ng-if="service.today_hotel && !hotel_traffic[1]" data-help-index="{{{true: 6}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-direction="{{{true:\'right\'}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-content="{{{true:\'大力点这里哦。（位置缺失的情况下，无法查询交通方案）\'}[service.place_list.length < 2 && !service.yesterday_hotel]}}" data-help-left-offset="{{{true: -20}[service.place_list.length < 2 && !service.yesterday_hotel]}}"><span class="icon">&#58884;</span><span>正在计算中...</span></div>\x3c!-- ##### 当晚住宿的交通 ##### --\x3e<div ng-if="service.today_hotel && !service.today_hotel.href" class="hotel-card"><div class="box">当晚<br>住宿</div><span>{{service.today_hotel.cn_name || service.today_hotel.en_name}}</span><div class="dotted" style="left: 34px; top: 8px;"></div></div><a ng-if="service.today_hotel && service.today_hotel.href" href="{{service.today_hotel.href}}" target="_blank" class="hotel-card"><div class="box">当晚<br>住宿</div><span>{{service.today_hotel.cn_name || service.today_hotel.en_name}}</span><div class="dotted" style="left: 34px; top: 8px;"></div></a><div class="hotel-tip" slide-dropdown="addHotelOptions" ng-if="!loading_details && !has_hotels"><div class="icon"></div><span data-bn-ipg="Planv3-mid-nohotel-add">今天还没安排住宿，请点击添加</span></div></div><div class="details-footer"><a href="#" slide-dropdown="moveOptions" data-bn-ipg="Planv3-mid-group-moveto"><em class="move"></em>移动到<em class="triangle"></em></a><a href="#" class="delete" data-bn-ipg="Planv3-mid-group-delete"><em></em>删除</a><a href="#" class="close" data-bn-ipg="Planv3-mid-group-close"><em></em></a></div></div>'
			}
		}
	]).controller("DayDetailsController", ["$scope", "$api", "$filter", "plannerService",
		function(e, t, n, i) {
			function a() {
				F = setInterval(function() {
					e.loading_text = A.substr(0, O++), O > j && (O = 1), e.$apply()
				}, 250)
			}

			function o() {
				clearInterval(F)
			}

			function r(n) {
				$(".planner-day-details .inner").css({
					"padding-bottom": "35px"
				}), $(".details-body").addClass("editing"), $(".details-footer").addClass("show"), n.closest(".place-wrapper").find(".checkbox").addClass("checked"), 1 === $(".details-body .place-wrapper .checkbox").size() && $(".details-body .select-all .checkbox").addClass("checked"), $(".details-body").on("click", ".place-wrapper .checkbox", function(e) {
					e.preventDefault(), $(this).toggleClass("checked"), 0 === $(".details-body .place-wrapper .checkbox:not(.checked)").size() ? $(".details-body .select-all .checkbox").addClass("checked") : $(".details-body .select-all .checkbox").removeClass("checked"), 0 === $(".details-body .place-wrapper .checkbox.checked").size() ? $(".details-footer a:not(.close)").addClass("disabled") : $(".details-footer a:not(.close)").removeClass("disabled")
				}).on("click", ".select-all .checkbox", function(e) {
					var t = $(this).hasClass("checked");
					e.preventDefault(), $(".details-body .checkbox")[t ? "removeClass" : "addClass"]("checked"), $(".details-footer a:not(.close)")[t ? "addClass" : "removeClass"]("disabled")
				}), $(".details-footer").on("click", ".close", function(e) {
					e.preventDefault(), s(), i.hideDropdown()
				}).on("click", ".delete", function(n) {
					var a = this;
					n.preventDefault(), $(this).hasClass("disabled") || requirejs(["web_old_slidconfirm"], function(n) {
						n.confirm({
							text: "是否批量删除选中内容？",
							target: a,
							onOK: function() {
								var n = [],
									o = [];
								$(".details-body .checkbox-wrapper .checkbox.checked").each(function() {
									var t = $(this);
									n.push(e.service.place_list[t.attr("data-index")]), o.push($(".place-wrapper").get(t.attr("data-index")))
								}), h(n, function(n) {
									e.$apply(function() {
										e.loading = !0
									}), t.removeEvents({
										data: {
											plan_id: t.getPlanId(),
											oneday_id: e.day.id,
											onedayevent_obj: n,
											confirm: L
										},
										onSuccess: function() {
											s(), $(o).slideUp(250, function() {
												i.showTip("删除成功！", "ok"), i.setSelectedDay()
											}), e.$apply(function() {
												e.loading = !1
											}), i.broadcast("update-cart-icon")
										},
										onError: function(t) {
											i.showTip(t.data.msg, "error"), e.$apply(function() {
												e.loading = !1
											})
										}
									})
								}, a)
							}
						})
					})
				})
			}

			function s() {
				$(".planner-day-details .inner").css({
					"padding-bottom": "0"
				}), $(".details-body").removeClass("editing"), $(".details-footer").removeClass("show"), $(".details-body").off("click", ".place-wrapper .checkbox"), $(".details-body").off("click", ".select-all .checkbox"), $(".details-body .checkbox").removeClass("checked"), $(".details-footer a").removeClass("disabled"), $(".details-footer").off("click", ".close").off("click", ".delete")
			}

			function l() {
				$(".details-header .add-city").addClass("editing").find("input").on("blur", function() {
					c()
				}).focus().select(), $(".details-header .last.item .delimiter").css("display", "block"), $(".details-header .empty").css("display", "none")
			}

			function c() {
				$(".details-header .add-city").removeClass("editing").find("input").off("blur").val(""), $(".details-header .last.item .delimiter").removeAttr("style"), $(".details-header .empty").removeAttr("style")
			}

			function d() {
				t.updateCityList({
					data: {
						plan_id: t.getPlanId(),
						oneday_id: e.day.id,
						truncate: 0 === e.day.city_list.length ? 1 : 0,
						citys: e.day.city_list.map(function(e) {
							return {
								tagid: e.tagid,
								name: e.name,
								type: parseInt(e.tagid) > 0 ? 1 : 0
							}
						})
					},
					onSuccess: function() {
						i.showTip("保存成功！", "ok")
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}

			function u() {
				t.getPlayHours({
					data: {
						plan_id: t.getPlanId(),
						oneday_id: e.day.id
					},
					onSuccess: function(t) {
						e.$apply(function() {
							if (e.total_hours = Math.ceil(t.data || 0), e.total_hours) {
								var n = "background-position:0px -" + (e.total_hours > 16 ? 615 : 41 * e.total_hours) + "px";
								setTimeout(function() {
									$("#js_total_hoursBgCss").attr("style", n)
								}, 500)
							} else $("#js_total_hoursBgCss").attr("style", "")
						})
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}

			function p() {
				if (e.service.place_list && !(e.service.place_list.length < 2)) {
					var n, a, o, r, s = {},
						l = {};
					for (e.traffic_list = [], a = 0, n = e.service.place_list.length; a < n - 1; a++) o = D(e.service.place_list[a], 1), r = D(e.service.place_list[a + 1]), o.mapstatus || (l[a - 1] = !0, l[a] = !0), s[a] = {
						from_event_id: o.id,
						from_pid: S(o),
						start_lat: o.lat,
						start_lng: o.lng,
						otype: k(o),
						to_event_id: r.id,
						to_pid: S(r),
						end_lat: r.lat,
						end_lng: r.lng,
						dtype: k(r)
					};
					o.mapstatus || (l[o] = !0, l[r] = !0), t.getTraffic({
						data: {
							plan_id: t.getPlanId(),
							oneday_id: e.day.id,
							traffic: s
						},
						onSuccess: function(t) {
							e.$apply(function() {
								e.traffic_list = t.data.map(function(e, t) {
									return l[t] ? $.extend(e, {
										empty: !0
									}) : e
								})
							})
						},
						onError: function(e) {
							i.showTip(e.data.msg, "error")
						}
					})
				}
			}

			function f(t) {
				var n;
				return "number" == typeof t ? n = i.allDays[t] : (n = e.day.city_list, t = i.selectedDay.index), n && n.length > 0 ? n[n.length - 1].tagid : t > 0 ? f(t - 1) : null
			}

			function h(e, t, n) {
				var i, a = null,
					o = null;
				L = null, i = e && e.length ? C(e).map(function(e) {
					var t = e.id;
					if (3 == e.type && (a = e.id), 2 == e.type && e.group_id > 0 && (o = t), e.type) return {
						type: parseInt(e.type),
						pid: parseInt(e.id),
						group_id: e.group_id || null
					}
				}) : [], a ? g(a, function() {
					t(i)
				}, n) : o ? m(function() {
					t(L ? i : i.map(function(e) {
						return {
							type: e.type,
							pid: e.pid
						}
					}))
				}, n) : t(i)
			}

			function g(e, n, a) {
				t.getTrafficEventDetails({
					data: {
						plan_id: t.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						trafficid: e
					},
					onSuccess: function(e) {
						var t = e.data.traffics.map(function(e) {
							return e.fromplace + " > " + e.toplace
						}).join("<br>");
						requirejs(["web_old_slidconfirm"], function(e) {
							e.confirm({
								text: "将一并删除关联的交通信息，是否继续?<br>" + t,
								target: a,
								onOK: function() {
									L = 1, n()
								}
							})
						})
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}

			function m(e, t) {
				var n = $(t).offset(),
					i = $("<div>", {
						class: "dropdown delete-hotel-confirm",
						css: {
							top: n.top - 50,
							left: n.left + 10
						}
					}).append([$("<h2>", {
						text: "该酒店为连续安排，是否一并删除所有日该酒店？"
					}), $("<div>", {
						class: "control"
					}).append([$("<a>", {
						class: "button",
						text: "取消",
						href: "#",
						id: "delete-cancel"
					}), $("<a>", {
						class: "button",
						text: "仅删除该日",
						href: "#",
						id: "delete-today"
					}), $("<a>", {
						class: "button warning",
						text: "全部删除",
						href: "#",
						id: "delete-all"
					})])]).appendTo(document.body).one("click.delete-hotel", "a.button", function(t) {
						switch ($(t.target).attr("id")) {
							case "delete-today":
								L = 0, e(),
									qyerUtil.doTrackCode("Planv3-mid-deletehotel-oneday");
								break;
							case "delete-all":
								L = 1, e(), qyerUtil.doTrackCode("Planv3-mid-deletehotel-all");
								break;
							default:
								qyerUtil.doTrackCode("Planv3-mid-deletehotel-cancel")
						}
						i.slideUp(250)
					}).slideDown(250)
			}

			function v(e) {
				i.showPopup('<section class="optimize-plan popup" ng-controller="OptimizePlanController"><h1>智能优化全程<a href="#" ng-click="applyOptimize($event)" class="primary button" ng-if="status == \'loaded\'" data-bn-ipg="Planv3-optimize-allday-accept">采纳</a></h1><p class="subtitle" ng-if="status == \'ready\'">基于千万穷游er的经验，帮您一键安排每日行程</p><p class="subtips" ng-if="status == \'ready\'">提示：如果你填写了详细的交通和酒店，优化结果将更加准确</p><p class="subtitle" ng-if="status == \'loading\'">正在努力为您计算合适的行程...</p><div class="types" ng-if="status == \'ready\'"><div class="card" ng-click="doOptimize($event, 1)" data-bn-ipg="Planv3-optimize-alldayoption-loose"><div class="relax iconfont">&#58961;</div><h4>宽松安排</h4><p>每天游玩4～6小时</p></div><div class="card" ng-click="doOptimize($event, 2)" data-bn-ipg="Planv3-optimize-alldayoption-normal"><div class="mid iconfont">&#58962;</div><h4>适中安排</h4><p>每天游玩6～10小时</p></div><div class="card" ng-click="doOptimize($event, 3)" data-bn-ipg="Planv3-optimize-alldayoption-tight"><div class="compact iconfont">&#58960;</div><h4>紧凑安排</h4><p>每天游玩11～16小时</p></div></div><div class="sidebar" ng-show="status == \'loaded\'"><div class="inner"><div class="tabs"><a data-bn-ipg="Planv3-optimize-allday-before" href="#" ng-class="{true:\'active\'}[period == \'before\']" ng-click="changePeriod($event, \'before\')">优化前</a><a data-bn-ipg="Planv3-optimize-allday-after" href="#" ng-class="{true:\'active\'}[period == \'after\']" ng-click="changePeriod($event, \'after\')">优化后</a></div><div class="tips"><p>优化结果: {{after.tip.title}}</p><ul ng-if="after.tip.item &amp;&amp; after.tip.item.length &gt; 0"><li ng-repeat="item in after.tip.item">{{item}}</li></ul><a href="#" class="more" ng-if="after.tip.item &amp;&amp; after.tip.item.length &gt; 0" ng-click="toggleMore($event)">展开全部介绍</a></div><div class="box" ng-repeat="day in before" ng-show="period == \'before\'"><h2>{{getDate(day.dayNum)}}</h2><h3 ng-class="{true: \'no-margin\'}[!day.event_list || day.event_list.length === 0]"><span ng-repeat="city in day.citys">{{city.name}}</span></h3><ul><li class="poi disabled" ng-repeat="poi in day.event_list"><img src="{{poi.pic || \'http://static.qyer.com/images/place/no/poi_200_133.png\'}}" alt=""><em class="icon" ng-if="poi.type == 3" ng-class="[\'\',\'plane-blue\',\'train-blue\',\'bus-blue\',\'car-blue\',\'boat-blue\',\'other-blue\',\'car-blue\'][poi.tripmode]"></em><em class="icon hotel-orange" ng-if="poi.type == 2"></em><em class="icon no-coords" ng-if="!poi.lat || !poi.lng"></em><div class="title"><span>{{poi.event_name}}</span></div><div class="arrow" ng-if="!$last">&gt;</div></li></ul><div class="empty" ng-if="!day.event_list || day.event_list.length === 0">该日未安排行程</div><div class="clear"></div></div><div class="box" ng-repeat="day in after.days" ng-show="period == \'after\'"><h2>{{getDate(day.dayNum)}}</h2><h3 ng-class="{true: \'no-margin\'}[!day.pois || day.pois.length === 0]"><span ng-repeat="city in day.citys">{{city.name}}</span></h3><ul ui-sortable="sortableOptions" ng-model="day.pois" ng-class="{true:\'empty\'}[day.pois.length === 0]"><li class="poi" ng-repeat="poi in day.pois"><a data-bn-ipg="Planv3-optimize-allday-delete" href="#" class="close" ng-click="removePoi($event, $parent.$index, $index)" ng-show="poi.type != 3"><em class="icon close-black"></em><em class="icon close-red"></em></a><img src="{{poi.pic || \'http://static.qyer.com/images/place/no/poi_200_133.png\'}}" alt=""><em class="icon" ng-if="poi.type == 3" ng-class="[\'\',\'plane-blue\',\'train-blue\',\'bus-blue\',\'car-blue\',\'boat-blue\',\'other-blue\',\'car-blue\'][poi.tripmode]"></em><em class="icon hotel-orange" ng-if="poi.type == 2"></em><em class="icon no-coords" ng-if="!poi.lat || !poi.lng"></em><div class="title"><span>{{poi.cn_name || poi.en_name}}</span></div><div ng-if="poi.tag &gt; 0" class="tag" ng-class="{1: \'new\', 2: \'change\', 4: \'no-location\'}[poi.tag]"></div><div class="arrow" ng-if="!$last">&gt;</div></li></ul><div class="empty" ng-if="!day.pois || day.pois.length === 0">该日未安排行程</div><div class="clear"></div></div><div class="box" ng-show="period == \'after\' &amp;&amp; after.deletedpois.length &gt; 0"><h3>被删除的景点</h3><ul><li class="poi" ng-repeat="poi in after.deletedpois" ng-click="restorePoi($index)"><img src="{{poi.pic || \'http://static.qyer.com/images/place/no/poi_200_133.png\'}}" alt=""><div class="restore">还原</div><div class="title"><span>{{poi.cn_name || poi.en_name}}</span></div></li></ul><div class="clear"></div></div></div></div><div id="route-map" class="route-map map-container" ng-show="status == \'loaded\'"></div><ul class="days"><li ng-repeat="day in before" ng-show="period == \'before\'"><input ng-model="day.selected" ng-init="true" type="checkbox" name="selectedDays" value="{{$index}}" ng-change="refreshMap(\'Planv3-optimize-allday-mapdate\')" checkbox checked><span>{{getDate(day.dayNum)}}</span></li><li ng-repeat="day in after.days" ng-show="period == \'after\'"><input ng-model="day.selected" ng-init="true" type="checkbox" name="selectedDays" value="{{$index}}" ng-change="refreshMap(\'Planv3-optimize-allday-mapdate\')" checkbox checked><span>{{getDate(day.dayNum)}}</span></li></ul></section>', $.extend({
					closeTrackCode: "Planv3-optimize-alldayoption-close"
				}, e))
			}

			function y() {
				i.showPopup('<section class="optimize-hotel popup" ng-controller="OptimizeHotelController"><h1 ng-if="status ==\'ready\'">智能推荐酒店</h1><p class="subtitle" ng-if="status == \'ready\'">基于千万穷游er的经验，帮您一键安排每日行程</p><div class="types" ng-if="status == \'ready\'"><div class="card" ng-click="doOptimize($event, 1)" data-bn-ipg="Planv3-recommendhotel-option-cheap"><div class="eco iconfont">&nbsp;</div><h4>经济型酒店</h4><p>(无星~2星级)</p></div><div class="card" ng-click="doOptimize($event, 2)" data-bn-ipg="Planv3-recommendhotel-option-middle"><div class="normal iconfont">&nbsp;</div><h4>普通型酒店</h4><p>(3星~4星级)</p></div><div class="card" ng-click="doOptimize($event, 3)" data-bn-ipg="Planv3-recommendhotel-option-luxury"><div class="lux iconfont">&nbsp;</div><h4>奢华型酒店</h4><p>(5星级)</p></div></div><p class="subtitle" ng-if="status == \'loading\'">正在努力为你推荐合适的酒店...</p><p class="subtitle" ng-if="status == \'successError\'"><i class="iconfont">&#58965;</i>{{errorMsg}}</p><h1 ng-if="status == \'loaded\'" class="hotel-popup-title">智能推荐酒店<em ng-if="status == \'loaded\'">下列酒店是基于您的要求推荐</em><span ng-if="status == \'loaded\'">已选择 <em>{{chooses}}</em> 个推荐酒店 / {{recommends.length}}段行程</span><a id="auto-select" class="button" href="#" ng-if="status == \'loaded\'" ng-click="autoSelect($event)" data-bn-ipg="Planv3-recommendhotel-result-autoselect">自动选择</a><a href="#" ng-click="submitSelect($event)" class="primary button" ng-if="status == \'loaded\'" data-bn-ipg="Planv3-recommendhotel-result-finish">完成</a></h1><div id="route-map" class="hotel-route-map map-container" ng-show="status == \'loaded\'"></div><div class="hotel-route-map-btn iconfont" ng-show="status == \'loaded\'" ng-class="{true:\'active\'}[showMap]" ng-click="showMapClick()" data-bn-ipg="Planv3-recommendhotel-result-map">&#59075;</div><div class="hotel-sidebar" ng-show="status == \'loaded\'"><div class="inner"><div class="nav"><span class="checkcity">{{recommends[index].city}}</span><span class="checkday">{{getDate(recommends[index].inday,recommends[index].inDayNum) | date:\'M月d日\'}}(入住) - {{getDate(recommends[index].outday,recommends[index].outDayNum) | date:\'M月d日\'}}(退房)</span><a href="#" class="prev iconfont" ng-click="changeIndex($event, -1)" ng-class="{true:\'disabled\'}[index == 0]" data-bn-ipg="Planv3-recommendhotel-result-citychange">&#59075;</a><a href="#" class="next iconfont" ng-click="changeIndex($event, 1)" ng-class="{true:\'disabled\'}[index == (recommends.length - 1)]" data-bn-ipg="Planv3-recommendhotel-result-citychange">&#59075;</a></div><div ng-if="!hotels.length" class="commend-hotel-list--none">        该段没有找到推荐酒店      </div><div class="commend-hotel-list"><div class="commend-hotel-list__showbox"><div class="commend-hotel-list__truebox" ng-style="hotelIndexStyle"><div id="recommend-hotel-{{hotel.id}}" class="item" ng-repeat="hotel in hotels" ng-if="hotel" ng-mouseenter="startAnimation(hotel.id)" ng-mouseleave="stopAnimation(hotel.id)"><div class="inner" ng-class="{true:\'\'}[hotel.selected]"><div class="image-box"><a data-bn-ipg="Planv3-recommendhotel-result-picture" href="{{hotel.url}}" target="_blank" ng-if="hotel.pic"><img src="{{hotel.pic}}"></a><a data-bn-ipg="Planv3-recommendhotel-result-picture" href="{{hotel.url}}" target="_blank" ng-if="!hotel.pic"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/defaultHotelImg.jpg"></a><div class="thread" ng-if="hotel.order_num &gt; 0 || !hotel.freecancel"><span ng-if="hotel.order_num &gt; 0"><i>{{hotel.order_num}}</i>个穷游er住过</span></div><div class="ribbon" ng-class="{0:\'hot\',1:\'eco\',2:\'pos\'}[hotel.recommendReason]" ng-if="!hotel.selected">{{{0:\'人气高\',1:\'性价比高\',2:\'地理位置好\'}[hotel.recommendReason]}}</div><div class="en_name">{{hotel.en_name}}</div><div class="cn_name">{{hotel.cn_name}}</div><div class="subtitle"><span class="iconfont subtitle__star" ng-repeat="star in [1,2,3,4,5]" ng-if="hotel.star / 2 &gt; $index">&#59020;</span><span>{{[\'\', \'一\', \'二\', \'三\', \'四\', \'五\'][hotel.star / 2]}}星级</span><span class="sep"> | </span><span>用户评分{{hotel.grade}}分</span></div><a href="{{hotel.url}}" target="_blank" data-bn-ipg="Planv3-recommendhotel-result-title" class="hotel_link"></a></div><div class="price-box clearfix"><a href="https://hotel.qyer.com/detail/{{hotel.id}}.html?pricing&planid={{planId}}&checkin={{checkinDate}}&checkout={{checkoutDate}}" target="_blank" ng-if="hotel.hq_reference_price > 0" data-bn-ipg="Planv3-recommendhotel-result-price-qyer"><div class="price-box--base price-box--hq" ><span class="price-box__txt">穷游网</span><br /><em ng-if="hqPriceLoading">价格获取中</em><em ng-if="!hqPriceLoading">{{getIntNumber(hotel.hq_reference_price)}}元</em></div></a><a href="{{hotel.url}}" target="_blank" data-bn-ipg="{{(hotel.hq_reference_price > 0 ? \'Planv3-recommendhotel-result-price-booking\' : \'Planv3-recommendhotel-result-price-bookingonly\')}}"><div class="price-box--base price-box--booking" ng-class="{true: \'price-box--full\', false: \'\'}[!priceloading && hotel.price == 0]"><span class="price-box__txt">Booking</span><br /><em ng-if="priceloading">价格获取中</em><em ng-if="!priceloading && hotel.price == 0">已订满</em><em ng-if="!priceloading && hotel.price > 0">{{getIntNumber(hotel.price)}}元</em></div></a></div><div class="reasons"><p>推荐理由</p><ul><li ng-repeat="r in hotel.reason"><a href="{{hotel.url}}" target="_blank">{{r}}</a></li></ul></div><div class="controls"><a href="#" ng-click="chooseHotel($event, hotel)" data-bn-ipg="Planv3-recommendhotel-result-select">添加到行程</a></div><div class="comment" ng-if="hotel.comment"><img src="{{hotel.comment.avatar}}" /><span><em>{{hotel.comment.content | limitToNum:50}}</em></span></div></div><div class="selected-mask" ng-if="hotel.selected"><div class="cancel"><a href="#" class="button white" ng-click="cancelChoose($event, hotel)" data-bn-ipg="Planv3-recommendhotel-result-unselect">取消添加</a></div><div class="tick">已选择该酒店</div><p class="en_name">{{hotel.en_name}}</p><p class="cn_name">{{hotel.cn_name}}</p><p class="day_day">将添加至的第{{recommends[index].inDayNum}}天-第{{recommends[index].outDayNum}}天行程中</p></div></div></div></div></div><div class="commend-hotel-list__btn commend-hotel-list__btn--left" ng-class="{true:\'commend-hotel-list__btn--disabled\'}[hotelIndex == 0]" ng-if="hotels.length" ng-click="changeHotelIndex($event,-1)" data-bn-ipg="Planv3-recommendhotel-result-hotelchange">&#59075;</div><div class="commend-hotel-list__btn commend-hotel-list__btn--right" ng-class="{true:\'commend-hotel-list__btn--disabled\'}[hotelIndex == hotelIndexMax]" ng-if="hotels.length" ng-click="changeHotelIndex($event,1)" data-bn-ipg="Planv3-recommendhotel-result-hotelchange">&#59075;</div></div></div></section>', {
					closeTrackCode: "Planv3-recommendhotel-option-close"
				})
			}

			function b() {
				if (!I) {
					if (I = !0, !$(".details-header .add-city input").length) return I = !1, void setTimeout(function() {
						b()
					}, 100);
					requirejs(["web_old_inputautocomplete"], function() {
						var n = $(".details-header .add-city input");
						n.qyerAutocomplete({
							isAllowEmptySeach: !0,
							isFocusedSeach: !0,
							autoSelect: !0,
							onSearch: function() {
								var a = $.trim(this.value);
								t.searchCity({
									data: {
										plan_id: t.getPlanId(),
										oneday_id: e.day.id,
										city_id: a ? null : f(),
										keyword: a
									},
									onSuccess: function(e) {
										var t = ['<div class="search-city-list">'];
										a || t.push('<div class="search-title">猜你想去</div>'), t.push('<ul class="qui-inputAutocomplete-ul">'), e.data.forEach(function(e) {
											var n = '<li data-id="' + e.city_id + '" data-name="' + e.city_name + '" data-lat="' + e.lat + '" data-lng="' + e.lng + '""><span>' + e.city_name + "(" + e.country_name + ")</span></li>";
											t.push(n)
										}), a && t.push('<li class="custom" data-id="-1" data-name="' + a + '">创建自定义城市“' + i.encodeHTML(a) + "”</li>"), t.push("</ul>"), t.push("</div>"), n.qyerAutocomplete("pushHTML", t.join(""))
									},
									onError: function(e) {
										var t, o = ['<div class="search-city-list">'];
										t = e.data && e.data.msg ? e.data.msg : "搜索无结果", o.push('<div class="search-title">' + t + "</div>"), o.push('<ul class="qui-inputAutocomplete-ul">'), a && o.push('<li class="custom" data-id="-1" data-name="' + a + '">创建自定义城市“' + i.encodeHTML(a) + "”</li>"), o.push("</ul>"), o.push("</div>"), n.qyerAutocomplete("pushHTML", o.join(""))
									}
								})
							},
							onSelect: function(t) {
								var n = t.getAttribute("data-id"),
									i = t.getAttribute("data-name"),
									a = t.getAttribute("data-lat"),
									o = t.getAttribute("data-lng");
								e.$apply(function() {
									e.day.city_list.push({
										tagid: n,
										name: i,
										lat: a,
										lng: o
									})
								}), c(), d()
							}
						})
					})
				}
			}

			function w() {
				var n = e.service.place_list;
				if (n && 0 !== n.length && 2 != n[n.length - 1].type) {
					var a = _.filter(n, function(e) {
						return 2 == e.type
					});
					0 === a.length ? e.service.today_hotel = null : e.service.today_hotel = a[a.length - 1]
				} else e.service.today_hotel = null;
				var o, r, s = [],
					l = [];
				o = n.length ? D(n[0]) : [], r = n.length ? D(n[n.length - 1], 1) : [], e.hotel_traffic = [], o && (e.service.yesterday_hotel || e.service.today_hotel) && (e.service.yesterday_hotel && (s.push({
					from_event_id: e.service.yesterday_hotel.id,
					from_pid: S(e.service.yesterday_hotel),
					start_lat: e.service.yesterday_hotel.lat,
					start_lng: e.service.yesterday_hotel.lng,
					otype: k(e.service.yesterday_hotel),
					to_event_id: o.id,
					to_pid: S(o),
					end_lat: o.lat,
					end_lng: o.lng,
					dtype: k(o)
				}), e.service.yesterday_hotel.mapstatus && o.mapstatus || (l[0] = !0)), e.service.today_hotel && (s.push({
					from_event_id: r.id,
					from_pid: S(r),
					start_lat: r.lat,
					start_lng: r.lng,
					otype: k(r),
					to_event_id: e.service.today_hotel.id,
					to_pid: S(e.service.today_hotel),
					end_lat: e.service.today_hotel.lat,
					end_lng: e.service.today_hotel.lng,
					dtype: k(e.service.today_hotel)
				}), r.mapstatus && e.service.today_hotel.mapstatus || (l[1] = !0)), t.getTraffic({
					data: {
						plan_id: t.getPlanId(),
						oneday_id: e.day.id,
						traffic: s
					},
					onSuccess: function(t) {
						e.$apply(function() {
							e.hotel_traffic = t.data.map(function(e, t) {
								return l[t] ? $.extend(e, {
									empty: !0
								}) : e
							}), !e.service.yesterday_hotel && e.service.today_hotel && e.hotel_traffic.splice(0, 0, {})
						})
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				}))
			}

			function x() {
				for (var e = document.body || document.documentElement, t = e.style, n = ["webkit", "khtml", "moz", "ms", "o"], i = 0; i < n.length;) {
					if ("string" == typeof t[n[i] + "Transition"]) return n[i];
					i++
				}
			}

			function k(e) {
				switch (parseInt(e.type)) {
					case 2:
						return parseInt(e.pid) > 0 ? 3 : 4;
					case 1:
						return parseInt(e.pid) > 0 ? 2 : 4;
					case 3:
						return e.traffic_poiid > 0 ? 2 : "" == e.traffic_poiname ? 1 : 4
				}
			}

			function T(e) {
				return _.each(e, function(e) {
					3 === e.type && "@all" == e.display && (e.id = e.from.id + "," + e.to.id), 3 === e.type && "@all" != e.display && (e.id = e[e.display].id)
				}), e
			}

			function C(e) {
				var t = [];
				return e.map(function(e) {
					return 3 === e.type && "@all" === e.display ? (t.push(D(e)), void t.push(D(e, 1))) : void t.push(D(e))
				}), t
			}

			function D(e, t) {
				var n;
				return 3 === e.type && "@all" === e.display && (n = t ? e.to : e.from), 3 === e.type && "@all" !== e.display && (n = e[e.display]), 3 !== e.type && (n = e), n
			}

			function S(e) {
				switch (parseInt(e.type)) {
					case 2:
					case 1:
						return parseInt(e.pid) > 0 ? e.pid : e.id;
					case 3:
						return e.traffic_poiid > 0 ? e.traffic_poiid : "" == e.traffic_poiname ? e.pid : e.id
				}
			}

			function P(e) {
				return 3 !== e.type ? [e.id] : 3 === e.type && 7 === e.tripmode ? [e[e.display].id] : 3 === e.type ? [e.from.id, e.to.id] : void 0
			}
			var I = !1,
				E = null,
				L = null,
				M = null,
				A = "正在加载中",
				O = 1,
				j = A.length,
				F = null;
			e.service = i, e.service.place_list = [], e.service.place_list_flatten = [], e.total_hours = 0, e.traffic_list = [], e.loading = !1, e.loading_details = !0, e.loading_text = "", e.controlsPosition_resize = !1, e.$on("mode-changed", function() {
				e.mode = e.service.mode
			}), e.hotel_traffic = [], $(".scroll-wrapper").prepend('<div class="planner-day-details-wrapper"></div>'), e.getDate = function() {
				var n = t.getStartDate();
				if (n) {
					$("#header-date-picker").attr("class", "");
					var i = new Date(n.getTime());
					return i.setDate(i.getDate() + e.index), i
				}
				return $("#header-date-picker").attr("class", "bullink"), "填写日期"
			}, e.$on("selected-day-changed", function(n, r) {
				s(), c(), e.service.place_list = [], e.service.place_list_flatten = [], e.index = i.selectedDay.index, e.day = i.selectedDay.object, b(), e.loading_details = !0, a(), t.getDayDetails({
					data: {
						plan_id: t.getPlanId(),
						oneday_id: e.day.id
					},
					onSuccess: function(t) {
						e.$apply(function() {
							var n = [];
							e.service.place_list = t.data ? T(t.data.event_list) : [], e.service.place_list_flatten = C(e.service.place_list), e.service.yesterday_hotel = t.data.yesterday_hotel, w(), e.has_hotels = _.some(e.service.place_list, function(e) {
								return 2 == e.type
							}), t.data && t.data.notes && t.data.notes.length > 0 && (n = _.map(t.data.notes, function(e) {
								return _.extend(e, {
									message: i.decodeHTML(e.message)
								})
							})), i.setSelectedDayNotes(n), i.broadcast("day-details-changed", r), e.loading_details = !1, o()
						}), setTimeout(function() {
							var e = $(".scroll-wrapper").scrollTop();
							$(".planner-day-details").height() - e < $(".scroll-wrapper").height() ? ($(".planner-day-details .inner").append($(".details-footer")), $(".planner-day-details .details-footer").attr("style", "")) : ($(".planner-day-details-wrapper").append($(".details-footer")), $(".planner-day-details-wrapper .details-footer").css({
								left: $(".scroll-wrapper").css("left"),
								width: $(".scroll-wrapper").css("width")
							}))
						}, 10), setTimeout(function() {
							i.scrBottom && ($(".scroll-wrapper").scrollTop($(".scroll-wrapper").height()), i.scrBottom = !1)
						}, 100), setTimeout(function() {
							$(".scroll-wrapper").scrollTop("0"), $(".details-header").append($(".planner-day-details").prev(".planner-day-details-wrapper").children(".controls")), $(".details-header .controls").attr("style", "")
						}, 10), $(".place .pin .iconfont").text($(this).attr("ng-bind-html"))
					},
					onError: function(t) {
						e.$apply(function() {
							e.loading_details = !1, o()
						}), i.showTip(t.data.msg, "error")
					}
				})
			}), e.$on("update-selected-traffic", function() {
				e.viewPathIndex < 0 ? e.hotel_traffic[Math.abs(e.viewPathIndex) - 1] = i.selectedTraffic.object : e.traffic_list[e.viewPathIndex] = i.selectedTraffic.object, e.$apply()
			}), e.$on("day-details-changed", function() {
				p(), u(), e.viewPathIndex = null
			}), e.$on("day-details-event-added", function(t, n) {
				e.service.place_list.push(n), e.service.place_list_flatten = C(e.service.place_list), e.$broadcast("day-details-changed")
			}), e.$on("day-details-event-changed", function(t, n) {
				e.service.place_list.forEach(function(e) {
					e.id == n.id && $.extend(e, n)
				}), e.$broadcast("day-details-changed")
			}), e.$on("auto-add-city", function(e, t) {
				i.selectedDay.object.city_list.push(t)
			}), e.addCity = function(e) {
				l(), qyerUtil.doTrackCode("Planv3-mid-city-add")
			}, e.removeCity = function(e) {
				i.selectedDay.object.city_list.splice(e, 1), d(), qyerUtil.doTrackCode("Planv3-mid-city-delete")
			}, e.getCityClass = function(e, t) {
				var n = [];
				return e && n.push("last"), t && n.push("custom"), n.join(" ")
			}, e.changeSelectedCity = function(e) {
				e.tagid > 0 && i.updateSelectedCity(e)
			}, e.citySortableOptions = {
				start: function() {
					i.hideDropdown()
				},
				stop: function(e, t) {
					d()
				},
				containment: "body",
				items: ".item:not(span,.add-city)"
			}, e._sortableTmp = null, e.placeSortableOptions = {
				start: function() {
					$("#wrapper .scroll-wrapper").css("z-index", 0), i.hideDropdown(), e._sortableTmp = e.service.place_list.map(function(e) {
						return e.id
					})
				},
				sort: function(e, t) {
					t.offset.top, $(window).scrollTop()
				},
				stop: function(n, a) {
					$("#wrapper .scroll-wrapper").css("z-index", ""), clearInterval(E), E = null;
					var o = e.service.place_list.map(function(e) {
						return e.id
					});
					e._sortableTmp.join("-") != o.join("-") && (e.$apply(function() {
						e.loading = !0
					}), e.service.place_list_flatten = C(e.service.place_list), t.reorderEvents({
						data: {
							plan_id: t.getPlanId(),
							oneday_id: e.day.id,
							onedayevent_obj: e.service.place_list_flatten.map(function(e) {
								return {
									pid: e.id,
									type: e.type
								}
							})
						},
						onSuccess: function() {
							p(), i.showTip("保存成功！", "ok"), i.broadcast("day-details-event-sorted"), e.$apply(function() {
								w(), e.loading = !1
							})
						},
						onError: function(t) {
							i.showTip(t.data.msg, "error"), i.setSelectedDay(), e.$apply(function() {
								e.loading = !1
							})
						}
					}))
				},
				scroll: !0,
				handle: ".place",
				helper: "clone",
				axis: "y",
				appendTo: "section.planner-day-details"
			}, e.recommendOptions = {
				title: "智能推荐",
				menu: function() {
					return [{
						label: "智能优化当日",
						icon: "bulb",
						disabled: !(e.service.place_list && e.service.place_list.length > 3),
						action: function(t) {
							i.selectedDay.place_list = e.service.place_list, i.showPopup('<section class="optimize-one-day popup" ng-controller="OptimizeOneDayController"><h1>智能优化当日<em ng-if="status == \'loaded\'">准确的交通信息则让优化更加完美</em><a href="#" ng-click="applyOptimize($event)" class="primary button" ng-if="status == \'loaded\'" data-bn-ipg="Planv3-optimize-oneday-accept">采纳</a></h1><p class="subtitle" ng-if="status == \'ready\'">选择起始点，帮你算出最短路程，少走弯路</p><p class="subtitle" ng-if="status == \'loading\'">优化中……</p><div id="optimize-form" class="form" ng-show="status == \'ready\'"><div class="row"><div class="label">起点:</div><div class="content"><select name="start" id="optimize-start" ng-model="start_id" ng-init="start_id = -1"><option value="-1" selected>选填</option><option value="{{place.id}}" ng-repeat="place in place_list" ng-if="place.cateid != 1000">{{(place.type == 3) ? (place.pair_id > 0 ? "到达：" : "出发：") : ""}}{{place.cn_name || place.en_name}}{{place.traffic_poiname?(" ("+place.traffic_poiname+")"):""}}{{(place.lat == null || place.lng == null)?"（无坐标）":""}}</option></select></div></div><div class="row"><div class="label">终点:</div><div class="content"><select name="destination" id="optimize-destination" ng-model="destination_id" ng-init="destination_id = -1"><option value="-1" selected>选填</option><option value="{{place.id}}" ng-repeat="place in place_list" ng-if="place.cateid != 1000">{{(place.type == 3) ? (place.pair_id > 0 ? "到达：" : "出发：") : ""}}{{place.cn_name || place.en_name}}{{place.traffic_poiname?(" ("+place.traffic_poiname+")"):""}}</option></select></div></div></div><div class="controls" ng-if="status == \'ready\'"><a href="#" class="primary button" ng-click="doOptimize($event)" data-bn-ipg="Planv3-optimize-onedayoption-reoptimize">优化当日</a></div><div class="sidebar" ng-show="status == \'loaded\'"><div class="inner"><div class="tabs"><a data-bn-ipg="Planv3-optimize-oneday-before" href="#" ng-class="{true:\'active\'}[period == \'before\']" ng-click="changePeriod(\'before\')">优化前</a><a data-bn-ipg="Planv3-optimize-oneday-after" href="#" ng-class="{true:\'active\'}[period == \'after\']" ng-click="changePeriod(\'after\')">优化后</a></div><div class="tips">{{getOptimizeStr(before,after)}}</div><div class="box"><h2>{{getDate()}}</h2><h3><span ng-repeat="city in city_list">{{city.name}}</span></h3><ul ng-show="period == \'before\'"><li class="poi disabled" ng-repeat="poi in before.eventList"><img src="{{poi.pic}}" alt=""><em class="icon" ng-if="poi.type == 3" ng-class="[\'\',\'plane-blue\',\'train-blue\',\'bus-blue\',\'car-blue\',\'boat-blue\',\'other-blue\',\'car-blue\'][poi.tripmode]"></em><em class="icon hotel-orange" ng-if="poi.type == 2"></em><em class="icon no-coords" ng-if="!poi.lat || !poi.lng"></em><div class="title"><span>{{poi.event_name}}</span></div><div class="arrow" ng-if="!$last">&gt;</div></li></ul><ul ng-show="period == \'after\'" ui-sortable="sortableOptions" ng-model="after.eventList"><li class="poi" ng-repeat="poi in after.eventList"><img src="{{poi.pic || \'http://static.qyer.com/images/place/no/poi_48_48.png\'}}" alt=""><em class="icon" ng-if="poi.type == 3" ng-class="[\'\',\'plane-blue\',\'train-blue\',\'bus-blue\',\'car-blue\',\'boat-blue\',\'other-blue\',\'car-blue\'][poi.tripmode]"></em><em class="icon hotel-orange" ng-if="poi.type == 2"></em><em class="icon no-coords" ng-if="!poi.lat || !poi.lng"></em><div class="title"><span ng-if="poi.city_name">{{poi.city_name}}({{poi.event_name}})</span><span ng-if="!poi.city_name">{{poi.event_name}}</span></div><div class="arrow" ng-if="!$last">&gt;</div></li></ul><div class="clear"></div></div><div class="box" ng-show="period == \'after\'"><div id="reoptimize-form" class="form"></div><a href="#" class="reoptimize primary button" ng-click="doOptimize($event)" data-bn-ipg="Planv3-optimize-oneday-reoptimize">重新优化</a></div></div></div><div id="route-map" class="route-map map-container" ng-show="status == \'loaded\'"></div></section>', {
								closeTrackCode: "Planv3-optimize-onedayoption-close"
							}), qyerUtil.doTrackCode("Planv3-mid-recommend-oenday")
						}
					}, {
						label: "智能优化全程",
						icon: "star-map",
						action: function(e) {
							v(), qyerUtil.doTrackCode("Planv3-mid-recommend-wholetrip")
						}
					}]
				}
			}, e.optimizeHotel = y, e.editOptions = {
				title: "操作",
				closeTrackCode: "Planv3-mid-edit-close",
				menu: function() {
					return [{
						label: "添加城际交通",
						icon: "lights",
						attrs: {
							"data-help-index": 4,
							"data-help-direction": "right",
							"data-help-step": 2,
							"data-help-content": "也可以在这里直接手动添加"
						},
						action: function(e) {
							var t = 0;
							i.place_list.forEach(function(e) {
								3 == e.type && t++
							}), t < 20 ? (i.isSelectedTrafficData = !1, i.broadcast("show-add-traffic")) : i.showTip("最多添加10组交通", "error"), qyerUtil.doTrackCode("Planv3-mid-edit-addtrans")
						}
					}, {
						label: "添加当日游玩",
						icon: "play",
						action: function(e) {
							i.place_list.filter(function(e) {
								return 1 == e.type
							}).length < 40 ? (i.isSelectedTrafficData = !0, i.broadcast("show-add-poi")) : i.showTip("最多添加40个景点", "error"), qyerUtil.doTrackCode("Planv3-mid-edit-addpoi")
						}
					}, {
						label: "添加当日住宿",
						icon: "bed",
						attrs: {
							"data-help-index": 3,
							"data-help-direction": "right",
							"data-help-step": "2",
							"data-help-content": "也可以在这里直接添加，支持自定义哦。"
						},
						action: function(e) {
							var t = 0;
							i.place_list.forEach(function(e) {
								2 == e.type && t++
							}), t < 5 ? i.broadcast("show-add-hotel") : i.showTip("最多添加5个酒店", "error"), qyerUtil.doTrackCode("Planv3-mid-edit-addhotel")
						}
					}, {
						label: "添加当日笔记",
						icon: "note",
						attrs: {
							"data-help-index": 8,
							"data-help-direction": "right",
							"data-help-step": 1,
							"data-help-content": "点击这里添加当日笔记"
						},
						action: function(e) {
							i.showPopup('<section class="add-note popup" id="add-note" ng-controller="AddNoteController"><h1>添加笔记</h1><div class="textarea-wrapper qui-textArea" data-width="605" data-height="200"><textarea placeholder="添加备注的文字" maxlength="3000" class="ui2_textarea"></textarea><div class="tips"><span class="current"></span>/<span class="max"></span>字        </div></div><div class="controls"><a class="button vm" ng-click="closeThisDialog()" href="#" data-bn-ipg="Planv3-popup-addnote-cancel">取消</a><a class="button primary vm {{submiting&&\'submiting\'}}" href="#" ng-click="submit($event)" data-bn-ipg="Planv3-popup-addnote-confirm">确定</a></div><div class="upload-pic-box" ng-show="isLogin"><ul><li ng-repeat="image in images"><img class="pic-pic" src="{{image.url}}/80x80" /><div class="pic-view" data-index="{{$index}}" ng-click="showPic(image.url)"><i class="iconfont">&#58991;</i>点击查看</div><i class="pic-delete iconfont" ng-click=\'delImage($index,$event)\'>&#58992;</i></li><li ng-if=\'imgStatus == "error"\'><div class="pic-error"  ng-click="addImage()"><i class="iconfont">&#58990;</i>上传失败                    <br />重传</div></li><li ng-if=\'imgStatus == "loading"\'><i class="iconfont pic-loading"></i></li><li ng-if=\'images.length < 5 && imgStatus == "default"\'><i class="iconfont pic-add" ng-click="addImage()">&#58943;</i></li></ul><input type="hidden" id="uploadImg" /></div></section>', {
								closeTrackCode: "Planv3-popup-addnote-close"
							}), qyerUtil.doTrackCode("Planv3-mid-edit-addnote")
						}
					}, {
						label: "-"
					}, {
						label: "清空该日日程",
						icon: "trash-bin",
						disabled: !e.service.place_list || 0 === e.service.place_list.length,
						action: function(n) {
							var a = this;
							requirejs(["web_old_slidconfirm"], function(n) {
								n.confirm({
									text: "确认要清空这一天的日程？",
									target: a,
									onOK: function() {
										h(e.service.place_list, function(n) {
											e.$apply(function() {
												e.loading = !0
											}), t.removeEvents({
												data: {
													plan_id: t.getPlanId(),
													oneday_id: e.day.id,
													onedayevent_obj: n,
													confirm: L
												},
												onSuccess: function() {
													e.$apply(function() {
														e.loading = !1, e.service.place_list = []
													}), i.showTip("清空成功！", "ok"), u(), setTimeout(function() {
														$(".details-header").append($(".planner-day-details").prev(".planner-day-details-wrapper").children(".controls")), $(".details-header .controls").attr("style", "")
													}, 10)
												},
												onError: function(t) {
													i.showTip(t.data.msg, "error"), e.$apply(function() {
														e.loading = !1
													})
												}
											})
										}, a)
									}
								})
							}), qyerUtil.doTrackCode("Planv3-mid-edit-clearday")
						}
					}]
				}
			}, e.deletePlace = function(n, a) {
				var o = $(n.target).closest(".place-wrapper").find(".traffic"),
					r = e.service.place_list[a];
				o.length || (o = $(n.target).closest(".place-wrapper")), requirejs(["web_old_slidconfirm"], function(n) {
					n.confirm({
						text: "确认要删除这一地点？",
						target: o,
						onOK: function() {
							h([r], function(n) {
								e.$apply(function() {
									e.loading = !0
								}), t.removeEvents({
									data: {
										plan_id: t.getPlanId(),
										oneday_id: e.day.id,
										onedayevent_obj: n,
										confirm: L
									},
									onSuccess: function() {
										L ? $(".place-wrapper").eq(a).slideUp(250, function() {
											i.setSelectedDay()
										}) : (e.service.place_list.splice(a, 1), p()), e.$apply(function() {
											w(), e.loading = !1
										}), i.showTip("删除成功！", "ok"), i.broadcast("day-details-event-deleted"), i.broadcast("update-cart-icon")
									},
									onError: function(t) {
										e.$apply(function() {
											e.loading = !1
										}), i.showTip(t.data.msg, "error")
									}
								})
							}, o)
						}
					})
				}), qyerUtil.doTrackCode("Planv3-mid-poi-delete")
			}, e.placeOptions = {
				title: "操作",
				menu: [{
					label: "添加备注",
					icon: "ribbon",
					action: function(t) {
						var n = e.service.place_list[t.index];
						e.viewDetails(null, n, "edit"), qyerUtil.doTrackCode("Planv3-mid-poi-addnote")
					}
				}, {
					label: "移动到",
					icon: "move",
					submenu: function() {
						var a = t.getStartDate(),
							o = n("date"),
							r = [];
						return i.allDays.forEach(function(n, s) {
							if (s !== i.selectedDay.index) {
								var l, c, d;
								a ? (l = new Date(a.getTime() + 864e5 * s), c = o(l, "M月d日") + "（" + ["日", "一", "二", "三", "四", "五", "六"][l.getDay()] + "）") : c = "D" + (s + 1) + " ", d = n.city_list && n.city_list.length ? n.city_list.map(function(e) {
									return e.name
								}).join("→") : "暂无安排", r.push({
									label: c + d,
									action: function(n) {
										var a = e.service.place_list[n.index],
											o = [],
											r = a.id;
										3 == a.type && "@all" == a.display && o.push({
											type: 3,
											pid: a.from.id
										}, {
											type: 3,
											pid: a.to.id
										}), 3 == a.type && "@all" != a.display && o.push({
											type: 3,
											pid: a[a.display].id
										}), 3 != a.type && o.push({
											type: a.type,
											pid: a.id
										}), e.$apply(function() {
											e.loading = !0
										}), t.moveEvents({
											data: {
												plan_id: t.getPlanId(),
												oneday_id: e.day.id,
												to_oneday_id: i.allDays[s].id,
												onedayevent_obj: o
											},
											onSuccess: function() {
												e.$apply(function() {
													e.loading = !1;
													for (var t = e.service.place_list.length - 1; t >= 0; t--) e.service.place_list[t].id == r && e.service.place_list.splice(t, 1)
												}), i.broadcast("day-details-event-moved"), i.showTip("移动成功！", "ok"), u()
											},
											onError: function(t) {
												i.showTip(t.data.msg, "error"), e.$apply(function() {
													e.loading = !1
												})
											}
										}), qyerUtil.doTrackCode("Planv3-mid-poi-moveto")
									}
								})
							}
						}), r
					}
				}, {
					label: "批量操作",
					icon: "batch",
					action: function(e) {
						r(this), qyerUtil.doTrackCode("Planv3-mid-poi-group")
					}
				}, {
					label: "-"
				}]
			}, e.moveOptions = {
				title: "选择移动到的天",
				small: !0,
				offsetX: 60,
				offsetY: -10,
				menu: function() {
					var a = t.getStartDate(),
						o = n("date"),
						r = [];
					return i.allDays.forEach(function(n, l) {
						if (l !== i.selectedDay.index) {
							var c, d, u;
							a ? (c = new Date(t.getStartDate().getTime() + 864e5 * l), d = o(c, "M月d日") + "（" + ["日", "一", "二", "三", "四", "五", "六"][c.getDay()] + "）") : d = "D" + (l + 1) + " ", u = n.city_list && n.city_list.length ? n.city_list.map(function(e) {
								return e.name
							}).join("→") : "暂无安排", r.push({
								label: d + u,
								action: function(n) {
									var a = this;
									requirejs(["web_old_slidconfirm"], function(n) {
										n.confirm({
											text: "是否移动选中内容？",
											target: a,
											onOK: function() {
												var n = [],
													a = [];
												$(".details-body .checkbox-wrapper .checkbox.checked").each(function() {
													var e = $(this),
														t = parseInt(e.attr("data-type"));
													e.attr("data-id").split(",").map(function(e) {
														return parseInt(e)
													}).forEach(function(e) {
														n.push({
															type: t,
															pid: e
														})
													}), a.push(parseInt(e.attr("data-index")))
												}), a.sort(), e.$apply(function() {
													e.loading = !0
												}), t.moveEvents({
													data: {
														plan_id: t.getPlanId(),
														oneday_id: e.day.id,
														to_oneday_id: i.allDays[l].id,
														onedayevent_obj: n
													},
													onSuccess: function() {
														e.$apply(function() {
															for (e.loading = !1; a.length;) e.service.place_list.splice(a.pop(), 1)
														}), i.broadcast("day-details-event-moved"), s(), i.showTip("移动成功！", "ok")
													},
													onError: function(t) {
														e.$apply(function() {
															e.loading = !1
														}), i.showTip(t.data.msg, "error")
													}
												})
											}
										})
									})
								}
							})
						}
					}), r
				}
			}, e.viewDetails = function(t, n, a, o) {
				if (t && $(t.target).hasClass("delete")) t.preventDefault();
				else if (o) t.target.className.indexOf("notes") > -1 ? (e.viewDetails(t, n, "edit", !1), n.active = !0) : 3 == $(t.currentTarget).data("bnb") ? qyerUtil.doTrackCode("Planv3-mid-airbnbclick") : qyerUtil.doTrackCode("Planv3-mid-hotel-click");
				else {
					if (t && 1e3 != n.cateid && 1e3 != n.catetypeid || t && t.target && $(t.target).hasClass("notes")) {
						if (t.preventDefault(), $(t.target).hasClass("edit")) return;
						qyerUtil.doTrackCode("Planv3-mid-poi-click")
					}(1e3 != n.cateid && 1e3 != n.catetypeid || t && t.target && $(t.target).hasClass("notes") || "edit" === a) && (t && t.target && $(t.target).hasClass("notes") && (qyerUtil.doTrackCode("Planv3-mid-clicknote"), a = "edit"), n.active = !0, i.selectedLastminute = 1e3 == n.cateid || 1e3 == n.catetypeid, i.selectedEventId = P(n)[0], i.selectedPoiId = n.pid, i.selectedGroupId = n.group_id, i.slideType = "edit", i.initMode = a || "view", i.showSlide(["", "viewPOI", "viewHotel", "viewTraffic"][n.type], !t))
				}
			}, e.viewPath = function(t) {
				var n;
				if (i.selectedTraffic = {}, t < 0) n = e.hotel_traffic[Math.abs(t) - 1], -1 === t ? (i.selectedTraffic.startEvent = e.service.yesterday_hotel, i.selectedTraffic.endEvent = D(i.place_list[0])) : (i.selectedTraffic.startEvent = D(i.place_list[i.place_list.length - 1]), i.selectedTraffic.endEvent = e.service.today_hotel);
				else {
					if (3 == i.place_list[t].type && 4 != i.place_list[t].tripmode && 7 != i.place_list[t].tripmode && 3 === i.place_list[t + 1].type && 4 != i.place_list[t + 1].tripmode && 7 != i.place_list[t + 1].tripmode) return;
					n = e.traffic_list[t], i.selectedTraffic.startEvent = D(i.place_list[t], 1), i.selectedTraffic.endEvent = D(i.place_list[t + 1])
				}
				e.viewPathIndex = t, i.selectedTraffic.id = n.id, i.selectedTraffic.route_id = n.route_id, i.selectedTraffic.mode = n.tripmode, i.selectedTraffic.object = n, i.selectedTraffic.oneday_id = e.day.id, "map" === i.mode ? i.broadcast("poi-path-selected") : (i.setMode("map"), setTimeout(function() {
					$(window).resize()
				}, 0))
			}, e.$on("mode-changed", function(t, n) {
				"standard" === n && (e.viewPathIndex = null)
			}), e.showRecommendTraffic = function(a) {
				clearTimeout(M), M = setTimeout(function() {
					var o = $(a.target).closest(".item"),
						r = o,
						s = o.next(),
						l = n("date"),
						c = t.getStartDate(),
						d = $(a.target).closest("section").offset();
					c && l(new Date(c.getTime() + 864e5 * i.selectedDay.index), "y-M-d"), t.city2citytraffic({
						data: {
							from_cityid: r.attr("data-id"),
							from_cityname: r.attr("data-name"),
							to_cityid: s.attr("data-id"),
							to_cityname: s.attr("data-name")
						},
						onSuccess: function(t) {
							t.data && (e.$apply(function() {
								e.recommendTraffics = t.data || []
							}), $(".recommend-traffic").finish().css({
								top: $(a.target).offset().top - d.top + 30
							}).slideDown(250))
						},
						onError: function(e) {
							i.showTip(e.data.msg, "error")
						}
					}), qyerUtil.doTrackCode("Planv3-mid-city-transinfo")
				}, 500), a.preventDefault()
			}, e.hideRecommendTraffic = function(e) {
				clearTimeout(M), $(".recommend-traffic").finish().slideUp(250)
			}, e.addHotelOptions = {
				title: "添加住宿",
				menu: [{
					label: "智能推荐酒店",
					icon: "star-bed",
					action: function() {
						y(), qyerUtil.doTrackCode("Planv3-mid-nohotel-autorecommend")
					}
				}, {
					label: "手动添加酒店",
					icon: "bed",
					action: function() {
						i.broadcast("show-add-hotel"), qyerUtil.doTrackCode("Planv3-mid-nohotel-addmyself")
					}
				}]
			}, e.getEventTimeString = function(e, t) {
				var n = "";
				return -1 == e && -1 == t ? n : (n += -1 == e ? "00" : e < 10 ? "0" + e : e, n += ":", n += -1 == t ? "00" : t < 10 ? "0" + t : t)
			}, e.getTimeString = function(e) {
				return e ? 0 == e || "0.00" == e ? "" : e < 60 ? "，平均用时" + e + "分钟" : "，平均用时" + (e / 60).toFixed(1) + "小时" : ""
			}, e.getCardIcon = function(e) {
				switch (e.type) {
					case 3:
						return 7 === e.tripmode ? "&#59011;" : e.sameday ? "&#xe6ca;" : "&#xe6a5;";
					case 1:
						return {
							32: "&#59008;",
							78: "&#59009;",
							147: "&#59006;",
							148: "&#59012;",
							77: "&#59010;",
							1000: "&#58993;"
						}[e.poiType] || "&#59008;";
					default:
						return ["&#59010;", "&#59008;", "&#59014;", "&#59002;"][e.type]
				}
			}, e.getTrafficIco = function(e) {
				return {
					"": "&#xe6b2;",
					1: "&#xe6ae;",
					2: "&#xe6af;",
					3: "&#xe6ab;",
					4: "&#xe6ac;",
					5: "&#xe6aa;",
					6: "&#xe6b2;",
					7: "&#xe6ac;"
				}[e]
			}, e.getCardIconClass = function(e, t, n) {
				switch (e) {
					case 3:
						return ["", "airport", "train", "bus", "car", "ship", "other", "car"][t];
					case 1:
						return {
							32: "poi",
							78: "restaurant",
							147: "shopping",
							148: "activity",
							77: "otherplay",
							1000: "excellent"
						}[n] || "poi";
					default:
						return ["other", "poi", "hotel", "bus"][e]
				}
			}, e.$on("add-city-to-plan", function(t, n) {
				e.day.city_list.push({
					tagid: n.id,
					name: n.cityname
				}), d()
			}), $(".scroll-wrapper").addClass("scroll_top"), $(".scroll-wrapper").scroll(function(e) {
				var t = $(".scroll-wrapper").scrollTop();
				if ($(".scroll-wrapper").scrollTop() > 75 ? ($(".planner-day-details").prev(".planner-day-details-wrapper").append($(".details-header .controls")), $(".planner-day-details-wrapper .controls").css({
					left: $(".scroll-wrapper").css("left"),
					width: parseInt($(".scroll-wrapper").css("width")) - 32 + "px"
				})) : ($(".details-header").append($(".planner-day-details").prev(".planner-day-details-wrapper").children(".controls")), $(".details-header .controls").attr("style", "")), $(".planner-day-details").height() - t < $(".scroll-wrapper").height() ? ($(".planner-day-details .inner").append($(".details-footer")), $(".planner-day-details .details-footer").attr("style", "")) : ($(".planner-day-details-wrapper").append($(".details-footer")), $(".planner-day-details-wrapper .details-footer").css({
					left: $(".scroll-wrapper").css("left"),
					width: $(".scroll-wrapper").css("width")
				})), "webkit" == x()) {
					var n = $(this).height() + $(this).scrollTop() == $(".scroll-wrapper .inner").height() + $(".planner-day-notes").height() || $(this).height() + $(this).scrollTop() > $(".scroll-wrapper .inner").height() + $(".planner-day-notes").height();
					0 == $(this).scrollTop() ? $(this).addClass("scroll_top") : n ? $(this).addClass("scroll_bot") : $(this).removeClass("scroll_top scroll_bot")
				}
			}), $(window).resize(function() {
				$(".planner-day-details-wrapper .controls").css({
					left: $(".scroll-wrapper").css("left"),
					width: parseInt($(".scroll-wrapper").css("width")) - 32 + "px"
				}), $(".planner-day-details-wrapper .details-footer").css({
					left: $(".scroll-wrapper").css("left"),
					width: $(".scroll-wrapper").css("width")
				})
			});
			var q = "qyer_plan_" + t.getPlanId() + "_autoFillModel_loaded";
			t.isAutoPlan() && !sessionStorage.getItem(q) && (! function(e) {
					i.showPopup('<section class="optimize-plan popup" ng-controller="OptimizeFillController"><h1>每日景点推荐</h1><p class="subtitle" ng-if="status == \'ready\'">基于千万穷游er的经验，帮你推荐每日景点</p><p class="subtitle" ng-if="status == \'ready\'">&nbsp;</p><p class="subtitle" ng-if="status == \'loading\'">正在努力为您计算合适的行程...</p><div class="types" ng-if="status == \'ready\'"><div class="card" ng-click="doOptimize($event, 1)" data-bn-ipg="Planv3-edit-autocomplete-easy"><div class="relax iconfont">&#58961;</div><h4>宽松安排</h4><p>每天游玩4～6小时</p></div><div class="card" ng-click="doOptimize($event, 2)" data-bn-ipg="Planv3-edit-autocomplete-mid"><div class="mid iconfont">&#58962;</div><h4>适中安排</h4><p>每天游玩6～10小时</p></div><div class="card" ng-click="doOptimize($event, 3)" data-bn-ipg="Planv3-edit-autocomplete-tight"><div class="compact iconfont">&#58960;</div><h4>紧凑安排</h4><p>每天游玩11～16小时</p></div></div></section>', $.extend({
						closeTrackCode: "Planv3-edit-autocomplete-close"
					}, e))
				}({
					afterClose: y
				}), sessionStorage.setItem(q, "true")),
				function() {
					var a = n("date"),
						o = $("<input type='text' />").hide().datepicker({
							dayNamesMin: ["日", "一", "二", "三", "四", "五", "六"],
							monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
							dateFormat: "yy-mm-dd",
							changeYear: !0,
							changeMonthType: !0,
							onSelect: function(n) {
								var o = new Date($.datepicker.parseDate("yy-mm-dd", n)),
									r = a(o, "yyyy-MM-dd");
								if (i.broadcast("start-date-updated", r), e.index > 0) {
									var s = new Date($.datepicker.parseDate("yy-mm-dd", n) - 864e5 * e.index);
									n = a(s, "yyyy-MM-dd")
								}
								t.savePlanSetting({
									data: {
										planid: t.getPlanId(),
										starttime: n
									},
									onSuccess: function() {
										i.updateStartDate($.datepicker.parseDate("yy-mm-dd", n)), i.showTip("保存成功！", "ok")
									},
									onError: function(e) {
										i.showTip(e.data.msg, "error")
									}
								})
							}
						}).appendTo("body");
					$("#header-date-picker").click(function(n) {
						if (o.datepicker("widget").is(":hidden")) {
							var i, r = t.getStartDate();
							i = r ? new Date(r.getTime() + 864e5 * e.index) : new Date, o.val(a(i, "yyyy-MM-dd")), o.show().datepicker("show").hide(), o.datepicker("widget").css({
								top: $(n.target).offset().top + 20,
								left: $(n.target).offset().left
							})
						} else o.hide();
						n.preventDefault()
					})
				}()
		}
	])
}(),
function() {
	"use strict";
	angular.module("planner-day-details.notes", ["planner-api"]).directive("plannerDayNotes", [
		function() {
			return {
				restrict: "C",
				template: '<div ng-controller="DayNotesController"><section class="day-note" ng-repeat="note in notes" ng-click="editNote($event, note)" data-bn-ipg="Planv3-mid-note-click"><p>{{note.message.length>150?(note.message.substring(0,150)+" ..."):note.message}}</p><div class="images" ng-if="note.images&&note.images.length > 0"><img ng-repeat="image in note.images" src="{{image.url}}/80x80" /></div><a href="#" class="delete" ng-click="deleteNote($event, note)">删除</a></section></div>'
			}
		}
	]).controller("DayNotesController", ["$scope", "$api", "plannerService",
		function(e, t, n) {
			e.hoverLeft = 0, e.hoverTop = 0, e.$on("selected-day-notes-loaded", function() {
				e.notes = n.selectedDay.notes, setTimeout(function() {
					$(window).trigger("resize")
				}, 0)
			}), e.$on("selected-day-changed", function() {
				e.notes = n.selectedDay.notes
			}), e.$on("selected-day-notes-updated", function() {
				console.warn("selected-day-notes-updated", e.notes), e.$apply(function() {
					e.notes = n.selectedDay.notes
				})
			}), e.deleteNote = function(e, i) {
				requirejs(["web_old_slidconfirm"], function(a) {
					a.confirm({
						text: "确认要删除这一条笔记？",
						target: e.target,
						onOK: function() {
							t.deleteNote({
								data: {
									plan_id: t.getPlanId(),
									oneday_id: n.selectedDay.object.id,
									note_id: i.id
								},
								onSuccess: function() {
									n.deleteNote(i)
								}
							})
						}
					})
				}), e.preventDefault()
			}, e.editNote = function(e, t) {
				"delete" != e.target.className && (n.selectedNote = t, n.showSlide("editNote"))
			}
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-day-details.optimize-fill", []).controller("OptimizeFillController", ["$scope", "$api", "$filter", "plannerService",
		function(e, t, n, i) {
			e.status = "ready", e.doOptimize = function(n, a) {
				n.preventDefault();
				var o = new Date;
				e.status = "loading", setTimeout(function() {
					i.resizePopup()
				}, 0), t.optimizeFill({
					data: {
						planid: t.getPlanId(),
						type: a,
						version: 3
					},
					onSuccess: function(t) {
						e.$apply(function() {
							var t = new Date - o;
							t > 3e3 ? t = 0 : t <= 3e3 && (t = 3e3 - t), setTimeout(function() {
								e.closeThisDialog(), i.setSelectedDay()
							}, t)
						})
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}, setTimeout(function() {
				i.resizePopup()
			}, 0)
		}
	])
}(jQuery),
function(e) {
	"use strict";
	var t = {
			url: "//common3.qyerstatic.com/plan/desktop/edit3/img/pin.png",
			size: {
				w: 30,
				h: 38
			},
			point: {
				x: 0,
				y: 114
			}
		},
		n = [0, {
				32: 114,
				78: 152,
				147: 38,
				148: 76,
				77: 418
			},
			190, [0, 0, 342, 228, 304, 266, 380, 304]
		];
	angular.module("planner-day-details.optimize-hotel", []).controller("OptimizeHotelController", ["$scope", "$api", "$filter", "plannerService",
		function(i, a, o, r) {
			function s(e) {
				return e.filter(function(e) {
					return e.lat && e.lng
				})
			}

			function l() {
				_.map(y, function(e) {
					e.setMap(null), e = null
				}), y = []
			}

			function c() {
				if (h) {
					for (; g.length;) g.shift().close();
					m.empty(), l();
					var e = i.recommends[i.index].hotels || [],
						t = i.recommends[i.index].events || [];
					e.tag1.length > 0 || e.tag2.length > 0 || e.tag3.length > 0 ? (t.forEach(function(e) {
						e = s(e), e.forEach(p), _.chain(e).reduce(function(e, t) {
							var n = {
								lat: parseFloat(t.lat),
								lng: parseFloat(t.lng)
							};
							return e.length > 0 && e[e.length - 1].push(n), e.push([n]), e
						}, []).filter(function(e) {
							return 2 === e.length
						}).map(function(e) {
							var t = new google.maps.Polyline({
								path: _.map(e, function(e) {
									return {
										lat: e.lat,
										lng: e.lng
									}
								}),
								strokeColor: "#ef5941",
								strokeOpacity: .9,
								strokeWeight: 0,
								icons: [{
									icon: {
										path: "M 0,-1 0,1",
										strokeOpacity: 1,
										scale: 2
									},
									offset: "0",
									repeat: "10px"
								}],
								map: m.map
							});
							y.push(t), (new google.maps.DirectionsService).route({
								destination: e[1],
								origin: e[0],
								travelMode: google.maps.TravelMode.WALKING
							}, function(e, n) {
								t.map && n == google.maps.DirectionsStatus.OK && (t.setMap(null), e.routes.map(function(e) {
									var t = new google.maps.Polyline({
										path: e.overview_path,
										strokeColor: "#ef5941",
										strokeOpacity: .9,
										strokeWeight: 2
									});
									t.setMap(m.map), y.push(t)
								}))
							})
						})
					}), v = {}, e.tag1.forEach(d), e.tag2.forEach(d), e.tag3.forEach(d), m.fitBounds(e.tag1.concat(e.tag2).concat(e.tag3))) : (m.map.setCenter(new google.maps.LatLng(i.recommends[i.index].lat, i.recommends[i.index].lng)), m.map.setZoom(13))
				} else f(), requirejs(["web_qui_quigmap"], function(e) {
					e.init("route-map"), h = !0, m = e, c()
				})
			}

			function d(n, i) {
				var a = m.addMarker({
						lat: n.lat,
						lng: n.lng,
						icon: e.extend({}, t, {
							point: {
								x: 60,
								y: 190
							}
						})
					}),
					o = m.createDiyInfoWindow({
						content: '<div class="poi-name"><span>' + (n.cn_name || n.en_name) + '</span><div class="triangle"></div></div>',
						disableAutoPan: !0
					});
				m.addEvent(a, "mouseover", function() {
					o.open(m.map, a)
				}), m.addEvent(a, "mouseout", function() {
					o.close()
				}), m.addEvent(a, "click", function() {
					u(n.id)
				}), v[n.id] = a
			}

			function u(t) {
				var n = _.findIndex(i.hotels, function(e) {
					return e.id === t
				});
				i.hotelIndex = Math.floor(n / 3), i.hotelIndexStyle = {
					transform: "translateX(" + 990 * -i.hotelIndex + "px)"
				}, e("#recommend-hotel-" + t).animateCss("bounce"), i.$apply()
			}

			function p(i, a) {
				var o, r, s = n[i.type];
				1 == i.type && (s = s[i.catetypeid] || 114), 3 == i.type && (s = s[i.tripmode]), o = m.addMarker(e.extend({}, i, {
					icon: e.extend({}, t, {
						point: {
							x: 0,
							y: s
						}
					})
				})), r = m.createDiyInfoWindow({
					content: '<div class="poi-name"><span>' + (i.chinesename || i.englishname) + '</span><div class="triangle"></div></div>',
					disableAutoPan: !0
				}), r.open(m.map, o), g.push(r)
			}

			function f() {
				var t = e(window).width();
				e("#route-map").css({
					width: t + "px"
				})
			}
			var h = !1,
				g = [],
				m = null,
				v = {},
				y = [];
			i.status = "ready", i.chooses = 0, i.planId = a.getPlanId(), i.hotelIndex = 0, i.hotelIndexStyle = {}, i.showMap = !1, i.showMapClick = function() {
				i.showMap = !i.showMap
			}, i.pushHotels = function() {
				var e = i.recommends[i.index].hotels;
				i.hotels = [];
				for (var t = 0;;) {
					if (e.tag1[t] && (i.hotels.push(e.tag1[t]), i.hotels[i.hotels.length - 1].recommendReason = 0), i.hotels.length >= 15) break;
					if (e.tag2[t] && (i.hotels.push(e.tag2[t]), i.hotels[i.hotels.length - 1].recommendReason = 1), i.hotels.length >= 15) break;
					if (e.tag3[t] && (i.hotels.push(e.tag3[t]), i.hotels[i.hotels.length - 1].recommendReason = 2), i.hotels.length >= 15) break;
					if (!e.tag1[t] && !e.tag2[t] && !e.tag3[t]) break;
					t++
				}
				i.hotelIndex = 0, i.hotelIndexStyle = {}, i.hotelIndexMax = Math.floor((i.hotels.length - 1) / 3)
			}, i.doOptimize = function(t, n) {
				t && t.preventDefault(), i.status = "loading", r.resizePopup(), a.optimizeHotel({
					data: {
						planid: a.getPlanId(),
						onedayid: r.selectedDay.object.id,
						version: 3,
						type: n
					},
					onSuccess: function(t) {
						function n(e, t) {
							t.setDate(t.getDate() + e);
							var n = t.getFullYear(),
								i = t.getMonth() + 1,
								a = t.getDate();
							return t.setDate(t.getDate() - e), n + "-" + i + "-" + a
						}
						for (var o = "", s = 0; s < t.data.length; s++) {
							var l = t.data[s].hotels;
							if (l.tag1.length)
								for (var d = 0; d < l.tag1.length; d++) o += "," + l.tag1[d].base_hotel_id;
							if (l.tag2.length)
								for (var d = 0; d < l.tag2.length; d++) o += "," + l.tag2[d].base_hotel_id;
							if (l.tag3.length)
								for (var d = 0; d < l.tag3.length; d++) o += "," + l.tag3[d].base_hotel_id
						}
						if (o = o.substr(1), a.getStartDate() && new Date < a.getStartDate()) {
							i.priceloading = !0, i.priceTxt = !0;
							for (var s = 0; s < t.data.length; s++) {
								var l = t.data[s].hotels;
								if (l.tag1.length)
									for (var d = 0; d < l.tag1.length; d++) l.tag1[d].price = 0, l.tag1[d].hq_reference_price = 0;
								if (l.tag2.length)
									for (var d = 0; d < l.tag2.length; d++) l.tag2[d].price = 0, l.tag2[d].hq_reference_price = 0;
								if (l.tag3.length)
									for (var d = 0; d < l.tag3.length; d++) l.tag3[d].price = 0, l.tag3[d].hq_reference_price = 0
							}
							var u, p, f = a.getStartDate();
							u = n(0, f), p = n(1, f), i.checkinDate = u, i.checkoutDate = p, e.ajax({
								url: "/ajax.php?action=ajaxhotelavail&return_style=more&hotel_id=" + o + "&checkin=" + u + "&checkout=" + p,
								type: "post",
								dataType: "json",
								success: function(e) {
									i.priceloading = !1, t.data = _.map(t.data, function(t) {
										return _.each(["tag1", "tag2", "tag3"], function(n) {
											t.hotels[n] = _.map(t.hotels[n], function(t) {
												var n = e.data[t.base_hotel_id];
												return n && n.price && (t.price = n.price), t
											})
										}), t
									}), i.$apply()
								},
								error: function(e) {}
							}), e.ajax({
								url: "/api/v3/hotel/haoqiao/avail",
								type: "post",
								dataType: "json",
								data: {
									hotel_id: o,
									checkin: u,
									checkout: p
								},
								success: function(e) {
									i.hqPriceLoading = !1, t.data = _.map(t.data, function(t) {
										return _.each(["tag1", "tag2", "tag3"], function(n) {
											t.hotels[n] = _.map(t.hotels[n], function(t) {
												var n = e.data[t.base_hotel_id];
												return n && n.price && (t.hq_reference_price = n.price), t
											})
										}), t
									}), i.$apply()
								}
							})
						} else i.priceTxt = !1;
						i.$apply(function() {
							i.recommends = t.data, t.data.forEach(function(e, t) {
								1 == e.select && (i.index = t)
							}), i.index || (i.index = 0), i.pushHotels(), i.status = "loaded", c(), e(".optimize-hotel").closest(".ngdialog").addClass("dock"), r.resizePopup()
						}), e("section.optimize-hotel").next().attr("data-bn-ipg", "Planv3-recommendhotel-result-close")
					},
					onError: function(e) {
						console.log(e), i.$apply(function() {
							i.status = "successError", i.errorMsg = e.data.msg
						})
					}
				})
			}, i.autoSelect = function(e) {
				var t = [];
				i.recommends.forEach(function(e, n) {
					["tag1", "tag2", "tag3"].forEach(function(n, i) {
						e.hotels[n].forEach(function(n) {
							n && n.selected && t.push({
								oneday_list: e.oneday_list,
								hotelid: n.id,
								tag: n.tag,
								rafill_reason: n.rafill_reason,
								cn_name: n.cn_name,
								en_name: n.en_name
							})
						})
					})
				}), r.showLoadingTip("正在更新行程数据，请稍候"), a.optimizeHotelAutoSelect({
					data: {
						planid: a.getPlanId(),
						type: 2,
						version: 3,
						hotels: t
					},
					onSuccess: function(e) {
						i.closeThisDialog(), r.hideLoadingTip(function() {
							r.showTip("已帮您自动选择了" + e.data.hotelCount + "家酒店", "ok")
						}), r.setSelectedDay()
					},
					onError: function(e) {
						r.hideLoadingTip(function() {
							r.showTip(e.data.msg, "error")
						})
					}
				})
			}, i.submitSelect = function(e) {
				var t = [];
				i.recommends.forEach(function(e, n) {
					["tag1", "tag2", "tag3"].forEach(function(n, i) {
						e.hotels[n].forEach(function(n) {
							n && n.selected && t.push({
								oneday_list: e.oneday_list,
								hotelid: n.id,
								tag: n.tag,
								rafill_reason: n.rafill_reason,
								cn_name: n.cn_name,
								en_name: n.en_name
							})
						})
					})
				}), t.length > 0 ? (r.showLoadingTip("正在更新行程数据，请稍候"), a.optimizeHotelSelect({
					data: {
						planid: a.getPlanId(),
						hotels: t
					},
					onSuccess: function(e) {
						i.closeThisDialog(), r.hideLoadingTip(function() {
							r.showTip("已选择了" + e.data.hotelCount + "家酒店", "ok")
						}), r.setSelectedDay()
					},
					onError: function(e) {
						r.hideLoadingTip(function() {
							r.showTip(e.data.msg, "error")
						})
					}
				})) : r.showTip("您还没有选择任何酒店"), e.preventDefault()
			}, i.changeIndex = function(t, n) {
				t.preventDefault(), e(t.target).hasClass("disabled") || (-1 === n ? qyerUtil.doTrackCode("Planv3-recommendhotel-result-left") : qyerUtil.doTrackCode("Planv3-recommendhotel-result-right"), i.index += n, i.pushHotels(), c())
			}, i.changeHotelIndex = function(t, n) {
				t.preventDefault(), e(t.target).hasClass("commend-hotel-list__btn--disabled") || (i.hotelIndex += n, i.hotelIndexStyle = {
					transform: "translateX(" + 990 * -i.hotelIndex + "px)"
				})
			}, i.startAnimation = function(e) {
				var t = v[e];
				m && t && google && google.maps && t.setAnimation(google.maps.Animation.BOUNCE)
			}, i.stopAnimation = function(e) {
				var t = v[e];
				m && t && t.setAnimation(null)
			}, i.chooseHotel = function(e, t) {
				t.selected = !0, i.chooses++, e && e.preventDefault()
			}, i.cancelChoose = function(e, t) {
				t.selected = !1, i.chooses--, e.preventDefault()
			}, i.getDate = function(e, t) {
				var n = a.getStartDate(),
					i = e || t;
				return i ? n ? new Date(n.getTime() + 864e5 * (i - 1)) : "D" + i : "无日期索引"
			}, i.getIntNumber = function(e) {
				return Math.ceil(e)
			}, e(window).on("resize.optimizeHotel", function() {
				e(".optimize-hotel").size() ? f() : e(window).off("resize.optimizeHotel")
			}), setTimeout(function() {
				r.resizePopup()
			}, 0), e.fn.extend({
				animateCss: function(t) {
					e(this).addClass("animated " + t).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend", function() {
						e(this).removeClass("animated " + t)
					})
				}
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	var t = {
			url: "//common3.qyerstatic.com/plan/desktop/edit3/img/pin.png",
			size: {
				w: 30,
				h: 38
			},
			point: {
				x: 0,
				y: 114
			}
		},
		n = [0, {
				32: 114,
				78: 152,
				147: 38,
				148: 76,
				77: 418
			},
			190, [0, 0, 342, 228, 304, 266, 380, 304]
		];
	angular.module("planner-day-details.optimize-one-day", []).controller("OptimizeOneDayController", ["$scope", "$api", "$filter", "plannerService",
		function(i, a, o, r) {
			function s() {
				_.map(p, function(e) {
					e.setMap(null), e = null
				}), p = []
			}

			function l() {
				if (c) {
					for (; d.length;) d.shift().close();
					u.clearMarker(), s();
					var a = i[i.period].eventList.filter(function(e) {
						return e.lat && e.lng
					});
					a.forEach(function(i, a) {
						var o, r, s;
						2 == i.type ? o = n[2] : (1 == i.type && (o = n[1][i.cateid || i.catetypeid || 32] || 114), 3 == i.type && (o = n[3][i.tripmode])), r = u.addMarker(e.extend({}, i, {
							icon: e.extend({}, t, {
								point: {
									x: 0,
									y: o
								}
							})
						})), s = u.createDiyInfoWindow({
							content: '<div class="poi-name"><span><mark>' + (a + 1) + "</mark>" + i.event_name + '</span><div class="triangle"></div></div>'
						}), s.open(u.map, r), d.push(s), u.addEvent(r, "click", function() {
							console.log("click", this)
						})
					}), _.chain(a).reduce(function(e, t) {
						var n = {
							lat: parseFloat(t.lat),
							lng: parseFloat(t.lng)
						};
						return e.length > 0 && e[e.length - 1].push(n), e.push([n]), e
					}, []).filter(function(e) {
						return 2 === e.length
					}).map(function(e) {
						var t = new google.maps.Polyline({
							path: _.map(e, function(e) {
								return {
									lat: e.lat,
									lng: e.lng
								}
							}),
							strokeColor: "#ef5941",
							strokeOpacity: .9,
							strokeWeight: 0,
							icons: [{
								icon: {
									path: "M 0,-1 0,1",
									strokeOpacity: 1,
									scale: 2
								},
								offset: "0",
								repeat: "10px"
							}],
							map: u.map
						});
						p.push(t), (new google.maps.DirectionsService).route({
							destination: e[1],
							origin: e[0],
							travelMode: google.maps.TravelMode.WALKING
						}, function(e, n) {
							t.map && n == google.maps.DirectionsStatus.OK && (t.setMap(null), e.routes.map(function(e) {
								var t = new google.maps.Polyline({
									path: e.overview_path,
									strokeColor: "#ef5941",
									strokeOpacity: .9,
									strokeWeight: 2
								});
								t.setMap(u.map), p.push(t)
							}))
						})
					}), u.fitBounds(a)
				} else f(), requirejs(["web_qui_quigmap"], function(e) {
					e.init("route-map"), c = !0, u = e, l()
				})
			}
			var c = !1,
				d = [],
				u = null,
				p = [];
			i.status = "ready", i.place_list = r.selectedDay.place_list, i.city_list = r.selectedDay.object.city_list, i.getDate = function() {
				var e, t = a.getStartDate(),
					n = o("date");
				return t ? (e = new Date(t.getTime() + 864e5 * r.selectedDay.index), n(e, "M月d日") + "（周" + ["日", "一", "二", "三", "四", "五", "六"][e.getDay()] + "）") : "Day " + (r.selectedDay.index + 1)
			}, i.doOptimize = function(t) {
				t.preventDefault(), e(".optimize-one-day").closest(".ngdialog").removeClass("dock"), e("section.optimize-one-day").next().removeAttr("data-bn-ipg"), i.status = "loading", r.resizePopup(), a.optimizeOneDay({
					data: {
						plan_id: a.getPlanId(),
						oneday_id: r.selectedDay.object.id,
						s_point: i.start_id,
						e_point: i.destination_id
					},
					onSuccess: function(t) {
						i.$apply(function() {
							i.before = t.data.bfList, i.after = t.data.afList, i.period = "after", i.status = "loaded", e("#optimize-form").children().appendTo("#reoptimize-form"), e(".optimize-one-day").closest(".ngdialog").addClass("dock"), r.resizePopup()
						}), e("section.optimize-one-day").next().attr("data-bn-ipg", "Planv3-optimize-oneday-close"), l()
					},
					onError: function(e) {
						r.showTip(e.data.msg, "error"), i.$apply(function() {
							i.status = "ready"
						})
					}
				})
			}, i.sortableOptions = {
				start: function() {},
				stop: function(e, t) {}
			}, i.changePeriod = function(e) {
				i.period = e, l()
			}, i.applyOptimize = function(e) {
				e.preventDefault(), r.showLoadingTip("正在更新行程数据，请稍候"), a.reorderEvents({
					data: {
						plan_id: a.getPlanId(),
						oneday_id: r.selectedDay.object.id,
						onedayevent_obj: i.after.eventList.map(function(e) {
							return {
								pid: e.onedayeventid,
								type: e.type
							}
						})
					},
					onSuccess: function() {
						i.closeThisDialog(), r.setSelectedDay(), r.hideLoadingTip(function() {
							r.showTip("优化成功！", "ok")
						})
					},
					onError: function(e) {
						r.hideLoadingTip(function() {
							r.showTip(e.data.msg, "error")
						})
					}
				})
			};
			var f = _.throttle(function() {
				var t = e(window).width() - 500,
					n = e(window).height() - 60;
				e("#route-map").css({
					width: t + "px",
					height: n + "px"
				})
			}, 200);
			require(["web_qui_quiselect"], function(e) {
				new e({
					target: "#optimize-start",
					exClassName: "full",
					onChange: function() {
						qyerUtil.doTrackCode("loaded" == i.status ? "Planv3-optimize-oneday-changestart" : "Planv3-optimize-onedayoption-changestart")
					}
				}), new e({
					target: "#optimize-destination",
					exClassName: "full",
					onChange: function() {
						qyerUtil.doTrackCode("loaded" == i.status ? "Planv3-optimize-oneday-changeend" : "Planv3-optimize-onedayoption-changeend")
					}
				});
				r.resizePopup()
			}), e(window).on("resize.optimizeOneDay", function() {
				e("#route-map").size() ? f() : e(window).off("resize.optimizeOneDay")
			}), i.getOptimizeStr = function(e, t) {
				if (!e || !t) return "";
				if (e.distance == t.distance) return "线路合理,无需优化.";
				var n = e.distance - t.distance;
				return n < 0 ? "优化结果如下: " : "优化结果: 节约了" + n.toFixed(2) + "公里路程。"
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	var t = {
			url: "//common3.qyerstatic.com/plan/desktop/edit3/img/pin.png",
			size: {
				w: 30,
				h: 38
			},
			point: {
				x: 0,
				y: 114
			}
		},
		n = [0, {
				32: 114,
				78: 152,
				147: 38,
				148: 76,
				77: 418
			},
			190, [0, 0, 342, 228, 304, 266, 380, 304]
		];
	angular.module("planner-day-details.optimize-plan", []).controller("OptimizePlanController", ["$scope", "$api", "$filter", "plannerService",
		function(i, a, o, r) {
			function s() {
				_.map(f, function(e) {
					e.setMap(null), e = null
				}), f = []
			}

			function l(a) {
				var o, r = [],
					h = [],
					g = null;
				if (d) {
					for (; u.length;) u.shift().close();
					if (p.empty(), s(), "after" == i.period ? (r = i.after.days, o = "pois") : (r = i.before, o = "event_list"), r.forEach(function(i) {
						if (i.selected) {
							var a = i[o].filter(function(e) {
								return e.lat && e.lng
							});
							i.citys && i.citys.length > 0 && (g = i.citys[i.citys.length - 1]), h = h.concat(a.map(function(e) {
								return {
									lat: e.lat,
									lng: e.lng
								}
							})), a.forEach(function(i, a) {
								var o, r, s = n[i.type];
								1 == i.type && (s = s[i.cateid || i.catetypeid] || 114), 3 == i.type && (s = s[i.tripmode]), o = p.addMarker({
									lat: i.lat,
									lng: i.lng,
									icon: e.extend({}, t, {
										point: {
											x: 0,
											y: s
										}
									})
								}), r = p.createDiyInfoWindow({
									content: '<div class="poi-name"><span><mark>' + (a + 1) + "</mark>" + (i.cn_name || i.event_name || i) + '</span><div class="triangle"></div></div>'
								}), r.open(p.map, o), u.push(r)
							}), _.chain(i[o]).reduce(function(e, t) {
								var n = {
									lat: parseFloat(t.lat),
									lng: parseFloat(t.lng)
								};
								return e.length > 0 && e[e.length - 1].push(n), e.push([n]), e
							}, []).filter(function(e) {
								return 2 === e.length
							}).map(function(e) {
								var t = new google.maps.Polyline({
									path: _.map(e, function(e) {
										return {
											lat: e.lat,
											lng: e.lng
										}
									}),
									strokeColor: "#ef5941",
									strokeOpacity: .9,
									strokeWeight: 0,
									icons: [{
										icon: {
											path: "M 0,-1 0,1",
											strokeOpacity: 1,
											scale: 2
										},
										offset: "0",
										repeat: "10px"
									}],
									map: p.map
								});
								f.push(t), (new google.maps.DirectionsService).route({
									destination: e[1],
									origin: e[0],
									travelMode: google.maps.TravelMode.WALKING
								}, function(e, n) {
									t.map && n == google.maps.DirectionsStatus.OK && (t.setMap(null), e.routes.map(function(e) {
										var t = new google.maps.Polyline({
											path: e.overview_path,
											strokeColor: "#ef5941",
											strokeOpacity: .9,
											strokeWeight: 2
										});
										t.setMap(p.map), f.push(t)
									}))
								})
							})
						}
					}), 0 === h.length && g && g.lat && g.lng) {
						var m = p.addMarker({
								lat: g.lat,
								lng: g.lng,
								icon: t
							}),
							v = p.createDiyInfoWindow({
								content: '<div class="poi-name"><span>' + g.name + '</span><div class="triangle"></div></div>'
							});
						v.open(p.map, m), u.push(v), h.push(g)
					}
					p.fitBounds(h)
				} else c(), requirejs(["web_qui_quigmap"], function(e) {
					e.init("route-map"), d = !0, p = e, l()
				});
				a && qyerUtil.doTrackCode("Planv3-optimize-allday-mapdate")
			}

			function c() {
				var t = e(window).width() - 500,
					n = e(window).height() - 60;
				e("#route-map").css({
					width: t + "px",
					height: n + "px"
				})
			}
			var d = !1,
				u = [],
				p = null,
				f = [];
			i.status = "ready", i.period = "after", i.toggleMore = function(t) {
				var n = e(t.target),
					i = n.prev();
				i.is(":visible") ? (i.finish().slideUp(250), n.text("展开全部介绍")) : (i.finish().slideDown(250), n.text("收起全部介绍")), t.preventDefault()
			}, i.getDate = function(e) {
				var t, n = a.getStartDate(),
					i = o("date");
				return n ? (t = new Date(n.getTime() + 864e5 * (e - 1)), i(t, "M月d日") + "（周" + ["日", "一", "二", "三", "四", "五", "六"][t.getDay()] + "）") : "Day " + e
			}, i.changePeriod = function(e, t) {
				"before" == t && i.before.forEach(function(e, t) {
					e.selected = i.after.days[t].selected
				}), "after" == t && i.after.days.forEach(function(e, t) {
					e.selected = i.before[t].selected
				}), i.period = t, l(), e.preventDefault()
			}, i.doOptimize = function(t, n) {
				t.preventDefault(), i.status = "loading", setTimeout(function() {
					r.resizePopup()
				}, 0), a.optimizePlan({
					data: {
						plan_id: a.getPlanId(),
						type: n
					},
					onSuccess: function(t) {
						i.$apply(function() {
							i.after = t.data.aflist, i.before = t.data.bflist, i.rafill_reason = t.data.rafill_reason, i.before.forEach(function(e, t) {
								e.selected = t < 2
							}), i.after.days.forEach(function(e, t) {
								e.selected = t < 2
							}), i.status = "loaded", e(".optimize-plan").closest(".ngdialog").addClass("dock"), r.resizePopup(), l()
						}), e("section.optimize-plan").next().attr("data-bn-ipg", "Planv3-optimize-allday-close")
					},
					onError: function(e) {
						r.showTip(e.data.msg, "error")
					}
				})
			}, i.applyOptimize = function(e) {
				r.showLoadingTip("正在更新行程数据，请稍候"), a.optimizePlanApply({
					data: {
						plan_id: a.getPlanId(),
						startdayNum: i.after.days[0].dayNum,
						rafill_reason: i.rafill_reason,
						days: i.after.days.map(function(e) {
							return {
								onedayid: e.onedayid,
								pois: e.pois.map(function(e) {
									return {
										eventid: e.eventid,
										pid: e.pid
									}
								})
							}
						}),
						deletedpois: i.after.deletedpois.map(function(e) {
							return {
								eventid: e.eventid,
								pid: e.pid
							}
						})
					},
					onSuccess: function(e) {
						i.closeThisDialog(), r.hideLoadingTip(function() {
							r.showTip("优化成功", "ok")
						}), r.setSelectedDay()
					},
					onError: function(e) {
						r.showTip(e.data.msg, "error")
					}
				})
			}, i.sortableOptions = {
				start: function() {},
				stop: function(e, t) {},
				connectWith: ".box > ul"
			}, i.removePoi = function(e, t, n) {
				r.showConfirm("是否删除该景点？", e.target, function() {
					var e = i.after.days[t].pois.splice(n, 1)[0];
					i.after.deletedpois.push(e), i.$apply(), qyerUtil.doTrackCode("Planv3-optimize-allday-deleteyes")
				}, function() {
					qyerUtil.doTrackCode("Planv3-optimize-allday-deleteno")
				}), e.preventDefault()
			}, i.restorePoi = function(e) {
				var t = i.after.deletedpois.splice(e, 1)[0];
				i.after.days.forEach(function(e) {
					e.onedayid == t.onedayid && e.pois.push(t)
				}), qyerUtil.doTrackCode("Planv3-optimize-allday-return")
			}, i.refreshMap = l, e(window).on("resize.optimizePlan", function() {
				e(".optimize-plan").size() ? c() : e(window).off("resize.optimizePlan")
			}), setTimeout(function() {
				r.resizePopup()
			}, 0)
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-header-help", []).controller("helpController", ["$scope", "$api", "plannerService",
		function(e, t, n) {
			var i = {
					3: 2,
					4: 2,
					8: 2
				},
				a = [],
				o = [],
				r = null;
			a[3] = [], a[4] = [], a[8] = [], a[2] = a[3][1] = a[4][1] = function() {
				n.setMode("standard"), setTimeout(function() {
					$(window).resize()
				}, 0)
			}, a[3][2] = a[4][2] = a[8][1] = function() {
				$(".details-header .edit").click()
			}, a[5] = function() {
				n.place_list.filter(function(e) {
					return 3 == e.type
				}).length < 20 && (n.isSelectedTrafficData = !1, n.broadcast("show-add-traffic"))
			}, a[8][2] = function() {
				$(".dropdown .close").click()
			}, o[6] = "点击两个安排之间的灰色条，就会出现交通方案了。（位置缺失的情况下，无法查询交通方案）", o[11] = "点击酒店或酒店右侧的设置按钮，选择要移动到的日期就好啦", e.content = "", e.url = "https://bbs.qyer.com/thread-2482054-1.html", e.images = [], e.getContentLen = function() {
				return r || (r = $("#js_helpContent")), (e.content || r.val()).length
			}, e.removeImage = function(t) {
				e.images.splice(t, 1)
			}, e.addImage = function() {
				$("#uploadSuggestionImage").trigger("click")
			}, e.send = function(i) {
				r || (r = $("#js_helpContent"));
				var a = e.content || r.val();
				return a ? a.length > 500 ? void n.showTip("最多输入500个字", "warning") : void t.feedback({
					data: {
						content: r.val(),
						images: e.images.map(function(e) {
							return e.key
						})
					},
					onSuccess: function(t) {
						n.showTip("发送成功", "ok"), e.closeThisDialog()
					},
					onError: function(e) {
						n.showTip(e.data.msg, "error")
					}
				}) : void n.showTip("请输入内容", "warning")
			}, e.showTip = function(t, n) {
				!n && e.closeThisDialog(), !n && t in i && (n = 1), n && Array.isArray(a[t]) ? a[t][n] && a[t][n]() : a[t] && a[t](), setTimeout(function() {
					var a = [],
						r = [],
						s = [],
						l = [];
					if ($("[data-help-index]").each(function(e, i) {
						var o = $(i).attr("data-help-index").split("|"),
							c = o.indexOf(t + ""),
							d = $(i).attr("data-help-step");
						if (c > -1) {
							if (d && ((d = d.split("|")[c]) <= 0 || d != n)) return;
							a.push($(i)), r.push($(i).attr("data-help-direction").split("|")[c]), s.push($(i).attr("data-help-content").split("|")[c]);
							var u = $(i).attr("data-help-left-offset");
							u ? l.push(u.split("|")[c]) : l.push(0)
						}
					}), a.length > 0) a.map(function(e, t) {
						var n = $("<div>", {
								class: ["black-tip", r[t]].join(" "),
								text: s[t]
							}),
							i = r[t],
							a = parseInt(l[t]);
						0 === e.offset().top && 0 === e.offset().left || (n.appendTo(document.body), "top" === i || "bottom" === i ? (n.css("left", e.offset().left + (e.outerWidth() - n.outerWidth()) / 2 + a), "top" === i ? n.css("top", e.offset().top - n.outerHeight() - 5) : n.css("top", e.offset().top + e.outerHeight() + 5)) : (n.css("top", e.offset().top + (e.outerHeight() - 36) / 2), "left" === i ? n.css("left", e.offset().left - n.outerWidth() - 5 + a) : n.css("left", e.offset().left + e.outerWidth() + 5 + a)))
					});
					else {
						var c = o[t];
						if (c) {
							var d = $("<div>", {
								class: "black-tip",
								text: c
							}).appendTo(document.body);
							d.css({
								left: ($(window).width() - d.outerWidth()) / 2,
								top: ($(window).height() - d.outerHeight()) / 2
							})
						}
					}
					$(document.body).on("click.hidetip", function(a) {
						if ("__dotarckcodebutton__" !== a.target.id && 0 === $(a.target).closest(".black-tip").size() && ($("body > .black-tip").remove(), $(document.body).off("click.hidetip"), n && n < i[t])) {
							if (8 == t && $(a.target).closest("[data-help-index=8]").size() > 0) return;
							8 == t && $(a.target).hasClass("close") ? setTimeout(function() {
								e.showTip(t, n + 1)
							}, 500) : e.showTip(t, n + 1)
						}
					})
				}, 250)
			}, setTimeout(function() {
				$(".helpPopup").closest(".ngdialog-content").css({
					width: "950px",
					marginLeft: "-475px"
				}), n.uploadPlanPic({
					browse_button: "uploadSuggestionImage",
					container: "helpPopup",
					paths: ["plan", "question"],
					FileUploaded: function(t, n) {
						e.images.push($.extend({
							name: n.name
						}, t)), e.$apply()
					},
					UploadError: function() {
						n.showTip("上传失败！", "error")
					}
				}), n.resizePopup()
			}, 0)
		}
	])
}(),
function() {
	"use strict";
	angular.module("planner-header", ["planner-header-help", "planner-header-share"]).directive("plannerHeader", [
		function() {
			return {
				restrict: "A",
				template: '<div ng-controller="PlannerHeaderController" class="inner" id = "pdf-header" ><div class="title"><a class="logo" href="/" target="_blank" data-bn-ipg="Planv3-tool-LOGO"><i class="iconfont">&#xe63d;</i></a><div class="text" ng-if="!editing"><span ng-click="startEditing()">{{title}}</span><div class="black-tip bottom">点击修改标题</div></div><div class="modify" ng-if="editing"><input id="modify-title" type="text" value="{{title}}" maxlength="36"><a href="#" ng-click="stopEditing()">取消</a><a href="#" class="modify-confirm" ng-click="saveEditing()" data-bn-ipg="Planv3-tool-rename">确定</a></div></div><ul class="preview-modes"><li ng-click="changeMode($event, \'standard\')" ng-class="{true: \'active\'}[service.mode == \'standard\']"><em class="icon hamburg"></em>标准模式</li><li ng-click="changeMode($event, \'map\')" ng-class="{true: \'active\'}[service.mode == \'map\']"><em class="icon map-mode"></em>地图模式</li></ul><ul class="edit"><li><a href="#">上一步</a></li><li><a href="#">重做</a></li></ul><div class="user-login" ng-if="!isLogin" ng-click="doLogin()"><em class="iconfont">&#xe66d;</em><span>请登录</span><span class="wide-screen">使用更多功能<span></div>\x3c!--a href="https://plan.qyer.com/topic/luckymoney" target="_blank" data-bn-ipg="planv3-top-button" class="evt-1202" ng-if="isLogin">订酒店返现金</a--\x3e<div class="links"><a href="#" class="link iconfont" ng-click="showHelp()" data-bn-ipg="Planv3-tool-help">&#58950;</a><div class="sep"></div><a ng-if="isLogin" href="{{url}}" target="_blank" class="link" data-bn-ipg="Planv3-tool-preview">预览</a><a ng-if="!isLogin" href="#" class="link" ng-click="doLogin()" data-bn-ipg="Planv3-tool-preview">预览</a><div class="sep"></div><a ng-if="isLogin" href="#" class="link" ng-click="showShare()" data-bn-ipg="Planv3-tool-share">分享</a><a ng-if="!isLogin" href="#" class="link" ng-click="doLogin()" data-bn-ipg="Planv3-tool-share">分享</a></div><div class="export"><a href="#" ng-click="toggleExport($event)">导出行程<span class="triangle"></span></a><div id="export-selector" class="dropdown"><ul><li class="with-icon icon-word" ng-click="exportWord($event)">          导出word行程单        </li><li class="with-icon icon1" ng-click="closeExport($event, true)"><a class="link" href="/planapi.php?action=downexcel&amp;id={{planId}}" target="_blank" ng-click="showAppAd()">送签专用行程单</a></li><li class="with-icon icon2" ng-click="exportPDF($event)">PDF详细行程单</li><li class="with-icon icon3"><a class="link" href="//app.qyer.com/plan/" target="_blank" data-bn-ipg="Planv3-tool-export-mobile">手机查看行程单</a></li></ul></div><div class="dropdown dropdown-pdf"><form action="/export.php?action=generatepdf" method="post" target="_blank"><input type="hidden" name="routeid" value="{{planId}}" /><input type="hidden" name="trip[]" value="1" /><input type="hidden" name="memo" value="1" /><h3>导出PDF选项<span>基础行程是最基本的元素。此外，你可以选择：</span></h3><a href="#" class="close" ng-click="closeExport($event)">关闭</a><ul><li><input type="checkbox" ng-model="cover" name="cover" value="1" checkbox checked><span>封面</span></li><li><input type="checkbox" ng-model="calendar" name="calendar" value="1" checkbox checked><span>日历表行程</span></li><li><input type="checkbox" ng-model="tripAll" checkbox checked disabled><span>行程</span><ul><li><input type="checkbox" ng-model="tripBasic" name="trip[]" value="1" checkbox checked disabled><span>基础行程</span></li><li><input type="checkbox" ng-model="tripMap" name="trip[]" value="2" checkbox checked><span>每日地图</span></li><li><input type="checkbox" ng-model="tripInfo" name="trip[]" value="8" checkbox checked><span>景点详细介绍</span></li><li><input type="checkbox" ng-model="allmap" name="allmap" value="1" checkbox checked><span>全程地图</span></li><li id="b_tripZworld"><input type="checkbox" ng-model="tripZworld" name="trip[]" value="4" checkbox checked><span>最世界产品</span></li></ul></li><li id="b_cost"><input type="checkbox" ng-model="cost" name="cost" value="1" checkbox checked><span>行程花费</span></li>\x3c!-- <li><input type="checkbox" ng-model="memo" name="memo" value="1" checkbox checked><span>备忘录</span></li> --\x3e<li><input type="checkbox" ng-model="pageshow" name="pageshow" value="1" checkbox checked><span>每日行程分页显示</span></li></ul><div class="control"><a href="#" class="button" data-bn-ipg="Planv3-PDF-close" ng-click="closeExport($event)">取消</a>\x3c!-- <a href="#" class="primary button" ng-click="submit($event)">导出</a> --\x3e<a href="#" class="button primary" data-bn-ipg="Planv3-PDF-nextstep" ng-click="showPdfModify()">下一步</a></div></form></div><div class="dropdown-word"><form action="/exportword.php" method="post" target="_blank" ><input type="hidden" name="routeid" value="{{planId}}" /><h3>导出Word选项<span></span></h3><a href="#" class="close" ng-click="closeWord($event)">关闭</a><table width="100%"><tr><td>餐饮</td><td><input type="text" name="food" value="酒店含早 中式午餐 中式晚餐" ></td></tr><tr><td>住宿</td><td><input type="text" name="hote" value="三星级酒店标准双人间（含早餐)" ></td></tr></table><div class="control"><a href="#" class="button" ng-click="closeWord($event)">取消</a><a href="#" class="primary button" ng-click="submit($event)">导出</a></div></form></div><div class="mask-pdf"></div><div class="pdf-modify dropdown"><h3>点击修改行程标题和封面图</h3><a href="#" class="close" ng-click="closeExport($event)">关闭</a><div class="modify-cont" id="modify-cont"><div class="modify-bg"><span ng-if="!pdfTitlEditing" class="modify-title" data-bn-ipg="Planv3-PDF-cover-tittle" ng-click="startPdfEditTitle($event)">{{pdf_cn_name}}</span><input ng-if="pdfTitlEditing" class="input-modify-title" type="text" value="{{pdf_cn_name}}" ng-keydown="stopPdfEditTitle($event)" ng-blur="stopPdfEditTitle($event)"><div class="modify-img"><form id="upload-cover-form-pdf"                enctype="multipart/form-data"                method="post"                action="/ajax.php?action=singleupload"><img src="{{pdf_pic}}"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/pdf_bg.png"><div  class="imgupload"><a href="##" class="iconfont">&#xe699;<input id="upload-cover-field-pdf" type="file" name="Filedata" data-bn-ipg="Planv3-PDF-cover-image"></a></div><div ng-if=\'imgLoadStatus == "loading"\' class="iconfont pdfimg-loading"></div><input type="hidden" name="type" value="plan"><input type="hidden" name="plan_id" value="{{planId}}"></form></div></div></div><div class="control"><a href="#" class="button" data-bn-ipg="Planv3-PDF-cover-laststep" ng-click="exportPDF()">上一步</a><a href="#" class="primary button" data-bn-ipg="Planv3-PDF-cover-export" ng-click="submitPdf($event)">导出</a></div></div></div><div class="insurancelayer"><div class="insurance_main"><div ng-if="isSchengen" class="insurance_top"><h3>申根保险销量Top3</h3><span>申根签证必备，旅行贴心保障</span></div><div ng-if="!isSchengen" class="insurance_top"><h3>旅行保险销量Top3</h3><span>在外旅行可能会面临多种突发情况，购买旅行保险可以多一份保障与安心</span></div><ul class="insurance_list"><li ng-repeat="item in insuranceData"><a href="{{item.href}}" target="_blank" data-bn-ipg="{{item.code}}"><img src="//common3.qyerstatic.com/plan/new/project/web/plan/img/insurance_{{item.image}}.png" class="listimg" height="160" width="300"><div class="listop"><div class="listitle">{{item.title}}</div><span class="tips">销量第{{[\'一\', \'二\', \'三\'][$index]}}</span><div class="tips_price"><span class="price">¥<b>{{item.price}}</b>起</span> 已售{{item.sales}}份 <span class="line">|</span>{{item.percent}}%穷游er选择 </div><div class="tag"><span ng-repeat="tag in item.tags">{{tag}}</span></div><div class="tips_title"><span class="iconfont">&#58931;</span>推荐理由：</div><ul class="reasons"><li ng-repeat="reason in item.reasons">{{reason}}</li></ul></div><cite><figure><img src="//common3.qyerstatic.com/plan/new/project/web/plan/img/insurance_u{{item.image}}.png"></figure><div class="text-container" title="{{item.comment}}" ng-class="{true: \'long-fix\'}[item.long]">                “{{item.comment}}”              </div></cite></a></li></ul></div><div class="close" data-bn-ipg="{{insuranceCloseCode}}"></div></div><div class="app-ad"><div class="main"><div class="phone"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/app-ad-scene-1.jpg"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/app-ad-scene-2.jpg" style="display:none"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/app-ad-scene-3.jpg" style="display:none"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/app-ad-scene-4.jpg" style="display:none"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/app-ad-scene-5.jpg" style="display:none"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/app-ad-scene-6.jpg" style="display:none"></div><div class="close"></div></div></div></div>'
			}
		}
	]).controller("PlannerHeaderController", ["$scope", "$api", "plannerService",
		function(e, t, n) {
			function i() {
				$(document).height() < 747 ? $("header .export .dropdown form>ul").css({
					height: "400px",
					"overflow-y": "auto"
				}) : $("header .export .dropdown form>ul").css({
					height: "auto"
				})
			}

			function a() {
				t.doHeartBeat({
					data: {
						planid: t.getPlanId()
					},
					onSuccess: o,
					onError: o
				})
			}

			function o() {
				setTimeout(function() {
					c += d, c >= 72e5 ? requirejs(["web_old_confirm"], function(e) {
						e.confirm({
							title: "提示",
							text: "您已编辑超过两小时，如要继续编辑，请点击确定按钮。",
							type: "warning",
							onOK: function() {
								window.location.reload()
							}
						})
					}) : a()
				}, d)
			}

			function r() {
				e.changeMode({
					target: $("ul.preview-modes > li:eq(1)").get()
				}, "map")
			}

			function s() {
				if (!e.business) {
					var t, n = 0,
						i = $("#wrapper > header .app-ad").clone().on("click", ".close", function(e) {
							$(this).closest(".app-ad").remove(), clearInterval(t)
						}).appendTo(document.body).show();
					t = setInterval(function() {
						n += 1, n > 5 && (n = 0), i.find(".phone img").eq(n).fadeIn().siblings().fadeOut()
					}, 2e3)
				}
			}

			function l() {
				var e = _.pluck($._data(document, "events").click, "selector");
				_.some(e, function(e) {
					return e && e.indexOf("data-bn-ipg") > -1
				}) ? (qyerUtil.doTrackCode("planv3-tool-order-display"), qyerUtil.doTrackCode("plan_editpage_v3")) : setTimeout(l, 1e3)
			}
			var c = 0,
				d = 3e4;
			e.title = t.getPlanTitle(), e.editing = !1, e.url = "/trip/" + t.getCodePlanId() + "/?fromjournalview=1", e.tripos = window.document.domain.indexOf("tripos.cn") > -1 || window.document.domain.indexOf("business.qyer.com") > -1, e.business = 1 == window.__plan_init_data__.business_group, e.business_info = window.__plan_init_data__.business_info, e.isLogin = window.QYER.uid > 0, e.planId = t.getPlanId(), e.service = n, e.cover = !0, e.calendar = !0, e.tripAll = !0, e.tripBasic = !0, e.tripMap = !0, e.tripInfo = !0, e.cost = !0, e.tripAllMap = !0, e.memo = !0, e.tripZworld = !0, e.allmap = !0, e.uid = window.QYER.uid, e.imgLoadStatus = "default", e.pdf_cn_name = t.getPlanTitle(), e.pdf_pic = t.getPlanCover(), e.startEditing = function() {
				e.editing = !0, setTimeout(function() {
					$("#modify-title").focus().select()
				}, 0)
			}, e.stopEditing = function() {
				e.editing = !1
			}, e.saveEditing = function() {
				var i = $("#modify-title").val();
				if (!$.trim(i) || qyerUtil.getWordLen(i) > 36) return void n.showTip("标题不能为空或超过18个汉字！", "error");
				t.savePlanSetting({
					data: {
						planid: t.getPlanId(),
						planner_name: i
					},
					onSuccess: function() {
						e.$apply(function() {
							e.title = i
						}), t.setPlanTitle(e.title), n.showTip("保存成功！", "ok")
					},
					onError: function(e) {
						n.showTip(e.data.msg, "error")
					}
				}), e.stopEditing()
			}, e.doLogin = window.qyerUtil.doLogin, i(), $(window).resize(function() {
				i()
			}), e.$on("show-map-poi", r), e.$on("show-map-hotel", r), e.changeMode = function(e, t) {
				n.setMode(t), setTimeout(function() {
					$(window).resize()
				}, 0), e.preventDefault && (qyerUtil.doTrackCode("Planv3-tool-" + t), e.preventDefault())
			}, e.toggleExport = function(t) {
				if (qyerUtil.doTrackCode("Planv3-tool-export"), !e.isLogin) return void window.qyerUtil.doLogin();
				$(t.target).siblings(".dropdown:visible").size() > 0 ? ($(t.target).removeClass("active").siblings(".dropdown").finish().slideUp(250), $(document.body).off("click.export")) : ($("#export-selector").slideDown(250, function() {
					$(document.body).on("click.export", function(e) {
						0 === $(e.target).closest(".dropdown").size() && ($(".export .dropdown").slideUp(250).siblings("a").removeClass("active"), $(document.body).off("click.export"))
					})
				}), $(t.target).addClass("active")), t.preventDefault()
			}, e.exportWord = function(e) {
				$(e.target).closest(".dropdown").slideUp(250), $(".dropdown-word").slideDown(250)
			}, e.closeWord = function(e) {
				$(e.target).closest(".dropdown-word").finish().slideUp(250).siblings("a").removeClass("active"), $(document.body).off("click.export")
			}, e.exportPDF = function(e) {
				qyerUtil.doTrackCode("Planv3-tool-export-PDF"), $(".dropdown-pdf").show(), $(".mask-pdf").show(), $(".pdf-modify").hide(), $("header").css({
					"z-index": "31",
					height: "60px"
				})
			}, e.closeExport = function(e, t) {
				$(e.target).closest(".dropdown").hide().siblings("a").removeClass("active"), $("header").css({
					"z-index": "20",
					height: "90px"
				}), $(".mask-pdf").hide(), $(document.body).off("click.export"), t && qyerUtil.doTrackCode("Planv3-tool-export-excel"), t || e.preventDefault()
			}, e.startPdfEditTitle = function(t) {
				e.pdfTitlEditing = !0, setTimeout(function() {
					$(".input-modify-title").focus().select()
				}, 0), t.preventDefault()
			}, e.stopPdfEditTitle = function(i) {
				var a = !1;
				if ("number" == typeof i.keyCode) switch (i.keyCode) {
					case 27:
						e.pdfTitlEditing = !1;
						break;
					case 13:
						e.pdfTitlEditing = !1, a = !0
				} else a = !0, e.pdfTitlEditing = !1;
				if (a && !i.target.value || i.target.value.length > 18) return void n.showTip("标题不能为空或超过18个汉字！", "error");
				a && i.target.value != e.pdf_cn_name && $.ajax({
					type: "post",
					url: "/api/route.php?action=saveplan",
					data: {
						planid: t.getPlanId(),
						planner_name: i.target.value
					},
					dataType: "json",
					success: function(n) {
						0 == n.error_code ? e.$apply(function() {
							e.pdf_cn_name = i.target.value, t.setPlanTitle(i.target.value)
						}) : alert(result.data.msg)
					}
				})
			}, e.showPdfModify = function() {
				$(".pdf-modify").show(), $(".dropdown-pdf").hide()
			}, e.submit = function(e) {
				$(e.target).closest("form").submit(), s(), e.preventDefault()
			}, e.submitPdf = function(e) {
				$(".dropdown-pdf form").submit(), s(), e.preventDefault()
			}, $("#upload-cover-field-pdf").on("change", function(n) {
				n.preventDefault(), $("#upload-cover-form-pdf").ajaxSubmit({
					dataType: "json",
					beforeSend: function() {
						e.$apply(function() {
							e.imgLoadStatus = "loading"
						})
					},
					success: function(n) {
						if (e.$apply(function() {
							e.imgLoadStatus = "default"
						}), "object" != typeof n) return void alert("数据传输失败");
						0 === n.error_code ? e.$apply(function() {
							e.pdf_pic = n.data.url, t.setPlanCover(n.data.url)
						}) : alert(n.data.msg)
					}
				})
			}), e.showHelp = function() {
				n.showPopup('<div ng-controller="helpController" id="helpPopup" class="helpPopup"><h2>常见问题</h2><div class="table"><div class="row"><div class="cell"><a href="#" ng-click="showTip(1)" data-bn-ipg="Planv3-help-common">如何修改当天的城市？</a></div><div class="cell"><a href="#" ng-click="showTip(6)" data-bn-ipg="Planv3-help-common">如何添加景点间交通</a></div><div class="cell"><a href="#" ng-click="showTip(11)" data-bn-ipg="Planv3-help-common">如何将景点/酒店/交通移到其他天？</a></div></div><div class="row"><div class="cell"><a href="#" ng-click="showTip(2)" data-bn-ipg="Planv3-help-common">如何添加餐厅？</a></div><div class="cell"><a href="#" ng-click="showTip(7)" data-bn-ipg="Planv3-help-common">搜索不到想要的景点／住宿／交通怎么办？</a></div><div class="cell"><a href="#" ng-click="showTip(12)" data-bn-ipg="Planv3-help-common">如何调整景点或日期的顺序？</a></div></div><div class="row"><div class="cell"><a href="#" ng-click="showTip(3)" data-bn-ipg="Planv3-help-common">如何添加酒店或者民宿？</a></div><div class="cell"><a href="#" ng-click="showTip(8)" data-bn-ipg="Planv3-help-common">如何添加备注或者笔记？</a></div><div class="cell"><a href="#" ng-click="showTip(13)" data-bn-ipg="Planv3-help-common">如何添加同行者，或与他人协同编辑？</a></div></div><div class="row"><div class="cell"><a href="#" ng-click="showTip(4)" data-bn-ipg="Planv3-help-common">如何添加城际交通？</a></div><div class="cell"><a href="#" ng-click="showTip(9)" data-bn-ipg="Planv3-help-common">如何修改行程名称或封面？</a></div><div class="cell"><a href="#" ng-click="showTip(14)" data-bn-ipg="Planv3-help-common">如何将行程设为仅自己可见？</a></div></div><div class="row"><div class="cell"><a href="#" ng-click="showTip(5)" data-bn-ipg="Planv3-help-common">如何处理转机或者换乘交通？</a></div><div class="cell"><a href="#" ng-click="showTip(10)" data-bn-ipg="Planv3-help-common">如何修改行程日期？</a></div><div class="cell"><a href="#" ng-click="showTip(15)" data-bn-ipg="Planv3-help-common">如何添加和查看花费？</a></div></div></div><div class="tip"><span>在操作中遇到任何问题，欢迎查看</span><a href="{{url}}" target="_blank" data-bn-ipg="Planv3-help-guide">《行程助手3.0版本使用指南》</a></div><div class="suggestion"><div class="title">若还有其他问题或建议，请您私信给我们，我们会尽快答复给您</div><div class="textarea-container"><textarea id="js_helpContent" class="ui2_textarea borderbox" placeholder="请描述您的问题和操作步骤" maxlength="500" ng-model="content"></textarea><div class="textarea-images"><a ng-if="images.length < 5" href="#" ng-click="addImage()" class="iconfont">&#xe699;</a><div class="image" ng-repeat="image in images"><span>{{image.name}}</span><a href="#" class="iconfont" ng-click="removeImage($index)">&#xe653;</a></div><input type="hidden" id="uploadSuggestionImage" /></div></div><div class="clearfix"><span class="fl">{{ getContentLen() }}/500字</span><a class="button primary fr" ng-if="getContentLen() > 0" href="#" ng-click="send($event)" data-bn-ipg="Planv3-help-submit">发送</a><a class="button primary fr disabled" ng-if="getContentLen() === 0" href="#">发送</a></div></div></div>', {})
			}, e.showShare = function() {
				n.showPopup('<div ng-controller="ShareController" class="share-popup"><h2 ng-show="state == \'initial\'">分享</h2><div ng-show="state == \'initial\'" class="container"><div class="qrcode"><div id="share-qrcode" class="img"></div><div class="desc">微信／QQ扫二维码分享</div></div><div class="sep"></div><div class="social"><a href="{{weiboUrl}}" target="_blank" data-bn-ipg="Planv3-share-weibo"><img src="//common1.qyerstatic.com/plan/desktop/edit3/img/weibo-icon.png"><span>微博分享</span></a><a href="#" ng-click="changeState(\'email\')" data-bn-ipg="Planv3-share-email"><img src="//common1.qyerstatic.com/plan/desktop/edit3/img/mail-icon.png"><span>邮箱分享</span></a><a href="#" ng-click="changeState(\'link\')" data-bn-ipg="Planv3-share-link"><img src="//common1.qyerstatic.com/plan/desktop/edit3/img/link-icon.png"><span>链接分享</span></a></div></div><h2 ng-show="state == \'email\'">分享到邮箱</h2><div class="via-email" ng-show="state == \'email\'"><p>将行程链接分享到以下邮箱（最多五个）</p><div class="emails" ng-class="{true: \'focus\'}[emailFocus]"><div class="email" ng-repeat="email in emails"><span ng-class="{false: \'red\'}[email.valid]">{{email.address}}</span><a href="#" ng-click="removeEmail($index)">&#xe653;</a></div><input ng-if="emails.length < 5" id="share-via-email" type="text" ng-keydown="keydownHandle($event)" ng-focus="$parent.emailFocus = true" ng-blur="$parent.emailFocus = false"/></div><a href="#" class="button primary" ng-click="shareWithEmail()" data-bn-ipg="Planv3-share-email-send">分享</a></div><h2 ng-show="state == \'link\'">分享链接</h2><div class="via-link" ng-show="state == \'link\'"><div><input id="share-via-link" type="text" readonly value="{{url}}" ng-click="selectLink()"/><a href="#" class="button primary" ng-click="copyLink()" data-bn-ipg="Planv3-share-link-copy">复制链接</a></div><p>可通过QQ、微博、微信、QQ空间等方式将链接分享给他人。</p><div id="copy-tip" class="copy-tip" style="display: none;"><span></span></div></div><div class="foot"><input type="checkbox" checkbox ng-model="isInvite" ng-init="isInvite = false"/><span>添加对方为同行者（勾选后，该行程也会出现在对方的行程列表中）</span></div></div>', {})
			}, e.showAppAd = s, t.isDoHeartBeat() && a();
			l(), t.isShowSurvey() && function() {
				var e = $("<a>", {
						class: "close",
						href: "#"
					}).append('<em class="iconfont">&#xe653;</em>'),
					t = $("<a>", {
						class: "button primary",
						href: "http://www.diaochapai.com/survey1577549",
						target: "_blank",
						text: "填写问卷"
					}),
					n = $("<div>", {
						class: "survey-mask"
					}).append($("<article>").append(e).append(t)).appendTo(document.body).on("click", "> article > a", function(e) {
						n.remove()
					})
			}(), setTimeout(function() {
				e.business && ($(".icon-word").show(), $("#b_tripZworld,#b_cost").hide())
			}, 0)
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-header-share", []).controller("ShareController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			function o() {
				clearTimeout(l), l = setTimeout(function() {
					e("#copy-tip").hide().removeClass("copy-success").removeClass("copy-fail").removeClass("show")
				}, 1e3)
			}

			function r() {
				setTimeout(function() {
					var t = 0;
					e(".via-email .emails .email").each(function(n, i) {
						t += e(i).outerWidth()
					}), t = 667 - t, e("#share-via-email").outerWidth(t).focus()
				}, 0)
			}
			var s, l;
			t.state = "initial", t.baseUrl = "http://plan.qyer.com/trip/" + n.getCodePlanId() + "/?fromjournalview=1", t.url = t.baseUrl, t.weiboUrl = "http://service.weibo.com/share/share.php?title=" + encodeURIComponent("我用#行程助手#创建了一个旅行计划《" + n.getPlanTitle() + "》") + "&url=" + encodeURIComponent(t.baseUrl) + "&source=bookmark&appkey=2992571369&pic=" + encodeURIComponent("/planapi_action_shareimg?id=" + n.getPlanId()), t.emails = [], t.changeState = function(n) {
				t.state = n, setTimeout(function() {
					e(".share-popup input").focus(), a.resizePopup()
				}, 0)
			}, t.selectLink = function() {
				e("#share-via-link").focus().select()
			}, t.copyLink = function() {
				t.selectLink(), document.execCommand && document.execCommand("copy") ? (e("#copy-tip").children("span").text("复制成功").end().show(), setTimeout(function() {
					e("#copy-tip").addClass("copy-success").addClass("show")
				}, 0), o()) : (e("#copy-tip").children("span").text("复制失败").end().show(), setTimeout(function() {
					e("#copy-tip").addClass("copy-fail").addClass("show")
				}, 0), o())
			}, t.keydownHandle = function(n) {
				var i = e("#share-via-email");
				switch (n.keyCode) {
					case 13:
					case 32:
					case 186:
					case 188:
						var a = i.val().trim();
						i.val(""), t.emails.push({
							address: a,
							valid: /^\S+@\S+$/.test(a) && !t.emails.find(function(e) {
								return e.address === a
							})
						}), r(), n.preventDefault();
						break;
					case 8:
						i.val().length <= 0 && (t.emails.pop(), r())
				}
			}, t.removeEmail = function(e) {
				t.emails.splice(e, 1), t.emails = t.emails.map(function(e, n) {
					var i = t.emails.concat([]);
					return i.splice(n, 5), {
						address: e.address,
						valid: /^\S+@\S+$/.test(e.address) && !i.find(function(t) {
							return t.address === e.address
						})
					}
				}), r()
			}, t.shareWithEmail = function() {
				e("#share-via-email").size() > 0 && e("#share-via-email").val().trim() && t.keydownHandle({
					keyCode: 13
				});
				var i = t.emails.filter(function(e) {
					return e.valid
				});
				if (0 === i.length) return void a.showTip("请输入有效的邮箱地址！", "error");
				n.shareWithEmail({
					data: {
						plan_id: n.getPlanId(),
						emails: i,
						invite: t.isInvite ? 1 : 0,
						secret: n.getFriendsCode()
					},
					onSuccess: function(e) {
						a.showTip("分享成功！", "ok"), t.closeThisDialog()
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				})
			}, setTimeout(function() {
				e(".share-popup").closest(".ngdialog-content").css({
					width: "750px",
					marginLeft: "-375px"
				}), s = new QRCode("share-qrcode", {
					text: t.url,
					width: 180,
					height: 180,
					colorDark: "#000000",
					colorLight: "#ffffff",
					correctLevel: QRCode.CorrectLevel.L
				}), a.resizePopup(), t.$watch("isInvite", function(e) {
					t.url = e ? t.baseUrl + "&friends=" + n.getFriendsCode() : t.baseUrl, qyerUtil.doTrackCode("Planv3-share-partner"), s.makeCode(t.url)
				})
			}, 0)
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-popup.flight", []).directive("plannerPopupFlight", [
		function() {
			return {
				restrict: "C",
				template: '<div class="planner-popup__bg"></div><dir class="flight-content"><div class="header">请选择你的航班</div><div class="conter"><ul><li ng-repeat="item in lists" ng-click="selectFlightInfo(item)"><i>{{item.departure.time}}</i><i>{{item.arrival.time}}</i><i>{{item.departure.city}}</i><i>{{item.arrival.city}}</i><i>{{item.departure.poiname}}</i><i>{{item.arrival.poiname}}</i><i class="iconfont">&#58883;</i></li></ul></div><div class="footer"><p>此处显示的航班起降时间为机场当地时间</p><div><a href="javascript:;" ng-click="$parent.close()">都不是？请手动添加</a></div></div></dir>'
			}
		}
	]).controller("PlannerPopupFlightController", ["$scope", "$api", "plannerService",
		function(e, t, n) {
			e.service = n, e.lists = e.$parent.data, e.selectFlightInfo = function(t) {
				e.$parent.close(), e.service.setTrafficFlightItem(t)
			}
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-popup", ["planner-popup.flight", "planner-popup.showPic"]).directive("plannerPopup", [
		function() {
			return {
				restrict: "C",
				template: '<div class="planner-popup-flight" ng-controller="PlannerPopupFlightController" ng-if="popName === \'flight\'"></div><div class="planner-popup-showPic" ng-controller="PlannerPopupShowPicController" ng-if="popName === \'showPic\'"></div>'
			}
		}
	]).controller("PlannerPopupController", ["$scope", "plannerService",
		function(e, t) {
			e.service = t, e.service.popShow = function(t) {
				e.service.popVisibled = !0, e.popName = t, e.data = e.service.popData, $(document).on("keyup.popup", function(t) {
					27 === (t.keyCode || t.which) && e.$apply(function() {
						e.close()
					})
				})
			}, e.close = function(t) {
				e.service.popVisibled = !1, e.popName = null, e.data = null, $(document).off("keyup.popup"), t && t()
			}
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-popup.showPic", []).directive("plannerPopupShowPic", [
		function() {
			return {
				restrict: "C",
				template: '<div class="planner-popup__bg planner-popup__bg--black"></div><div class="showPic-content" ng-show="status == \'complete\'"><div class="showPic-content__wrap"><img sb-load="onImgLoad($event)" ng-src="{{src}}" ng-style="imgstyle" /></div></div><div class="planner-popup__loading" ng-show="status == \'loading\'"></div><div class="planner-popup__close iconfont" ng-click="close(closecallback)">&#58963;</div>'
			}
		}
	]).directive("sbLoad", ["$parse",
		function(e) {
			return {
				restrict: "A",
				link: function(t, n, i) {
					var a = e(i.sbLoad);
					n.on("load", function(e) {
						a(t, {
							$event: e
						})
					})
				}
			}
		}
	]).controller("PlannerPopupShowPicController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a(n) {
				t.$apply(function() {
					var i = e(window),
						a = i.width(),
						o = i.height(),
						r = (e(n), n.width),
						s = n.height,
						l = a / o;
					t.imgstyle = r <= a && s * l <= o ? {
						width: "auto",
						height: "auto"
					} : r > a && s * l <= o ? {
						width: a,
						height: "auto"
					} : r / l <= a && s > o ? {
						width: "auto",
						height: o
					} : r / s < a / o ? {
						width: "auto",
						height: o
					} : {
						width: a,
						height: "auto"
					}, t.status = "complete"
				})
			}
			t.service = i, t.status = "loading", t.src = t.$parent.data, t.imgstyle = {}, t.onImgLoad = function(t) {
				var n = t.target;
				a(n), e(window).on("resize.showpic", {
					img: n
				}, function(e) {
					a(e.data.img)
				})
			}, t.closecallback = function() {
				e(window).off("resize.showpic")
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-recommends.body", ["planner-recommends.routes", "planner-recommends.pois", "planner-recommends.hotels", "planner-recommends.traffics", "planner-recommends.flight-details", "planner-recommends.train-details", "planner-recommends.rent-car", "planner-recommends.lastminutes"]).directive("recommendsBody", [
		function() {
			return {
				restrict: "C",
				template: '\x3c!-- 路线 --\x3e<div class="inner recommend-routes" ng-controller="RecommendRoutesController" ng-if="service.selectedCity &amp;&amp; page == \'routes\'"></div>\x3c!-- 游玩 --\x3e<div class="inner recommend-pois" ng-controller="RecommendPoisController" ng-if="service.selectedCity &amp;&amp; page == \'pois\'"></div>\x3c!-- 住宿 --\x3e<div class="inner recommend-hotels" ng-controller="RecommendHotelsController" ng-if="service.selectedCity &amp;&amp; page == \'hotels\'"></div>\x3c!-- 城际交通 --\x3e<div class="inner recommend-traffics" ng-controller="RecommendTrafficsController" ng-if="service.selectedCity &amp;&amp; page == \'traffics\'"></div>\x3c!-- 备选 --\x3e<div class="inner recommend-alternatives" ng-controller="RecommendAlternativesController" ng-if="service.selectedCity &amp;&amp; page == \'alternatives\'"></div>\x3c!-- 折扣 --\x3e<div class="inner recommend-lastminutes" ng-controller="RecommendLastminutesController" ng-if="service.selectedCity &amp;&amp; page == \'lastminutes\'"></div>\x3c!-- 空 --\x3e<div class="inner recommend-empty" ng-if="!service.selectedCity">请选择城市</div>'
			}
		}
	]).controller("RecommendsBodyController", ["$scope", "templatePath", "plannerService",
		function(e, t, n) {
			function i() {
				e.page = n.selectedRecommendTab
			}
			e.page = "pois", e.$on("recommend-tab-changed", function() {
				i()
			}), i()
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-recommends.flight-details", []).controller("FlightDetailsController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			var o = a.selectedFlightItem;
			a.selectedFlightItem = null, setTimeout(function() {
				e(".flight-details").closest(".ngdialog-content").css({
					width: "950px",
					marginLeft: "-475px"
				})
			}, 0), n.getRecommendFlightDetails({
				data: {
					plan_id: n.getPlanId(),
					OutboundLegId: o.OutboundLegId,
					SessionKey: o.SessionKey
				},
				onSuccess: function(t) {
					e(".flight-details .container").html(t.data.boxhtml).find("a.booking_btn").attr("data-bn-ipg", "Planv3_right_trans_flight_book"), a.resizePopup()
				},
				onError: function(e) {
					a.showTip(e.data.msg, "error")
				}
			})
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-recommends.header", []).directive("recommendsHeader", [
		function() {
			return {
				restrict: "C",
				template: '<a class="city" href="#" ng-click="showCities($event)" data-bn-ipg="Planv3-right-city-change">{{service.selectedCity.name || \'请选择城市\'}}<span class="triangle"></span></a><div class="city-options"><ul><li ng-repeat="city in service.getAllCities()" ng-click="changeCity(city)">{{city.name}}</li></ul><input type="text" placeholder="输入城市名称"><p class="top5" ng-if="service.selectedCity &amp;&amp; top5"><span>下一站TOP5：</span><span ng-repeat="city in top5"><a href="#" ng-click="changeCity({tagid: city.city_id, name: city.cn_name, lat: city.lat, lng: city.lng})">{{city.cn_name}}</a>({{city.percentage}}%前往)&nbsp;</span></p><p class="top5" ng-if="!service.selectedCity || !top5">周边：没有相关城市</p></div><div class="search" ng-show="mode == \'standard\'"><input type="text" placeholder="输入关键词" ng-keydown="keyHandler($event)"><a href="#" class="icon close" ng-click="closeSearch($event)">关闭</a><a href="#" ng-click="openSearch($event)" data-bn-ipg="Planv3-right-city-search"><em class="magnify icon"></em></a></div>'
			}
		}
	]).controller("RecommendsHeaderController", ["$scope", "$api", "plannerService",
		function(e, t, n) {
			function i() {
				$(document.body).off("click.cityOptions"), $(".city-options").slideUp(250)
			}

			function a(e) {
				n.changeRecommendType("search", $.trim(e))
			}
			e.service = n, e.top5 = null, e.showCities = function(e) {
				e.preventDefault(), $(".city-options").not(":visible") && $(".city-options").slideDown(250, function() {
					$(document.body).on("click.cityOptions", function(e) {
						0 === $(e.target).closest(".city-options").size() && i()
					})
				})
			}, e.changeCity = function(e) {
				n.updateSelectedCity(e), i()
			}, e.keyHandler = function(e) {
				13 === e.keyCode && a(e.target.value), 27 === e.keyCode && ($(e.target).closest(".search").removeClass("expand"), e.target.value = "", n.changeRecommendType("normal", null))
			}, e.$on("selected-city-changed", function() {
				n.selectedCity ? t.getTopFiveCities({
					data: {
						plan_id: t.getPlanId(),
						oneday_id: n.selectedDay.object.id,
						city_id: n.selectedCity.tagid
					},
					onSuccess: function(t) {
						e.$apply(function() {
							e.top5 = t.data;
							for (var n in e.top5) e.top5[n].percentage = parseInt(e.top5[n].percentage, 10)
						})
					},
					onError: function() {
						e.$apply(function() {
							e.top5 = null
						})
					}
				}) : e.top5 = null
			}), e.openSearch = function(t) {
				var n = $(t.target).closest(".search");
				n.hasClass("expand") ? a(n.find("input").val()) : (n.addClass("expand").find("input").focus().select(), $(document.body).on("click.closeSearch", function(t) {
					0 === $(t.target).closest(".search.expand").size() && "" === $.trim(n.find("input").val()) && e.closeSearch()
				})), t.preventDefault()
			}, e.closeSearch = function(e) {
				(e ? $(e.target).closest(".search") : $(".search.expand")).removeClass("expand").find("input").val(""), n.changeRecommendType("normal", null), $(document.body).off("click.closeSearch"), e && e.preventDefault()
			}, requirejs(["web_old_inputautocomplete"], function() {
				var e = $(".city-options input");
				e.qyerAutocomplete({
					isAllowEmptySeach: !0,
					isFocusedSeach: !0,
					autoSelect: !0,
					onSearch: function() {
						var i = $.trim(this.value);
						t.searchCity({
							data: {
								plan_id: t.getPlanId(),
								oneday_id: n.selectedDay.object.id,
								city_id: n.selectedCity ? n.selectedCity.tagid : null,
								keyword: i
							},
							onSuccess: function(t) {
								if (e.is(":visible") || 0 === e.closest(".city-options").queue().size()) {
									var n = ['<div class="search-city-list expand">'];
									i || n.push('<div class="search-title">猜你想去</div>'), n.push('<ul class="qui-inputAutocomplete-ul">'), t.data.forEach(function(e) {
										var t = '<li data-id="' + e.city_id + '" data-name="' + e.city_name + '" data-lat="' + e.lat + '" data-lng="' + e.lng + '""><span>' + e.city_name + "(" + e.country_name + ")</span></li>";
										n.push(t)
									}), n.push("</ul>"), n.push("</div>"), e.qyerAutocomplete("pushHTML", n.join(""))
								}
							},
							onError: function(t) {
								if (e.is(":visible") || 0 === e.closest(".city-options").queue().size()) {
									var n, i = ['<div class="search-city-list expand">'];
									n = t.data && t.data.msg ? t.data.msg : "搜索无结果", i.push('<div class="search-title">' + n + "</div>"), i.push('<ul class="qui-inputAutocomplete-ul">'), i.push("</ul>"), i.push("</div>"),
										e.qyerAutocomplete("pushHTML", i.join(""))
								}
							}
						})
					},
					onSelect: function(e) {
						var t = e.getAttribute("data-id"),
							a = e.getAttribute("data-name"),
							o = e.getAttribute("data-lat"),
							r = e.getAttribute("data-lng");
						n.updateSelectedCity({
							tagid: t,
							name: a,
							lat: o,
							lng: r
						}), this.value = "", i()
					}
				})
			})
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-recommends.hotels", []).directive("recommendHotels", [
		function() {
			return {
				restrict: "C",
				template: '<ul class="range" ng-if="service.recommendType == \'search\'"><li ng-class="{true:\'active\'}[range==1]" ng-click="changeRange(1)" data-bn-ipg="Planv3-right-search-currentcity">当前城市({{service.searchRecommendResultCount.city_count}})</li><li ng-class="{true:\'active\'}[range==2]" ng-click="changeRange(2)" data-bn-ipg="Planv3-right-search-global">全球范围({{service.searchRecommendResultCount.global_count}})</li></ul><div class="hotel-filters" ng-if="service.recommendType != \'search\'"><a href="#" class="button primary" ng-click="toggleOrder($event)"      data-bn-ipg="planv3-right-hotel-rank"      ng-class="{true: \'open\'}[showOrderOption]"><i class="iconfont">&#xe6c1;</i><span>排序：</span><span>{{currentOrder.val}}</span></a><a href="#" class="button filter-button"      data-bn-ipg="planv3-right-hotel-filter"      ng-click="toggleFilter($event)"      ng-class="{\'open\': showFilterOption, \'primary\': hasFilter(), \'green\': !hasFilter()}"><i class="iconfont">&#xe68f;</i><span>筛选：</span><span class="delimiter" ng-if="!hasFilter()">全部</span><span class="delimiter" ng-if="currentFilter.area">{{currentFilter.area.val}}</span><span class="delimiter" ng-if="currentFilter.grade">{{currentFilter.grade.val}}</span><span class="delimiter" ng-if="currentFilter.price">{{currentFilter.price.val}}</span><span class="delimiter" ng-if="currentFilter.type">{{currentFilter.type.val}}</span><span class="delimiter" ng-if="currentFilter.vendor">{{currentFilter.vendor.val}}</span></a><ul class="orders"      ng-class="{true: \'open\'}[showOrderOption]"      style="width:{{showOrderWidth}}px"><li ng-repeat="order in orders"        ng-click="chooseOrder(order)"        data-bn-ipg="{{order.code}}"        ng-class="{true:\'active\'}[currentOrder.key == order.key]">{{order.val}}</li></ul><div class="filters" ng-class="{true: \'open\'}[showFilterOption]"><div ng-repeat="filterItem in filterNames"        class="row" ng-if="filter[filterItem.type].length > 0"><div class="label"><span>{{filterItem.name}}</span></div><ul><li ng-click="chooseFilter(filterItem.type)"            data-bn-ipg="{{filterItem.code}}"            ng-class="{true: \'active\'}[!currentFilter[filterItem.type]]">全部</li><li ng-repeat="item in filter[filterItem.type]"            data-bn-ipg="{{filterItem.code}}"            ng-click="chooseFilter(filterItem.type, item)"            ng-class="{true: \'active\'}[currentFilter[filterItem.type].key == item.key]">{{item.val}}</li></ul></div></div></div><div class="container" ng-class="{true: \'container--search\'}[service.recommendType == \'search\']"><div class="loading" ng-if="loading">正在加载中...</div><div class="info" ng-if="hotels.length > 0 && !loading"><span>多数酒店可<em>免费取消</em>，无需预付，0成本预定，不怕没房啦~</span></div><div ng-if="!hotels.length && !loading"><div class="empty-ufo" ng-if="service.recommendType !== \'search\'"><p>        当前城市没有结果~<br>        你可以<a href="#" ng-click="service.broadcast(\'show-add-hotel\')"><i class="iconfont">&#xe68b;</i>手动添加</a></p></div><div class="empty-ufo" ng-if="service.recommendType === \'search\'"><p ng-if="range == 1">        当前城市没有搜到结果~<br>        你可以<a href="#" ng-click="changeRange(2)"><i class="iconfont">&#xe692;</i>搜索全球范围</a>或者<a href="#" ng-click="service.broadcast(\'show-add-hotel\', service.recommendKeyword)"><i class="iconfont">&#xe68b;</i>手动添加</a></p><p ng-if="range == 2">没有搜到结果。你可以<a href="#" ng-click="service.broadcast(\'show-add-hotel\', service.recommendKeyword)">手动添加</a></p></div></div><div class="item" ng-repeat="hotel in hotels" ng-if="!loading"><div class="title"><h1><a target="_blank" class="titleLink" href="{{hotel.url}}" ng-click="doTrackCode((service.recommendType == \'search\' ? \'Planv3-right-search-hoteltitle\' : \'Planv3-right-hotel-name\'))">{{ hotel.en_name}}{{hotel.cn_name?("(" + hotel.cn_name + ")" ):""}}</a></h1><a href="#" class="iconfont" ng-if="hotel.lat && hotel.lng" ng-click="showInMap($event, hotel)" data-bn-ipg="Planv3-right-hotel-map">&#58959;</a></div><div class="subtitle"><span class="icon golden-star" ng-repeat="star in [1,2,3,4,5]" ng-if="hotel.star &gt; $index"></span><span>{{[\'\', \'一星级\', \'二星级\', \'三星级\', \'四星级\', \'五星级\'][hotel.star]}}</span><span class="sep" ng-if="hotel.grade>0 &amp;&amp; hotel.star>0"> | </span><span ng-if="hotel.grade>0">{{hotel.grade}}分</span><a href="{{hotel.url}}" target="_blank" data-bn-ipg="{{(hotel.hq_reference_price > 0 ? \'planv3-right-hotel-price-booking\' : \'planv3-right-hotel-price-bookingonly\')}}"><span class="right price_right" ng-class="{true: \'price_gray\', false: \'\'}[!priceloading && hotel.reference_price == 0]"><em ng-if="priceloading">价格获取中</em><em ng-if="!priceloading && hotel.reference_price == 0">已订满</em><em ng-if="!priceloading && hotel.reference_price > 0">¥ {{getIntNumber(hotel.reference_price)}}</em><span class = "pricetxt">Booking</span></span></a><a href="https://hotel.qyer.com/detail/{{hotel.id}}.html?pricing&planid={{planId}}&checkin={{checkinDate}}&checkout={{checkoutDate}}" target="_blank" ng-if="hotel.hq_reference_price > 0" data-bn-ipg="planv3-right-hotel-price-qyer"><span class="right price_right price_green"><em ng-if="hqPriceLoading">价格获取中</em><em ng-if="!hqPriceLoading">¥ {{getIntNumber(hotel.hq_reference_price)}}</em><span class = "pricetxt">穷游网</span></span></a></div><p ng-if="hotel.thread_num || hotel.plan_num || !hotel.freecancel"><span ng-if="hotel.thread_num || hotel.plan_num">{{hotel.thread_num?(hotel.thread_num+"篇游记中提到 "):""}} {{hotel.plan_num?(" "+hotel.plan_num+"个行程中选择"):""}}</span></p><div class="images"><div ng-if="hotel.pics.length">\x3c!-- 最多重复4次,因为宽度限制,太长了也 overflow hidden 显示不出来了,再有小尺寸时,最后一个 hidden 掉, 配合 hover 效果 --\x3e<a target="_blank" href="{{hotel.url}}"><img class="hotel-pic" data-more="{{hotel.pics.length>1}}" src="{{image}}" ng-repeat="image in hotel.pics" ng-if="$index<4" data-bn-ipg="Planv3-right-hotel-pic"></a></div><div ng-if="!hotel.pics.length"><a target="_blank" class="" href="{{hotel.url}}" ng-click="doTrackCode((service.recommendType == \'search\' ? \'Planv3-right-search-hotelpic\' : \'Planv3-right-hotel-pic\'))"><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/defaultHotelImg.jpg"></a></div></div><p ng-if="hotel.poilocal">附近景点：<span ng-repeat="poi in hotel.poilocal"><em>{{poi.chinesename||poi.englishname}}</em>({{poi.distance>1000?( (poi.distance/1000).toFixed(1)+"公里" ):(poi.distance+"米")}})</span></p><div class="services"><span ng-class="{\'false\': \'disabled\'}[hotel.wifi]"><em class="icon wifi"></em>WIFI</span><span ng-class="{\'false\': \'disabled\'}[hotel.pickup]"><em class="icon pickup"></em>接机服务</span><span ng-class="{\'false\': \'disabled\'}[hotel.parking]"><em class="icon parking"></em>停车场</span><span ng-class="{\'false\': \'disabled\'}[hotel.luggage]"><em class="icon luggage"></em>寄存</span></div><div class="controls"><a href="{{hotel.url}}" target="_blank" ng-click="doTrackCode((service.recommendType == \'search\' ? \'Planv3-right-search-moreinfo\' : \'Planv3-right-hotel-moreinfo\'))"><span class="iconfont">&#58944;</span>查看详情</a><a href="#" ng-click="addToPlan($event, hotel);doTrackCode((service.recommendType == \'search\' ? \'Planv3-right-search-addhotel\' : \'Planv3-right-hotel-addtoplan\'))" data-bn-ipg=""><span class="iconfont">&#58943;</span>添加到行程</a></div></div><img src="//common3.qyerstatic.com/plan/img/shared/loading.gif" class="scroll-loading" ng-if="miniLoading"><div class="empty-text" ng-if="hotels.length > 0 && allLoaded"><p ng-if="service.recommendType !== \'search\'">      当前城市没有更多结果了~<br>      你可以<a href="#" ng-click="service.broadcast(\'show-add-hotel\')"><i class="iconfont">&#xe68b;</i>手动添加</a></p><p ng-if="service.recommendType === \'search\' && range == 1">      当前城市没有更多结果了~<br>      你可以<a href="#" ng-click="changeRange(2)"><i class="iconfont">&#xe692;</i>搜索全球范围</a>或者<a href="#" ng-click="service.broadcast(\'show-add-hotel\', service.recommendKeyword)"><i class="iconfont">&#xe68b;</i>手动添加</a></p><p ng-if="service.recommendType === \'search\' && range == 2">      没有更多结果了。你可以<a href="#" ng-click="service.broadcast(\'show-add-hotel\', service.recommendKeyword)">手动添加</a></p></div></div>'
			}
		}
	]).controller("RecommendHotelsController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a(e, t) {
				var n = new Date(t.getTime());
				return n.setDate(n.getDate() + e), n.getFullYear() + "-" + (n.getMonth() + 1) + "-" + n.getDate()
			}

			function o() {
				if (i.selectedDay.object && i.selectedCity) {
					if (t.allLoaded) return t.loading = !1, t.miniLoading = !1, void("$apply" != t.$root.$$phase && "$digest" != t.$root.$$phase && t.$apply());
					0 === l ? t.loading = !0 : t.miniLoading = !0, n.getRecommendHotels({
						data: {
							plan_id: n.getPlanId(),
							oneday_id: i.selectedDay.object.id,
							city_id: i.selectedCity.tagid,
							keyword: i.recommendKeyword,
							range: t.range,
							page: l++,
							type: t.currentFilter.type ? t.currentFilter.type.key : 0,
							grade: t.currentFilter.grade ? t.currentFilter.grade.key : 0,
							area_id: t.currentFilter.area ? t.currentFilter.area.key : 0,
							price: t.currentFilter.price ? t.currentFilter.price.key : 0,
							source: t.currentFilter.vendor ? t.currentFilter.vendor.key : 0,
							order: t.currentOrder.key
						},
						onSuccess: function(r) {
							r.data.list && 0 !== r.data.list.length || (t.allLoaded = !0);
							for (var s = "", l = 0; l < r.data.list.length; l++) s += "," + r.data.list[l].id;
							s = s.substr(1);
							var c = n.getStartDate();
							if (c) {
								var d, u, p;
								c.setDate(c.getDate() + i.selectedDay.index), p = c.getTime() < (new Date).getTime(), p && (c = new Date, c.setDate(c.getDate() + 30)), t.priceloading = !0, t.hqPriceLoading = !0, t.$apply(), d = a(0, c), u = a(1, c), p || (t.checkinDate = d, t.checkoutDate = u), _.each(r.data.list, function(e) {
									e.reference_price = 0
								}), e.ajax({
									url: "/ajax.php?action=ajaxhotelavail&return_style=more&hotel_id=" + s + "&checkin=" + d + "&checkout=" + u,
									type: "post",
									dataType: "json",
									success: function(e) {
										t.priceloading = !1, r.data.list = _.map(r.data.list, function(t) {
											var n = e.data[t.id];
											return n && n.price && (t.reference_price = n.price), t
										}), t.$apply()
									},
									error: function(e) {}
								}), e.ajax({
									url: "/api/v3/hotel/haoqiao/avail",
									type: "post",
									dataType: "json",
									data: {
										hotel_id: s,
										checkin: d,
										checkout: u
									},
									success: function(e) {
										t.hqPriceLoading = !1, r.data.list = _.map(r.data.list, function(t) {
											var n = e.data[t.id];
											return n && n.price && (t.hq_reference_price = n.price), t
										}), t.$apply()
									}
								})
							}
							t.$apply(function() {
								t.loading = !1, t.miniLoading = !1, r.data && r.data.list && r.data.list.length && (t.hotels = t.hotels.concat(r.data.list)), "search" == i.recommendType && (i.searchRecommendResultCount = {
									city_count: r.data.city_count,
									global_count: r.data.global_count
								}, (1 == t.range && t.hotels.length == r.data.city_count || 2 == t.range && t.hotels.length == r.data.global_count) && (t.allLoaded = !0))
							}), e(".recommends-body").off("scroll").on("scroll", function() {
								var n = 1 + parseInt("-" + e(".recommends-body").scrollTop()) / 30,
									a = parseInt("-" + e(".recommends-body").scrollTop()) + 60;
								"search" === i.recommendType ? n <= 0 ? e(this).find(".range").hide() : e(this).find(".range").css("opacity", n).show() : e(".recommends-tabs").css("top", a + "px");
								var r = e(".recommends-body").scrollTop() + e(".recommends-body").height(),
									s = e(".container").height() + 85;
								(r == s || r > s) && t.nextPage && (t.nextPage = !1, t.$apply(function() {
									o()
								}), setTimeout(function() {
									t.nextPage = !0
								}, 2e3))
							})
						}
					})
				}
			}

			function r() {
				t.currentOrder = {
					key: 4,
					val: "综合排序"
				}, t.currentFilter = {}, t.filter.area = [], n.getRecommendHotelAreas({
					data: {
						plan_id: n.getPlanId(),
						city_id: i.selectedCity.tagid
					},
					onSuccess: function(e) {
						t.filter.area = (e.data || []).map(function(e) {
							return {
								key: e.id,
								val: e.name
							}
						}), t.$apply()
					}
				})
			}

			function s() {
				l = 0, t.allLoaded = !1, t.hotels = [], o()
			}
			var l = 0,
				c = 2 == window.__plan_init_data__.user_group || 3 == window.__plan_init_data__.user_group ? 1 : 0;
			t.hotels = [], t.range = 1, t.doTrackCode = qyerUtil.doTrackCode, t.planId = n.getPlanId(), t.nextPage = !0, t.loading = !1, t.miniLoading = !1, t.allLoaded = !1, t.changeRange = function(e) {
				t.range = e, l = 0, t.allLoaded = !1, t.hotels = [], o()
			}, t.getIntNumber = function(e) {
				return parseInt(e, 10)
			}, t.showInMap = function(e, t) {
				i.selectedHotel = t, i.broadcast("show-map-hotel")
			}, t.addToPlan = function(e, t) {
				var n = 0;
				if (i.place_list.forEach(function(e) {
					2 == e.type && n++
				}), n >= 5) return void i.showTip("最多添加5个酒店", "error");
				t.image = t.pics[0], i.selectedHotel = t, i.rafill_reason = 6, i.broadcast("show-add-hotel")
			}, t.currentOrder = {
				key: 4,
				val: "综合排序"
			}, t.orders = [{
				key: 4,
				val: "综合排序",
				code: "planv3-right-hotel-rank-overall"
			}, {
				key: 3,
				val: "评分由高到低",
				code: "planv3-right-hotel-rank-score"
			}, {
				key: 2,
				val: "价格由高到低",
				code: "planv3-right-hotel-rank-pricedesc"
			}, {
				key: 1,
				val: "价格由低到高",
				code: "planv3-right-hotel-rank-priceasc"
			}], t.showOrderOption = !1, t.showOrderWidth = 150, t.toggleOrder = function(n) {
				n && n.preventDefault(), t.showOrderOption ? e(document.body).off("click.hideOrder") : (e(document.body).trigger("click.hideFilter"), t.showOrderWidth = e(n.target).closest("a.button").outerWidth(), e(document.body).on("click.hideOrder", function(n) {
					e(n.target).closest(".hotel-filters").size() || (t.toggleOrder(), "$apply" != t.$root.$$phase && "$digest" != t.$root.$$phase && t.$apply())
				})), t.showOrderOption = !t.showOrderOption
			}, t.chooseOrder = function(n) {
				t.currentOrder = n, t.showOrderOption = !1, s(), e(document.body).off("click.hideOrder")
			}, t.currentFilter = {}, t.hasFilter = function() {
				return t.currentFilter.area || t.currentFilter.grade || t.currentFilter.price || t.currentFilter.type || t.currentFilter.vendor
			}, t.filterNames = [{
				name: "区域",
				type: "area",
				code: "planv3-right-hotel-filter-area"
			}, {
				name: "星级",
				type: "grade",
				code: "planv3-right-hotel-filter-star"
			}, {
				name: "价格",
				type: "price",
				code: "planv3-right-hotel-filter-price"
			}, {
				name: "类型",
				type: "type",
				code: "planv3-right-hotel-filter-type"
			}, {
				name: "供应商",
				type: "vendor",
				code: "planv3-right-hotel-filter-supplier"
			}], t.filter = {
				area: [],
				grade: [{
					key: 1,
					val: "一星"
				}, {
					key: 2,
					val: "二星"
				}, {
					key: 3,
					val: "三星"
				}, {
					key: 4,
					val: "四星"
				}, {
					key: 5,
					val: "五星"
				}],
				price: [{
					key: 1,
					val: "400元以下"
				}, {
					key: 2,
					val: "401-800元"
				}, {
					key: 3,
					val: "801-1300元"
				}, {
					key: 4,
					val: "1301元以上"
				}],
				type: [{
					key: 14,
					val: "酒店"
				}, {
					key: 3,
					val: "家庭旅馆"
				}, {
					key: 13,
					val: "旅馆"
				}, {
					key: 23,
					val: "住宅"
				}, {
					key: 21,
					val: "度假村"
				}],
				vendor: []
			}, c && (t.filter.vendor = [{
				key: 1,
				val: "穷游网"
			}]), t.showFilterOption = !1, t.toggleFilter = function(n) {
				n && n.preventDefault(), t.showFilterOption ? e(document.body).off("click.hideFilter") : (e(document.body).trigger("click.hideOrder"), e(document.body).on("click.hideFilter", function(n) {
					e(n.target).closest(".hotel-filters").size() || (t.toggleFilter(), "$apply" != t.$root.$$phase && "$digest" != t.$root.$$phase && t.$apply())
				})), t.showFilterOption = !t.showFilterOption
			}, t.chooseFilter = function(n, i) {
				t.currentFilter[n] && i && t.currentFilter[n].key == i.key || (t.currentFilter[n] || i) && (t.currentFilter[n] = i, t.showFilterOption = !1, s(), e(document.body).off("click.hideFilter"))
			}, t.$on("recommend-keyword-changed", function() {
				l = 0, t.allLoaded = !1, t.hotels = [], o()
			}), t.$on("selected-city-changed", function() {
				l = 0, t.allLoaded = !1, t.hotels = [], r(), o()
			}), r(), o()
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-recommends", ["planner-recommends.header", "planner-recommends.tabs", "planner-recommends.body", "planner-recommends.map"]).directive("plannerRecommends", [
		function() {
			return {
				restrict: "C",
				template: '<div class="inner" ng-controller="PlannerRecommendsController" ng-class="{true: \'with-path\'}[!!service.selectedTraffic]"><div class="recommends-header" ng-controller="RecommendsHeaderController"></div><div class="recommends-tabs" ng-controller="RecommendsTabsController" ng-show="mode == \'standard\' &amp;&amp; service.selectedCity"></div><div class="recommends-body" ng-controller="RecommendsBodyController" ng-show="mode == \'standard\'"></div><div class="recommends-map" ng-controller="RecommendsMapController" ng-if="mode == \'map\'"></div></div>'
			}
		}
	]).controller("PlannerRecommendsController", ["$scope", "plannerService",
		function(e, t) {
			e.mode = "standard", e.service = t, e.$on("mode-changed", function(t, n) {
				e.mode = n
			})
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-recommends.lastminutes", []).directive("recommendLastminutes", [
		function() {
			return {
				restrict: "C",
				template: '<ul class="range" ng-if="service.recommendType == \'search\'"><li ng-class="{true:\'active\'}[range==1]" ng-click="changeRange(1)" data-bn-ipg="Planv3-right-search-currentcity">当前城市({{service.searchRecommendResultCount.city_count}})</li><li ng-class="{true:\'active\'}[range==2]" ng-click="changeRange(2)" data-bn-ipg="Planv3-right-search-global">全球范围({{service.searchRecommendResultCount.global_count}})</li></ul><div class="container"><div class="loading" ng-if="loading">正在加载中...</div><div ng-if="!lms.length && !loading"><div class="empty-ufo" ng-if="service.recommendType !== \'search\'"><p>当前城市没有结果~</p></div><div class="empty-ufo" ng-if="service.recommendType === \'search\'"><p ng-if="range == 1">        当前城市没有搜到结果~<br>        你可以<a href="#" ng-click="changeRange(2)"><i class="iconfont">&#xe692;</i>搜索全球范围</a></p><p ng-if="range == 2">没有搜到结果。</p></div></div><article ng-repeat="lm in lms" ng-if="!loading"><div class="image" ng-click="viewDetails($event, lm.pid, 1)"><img src="{{ lm.pic }}/420x280" class="lmimg" height="220" data-defaultSrc="//common3.qyerstatic.com/plan/desktop/edit3/img/defaultPOI_{{lm.catetypeid}}.png" onerror="this.onerror=null;this.src=this.getAttribute(\'data-defaultSrc\');"></div><div class="title"><div class="inner"><h1 ng-click="viewDetails($event, lm.pid, 2)" class="double-line">{{lm.cn_name || lm.en_name || lm.title}}</h1></div></div><div class="price"><em>{{lm.price}}</em><span>元起</span><i>{{lm.list_price}}元</i></div><div class="solds"><span ng-if="lm.sale_count > 0"><em>{{lm.sale_count}}</em>名穷游er购买</span><span class="remaining" ng-if="lm.remaining < 10">当天剩余<em>{{lm.remaining}}</em>件</span></div><a href="#" ng-click="addToPlan($event, lm, true)" data-bn-ipg="Planv3-lmpoi-overview-add" class="add"><span class="iconfont">&#58943;</span>加入行程</a>\x3c!-- <a href="{{lm.url}}" target="_blank" data-bn-ipg="Planv3-lmpoi-overview-booking" class="add half" style="border-left:0"><span class="iconfont">&#xe672;</span>立即预订</a> --\x3e</article><img src="//common3.qyerstatic.com/plan/img/shared/loading.gif" class="scroll-loading" ng-if="miniLoading"><div class="empty-text" ng-if="lms.length > 0 && allLoaded"><p ng-if="service.recommendType !== \'search\'">当前城市没有更多结果了~</p><p ng-if="service.recommendType === \'search\' && range == 1">      当前城市没有更多结果了~<br>      你可以<a href="#" ng-click="changeRange(2)"><i class="iconfont">&#xe692;</i>搜索全球范围</a></p><p ng-if="service.recommendType === \'search\' && range == 2">      没有更多结果了。    </p></div></div>'
			}
		}
	]).controller("RecommendLastminutesController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a() {
				if (t.allLoaded) return t.loading = !1, t.miniLoading = !1, void t.$apply();
				1 === r ? t.loading = !0 : t.miniLoading = !0, n.getRecommendLms({
					data: {
						planid: n.getPlanId(),
						cityid: i.selectedCity.tagid,
						keyword: i.recommendKeyword,
						range: t.range,
						page: r++,
						type: o
					},
					onSuccess: function(n) {
						t.loading = !1, t.miniLoading = !1;
						var o;
						if ("search" == i.recommendType ? (o = n.data.list, r <= 2 && (i.searchRecommendResultCount = {
							city_count: n.data.city_count || 0,
							global_count: n.data.global_count || 0
						})) : o = n.data, !o || 0 === o.length) return t.allLoaded = !0, void t.$apply();
						t.lms = t.lms.concat(o), (1 == t.range && t.lms.length == n.data.city_count || 2 == t.range && t.lms.length == n.data.global_count) && (t.allLoaded = !0), t.$apply(), e(".recommends-body").off("scroll").on("scroll", function() {
							var n = 1 + parseInt("-" + e(".recommends-body").scrollTop()) / 30,
								o = parseInt("-" + e(".recommends-body").scrollTop()) + 60;
							"search" === i.recommendType ? n <= 0 ? e(this).find(".range").hide() : e(this).find(".range").css("opacity", n).show() : e(".recommends-tabs").css("top", o + "px"), e(".recommends-body").scrollTop() + e(".recommends-body").height() == e(".container").height() + 126 && t.$apply(function() {
								a()
							})
						})
					},
					onError: function(e) {
						r > 2 && i.showTip(e.data.msg, "error"), t.loading = !1, t.miniLoading = !1, t.$apply()
					}
				})
			}
			var o = i.lmFilter,
				r = 1;
			t.lms = [], t.loading = !1, t.miniLoading = !1, t.allLoaded = !1, t.range = 1, t.viewDetails = function(e, t, n) {
				e.preventDefault(), i.selectedPoiId = t, i.selectedLastminute = !0, i.slideType = "view", i.showSlide("viewPOI"), 1 === n ? qyerUtil.doTrackCode("Planv3-lmpoi-overview-img") : qyerUtil.doTrackCode("Planv3-lmpoi-overview-title")
			}, t.addToPlan = function(e, t) {
				if (e.preventDefault(), _.reduce(i.place_list, function(e, t) {
					return 1 == t.type ? e + 1 : e
				}, 0) >= 40) return void i.showTip("最多添加40个景点", "error");
				n.addPOI({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						rafill_reason: 5,
						poi: {
							pid: t.pid,
							cn_name: t.cn_name || t.title,
							en_name: t.en_name,
							address: "",
							starthours: -1,
							startminutes: -1,
							endhours: -1,
							endminutes: -1,
							spend: t.price,
							currency: "CNY",
							counts: 1,
							positiontype: 1,
							useraddress: null,
							lat: t.lat,
							lng: t.lng,
							catetypeid: 1e3
						},
						note: {
							content: "",
							images: []
						}
					},
					onSuccess: function(e) {
						i.scrBottom = !0, i.showTip("添加成功！", "ok"), e.data.city && (e.data.city.name = i.decodeHTML(e.data.city.name), i.broadcast("auto-add-city", e.data.city)), i.setSelectedDay(), i.broadcast("update-cart-icon")
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}, t.changeRange = function(n) {
				t.range = n, r = 1, t.allLoaded = !1, t.lms = [], a(), e(".recommend-lastminutes .range").css("opacity", 1).show()
			}, t.$on("recommend-keyword-changed", function() {
				r = 1, t.allLoaded = !1, t.lms = [], a()
			}), t.$on("lm-filter-changed", function() {
				o = i.lmFilter, r = 1, t.allLoaded = !1, t.lms = [], a()
			}), t.$on("selected-city-changed", function() {
				r = 1, t.allLoaded = !1, t.lms = [], a()
			}), a()
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-recommends.map", []).filter("duration", function() {
		return function(e) {
			var t, n = Math.round(e / 60);
			return n <= 60 ? n + "min" : (t = Math.floor(n / 60), n %= 60, t + "h " + n + "min")
		}
	}).filter("weekday", function() {
		return function(e) {
			return ["日", "一", "二", "三", "四", "五", "六"][e.getDay()]
		}
	}).directive("recommendsMap", [
		function() {
			return {
				restrict: "C",
				template: '<div class="options"><input type="checkbox" checkbox ng-model="filter.poi[\'32\']" ng-init="filter.poi[\'32\'] = false" checked ng-change="trackFilter(\'sight\')"><span ng-click="filter.poi[\'32\'] = !filter.poi[\'32\'];trackFilter(\'sight\')">景点</span><input type="checkbox" checkbox ng-model="filter.poi[\'78\']" ng-init="filter.poi[\'78\'] = false" checked ng-change="trackFilter(\'food\')"><span ng-click="filter.poi[\'78\'] = !filter.poi[\'78\'];trackFilter(\'food\')">美食</span><input type="checkbox" checkbox ng-model="filter.poi[\'147\']" ng-init="filter.poi[\'147\'] = false" checked ng-change="trackFilter(\'shopping\')"><span ng-click="filter.poi[\'147\'] = !filter.poi[\'147\'];trackFilter(\'shopping\')">购物</span><input type="checkbox" checkbox ng-model="filter.poi[\'148\']" ng-init="filter.poi[\'148\'] = false" checked ng-change="trackFilter(\'event\')"><span ng-click="filter.poi[\'148\'] = !filter.poi[\'148\'];trackFilter(\'event\')">体验</span><input type="checkbox" checkbox ng-model="filter.poi[\'77\']" ng-init="filter.poi[\'77\'] = false" checked ng-change="trackFilter(\'trans\')"><span ng-click="filter.poi[\'77\'] = !filter.poi[\'77\'];trackFilter(\'trans\')">交通</span><select ng-model="filter.type" ng-init="filter.type = 0" ng-change="trackFilter(\'selectpoi\')"><option value="0">显示所有</option><option value="1">显示推荐</option></select><span>|</span><input type="checkbox" checkbox ng-model="filter.hotel" ng-init="filter.hotel = false" checked ng-change="trackFilter(\'hotel\')"><span ng-click="filter.hotel = !filter.hotel;trackFilter(\'hotel\')">酒店</span><select ng-model="filter.grade" ng-init="filter.grade = 0" ng-change="trackFilter(\'groupbystar\')"><option value="0">不限星级</option><option value="5">五星酒店</option><option value="4">四星酒店</option><option value="3">三星酒店</option><option value="2">二星酒店</option><option value="1">一星酒店</option><option value="-1">无星级</option></select></div><div class="inner"><div id="recommend-map" class="inner"></div>\x3c!-- <ul class="show-price" ng-show="filter.hotel"><li><input type="checkbox" checkbox checked ng-model="filter.price" ng-init="filter.price = true" ng-change="trackFilter(\'showprice\')"><span ng-click="filter.price = !filter.price;trackFilter(\'showprice\')">显示酒店价格</span></li></ul><ul class="show-path"><li><input type="checkbox" checkbox checked ng-model="filter.path" ng-init="filter.path = true" ng-change="trackFilter(\'showroute\')"><span ng-click="filter.path = !filter.path;trackFilter(\'showroute\')">显示当日路线</span></li></ul> --\x3e<ul class="zoomer"><li><a href="#" ng-click="zoomIn($event)">＋</a></li><li><a href="#" ng-click="zoomOut($event)">–</a></li></ul></div><div class="traffic-path" ng-show="service.selectedTraffic"><div class="header"><ul><li data-bn-ipg="planv3-transport-tab-transit" ng-class="{true: \'active\'}[pathTab == \'transit\']" ng-click="pathTabHandle(\'transit\')"><em class="iconfont">&#xe6c5;</em><span class="tip">公共交通</span></li><li data-bn-ipg="planv3-transport-tab-drive" ng-class="{true: \'active\'}[pathTab == \'driving\']" ng-click="pathTabHandle(\'driving\')"><em class="iconfont">&#xe6c6;</em><span class="tip">驾车</span></li><li data-bn-ipg="planv3-transport-tab-walk" ng-class="{true: \'active\'}[pathTab == \'walking\']" ng-click="pathTabHandle(\'walking\')"><em class="iconfont">&#xe6c7;</em><span class="tip">徒步</span></li></ul><a href="#" class="close" ng-click="changeMode($event, \'standard\')">关闭</a></div><div class="body"><div><div ng-show="pathTab == \'transit\'"><div class="transit-search"><h3>出发时间</h3><div id="transit-date-picker">{{getDate() | date:\'M月d日\'}}周{{getDate() | weekday}}</div><select id="transit-time-picker" ng-model="transitTime" ng-init="transitTime = \'10:00\'"><option ng-repeat="time in transitTimes" value="{{time}}" ng-selected="time == \'10:00\'">{{time}}</option></select><a data-bn-ipg="planv3-transport-tab-transit-search" href="#" class="button primary" ng-click="transitQuery($event)">查询</a></div><div ng-if="loading" class="loading">正在加载中...</div><div ng-if="!loading && pathData[\'transit\'].length == 0 && !copyrightError" class="empty">两点之间没有合适的公交方案</div><div ng-if="!loading && pathData[\'transit\'].length == 0 && copyrightError" class="empty">由于版权问题，日本地区不支持公共交通查询。</div><ul ng-if="!loading && pathData[\'transit\'].length > 0" class="path-list"><li ng-repeat="route in pathData[\'transit\']" ng-click="togglePoiPath($event, route)"><h4>路线{{[\'一\', \'二\', \'三\', \'四\', \'五\', \'六\', \'七\', \'八\', \'九\', \'十\'][$index] || ($index + 1)}}</h4><div class="path-select iconfont" ng-class="{true: \'active\'}[service.selectedTraffic.route_id == route.id]">&#xe68d;</div><div class="path-expired" ng-if="route.status == 0">该方案已过期，请您重新查询</div><div class="path-time"><span>{{route.data.legs[0].departure_time.text}} - {{route.data.legs[0].arrival_time.text}}</span><span ng-if="route.duration"> ｜ </span><span>{{route.duration | duration}}</span><span ng-if="route.data.fare.text"> ｜ </span><span ng-if="route.data.fare.text">{{route.data.fare.text}}</span></div><div class="path-brief"><div class="brief-block" ng-repeat="line in route.lines"><img ng-if="line.vehicle.icon" ng-src="{{changeIcoSuffix(line.vehicle.icon)}}" err-src="{{line.vehicle.icon}}" alt=""><span style="color:{{line.text_color}};background:{{line.color}};">{{line.short_name || line.name}}</span></div></div><div class="path-expand" ng-click="togglePathDetails($event)" data-bn-ipg="planv3-transport-tab-transit-details"><span>展开路线详情</span><span style="display:none;">收起路线详情</span><i class="iconfont">&#xe630;</i><i class="iconfont" style="display:none;">&#xe631;</i></div><div class="path-details"><div class="path-stop" title="{{service.selectedTraffic.startEvent.title}}">{{service.selectedTraffic.startEvent.title}}</div><div ng-repeat="step in route.steps"><div ng-if="step.transit_details" class="path-stop" title="{{step.transit_details.departure_stop.name}}"><span>{{step.transit_details.departure_stop.name}}</span></div><div class="path-section" ng-class="{true: \'dotted\'}[step.travel_mode == \'WALKING\']"><p ng-if="step.travel_mode == \'WALKING\'"><i class="iconfont">&#xe6c7;</i><span>{{step.duration.value | duration}} ({{(step.distance.value / 1000).toFixed(2)}}km)</span></p><p ng-if="step.travel_mode != \'WALKING\'"><img ng-if="!step.transit_details.line.vehicle.local_icon && step.transit_details.line.vehicle.icon" ng-src="{{changeIcoSuffix(step.transit_details.line.vehicle.icon)}}" err-src="{{step.transit_details.line.vehicle.icon}}" alt=""><img ng-if="step.transit_details.line.vehicle.local_icon" ng-src="{{changeIcoSuffix(step.transit_details.line.vehicle.local_icon)}}" err-src="{{step.transit_details.line.vehicle.local_icon}}" alt=""><span ng-if="step.transit_details.line" class="line" style="color:{{step.transit_details.line.text_color}};background:{{step.transit_details.line.color}};">{{step.transit_details.line.short_name || step.transit_details.line.name}}</span><span ng-if="step.transit_details.line"> ｜ </span><span ng-if="step.transit_details.headsign">开往{{step.transit_details.headsign}}方向</span><span ng-if="step.transit_details.headsign"> ｜ </span><span ng-if="step.transit_details.num_stops">{{step.transit_details.num_stops}}站</span></p></div><div ng-if="step.transit_details" class="path-stop" title="{{step.transit_details.arrival_stop.name}}"><span>{{step.transit_details.arrival_stop.name}}</span></div></div><div class="path-stop" title="{{service.selectedTraffic.endEvent.title}}">{{service.selectedTraffic.endEvent.title}}</div></div></li></ul></div><div ng-show="pathTab == \'driving\'"><div ng-if="loading" class="loading">正在加载中...</div><div ng-if="!loading && pathData[\'driving\'].length == 0" class="empty">两点之间没有合适的驾车方案</div><ul ng-if="!loading && pathData[\'driving\'].length > 0" class="path-list"><li ng-repeat="route in pathData[\'driving\']" ng-click="togglePoiPath($event, route)"><h4>路线{{[\'一\', \'二\', \'三\', \'四\', \'五\', \'六\', \'七\', \'八\', \'九\', \'十\'][$index] || ($index + 1)}}</h4><div class="path-select iconfont" ng-class="{true: \'active\'}[service.selectedTraffic.route_id == route.id]">&#xe68d;</div><div class="path-stop">{{service.selectedTraffic.startEvent.title}}</div><div class="path-section"><p><i class="iconfont">&#xe6c6;</i><span>{{route.duration | duration}} ({{(route.distance / 1000).toFixed(2)}}km)</span></p></div><div class="path-stop">{{service.selectedTraffic.endEvent.title}}</div></li></ul></div><div ng-show="pathTab == \'walking\'"><div ng-if="loading" class="loading">正在加载中...</div><div ng-if="!loading && pathData[\'walking\'].length == 0" class="empty">两点之间没有合适的徒步方案</div><ul ng-if="!loading && pathData[\'walking\'].length > 0" class="path-list"><li ng-repeat="route in pathData[\'walking\']" ng-click="togglePoiPath($event, route)"><h4>路线{{[\'一\', \'二\', \'三\', \'四\', \'五\', \'六\', \'七\', \'八\', \'九\', \'十\'][$index] || ($index + 1)}}</h4><div class="path-select iconfont" ng-class="{true: \'active\'}[service.selectedTraffic.route_id == route.id]">&#xe68d;</div><div class="path-stop">{{service.selectedTraffic.startEvent.title}}</div><div class="path-section dotted"><p><i class="iconfont">&#xe6c7;</i><span>{{route.duration | duration}} ({{(route.distance / 1000).toFixed(2)}}km)</span></p></div><div class="path-stop">{{service.selectedTraffic.endEvent.title}}</div></li></ul></div></div></div></div>'
			}
		}
	]).directive("errSrc", function() {
		return {
			link: function(e, t, n) {
				t.bind("error", function() {
					n.src != n.errSrc && n.$set("src", n.errSrc)
				})
			}
		}
	}).controller("RecommendsMapController", ["$scope", "$api", "$filter", "plannerService",
		function(e, t, n, i) {
			function a() {
				w = new planner.maps.Map("recommend-map", {
					disableDefaultUI: !0,
					mapTypeControl: !1,
					zoom: D,
					center: o()
				}), x = w.getMap(), x.addListener("idle", l), T && T(), $(window).on("resize.gmap", function() {
					google.maps.event.trigger(x, "resize")
				})
			}

			function o() {
				var e, t = i.selectedCity,
					n = i.selectedPoi,
					a = i.selectedHotel;
				return e = n || a || t || {
					lat: 39.9087306,
					lng: 116.3886342
				}, "string" == typeof e.lat && (e.lat = parseFloat(e.lat)), "string" == typeof e.lng && (e.lng = parseFloat(e.lng)), e
			}

			function r() {
				var t = function() {
						var e = $("#recommend-map");
						e.width(e.parent().width() - 320)
					},
					i = n("date");
				w && w.cardLayer && w.cardLayer.setMap(null), $(window).off("resize.map").on("resize.map", t), setTimeout(t, 0), $("#transit-date-picker").off("click").on("click", function(t) {
					if (R.datepicker("widget").is(":hidden")) {
						var n = e.getDate();
						R.val(i(n, "yyyy-MM-dd")), R.show().datepicker("show").hide(), R.datepicker("widget").css({
							top: $(t.target).offset().top + 20,
							left: $(t.target).offset().left
						})
					} else R.hide();
					t.preventDefault()
				}), C || (C = {
					destroy: function() {}
				}, requirejs(["web_qui_quiselect"], function(e) {
					C = new e({
						target: "#transit-time-picker"
					}), $(".transit-search .qui-select-title").one("click", function() {
						$(".transit-search .qui-select-list").scrollTop(1920)
					})
				}))
			}

			function s() {
				i.selectedTraffic = null, e.transitDate = null, $("#recommend-map").css("width", ""), $(window).off("resize.map"), $("#transit-date-picker").off("click"), C && (C.destroy(), C = null)
			}

			function l(n) {
				if (!(i.selectedPoi || i.selectedHotel || i.selectedTraffic) && x && x.getBounds()) {
					var a, o = (new Date).getTime(),
						r = i.selectedCity || {},
						s = x.getBounds(),
						l = s.getNorthEast(),
						c = s.getSouthWest(),
						d = x.getCenter(),
						p = [];
					q = o, A = [], j = [];
					for (a in e.filter.poi) e.filter.poi[a] && p.push(a);
					void 0 !== n && u(), (0 !== p.length || e.filter.hotel) && t.getMapInfo({
						data: {
							plan_id: t.getPlanId(),
							oneday_id: i.selectedDay.object.id,
							cityid: r.tagid,
							minlat: c.lat(),
							minlng: c.lng(),
							maxlat: l.lat(),
							maxlng: l.lng(),
							centerlat: d.lat(),
							centerlng: d.lng(),
							isrecommend: e.filter.type,
							category_id: p.join(","),
							hotelstar: e.filter.grade,
							ishotel: 1 & e.filter.hotel
						},
						onSuccess: function(e) {
							o === q && (A = e.data.poi.map(function(e) {
								return $.extend(e, {
									grade: 2 * e.grade
								})
							}), j = e.data.hotel, u())
						},
						onError: function(e) {
							i.showTip(e.data.msg, "error")
						}
					})
				}
			}

			function c() {
				w.clear(), L = {}, M = [], O = {}, F = {}
			}

			function d(e) {
				return P[e.cateid || e.catetypeid] || planner.maps.IconType.SIGHT
			}

			function u() {
				if (w && !i.selectedTraffic) {
					c();
					var t = i.place_list_flatten.filter(function(e) {
						return e.lat && e.lng && e.pid > 0
					}).map(function(e) {
						return e.pid
					});
					if (google.maps.event.trigger(x, "resize"), i.selectedPoi) {
						N = !1;
						var n = w.addMarker($.extend({
							icon: d(i.selectedPoi)
						}, i.selectedPoi));
						p({
							marker: n,
							object: i.selectedPoi,
							type: "poi",
							added: t.indexOf(i.selectedPoi.id) > -1,
							event: !1
						}), O[n.id] = n
					}
					if (i.selectedHotel) {
						N = !1;
						var a = w.addMarker($.extend({
							icon: planner.maps.IconType.HOTEL
						}, i.selectedHotel));
						p({
							marker: a,
							object: i.selectedHotel,
							type: "hotel",
							added: t.indexOf(i.selectedHotel.id) > -1,
							event: !1
						}), F[a.id] = a
					}
					if (A.length && A.map(function(n) {
						if (!(e.filter.path && t.indexOf(n.id) > -1)) {
							var i = w.addMarker($.extend({
								icon: d(n)
							}, n));
							p({
								marker: i,
								object: n,
								type: "poi",
								added: t.indexOf(n.id) > -1,
								event: !1
							}), O[i.id] = i
						}
					}), j.length && e.filter.hotel && j.map(function(n) {
						if (!(e.filter.path && t.indexOf(n.id) > -1)) {
							var i = $.extend({
								icon: planner.maps.IconType.HOTEL
							}, n);
							e.filter.price && $.extend(i, {
								title: "¥" + (n.price || n.reference_price),
								bubbleType: planner.maps.BubbleType.PRICE
							});
							var a = w.addMarker(i);
							p({
								marker: a,
								object: n,
								type: "hotel",
								added: t.indexOf(n.id) > -1,
								event: !1
							}), F[a.id] = a
						}
					}), e.filter.path) {
						var o = [];
						i.yesterday_hotel && o.push(i.yesterday_hotel), o = o.concat(i.place_list_flatten), i.today_hotel && o.push(i.today_hotel), E = o.filter(function(e) {
							return e.lat && e.lng
						}), E.map(function(e, t) {
							var n = w.addMarker($.extend({
								icon: planner.maps.IconType.LABEL,
								color: "#F56F62",
								label: t < 9 ? S[t + 1] : t + 1
							}, e, {
								title: e.cn_name || e.en_name
							}));
							p({
								marker: n,
								object: e,
								type: 2 == e.type ? "hotel" : "poi",
								added: !0,
								event: !0
							}), L[n.id] = n
						}), M.push(w.addLine(E)), N && (N = !1)
					}
				}
			}

			function p(e) {
				var t = f(e.type, e.object, e.added);
				e.marker.addListener("mouseover", function() {
					clearTimeout(k), I.data("marker", e).data("hover", !0), "hotel" === e.type ? (I.addClass("long-style"), I.attr("href", e.object.url || e.object.href).attr("target", "_blank")) : (I.removeClass("long-style"), I.attr("href", "#").attr("target", "")), I.find(".inner").empty().append(t).show(), w.addCard(e.marker, I.get(0)), m()
				}), e.marker.addListener("mouseout", function() {
					var t = I.data("marker");
					t && t.object && t.object.lat == e.object.lat && t.object.lng == e.object.lng && !I.data("hover") || (k = setTimeout(function() {
						w.removeCard(), I.data("marker", null).data("hover", null)
					}, 200))
				}), e.marker.addListener("click", function() {
					clearTimeout(k), I.data("marker", e).data("hover", !1), console.log(e.type, e.object.source), "hotel" === e.type ? (I.addClass("long-style"), I.attr("href", e.object.url || e.object.href).attr("target", "_blank")) : (I.removeClass("long-style"), I.attr("href", "#").attr("target", "")), I.find(".inner").empty().append(t).show(), w.addCard(e.marker, I.get(0)), m(), qyerUtil.doTrackCode("Planv3-map-pin-click")
				})
			}

			function f(e, t, n) {
				return "hotel" === e ? h(t, n) : g(t, n)
			}

			function h(e, t) {
				if (0 == e.pid) return ['<div class="close"><i class="iconfont">&#xe653;</i></div>', "<h4>", e.en_name || e.cn_name, "</h4>", "<h5>自定义酒店</h5>"].join("");
				for (var n = "", i = 1; i <= 5; i++) e.star >= i ? n += '<span class="icon golden-star"></span>' : n += '<span class="icon empty-star"></span>';
				return 3 == e.source ? ['<div class="close"><i class="iconfont">&#xe653;</i></div>', '<div class="add-to-plan plus"></div>', "<h4>", e.en_name || e.cn_name, "</h4>", e.en_name ? "<h5>" + e.cn_name + "</h5>" : "", '<div class="stars">', n, e.star, "星级", "</div>"].join("") : ['<div class="close"><i class="iconfont">&#xe653;</i></div>', '<div class="add-to-plan plus"></div>', "<h4>", e.en_name || e.cn_name, "</h4>", e.en_name ? "<h5>" + e.cn_name + "</h5>" : "", '<div class="stars">', n, e.star, "星级<i>|</i>", e.grade || "暂无评", "分 ", ["非常差", "差", "一般", "好", "非常好"][Math.floor(e.grade / 2)], "</div>"].join("")
			}

			function g(e, t) {
				if (0 == e.pid) return ['<div class="close"><i class="iconfont">&#xe653;</i></div>', "<h4>", e.cn_name || e.en_name, "</h4>", "<h5>自定义景点</h5>"].join("");
				if (3 == e.type) return ['<div class="close"><i class="iconfont">&#xe653;</i></div>', "<h4>", e.traffic_poiname || e.cn_name || e.en_name, "</h4>"].join("");
				for (var n = "", i = 1; i <= 5; i++) e.grade / 2 >= i ? n += '<span class="icon star"></span>' : n += '<span class="icon empty-star"></span>';
				return ['<div class="close"><i class="iconfont">&#xe653;</i></div>', '<div class="add-to-plan plus"></div>', "<h4>", e.cn_name || e.en_name, "</h4>", e.cn_name ? "<h5>" + e.en_name + "</h5>" : "", '<div class="stars">', n, "</div>", e.overall_rank ? '<div class="chart">全部' + e.city_name + e.cate_name + "景点中排名<em>第" + e.overall_rank + "名</em></div>" : ""].join("")
			}

			function m() {
				I.off("mouseenter").on("mouseenter", function() {
					clearTimeout(k)
				}).off("mouseleave").on("mouseleave", function() {
					I.data("hover") && w.removeCard()
				}).off("mouseover").on("mouseover", "a.add-to-plan", function(e) {
					var t = $(e.target);
					t.text(t.data("hover"))
				}).off("mouseout").on("mouseout", "a.add-to-plan", function(e) {
					var t = $(e.target);
					t.text(t.data("text"))
				}).off("click").on("click", ".close", function(e) {
					w.removeCard(), I.data("marker", null), qyerUtil.doTrackCode("Planv3-map-card-close"), e.preventDefault()
				}).on("click", ".add-to-plan", function(e) {
					if (!$(e.target).hasClass("loading")) {
						$(e.target).addClass("loading");
						var n = I.data("marker");
						"hotel" === n.type ? (i.selectedHotel = n.object, n.event && (i.selectedHotel.id = n.object.pid), i.addHotelCallback = function(t) {
							t && t.city && i.broadcast("auto-add-city", t.city), i.setSelectedDay(), $(e.target).removeClass("loading")
						}, i.broadcast("show-add-hotel")) : t.addPOI({
							data: {
								plan_id: t.getPlanId(),
								oneday_id: i.selectedDay.object.id,
								poi: {
									pid: n.object.pid || n.object.id,
									cn_name: n.object.cn_name,
									en_name: n.object.en_name,
									address: "",
									starthours: -1,
									startminutes: -1,
									endhours: -1,
									endminutes: -1,
									spend: 0,
									currency: "CNY",
									counts: 1,
									positiontype: 1,
									useraddress: null,
									lat: n.object.lat,
									lng: n.object.lng,
									catetypeid: parseInt(n.object.cateid || n.object.catetypeid, 10)
								},
								note: {
									content: "",
									images: []
								}
							},
							onSuccess: function(t) {
								i.showTip("添加成功！", "ok"), t.data.city && i.broadcast("auto-add-city", t.data.city), n.object.event_id = t.data.id, i.setSelectedDay(), $(e.target).removeClass("loading")
							},
							onError: function(t) {
								$(e.target).removeClass("loading"), i.showTip(t.data.msg, "error")
							}
						}), qyerUtil.doTrackCode("Planv3-map-card-addtoplan"), e.preventDefault()
					}
				}).on("click", ".add-note", function(e) {
					var t = I.data("marker");
					i.selectedPoiId = t.object.pid, i.selectedEventId = t.object.id, i.slideType = "edit", i.initMode = "edit", "hotel" === t.type ? i.showSlide("viewHotel", !0) : (i.slideHideMap = !0, i.selectedLastminute = 1e3 == t.object.cateid || 1e3 == t.object.catetypeid, i.showSlide("viewPOI", !0)), qyerUtil.doTrackCode("Planv3-map-card-addnote"), e.preventDefault()
				}).on("click", function(e) {
					if (!($(e.target).closest(".add-to-plan").size() > 0 || $(e.target).closest(".close").size() > 0)) {
						switch (e.target.nodeName) {
							case "IMG":
								qyerUtil.doTrackCode("Planv3-map-card-pic");
								break;
							case "H5":
								qyerUtil.doTrackCode("Planv3-map-card-click");
								break;
							default:
								$(e.target).hasClass("view-details") && qyerUtil.doTrackCode("Planv3-map-card-moreinfo"), $(e.target).hasClass("add-note") && qyerUtil.doTrackCode("Planv3-map-card-addnote")
						}
						var t = I.data("marker");
						if ("hotel" === t.type) return void(3 == t.object.source && qyerUtil.doTrackCode("Planv3-map-card-airbnbclick"));
						t.event ? (i.selectedEventId = "number" == typeof t.object.id ? t.object.id : t.object.id.id, i.selectedPoiId = t.object.pid, i.selectedLastminute = 1e3 == t.object.cateid || 1e3 == t.object.catetypeid, i.selectedGroupId = t.object.group_id, i.slideType = "edit", i.slideHideMap = !0, i.initMode = $(e.target).hasClass("add-note") ? "edit" : "view", i.showSlide(["", "viewPOI", "viewHotel", "viewTraffic"][t.object.type], !0)) : (i.selectedPoiId = t.object.id, i.slideHideMap = !0, i.slideType = "view", i.showSlide("viewPOI", !0)), e.preventDefault()
					}
				})
			}

			function v(e) {
				switch (parseInt(e.type)) {
					case 2:
						return parseInt(e.pid) > 0 ? 3 : 4;
					case 1:
						return parseInt(e.pid) > 0 ? 2 : 4;
					case 3:
						return e.traffic_poiid > 0 ? 2 : "" == e.traffic_poiname ? 1 : 4
				}
			}

			function y(e) {
				switch (parseInt(e.type)) {
					case 2:
					case 1:
						return parseInt(e.pid) > 0 ? e.pid : e.id;
					case 3:
						return e.traffic_poiid > 0 ? e.traffic_poiid : "" == e.traffic_poiname ? e.pid : e.id
				}
			}

			function b(a, o, s) {
				if (i.selectedTraffic) {
					var l, c = i.selectedTraffic.startEvent,
						d = i.selectedTraffic.endEvent,
						u = i.selectedTraffic.id ? i.selectedTraffic.mode : null,
						p = a || u || "transit";
					if (a || (!i.selectedTraffic.id && i.selectedTraffic.object.distance <= 1 && !i.selectedTraffic.mode ? p = "walking" : 4 != i.selectedTraffic.startEvent.tripmode && 7 != i.selectedTraffic.startEvent.tripmode || 4 != i.selectedTraffic.endEvent.tripmode && 7 != i.selectedTraffic.endEvent.tripmode || (p = "driving")), e.pathTab = p, l = {
						opid: y(c),
						otype: v(c),
						dpid: y(d),
						dtype: v(d),
						tripmode: p
					}, e.pathData[p] = [], e.loading = !0, p === i.selectedTraffic.mode && (l.routeid = i.selectedTraffic.route_id), "transit" === p) {
						if (!o) {
							o = n("date")(e.getDate(), "yyyy-MM-dd")
						}
						s || (s = "10:00"), l.datetime = o + " " + s + ":00"
					}
					e.copyrightError = !1, t.getDirection({
						data: l,
						onSuccess: function(t) {
							if (0 === t.error_code) {
								if (t.data && t.data.length > 0) {
									var n = t.data.map(function(e) {
										return "string" == typeof e.data && (e.data = JSON.parse(e.data)), e
									});
									"transit" === p && (n = n.filter(function(e) {
										return e.data.legs.filter(function(e) {
											return e.steps.filter(function(e) {
												return "WALKING" !== e.travel_mode
											}).length > 0
										}).length > 0
									})), n = n.map(function(e) {
										return "transit" === p && (e.lines = e.data.legs.map(function(e) {
											return e.steps.filter(function(e) {
												return "TRANSIT" === e.travel_mode
											}).map(function(e) {
												return e.transit_details.line
											})
										}).reduce(function(e, t) {
											return e.concat(t)
										}, []), e.departure_time = l.datetime), e.steps = e.data.legs.reduce(function(e, t) {
											return e.concat(t.steps)
										}, []), e
									}), e.pathData[p] = n, !i.selectedTraffic.id && !i.selectedTraffic.route_id && e.pathData[p].length > 0 ? e.togglePoiPath(null, e.pathData[p][0], function() {
										_(p)
									}) : _(p)
								}
							} else 100 === t.error_code ? e.copyrightError = !0 : i.showTip(t.data.msg, "error");
							e.loading = !1, e.$apply()
						},
						onError: function(t) {
							void 0 !== t.error_code ? 100 === t.error_code ? e.copyrightError = !0 : i.showTip(t.data.msg, "error") : i.showTip("网络错误，请稍后再试！", "error"), e.loading = !1, e.$apply()
						}
					}), r()
				}
			}

			function _(t) {
				if (!x) return void(T = function() {
					_(t), T = null
				});
				var n = e.pathData[t].find(function(e) {
					return e.id == i.selectedTraffic.route_id
				});
				if (c(), n && n.data) {
					var a = n.data.legs[0].start_location,
						o = n.data.legs[n.data.legs.length - 1].end_location;
					w.addMarker($.extend({
						label: "起",
						title: i.selectedTraffic.startEvent.title,
						bubbleType: planner.maps.BubbleType.RIGHT
					}, a)), w.addMarker($.extend({
						label: "终",
						title: i.selectedTraffic.endEvent.title,
						bubbleType: planner.maps.BubbleType.RIGHT
					}, o)), google.maps.event.trigger(x, "resize"), w.fitBounds([n.data.bounds.northeast, n.data.bounds.southwest]), w.addLine(n.data.overview_polyline)
				}
			}
			var w, x, k, T, C, D = 13,
				S = ["０", "１", "２", "３", "４", "５", "６", "７", "８", "９"],
				P = {
					32: planner.maps.IconType.SIGHT,
					78: planner.maps.IconType.FOOD,
					147: planner.maps.IconType.SHOPPING,
					148: planner.maps.IconType.EXPERIENCE,
					77: planner.maps.IconType.TRAFFIC,
					1000: planner.maps.IconType.DISCOUNT
				},
				I = (planner.maps.IconType.OTHER, planner.maps.IconType.PLANE, planner.maps.IconType.TRAIN, planner.maps.IconType.BUS, planner.maps.IconType.CAR, planner.maps.IconType.FERRY, planner.maps.IconType.OTHER, planner.maps.IconType.CAR, $('<a class="brief-card" href="#">').append($('<div class="inner">'))),
				E = [],
				L = {},
				M = [],
				A = [],
				O = {},
				j = [],
				F = {},
				q = null,
				N = !0,
				R = $("<input type='text' />").hide().datepicker({
					dayNamesMin: ["日", "一", "二", "三", "四", "五", "六"],
					monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
					dateFormat: "yy-mm-dd",
					changeYear: !0,
					minDate: new Date(1e3 * window.__plan_init_data__.server_time),
					changeMonthType: !0,
					onSelect: function(t) {
						e.transitDate = t, e.$apply()
					}
				}).appendTo("body");
			e.service = i, e.transitDate = null, e.filter = {
				poi: {
					32: !0,
					78: !0,
					147: !0,
					148: !0,
					77: !0
				},
				type: 0,
				hotel: !1,
				path: !0,
				price: !0,
				grade: 0
			}, e.pathTab = "transit", e.pathData = {
				transit: [],
				driving: [],
				walking: []
			}, e.transitTimes = function() {
				for (var e = 0, t = ["00", 10, 20, 30, 40, 50], n = []; e < 24;) n = n.concat(t.map(function(t) {
					return (e < 10 ? "0" + e : e) + ":" + t
				})), e++;
				return n
			}(), e.zoomIn = function(e) {
				x && x.setZoom(x.getZoom() + 1), e.preventDefault()
			}, e.zoomOut = function(e) {
				x && x.setZoom(x.getZoom() - 1), e.preventDefault()
			}, e.changeMode = function(e, t) {
				i.setMode(t), setTimeout(function() {
					$(window).resize()
				}, 0)
			}, e.pathTabHandle = function(t) {
				e.pathTab !== t && (b(t), e.pathTab = t)
			}, e.changeIcoSuffix = function(e) {
				return e.replace(/maps\.gstatic\.com/gi, "maps.gstatic.cn")
			}, e.togglePoiPath = function(e, n, a) {
				if (!(e && e.target && ($(e.target).closest(".path-details").size() > 0 || $(e.target).closest(".path-expand").size() > 0))) {
					var o = n.id,
						r = n.tripmode;
					i.selectedTraffic.route_id != o || i.selectedTraffic.mode != r || a ? (i.selectedTraffic.route_id = o, i.selectedTraffic.mode = r, i.selectedTraffic.object.route_id = o, i.selectedTraffic.object.tripmode = r, i.selectedTraffic.object.distance = (n.distance / 1e3).toFixed(2), i.selectedTraffic.object.duration = n.duration, qyerUtil.doTrackCode("planv3-transport-tab-" + r + "-confirm"), t.setDirection({
						data: {
							id: i.selectedTraffic.id,
							plan_id: t.getPlanId(),
							oneday_id: i.selectedDay.object.id,
							from_onedayevent_id: i.selectedTraffic.startEvent.id,
							to_onedayevent_id: i.selectedTraffic.endEvent.id,
							route_id: o,
							departure_time: n.departure_time
						},
						onSuccess: function(e) {
							0 !== e.error_code ? i.showTip(e.data.msg, "error") : (!i.selectedTraffic.id && e.data && (i.selectedTraffic.id = e.data), i.broadcast("update-selected-traffic"), a && a())
						},
						onError: function() {
							i.showTip("网络错误，请稍后再试！", "error")
						}
					})) : (i.selectedTraffic.route_id = null, i.selectedTraffic.mode = null, i.selectedTraffic.object.tripmode = null, i.selectedTraffic.object.route_id = null, t.unsetDirection({
						data: {
							id: i.selectedTraffic.id,
							plan_id: t.getPlanId(),
							oneday_id: i.selectedDay.object.id
						},
						onSuccess: function(e) {
							0 !== e.error_code ? i.showTip(e.data.msg, "error") : i.broadcast("update-selected-traffic")
						},
						onError: function() {
							i.showTip("网络错误，请稍后再试！", "error")
						}
					})), _(r)
				}
			}, e.togglePathDetails = function(e) {
				$(e.target).closest("li").find(".path-details").toggle(), $(e.target).closest(".path-expand").children().toggle()
			}, e.getDate = function() {
				if (e.transitDate) return new Date(e.transitDate);
				var n = t.getStartDate();
				if (n) return new Date(n.getTime() + 864e5 * i.selectedDay.index);
				var a = new Date;
				return a.setMonth(a.getMonth() + 1), a
			}, e.transitQuery = function(t) {
				b("transit", e.transitDate, e.transitTime), t.preventDefault()
			}, e.$watch("filter.type", l), e.$watch("filter.poi", l, !0), e.$watch("filter.hotel", l), e.$watch("filter.price", u), e.$watch("filter.path", u), e.$watch("filter.grade", function() {
				e.filter.hotel && l()
			}), e.$on("day-details-changed", function() {
				s(), N = !0, u()
			}), e.$on("day-details-event-sorted", u), e.$on("day-details-event-moved", u), e.$on("day-details-event-deleted", u), e.$on("poi-path-selected", function() {
				r(), b()
			}), e.$on("start-pin-animation", function(e, t) {
				"string" == typeof t && (t = t.split(",")[0]);
				var n = L[t];
				x && n && n.setAnimation(google.maps.Animation.BOUNCE)
			}), e.$on("stop-pin-animation", function(e, t) {
				"string" == typeof t && (t = t.split(",")[0]);
				var n = L[t];
				x && n && n.setAnimation(null)
			}), e.$on("selected-city-changed", function() {
				var e = i.selectedCity || {
					lat: 39.9087306,
					lng: 116.3886342
				};
				x.setCenter({
					lat: parseFloat(e.lat),
					lng: parseFloat(e.lng)
				}), x.setZoom(D), l()
			}), e.trackFilter = function(e) {
				qyerUtil.doTrackCode("Planv3-map-tool-" + e)
			}, e.$on("$destroy", function() {
				s(), $(window).off("resize.gmap")
			}), i.selectedTraffic && b(), window._googlemaploaded_ ? a() : $(window).on("googlemaploaded", function() {
				a()
			})
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-recommends.pois", []).directive("recommendPois", [
		function() {
			return {
				restrict: "C",
				template: '<ul class="range" ng-if="service.recommendType == \'search\'"><li ng-class="{true:\'active\'}[range==1]" ng-click="changeRange(1)" data-bn-ipg="Planv3-right-search-currentcity">当前城市({{service.searchRecommendResultCount.city_count || 0}})</li><li ng-class="{true:\'active\'}[range==2]" ng-click="changeRange(2)" data-bn-ipg="Planv3-right-search-global">全球范围({{service.searchRecommendResultCount.global_count || 0}})</li></ul><div class="container"><div class="loading" ng-if="loading">正在加载中...</div><div ng-if="!pois.length && !loading"><div class="empty-ufo" ng-if="service.recommendType !== \'search\'"><p>        当前城市没有结果~<br>        你可以<a href="#" ng-click="service.broadcast(\'show-add-poi\')"><i class="iconfont">&#xe68b;</i>手动添加</a></p></div><div class="empty-ufo" ng-if="service.recommendType === \'search\'"><p ng-if="range == 1">        当前城市没有搜到结果~<br>        你可以<a href="#" ng-click="changeRange(2)"><i class="iconfont">&#xe692;</i>搜索全球范围</a>或者<a href="#" ng-click="service.broadcast(\'show-add-poi\', service.recommendKeyword)"><i class="iconfont">&#xe68b;</i>手动添加</a></p><p ng-if="range == 2">没有搜到结果。你可以<a href="#" ng-click="service.broadcast(\'show-add-poi\', service.recommendKeyword)">手动添加</a></p></div></div><article ng-repeat="poi in pois" ng-if="!loading"><div class="image" ng-click="viewDetails($event, (poi.catetypeid == 1000 ? poi.pid : poi.id), poi.catetypeid == 1000, 1)"><div class="image__lmimg" style="background-image:url({{poi.image}}),url({{poi.image_default}})"></div><div class="comment" ng-if="poi.comment&amp;&amp;poi.comment.length"><div class="poitext"><img src="{{poi.avatar}}" alt=""><span>{{poi.user_name}}</span><p>{{poi.comment.length>45?(poi.comment.substring(0,45)+"..."):poi.comment}}</p></div></div></div><span class="recommend" ng-if="poi.catetypeid != 1000 && poi.isrecommend">必去</span>\x3c!-- <span class="lastminute" ng-if="poi.lm">折扣</span> --\x3e<span class="excellent" ng-if="poi.catetypeid == 1000">优选</span><div class="title"><div class="inner"><h1 ng-click="viewDetails($event, (poi.catetypeid == 1000 ? poi.pid : poi.id), poi.catetypeid == 1000, 2)" ng-class="{true:\'double-line\'}[poi.catetypeid == 1000]">{{poi.cn_name || poi.en_name || poi.title}}</h1><h2 ng-click="viewDetails($event, (poi.catetypeid == 1000 ? poi.pid : poi.id), poi.catetypeid == 1000, 2)" ng-if="poi.catetypeid != 1000">{{poi.en_name || \'&nbsp;\'}}</h2><a href="#" class="iconfont" ng-if="poi.lat && poi.lng && poi.catetypeid != 1000" ng-click="showInMap($event, poi)" data-bn-ipg="Planv3-right-poi-map">&#58959;</a></div></div><div class="summary" ng-if="poi.catetypeid != 1000"><div class="score"><span class="icon" ng-repeat="star in [1,2,3,4,5]" ng-class="{\'true\':\'empty-star\',\'false\':\'star\'}[poi.score &lt; ($index + 1)]"></span></div><div class="percentage">{{poi.percentage}}%的人选择</div></div><div class="hours" ng-if="poi.catetypeid != 1000">平均游玩时间：{{poi.average_hours}}</div><div class="price" ng-if="poi.catetypeid == 1000"><em>{{poi.price}}</em><span>元起</span><i>{{poi.list_price}}元</i></div><div class="solds" ng-if="poi.catetypeid == 1000"><span ng-if="poi.sale_count > 0"><em>{{poi.sale_count}}</em>名穷游er购买</span><span class="remaining" ng-if="poi.remaining < 10">当天剩余<em>{{poi.remaining}}</em>件</span></div><a href="javascript:void(0)" ng-if="poi.catetypeid != 1000" ng-click="addToPlan($event, poi);doTrackCode((service.recommendType == \'search\' ? \'Planv3-right-search-addpoi\' : \'Planv3-right-poi-addtoplan\'))" class="add" ng-mouseenter="addHoverHandler($event)" ng-mouseleave="addOutHandler($event)"><span class="iconfont">&#58943;</span><span class="text">{{getButtonText(poi)}}</span></a><a href="#" ng-click="addToPlan($event, poi, true)" data-bn-ipg="Planv3-lmpoi-overview-add" ng-if="poi.catetypeid == 1000" class="add"><span class="iconfont">&#58943;</span>加入行程</a>\x3c!-- <a href="{{poi.url}}" target="_blank" data-bn-ipg="Planv3-lmpoi-overview-booking" ng-if="poi.catetypeid == 1000" class="add half" style="border-left:0"><span class="iconfont">&#xe672;</span>立即预订</a> --\x3e</article><img src="//common3.qyerstatic.com/plan/img/shared/loading.gif" class="scroll-loading" ng-if="miniLoading"><div class="empty-text" ng-if="pois.length > 0 && allLoaded"><p ng-if="service.recommendType !== \'search\'">      当前城市没有更多结果了~<br>      你可以<a href="#" ng-click="service.broadcast(\'show-add-poi\')"><i class="iconfont">&#xe68b;</i>手动添加</a></p><p ng-if="service.recommendType === \'search\' && range == 1">      当前城市没有更多结果了~<br>      你可以<a href="#" ng-click="changeRange(2)"><i class="iconfont">&#xe692;</i>搜索全球范围</a>或者<a href="#" ng-click="service.broadcast(\'show-add-poi\', service.recommendKeyword)"><i class="iconfont">&#xe68b;</i>手动添加</a></p><p ng-if="service.recommendType === \'search\' && range == 2">      没有更多结果了。你可以<a href="#" ng-click="service.broadcast(\'show-add-poi\', service.recommendKeyword)">手动添加</a></p></div></div>'
			}
		}
	]).controller("RecommendPoisController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a() {
				i.selectedDay.object && i.selectedCity && (1 === r ? (t.loading = !0, t.allLoaded = !1) : t.miniLoading = !0, n.getRecommendPois({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						city_id: i.selectedCity.tagid,
						keyword: i.recommendKeyword,
						range: t.range,
						page: r++,
						type: o
					},
					onSuccess: function(n) {
						var o;
						o = "search" == i.recommendType ? n.data ? n.data.list : null : n.data, t.loading = !1, t.miniLoading = !1, n.data && n.data.city_count >= 0 && n.data.global_count >= 0 && (i.searchRecommendResultCount = {
							city_count: n.data.city_count,
							global_count: n.data.global_count
						}), o && o.length > 0 ? ("search" == i.recommendType && (1 == t.range && t.pois.length + o.length == n.data.city_count || 2 == t.range && t.pois.length + o.length == n.data.global_count) && (t.allLoaded = !0), _.each(o, t.poiFliterImg), t.pois = t.pois.concat(o)) : t.allLoaded = !0, t.$apply(), e(".recommends-body").off("scroll").on("scroll", function() {
							var n = 1 + parseInt("-" + e(".recommends-body").scrollTop()) / 30,
								s = parseInt("-" + e(".recommends-body").scrollTop()) + 60;
							if ("search" === i.recommendType ? n <= 0 ? e(this).find(".range").hide() : e(this).find(".range").css("opacity", n).show() : e(".recommends-tabs").css("top", s + "px"), o && o.length > 0) {
								e(".recommends-body").scrollTop() + e(".recommends-body").height() == e(".container").height() + 126 && t.$apply(function() {
									a(r)
								})
							}
						})
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error"), t.loading = !1, t.miniLoading = !1
					}
				}))
			}
			t.pois = [];
			var o = i.poiFilter,
				r = 1;
			t.getPoiDefaultPic = i.getPoiDefaultPic, t.loading = !1, t.miniLoading = !1, t.allLoaded = !1, t.range = 1, t.doTrackCode = qyerUtil.doTrackCode, t.changeRange = function(n) {
				t.range = n, r = 1, t.pois = [], a(), e(".recommend-pois .range").css("opacity", 1).show()
			}, t.$on("selected-city-changed", function() {
				r = 1, t.pois = [], a(r)
			}), t.$on("recommend-keyword-changed", function() {
				r = 1, t.pois = [], a()
			}), t.$on("poi-filter-changed", function() {
				o = i.poiFilter, r = 1, t.pois = [], a()
			}), t.viewDetails = function(e, t, n, a) {
				e.preventDefault(), i.selectedPoiId = t, i.selectedLastminute = n, i.slideType = "view", i.showSlide("viewPOI"), "search" === i.recommendType ? "DIV" === e.target.nodeName ? qyerUtil.doTrackCode("Planv3-right-search-poipic") : qyerUtil.doTrackCode("Planv3-right-search-poititle") : n ? 1 === a ? qyerUtil.doTrackCode("Planv3-lmpoi-overview-img") : qyerUtil.doTrackCode("Planv3-lmpoi-overview-title") : qyerUtil.doTrackCode("Planv3-right-poi-click")
			}, a(r), t.getButtonText = function(e) {
				var t = {},
					n = [];
				return e.added && e.added.length > 0 ? (e.added.forEach(function(e) {
					t[e.number] || (t[e.number] = !0, e.oneday_id == i.selectedDay.object.id ? n.push("当日") : n.push("D" + e.number))
				}), n.join("、") + "已添加") : "添加到行程"
			}, t.addHoverHandler = function(t) {
				var n = e(t.target).find(">span.text");
				n.data("text", n.text()).text("添加到行程"), t.preventDefault()
			}, t.addOutHandler = function(t) {
				var n = e(t.target).find(">span.text");
				n.text(n.data("text")), t.preventDefault()
			}, t.showInMap = function(e, t) {
				i.selectedPoi = t, i.broadcast("show-map-poi")
			}, t.addToPlan = function(e, t) {
				e.preventDefault();
				var a = 0;
				if (i.place_list.forEach(function(e) {
					1 == e.type && a++
				}), a >= 40) return void i.showTip("最多添加40个景点", "error");
				n.addPOI({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						rafill_reason: 5,
						poi: {
							pid: 1e3 == t.catetypeid ? t.pid : t.id,
							cn_name: t.cn_name || t.title,
							en_name: t.en_name,
							address: "",
							starthours: -1,
							startminutes: -1,
							endhours: -1,
							endminutes: -1,
							spend: 0,
							currency: "CNY",
							counts: 1,
							positiontype: 1,
							useraddress: null,
							lat: t.lat,
							lng: t.lng,
							catetypeid: parseInt(t.catetypeid, 10)
						},
						note: {
							content: "",
							images: []
						}
					},
					onSuccess: function(e) {
						i.scrBottom = !0, i.showTip("添加成功！", "ok"), e.data.city && (e.data.city.name = i.decodeHTML(e.data.city.name), i.broadcast("auto-add-city", e.data.city)), i.setSelectedDay(), i.broadcast("update-cart-icon")
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}, t.poiFliterImg = function(e) {
				e.image && (e.image += "300_200"), e.pic && (e.image = e.pic + "/420x280"), "https://static.qyer.com/images/place/no/300x200/" == e.image && (e.image = ""), e.type = 1, e.image_default = t.getPoiDefaultPic(e, "400x300")
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-recommends.rent-car", []).controller("RentCarController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			setTimeout(function() {
				e("#rent-car-iframe").closest(".ngdialog-content").css({
					width: "480px",
					marginLeft: "-240px"
				}).children().first().css({
					width: "470px",
					overflow: "hidden"
				}).end().end().end().attr("src", "http://qyer.huizuche.com/Pages/search-qyp.html?pt=" + a.rentCarData.rentDate + "T11:30&rt=" + a.rentCarData.returnDate + "T11:30")
			}, 0)
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-recommends.routes", []).directive("recommendRoutes", [
		function() {
			return {
				restrict: "C",
				template: '<div class="container"><div class="loading" ng-if="loading">正在加载中...</div><div class="item" ng-repeat="route in routes" ng-if="!loading"><div class="title"><div class="pin" ng-class="{daytour:\'icon1\', cursory:\'icon2\', editor:\'icon3\',theme:\'icon3\'}[route.tag || \'daytour\']"></div><h1><a href="javascript:void(0)" ng-click="viewDetails(route)" data-bn-ipg="Planv3-right-route-click">{{route.title}}</a></h1><p ng-repeat="day in route.days"><em ng-if="route.days.length &gt; 1">D{{$index + 1}}</em><span ng-repeat="poi in day.pois" ng-click="viewPoiDetails(poi.id)">{{poi.title}}</span></p></div><div class="desc" ng-if="route.desc"><div class="qyer-editor"></div><h2>- 小编点评 -</h2><p>“{{route.desc}}”</p></div><div class="controls"><a href="#" ng-click="viewDetails(route)" data-bn-ipg="Planv3-right-route-moreinfo"><span class="iconfont">&#58944;</span> 查看详情</a><a href="#" ng-if="route.days.length === 1" ng-click="addRouteToPlan($event, $index)" data-bn-ipg="Planv3-right-route-addtoplan"><span class="iconfont">&#58943;</span> 添加到行程</a><a href="#" ng-if="route.days.length &gt; 1" slide-dropdown="chooseDayOptions" data-index="{{$index}}" data-bn-ipg="Planv3-right-route-addtoplan"><span class="iconfont">&#58943;</span> 添加到行程</a></div></div></div>'
			}
		}
	]).controller("RecommendRoutesController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a() {
				i.selectedDay.object && (t.loading = !0, n.getRecommendRoutes({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						city_id: i.selectedCity.tagid
					},
					onSuccess: function(n) {
						t.$apply(function() {
							t.loading = !1, t.routes = n.data
						}), e(".recommends-body").scroll(function() {
							var t = parseInt("-" + e(".recommends-body").scrollTop()) + 60;
							e(".recommends-tabs").css("top", t + "px")
						})
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error"), t.$apply(function() {
							t.loading = !1
						})
					}
				}))
			}

			function o(e, t, a) {
				n.addRouteToPlan({
					data: {
						plan_id: n.getPlanId(),
						rafill_reason: e.rafill_reason,
						oneday_id: i.selectedDay.object.id,
						source_planid: a ? null : e.route_id,
						source_pids: t.pois.map(function(e) {
							return e.id
						})
					},
					onSuccess: function(e) {
						i.showTip("添加成功！", "ok"), e.data.city && i.broadcast("auto-add-city", e.data.city), i.setSelectedDay()
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}
			t.routes = [], t.loading = !1, t.$on("selected-city-changed", a), t.addRouteToPlan = function(e, n) {
				var a = t.routes[n];
				i.showConfirm("该线路所有景点将加入第" + (i.selectedDay.index + 1) + "天，是否确定？", e.target, function() {
					i.scrBottom = !0, o(a, a.days[0], !0)
				}), e.preventDefault()
			}, t.chooseDayOptions = {
				title: "选择添加该日的部分",
				menu: function(e) {
					var n = t.routes[e.index];
					return n.days.map(function(e, t) {
						return {
							label: "行程D" + (t + 1) + "的部分",
							icon: "add",
							action: function() {
								i.showConfirm("该线路D" + (t + 1) + "所有景点将加入第" + (i.selectedDay.index + 1) + "天，是否确定？", this, function() {
									i.scrBottom = !0, o(n, e)
								})
							}
						}
					})
				}
			}, t.viewDetails = function(e) {
				i.selectedRoute = e, i.showSlide("viewRoute")
			}, t.viewPoiDetails = function(e) {
				i.selectedPoiId = e, i.slideType = "view", i.showSlide("viewPOI")
			}, a()
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-recommends.tabs", []).directive("recommendsTabs", [
		function() {
			return {
				restrict: "C",
				template: '<ul class="mainmenu" ng-class="{true:\'search-state\'}[service.recommendType == \'search\']"><li style="text-align:left;"><a href="#" ng-click="changeTab(0, $event)" data-bn-ipg="Planv3-right-menu-route"><i class="iconfont">&#58938;</i>路线</a></li><li class="hold-position" style="text-align:left;" data-help-index="2" data-help-direction="top" data-help-content="选中游玩后，勾选美食即可" data-help-left-offset="-20"><a href="#" ng-click="changeTab(1, $event);doTrackCode((service.recommendType == \'search\' ? \'Planv3-right-search-poi\' : \'Planv3-right-menu-poi\'));"><i class="iconfont">&#58926;</i>游玩<span class="triangle"></span></a><div><ul class="poi-filter"><li><input type="checkbox" checkbox checked ng-change="togglePoiFilter()" ng-model="poi.all"><span ng-click="togglePoiFilter()">全部</span></li><li><input type="checkbox" checkbox checked ng-change="changePoiFilter(\'sight\')" ng-model="poi[\'32\']"><span ng-click="poi[\'32\'] = !poi[\'32\'];changePoiFilter(\'sight\');">景点</span></li><li><input type="checkbox" checkbox checked ng-change="changePoiFilter(\'food\')" ng-model="poi[\'78\']"><span ng-click="poi[\'78\'] = !poi[\'78\'];changePoiFilter(\'food\');">美食</span></li><li><input type="checkbox" checkbox checked ng-change="changePoiFilter(\'shopping\')" ng-model="poi[\'147\']"><span ng-click="poi[\'147\'] = !poi[\'147\'];changePoiFilter(\'shopping\');">购物</span></li><li><input type="checkbox" checkbox checked ng-change="changePoiFilter(\'event\')" ng-model="poi[\'148\']"><span ng-click="poi[\'148\'] = !poi[\'148\'];changePoiFilter(\'event\');">体验</span></li><li><input type="checkbox" checkbox checked ng-change="changePoiFilter(\'trans\')" ng-model="poi[\'77\']"><span ng-click="poi[\'77\'] = !poi[\'77\'];changePoiFilter(\'trans\');">交通</span></li></ul></div></li><li class="hold-position" style="text-align:left;" data-help-index="3" data-help-direction="top" data-help-content="选中后，可搜索酒店" data-help-step="1" data-help-left-offset="-16"><a href="#" ng-click="changeTab(2, $event);doTrackCode((service.recommendType == \'search\' ? \'Planv3-right-search-hotel\' : \'Planv3-right-menu-hotel\'));"><i class="iconfont">&#58915;</i>住宿\x3c!--em class="evt-1012"></em--\x3e<span class="triangle"></span></a></li><li data-help-index="4" data-help-direction="top" data-help-content="选中城际交通后，输入起始城市即可" data-help-step="1"><a href="#" ng-click="changeTab(3, $event)" data-bn-ipg="Planv3-right-menu-trans"><i class="iconfont">&#58911;</i>城际交通</a></li><li style="display:none"><a href="#" ng-click="changeTab(4, $event)"data-bn-ipg="Planv3-right-menu-collection"><i class="iconfont">&#58939;</i>备选<span class="triangle"></span></a></li><li class="hold-position" style="text-align: right;"><a href="#" ng-click="changeTab(5, $event)" data-bn-ipg="Planv3-right-menu-lastminute"><i class="iconfont" style="font-size: 1.1em;">&#xe673;</i>折扣<span class="triangle"></span></a><div><ul class="lm-filter"><li><input type="checkbox" checkbox checked ng-change="toggleLmFilter()" ng-model="lastminute.all"><span ng-click="toggleLmFilter()">全部</span></li><li><input type="checkbox" checkbox checked ng-change="changeLmFilter(\'ticket\')" ng-model="lastminute[\'1\']"><span ng-click="lastminute[\'1\'] = !lastminute[\'1\'];changeLmFilter(\'ticket\');">机票/酒店/自由行</span></li><li><input type="checkbox" checkbox checked ng-change="changeLmFilter(\'service\')" ng-model="lastminute[\'2\']"><span ng-click="lastminute[\'2\'] = !lastminute[\'2\'];changeLmFilter(\'service\');">WiFi/签证/保险</span></li><li><input type="checkbox" checkbox checked ng-change="changeLmFilter(\'local\')" ng-model="lastminute[\'3\']"><span ng-click="lastminute[\'3\'] = !lastminute[\'3\'];changeLmFilter(\'local\');">当地游玩</span></li></ul></div></li></ul>'
			}
		}
	]).controller("RecommendsTabsController", ["$scope", "plannerService",
		function(e, t) {
			var n = ["routes", "pois", "hotels", "traffics", "alternatives", "lastminutes"];
			e.service = t, e.doTrackCode = qyerUtil.doTrackCode, e.poi = {
				all: !0,
				32: !0,
				78: !0,
				147: !0,
				148: !0,
				77: !0
			}, e.lastminute = {
				all: !0,
				1: !0,
				2: !0,
				3: !0
			}, e.hotel = {
				type: 0,
				grade: 0,
				order: 0
			}, e.changeTab = function(e, i) {
				$(".recommends-tabs .mainmenu>li").eq(e).find(">a").addClass("active").end().siblings("li").find(">a").removeClass("active"), $(".recommends-tabs").css("top", "60px"), t.changeRecommendTab(n[e]), i && i.preventDefault()
			}, e.$on("selected-day-changed", function() {
				$(".recommends-tabs").css("top", "60px")
			}), e.$on("recommend-type-changed", function() {
				"normal" !== t.recommendType && "pois" !== t.selectedRecommendTab && "hotels" !== t.selectedRecommendTab && "lastminutes" !== t.selectedRecommendTab && e.changeTab(1)
			}), e.togglePoiFilter = function() {
				setTimeout(function() {
					var n, i = [],
						a = e.poi.all;
					for (n in e.poi) "all" !== n && (e.poi[n] = a, a && i.push(n));
					e.$apply(), t.changePoiFilter(a ? 0 : "")
				}, 0), qyerUtil.doTrackCode("Planv3-right-menu-all")
			}, e.changePoiFilter = function(n) {
				var i, a = [],
					o = !0;
				for (i in e.poi) "all" !== i && (o = o && e.poi[i], e.poi[i] && a.push(i));
				e.poi.all = o, e.poi.all ? t.changePoiFilter("0") : t.changePoiFilter(a.join(",")), qyerUtil.doTrackCode("Planv3-right-menu-" + n)
			}, e.toggleLmFilter = function() {
				setTimeout(function() {
					var n, i = [],
						a = e.lastminute.all;
					for (n in e.lastminute) "all" !== n && (e.lastminute[n] = a, a && i.push(n));
					e.$apply(), a ? t.changeLmFilter("0") : t.changeLmFilter(i.join(","))
				}, 0), qyerUtil.doTrackCode("Planv3-right-menu-lmall")
			}, e.changeLmFilter = function(n) {
				var i, a = [],
					o = !0;
				for (i in e.lastminute) "all" !== i && (o = o && e.lastminute[i], e.lastminute[i] && a.push(i));
				e.lastminute.all = o, o ? t.changeLmFilter("0") : t.changeLmFilter(a.join(",")), qyerUtil.doTrackCode("Planv3-right-menu-" + n)
			}, e.changeTab(1)
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-recommends.traffics", []).directive("recommendTraffics", [
		function() {
			return {
				restrict: "C",
				template: '<div class="container traffics-v2-container" ng-class="{true: \'has-brief\'}[!!brief]"><div class="filter-box"><div class="filter-row"><input id="recommend-traffic-start-city" class="filter-city-input filter-city-input-left" type="text" placeholder="出发城市"><i class="filter-city-arrow iconfont">&#xe64a;</i><input id="recommend-traffic-end-city" class="filter-city-input filter-city-input-right" type="text" placeholder="到达城市"></div><div class="filter-row" ng-class="{true: dashed}[!!brief]"><div class="qui-select traffic-guests-select"          ng-class="{true: \'qui-select-open\' }[isShowGuests]"          ng-click="toggleGuests($event)"><div class="qui-select-title">{{adults + children + infants}}个乘客</div><div ng-show="isShowGuests" class="traffic-guests-details"><div class="traffic-guest-type"><span>{{adults}}成人</span><div class="traffic-guest-remove" ng-class="{true: \'traffic-guest-disabled\'}[adults <= 1]" ng-click="removeGuest(\'adults\')">-</div><div class="traffic-guest-add" ng-class="{true: \'traffic-guest-disabled\'}[(adults + children + infants) >= 4]" ng-click="addGuest(\'adults\')">+</div></div><div class="traffic-guest-type"><span>{{children}}儿童</span><div class="traffic-guest-remove" ng-class="{true: \'traffic-guest-disabled\'}[children <= 0]" ng-click="removeGuest(\'children\')">-</div><div class="traffic-guest-add" ng-class="{true: \'traffic-guest-disabled\'}[(adults + children + infants) >= 4]" ng-click="addGuest(\'children\')">+</div></div><div class="traffic-guest-type"><span>{{infants}}婴儿</span><div class="traffic-guest-remove" ng-class="{true: \'traffic-guest-disabled\'}[infants <= 0]" ng-click="removeGuest(\'infants\')">-</div><div class="traffic-guest-add" ng-class="{true: \'traffic-guest-disabled\'}[(adults + children + infants) >= 4]" ng-click="addGuest(\'infants\')">+</div></div></div></div><input id="traffic-date-input" class="traffic-date-input" type="text" value="{{initialDate()}}"><select name="time" id="traffic-time"><option value="00:00">00:00</option><option value="00:10">00:10</option><option value="00:20">00:20</option><option value="00:30">00:30</option><option value="00:40">00:40</option><option value="00:50">00:50</option><option value="01:00">01:00</option><option value="01:10">01:10</option><option value="01:20">01:20</option><option value="01:30">01:30</option><option value="01:40">01:40</option><option value="01:50">01:50</option><option value="02:00">02:00</option><option value="02:10">02:10</option><option value="02:20">02:20</option><option value="02:30">02:30</option><option value="02:40">02:40</option><option value="02:50">02:50</option><option value="03:00">03:00</option><option value="03:10">03:10</option><option value="03:20">03:20</option><option value="03:30">03:30</option><option value="03:40">03:40</option><option value="03:50">03:50</option><option value="04:00">04:00</option><option value="04:10">04:10</option><option value="04:20">04:20</option><option value="04:30">04:30</option><option value="04:40">04:40</option><option value="04:50">04:50</option><option value="05:00">05:00</option><option value="05:10">05:10</option><option value="05:20">05:20</option><option value="05:30">05:30</option><option value="05:40">05:40</option><option value="05:50">05:50</option><option value="06:00">06:00</option><option value="06:10">06:10</option><option value="06:20">06:20</option><option value="06:30">06:30</option><option value="06:40">06:40</option><option value="06:50">06:50</option><option value="07:00" selected>07:00</option><option value="07:10">07:10</option><option value="07:20">07:20</option><option value="07:30">07:30</option><option value="07:40">07:40</option><option value="07:50">07:50</option><option value="08:00">08:00</option><option value="08:10">08:10</option><option value="08:20">08:20</option><option value="08:30">08:30</option><option value="08:40">08:40</option><option value="08:50">08:50</option><option value="09:00">09:00</option><option value="09:10">09:10</option><option value="09:20">09:20</option><option value="09:30">09:30</option><option value="09:40">09:40</option><option value="09:50">09:50</option><option value="10:00">10:00</option><option value="10:10">10:10</option><option value="10:20">10:20</option><option value="10:30">10:30</option><option value="10:40">10:40</option><option value="10:50">10:50</option><option value="11:00">11:00</option><option value="11:10">11:10</option><option value="11:20">11:20</option><option value="11:30">11:30</option><option value="11:40">11:40</option><option value="11:50">11:50</option><option value="12:00">12:00</option><option value="12:10">12:10</option><option value="12:20">12:20</option><option value="12:30">12:30</option><option value="12:40">12:40</option><option value="12:50">12:50</option><option value="13:00">13:00</option><option value="13:10">13:10</option><option value="13:20">13:20</option><option value="13:30">13:30</option><option value="13:40">13:40</option><option value="13:50">13:50</option><option value="14:00">14:00</option><option value="14:10">14:10</option><option value="14:20">14:20</option><option value="14:30">14:30</option><option value="14:40">14:40</option><option value="14:50">14:50</option><option value="15:00">15:00</option><option value="15:10">15:10</option><option value="15:20">15:20</option><option value="15:30">15:30</option><option value="15:40">15:40</option><option value="15:50">15:50</option><option value="16:00">16:00</option><option value="16:10">16:10</option><option value="16:20">16:20</option><option value="16:30">16:30</option><option value="16:40">16:40</option><option value="16:50">16:50</option><option value="17:00">17:00</option><option value="17:10">17:10</option><option value="17:20">17:20</option><option value="17:30">17:30</option><option value="17:40">17:40</option><option value="17:50">17:50</option><option value="18:00">18:00</option><option value="18:10">18:10</option><option value="18:20">18:20</option><option value="18:30">18:30</option><option value="18:40">18:40</option><option value="18:50">18:50</option><option value="19:00">19:00</option><option value="19:10">19:10</option><option value="19:20">19:20</option><option value="19:30">19:30</option><option value="19:40">19:40</option><option value="19:50">19:50</option><option value="20:00">20:00</option><option value="20:10">20:10</option><option value="20:20">20:20</option><option value="20:30">20:30</option><option value="20:40">20:40</option><option value="20:50">20:50</option><option value="21:00">21:00</option><option value="21:10">21:10</option><option value="21:20">21:20</option><option value="21:30">21:30</option><option value="21:40">21:40</option><option value="21:50">21:50</option><option value="22:00">22:00</option><option value="22:10">22:10</option><option value="22:20">22:20</option><option value="22:30">22:30</option><option value="22:40">22:40</option><option value="22:50">22:50</option><option value="23:00">23:00</option><option value="23:10">23:10</option><option value="23:20">23:20</option><option value="23:30">23:30</option><option value="23:40">23:40</option><option value="23:50">23:50</option></select>\x3c!-- <div class="traffic-time-container"><input id="traffic-time" type="text" name="time" value="07:00"/></div> --\x3e<a href="#" class="filter-query" ng-click="search($event)" ng-class="{true: \'disabled\'}[!start_city || !end_city || search_loading]">{{ search_loading ? \'查询中\' : \'查询\'}}</a></div></div><div class="brief-box" ng-if="brief"><h4>从{{start_city.name}}到{{end_city.name}}距离：{{brief[0].distance}}km</h4><ul><li ng-repeat="item in brief" ng-if="item.tripmode && (item.avg_time > 0 || item.percent > 0 || item.avg_spend > 0)"><i class="iconfont">{{[\'\', \'\', \'\', \'\', \'\', \'\', \'\', \'\'][item.tripmode]}}</i><span ng-if="item.percent > 0">{{item.percent}}%的用户选择了</span><span>{{[\'\', \'飞机\', \'火车\', \'巴士\', \'自驾\', \'邮轮\', \'其他\', \'租车\'][item.tripmode]}}</span><span ng-if="item.avg_time > 0">，平均用时{{(item.avg_time / 60).toFixed(1)}}小时</span><span ng-if="item.avg_spend">，花费{{item.avg_spend}}人民币</span></li></ul></div><ul class="info-tab" ng-if="brief"><li style="text-align: left;" ng-class="{true: \'active\'}[tab == 1]"        data-bn-ipg="Planv3_right_trans_flight" ng-click="changeTab(1)"><div><i class="iconfont">&#xe6ae;</i><span>飞机</span></div></li><li ng-class="{true: \'active\'}[tab == 2]" data-bn-ipg="Planv3_right_trans_train"        ng-click="changeTab(2)"><div style="margin-left: -10px"><i class="iconfont">&#xe6af;</i><span>火车</span></div></li><li ng-class="{true: \'active\'}[tab == 3]" data-bn-ipg="Planv3_right_trans_bus"        ng-click="changeTab(3)"><div><i class="iconfont">&#xe6ab;</i><span>巴士</span></div></li><li ng-class="{true: \'active\'}[tab == 4]" data-bn-ipg="Planv3_right_trans_driving"        ng-click="changeTab(4)"><div style="margin-left: 10px"><i class="iconfont">&#xe6ac;</i><span>自驾</span></div></li><li style="text-align: right;" ng-class="{true: \'active\'}[tab == 5]"      data-bn-ipg="Planv3_right_trans_ship" ng-click="changeTab(5)"><div><i class="iconfont">&#xe6aa;</i><span>邮轮</span></div></li></ul><div class="info-box" ng-if="brief && !type_loading"><div class="empty" ng-if="!list || list.length === 0"><span>没有找到合适的{{[\'\', \'飞机\', \'火车\', \'巴士\', \'自驾\', \'邮轮\', \'其他\', \'租车\'][tab]}}方案，</span><a href="#" ng-click="addCustom()">点击手动添加</a></div>\x3c!-- 飞机 --\x3e<div class="info-item info-flight" ng-if="list && list.length > 0 && tab == 1" ng-repeat="item in list"><div class="info-item-header"><img src="{{logo}}" ng-if="item.logos && item.logos.length > 0" ng-repeat="logo in item.logos"><h4 ng-if="!item.logos || item.logos.length === 0">{{item.company.join(\' \')}}</h4><span class="info-item-price"><small>总价¥</small>{{item.Price.toFixed(2)}}</span></div><div class="info-item-time"><span>{{item.data[0].departure_time | time}} {{item.data[0].departure_city_name}}</span><span class="info-item-time-line" ng-if="item.data.length > 1">{{item.data.length - 1}}次中转</span><span class="info-item-time-line" ng-if="item.data.length === 1">直达</span><span>{{item.data[item.data.length - 1].arrival_time | time}} {{item.data[item.data.length - 1].arrival_city_name}}</span><span>{{duration(item.data[0].departure_time, item.data[item.data.length - 1].arrival_time)}}</span><div class="info-item-expand" data-bn-ipg="Planv3_right_trans_flight_route"            ng-show="!item.$open" ng-click="item.$open = true"><span>展开路线</span><i class="iconfont">&#xe630;</i></div><div class="info-item-expand" ng-show="item.$open" ng-click="item.$open = false"><span>收起路线</span><i class="iconfont">&#xe631;</i></div></div><div class="info-item-details" ng-show="item.$open" ng-init="item.$open = false"><div class="info-item-segment" ng-repeat="segment in item.data"><div class="info-item-stop"><span class="info-item-stop-time">{{segment.departure_time | time}}</span><span>{{segment.departure_city_name}}</span><span>{{segment.departure_poi_name}}</span></div><div class="info-item-section"><i class="iconfont">&#xe6ae;</i><span>{{item.items[$index].Company}} {{segment.flight_number}}</span></div><div class="info-item-stop"><span class="info-item-stop-time">{{segment.arrival_time | time}}</span><span>{{segment.arrival_city_name}}</span><span>{{segment.arrival_poi_name}}</span></div></div></div><div class="info-item-controls"><div class="info-item-button" data-bn-ipg="Planv3_right_trans_flight_add"            ng-click="addFlightToPlan(item)"><i class="iconfont">&#xe69e;</i><span>加入行程</span></div><div class="info-item-button" data-bn-ipg="Planv3_right_trans_flight_reservation"            ng-click="bookFlight(item)"><i class="iconfont">&#xe69d;</i><span>现在预订</span></div></div></div>\x3c!-- 其他 --\x3e<div class="info-item" ng-if="list && list.length > 0 && tab != 1" ng-repeat="item in list"><div ng-if="tab != 4" class="info-item-header"><img src="{{logo}}" ng-repeat="logo in item.logos"><h4 ng-if="!item.logos || item.logos.length === 0" title="{{item.agencies}}">{{item.agencies}}</h4><span class="info-item-price" ng-if="source === \'google\' && item.spend > 0"><small>总价¥</small>{{(item.spend / 1).toFixed(2)}}</span><span class="info-item-price" ng-if="source === \'goeuro\' && item.price && item.price != 0"><small>总价¥</small>{{item.price}}</span><span class="info-item-price-gray" ng-if="(source === \'goeuro\' && (item.price <= 0 || !item.price)) || (source === \'google\' && (item.spend <= 0 || !item.spend))">无实时价格</span></div><div class="info-item-time"><span ng-if="source === \'google\' && item.start_hours && item.start_minutes">{{item.start_hours}}:{{item.start_minutes}} {{item.fromplace}}</span><span ng-if="source === \'google\' && (!item.start_hours || !item.start_minutes)">{{item.fromplace}}</span><span ng-if="source === \'goeuro\'">{{item.start_time}} {{item.start_place}}</span><span class="info-item-time-line" ng-if="source === \'google\' && tab == 2 && item.segments && item.segments.length <= 1">直达</span><span class="info-item-time-line" ng-if="source === \'google\' && tab == 2 && item.segments && item.segments.length > 1">{{item.segments.length - 1}}次中转</span><span class="info-item-time-line" ng-if="source === \'goeuro\' && tab == 2 && item.stopovers == 0">直达</span><span class="info-item-time-line" ng-if="source === \'goeuro\' && tab == 2 && item.stopovers > 0">{{item.stopovers}}次中转</span><span class="info-item-time-line" ng-if="tab != 2 && tab != 4 && item.segments && item.segments.length <= 1">直达</span><span class="info-item-time-line" ng-if="tab != 2 && tab != 4 && item.segments && item.segments.length > 1">{{item.segments.length - 1}}次中转</span><span class="info-item-time-line" ng-if="tab == 4">&nbsp;</span><span ng-if="source === \'google\' && item.end_hours && item.end_minutes">{{item.end_hours}}:{{item.end_minutes}} {{item.toplace}}</span><span ng-if="source === \'google\' && (!item.end_hours || !item.end_minutes)">{{item.toplace}}</span><span ng-if="source === \'goeuro\'">{{item.end_time}} {{item.end_place}}</span><span ng-if="source === \'google\'">{{duration(item.duration_time)}}</span><span ng-if="source === \'goeuro\'">{{duration(item.duration)}}</span><div class="info-item-expand" ng-show="item.loading"><span>路线加载中...</span></div>\x3c!-- 火车和自驾以外的 --\x3e<div class="info-item-expand" ng-if="tab != 2 && tab != 4" ng-show="!item.loading && !item.$open && item.segments" ng-click="item.$open = true" data-bn-ipg="{{source === \'goeuro\' ? \'Planv3_right_trans_goeuro_route\' : \'Planv3_right_trans_google_route\'}}"><span>展开路线</span><i class="iconfont">&#xe630;</i></div><div class="info-item-expand" ng-if="tab != 2 && tab != 4" ng-show="!item.loading && item.$open && item.segments" ng-click="item.$open = false"><span>收起路线</span><i class="iconfont">&#xe631;</i></div>\x3c!-- 火车 --\x3e<div class="info-item-expand" ng-if="tab == 2" ng-show="!item.loading && !item.$open" ng-click="loadGoeuroDetails(item)" data-bn-ipg="{{source === \'goeuro\' ? \'Planv3_right_trans_goeuro_route\' : \'Planv3_right_trans_google_route\'}}"><span>展开路线</span><i class="iconfont">&#xe630;</i></div><div class="info-item-expand" ng-if="tab == 2" ng-show="!item.loading && item.$open" ng-click="item.$open = false"><span>收起路线</span><i class="iconfont">&#xe631;</i></div>\x3c!-- 自驾(Google) --\x3e<div class="info-item-expand" ng-if="tab == 4" ng-show="!item.loading && !item.$open && item.segments" ng-click="loadMap($event, item)" data-bn-ipg="Planv3_right_trans_driving_route"><span>展开路线</span><i class="iconfont">&#xe630;</i></div><div class="info-item-expand" ng-if="tab == 4" ng-show="!item.loading && item.$open && item.segments" ng-click="unloadMap($event, item)"><span>收起路线</span><i class="iconfont">&#xe631;</i></div></div><div class="info-item-details" ng-if="tab != 4 && item.segments" ng-show="item.$open"><div class="info-item-segment" ng-repeat="segment in item.segments"><div class="info-item-stop"><span class="info-item-stop-time" ng-if="source === \'google\'">{{segment.start_hours}}:{{segment.start_minutes}}</span><span class="info-item-stop-time" ng-if="source === \'goeuro\'">{{segment.start_time}}</span><span ng-if="source === \'google\'">{{segment.fromplace}}</span><span ng-if="source === \'goeuro\'">{{segment.start_place}} {{segment.start_station}}</span></div><div class="info-item-section">\x3c!-- 车次号 --\x3e<i class="iconfont" ng-if="tab == 2 && segment.traffic_num">&#xe6af;</i><i class="iconfont" ng-if="tab == 3 && segment.traffic_num">&#xe6ab;</i><span ng-if="segment.traffic_num">{{segment.traffic_num}}</span></div><div class="info-item-stop"><span class="info-item-stop-time" ng-if="source === \'google\'">{{segment.end_hours}}:{{segment.end_minutes}}</span><span class="info-item-stop-time" ng-if="source === \'goeuro\'">{{segment.end_time}}</span><span ng-if="source === \'google\'">{{segment.toplace}}</span><span ng-if="source === \'goeuro\'">{{segment.end_place}} {{segment.end_station}}</span></div></div></div><div class="info-item-map" ng-if="tab == 4" ng-show="item.$open" ng-init="item.$open = false">        谷歌地图      </div><div class="info-item-controls"><div class="info-item-button" ng-if="source === \'goeuro\' && item.loading"><span>加载中……</span></div><div class="info-item-button" ng-if="source === \'goeuro\' && !item.loading" ng-click="addGoEuroToPlan(item)" data-bn-ipg="Planv3_right_trans_goeuro_add"><i class="iconfont">&#xe69e;</i><span>加入行程</span></div><div class="info-item-button" ng-if="source === \'google\'" ng-click="addToPlan(item)" data-bn-ipg="{{tab === 4 ? \'Planv3_right_trans_driving_add\' : \'Planv3_right_trans_google_add\'}}"><i class="iconfont">&#xe69e;</i><span>加入行程</span></div><a class="info-item-button" ng-if="tab == 4" target="_blank" href="{{brief.booking_url}}"            data-bn-ipg="Planv3_right_trans_zuzuche_reservation"><i class="iconfont">&#xe69d;</i><span>去租车</span></a><div class="info-item-button" ng-if="tab == 2 || tab == 3" data-bn-ipg="{{source === \'goeuro\' ? \'Planv3_right_trans_goeuro_reservation\' : \'Planv3_right_trans_google_reservation\'}}" ng-click="bookTrain(item)"><i class="iconfont">&#xe69d;</i><span>现在预订</span></div></div></div><div class="info-more" ng-if="list && list.length > 0"><span>没有更多方案了？ <a href="#" ng-click="addCustom()">点击手动添加</a></span></div></div><div class="info-box" ng-if="brief && type_loading"><div class="empty" ng-if="type_loading"><img src="//common1.qyerstatic.com/plan/desktop/edit3/img/loading2.gif" alt=""><span>正在为您查询方案...</span></div></div></div>'
			}
		}
	]).filter("time", function() {
		return function(e) {
			return e && e.substr(11, 5)
		}
	}).controller("RecommendTrafficsController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			function o(n) {
				var i = a.selectedDay.object.city_list.filter(function(e) {
					return e.tagid > 0
				});
				t.start_city = null, t.end_city = null, e("#recommend-traffic-start-city, #recommend-traffic-end-city").val(""), i[0] && (t.start_city = g = {
					id: i[0].tagid,
					name: i[0].name
				}, e("#recommend-traffic-start-city").val(i[0].name)), i[1] && (t.end_city = m = {
					id: i[1].tagid,
					name: i[1].name
				}, e("#recommend-traffic-end-city").val(i[1].name)), n && (t.brief = null, t.list = null, t.search())
			}

			function r(e) {
				return e ? (e.format.split(" ")[1] || "").split(":") : []
			}

			function s(e) {
				return e.format.split(" ")[0] || ""
			}

			function l(e) {
				var i, a = this,
					o = e.data.source;
				switch (o) {
					case "google":
						return i = e.data.data.routes, i.map(function(i) {
							var a = i.legs[0],
								o = i.fare,
								l = r(a.departure_time),
								c = r(a.arrival_time),
								d = a.steps.filter(function(e) {
									return "WALKING" !== e.travel_mode
								});
							return o && (o = o.value * n.getExchangeRate(o.currency)), {
								logos: [],
								spend: o || 0,
								fromplace: e.data.fromcity,
								fromplace_id: e.data.from_id,
								start_hours: l[0],
								start_minutes: l[1],
								toplace: e.data.tocity,
								toplace_id: e.data.to_id,
								end_hours: c[0],
								end_minutes: c[1],
								duration_time: a.duration.value,
								agencies: 4 === t.tab ? [] : d.reduce(function(e, t) {
									return e.concat(t.transit_details.line.agencies.map(function(e) {
										return e.name
									}))
								}, []).reduce(function(e, t) {
									return t in e.map ? e : (e.map[t] = !0, {
										list: e.list.concat(t),
										map: e.map
									})
								}, {
									list: [],
									map: {}
								}).list.join(", "),
								segments: 4 === t.tab ? [{
									start_hours: l[0],
									start_minutes: l[1],
									fromplace: e.data.fromcity,
									fromplace_id: e.data.from_id,
									end_hours: c[0],
									end_minutes: c[1],
									toplace: e.data.tocity,
									toplace_id: e.data.to_id
								}] : d.map(function(e) {
									var t, n, i, a, o = e.transit_details;
									return o ? (t = s(o.departure_time), n = s(o.arrival_time), i = r(o.departure_time), a = r(o.arrival_time), {
										type: e.travel_mode,
										start_hours: i[0],
										start_minutes: i[1],
										start_date: t,
										fromplace: o.departure_stop.name,
										end_hours: a[0],
										end_minutes: a[1],
										end_date: n,
										duration: e.duration.text,
										toplace: o.arrival_stop.name,
										url: o.line.url || o.line.agencies[0].url,
										traffic_num: o.line.short_name || o.line.name,
										agency: o.line.agencies[0].name
									}) : {}
								}),
								start: a.start_location,
								end: a.end_location,
								bounds: i.bounds,
								path: i.overview_polyline
							}
						});
					case "goeuro":
						return i = e.data.list, i.map(function(e) {
							e.params = a
						}), i;
					default:
						return []
				}
			}

			function c(i) {
				if (t.brief.list[i]) return t.list = t.brief.list[i], void(t.source = t.brief.source[i]);
				if (1 === i) t.type_loading = !0, n.getRecommendFlightTimeTable({
					data: {
						plan_id: n.getPlanId(),
						fromcity: g.name,
						tocity: m.name,
						cometime: e("#traffic-date-input").val(),
						time: e("#traffic-time").val(),
						adults: t.adults,
						children: t.children,
						infants: t.infants,
						SessionKey: ""
					},
					onSuccess: function(n) {
						var a = (n.data.list || []).map(function(t) {
							return e.extend({
								company: t.items.map(function(e) {
									return e.Company
								}),
								logos: t.data.reduce(function(e, t) {
									return t.logos.map(function(t) {
										e.map[t] || (e.map[t] = !0, e.list.push(t))
									}), e
								}, {
									list: [],
									map: {}
								}).list
							}, t)
						});
						t.brief.list[i] = a, t.tab === i && (t.list = a, t.type_loading = !1, t.$apply())
					},
					onError: function(e) {
						t.brief.list[i] = null, t.tab === i && (t.list = null, t.type_loading = !1, t.$apply())
					}
				});
				else if (5 === i) t.list = [];
				else {
					v = e("#traffic-date-input").val(), y = t.adults, b = t.children, _ = t.infants;
					var o = {
						fromcity_id: g.id,
						tocity_id: m.id,
						start_date: v,
						start_time: e("#traffic-time").val(),
						adults: t.adults,
						children: t.children,
						infants: t.infants,
						mode: $[i]
					};
					t.type_loading = !0, n.getRecommendTimeTable({
						data: o,
						onSuccess: function(e) {
							var n = l.call(o, e),
								a = e.data.source || "google";
							t.brief.source[i] = a, t.brief.list[i] = n, t.brief.booking_url = e.data.booking_url, t.tab === i && (t.source = a, t.list = n, t.type_loading = !1, t.$apply())
						},
						onError: function(e) {
							t.brief.list[i] = null, t.brief.source[i] = null, t.tab === i && (t.list = null, t.source = null, t.type_loading = !1, t.$apply()), 2 == e.error_code && a.showTip(e.data.msg, "error")
						}
					})
				}
			}

			function d(e) {
				if (!e) return null;
				if (k[e]) return k[e];
				var t = e.split("-");
				return t = new Date(t[0], t[1] - 1, t[2]), k[e] = t.getTime(), k[e]
			}

			function u(e, t) {
				return Math.floor((d(t) - d(e)) / 864e5)
			}

			function p(e, t) {
				var i = a.allDays.length;
				n.insertDay({
					data: {
						plan_id: n.getPlanId(),
						index: i
					},
					onSuccess: function(n) {
						a.allDays.push(n.data), 1 === e ? t && t() : p(e - 1, t)
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error"), t && t()
					}
				})
			}

			function f(n, i) {
				n < a.allDays.length ? i && i() : a.showConfirm2("到达日期已超出行程，将该日添加到行程中", function() {
					var o = n - a.allDays.length + 1,
						r = e("<div>", {
							class: "mask",
							style: "z-index:100;background:none"
						}).appendTo(document.body);
					a.showLoadingTip("正在添加中..."), p(o, function() {
						t.$apply(), a.hideLoadingTip(), r.remove(), i && i()
					})
				}, i)
			}

			function h(e) {
				e || (e = 0);
				var t = a.allDays[a.selectedDay.index + e];
				return t || (t = a.allDays[a.allDays.length - 1]), t
			}
			var g, m, v, y, b, _, w = a.tmpTraffic || {},
				x = [],
				$ = ["", "", "train", "bus", "driving"],
				k = {};
			t.tab = w.tab || null, t.brief = w.brief || null, t.list = w.list || null, t.source = w.source || null, t.adults = 1, t.children = 0, t.infants = 0, t.isShowGuests = !1, t.addGuest = function(e) {
					t.adults + t.children + t.infants !== 4 && (t[e] += 1)
				}, t.removeGuest = function(e) {
					t[e] -= 1, t[e] < 0 && (t[e] = 0), "adults" === e && t[e] < 1 && (t[e] = 1)
				}, t.toggleGuests = function(n, i) {
					e(n.target).closest(".traffic-guests-details").size() > 0 || (t.isShowGuests = !t.isShowGuests, t.isShowGuests ? e(document.body).on("click.tguests", function(n) {
						e(n.target).closest(".traffic-guests-select").size() > 0 || t.toggleGuests(n, !0)
					}) : e(document.body).off("click.tguests"), i && t.$apply())
				}, o(), requirejs(["web_qui_quiselect", "web_old_inputautocomplete"], function(i) {
					new i({
						target: "#traffic-time",
						exClassName: "traffic-time-select"
					});
					e(".traffics-v2-container").find(".filter-city-input").each(function() {
						var i = e(this);
						i.data("inited") || (i.data("inited", !0), i.qyerAutocomplete({
							isAllowEmptySeach: !0,
							isFocusedSeach: !0,
							autoSelect: !0,
							onSearch: function() {
								var t = e.trim(this.value),
									o = a.getAllCities().filter(function(e) {
										return e.tagid > 0
									});
								if (t) n.searchCity({
									data: {
										plan_id: n.getPlanId(),
										oneday_id: a.selectedDay.object.id,
										city_id: null,
										keyword: t
									},
									onSuccess: function(e) {
										var t = ['<div class="filter-city-list">'];
										t.push('<ul class="qui-inputAutocomplete-ul">'), e.data.forEach(function(e) {
											var n = '<li data-id="' + e.city_id + '" data-name="' + e.city_name + '"><span>' + a.encodeHTML(e.city_name) + "</span></li>";
											t.push(n)
										}), t.push("</ul>"), t.push("</div>"), i.qyerAutocomplete("pushHTML", t.join(""))
									},
									onError: function(e) {
										var t, n = ['<div class="search-city-list">'];
										t = e.data && e.data.msg ? e.data.msg : "搜索无结果", n.push('<div class="search-title">' + t + "</div>"), n.push('<ul class="qui-inputAutocomplete-ul">'), n.push("</ul>"), n.push("</div>"), i.qyerAutocomplete("pushHTML", n.join(""))
									}
								});
								else {
									var r = ['<div class="filter-city-list">'];
									r.push('<ul class="qui-inputAutocomplete-ul">'), o.map(function(e) {
										var t = '<li data-id="' + e.tagid + '" data-name="' + e.name + '"><span>' + e.name + "</span></li>";
										r.push(t)
									}), r.push("</ul>"), r.push("</div>"), i.qyerAutocomplete("pushHTML", r.join(""))
								}
							},
							onSelect: function(n) {
								var a = (e.trim(this.value), n.getAttribute("data-id")),
									o = n.getAttribute("data-name");
								this.value = o, i.hasClass("filter-city-input-left") ? t.$apply(function() {
									t.start_city = {
										id: a,
										name: o
									}
								}) : t.$apply(function() {
									t.end_city = {
										id: a,
										name: o
									}
								})
							}
						}), x.push(i))
					})
				}), e(".traffic-date-input").datepicker({
					dayNamesMin: ["日", "一", "二", "三", "四", "五", "六"],
					monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
					dateFormat: "yy-mm-dd",
					changeYear: !0,
					changeMonthType: !0,
					minDate: new Date,
					onSelect: function(e) {}
				}), t.search = function() {
					t.start_city && t.end_city && !t.search_loading && (qyerUtil.doTrackCode("Planv3_right_trans_search"), g = t.start_city, m = t.end_city, t.search_loading = !0, n.city2citytraffic({
						data: {
							from_cityid: t.start_city.id,
							from_cityname: t.start_city.name,
							to_cityid: t.end_city.id,
							to_cityname: t.end_city.name
						},
						onSuccess: function(e) {
							t.brief = e.data, t.brief.list = [], t.brief.source = [], t.changeTab(t.tab || parseInt(e.data[0].tripmode) || 1), t.search_loading = !1, t.$apply()
						},
						onError: function() {
							t.search_loading = !1, t.$apply()
						}
					}))
				}, t.changeTab = function(e) {
					t.tab = e, c(e)
				},
				t.duration = function(e, t) {
					var n, i;
					if (e && t) {
						"string" == typeof e && (e = new Date(e)), "string" == typeof t && (t = new Date(t));
						var a = t.getTime() - e.getTime();
						return n = Math.floor(a / 36e5), i = Math.floor(a % 36e5 / 6e4), i > 0 ? n + "h" + i + "m" : n + "h"
					}
					return e ? ("string" == typeof e && e.indexOf(":") > -1 && (e = e.split(":").map(function(e) {
						return parseInt(e)
					}), e = 60 * e[0] + e[1]), "number" == typeof e && (e = Math.ceil(e / 60)), e < 60 ? e + "m" : (n = Math.floor(e / 60), i = e % 60, i > 0 ? n + "h" + i + "m" : n + "h")) : ""
				}, t.loadGoeuroDetails = function(i, o) {
					i.segments && i.segments.length > 0 ? i.$open = !0 : (i.loading = !0, n.getRecommendGoeuroDetails({
						data: e.extend({}, i.params, {
							search_id: i.search_id,
							trip_id: i.trip_id
						}),
						onSuccess: function(n) {
							var a = {
									fromcity_id: i.params.fromcity_id,
									tocity_id: i.params.tocity_id,
									start_date: i.params.start_date,
									start_time: i.params.start_time,
									person: i.params.person,
									mode: i.params.mode,
									search_id: i.search_id,
									trip_id: i.trip_id
								},
								r = [];
							for (var s in a) r.push(s + "=" + encodeURIComponent(a[s]));
							e.extend(i, {
								segments: n.data.journey_list,
								tickets: n.data.ticket_list.map(function(t) {
									var n = r.concat(["offer_id=" + encodeURIComponent(t.offer_id)]);
									return e.extend(t, {
										url: "/goeurobooking.php?" + n.join("&")
									})
								})
							}), o ? o(i) : i.$open = !0, i.loading = !1, t.$apply()
						},
						onError: function(n) {
							e.extend(i, {
								segments: null
							}), i.loading = !1, a.showTip(n.data.msg), t.$apply()
						}
					}))
				}, t.bookFlight = function(e) {
					a.selectedFlightItem = e, a.showPopup('<section class="flight-details popup" ng-controller="FlightDetailsController"><h1>航班详情和价格</h1><div class="container"><p style="text-align: center; line-height: 140px; font-size: 16px;">正在加载中...</p></div></section>')
				}, t.addFlightToPlan = function(e) {
					var t = e.data[0].departure_time.split("T")[0],
						n = e.data[e.data.length - 1].arrival_time.split("T")[0];
					f(a.selectedDay.index + u(t, n), function() {
						a.selectedTrafficData = {
							currency: e.Currency || "CNY",
							price: e.Price,
							traffics: e.data.map(function(e) {
								var n = e.departure_time.split("T"),
									i = e.arrival_time.split("T"),
									a = n[1].substr(0, 5).split(":"),
									o = i[1].substr(0, 5).split(":");
								return {
									tripmode: 1,
									fromplace: e.departure_city_name,
									frompoi: e.departure_poi_name,
									fromplaceid: e.departure_city_id,
									frompositiontype: 1,
									fromday: h(u(t, n[0])).id,
									starthours: parseInt(a[0]),
									startminutes: parseInt(a[1]),
									toplace: e.arrival_city_name,
									topoi: e.arrival_poi_name,
									toplaceid: e.arrival_city_id,
									topositiontype: 1,
									today: h(u(t, i[0])).id,
									endhours: parseInt(o[0]),
									endminutes: parseInt(o[1]),
									traffic_number: e.flight_number
								}
							})
						}, a.rafill_reason = 1, a.isSelectedTrafficData = !0, a.broadcast("show-add-traffic")
					})
				}, t.bookTrain = function(e) {
					e.segments || (a.selectedTrainItemLoading = !0, t.loadGoeuroDetails(e, function() {
						a.broadcast("goeuro-train-details-loaded")
					})), a.selectedTrainItem = e, a.selectedTrainType = t.source, a.selectedTrainDate = v, a.selectedTrainAdults = y, a.selectedTrainChildren = b, a.selectedTrainInfants = _, a.showPopup('<section class="train-details popup" ng-controller="TrainDetailsController"><h1>价格详情</h1>\x3c!-- Google Source --\x3e<div class="container" ng-if="type === \'google\'"><p ng-if="loading" style="text-align: center; line-height: 140px; font-size: 16px;">正在加载中...</p><div class="train-item" ng-if="!loading" ng-repeat="seg in item.segments"><table><thead><tr><th colspan="4">{{date}}（{{weekday}}）</th></tr></thead><tbody><tr class="train-last"><td class="col1"><div class="train-icon"></div></td><td class="col2">{{seg.traffic_num}}</td><td class="col3">{{seg.fromplace}}<br>{{seg.toplace}}</td><td>{{seg.duration}}</td></tr><tr class="train-bottom"><td>信息来源</td><td>{{seg.agency}}</td><td colspan="2"><a ng-if="seg.url" href="{{seg.url}}" target="_blank" class="link" data-bn-ipg="Planv3_right_trans_google_book">去官网预订</a></td></tr></tbody></table></div></div>\x3c!-- GoEuro Source --\x3e<div class="container" ng-if="type === \'goeuro\'"><p ng-if="loading" style="text-align: center; line-height: 140px; font-size: 16px;">正在加载中...</p><div class="flydtlbox" ng-if="!loading"><div class="flydtlbox_tit"><span class="box1"><img src="{{logo}}" ng-repeat="logo in item.logos"></span><span class="box2">{{date}}</span><span class="box3"><span class="city">{{item.start_place}}</span><span class="next"></span><span class="city">{{item.end_place}}</span></span><span class="box4">{{duration}}</span></div><ul class="flydtlbox_cnt"><li class="clearfix" ng-repeat="seg in item.segments"><div class="box1"><span class="train-icon" ng-if="seg.traffic_mode === \'train\'"></span><span class="bus-icon" ng-if="seg.traffic_mode === \'bus\'"></span></div><div class="box2"><p>{{seg.start_date}}</p><p>{{seg.end_date}}</p></div><div class="box3"><p>{{seg.start_time}}</p><p>{{seg.end_time}}</p></div><div class="box4"><p><span class="name">{{seg.start_station}}</span></p><p><span class="name">{{seg.end_station}}</span></p></div><div class="box5"><p>{{seg.traffic_num}}</p></div><div class="box6">{{duration(seg.duration)}}</div></li></ul><div class="flydtlbox_wfgap"></div></div><div class="flyprcbox" ng-if="!loading"><ul class="flyprcbox_cnt"><li ng-repeat="ticket in item.tickets"><span class="box1" title="{{ticket.fare_type}}">{{ticket.fare_type}}</span><span class="box2"></span><span class="box3"><em>{{ticket.total_price}}</em>元</span><span class="box4"><a href="{{ticket.url}}" target="_blank" class="ui_buttonB booking_btn" data-bn-ipg="Planv3_right_trans_goeuro_book">预 订</a></span><span ng-if="$index == 0" class="box5">            成人<em>{{adults}}</em>            儿童<em>{{children}}</em>            婴儿<em>{{infants}}</em></span></li></ul></div></div></section>')
				}, t.addToPlan = function(e) {
					var n = e.segments[0].start_date,
						i = e.segments[e.segments.length - 1].end_date;
					f(a.selectedDay.index + u(n, i), function() {
						a.selectedTrafficData = {
							currency: e.currency || "CNY",
							price: e.spend,
							traffics: e.segments.map(function(i, a) {
								var o = null,
									r = -1,
									s = null,
									l = -1;
								return 0 === a && (o = e.fromplace, r = e.fromplace_id), a === e.segments.length - 1 && (s = e.toplace, l = e.toplace_id), {
									tripmode: t.tab,
									traffic_number: i.traffic_num,
									fromplace: o,
									fromplaceid: r,
									frompoi: 4 === t.tab ? null : i.fromplace,
									frompositiontype: 2,
									fromday: h(u(n, i.start_date)).id,
									starthours: i.start_hours,
									startminutes: i.start_minutes,
									toplace: s,
									toplaceid: l,
									topoi: 4 === t.tab ? null : i.toplace,
									topositiontype: 2,
									today: h(u(n, i.end_date)).id,
									endhours: i.end_hours,
									endminutes: i.end_minutes
								}
							})
						}, a.isSelectedTrafficData = !0, a.rafill_reason = 1, a.broadcast("show-add-traffic")
					})
				}, t.addGoEuroToPlan = function(e) {
					if (!e.segments) return e.loading = !0, void t.loadGoeuroDetails(e, function() {
						e.loading = !1, t.addGoEuroToPlan(e)
					});
					var n = e.segments[0].start_date,
						i = e.segments[e.segments.length - 1].end_date,
						o = u(n, i);
					f(a.selectedDay.index + o, function() {
						a.selectedTrafficData = {
							currency: "CNY",
							price: e.price.replace(/,/g, ""),
							traffics: e.segments.map(function(i, a) {
								var o = i.start_time.split(":"),
									r = i.end_time.split(":"),
									s = 0 === a ? g.id : -1,
									l = a === e.segments.length - 1 ? m.id : -1;
								return {
									tripmode: t.tab,
									traffic_number: i.traffic_num,
									fromplace: i.start_place,
									frompoi: i.start_station,
									fromplaceid: s,
									frompositiontype: 2,
									fromday: h(u(n, i.start_date)).id,
									starthours: o[0],
									startminutes: o[1],
									toplace: i.end_place,
									topoi: i.end_station,
									toplaceid: l,
									topositiontype: 2,
									today: h(u(n, i.end_date)).id,
									endhours: r[0],
									endminutes: r[1]
								}
							})
						}, a.isSelectedTrafficData = !0, a.rafill_reason = 1, a.broadcast("show-add-traffic")
					})
				}, t.addCustom = function() {
					var n = e("#traffic-time").val().split(":");
					a.selectedTrafficData = {
						currency: "CNY",
						traffics: [{
							tripmode: t.tab,
							fromplace: g.name,
							fromplaceid: g.id,
							frompositiontype: 1,
							starthours: parseInt(n[0]),
							startminutes: parseInt(n[1]),
							toplace: m.name,
							toplaceid: m.id,
							topositiontype: 1
						}]
					}, a.isSelectedTrafficData = !0, a.broadcast("show-add-traffic")
				}, t.loadMap = function(t, n) {
					n.$open = !0;
					var i, a = "map" + (new Date).getTime();
					e(t.target).closest(".info-item").find(".info-item-map").attr("id", a);
					n.$domid = a, i = n.$map = new planner.maps.Map(a, {
						scrollwheel: !1
					}), i.addMarker(e.extend({}, n.start, {
						label: "起"
					})), i.addMarker(e.extend({}, n.end, {
						label: "终"
					})), i.addLine(n.path), setTimeout(function() {
						google.maps.event.trigger(i.getMap(), "resize"), i.fitBounds([n.bounds.northeast, n.bounds.southwest])
					}, 0)
				}, t.unloadMap = function(t, n) {
					n.$open = !1, e("#" + n.$domid).empty()
				}, t.initialDate = function() {
					var e, t = n.getStartDate(),
						i = a.selectedDay.index,
						o = new Date;
					return t ? (e = new Date(t), e.getTime() < o.getTime() ? (e = o, e.setMonth(e.getMonth() + 1)) : e.setDate(e.getDate() + i)) : (e = o, e.setMonth(e.getMonth() + 1)), e.getFullYear() + "-" + (e.getMonth() + 1) + "-" + e.getDate()
				}, e(".recommends-body").on("scroll.traffics", function() {
					var t = 55 + e(".filter-box").height() + e(".brief-box").height(),
						n = e(".recommends-body").scrollTop();
					n > t ? (e(".traffics-v2-container").addClass("info-tab-fixed"), e(".info-tab").css("top", n)) : (e(".traffics-v2-container").removeClass("info-tab-fixed"), e(".info-tab").removeAttr("style"))
				}), t.$on("selected-day-changed", function(e, t) {
					t && t.isDayChanged && o(!0)
				}), t.$on("$destroy", function() {
					for (a.tmpTraffic = {
						brief: t.brief,
						list: t.list,
						tab: t.tab,
						source: t.source
					}, e(".recommends-body").off("scroll.traffics"); x.length;) try {
						x.shift().qyerAutocomplete("destroy")
					} catch (e) {
						console.log(e)
					}
				})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-recommends.train-details", []).controller("TrainDetailsController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			var o = a.selectedTrainItem;
			t.item = o, t.type = a.selectedTrainType, t.date = a.selectedTrainDate, t.adults = a.selectedTrainAdults, t.children = a.selectedTrainChildren, t.infants = a.selectedTrainInfants, t.loading = a.selectedTrainItemLoading, a.selectedTrainItem = null, a.selectedTrainType = null, a.selectedTrainDate = null, a.selectedTrainAdults = null, a.selectedTrainChildren = null, a.selectedTrainInfants = null, a.selectedTrainItemLoading = null, t.weekday = t.date.split("-"), t.weekday = new Date(t.weekday[0], t.weekday[1] - 1, t.weekday[2]), t.weekday = "周" + ["日", "一", "二", "三", "四", "五", "六"][t.weekday.getDay()], t.$apply(), setTimeout(function() {
				e(".train-details").closest(".ngdialog-content").css({
					width: "950px",
					marginLeft: "-475px"
				}), a.resizePopup()
			}, 0), t.duration = function(e) {
				return e < 60 ? e + "分" : Math.floor(e / 60) + "时" + e % 60 + "分"
			}, t.$on("goeuro-train-details-loaded", function() {
				t.loading = !1, t.$apply(), setTimeout(function() {
					a.resizePopup()
				}, 0)
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-slides.comment", []).controller("AddCommentController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			t.commentActive = i.scope.commentAction, t.poi = i.scope.poi, "add" === t.commentActive && (t.title = "添加", t.comment = {}), "edit" === t.commentActive && (t.title = "编辑", t.comment = _.clone(i.comment), t.lookScore = t.comment.score), t.comment.album = [], t.comment.imgs = [], t.setComment = function() {
				if (!t.comment.score) return void i.showTip("点击星星为它评分");
				if (t.comment.content.length < 30 || t.comment.content.length > 2e3) return void i.showTip("点评不少于30字，不超过2000字");
				if (t.submiting) return void i.showTip("正在保存，请勿重复提交!");
				t.submiting = !0;
				var a = {
					plan_id: n.getPlanId(),
					poiid: t.poi.id,
					content: t.comment.content,
					score: t.comment.score,
					imgs: t.comment.imgs.join(",")
				};
				"add" === t.commentActive && n.addPoiComment({
					data: a,
					onSuccess: function(e) {
						i.scope.comments.unshift(e.data), i.scope.already_comment = 1, i.scope.total_comments++, i.showTip("评论" + t.title + "成功", "ok"), t.closeThisDialog()
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error"), t.submiting = !1
					}
				}), "edit" === t.commentActive && n.editPoiComment({
					data: a,
					onSuccess: function(n) {
						e.each(i.scope.comments, function(e, t) {
							if (t.comment_id == n.data.comment_id) return i.scope.comments[e] = n.data, !1
						}), i.showTip("评论" + t.title + "成功", "ok"), t.closeThisDialog()
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error"), t.submiting = !1
					}
				})
			}, t.setScore = function(n) {
				t.comment.score = 2 * (e(n.target).index() + 1)
			}, t.enterScore = function(n) {
				t.lookScore = 2 * (e(n.target).index() + 1)
			}, t.leaveScore = function(e) {
				t.lookScore = t.comment.score
			}, requirejs(["web_old_textarea"], function() {
				e(".comment-box .textarea-wrapper").qyerTextArea({
					max: 2e3,
					min: 30
				}), setTimeout(function() {
					i.resizePopup()
				}, 0)
			}), t.uploadPicCallback = function(e) {
				var n = {};
				n.thumb = n.photo = e.url, t.$apply(function() {
					t.comment.imgs.unshift(e.key), t.comment.album.unshift(n)
				}), setTimeout(function() {
					i.resizePopup()
				}, 0)
			}, i.uploadPic("uploadPicBtn", "uploadPicBtnBox", t.uploadPicCallback), t.delUploadPic = function(e) {
				t.comment.album.splice(e, 1), t.comment.imgs.splice(e, 1)
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-slides.editNote", []).directive("slideEditNote", [
		function() {
			return {
				restrict: "C",
				template: '<div class="header"><h2>{{getDate() | date:\'M月d日\'}} 笔记</h2><a href="#" class="close" ng-click="service.hideSlide($event)" data-bn-ipg="Planv3-noteinfo-close">关闭</a></div><div class="body" id="edit-note"><div class="textarea-wrapper textarea-box qui-textArea box" ng-class="{hover:textarea.focus}"><textarea placeholder="添加备注的文字" class="ui2_textarea" ng-model="content" ng-focus="textarea.focusFun($event)" ng-blur="textarea.blurFun($event)" maxlength="3000" ng-class="{lostFocus:!textarea.btnShow}"></textarea><div class="textarea-info" ng-show="textarea.btnShow"><div class="tips textarea-count-length"><span class="current"></span>/<span class="max"></span>字            </div><div class="textarea-btnbox"><a href="#" class="button vm" ng-click="textarea.cancel($event)">取消</a><a href="#" class="button primary vm" ng-click="textarea.save($event)">保存</a></div></div></div>\x3c!--图片上传--\x3e<div class="uploadPic" ng-show="service.isLogin"><ul><li class="uploadPicLi" ng-repeat="image in images"><img class="uploadPicLi__pic" src="{{image.url || image.qnUrl}}/80x80" /><div class="uploadPicLi__view" data-index="{{$index}}" ng-click="showPic(image.url || image.qnUrl)"><i class="iconfont">&#58991;</i>点击查看</div><i class="uploadPicLi__delete iconfont" ng-click=\'delImage($index,$event)\'>&#58992;</i></li><li class="uploadPicLi" ng-if=\'imgStatus == "error"\'><div class="uploadPicLi__error"  ng-click="addImage()"><i class="iconfont">&#58990;</i>上传失败                    <br />重传</div></li><li class="uploadPicLi" ng-if=\'imgStatus == "loading"\'><i class="iconfont uploadPicLi__loading"></i></li><li class="uploadPicLi" ng-if=\'images.length < 5 && imgStatus == "default"\'><i class="iconfont uploadPicLi__add" ng-click="addImage()">&#58943;</i></li></ul><input type="hidden" id="uploadImg" /></div>\x3c!--/图片上传--\x3e</div>'
			}
		}
	]).controller("SlideEditNoteController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a() {
				if (!t.dirtyFlag) return !1;
				n.editNote({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						note_id: t.note_id,
						message: t.content,
						images: t.images,
						platform: "v3"
					},
					onSuccess: function(e) {
						t.$apply(function() {
							t.content_bak = t.content = e.data.message, t.images = e.data.images, t.dirtyFlag = 0
						}), i.updateSelectedNote(JSON.stringify(e.data)), i.showTip("保存成功！", "ok")
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}
			t.note_id = i.selectedNote.id, t.content_bak = t.content = i.selectedNote.message, t.imgStatus = "default", t.images = [], t.dirtyFlag = 0, t.service = i;
			for (var o in i.selectedNote.images) {
				var r = {};
				r.url = i.selectedNote.images[o].url, t.images.push(r)
			}
			t.getDate = function() {
				var e = n.getStartDate();
				return e ? new Date(e.getTime() + 864e5 * i.selectedDay.index) : null
			}, requirejs(["web_old_textarea"], function() {
				e(".slide-edit-note .textarea-wrapper").qyerTextArea({
					max: 3e3
				}).find("textarea").focus(), i.resizePopup()
			}), e(".slide-edit-note").on("change.dirty", "textarea", function() {
				t.dirtyFlag = 1
			}), t.$on("slide-closed:editNote", a), i.textareaTurn({
				scope: t,
				save: a
			}), t.addImage = function() {
				e("#uploadImg").trigger("click")
			}, t.delImage = function(e, n) {
				requirejs(["web_old_slidconfirm"], function(i) {
					i.confirm({
						text: "确认删除图片",
						target: n.target,
						onOK: function() {
							t.$apply(function() {
								t.images.splice(e, 1), t.dirtyFlag = 1
							})
						}
					})
				}), n.preventDefault()
			};
			var s = function() {
					t.$apply(function() {
						t.imgStatus = "loading"
					})
				},
				l = function(e) {
					var n = new Image;
					n.src = e.origin_url + "/80x80", n.onload = function() {
						t.$apply(function() {
							var n = {
								url: e.origin_url
							};
							t.images.push(n), t.imgStatus = "default", t.dirtyFlag = 1
						})
					}
				},
				c = function() {
					t.$apply(function() {
						t.imgStatus = "error"
					})
				};
			i.uploadPlanPic({
				browse_button: "uploadImg",
				container: "wrapper",
				paths: ["plan", "day", "note"],
				BeforeUpload: s,
				FileUploaded: l,
				UploadError: c
			}), t.showPic = function(e) {
				t.service.popData = e, t.service.popShow("showPic")
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-slides", ["planner-slides.editNote", "planner-slides.comment", "planner-slides.viewPOI", "planner-slides.viewHotel", "planner-slides.viewTraffic", "planner-slides.viewRoute"]).directive("plannerSlider", [
		function() {
			return {
				restrict: "C",
				template: '<div class="slide-edit-note" ng-controller="SlideEditNoteController" ng-if="service.slideName === \'editNote\'"></div><div class="slide-edit-hotel" ng-controller="SlideEditHotelController" ng-if="service.slideName === \'editHotel\'"></div><div class="slide-view-poi" ng-controller="SlideViewPOIController" ng-if="service.slideName === \'viewPOI\'"></div><div class="slide-view-hotel" ng-controller="SlideViewHotelController" ng-if="service.slideName === \'viewHotel\'"></div><div class="slide-view-traffic" ng-controller="SlideViewTrafficController" ng-if="service.slideName === \'viewTraffic\'"></div><div class="slide-view-route" ng-controller="SlideViewRouteController" ng-if="service.slideName === \'viewRoute\'"></div>'
			}
		}
	]).controller("PlannerSliderController", ["$scope", "plannerService",
		function(e, t) {
			e.service = t, e.$on("show-add-hotel", function(e, n) {
				n && (t.tmpSearchHotelKeyword = n), t.showPopup('<section class="add-hotel popup" id="add-hotel" ng-controller="AddHotelController"><ul class="header-tab"><li ng-class="{\'default\':\'active\'}[headTab]" ng-click=\'changeHotelType("default")\'>添加酒店</li><li ng-class="{\'airbnb\':\'active\'}[headTab]" ng-click=\'changeHotelType("airbnb")\'>添加Airbnb爱彼迎</li></ul><div class="head"><div class="thumbnail"><img src="{{hotel.image}}" alt="" ng-show="hotel.image"><img src="{{hotelImgCustomShow()}}" alt="" ng-show="hotelCustom"><div class="poicover" ng-show="hotelCustom&&imgStatusCustom == \'default\'" ng-click="addImageCustom()">&#xe699;</div><input type="hidden" id="hotel_cover" /><div class="poi_loading" ng-show=\'imgStatusCustom == "loading"\'>loading</div></div><div ng-show="headTab == \'default\'"><input type="text" placeholder="请输入酒店名称" ng-show="inputState" id="hotelInput"><h2 ng-click="changeHotel($event)" ng-hide="inputState">{{hotel.cn_name}}</h2><h2 ng-click="changeHotel($event)" ng-hide="inputState">{{hotel.en_name}}</h2></div><div ng-show="headTab == \'airbnb\'" class=\'airbnb\'><p ng-show="airbnbInputState == \'edit\'"><input type="text" placeholder="复制链接" id="airbnbInput"><span class="active" ng-hide="airbnbLoading" ng-click="submitAirbnbInput()">确定</span><span ng-hide="airbnbLoading" ng-click="resetAirbnbInput()" >取消</span><span ng-if="airbnbLoading">查找中...</span></p><p ng-if="airbnbInputState == \'edit\'" class="tip">请在输入框内复制Airbnb爱彼迎房源网址 <a href="http://www.airbnbchina.cn/?af=104561116&c=ADDINGACCOM" target="_blank" data-bn-ipg="Planv3-addhotel-copylink-airbnbclick">去官网复制</a></p><h3 ng-if="airbnbInputState == \'view\'" class="shortline"><a href="{{hotel.url}}" data-bn-ipg="Planv3-addhotel-title-airbnbclick" target="_blank">{{hotel.cn_name}}</a></h3><p ng-if="airbnbInputState == \'view\'" class="shortline"><a href="{{hotel.url}}" data-bn-ipg="Planv3-addhotel-title-airbnbclick" target="_blank">{{hotel.url}}</a></p><span ng-if="airbnbInputState == \'view\'" class="change active" ng-click="changeAirbnbInput()">更改</span></div></div><div class="form"><div class="row"><div class="label"><span>入住日期</span></div><div class="content"><select name="start-date" id="hotel-start-date-select"><option ng-repeat="day in days" value="{{$index}}" ng-selected="$index == currentDayIndex">{{getDayString($index, day)}}{{place.traffic_poiname?(" ("+place.traffic_poiname+")"):""}}</option></select></div></div><div class="row"><div class="label"><span>退房日期</span></div><div class="content"><select name="end-date" id="hotel-end-date-select"><option ng-repeat="day in days" value="{{$index}}" ng-selected="$index == getNextIndex()">{{getDayString($index, day)}}{{place.traffic_poiname?(" ("+place.traffic_poiname+")"):""}}</option></select></div></div><div class="row"><div class="label"><span>花费</span></div><div class="content"><input class="cost" type="text" name="cost" value="0" min="0" step="1" ng-model="price" ng-keyup="pricekeyup($event)"><select name="currency" id="hotel-currency-select" ng-model="currency" ng-init="currency = currencyList[0].unit_name"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}">{{currency.name}}</option></select><select name="room-count" id="hotel-room-count-select" ng-model="count" ng-init="count = 1"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div><div class="label extend"><h5>{{currency}} {{(price * count).toFixed(2)}}</h5></div></div><div class="row"><div class="label"><span>地理位置</span></div><div class="content"><a href="#" class="button mark" ng-click="showMap($event)" ng-if="!isShowMap" ng-class="{true:\'disabled\'}[hotel.hotel_id == null || hotel.hotel_id > 0]"><span>!</span>在地图上标记</a><a href="#" class="button mark" ng-click="hideMap($event)" ng-if="isShowMap" ng-class="{true:\'disabled\'}[hotel.hotel_id == null || hotel.hotel_id > 0]">收起地图</a></div><div class="label extend" ng-if="hotel.hotel_id <= 0 && lat && lng"><span class="lat-lng"><em class="icon map-pin4"></em>{{lat.toFixed(3)}},{{lng.toFixed(3)}}</span></div></div></div><div id="add-hotel-map" class="map-container" ng-show="hotel.hotel_id <= 0"></div><div class="textarea-wrapper qui-textArea" data-width="605" data-height="132"><textarea placeholder="添加备注的文字" class="ui2_textarea" ng-model="note.content"></textarea><div class="tips"><span class="current"></span>/<span class="max"></span>字    </div></div><div class="controls"><a class="button vm" ng-click="closeThisDialog()" href="#" data-bn-ipg="Planv3-popup-addhotel-cancel">取消</a><a class="button primary vm {{submiting&&\'submiting\'}}" href="#" ng-click="submit($event)" data-bn-ipg="Planv3-popup-addhotel-confirm">确定</a></div></section>', {
					closeTrackCode: "Planv3-popup-addhotel-close"
				})
			}), e.$on("show-add-poi", function(e, n) {
				n && (t.tmpSearchPoiKeyword = n), t.showPopup('<section class="add-poi popup" id="add-poi" ng-controller="AddPOIController"><h1>添加游玩</h1><div class="head"><div class="thumbnail"><img ng-src="{{poi.image}}/80" alt="" ng-show="poi.image"><img ng-src="{{imgCustomShow()}}" alt="" ng-show="poiCustom"><div class="poicover" ng-show="poiCustom&&imgStatusCustom == \'default\'" ng-click="addImageCustom()">&#xe699;</div><input type="hidden" id="poi_cover" /><div class="poi_loading" ng-show=\'imgStatusCustom == "loading"\'>loading</div></div><input type="text" placeholder="请输入目的地" ng-show="inputState"><h2 ng-click="changePOI($event)" ng-hide="inputState">{{poi.cn_name}}</h2><h2 ng-click="changePOI($event)" ng-hide="inputState">{{poi.en_name}}</h2></div><div class="form"><div class="row"><div class="label"><span>类型</span></div><div class="content"><select id="poi-type-select" name="type" ng-model="poi.cateid" ng-init="poi.cateid = 32"><option data-class="poi" value="32" selected>景点</option><option data-class="food" value="78">美食</option><option data-class="shopping" value="147">购物</option><option data-class="exp" value="148">体验</option><option data-class="traffic" value="77">交通</option></select></div></div><div class="row"><div class="label"><span>开始时间</span></div><div class="content"><select name="start-hour" id="poi-start-hour-select" ng-model="starthours"><option value="-1">时</option><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select name="start-minute" id="poi-start-minute-select" ng-model="startminutes"><option value="-1">分</option><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div><div class="label extend"><a href="#" ng-click="showEndTime($event)">添加结束时间</a></div><div class="label" style="display:none"><span>结束时间</span></div><div class="content" style="display:none"><select name="end-hour" id="poi-end-hour-select" ng-model="endhours"><option value="-1">时</option><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select name="end-minute" id="poi-end-minute-select" ng-model="endminutes"><option value="-1">分</option><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div></div><div class="row"><div class="label"><span>花费</span></div><div class="content"><input class="cost" type="text" name="cost" value="0" min="0" step="1" ng-model="spend" ng-init="spend = 0" ng-keyup="spendkeyup($event)" ><select name="currency" id="poi-currency-select" ng-model="currency" ng-init="currency = currencyList[0].unit_name"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}">{{currency.name}}</option></select><select name="ticket-count" id="poi-ticket-count-select" ng-model="counts" ng-init="counts = 1"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div></div><div class="row" ng-data="{{poi}}"><div class="label"><span>地理位置</span></div><div class="content"><a href="#" class="button mark" ng-click="showMap($event)" ng-if="!isShowMap" ng-class="{true:\'disabled\'}[poi.id == null || poi.id > 0]"><span>!</span>在地图上标记</a><a href="#" class="button mark" ng-click="hideMap($event)" ng-if="isShowMap" ng-class="{true:\'disabled\'}[poi.id == null || poi.id > 0]">收起地图</a></div><div class="label extend" ng-if="poi.id <= 0 && lat && lng"><span class="lat-lng"><em class="icon map-pin4"></em>{{lat.toFixed(3)}},{{lng.toFixed(3)}}</span></div></div></div><div id="add-poi-map" class="map-container" ng-show="poi.id <= 0"></div><div class="textarea-wrapper qui-textArea" data-width="605" data-height="132"><textarea placeholder="添加备注的文字" class="ui2_textarea" ng-model="content" ng-init="content = \'\'"></textarea><div class="tips"><span class="current"></span>/<span class="max"></span>字    </div></div><div class="controls"><a class="button vm" href="#" ng-click="closeThisDialog()" data-bn-ipg="Planv3-popup-addpoi-cancel">取消</a><a class="button primary vm {{submiting&&\'submiting\'}}" href="#" ng-click="submit($event)" data-bn-ipg="Planv3-popup-addpoi-confirm">确定</a></div></section>', {
					closeTrackCode: "Planv3-popup-addpoi-close"
				})
			}), e.$on("show-add-traffic", function(e) {
				t.showPopup('<section class="add-traffic popup" ng-controller="AddTrafficController"><h1>添加城际交通</h1><div class="form"><div class="traffic-item" ng-repeat="traffic in traffics"><div class="row"><div class="label"><span>交通方式</span></div><div class="content"><select id="traffic-type-select-{{$index}}" class="traffic-type-select" ng-model="traffic.tripmode" ng-init="traffic.tripmode = (traffic.tripmode || 1)"><option value="1">飞机</option><option value="2">火车</option><option value="3">巴士</option><option value="4">自驾</option><option value="5">轮船</option><option value="7">租车(提车/还车)</option><option value="6">其他</option></select></div>\x3c!-- <div class="label" ><span>{{traffic.tripmode=="1"?"航班号":"班次"}}</span></div> --\x3e<div class="label" ><span>班次</span></div><div class="content" ><input class="full flight-number" type="text" name="fligh-no" ng-model="traffic.traffic_number" data-index="{{$index}}"></div></div><div class="row"><div class="label" ng-if="traffic.tripmode==7"><span>提车地点</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; $index == 0"><span>出发站</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; $index &gt; 0"><span>中转站{{$index}}</span></div><div class="content">\x3c!-- <select class="start-city-select" id="start-city-select-{{$index}}"><option value="{{city.id}}" ng-repeat="city in cities">{{city.name}}</option></select> --\x3e<input type="text" class="half start-city-input" id="start-city-input-{{$index}}" placeholder="{{[\'出发城市\', \'出发城市\', \'出发城市\', \'出发城市\', \'出发城市\', \'出发城市\', \'出发城市\',\'提车城市\'][traffic.tripmode]}}" autocomplete="off" ng-model="traffic.fromplace" ><input type="text" class="half start-poi-input" id="start-poi-input-{{$index}}" placeholder="{{[\'\', \'出发机场\', \'出发车站\', \'出发车站\', \'出发地点\', \'出发港口\', \'出发车站\',\'提车地点\'][traffic.tripmode]}}" ng-model="traffic.frompoi" data-cityid="{{traffic.fromplaceid}}" ng-disabled="!traffic.fromplace"><div class="icon map-pin2" ng-if="traffic.frompositiontype == 2" ng-click="showMap($event, $index, \'from\')"></div></div><div class="label"><span>出发时间</span></div><div class="content"><select id="start-day-select-{{$index}}" class="start-day-select" ng-model="traffic.fromday" ng-init="traffic.fromday || (traffic.fromday = service.selectedDay.object.id)"><option value="{{day.id}}" ng-repeat="day in service.allDays" ng-selected="day.id == traffic.fromday">{{getDateString($index)}}</option></select><select id="start-hour-select-{{$index}}" class="start-hour-select" ng-model="traffic.starthours" ng-init="traffic.starthours = (traffic.starthours > -1 ? traffic.starthours : -1)"><option value="-1">时</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select id="start-minute-select-{{$index}}" class="start-minute-select" ng-model="traffic.startminutes" ng-init="traffic.startminutes = (traffic.startminutes > -1 ? traffic.startminutes : -1)"><option value="-1">分</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div></div><div class="row"><div class="label" ng-if="traffic.tripmode==7"><span>还车地点</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; $last"><span>到达站</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; !$last"><span>中转站{{$index+1}}</span></div><div class="content">\x3c!-- <select class="end-city-select" id="end-city-select-{{$index}}"><option value="{{city.id}}" ng-repeat="city in cities">{{city.name}}</option></select> --\x3e<input type="text" class="half end-city-input" id="end-city-input-{{$index}}" placeholder="{{[\'\', \'到达城市\', \'到达城市\', \'到达城市\', \'到达城市\', \'到达城市\', \'到达城市\',\'还车城市\'][traffic.tripmode]}}" autocomplete="off" ng-model="traffic.toplace"><input type="text" class="half end-poi-input" id="end-poi-input-{{$index}}" placeholder="{{[\'\', \'到达机场\', \'到达车站\', \'到达车站\', \'到达地点\', \'到达港口\', \'到达车站\',\'还车地点\'][traffic.tripmode]}}" ng-model="traffic.topoi" data-cityid="{{traffic.toplaceid}}" ng-disabled="!traffic.toplace"><div class="icon map-pin2" ng-if="traffic.topositiontype == 2" ng-click="showMap($event, $index, \'to\')"></div></div><div class="label"><span>到达时间</span></div><div class="content"><select id="end-day-select-{{$index}}" class="end-day-select" ng-model="traffic.today" ng-init="traffic.today || (traffic.today = service.selectedDay.object.id)"><option value="{{day.id}}" ng-repeat="day in service.allDays" ng-selected="day.id == traffic.today">{{getDateString($index)}}</option></select><select id="end-hour-select-{{$index}}" class="end-hour-select" ng-model="traffic.endhours" ng-init="traffic.endhours = (traffic.endhours > -1 ? traffic.endhours : -1)"><option value="-1">时</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select id="end-minute-select-{{$index}}" class="end-minute-select" ng-model="traffic.endminutes" ng-init="traffic.endminutes = (traffic.endminutes > -1 ? traffic.endminutes : -1)"><option value="-1">分</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div></div><div class="reference" ng-if="traffic.fromplace && traffic.toplace && traffic.recommendTraffics[0].distance"><span class="iconfont">&#58965;</span>        距离{{traffic.recommendTraffics[0].distance}}KM<span ng-if="traffic.recommendTraffics[0].percent > 0">，       {{traffic.recommendTraffics[0].percent}}%用户选择        {{[\'\', \'飞机\', \'火车\', \'大巴\', \'租车\', \'轮船\', \'其他\'][traffic.recommendTraffics[0].tripmode]}}        {{getTimeString(traffic.recommendTraffics[0].avg_time)}}        {{traffic.recommendTraffics[0].avg_spend?("，花费"+ traffic.recommendTraffics[0].avg_spend +"人民币"):""}}</span><ul><li ng-repeat="traffic in traffic.recommendTraffics" ng-if="traffic.percent"><p><span class="iconfont">{{[\'\', \'&#58883;\', \'&#58886;\', \'&#58881;\', \'&#58882;\', \'&#58880;\', \'&#58884;\'][traffic.tripmode]}}</span><span ng-if="traffic.percent > 0">{{traffic.percent}}%用户选择了</span><span>{{[\'\', \'飞机\', \'火车\', \'大巴\', \'租车\', \'轮船\', \'其他\'][traffic.tripmode]}} {{getTimeString(traffic.avg_time)}} {{traffic.avg_spend?("，花费"+ traffic.avg_spend +"人民币"):""}}</span></p></li></ul></div><div class="links"><a href="#" ng-if="$index &gt; 0" ng-click="removeTrafficItem($event, $index)">-删除该段</a><a href="#" ng-if="$last" ng-click="addTrafficItem($event)" data-bn-ipg="Planv3-popup-addtrans-addtransfer" data-help-index="5" data-help-direction="right" data-help-content="点击这里添加下一程交通">+增加中转</a></div></div><div id="add-traffic-map" class="map-container"></div><div class="row"><div class="label"><span>花费</span></div><div class="content"><input class="cost" type="text" name="cost" min="0" step="1"  ng-model="cost" ng-init="cost = (cost || 0)" ng-value="cost || 0" ng-keyup="costkeyup($event)"><select name="currency" id="traffic-currency-select" ng-model="currency"><option ng-repeat="item in currencyList" value="{{item.unit_name}}" ng-selected="item.unit_name == currency">{{item.name}}</option></select><select name="ticket-count" id="traffic-ticket-count-select" ng-model="count" ng-init="count = 1"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div><div class="label extend"><h5>{{currency}} {{(cost * count).toFixed(2)}}</h5></div></div></div><div class="textarea-wrapper qui-textArea" data-width="605" data-height="132"><textarea placeholder="添加备注的文字" class="ui2_textarea" ng-model="content"></textarea><div class="tips"><span class="current"></span>/<span class="max"></span>字    </div></div><div class="controls"><a class="button vm" ng-click="closeThisDialog()" href="#" data-bn-ipg="Planv3-popup-addtrans-cancel">取消</a><a class="button primary vm {{submiting&&\'submiting\'}}" href="#" ng-click="submit($event)" data-bn-ipg="Planv3-popup-addtrans-confirm">确定</a></div></section>', {
					closeTrackCode: "Planv3-popup-addtrans-close"
				})
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-slides.viewHotel", ["ngSanitize"]).directive("slideViewHotel", [
		function() {
			return {
				restrict: "C",
				template: '<div class="header" ng-class="{true:\'subtitle\'}[!!event.en_name]"><h2 ng-if="!editing"><a href="{{event.href}}" target="_blank" ng-click="startEditTitle($event)" ng-class="{true:\'custom\'}[isCustom]" data-bn-ipg="{{event.source != 3 ? \'Planv3-hotelinfo-title\' :\'Planv3-right-hotel-title-airbnbclick\'}}" >{{event.cn_name}}<em class="icon pencil" ng-if="isCustom"></em></a></h2><h2 ng-if="editing"><input type="text" value="{{event.cn_name}}" ng-keydown="stopEditTitle($event)" ng-blur="stopEditTitle($event)"></h2><h3 ng-if="event.en_name"><a href="{{event.href}}" target="_blank" data-bn-ipg="Planv3-hotelinfo-title">{{event.en_name}}</a></h3><a href="#" class="close" ng-click="service.hideSlide($event)" data-bn-ipg="Planv3-hotelinfo-close">关闭</a><a href="#" ng-click="showInMap($event)" class="control" ng-if="event.lat && event.lng && !hideMap" data-bn-ipg="Planv3-hotelinfo-map"><span class="icon map-pin3"></span></a></div><div class="body hotelInfoBody" id="hotelInfoBody"><div class="box" ng-if="!isCustom"><a class="image" href="{{event.href}}" target="_blank" data-bn-ipg="{{event.source != 3 ? \'Planv3-hotelinfo-pic\' :\'Planv3-right-hotel-pic-airbnbclick\'}}" ><em class="image__bg" style="background-image:url({{event.image}}),url({{event.image_default}});"></em>\x3c!-- <span>{{event.photo_count}}张照片</span> --\x3e</a><div class="hotelInfoBody-info"><p class="score" ng-if="event.source != 3">{{event.grade}}<span>分</span></p><p class="hotelInfoBody-info-star"><span class="icon" ng-repeat="star in [0,1,2,3,4]" ng-if="star<event.star"></span><span>{{[\'\',\'一星\',\'二星\',\'三星\',\'四星\',\'五星\'][event.star]}}</span>\x3c!-- <span>来自{{event.star1 + event.star2 + event.star3 + event.star4 + event.star5}}条点评</span> --\x3e</p><p><span ng-if="event.thread_num">{{event.thread_num}}篇游记中提到</span><span ng-if="event.plan_num">{{event.thread_num?"，":""}} {{event.plan_num}}个行程中选择</span></p><p ng-if="event.poilocal.length">附近景点：<span ng-repeat="poi in event.poilocal"><em  class="hotelInfoBody-info-localname">{{poi.chinesename}}</em>({{poi.distance>1000?( (poi.distance/1000).toFixed(1)+"公里" ):(poi.distance+"米")}})</span></p><p ng-if="event.reference_price"><span>参考价： <em class="hotelInfoBody-info-price">{{event.currency_code}} {{event.reference_price}}</em></span></p></div><div class="clear"></div></div><div class="tabs" ng-show="service.slideType==\'edit\'" ng-if="!isCustom"><a href="#" ng-class="{true:\'active\'}[mode==\'view\']" ng-click="changeViewMode(\'view\');" data-bn-ipg="Planv3-hotelinfo-infotab">住宿详情</a><a href="#" ng-class="{true:\'active\'}[mode==\'edit\']" ng-click="changeViewMode(\'edit\');" data-bn-ipg="Planv3-hotelinfo-notetab">备注信息</a></div><div class="box last hotelInfoBody-info-description" ng-show="mode==\'view\' &amp;&amp; !isCustom"><p class="hotelInfoBody-info-description-title"><em></em>简介</p><p>{{event.description}}</p>\x3c!-- airbnb --\x3e<p ng-if="event.source == 3"><strong>房屋类型：</strong>{{event.room_type_format}}<br><strong>卧室数量：</strong>{{event.room_num}}<br><strong>床数量：</strong>{{event.bed_num}}<br><strong>最多可住：</strong>{{event.person_num}}</p>\x3c!-- airbnb --\x3e</div><div class="box hollow last" ng-show="mode==\'edit\'"><div class="customimg" ng-if="isCustom"><img src="{{hotelImgCustomShow()}}"><div class="poi_cover" ng-click="addImageCustom()" ng-show="imgStatusCustom == \'default\'">&#xe699;</div><input type="hidden" id="poi_cover" /><div class="poi_loading" ng-show=\'imgStatusCustom == "loading"\'></div></div><div class="form"><div class="row"><div class="label"><span>花费</span></div><div class="content"><input class="cost" type="text" name="cost" ng-model="event.spend" ng-init="spend = 0" ng-keyup="pricekeyup($event)"><select name="currency" id="hotel-currency-select" ng-model="event.currency" ng-init="event.currency = currencyList[0].unit_name"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}">{{currency.name}}</option></select><select name="room-count" id="hotel-room-count-select" ng-model="event.counts" ng-init="event.counts = 1"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div><div class="label extend"><h5>{{event.currency}} {{(event.spend * event.counts).toFixed(2)}}</h5></div></div><div class="row" ng-if="isCustom"><div class="label"><span>地理位置</span></div><div class="content"><a href="#" class="button mark" ng-click="showMap($event)" ng-if="!isShowMap"><span>!</span>在地图上标记</a><a href="#" class="button mark" ng-click="hideMap($event)" ng-if="isShowMap">收起地图</a></div><div class="label extend" ng-if="isCustom && event.lat && event.lng"><span class="lat-lng"><em class="icon map-pin4"></em>{{event.lat.toFixed(3)}},{{event.lng.toFixed(3)}}</span></div></div></div><div id="view-hotel-map" class="map-container"></div><div class="textarea-wrapper textarea-box qui-textArea" ng-class="{hover:textarea.focus}" data-width="480"><textarea placeholder="添加备注的文字" class="ui2_textarea" ng-model="event.note.content" ng-init="event.note.content = \'\'" ng-focus="textarea.focusFun($event)" ng-blur="textarea.blurFun($event)" maxlength="3000" ng-class="{lostFocus:!textarea.btnShow}"></textarea><div class="textarea-info" ng-show="textarea.btnShow"><div class="tips textarea-count-length"><span class="current"></span>/<span class="max"></span>字                </div><div class="textarea-btnbox"><a href="#" class="button vm" ng-click="textarea.cancel($event)">取消</a><a href="#" class="button primary vm" ng-click="textarea.save($event)">保存</a></div></div></div>\x3c!--图片上传--\x3e<div class="uploadPic" ng-show="service.isLogin"><ul><li class="uploadPicLi" ng-repeat="image in images"><img class="uploadPicLi__pic" src="{{image.url || image.qnUrl}}/80x80" /><div class="uploadPicLi__view" data-index="{{$index}}" ng-click="showPic(image.url || image.qnUrl)"><i class="iconfont">&#58991;</i>点击查看</div><i class="uploadPicLi__delete iconfont" ng-click=\'delImage($index,$event)\'>&#58992;</i></li><li class="uploadPicLi" ng-if=\'imgStatus == "error"\'><div class="uploadPicLi__error"  ng-click="addImage()"><i class="iconfont">&#58990;</i>上传失败                    <br />重传</div></li><li class="uploadPicLi" ng-if=\'imgStatus == "loading"\'><i class="iconfont uploadPicLi__loading"></i></li><li class="uploadPicLi" ng-if=\'images.length < 5 && imgStatus == "default"\'><i class="iconfont uploadPicLi__add" ng-click="addImage()">&#58943;</i></li></ul><input type="hidden" id="uploadImg" /></div>\x3c!--/图片上传--\x3e</div></div>'
			}
		}
	]).controller("SlideViewHotelController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a() {
				if ("edit" === i.slideType && t.dirtyFlag) {
					t.event.spend = parseFloat(t.event.spend).toFixed(2);
					var a = {
						id: i.selectedEventId,
						pid: t.event.hotel_id,
						cn_name: t.event.cn_name,
						en_name: t.event.en_name,
						pic: t.event.image,
						inDay: t.event.checkinDay,
						outDay: t.event.checkoutDay,
						currency: t.event.currency,
						counts: t.event.counts,
						spend: t.event.spend,
						position_type: t.event.hotel_id > 0 ? 1 : 2,
						lat: t.event.hotel_id > 0 ? null : t.event.lat,
						lng: t.event.hotel_id > 0 ? null : t.event.lng,
						useraddress: t.event.hotel_id > 0 ? null : t.event.useraddress
					};
					n.setHotelEventDetails({
						data: {
							plan_id: n.getPlanId(),
							cover: t.hotelImgCustom,
							oneday_id: i.selectedDay.object.id,
							hotel: a,
							event_id: i.selectedEventId,
							note: {
								content: t.event.note.content,
								images: t.images || []
							}
						},
						onSuccess: function(n) {
							t.content_bak = t.event.note.content, t.dirtyFlag = !1, i.changeSelectedDayEvent(e.extend(a, {
								type: 2,
								ticketcount: a.counts,
								textsids: !!t.event.note.content
							})), i.showTip("保存成功", "ok")
						},
						onError: function(e) {
							i.showTip(e.data.msg, "error")
						}
					})
				}
			}
			var o;
			if (t.imgStatusCustom = "default", t.customkey = "", t.dirtyFlag = !1, t.hotel = {}, t.editing = !1, t.hideMap = i.slideHideMap, i.slideHideMap = null, t.service = i, t.imgStatus = "default", t.images = [], t.getPoiDefaultPic = i.getPoiDefaultPic, t.mode = i.selectedPoiId > 0 ? i.initMode || "view" : i.slideType, t.event = {}, t.isShowMap = !1, t.isCustom = i.selectedPoiId <= 0, t.changeViewMode = function(e) {
				t.mode = e
			}, t.startEditTitle = function(n) {
				t.isCustom && (t.editing = !0, setTimeout(function() {
					e(".slide-view-hotel .header input").focus().select()
				}, 0), n.preventDefault())
			}, t.stopEditTitle = function(e) {
				var n = !1;
				if ("number" == typeof e.keyCode) switch (e.keyCode) {
					case 27:
						t.editing = !1;
						break;
					case 13:
						t.editing = !1, n = !0
				} else n = !0, t.editing = !1;
				n && e.target.value != t.event.cn_name && (t.dirtyFlag = !0, t.event.cn_name = e.target.value)
			}, "edit" === i.slideType && (t.currencyList = n.getCurrencyList(), n.getHotelEventDetails({
				data: {
					plan_id: n.getPlanId(),
					oneday_id: i.selectedDay.object.id,
					event_id: i.selectedEventId
				},
				onSuccess: function(n) {
					0 == t.event.note && (t.event.note = {}), 0 == t.event.note.images && (t.event.note.images = {}), t.$apply(function() {
						t.hotelImgCustom = n.data.image, 3 != n.data.source && (n.data.image = n.data.image && n.data.image + "/300x200", n.data.image_default = t.getPoiDefaultPic({
							type: 2
						}, "400x300")), e.extend(t.event, n.data), t.event.cn_name = i.decodeHTML(t.event.cn_name), t.content_bak = t.event.note.content = i.decodeHTML(t.event.note.content), t.images = t.event.note.images
					}), requirejs(["web_qui_quiselect", "web_old_textarea"], function(t) {
						new t({
							target: "#hotel-currency-select",
							exClassName: "currency",
							template: '<li class="qui-select-item{{if data.selected}} qui-select-item-active{{/if}}" data-value="{{data.value}}" data-text="{{data.text}}" title="{{data.text}}">{{data.text}}</li>'
						}), new t({
							target: "#hotel-room-count-select",
							exClassName: "room-count"
						});
						e(".slide-view-hotel .textarea-wrapper").qyerTextArea({
							max: 3e3
						})
					})
				},
				onError: function(e) {
					i.showTip(e.data.msg, "error")
				}
			}), e(".slide-view-hotel").on("change.dirty", "select, input, textarea", function() {
				t.dirtyFlag = !0
			})), t.addImageCustom = function() {
				e("#poi_cover").trigger("click")
			}, t.isCustom) {
				var r = function() {
						t.$apply(function() {
							t.imgStatusCustom = "loading"
						})
					},
					s = function(e) {
						var n = new Image;
						n.src = e.origin_url + "/300x200", n.onload = function() {
							t.$apply(function() {
								t.hotelImgCustom = e.origin_url, t.imgStatusCustom = "default", t.dirtyFlag = 1
							})
						}
					},
					l = function() {
						t.$apply(function() {
							t.imgStatusCustom = "error"
						})
					};
				i.uploadPlanPic({
					browse_button: "poi_cover",
					container: "hotelInfoBody",
					paths: ["plan", "custom", "hotel", "cover"],
					BeforeUpload: r,
					FileUploaded: s,
					UploadError: l
				})
			}
			t.showInMap = function(e) {
				i.hideSlide(), i.selectedHotel = t.event, i.broadcast("show-map-hotel"), e.preventDefault()
			}, t.showMap = function(n) {
				t.isShowMap = !0, e("#view-hotel-map").show(), o || i.createSelectMarker("view-hotel-map", function(n) {
					o = n, o.reset(t.event.lat, t.event.lng, t.event.useraddress), t.event.lat && t.event.lng && e("#view-hotel-map .mark-button").removeClass("primary").text("取消标记"), i.resizePopup()
				}, function() {
					var e = o.getData();
					t.dirtyFlag = !0, t.$apply(function() {
						t.event.lat = e.lat, t.event.lng = e.lng, t.event.useraddress = e.address
					})
				}), i.resizePopup(), n.preventDefault()
			}, t.hideMap = function(n) {
				t.isShowMap = !1, e("#view-hotel-map").hide(), n.preventDefault()
			}, t.$on("slide-closed:viewHotel", a), t.$on("$destroy", function() {
				e(window).off("resize.viewHotel")
			}), t.pricekeyup = function(n) {
				var i = e(n.target);
				if (i.val()) {
					var a = i.val().replace(/([0-9]+\.[0-9]{2})[0-9]*/, "$1");
					a = a.replace(/[\u4e00-\u9fa5]/gi, ""), t.event.spend = a
				}
			}, i.textareaTurn({
				scope: t,
				type: "poi",
				save: a
			}), t.hotelImgCustomShow = function() {
				return t.hotelImgCustom ? t.hotelImgCustom + "/300x200" : "//common3.qyerstatic.com/plan/desktop/edit3/img/hotelcustom.png"
			}, t.addImage = function() {
				e("#uploadImg").trigger("click")
			}, t.delImage = function(e, n) {
				requirejs(["web_old_slidconfirm"], function(i) {
					i.confirm({
						text: "确认删除图片",
						target: n.target,
						onOK: function() {
							t.$apply(function() {
								t.images.splice(e, 1), t.dirtyFlag = 1
							})
						}
					})
				}), n.preventDefault()
			};
			var c = function() {
					t.$apply(function() {
						t.imgStatus = "loading"
					})
				},
				d = function(e) {
					var n = new Image;
					n.src = e.origin_url + "/80x80", n.onload = function() {
						t.$apply(function() {
							var n = {};
							n.url = e.origin_url, t.images.push(n), t.imgStatus = "default", t.dirtyFlag = 1
						})
					}
				},
				u = function() {
					t.$apply(function() {
						t.imgStatus = "error"
					})
				};
			i.uploadPlanPic({
				browse_button: "uploadImg",
				container: "wrapper",
				paths: ["plan", "hotel", "note"],
				BeforeUpload: c,
				FileUploaded: d,
				UploadError: u
			}), t.showPic = function(e) {
				t.service.popData = e, t.service.popShow("showPic")
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-slides.viewPOI", ["ngSanitize"]).directive("slideViewPoi", [
		function() {
			return {
				restrict: "C",
				template: '<div class="header" ng-if="(mode==\'edit\' && !dataLoaded) || (mode==\'view\' && !detailsLoaded)"><h2>正在加载中...</h2></div><div class="header" ng-class="{true:\'subtitle\'}[!!poi.en_name]" ng-show="(mode==\'edit\' && dataLoaded) || (mode==\'view\' && detailsLoaded)"><h2 ng-if="!editing"><a href="http://{{isLastminute ? poi.url : (poi.status ? poi.poi_url : \'#\')}}" target="{{isLastminute ? \'_blank\' : (poi.status ? \'_blank\':\'_self\')}}" ng-class="{true: \'custom\'}[isCustom]" ng-click="startEditTitle($event)" data-bn-ipg="{{isLastminute ? \'Planv3-lmpoi-detail-title\' : \'Planv3-poiinfo-title\'}}">{{isLastminute ? poi.title : poi.cn_name}}<em ng-if="isCustom" class="icon pencil"></em></a></h2><h2 ng-if="editing"><input type="text" value="{{poi.cn_name}}" ng-keydown="stopEditTitle($event)" ng-blur="stopEditTitle($event)"></h2><h3 ng-if="poi.en_name"><a href="http://{{poi.status ? poi.poi_url : \'#\'}}" target="{{poi.status ? \'_blank\':\'_self\'}}"  data-bn-ipg="{{isLastminute ? \'Planv3-lmpoi-detail-title\' : \'Planv3-poiinfo-title\'}}">{{poi.en_name}}</a></h3><a href="#" class="close" data-bn-ipg="Planv3-poiinfo-close" ng-click="service.hideSlide($event)">关闭</a><a href="#" ng-click="showInMap($event)" class="control" ng-if="poi.lat && poi.lng && isShowPin"><span class="iconfont">&#58917;</span></a><a href="#" ng-click="addToPlan($event)" class="control" ng-if="service.slideType!=\'edit\'"><span class="icon plus"></span></a></div><div class="body poiInfoBody" id="poiInfoBody"><div class="box" ng-if="!isCustom" ng-show="detailsLoaded"><a class="image" href="http://{{isLastminute ? poi.url : (poi.status ? poi.poi_url : \'#\')}}" target="{{isLastminute ? \'_blank\' : (poi.status ? \'_blank\':\'_self\')}}" data-bn-ipg="{{isLastminute ? \'Planv3-lmpoi-detail-img\' : \'Planv3-poiinfo-pic\'}}"><em class="image__bg" style="background-image:url({{poi.pic}}),url({{poi.image_default}});"></em><span ng-if="!isLastminute">{{poi.photo_count}}张照片</span></a><div class="poiInfoBody-info"><p class="score poiInfoBody-info-grade" ng-if="!isLastminute">{{poi.grade * 2}}<span>分</span><em class="poiInfoBody-info-icon poiInfoBody-info-hoticon"><span class="poiInfoBody-info-starlist"><span class="poiInfoBody-info-starlist-title">分数详情</span><span class="poiInfoBody-info-starlist-item"><span>五星</span><span class="poiInfoBody-info-starlist-progress"><span style="width:{{poi.star5}}%;"></span></span><span>{{poi.star5}}%</span></span><span class="poiInfoBody-info-starlist-item"><span>四星</span><span class="poiInfoBody-info-starlist-progress"><span style="width:{{poi.star4}}%;"></span></span><span>{{poi.star4}}%</span></span><span class="poiInfoBody-info-starlist-item"><span>三星</span><span class="poiInfoBody-info-starlist-progress"><span style="width:{{poi.star3}}%;"></span></span><span>{{poi.star3}}%</span></span><span class="poiInfoBody-info-starlist-item"><span>二星</span><span class="poiInfoBody-info-starlist-progress"><span style="width:{{poi.star2}}%;"></span></span><span>{{poi.star2}}%</span></span><span class="poiInfoBody-info-starlist-item"><span>一星</span><span class="poiInfoBody-info-starlist-progress"><span style="width:{{poi.star1}}%;"></span></span><span>{{poi.star1}}%</span></span></span></em></p><p class="comment" ng-if="!isLastminute"><span class="icon" ng-repeat="star in [1,2,3,4,5]" ng-class="{\'true\':\'empty-star\',\'false\':\'star\'}[poi.grade < ($index + 1)]"></span><span class="count" ng-if="poi.comment_count" ng-click="scrollToComments()" data-bn-ipg="Planv3-poiinfo-comment">来自{{poi.comment_count}}条点评</span></p><p ng-if="!isLastminute && poi.overall_rank"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-rank"></em><span>{{poi.city_name}}全部{{poi.cate_name}}中排 </span><span class="overall-rank"> 第{{poi.overall_rank}}名</span></p><p ng-if="!isLastminute && poi.percentage"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-percentage"></em><span>游玩该城市的穷游er有{{poi.percentage}}%的人安排</span></p><p ng-if="!isLastminute"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-time"></em><span>建议游玩时间：{{poi.play_time}}</span></p><div class="price" ng-if="isLastminute"><em>{{poi.price}}</em><span>元起</span><i>{{poi.list_price}}元</i></div><div class="solds" ng-if="isLastminute"><span ng-if="poi.views > 0"><em>{{poi.views}}</em>次浏览</span><span ng-if="poi.sale_count > 0"><em>{{poi.sale_count}}</em>名穷游er购买</span></div><div class="time" ng-if="isLastminute"><span><em class="icon alarm"></em>{{poi.end_date}}</span><span>请提前{{poi.reservation_day * 1 + 1}}天预订</span></div><div class="order" ng-if="isLastminute"><a href="{{poi.url}}" data-bn-ipg="Planv3-lmpoi-detail-booking" target="_blank" class="alternate button">查看更多</a></div></div><a class="poiInfoBody-edit" href="{{poi.poi_url}}edit/" target="_blank"><i class="iconfont">&#58978;</i>纠错</a><div class="clear"></div></div><div class="tabs" ng-show="service.slideType==\'edit\' && detailsLoaded" ng-if="!isCustom"><a href="#" ng-class="{true:\'active\'}[mode==\'view\']" ng-click="changeViewMode(\'view\')">景点详情</a><a href="#" ng-class="{true:\'active\'}[mode==\'edit\']" ng-click="changeViewMode(\'edit\')" >备注信息</a></div><div class="box lastminute" ng-repeat="lm in poi.lm" ng-if="mode==\'view\' && !isCustom && $index < 3"><div class="badge"></div><div class="content"><a href="{{lm.url}}" target="_blank" data-bn-ipg="Planv3-poiinfo-lastminute-pic"><img src="{{lm.pic}}/300x200" alt="{{poi.title}}"></a><h2><a href="{{lm.url}}" target="_blank" data-bn-ipg="Planv3-poiinfo-lastminute-title">{{lm.title}}</a></h2><p><em><i>{{lm.buy_price}}</i>元起</em><i>{{lm.list_price}}元</i><span class="sep"></span><span>{{lm.views}}次浏览</span><span ng-if="lm.sort_sold_num > 0">{{lm.sort_sold_num}}件已售</span></p><p style="line-height:24px;"><em class="icon alarm"></em>{{lm.end_time}}结束</p></div><a href="#" ng-click="addLmToPlan($event, lm)" data-bn-ipg="Planv3-poiinfo-lastminute-add" class="add button"><em class="iconfont" style="font-size:1.2em;">&#58943;</em>加入行程</a><a href="{{lm.url}}" data-bn-ipg="Planv3-poiinfo-lastminute-more" class="more button" target="_blank"><em class="iconfont" style="font-size:1.2em;">&#xe640;</em>查看详情</a></div><div class="box poiInfoBody-info-area" ng-if="mode==\'view\' && !isCustom && !isLastminute && poi.introduction" ng-show="detailsLoaded"><p class="poiInfoBody-info-area-title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-introduction"></em><span>简介</span></p><p ng-bind-html="poi._briefIntroduction"></p><p class="poiInfoBody-info-expend" ng-show="poi._briefIntroduction!=poi.introduction"><span ng-click="poi._briefIntroduction=poi.introduction" data-bn-ipg="Planv3-poiinfo-moreinfo">展开全部介绍<em class="icon"></em></span></p></div><div class="box poiInfoBody-info-area" ng-if="mode==\'view\' && !isCustom && !isLastminute " ng-show="detailsLoaded && (poi.address || poi.wayto || poi.opentime || poi.price || poi.phone || poi.site)"><ul class="poiInfoBody-info-items"><li class="clearfix" ng-if="poi.address"><div class="title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-address"></em><span>地址</span></div><div class="text"><span>{{poi.address}}</span></div></li><li class="clearfix" ng-if="poi.wayto"><div class="title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-wayto"></em><span>路线</span></div><div class="text"><span ng-bind-html="poi.wayto"></span></div></li><li class="clearfix" ng-if="poi.opentime"><div class="title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-opentime"></em><span>时间</span></div><div class="text"><span>{{poi.opentime}}</span></div></li><li class="clearfix" ng-if="poi.price"><div class="title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-price"></em><span>门票</span></div><div class="text"><span>{{poi.price}}</span></div></li><li class="clearfix" ng-if="poi.phone"><div class="title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-phone"></em><span>电话</span></div><div class="text"><span>{{poi.phone}}</span></div></li><li class="clearfix" ng-if="poi.site"><div class="title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-site"></em><span>网址</span></div><div class="text"><span><a href="{{poi.site.indexOf(\'http\') > -1 ? poi.site : (\'http://\' + poi.site)}}" target="_blank">{{poi.site}}</a></span></div></li></ul></div><div class="box poiInfoBody-info-area" ng-if="mode==\'view\' && !isCustom && !isLastminute && poi.tips" ng-show="detailsLoaded"><p class="poiInfoBody-info-area-title"><em class="poiInfoBody-info-icon poiInfoBody-info-icon-tips"></em><span>小贴士</span></p><p><pre class="preText">{{poi.tips}}</pre></p></div><div id="js_poiInfoBody_comments" class="box last poiInfoBody-info-area" ng-if="mode==\'view\' && !isCustom && !isLastminute" ng-show="detailsLoaded && commentLoaded"><p class="poiInfoBody-info-area-title"><a href="#" ng-click="addComment()" class="button primary vm poiInfoBody-info-btn" ng-if="!already_comment">写点评</a><em class="poiInfoBody-info-icon poiInfoBody-info-icon-total_comments"></em><span>点评({{total_comments}})</span></p><div ng-if="total_comments"><ul class="qui-piczoomer"><li class="poiInfoBody-comment clearfix" ng-repeat="comment in comments"><img class="poiInfoBody-comment-user" src="{{comment.user_avatar}}" alt=""><p class="poiInfoBody-comment-content-head clearfix"><span class="fl">{{comment.user_name}}说</span><div class="fr"><span class="icon" ng-repeat="star in [1,2,3,4,5]" ng-class="{\'true\':\'empty-star\',\'false\':\'star\'}[comment.score/2 < ($index + 1)]"></span><span>{{comment.date}}</span></div></p><p class="poiInfoBody-comment-content-text">{{comment.content}}</p><div class="comment-album" ng-if="comment.album"><p><a href="{{image.link}}" target="_blank" ng-repeat="image in comment.album" ng-if="comment.showAll || $index<5"><img data-datalarge="{{image.photo}}" src="{{image.thumb}}" /></a></p><a href="#" ng-click="comment.showAll = true" class="show-more-pic" ng-if="comment.album.length>5 && !comment.showAll">查看全部</a></div><p class="poiInfoBody-comment-content-btn" ng-if="comment.is_owner"><a href="#" ng-click="editComment(comment)">编辑</a><a href="#" ng-click="delComment($event,comment)">删除</a></p></li></ul><a href="#" class="poiInfoBody-comment-loadmore" ng-if="total_comments == null || total_comments / 10 &gt; current_page " ng-click="loadComments($event)" data-bn-ipg="Planv3-poiinfo-morecomment">更多</a></div><div ng-if="!total_comments" class="poiInfoBody-comment-zero">            暂时还没有穷游er点评过这里        </div></div><div class="box lm-box" ng-if="isLastminute && mode == \'view\'"><h4>基础信息</h4><ul><li class="clearfix"><div class="title"><span>目的地</span></div><div class="text"><span>{{poi.end_pos}}</span></div></li><li class="clearfix" ng-if=\'travelTime\'><div class="title"><span>旅行时间</span></div><div class="text"><span>{{poi.travel_starttime | date: \'yyyy年MM月dd日\'}}至{{poi.travel_endtime | date: \'yyyy年MM月dd日\'}}</span></div></li><li class="clearfix" ng-if="poi.highlight"><div class="title"><span>折扣亮点</span></div><div class="text"><span ng-bind-html="poi.highlight"></span></div></li><li class="clearfix" ng-if="poi.spot_intro"><div class="title"><span>景点介绍</span></div><div class="text"><span ng-bind-html="poi.spot_intro"></span></div></li></ul></div><div class="box lm-box clearfix" ng-if="isLastminute && mode == \'view\' && poi.info_product_introduce != \'\'"><h4>产品介绍</h4><ul><li ng-repeat="introduce in poi.info_product_introduce"><div class="title"><span>{{introduce.name}}</span></div><div class="text"><span ng-bind-html="introduce.content"></span></div></li></ul></div><div class="box lm-box" ng-if="isLastminute && mode == \'view\' && (poi.info_cost.include != \'\' || poi.info_cost.exclude != \'\' || poi.info_cost.present != \'\') "><h4>费用说明</h4><ul><li class="clearfix" ng-if="poi.info_cost.include"><div class="title"><span>费用包含</span></div><div class="text"><span ng-bind-html="poi.info_cost.include"></span></div></li><li class="clearfix" ng-if="poi.info_cost.exclude"><div class="title"><span>费用不含</span></div><div class="text"><span ng-bind-html="poi.info_cost.exclude"></span></div></li><li class="clearfix" ng-if="poi.info_cost.present"><div class="title"><span>赠送项目</span></div><div class="text"><span ng-bind-html="poi.info_cost.present"></span></div></li></ul></div><div class="box lm-box last" ng-if="isLastminute && mode == \'view\' && poi.info_use_explan != \'\' "><h4>预定须知</h4><ul><li ng-repeat="explan in poi.info_use_explan"><div class="title"><span>{{explan.name}}</span></div><div class="text"><span ng-bind-html="explan.content"></span></div></li></ul><a href="{{poi.url}}" class="button more" data-bn-ipg="Planv3-lmpoi-detail-info" target="_blank"><em class="iconfont" style="font-size:1.2em;">&#xe640;</em>查看详情</a></div><div class="box hollow last" ng-if="service.slideType==\'edit\'" ng-show="mode==\'edit\' && dataLoaded"><div class="customimg" ng-if="isCustom"><img ng-src="{{imgCustomShow()}}"><div class="poi_cover" ng-click="addImageCustom()" ng-show="imgStatusCustom == \'default\'">&#xe699;</div><input type="hidden" id="poi_cover" /><div class="poi_loading" ng-show=\'imgStatusCustom == "loading"\'></div></div><div class="form"><div class="row"><div class="label"><span>类型</span></div><div class="content"><select id="poi-type-select" ng-disabled="!isCustom" name="type" ng-model="event.catetypeid" ng-init="event.catetypeid = 32"><option data-class="poi" value="32">景点</option><option data-class="food" value="78">美食</option><option data-class="shopping" value="147">购物</option><option data-class="exp" value="148">体验</option><option data-class="traffic" value="77">交通</option><option data-class="excellent" value="1000" ng-if="isLastminute">优选</option></select></div></div><div class="row"><div class="label"><span>开始时间</span></div><div class="content"><select name="start-hour" id="poi-start-hour-select" ng-model="event.starthours"><option value="-1">时</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select name="start-minute" id="poi-start-minute-select" ng-model="event.startminutes"><option value="-1">分</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div><div id="add-end-time" class="label extend" style="width: 110px;"><a href="#" ng-click="showEndTime($event)">添加结束时间</a></div></div><div class="row" style="display:none"><div class="label"><span>结束时间</span></div><div class="content"><select name="end-hour" id="poi-end-hour-select" ng-model="event.endhours"><option value="-1">时</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select name="end-minute" id="poi-end-minute-select" ng-model="event.endminutes"><option value="-1">分</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div></div><div class="row"><div class="label"><span>花费</span></div><div class="content"><input class="cost" type="text" name="cost" value="0" ng-model="event.spend" min="0" ng-init="event.spend = 0" ng-keyup="spendkeyup($event)"><select name="currency" id="poi-currency-select" ng-model="event.currency" ng-init="event.currency = currencyList[0].unit_name"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}">{{currency.name}}</option></select><select name="ticket-count" id="poi-ticket-count-select" ng-model="event.counts" ng-init="event.counts = 0"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div></div><div class="row" ng-if="isCustom || isLastminute" ng-test="{{poi}}"><div class="label"><span>地理位置</span></div><div class="content"><a href="#" class="button mark" ng-click="showMap($event)" ng-if="!isShowMap" data-bn-ipg="Planv3-poiinfo-edit-markmap"><span>!</span>在地图上标记</a><a href="#" class="button mark" ng-click="hideMap($event)" ng-if="isShowMap">收起地图</a></div><div class="label extend" ng-if="(isCustom || isLastminute) && event.lat && event.lng" style="width: 160px"><span class="lat-lng"><em class="icon map-pin4"></em>{{event.lat.toFixed(3)}},{{event.lng.toFixed(3)}}</span></div></div></div><div id="view-poi-map" class="map-container"></div><div class="textarea-wrapper textarea-box qui-textArea" ng-class="{hover:textarea.focus}" data-width="480"><textarea placeholder="添加备注的文字" class="ui2_textarea" ng-model="event.note.content" ng-init="event.note.content = \'\'" ng-focus="textarea.focusFun($event)" ng-blur="textarea.blurFun($event)" maxlength="3000" ng-class="{lostFocus:!textarea.btnShow}"></textarea><div class="textarea-info" ng-show="textarea.btnShow"><div class="tips textarea-count-length"><span class="current"></span>/<span class="max"></span>字                </div><div class="textarea-btnbox"><a href="#" class="button vm" ng-click="textarea.cancel($event)">取消</a><a href="#" class="button primary vm" ng-click="textarea.save($event)">保存</a></div></div></div>\x3c!--图片上传--\x3e<div class="uploadPic" ng-show="service.isLogin"><ul><li class="uploadPicLi" ng-repeat="image in images"><img class="uploadPicLi__pic" src="{{image.url}}/80x80" /><div class="uploadPicLi__view" data-index="{{$index}}" ng-click="showPic(image.url)"><i class="iconfont">&#58991;</i>点击查看</div><i class="uploadPicLi__delete iconfont" ng-click=\'delImage($index,$event)\'>&#58992;</i></li><li class="uploadPicLi" ng-if=\'imgStatus == "error"\'><div class="uploadPicLi__error"  ng-click="addImage()"><i class="iconfont">&#58990;</i>上传失败                    <br />重传</div></li><li class="uploadPicLi" ng-if=\'imgStatus == "loading"\'><i class="iconfont uploadPicLi__loading"></i></li><li class="uploadPicLi" ng-if=\'images.length < 5 && imgStatus == "default"\'><i class="iconfont uploadPicLi__add" ng-click="addImage()">&#58943;</i></li></ul><input type="hidden" id="uploadImg" /></div>\x3c!--/图片上传--\x3e</div></div>'
			}
		}
	]).controller("SlideViewPOIController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a() {
				if ("edit" === i.slideType && t.dirtyFlag) {
					var e = {
						id: t.isCustom ? 0 : t.poi.id,
						pid: t.isCustom ? 0 : t.poi.id,
						cn_name: t.poi.cn_name || t.poi.title,
						en_name: t.poi.en_name,
						address: "",
						catetypeid: parseInt(t.event.cateid || t.event.catetypeid),
						starthours: t.event.starthours,
						startminutes: t.event.startminutes,
						endhours: t.event.endhours,
						endminutes: t.event.endminutes,
						spend: t.event.spend,
						currency: t.event.currency,
						counts: parseInt(t.event.counts),
						positiontype: t.poi.pid > 0 ? 1 : 2,
						useraddress: t.event.useraddress,
						lat: !t.isLastminute && t.poi.pid > 0 ? null : t.event.lat,
						lng: !t.isLastminute && t.poi.pid > 0 ? null : t.event.lng
					};
					n.setPoiEventDetails({
						data: {
							plan_id: n.getPlanId(),
							cover: t.imgCustom,
							oneday_id: i.selectedDay.object.id,
							poi: e,
							event_id: i.selectedEventId,
							note: {
								content: t.event.note.content,
								images: t.images || []
							}
						},
						onSuccess: function(e) {
							t.content_bak = t.event.note.content, t.dirtyFlag = !1, i.setSelectedDay(), i.showTip("保存成功", "ok")
						},
						onError: function(e) {
							i.showTip(e.data.msg, "error")
						}
					})
				}
			}
			var o;
			t.imgStatusCustom = "default", t.customkey = "", t.dirtyFlag = !1, t.poi = {}, t.total_comments = null, t.comments = [], t.current_page = 1, t.editing = !1, t.isShowPin = !i.slideHideMap, i.slideHideMap = null, t.imgStatus = "default", t.images = [], t.getPoiDefaultPic = i.getPoiDefaultPic, t.mode = i.selectedPoiId > 0 ? i.initMode || "view" : "edit", i.initMode = null, t.event = {}, t.isCustom = i.selectedPoiId <= 0, t.doTrackCode = qyerUtil.doTrackCode, t.isLastminute = i.selectedLastminute, t.startEditTitle = function(n) {
				t.isCustom && (t.editing = !0, setTimeout(function() {
					e(".slide-view-poi .header input").focus().select()
				}, 0), n.preventDefault())
			}, t.stopEditTitle = function(e) {
				var n = !1;
				if ("number" == typeof e.keyCode) switch (e.keyCode) {
					case 27:
						t.editing = !1;
						break;
					case 13:
						t.editing = !1, n = !0
				} else n = !0, t.editing = !1;
				n && e.target.value != t.poi.cn_name && (t.dirtyFlag = !0, t.poi.cn_name = e.target.value)
			}, t.changeViewMode = function(e) {
				t.mode = e
			}, t.loadComments = function(e) {
				e && e.preventDefault(), n.getPoiComments({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						city_id: 20,
						poi_id: i.selectedPoiId,
						page: t.current_page
					},
					onSuccess: function(e) {
						t.$apply(function() {
							t.total_comments = e.data.total, t.comments = t.comments.concat(e.data.comments), t.current_page++, t.commentLoaded = !0, t.already_comment = e.data.already_comment
						})
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}, t.addToPlan = function(e) {
				var a = 0;
				i.place_list.forEach(function(e) {
					1 == e.type && a++
				}), a < 40 ? n.addPOI({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						poi: {
							pid: t.poi.id,
							cn_name: t.isLastminute ? t.poi.title : t.poi.cn_name,
							en_name: t.poi.en_name,
							address: "",
							starthours: -1,
							startminutes: -1,
							endhours: -1,
							endminutes: -1,
							spend: 0,
							currency: "CNY",
							counts: 1,
							positiontype: 1,
							useraddress: null,
							lat: t.poi.lat,
							lng: t.poi.lng,
							catetypeid: t.isLastminute ? 1e3 : parseInt(t.poi.cateid || t.poi.catetypeid, 10)
						},
						note: {
							content: "",
							images: t.images || []
						}
					},
					onSuccess: function(e) {
						i.showTip("添加成功！", "ok"), e.data.city && i.broadcast("auto-add-city", e.data.city), i.setSelectedDay(), i.broadcast("update-cart-icon")
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				}) : i.showTip("最多添加40个景点", "error"), e.preventDefault()
			}, t.addLmToPlan = function(e, a) {
				if (e.preventDefault(), _.reduce(i.place_list, function(e, t) {
					return 1 == t.type ? e + 1 : e
				}, 0) >= 40) return void i.showTip("最多添加40个景点", "error");
				n.addPOI({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: i.selectedDay.object.id,
						poi: {
							pid: a.id,
							cn_name: a.cn_name || a.title,
							en_name: a.en_name,
							address: "",
							starthours: -1,
							startminutes: -1,
							endhours: -1,
							endminutes: -1,
							spend: 0,
							currency: "CNY",
							counts: 1,
							positiontype: 1,
							useraddress: null,
							lat: a.lat,
							lng: a.lng,
							catetypeid: 1e3
						},
						note: {
							content: "",
							images: t.images || []
						}
					},
					onSuccess: function(e) {
						i.scrBottom = !0, i.showTip("添加成功！", "ok"), e.data.city && (e.data.city.name = i.decodeHTML(e.data.city.name), i.broadcast("auto-add-city", e.data.city)), i.setSelectedDay(), i.broadcast("update-cart-icon")
					},
					onError: function(e) {
						i.showTip(e.data.msg, "error")
					}
				})
			}, t.showInMap = function(e) {
				i.hideSlide(), i.selectedPoi = t.poi, i.broadcast("show-map-poi")
			}, t.isCustom || (n[t.isLastminute ? "getLmDetails" : "getPoiDetails"]({
				data: {
					plan_id: n.getPlanId(),
					oneday_id: i.selectedDay.object.id,
					city_id: 20,
					poi_id: t.isLastminute ? null : i.selectedPoiId,
					lmid: t.isLastminute ? i.selectedPoiId : null
				},
				onSuccess: function(e) {
					t.$apply(function() {
						t.detailsLoaded = !0, t.poi = e.data, t.poi.pic_comment = t.poi.pic, t.poi.pic = t.poi.pic + "/300_200", t.poi.image_default = t.getPoiDefaultPic({
							type: 1,
							catetypeid: e.data.catetypeid
						}, "400x300"), 0 != t.poi.travel_starttime && 0 != t.poi.travel_endtime ? t.travelTime = !0 : t.travelTime = !1, t.poi.introduction && (t.poi._briefIntroduction = t.poi.introduction.length > 200 ? t.poi.introduction.substring(0, 200) + " ..." : t.poi.introduction), t.isLastminute && (t.poi.travel_starttime && (t.poi.travel_starttime = new Date(1e3 * t.poi.travel_starttime)), t.poi.travel_endtime && (t.poi.travel_endtime = new Date(1e3 * t.poi.travel_endtime)))
					})
				},
				onError: function(e) {
					i.showTip(e.data.msg, "error")
				}
			}), !t.isLastminute && t.loadComments()), "edit" === i.slideType && (t.currencyList = n.getCurrencyList(), n.getPoiEventDetails({
				data: {
					plan_id: n.getPlanId(),
					oneday_id: i.selectedDay.object.id,
					event_id: i.selectedEventId
				},
				onSuccess: function(n) {
					if (t.$apply(function() {
						e.extend(t.event, n.data), t.images = t.event.note.images || [], t.imgCustom = n.data.image, t.event.currency || (t.event.currency = t.currencyList[0].unit_name), t.event.note || (t.event.note = {}), t.isCustom && (t.poi = n.data), t.poi.cn_name = i.decodeHTML(t.poi.cn_name), t.event.note && t.event.note.content ? t.content_bak = t.event.note.content = i.decodeHTML(t.event.note.content) : t.content_bak = t.event.note.content = "", t.dataLoaded = !0
					}), t.addImageCustom = function() {
						e("#poi_cover").trigger("click")
					}, t.isCustom) {
						var a = function() {
								t.$apply(function() {
									t.imgStatusCustom = "loading"
								})
							},
							o = function(e) {
								var n = new Image;
								n.src = e.origin_url + "/300x200", n.onload = function() {
									t.$apply(function() {
										t.imgCustom = e.origin_url, t.imgStatusCustom = "default", t.dirtyFlag = 1
									})
								}
							},
							r = function() {
								t.$apply(function() {
									t.imgStatusCustom = "error"
								})
							};
						i.uploadPlanPic({
							browse_button: "poi_cover",
							container: "poiInfoBody",
							paths: ["plan", "custom", "poi", "cover"],
							BeforeUpload: a,
							FileUploaded: o,
							UploadError: r
						})
					}
					requirejs(["web_qui_quiselect", "web_old_textarea", "web_old_inputautocomplete"], function(n) {
						var i = new n({
							target: "#poi-type-select",
							exClassName: "full",
							template: '<li class="qui-select-item{{if data.selected}} qui-select-item-active{{/if}}"data-value="{{data.value}}" data-text="{{data.text}}"><em class="icon {{data.class}}-small"></em>{{data.text}}</li>',
							onChange: function(e) {
								qyerUtil.doTrackCode("Planv3-poiinfo-edit-category")
							}
						});
						new n({
							target: "#poi-start-hour-select",
							exClassName: "half",
							onChange: function() {
								qyerUtil.doTrackCode("Planv3-poiinfo-edit-time")
							}
						}), new n({
							target: "#poi-start-minute-select",
							exClassName: "half",
							onChange: function() {
								qyerUtil.doTrackCode("Planv3-poiinfo-edit-time")
							}
						}), new n({
							target: "#poi-currency-select",
							exClassName: "currency"
						}), new n({
							target: "#poi-ticket-count-select",
							exClassName: "ticket-count"
						});
						t.isCustom || i.setConfig({
							disabled: !0
						}), e(".slide-view-poi .textarea-wrapper").qyerTextArea({
							max: 3e3
						})
					}), -1 == t.event.endhours && -1 == t.event.endminutes || t.showEndTime(null, !0)
				},
				onError: function(e) {
					i.showTip(e.data.msg, "error")
				}
			}), e(".slide-view-poi").on("change.dirty", "select, input, textarea", function() {
				t.dirtyFlag = !0
			})), t.showEndTime = function(t, n) {
				t && t.preventDefault(), requirejs(["web_qui_quiselect"], function(t) {
					e("#add-end-time").hide().closest(".row").next().show();
					new t({
						target: "#poi-end-hour-select",
						exClassName: "half",
						onChange: function() {
							qyerUtil.doTrackCode("Planv3-poiinfo-edit-time")
						}
					}), new t({
						target: "#poi-end-minute-select",
						exClassName: "half",
						onChange: function() {
							qyerUtil.doTrackCode("Planv3-poiinfo-edit-time")
						}
					})
				})
			}, t.showMap = function(n) {
				t.isShowMap = !0, e("#view-poi-map").show(), o || i.createSelectMarker("view-poi-map", function(n) {
					o = n, o.reset(t.event.lat, t.event.lng, t.event.useraddress), t.event.lat && t.event.lng && e("#view-poi-map .mark-button").removeClass("primary").text("取消标记"), i.resizePopup()
				}, function() {
					var e = o.getData();
					t.dirtyFlag = !0, t.$apply(function() {
						t.event.lat = e.lat, t.event.lng = e.lng, t.event.useraddress = e.address
					})
				}), i.resizePopup(), n.preventDefault()
			}, t.hideMap = function(n) {
				t.isShowMap = !1, e("#view-poi-map").hide(), n.preventDefault()
			}, t.$on("slide-closed:viewPOI", a), t.scrollToComments = function() {
				e("#js_poiInfoBody_comments").length
			}, t.spendkeyup = function(n) {
				var i = e(n.target);
				if (i.val()) {
					var a = i.val().replace(/([0-9]+\.[0-9]{2})[0-9]*/, "$1");
					a = a.replace(/[\u4e00-\u9fa5]/gi, ""), t.event.spend = a
				}
			}, t.addComment = function() {
				t.commentAction = "add", i.scope = t,
					i.showPopup('<section class="comment-box popup" ng-controller="AddCommentController"><h1>{{title}}评论</h1><div class="comment-box"><div class="comment-list-1"><a href="{{poi.status ? poi.poi_url : \'#\'}}" target="{{poi.status ? \'_blank\':\'_self\'}}" ><img class="comment-list-1-img" src="{{poi.pic_comment}}/80" alt="" onerror=\'this.onerror=null;this.src="//common3.qyerstatic.com/plan/desktop/edit3/img/defaultPOI_32.png"; \'></a><h3 class="comment-list-1-cntitle">{{poi.cn_name}}</h3><h4 class="comment-list-1-entitle">{{poi.en_name}}</h4><p class="comment-list-1-star"><span class="icon" ng-repeat="item in [1,2,3,4,5]" ng-class="{true:\'star\',false:\'empty-star\'}[$index<lookScore/2]" ng-mouseenter="enterScore($event)" ng-mouseleave="leaveScore($event)" ng-click="setScore($event)" ></span> 点击星星为它评分            </p></div><div class="comment-textarea textarea-wrapper qui-textArea"><textarea class="ui2_textarea" maxlength="2000" ng-model="comment.content" placeholder="这里有哪些亮点？哪些方面还不够好？大家都期待着你的点评"></textarea><div class="comment-album clearfix" id="uploadPicBtnBox"><a href="javascript:;" id="uploadPicBtn" class="add-more-pic">上传图片</a><p><a href="#" ng-repeat="image in comment.album"><i class="close" ng-click="delUploadPic($index)"></i><img data-datalarge="{{image.photo}}" src="{{image.thumb}}" /></a></p></div><div class="tips"><span class="current"></span> / <span class="min"></span> ~ <span class="max"></span></div></div><div class="comment-btn tr controls"><a href="#" ng-click="closeThisDialog()" class="button vm">取消</a><a href="#" class="button primary vm" ng-click="setComment()">发布</a></div></div></section>')
			}, t.delComment = function(e, a) {
				i.showConfirm("确定要删除您的点评吗?", e.target, function() {
					if (t.submiting) return void i.showTip("正在保存，请勿重复提交!");
					t.submiting = !0, n.delPoiComment({
						data: {
							plan_id: n.getPlanId(),
							comment_id: a.comment_id
						},
						onSuccess: function(e) {
							t.$apply(function() {
								t.comments = _.without(t.comments, a), t.already_comment = 0, t.total_comments--, t.submiting = !1, i.showTip("评论删除成功！", "ok")
							})
						},
						onError: function(e) {
							i.showTip(e.data.msg, "error"), t.$apply(function() {
								t.submiting = !1
							})
						}
					})
				})
			}, t.editComment = function(e) {
				t.commentAction = "edit", i.scope = t, i.comment = e, i.showPopup('<section class="comment-box popup" ng-controller="AddCommentController"><h1>{{title}}评论</h1><div class="comment-box"><div class="comment-list-1"><a href="{{poi.status ? poi.poi_url : \'#\'}}" target="{{poi.status ? \'_blank\':\'_self\'}}" ><img class="comment-list-1-img" src="{{poi.pic_comment}}/80" alt="" onerror=\'this.onerror=null;this.src="//common3.qyerstatic.com/plan/desktop/edit3/img/defaultPOI_32.png"; \'></a><h3 class="comment-list-1-cntitle">{{poi.cn_name}}</h3><h4 class="comment-list-1-entitle">{{poi.en_name}}</h4><p class="comment-list-1-star"><span class="icon" ng-repeat="item in [1,2,3,4,5]" ng-class="{true:\'star\',false:\'empty-star\'}[$index<lookScore/2]" ng-mouseenter="enterScore($event)" ng-mouseleave="leaveScore($event)" ng-click="setScore($event)" ></span> 点击星星为它评分            </p></div><div class="comment-textarea textarea-wrapper qui-textArea"><textarea class="ui2_textarea" maxlength="2000" ng-model="comment.content" placeholder="这里有哪些亮点？哪些方面还不够好？大家都期待着你的点评"></textarea><div class="comment-album clearfix" id="uploadPicBtnBox"><a href="javascript:;" id="uploadPicBtn" class="add-more-pic">上传图片</a><p><a href="#" ng-repeat="image in comment.album"><i class="close" ng-click="delUploadPic($index)"></i><img data-datalarge="{{image.photo}}" src="{{image.thumb}}" /></a></p></div><div class="tips"><span class="current"></span> / <span class="min"></span> ~ <span class="max"></span></div></div><div class="comment-btn tr controls"><a href="#" ng-click="closeThisDialog()" class="button vm">取消</a><a href="#" class="button primary vm" ng-click="setComment()">发布</a></div></div></section>')
			}, i.textareaTurn({
				scope: t,
				type: "poi",
				save: a
			}), t.imgCustomShow = function() {
				return t.imgCustom ? t.imgCustom + "/300x200" : 32 == t.event.catetypeid ? "//common3.qyerstatic.com/plan/desktop/edit3/img/poicustom.png" : 78 == t.event.catetypeid ? "//common3.qyerstatic.com/plan/desktop/edit3/img/foodcustom.png" : 147 == t.event.catetypeid ? "//common3.qyerstatic.com/plan/desktop/edit3/img/shoppingcustom.png" : 148 == t.event.catetypeid ? "//common3.qyerstatic.com/plan/desktop/edit3/img/activitycustom.png" : 77 == t.event.catetypeid ? "//common3.qyerstatic.com/plan/desktop/edit3/img/trafficcustom.png" : void 0
			}, t.addImage = function() {
				e("#uploadImg").trigger("click")
			}, t.delImage = function(e, n) {
				requirejs(["web_old_slidconfirm"], function(i) {
					i.confirm({
						text: "确认删除图片",
						target: n.target,
						onOK: function() {
							t.$apply(function() {
								t.images.splice(e, 1), t.dirtyFlag = 1
							})
						}
					})
				}), n.preventDefault()
			};
			var r = function() {
					t.$apply(function() {
						t.imgStatus = "loading"
					})
				},
				s = function(e) {
					var n = new Image;
					n.src = e.origin_url + "/80x80", n.onload = function() {
						t.$apply(function() {
							var n = {};
							n.url = e.origin_url, t.images.push(n), t.imgStatus = "default", t.dirtyFlag = 1
						})
					}
				},
				l = function() {
					t.$apply(function() {
						t.imgStatus = "error"
					})
				};
			i.uploadPlanPic({
				browse_button: "uploadImg",
				container: "wrapper",
				paths: ["plan", "poi", "note"],
				BeforeUpload: r,
				FileUploaded: s,
				UploadError: l
			}), t.showPic = function(e) {
				t.service.popData = e, t.service.popShow("showPic")
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	var t = {
		url: "//common3.qyerstatic.com/plan/desktop/edit3/img/pin.png",
		size: {
			w: 30,
			h: 38
		},
		point: {
			x: 0,
			y: 114
		}
	};
	angular.module("planner-slides.viewRoute", []).directive("slideViewRoute", [
		function() {
			return {
				restrict: "C",
				template: '<div class="header"><h2>{{route.title}}</h2><a href="#" class="close" ng-click="service.hideSlide($event)" data-bn-ipg="Planv3-routeinfo-close">关闭</a></div><div class="body"><div class="map-container"><div id="view-route-map" class="inner"></div><ul class="days"><li ng-repeat="day in route.days"><input ng-model="day.selected" ng-init="true" type="checkbox" name="selectedDays" value="{{$index}}" ng-change="update(\'Planv3-routeinfo-map\')" checkbox checked><span ng-click="day.selected = !day.selected;update(\'Planv3-routeinfo-map\')">D{{$index + 1}}部分</span></li></ul></div><div class="item"><div class="title"><div class="pin" ng-class="{daytour:\'icon1\', cursory:\'icon2\', editor:\'icon3\',theme:\'icon3\'}[route.tag || \'daytour\']"></div><h1>{{route.title}}</h1><p ng-repeat="day in route.days"><em ng-if="route.days.length &gt; 1">D{{$index + 1}}</em><span ng-repeat="poi in day.pois" ng-click="viewPoiDetails(poi.id)">{{poi.title}}</span></p></div><div class="desc" ng-if="route.desc"><div class="qyer-editor"></div><h2>- 小编点评 -</h2><p>“{{route.desc}}”</p></div></div></div><div class="footer"><p>平均每日游玩时间：{{route.total_hours}}小时&nbsp;&nbsp;&nbsp;</p><a href="#" class="add" ng-if="route.days.length === 1" ng-click="addToPlan($event)" data-bn-ipg="Planv3-routeinfo-addtoplan"><span class="iconfont">&#58943;</span>添加到行程</a><a href="#" class="add" ng-if="route.days.length &gt; 1" slide-dropdown="chooseDayOptions" data-bn-ipg="Planv3-routeinfo-addtoplan"><span class="iconfont">&#58943;</span>添加到行程</a></div>'
			}
		}
	]).controller("SlideViewRouteController", ["$scope", "$api", "plannerService",
		function(n, i, a) {
			function o() {
				var t = e(".slide-view-route .item").height() + e(".slide-view-route .footer").height() + 196;
				e(".slide-view-route .map-container").css("height", e(window).height() - t + "px")
			}

			function r() {
				requirejs(["web_qui_quigmap"], function(e) {
					u = e, u.init("view-route-map", {
						mapTypeControl: !1
					}), l()
				})
			}

			function s() {
				if (u)
					for (u.clearMarker(), u.clearLine(); f.length;) f.shift().close()
			}

			function l() {
				p = [], n.route.days.forEach(function(n) {
					n.selected && (p = p.concat(n.pois), n.pois.forEach(function(n, i) {
						var a = u.addMarker(e.extend({}, n, {
								icon: t
							})),
							o = u.createDiyInfoWindow({
								content: '<div class="poi-name"><span><mark>' + (i + 1) + "</mark>" + n.title + '</span><div class="triangle"></div></div>'
							});
						o.open(u.map, a), f.push(o), u.addEvent(a, "click", function() {
							console.log("click", this)
						})
					}), u.drawLine(n.pois, {
						strokeColor: "#ef5941",
						strokeOpacity: .9,
						strokeWeight: 2
					}))
				}), u.fitBounds(p)
			}

			function c() {
				var e = 0;
				n.hours = 0, n.cost = 0, n.route.days.forEach(function(t) {
					t.selected && (e++, n.hours += t.total_hours, n.cost += Math.ceil(t.total_cost * i.getExchangeRate(t.currency)))
				}), n.hours && e ? n.hours = parseFloat((n.hours / e).toFixed(1)) : n.hours = 0
			}

			function d(e, t) {
				i.addRouteToPlan({
					data: {
						plan_id: i.getPlanId(),
						rafill_reason: 4,
						oneday_id: a.selectedDay.object.id,
						source_planid: t ? null : n.route.route_id,
						source_pids: e.pois.map(function(e) {
							return e.id
						})
					},
					onSuccess: function(e) {
						a.showTip("添加成功！", "ok"), e.data.city && a.broadcast("auto-add-city", e.data.city), a.setSelectedDay()
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				})
			}
			var u, p, f = [];
			n.route = a.selectedRoute, n.cost = 0, n.hours = 0, n.addToPlan = function(e) {
				e.preventDefault(), a.showConfirm("该线路所有景点将加入第" + (a.selectedDay.index + 1) + "天，是否确定？", e.target, function() {
					d(n.route.days[0], !0)
				})
			}, n.chooseDayOptions = {
				title: "选择添加该日的部分",
				menu: function() {
					return n.route.days.map(function(e, t) {
						return {
							label: "行程D" + (t + 1) + "的部分",
							icon: "add",
							action: function() {
								a.showConfirm("该线路D" + (t + 1) + "所有景点将加入第" + (a.selectedDay.index + 1) + "天，是否确定？", this, function() {
									d(e)
								})
							}
						}
					})
				}
			}, n.route.days.forEach(function(e) {
				e.selected = !0
			}), n.update = function(e) {
				s(), l(), c(), e && qyerUtil.doTrackCode(e)
			}, n.viewPoiDetails = function(e) {
				a.selectedPoiId = e, a.slideType = "view", a.showSlide("viewPOI")
			}, setTimeout(function() {
				o(), window._googlemaploaded_ ? r() : e(window).on("googlemaploaded", function() {
					r()
				}), c()
			}, 250)
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-slides.viewTraffic", []).directive("slideViewTraffic", [
		function() {
			return {
				restrict: "C",
				template: '<div class="header"><h2>城际交通方案</h2><a href="#" class="close" ng-click="service.hideSlide($event)" data-bn-ipg="Planv3-transinfo-close">关闭</a></div><div class="body"><div class="form"><div class="traffic-item" ng-repeat="traffic in traffics"><div class="row"><div class="label"><span>交通方式</span></div><div class="content"><select id="traffic-type-select-{{$index}}" class="traffic-type-select" ng-model="traffic.tripmode"><option value="1">飞机</option><option value="2">火车</option><option value="3">巴士</option><option value="4">自驾</option><option value="5">轮船</option><option value="7">租车(提车/还车)</option><option value="6">其他</option></select></div>\x3c!-- <div class="label"><span>{{traffic.tripmode=="1"?"航班号":"班次"}}</span></div> --\x3e<div class="label"><span>班次</span></div><div class="content"><input class="full flight-number" type="text" name="fligh-no" ng-model="traffic.traffic_number" data-index="{{$index}}"></div></div><div class="row"><div class="label" ng-if="traffic.tripmode==7"><span>提车地点</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; $index == 0"><span>出发站</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; $index &gt; 0"><span>中转站{{$index}}</span></div><div class="content">\x3c!-- <select class="start-city-select" id="start-city-select-{{$index}}"><option value="{{city.id}}" ng-repeat="city in cities">{{city.name}}</option></select> --\x3e<input type="text" ng-if="traffic.tripmode==7" class="half start-city-input" id="start-city-input-{{$index}}" placeholder="提车城市" autocomplete="off" ng-model="traffic.fromplace"><input type="text" ng-if="traffic.tripmode!=7" class="half start-city-input" id="start-city-input-{{$index}}" placeholder="出发城市" autocomplete="off" ng-model="traffic.fromplace"><input type="text" class="half start-poi-input" id="start-poi-input-{{$index}}" ng-model="traffic.frompoi" placeholder="{{[\'\', \'出发机场\', \'出发车站\', \'出发车站\', \'出发地点\', \'出发港口\', \'出发车站\',\'提车地点\'][traffic.tripmode]}}"  data-cityid="{{traffic.fromplaceid}}" ng-disabled="!traffic.fromplace"><div class="icon map-pin2" ng-if="traffic.frompositiontype == 2 && traffic.frompoi"  ng-click="showMap($event, $index, \'from\')"></div></div><div class="label"><span>出发时间</span></div><div class="content"><select id="start-day-select-{{$index}}" class="start-day-select" ng-model="traffic.fromday"><option value="{{day.id}}" ng-repeat="day in service.allDays" ng-selected="day.id == traffic.fromday">{{getDateString($index)}}</option></select><select id="start-hour-select-{{$index}}" class="start-hour-select" ng-model="traffic.starthours"><option value="-1">时</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select id="start-minute-select-{{$index}}" class="start-minute-select" ng-model="traffic.startminutes"><option value="-1">分</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div></div><div class="row"><div class="label" ng-if="traffic.tripmode==7"><span>还车地点</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; $last"><span>到达站</span></div><div class="label" ng-if="traffic.tripmode!=7 &amp;&amp; !$last"><span>中转站{{$index+1}}</span></div><div class="content">\x3c!-- <select class="end-city-select" id="end-city-select-{{$index}}"><option value="{{city.id}}" ng-repeat="city in cities">{{city.name}}</option></select> --\x3e<input type="text" ng-if="traffic.tripmode==7" class="half end-city-input" id="end-city-input-{{$index}}" placeholder="还车城市" autocomplete="off" ng-model="traffic.toplace"><input type="text" ng-if="traffic.tripmode!=7" class="half end-city-input" id="end-city-input-{{$index}}" placeholder="到达城市" autocomplete="off" ng-model="traffic.toplace"><input type="text" class="half end-poi-input" id="end-poi-input-{{$index}}" ng-model="traffic.topoi"  placeholder="{{[\'\', \'到达机场\', \'到达车站\', \'到达车站\', \'到达地点\', \'到达港口\', \'到达车站\',\'还车地点\'][traffic.tripmode]}}" data-cityid="{{traffic.toplaceid}}" ng-disabled="!traffic.toplace"><div class="icon map-pin2" ng-if="traffic.topositiontype == 2 && traffic.topoi" ng-click="showMap($event, $index, \'to\')"></div></div><div class="label"><span>到达时间</span></div><div class="content"><select id="end-day-select-{{$index}}" class="end-day-select" ng-model="traffic.today"><option value="{{day.id}}" ng-repeat="day in service.allDays" ng-selected="day.id == traffic.today">{{getDateString($index)}}</option></select><select id="end-hour-select-{{$index}}" class="end-hour-select" ng-model="traffic.endhours"><option value="-1">时</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><select id="end-minute-select-{{$index}}" class="end-minute-select" ng-model="traffic.endminutes"><option value="-1">分</option><option value="0">00</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select></div></div><div class="reference" ng-if="traffic.fromplace && traffic.toplace && traffic.recommendTraffics[0].distance"><span class="iconfont">&#58965;</span>                距离{{traffic.recommendTraffics[0].distance}}KM<span ng-if="traffic.recommendTraffics[0].percent > 0">，               {{traffic.recommendTraffics[0].percent}}%用户选择                {{[\'\', \'飞机\', \'火车\', \'大巴\', \'租车\', \'轮船\', \'其他\'][traffic.recommendTraffics[0].tripmode]}}                {{getTimeString(traffic.recommendTraffics[0].avg_time)}}                {{traffic.recommendTraffics[0].avg_spend?("，花费"+ traffic.recommendTraffics[0].avg_spend +"人民币"):""}}</span><ul><li ng-repeat="traffic in traffic.recommendTraffics" ng-if="traffic.percent"><p><span class="iconfont">{{[\'\', \'&#58883;\', \'&#58886;\', \'&#58881;\', \'&#58882;\', \'&#58880;\', \'&#58884;\'][traffic.tripmode]}}</span><span ng-if="traffic.percent > 0">{{traffic.percent}}%用户选择了</span><span>{{[\'\', \'飞机\', \'火车\', \'大巴\', \'租车\', \'轮船\', \'其他\'][traffic.tripmode]}} {{getTimeString(traffic.avg_time)}} {{traffic.avg_spend?("，花费"+ traffic.avg_spend +"人民币"):""}}</span></p></li></ul></div><div class="links"><a href="#" ng-if="$index &gt; 0" ng-click="removeTrafficItem($event, $index)" data-bn-ipg="Planv3-transinfo-edit-delete">-删除该段</a><a href="#" ng-if="$last" ng-click="addTrafficItem($event)" data-bn-ipg="Planv3-transinfo-edit-addtransfer">+增加中转</a></div></div><div id="view-traffic-map" class="map-container"></div><div class="row"><div class="label"><span>花费</span></div><div class="content"><input class="cost" type="text" name="cost" value="0" min="0" ng-model="cost" ng-init="cost = 0" ng-keyup="costkeyup($event)"><select name="currency" id="traffic-currency-select" ng-model="currency" ng-init="currency = currencyList[0].unit_name"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}">{{currency.name}}</option></select><select name="ticket-count" id="traffic-ticket-count-select" ng-model="count" ng-init="count = 1"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div><div class="label extend"><h5>{{currency}} {{(cost * count).toFixed(2)}}</h5></div></div></div><div class="textarea-wrapper textarea-box qui-textArea" ng-class="{hover:textarea.focus}" data-width="605"><textarea placeholder="添加备注的文字" class="ui2_textarea" ng-model="content" ng-focus="textarea.focusFun($event)" ng-blur="textarea.blurFun($event)" maxlength="3000" ng-class="{lostFocus:!textarea.btnShow}"></textarea><div class="textarea-info" ng-show="textarea.btnShow"><div class="tips textarea-count-length"><span class="current"></span>/<span class="max"></span>字            </div><div class="textarea-btnbox"><a href="#" class="button vm" ng-click="textarea.cancel($event)">取消</a><a href="#" class="button primary vm" ng-click="textarea.save($event)">保存</a></div></div></div>\x3c!--图片上传--\x3e<div class="uploadPic" ng-show="service.isLogin"><ul><li class="uploadPicLi" ng-repeat="image in images"><img class="uploadPicLi__pic" src="{{image.url}}/80x80" /><div class="uploadPicLi__view" data-index="{{$index}}" ng-click="showPic(image.url)"><i class="iconfont">&#58991;</i>点击查看</div><i class="uploadPicLi__delete iconfont" ng-click=\'delImage($index,$event)\'>&#58992;</i></li><li class="uploadPicLi" ng-if=\'imgStatus == "error"\'><div class="uploadPicLi__error"  ng-click="addImage()"><i class="iconfont">&#58990;</i>上传失败                    <br />重传</div></li><li class="uploadPicLi" ng-if=\'imgStatus == "loading"\'><i class="iconfont uploadPicLi__loading"></i></li><li class="uploadPicLi" ng-if=\'images.length < 5 && imgStatus == "default"\'><i class="iconfont uploadPicLi__add" ng-click="addImage()">&#58943;</i></li></ul><input type="hidden" id="uploadImg" /></div>\x3c!--/图片上传--\x3e</div>'
			}
		}
	]).controller("SlideViewTrafficController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			function o() {
				var t = e(window).height();
				e(".slide-view-traffic .body").css("maxHeight", t - 156 + "px")
			}

			function r(i) {
				var o = e(".slide-view-traffic");
				requirejs(["web_qui_quiselect", "web_old_inputautocomplete"], function(r) {
					o.find(".start-city-input, .end-city-input").each(function() {
						var i = e(this),
							o = a.selectedDay.object.city_list;
						i.data("inited") || (i.data("inited", !0), i.qyerAutocomplete({
							isAllowEmptySeach: !0,
							isFocusedSeach: !0,
							autoSelect: !0,
							onSearch: function() {
								var t = e.trim(this.value);
								if (t) n.searchCity({
									data: {
										plan_id: n.getPlanId(),
										oneday_id: a.selectedDay.object.id,
										city_id: null,
										keyword: t
									},
									onSuccess: function(n) {
										var o = ['<div class="search-city-list full">'];
										o.push('<ul class="qui-inputAutocomplete-ul">'), n.data.forEach(function(e) {
											var t = '<li data-id="' + e.city_id + '" data-name="' + e.city_name + '"><span>' + e.city_name + "</span></li>";
											o.push(t)
										}), t && o.push('<li class="custom" data-id="-1" data-name="' + t + '">创建自定义城市“' + a.encodeHTML(t) + "”</li>"), o.push("</ul>"), o.push("</div>"), i.qyerAutocomplete("pushHTML", o.join("")), i.parent().append(e(".search-city-list").parent()), i.siblings(".qui-inputAutocomplete").css({
											top: "38px",
											left: "0px"
										})
									},
									onError: function(n) {
										var o, r = ['<div class="search-city-list">'];
										o = n.data && n.data.msg ? n.data.msg : "搜索无结果", r.push('<div class="search-title">' + o + "</div>"), r.push('<ul class="qui-inputAutocomplete-ul">'), t && r.push('<li class="custom" data-id="-1" data-name="' + t + '">创建自定义城市“' + a.encodeHTML(t) + "”</li>"), r.push("</ul>"), r.push("</div>"), i.qyerAutocomplete("pushHTML", r.join("")), i.parent().append(e(".search-city-list").parent()), i.siblings(".qui-inputAutocomplete").css({
											top: "38px",
											left: "0px"
										})
									}
								});
								else {
									var o = ['<div class="search-city-list full">'];
									o.push('<ul class="qui-inputAutocomplete-ul">'), a.getAllCities().forEach(function(e) {
										var t = '<li data-id="' + e.tagid + '" data-name="' + e.name + '"><span>' + a.encodeHTML(e.name) + "</span></li>";
										o.push(t)
									}), o.push("</ul>"), o.push("</div>"), i.qyerAutocomplete("pushHTML", o.join("")), i.parent().append(e(".search-city-list").parent()), i.siblings(".qui-inputAutocomplete").css({
										top: "38px",
										left: "0px"
									})
								}
							},
							onSelect: function(r) {
								var s, l = r.getAttribute("data-id"),
									c = r.getAttribute("data-name");
								if (i.val(c), i.hasClass("start-city-input")) {
									if (s = parseInt(i.attr("id").replace("start-city-input-", "")), t.$apply(function() {
										t.traffics[s].fromplaceid = l, t.traffics[s].fromplace = c
									}), o && o.length)
										for (var d = 0; d < o.length; d++) o[d].tagid == l && d != o.length && (s = parseInt(e(".end-city-input").eq(0).attr("id").replace("end-city-input-", "")), t.$apply(function() {
											t.traffics[s].toplaceid = o[d + 1].tagid, t.traffics[s].toplace = o[d + 1].name
										}))
								} else s = parseInt(i.attr("id").replace("end-city-input-", "")), t.$apply(function() {
									t.traffics[s].toplaceid = l, t.traffics[s].toplace = c
								});
								i.val() && n.city2citytraffic({
									data: {
										from_cityid: t.traffics[s].fromplaceid,
										from_cityname: t.traffics[s].fromplace,
										to_cityid: t.traffics[s].toplaceid,
										to_cityname: t.traffics[s].toplace
									},
									onSuccess: function(e) {
										t.$apply(function() {
											t.traffics[s].recommendTraffics = e.data || []
										})
									},
									onError: function(e) {
										a.showTip(e.data.msg, "error")
									}
								}), t.dirtyFlag = !0
							}
						}), f.push(i))
					}), o.find(".start-poi-input, .end-poi-input").each(function() {
						var i, o = e(this);
						o.data("inited") || (o.data("inited", !0), o.qyerAutocomplete({
							isAllowEmptySeach: !0,
							isFocusedSeach: !0,
							autoSelect: !0,
							onSearch: function() {
								i = o.hasClass("start-poi-input") ? o.attr("id").replace("start-poi-input-", "") : o.attr("id").replace("end-poi-input-", "");
								var r = e.trim(this.value),
									s = e(this).attr("data-cityid");
								n.searchStation({
									data: {
										plan_id: n.getPlanId(),
										oneday_id: a.selectedDay.object.id,
										city_id: s,
										keyword: r,
										tripmode: t.traffics[i].tripmode
									},
									onSuccess: function(t) {
										var n = ['<div class="search-station-list">'];
										r || n.push('<div class="search-title">猜你想去</div>'), n.push('<ul class="qui-inputAutocomplete-ul">'), t.data.forEach(function(e) {
											var t = '<li data-id="' + e.id + '" data-enname="' + e.en_name + '" data-cnname="' + e.cn_name + '"><span>' + a.encodeHTML(e.cn_name) + "</span></li>";
											n.push(t)
										}), r && n.push('<li data-id="-1" class="custom" data-cnname="' + r + '">创建自定义地点“' + a.encodeHTML(r) + "”</li>"), n.push("</ul>"), n.push("</div>"), o.qyerAutocomplete("pushHTML", n.join("")), o.parent().append(e(".search-station-list").parent()), o.siblings(".qui-inputAutocomplete").css({
											top: "38px",
											left: "109px"
										})
									},
									onError: function(t) {
										var n, i = ['<div class="search-station-list">'];
										n = t.data && t.data.msg ? t.data.msg : "搜索无结果", i.push('<div class="search-title">' + n + "</div>"), i.push('<ul class="qui-inputAutocomplete-ul">'), r && i.push('<li data-id="-1" class="custom" data-cnname="' + r + '">创建自定义地点“' + a.encodeHTML(r) + "”</li>"), i.push("</ul>"), i.push("</div>"), o.qyerAutocomplete("pushHTML", i.join("")), o.parent().append(e(".search-station-list").parent()), o.siblings(".qui-inputAutocomplete").css({
											top: "38px",
											left: "109px"
										})
									}
								})
							},
							onSelect: function(e) {
								var n, i = e.getAttribute("data-id"),
									a = e.getAttribute("data-cnname");
								e.getAttribute("data-enname");
								o.hasClass("start-poi-input") ? (n = o.attr("id").replace("start-poi-input-", ""), t.traffics[n].frompoiid = i, t.traffics[n].frompoi = a, t.traffics[n].frompositiontype = -1 == i ? 2 : 1) : (n = o.attr("id").replace("end-poi-input-", ""), t.traffics[n].topoiid = i, t.traffics[n].topoi = a, t.traffics[n].topositiontype = -1 == i ? 2 : 1), t.dirtyFlag = !0, o.val(a), t.$apply()
							}
						}), f.push(o))
					}), o.find(".traffic-type-select:visible").each(function(t, n) {
						var i = new r({
							target: "#" + n.id,
							exClassName: "full"
						});
						e(n).data("control", i)
					}), o.find(".start-day-select:visible, .end-day-select:visible").each(function(t, n) {
						var i = new r({
							target: "#" + n.id,
							exClassName: "half"
						});
						e(n).data("control", i)
					}), o.find(".start-hour-select:visible, .start-minute-select:visible, .end-hour-select:visible, .end-minute-select:visible").each(function(t, n) {
						var i = new r({
							target: "#" + n.id,
							exClassName: "quarter"
						});
						e(n).data("control", i)
					}), i && i()
				})
			}

			function s() {
				return !0
			}

			function l() {
				"edit" === a.slideType && t.dirtyFlag && "edit" === a.slideType && s() && n.setTrafficEventDetails({
					data: {
						plan_id: n.getPlanId(),
						oneday_id: a.selectedDay.object.id,
						group_id: a.selectedGroupId,
						currency: t.currency,
						price: t.cost,
						count: t.count,
						traffics: t.traffics,
						note: {
							images: t.images || [],
							content: t.content
						}
					},
					onSuccess: function(e) {
						a.setSelectedDay(), t.content_bak = t.content, t.dirtyFlag = !1, a.showTip("保存成功", "ok")
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				})
			}

			function c(t, i, o) {
				var r = a.allDays.length;
				n.insertDay({
					data: {
						plan_id: n.getPlanId(),
						index: r
					},
					onSuccess: function(r) {
						0 === r.data.city_list.length && r.data.city_list[0].id == i.id ? r.data.city_list[0].tagid = r.data.city_list[0].id : (r.data.city_list = [e.extend({}, i)], n.updateCityList({
							data: {
								plan_id: n.getPlanId(),
								oneday_id: r.data.id,
								truncate: 0,
								citys: [{
									tagid: i.tagid,
									name: i.name,
									type: 1
								}]
							}
						})), a.allDays.push(r.data), 1 === t ? o && o() : c(t - 1, i, o)
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error"), o && o()
					}
				})
			}

			function d(e, n) {
				t.traffic.today = a.allDays[e].id;
				var i = t.traffic_dom.find(".end-day-select").children().eq(e).text();
				t.traffic_dom.find(".end-day-select").next().find(".qui-select-title").text(i).next().find(".qui-select-item").eq(e).addClass("qui-select-item-active").siblings().removeClass("qui-select-item-active")
			}
			var u, p, f = [];
			t.dirtyFlag = !1, t.traffics = [{}], t.mode = a.slideType, t.service = a, t.images = [], t.imgStatus = "default", t.getDateString = function(e) {
				var t, o, r = n.getStartDate(),
					s = i("date");
				return r ? (o = new Date(r.getTime() + 864e5 * e), t = s(o, "M月d日") + "(" + ["日", "一", "二", "三", "四", "五", "六"][o.getDay()] + ")") : t = "第" + (e + 1) + "天", t + " " + a.allDays[e].city_list.map(function(e) {
					return e.name
				}).join("，")
			}, t.showMap = function(n, i, o) {
				var r = t.traffics[i];
				p = {
					traffic: r,
					type: o
				}, u ? (e(n.target).closest(".row").next().is("#view-traffic-map") ? e("#view-traffic-map").toggle() : (e(n.target).closest(".row").after(e("#view-traffic-map").show()), u.reset(r[o + "poilat"], r[o + "poilng"], r[o + "poiaddress"])), a.resizePopup()) : (e(n.target).closest(".row").after(e("#view-traffic-map").show()), a.createSelectMarker("view-traffic-map", function(e) {
					u = e, a.resizePopup(), u.reset(r[o + "poilat"], r[o + "poilng"], r[o + "poiaddress"])
				}, function() {
					var e = u.getData();
					p.traffic[p.type + "poilat"] = e.lat, p.traffic[p.type + "poilng"] = e.lng, p.traffic[p.type + "poiaddress"] = e.address, t.dirtyFlag = !0
				}))
			}, t.addTrafficItem = function(e) {
				if (e.preventDefault(), t.traffics && t.traffics.length >= 5) return void a.showTip("最多添加5段交通", "error");
				var n = t.traffics[t.traffics.length - 1];
				t.traffics.push({
					fromplaceid: n.toplaceid || "",
					fromplace: n.toplace || "",
					toplaceid: "",
					toplace: "",
					endhours: "-1",
					endminutes: "-1",
					fromday: n.today,
					frompoi: "",
					frompoiid: "",
					frompoilat: "",
					frompoilng: null,
					id: "",
					starthours: "-1",
					startminutes: "-1",
					today: n.today,
					topoi: "",
					topoiid: "",
					topoilat: "",
					topoilng: null,
					traffic_number: "",
					tripmode: "1"
				}), t.dirtyFlag = !0, setTimeout(function() {
					r()
				}, 0)
			}, t.removeTrafficItem = function(e, i) {
				e.preventDefault(),
					a.showConfirm("确认要删除此段中转交通？", e.target, function() {
						n.removeEvents({
							data: {
								plan_id: n.getPlanId(),
								oneday_id: a.selectedDay.object.id,
								onedayevent_obj: [{
									group_id: 0,
									pid: t.traffics[i].id,
									type: 3
								}]
							},
							onSuccess: function() {
								a.showTip("删除成功！", "ok"), a.setSelectedDay(), t.traffics.splice(i, 1), setTimeout(function() {
									r()
								}, 0)
							},
							onError: function(e) {
								a.showTip(e.data.msg, "error")
							}
						})
					})
			}, "edit" === a.slideType && (t.currencyList = n.getCurrencyList(), n.getTrafficEventDetails({
				data: {
					plan_id: n.getPlanId(),
					oneday_id: a.selectedDay.object.id,
					trafficid: a.selectedEventId
				},
				onSuccess: function(i) {
					t.$apply(function() {
						t.cost = parseFloat(i.data.spend || 0, 10), t.traffics = _.map(i.data.traffics, function(e) {
							return _.extend(e, {
								fromplace: a.decodeHTML(e.fromplace),
								frompoi: a.decodeHTML(e.frompoi),
								toplace: a.decodeHTML(e.toplace),
								topoi: a.decodeHTML(e.topoi),
								traffic_number: a.decodeHTML(e.traffic_number)
							})
						}), _.each(t.traffics, function(e, i) {
							n.city2citytraffic({
								data: {
									from_cityid: e.fromplaceid,
									from_cityname: e.fromplace,
									to_cityid: e.toplaceid,
									to_cityname: e.toplace
								},
								onSuccess: function(e) {
									t.$apply(function() {
										t.traffics[i].recommendTraffics = e.data || []
									})
								},
								onError: function(e) {
									a.showTip(e.data.msg, "error")
								}
							})
						}), t.currency = i.data.currency || "CNY", t.count = i.data.counts || 1, t.content = t.content_bak = a.decodeHTML(i.data.note.content), t.images = i.data.note.images || []
					}), requirejs(["web_qui_quiselect", "web_old_textarea"], function(t) {
						new t({
							target: "#traffic-currency-select",
							exClassName: "currency"
						}), new t({
							target: "#traffic-ticket-count-select",
							exClassName: "ticket-count"
						});
						e(".slide-view-traffic .textarea-wrapper").qyerTextArea({
							max: 3e3
						}), r()
					})
				},
				onError: function(e) {
					a.showTip(e.data.msg, "error")
				}
			}), e(".slide-view-traffic").on("change.dirty", "select, input, textarea", function() {
				t.dirtyFlag = !0
			})), o(), e(window).on("resize.viewTraffic", function() {
				o()
			}), t.$on("slide-closed:viewTraffic", l), t.traffic_dom = "", t.traffic = "", t.service.setTrafficFlightItem = function(n) {
				var n = n,
					i = t.traffic_dom,
					o = n.departure.time.split(":"),
					s = n.arrival.time.split(":"),
					l = null;
				t.traffic.traffic_number = n.flight, t.traffic.fromplaceid = n.departure.id, t.traffic.fromplace = n.departure.city, t.traffic.frompoiid = n.departure.poi_id, t.traffic.frompoi = n.departure.poiname, t.traffic.frompoilat = n.departure.lat, t.traffic.frompoilng = n.departure.lng, t.traffic.frompositiontype = n.departure.poi_id > 0 ? 1 : 2, t.traffic.starthours = parseInt(o[0]), t.traffic.startminutes = parseInt(o[1]), t.traffic.toplaceid = n.arrival.id, t.traffic.toplace = n.arrival.city, t.traffic.topoiid = n.arrival.poi_id, t.traffic.topoi = n.arrival.poiname, t.traffic.topoilat = n.arrival.lat, t.traffic.topoilng = n.arrival.lng, t.traffic.topositiontype = n.departure.poi_id > 0 ? 1 : 2, t.traffic.endhours = parseInt(s[0]), t.traffic.endminutes = parseInt(s[1]), i.find(".start-hour-select").next().find(".qui-select-title").text(o[0]), i.find(".start-minute-select").next().find(".qui-select-title").text(o[1]), i.find(".end-hour-select").next().find(".qui-select-title").text(s[0]), i.find(".end-minute-select").next().find(".qui-select-title").text(s[1]), n.arrival.day > 0 ? (a.allDays.forEach(function(e, n) {
					e.id == t.traffic.fromday && (l = n)
				}), null !== l && (l += n.arrival.day, l > a.allDays.length - 1 ? a.showConfirm2("到达日期已超出行程，将该日添加到行程中", function() {
					var i = l - a.allDays.length + 1,
						o = e("<div>", {
							class: "mask",
							style: "z-index:100;background:none"
						}).appendTo(document.body);
					a.showLoadingTip("正在添加中..."), c(i, {
						tagid: n.arrival.id,
						name: n.arrival.city,
						type: 1,
						lat: n.arrival.lat,
						lng: n.arrival.lng
					}, function() {
						t.$apply(), e(".add-traffic .end-day-select, .add-traffic .start-day-select").show().next().remove(), r(function() {
							d(l)
						}), a.hideLoadingTip(), o.remove()
					})
				}, function() {
					d(a.allDays.length - 1)
				}) : d(l))) : t.traffic.today = t.traffic.fromday
			}, e(document.body).on("change.flight-number", ".slide-view-traffic input.flight-number", function(o) {
				var r = o.target,
					s = e.trim(this.value),
					l = n.getStartDate(),
					c = i("date"),
					d = null;
				t.traffic_dom = e(r).closest(".traffic-item"), s && (l && (d = new Date(l.getTime() + 864e5 * a.selectedDay.index)), t.traffic = t.traffics[e(r).attr("data-index")], "1" == t.traffic.tripmode && n.getFlightList({
					data: {
						flight_no: s,
						date: d ? c(d, "y-M-d") : null
					},
					onSuccess: function(e) {
						e.data.length > 1 ? t.$apply(function() {
							t.service.popData = e.data, t.service.popShow("flight")
						}) : t.$apply(function() {
							t.service.setTrafficFlightItem(e.data[0])
						})
					},
					onError: function(e) {}
				}))
			}), e(".planner-slider").css("width", "646px"), t.$on("$destroy", function() {
				for (; f.length;) try {
					f.shift().qyerAutocomplete("destroy")
				} catch (e) {
					console.log(e)
				}
				e(document.body).off("change.flight-number"), e(".planner-slider").removeAttr("style"), e(window).off("resize.viewTraffic")
			}), t.costkeyup = function(n) {
				var i = e(n.target);
				if (i.val()) {
					var a = i.val().replace(/([0-9]+\.[0-9]{2})[0-9]*/, "$1");
					a = a.replace(/[\u4e00-\u9fa5]/gi, ""), t.cost = a
				}
			}, a.textareaTurn({
				scope: t,
				save: l
			}), t.addImage = function() {
				e("#uploadImg").trigger("click")
			}, t.delImage = function(e, n) {
				requirejs(["web_old_slidconfirm"], function(i) {
					i.confirm({
						text: "确认删除图片",
						target: n.target,
						onOK: function() {
							t.$apply(function() {
								t.images.splice(e, 1), t.dirtyFlag = 1
							})
						}
					})
				}), n.preventDefault()
			};
			var h = function() {
					t.$apply(function() {
						t.imgStatus = "loading"
					})
				},
				g = function(e) {
					var n = new Image;
					n.src = e.origin_url + "/80x80", n.onload = function() {
						t.$apply(function() {
							var n = {};
							n.url = e.origin_url, t.images.push(n), t.imgStatus = "default", t.dirtyFlag = 1
						})
					}
				},
				m = function() {
					t.$apply(function() {
						t.imgStatus = "error"
					})
				};
			a.uploadPlanPic({
				browse_button: "uploadImg",
				container: "wrapper",
				paths: ["plan", "traffic", "note"],
				BeforeUpload: h,
				FileUploaded: g,
				UploadError: m
			}), t.showPic = function(e) {
				t.service.popData = e, t.service.popShow("showPic")
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.calendar", []).directive("plannerToolbarCalendar", [
		function() {
			return {
				restrict: "C",
				template: '<table><thead ng-if="!loading"><tr><th><em class="icon calendar-small"></em><span>日期</span></th><th><em class="icon building-small"></em><span>城市</span></th><th><em class="icon plane-small"></em><span>交通</span></th><th><em class="icon kiosk-small"></em><span>景点</span></th><th><em class="icon bed-small"></em><span>住宿</span></th></tr></thead><tbody ng-if="!loading"><tr ng-repeat="day in days"><td><div class="date" ng-if="getSpecifyDate($index)"><div class="left">{{getDate($index)}}</div><div class="right"><div class="month">{{getMonth($index)}}月</div><div class="day">星期{{getDay($index)}}</div></div></div><p ng-if="!getSpecifyDate($index)">D{{$index + 1}}</p></td><td><p ng-repeat="city in day.citys"><a target="_blank" href="{{city.url}}" ng-if="city.url">{{city.cn_name}} {{city.en_name}}</a><span ng-if="!city.url">{{city.cn_name}} {{city.en_name}}</span></p></td><td><ul><li ng-repeat="traffic in day.traffic"><p ng-if="traffic.time">{{traffic.time}}</p><p><a target="_blank" href="{{traffic.starturl}}" ng-if="traffic.starturl">{{traffic.start}}</a><span ng-if="!traffic.starturl">{{traffic.start}}</span><em class="traffic" ng-class="[\'other\', \'plane\', \'train\', \'bus\', \'car\', \'boat\', \'walk\', \'metro\'][traffic.type]"></em><a target="_blank" href="{{traffic.endurl}}" ng-if="traffic.endurl">{{traffic.end}}</a><span ng-if="!traffic.endurl">{{traffic.end}}</span></p><p ng-if="traffic.number">{{traffic.number}}</p></li></ul></td><td><ol><li ng-repeat="poi in day.poi"><a href="{{poi.url}}" target="_blank" ng-if="poi.url">{{poi.cn_name || poi.en_name}}</a><span ng-if="!poi.url">{{poi.cn_name || poi.en_name}}</span></li></ol></td><td><p ng-repeat="hotel in day.hotel"><a href="{{hotel.url}}" target="_blank" ng-if="hotel.url" data-bn-ipg="{true:\'Planv3-toolbar-calendar-airbnbclick\'}[event.source == 3]"><span>{{hotel.en_name || hotel.cn_name}}</span><span ng-if="hotel.en_name && hotel.cn_name">({{hotel.cn_name}})</span></a><span ng-if="!hotel.url">{{hotel.en_name || hotel.cn_name}}</span><span ng-if="!hotel.url && hotel.en_name && hotel.cn_name">({{hotel.cn_name}})</span><br><span ng-if="hotel.spend">{{hotel.currency}} {{hotel.spend * (hotel.counts || 1)}}</span></p></td></tr></tbody><tbody ng-if="loading"><tr><td>正在加载中...</td></tr></tbody></table><table class="clone" ng-if="!loading"><thead ng-if="!loading"><tr><th><em class="icon calendar-small"></em><span>日期</span></th><th><em class="icon building-small"></em><span>城市</span></th><th><em class="icon plane-small"></em><span>交通</span></th><th><em class="icon kiosk-small"></em><span>景点</span></th><th><em class="icon bed-small"></em><span>住宿</span></th></tr></thead></table>'
			}
		}
	]).controller("ToolbarCalendarController", ["$scope", "$api", "plannerService",
		function(e, t, n) {
			var i = [];
			e.loading = !0, e.days = [], e.getSpecifyDate = function(e) {
				if (void 0 !== i[e]) return i[e];
				var n, a = t.getStartDate();
				return n = a ? new Date(a.getTime() + 864e5 * e) : null, i[e] = n, n
			}, e.getDate = function(t) {
				var n, i = e.getSpecifyDate(t);
				return i ? (n = i.getDate(), n < 10 ? "0" + n : n) : null
			}, e.getMonth = function(t) {
				var n = e.getSpecifyDate(t);
				return n ? n.getMonth() + 1 : null
			}, e.getDay = function(t) {
				var n = e.getSpecifyDate(t);
				return n ? ["日", "一", "二", "三", "四", "五", "六"][n.getDay()] : null
			}, t.getCalendarData({
				data: {
					plan_id: t.getPlanId()
				},
				onSuccess: function(t) {
					e.$apply(function() {
						e.days = t.data, e.loading = !1
					})
				},
				onError: function(t) {
					e.$apply(function() {
						e.loading = !1
					}), n.showTip(t.data.msg, "error")
				}
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.cart", []).directive("plannerToolbarCart", [
		function() {
			return {
				restrict: "C",
				template: '<div class="header"><ul><li ng-class="{true:\'active\'}[tab==\'unpaid\']" ng-click="clickUnpaidTab($event)" ng-disabled="dirtyFlag">待付款订单</li><li ng-class="{true:\'active\'}[tab==\'paid\']" ng-click="clickPaidTab($event)" ng-disabled="dirtyFlag">已付款订单</li></ul></div><div class="content" ng-class="{true:\'expand\'}[tab==\'paid\']"><div class="inner">\x3c!-- 待付款订单为空 --\x3e<div class="group" ng-if="!unpaidOrderData.productinfo.length && tab == \'unpaid\' && (role == 0 || loading)"><div class="empty"><span ng-if="!loading">暂无待付款订单</span><span ng-if="loading">加载中...</span></div></div>\x3c!-- 待付款订单（用户界面） --\x3e<div class="group" ng-if="unpaidOrderData.productinfo.length > 0 && tab == \'unpaid\' && role == 0"><div class="title" ng-if="unpaidOrderData.productinfo.length > 0"><div>名称</div><div>产品类型</div><div>单价</div><div>数量</div><div>开始时间</div><div>结束时间</div><div>备注</div><div>价格</div></div><h3 class="lm_title" ng-if="discountTitle">折扣商品</h3><div class="item clearfix" ng-repeat="item in unpaidOrderData.productinfo"  ng-if="item.type == 1"><div><div><a ng-if="item.url" href="{{item.url}}" target="_blank">{{item.title}}</a><span ng-if="!item.url">{{item.title}}</span></div></div><div>{{item.lm_typename}}</div><div>CNY {{item.price}}</div><div>{{item.counts}}</div><div>{{item.starttime}}</div><div>{{item.endtime}}</div><div title="{{item.note}}">{{item.note}}</div><div>CNY {{item.total}}</div></div><h3 class="hotle_title"  ng-if="hotleTitle">酒店</h3><div class="item clearfix" ng-repeat="item in unpaidOrderData.productinfo"  ng-if="item.type == 2"><div><div><a ng-if="item.url" href="{{item.url}}" target="_blank">{{item.title}}</a><span ng-if="!item.url">{{item.title}}</span></div></div><div>{{item.lm_typename}}</div><div>CNY {{item.price}}</div><div>{{item.counts}}</div><div>{{item.starttime}}</div><div>{{item.endtime}}</div><div title="{{item.note}}">{{item.note}}</div><div>CNY {{item.total}}</div></div><h3 class="other_title"  ng-if="otherTitle">其他</h3><div class="item clearfix" ng-repeat="item in unpaidOrderData.productinfo"  ng-if="item.type == 3"><div><div><a ng-if="item.url" href="{{item.url}}" target="_blank">{{item.title}}</a><span ng-if="!item.url">{{item.title}}</span></div></div><div>{{item.lm_typename}}</div><div>CNY {{item.price}}</div><div>{{item.counts}}</div><div>{{item.starttime}}</div><div>{{item.endtime}}</div><div title="{{item.note}}">{{item.note}}</div><div>CNY {{item.total}}</div></div>\x3c!-- <div class="title" ng-if="unpaidOrderData.discount > 0"><div>折扣</div></div><dl class="discount" ng-if="unpaidOrderData.discount > 0"><dt>折</dt><dd>{{unpaidOrderData.discount}}</dd></dl> --\x3e</div>\x3c!-- 待付款订单（规划师界面） --\x3e<div class="group editable" ng-if="!loading && tab == \'unpaid\' && role == 1"><div class="title"><div>名称</div><div>产品类型</div><div>单价</div><div>数量</div><div>开始时间</div><div>结束时间</div><div>备注</div><div>价格</div></div><div class="editable-item" ng-if="unpaidOrderData.productinfo.length == 0"><span>暂无待付款订单</span></div><h3 class="lm_title"  ng-if="discountTitle">折扣商品</h3><div class="editable-item" ng-repeat="item in unpaidOrderData.productinfo" ng-hide="item.status == \'del\'" ng-if="item.type == 1"><div><input type="text" ng-model="item.title" ng-change="goDirty()"><a href="{{item.url}}" target="_blank" ng-if="item.pid > 0">查看</a>\x3c!-- <a href="##" ng-if="item.pid == 0" ng-click="deleteCustomItem($index)">删除</a> --\x3e<a href="##" ng-if="item.pid == 0 && !item.url" ng-click="addCustomLink($index)">添加链接</a><a href="##" ng-if="item.pid == 0 && item.url" ng-click="modifyCustomLink($index)">修改链接</a></div><div><input type="text" ng-model="item.lm_typename" ng-change="goDirty()"></div><div><input type="text" ng-model="item.price" ng-change="calculate()"></div><div><select class="item-count-select raw-select" ng-model="item.counts" ng-change="calculate()"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option></select></div><div><input type="text" ng-model="item.starttime" class="starttime"></div><div><input type="text" ng-model="item.endtime" class="endtime" ></div><div><input type="text" value="" ng-model="item.note"  maxlength="200" ng-change="goDirty()"></div><div><span>{{((item.price * item.counts) || 0).toFixed(2)}}</span></div></div><h3 class="hotle_title" ng-if="hotleTitle">酒店</h3><div class="editable-item" ng-repeat="item in unpaidOrderData.productinfo" ng-hide="item.status == \'del\'" ng-if="item.type == 2"><div><input type="text" ng-model="item.title" ng-change="goDirty()"><a href="{{item.url}}" target="_blank" ng-if="item.pid > 0">查看</a>\x3c!-- <a href="##" ng-if="item.pid == 0" ng-click="deleteCustomItem($index)">删除</a> --\x3e<a href="##" ng-if="item.pid == 0 && !item.url" ng-click="addCustomLink($index)">添加链接</a><a href="##" ng-if="item.pid == 0 && item.url" ng-click="modifyCustomLink($index)">修改链接</a></div><div><input type="text" ng-model="item.lm_typename" ng-change="goDirty()"></div><div><input type="text" ng-model="item.price" ng-change="calculate()"></div><div><select class="item-count-select raw-select" ng-model="item.counts" ng-change="calculate()"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option></select></div><div><input type="text" ng-model="item.starttime" class="starttime"></div><div><input type="text" ng-model="item.endtime" class="endtime"></div><div><input type="text" value="" ng-model="item.note"  maxlength="200" ng-change="goDirty()"></div><div><span>{{((item.price * item.counts) || 0).toFixed(2)}}</span></div></div><h3 class="other_title" ng-if="otherTitle">其他</h3><div class="editable-item" ng-repeat="item in unpaidOrderData.productinfo" ng-hide="item.status == \'del\'" ng-if="item.type == 3"><div><input type="text" ng-model="item.title" ng-change="goDirty()"><a href="{{item.url}}" target="_blank" ng-if="item.pid > 0">查看</a>\x3c!-- <a href="##" ng-if="item.pid == 0" ng-click="deleteCustomItem($index)">删除</a> --\x3e<a href="##" ng-if="item.pid == 0 && !item.url" ng-click="addCustomLink($index)">添加链接</a><a href="##" ng-if="item.pid == 0 && item.url" ng-click="modifyCustomLink($index)">修改链接</a></div><div><input type="text" ng-model="item.lm_typename" ng-change="goDirty()"></div><div><input type="text" ng-model="item.price" ng-change="calculate()"></div><div><select class="item-count-select raw-select" ng-model="item.counts" ng-change="calculate()"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option></select></div><div><input type="text" ng-model="item.starttime" class="starttime" ></div><div><input type="text" ng-model="item.endtime" class="endtime"></div><div><input type="text" value="" ng-model="item.note" maxlength="200" ng-change="goDirty()"></div><div><span>{{((item.price * item.counts) || 0).toFixed(2)}}</span></div></div><div class="editable-item"><a href="##" class="add-custom" ng-click="addCustomItem()">＋添加自定义商品</a></div>\x3c!--  <div class="title" ng-if="unpaidOrderData.productinfo.length > 0"><div>折扣</div></div><div class="discount" ng-show="unpaidOrderData.productinfo.length > 0"><input type="checkbox" ng-model="$parent.enableDiscount" ng-change="calculate(true)" checkbox><input type="text" ng-disabled="!$parent.enableDiscount" ng-model="unpaidOrderData.discount" ng-change="calculate(true)"></div> --\x3e</div>\x3c!-- 已付款订单为空 --\x3e<div class="group" ng-if="!paidOrderData.length && tab == \'paid\'"><div class="empty"><span ng-if="!loading">暂无已付款订单</span><span ng-if="loading">加载中...</span></div></div>\x3c!-- 已付款订单 --\x3e<div class="group paid-bills"         ng-if="tab == \'paid\'"         ng-class="{true:\'editable\'}[role==1]"         ng-repeat="order in paidOrderData"><div class="title"><div class="name">名称</div><div class="type">产品类型</div><div class="price">单价</div><div class="count">数量</div><div class="starttime_text">开始时间</div><div class="endtime_text">结束时间</div><div class="note">备注</div><div class="tit_amount">小计</div>\x3c!-- <div class="amount">订单编号</div> --\x3e</div><div class="paid-item" ng-repeat="item in order.productinfo"><div class="name"><a href="{{item.url}}" target="_blank">{{item.title}}</a></div><div class="type">{{item.lm_typename}}</div><div class="price">{{item.price}}</div><div class="count">x{{item.counts}}</div><div class="starttime_text">{{item.starttime}}</div><div class="endtime_text">{{item.endtime}}</div><div class="note" ng-if="role==0" title="{{item.note}}">{{item.note}}</div><input class="note" type="text" ng-if="role==1" ng-model="item.note" ng-blur="saveNote(item)"><div class="tit_amount">{{((item.price * item.counts) || 0).toFixed(2)}}</div>\x3c!-- <div class="amount" ng-if="role==0">{{item.qyerno}}</div><input type="text" ng-if="role==1" ng-model="item.qyerno" ng-blur="saveOrderNumber(item)"> --\x3e</div><div class="subtotal"><div class="amount"><span>小计：CNY {{order.sale_amount}}</span><em>（{{order.paytime * 1000 | date:\'y年M月d日\'}}）</em></div></div></div></div></div><div class="pay" ng-if="unpaidOrderData.productinfo.length > 0 && tab == \'unpaid\' && role == 0"><span ng-if="$parent.enableDiscount">折后价：</span><span ng-if="!$parent.enableDiscount">总价：</span><span>{{unpaidOrderData.sale_amount}}元</span><del ng-if="$parent.enableDiscount">{{unpaidOrderData.amount}}元</del><a class="green" href="##" ng-click="payOrder()"><span ng-if="!paying">去支付</span><span ng-if="paying">处理中...</span></a></div><div class="pay" ng-if="tab == \'unpaid\' && role == 1"><span ng-if="$parent.enableDiscount">折后价：</span><span ng-if="!$parent.enableDiscount">总价：</span><span>{{unpaidOrderData.sale_amount}}元</span><del ng-if="$parent.enableDiscount">{{unpaidOrderData.amount}}元</del><span class="gray" ng-if="audit && needAudit">已审核</span><span class="gray" ng-if="!audit && needAudit">未审核</span><a class="orange" href="##" ng-click="confirm()" ng-if="dirtyFlag"><span ng-if="!saving">确认</span><span ng-if="saving">保存中...</span></a><a class="cancel" href="##" ng-click="cancel()" ng-if="dirtyFlag">取消</a></div><div class="pay" ng-if="tab == \'unpaid\' && op == 3">\x3c!-- op超级规划师 --\x3e<span ng-if="$parent.enableDiscount">折后价：</span><span ng-if="!$parent.enableDiscount">总价：</span><span>{{unpaidOrderData.sale_amount}}元</span><span class="gray" ng-if="audit && needAudit">已审核</span><span class="gray" ng-if="!audit && needAudit">未审核</span><span class="pass" ng-if="!dirtyFlag && !audit && needAudit && showPass ">通过</span><del ng-if="$parent.enableDiscount">{{unpaidOrderData.amount}}元</del><a class="orange" href="##" ng-click="confirm()" ng-if="dirtyFlag"><span ng-if="!saving">确认</span><span ng-if="saving">保存中...</span></a><a class="cancel" href="##" ng-click="cancel()" ng-if="dirtyFlag">取消</a></div><div id="pay-popup-check" class="pay-popup" style="display:none;"><h2>登录支付平台</h2><p>请在新打开的支付平台页面进行支付<br>支付完成前请不要关闭该窗口</p><a href="##" class="primary button">支付已完成</a><p><a href="##" class="link">支付遇到困难，返回再次尝试&gt;</a></p></div><div id="pay-popup-fail" class="pay-popup" style="display:none;"><h1>尚未支付成功</h1><p>支付未完成，请重新支付<br>为避免重复支付，请您查验是否已扣款</p><a href="##" class="primary button">我知道了</a></div>'
			}
		}
	]).controller("ToolbarCartController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			function o() {
				0 === t.role && a.broadcast("update-cart-icon")
			}

			function r() {
				t.loading = !0, t.unpaidOrderData = null, n.getOrderList({
					data: {
						plan_id: n.getPlanId(),
						status: 0,
						user_group: window.__plan_init_data__.user_group
					},
					onSuccess: function(i) {
						if ("[object Object]" === Object.prototype.toString.call(i.data)) {
							if (t.unpaidOrderData = i.data, t.showPass = i.data.productinfo && i.data.productinfo.length > 0 ? 1 : 0, t.audit = 1 == i.data.isaudit ? 1 : 0, t.needAudit = 0 == i.data.id ? 0 : 1, i.data.productinfo)
								for (var o = 0; o < i.data.productinfo.length; o++) 1 == i.data.productinfo[o].type ? t.discountTitle = !0 : 2 == i.data.productinfo[o].type ? t.hotleTitle = !0 : 3 == i.data.productinfo[o].type && (t.otherTitle = !0)
						} else t.unpaidOrderData = {};
						t.enableDiscount = 0, 0 == t.unpaidOrderData.discount && 1 === t.role && (t.unpaidOrderData.discount = 10), f = e.extend(!0, {}, t.unpaidOrderData), t.dirtyFlag = !1, a.toolbarLock = !1, t.loading = !1, t.$apply(), l(), e(".pass").click(function() {
							n.editisaudit({
								data: {
									plan_id: n.getPlanId(),
									id: i.data.id
								},
								onSuccess: function(e) {
									0 == e.error_code && (i.data.isaudit = 1, t.audit = i.data.isaudit, t.$apply())
								},
								onError: function(e) {}
							})
						})
					},
					onError: function(e) {
						t.loading = !1, t.$apply()
					}
				})
			}

			function s() {
				t.loading = !0, t.paidOrderData = null, n.getOrderList({
					data: {
						plan_id: n.getPlanId(),
						status: 1,
						user_group: window.__plan_init_data__.user_group
					},
					onSuccess: function(e) {
						"[object Array]" === Object.prototype.toString.call(e.data) ? t.paidOrderData = e.data : t.paidOrderData = [], t.loading = !1, t.$apply()
					},
					onError: function(e) {
						t.loading = !1, t.$apply()
					}
				})
			}

			function l() {
				setTimeout(function() {
					e(".planner-toolbar-cart select.raw-select").each(function(t, n) {
						e(n).removeClass("raw-select"), requirejs(["web_qui_quiselect", "web_old_textarea"], function(e) {
							new e({
								target: n
							})
						})
					}), e(".starttime,.endtime").datepicker({
						dayNamesMin: ["日", "一", "二", "三", "四", "五", "六"],
						monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
						dateFormat: "yy-mm-dd",
						changeYear: !0,
						changeMonthType: !0,
						onSelect: function(n) {
							e(this).change(), t.goDirty(), t.$apply()
						}
					})
				}, 0)
			}

			function c() {
				h.appendTo(document.body), u || (u = e(".planner-toolbar-cart #pay-popup-check")), u.appendTo(document.body).show().on("click", ".link", function() {
					u.off("click").remove(), h.remove()
				}).on("click", ".button", function() {
					e.ajax({
						url: "/api/v3/orders/paystatus",
						type: "post",
						async: !1,
						data: {
							plan_id: n.getPlanId(),
							order_id: t.unpaidOrderData.id
						},
						dataType: "json"
					}).done(function(e) {
						0 == e.error_code && 1 == e.data ? (h.remove(), u.off("click").remove(), t.tab = "paid", s(), t.$apply(), o()) : d()
					}).fail(function(e) {
						d()
					})
				})
			}

			function d() {
				u.off("click").remove(), p || (p = e(".planner-toolbar-cart #pay-popup-fail")), p.appendTo(document.body).show().on("click", ".button", function() {
					p.off("click").remove(), h.remove()
				})
			}
			var u, p, f, h = e("<div>").css({
				width: "100%",
				height: "100%",
				position: "absolute",
				background: "rgba(0, 0, 0, 0.5)",
				zIndex: 5e4
			});
			t.tab = "unpaid", t.op = window.__plan_init_data__.user_group, t.role = 2 == window.__plan_init_data__.user_group || 3 == window.__plan_init_data__.user_group ? 1 : 0, t.loading = !1, t.saving = !1, t.paying = !1, t.dirtyFlag = !1, t.addCustomItem = function() {
				t.otherTitle = !0, t.unpaidOrderData.productinfo.push({
					plan_id: n.getPlanId(),
					event_id: "0",
					pid: "0",
					title: "（自定义商品）",
					price: "0",
					counts: "1",
					total: "0",
					type: "3",
					lm_typename: "",
					starttime: "",
					endtime: "",
					note: ""
				}), t.goDirty(), l(), t.showPass = 1
			}, t.deleteCustomItem = function(e) {
				var n = t.unpaidOrderData.productinfo[e];
				n.id ? (n.counts = 0, n.status = "del") : t.unpaidOrderData.productinfo.splice(e, 1), t.calculate()
			}, t.addCustomLink = function(e) {
				var n = t.unpaidOrderData.productinfo[e],
					i = prompt("请输入链接");
				"" != i && (n.url = i, t.goDirty())
			}, t.modifyCustomLink = function(e) {
				var i = t.unpaidOrderData.productinfo[e],
					a = prompt("请输入链接", i.url);
				a != i.url && (i.url = a, n.modifyCustomLink({
					data: {
						plan_id: n.getPlanId(),
						id: i.id,
						url: a
					}
				}))
			}, t.goDirty = function() {
				t.dirtyFlag = !0, a.toolbarLock = !0, t.audit = 0
			}, t.clickUnpaidTab = function() {
				t.dirtyFlag || (t.tab = "unpaid", r())
			}, t.clickPaidTab = function() {
				t.dirtyFlag || (t.tab = "paid", s())
			}, t.calculate = function(e) {
				e || (t.unpaidOrderData.amount = _.reduce(t.unpaidOrderData.productinfo, function(e, t) {
					return t.price = t.price + "", t.price.indexOf(".") > -1 && (t.price = t.price.substr(0, t.price.indexOf(".") + 3)), e + (parseFloat(t.price) * parseFloat(t.counts) || 0)
				}, 0).toFixed(2)), t.unpaidOrderData.discount && (t.unpaidOrderData.discount = t.unpaidOrderData.discount + "", t.unpaidOrderData.discount.indexOf(".") > -1 && (t.unpaidOrderData.discount = t.unpaidOrderData.discount.substr(0, t.unpaidOrderData.discount.indexOf(".") + 2)), t.unpaidOrderData.discount > 10 && (t.unpaidOrderData.discount = 10)), t.enableDiscount && t.unpaidOrderData.discount > 0 ? t.unpaidOrderData.sale_amount = (t.unpaidOrderData.amount * t.unpaidOrderData.discount / 10).toFixed(2) : t.unpaidOrderData.sale_amount = t.unpaidOrderData.amount, t.dirtyFlag = !0, a.toolbarLock = !0
			}, t.cancel = function() {
				t.saving || (t.unpaidOrderData = e.extend(!0, {}, f), t.dirtyFlag = !1, a.toolbarLock = !1, t.audit = 0, l())
			}, t.confirm = function() {
				t.saving || (t.saving = !0, n.saveOrderList({
					data: {
						plan_id: n.getPlanId(),
						id: t.unpaidOrderData.id,
						discount: t.enableDiscount && 10 != t.unpaidOrderData.discount ? t.unpaidOrderData.discount : 0,
						status: 0,
						user_group: 1,
						products: t.unpaidOrderData.productinfo
					},
					onSuccess: function() {
						t.saving = !1, t.dirtyFlag = !1, a.toolbarLock = !1, a.showTip("保存成功！", "ok"), t.$apply(), e("#toolbar-editor").click()
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error"), t.saving = !1, t.$apply()
					}
				}))
			}, t.saveOrderNumber = function(e) {
				n.saveOrderNumber({
					data: {
						plan_id: n.getPlanId(),
						productinfo: [{
							id: e.id,
							qyerno: e.qyerno
						}]
					}
				})
			}, t.saveNote = function(e) {
				n.saveNote({
					data: {
						plan_id: n.getPlanId(),
						productinfo: [{
							id: e.id,
							note: e.note
						}]
					}
				})
			}, t.payOrder = function() {
				t.paying || (t.paying = !0, e.ajax({
					url: "/api/v3/orders/pay",
					type: "post",
					async: !1,
					data: {
						plan_id: n.getPlanId(),
						id: t.unpaidOrderData.id,
						token: t.unpaidOrderData.token
					},
					dataType: "json"
				}).done(function(t) {
					if (0 == t.error_code) {
						var n = e("<form>", {
							method: "POST",
							action: "https://pay.qyer.com",
							target: "_blank"
						});
						for (var i in t.data) e("<input>", {
							type: "hidden",
							name: i,
							value: t.data[i]
						}).appendTo(n);
						n.appendTo(document.body).submit(), setTimeout(function() {
							n.remove()
						}, 100), c()
					} else a.showTip(t.data.msg, "error")
				}).fail(function(e) {
					a.showTip("未知错误", "error")
				}).always(function(e) {
					t.paying = !1
				}))
			}, 1 === t.role || a.cartNumber > 0 ? t.clickUnpaidTab() : t.clickPaidTab()
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.colleague", []).directive("plannerToolbarColleague", [
		function() {
			return {
				restrict: "C",
				template: '<div class="planner-toolbar-panel-box"><section ng-if="isself"><div class="header"><ul><li ng-class="{true:\'active\'}[sort==\'account\']" ng-click="sort = \'account\'" data-bn-ipg="Planv3-partner-account">账号添加</li><li ng-class="{true:\'active\'}[sort==\'m2m\']" ng-click="sort = \'m2m\'" data-bn-ipg="Planv3-partner-QRcode">二维码邀请</li></ul></div><h2>他们将跟你一起出游</h2><div ng-if="loading">正在加载中...</div><div ng-if="!loading" class="users"><div class="item" ng-repeat="user in users"><div ng-if="user.static == 1"><a href="{{user.homepage}}" target="_blank"><img src="{{user.icon}}" alt=""></a><a href="{{user.homepage}}" target="_blank" title="{{user.name}}">{{user.name}}</a><span ng-if="user.authority == 1 || !user.authority" slide-dropdown="authorityOptions" data-uid="{{user.uid}}" data-fellowid="{{user.fellowid}}" data-index="{{$index}}"><i class="iconfont">&#58967;</i>允许浏览<span class="triangle"></span></span><span ng-if="user.authority == 2" slide-dropdown="authorityOptions" data-uid="{{user.uid}}" data-fellowid="{{user.fellowid}}" data-index="{{$index}}"><i class="iconfont">&#58966;</i>允许编辑<span class="triangle"></span></span></div><div ng-if="user.static == 0" class="email"><a href="javascript:;" target="_blank" title="{{user.mail}}">{{user.mail}}</a><span>待注册</span></div><i class="delete" data-static="{{user.static}}" data-uid="{{user.uid}}" data-fellowid="{{user.fellowid}}" data-index="{{$index}}" ng-click="delColleague($event)">删除</i></div></div><div ng-show="sort == \'account\'"><div class="add-user"><input id="add-colleague-input" type="text" autofocus placeholder="请输入昵称或邮箱"><button ng-click="confirmAdd($event)" ng-class="{\'loading\':confirmAddLoading}">确定</button><button ng-click="stopAdd($event)">取消</button><div class="autoCompleteBox"></div></div><div class="commend-list" ng-if="commends.length"><h2>推荐列表</h2><ul class="items"><div class="item" ng-repeat="item in commends"><a href="{{item.homepage}}" target="_blank"><img ng-src="{{item.icon}}" /></a>{{item.name}}<button ng-class="{true:\'active\'}[!!item.isAlong]" ng-click="changeAlong($event)">{{item.isAlong ? \'已添加\' : \'添加\'}}</button></div></ul></div></div><div ng-show="sort == \'m2m\'"><div class="m2m-img" id="m2m-qrcode"></div><div class="m2m-link" id="m2m-link"><input type="text" value="{{friendsUrl}}" /><button ng-click="selectTxt($event)" data-bn-ipg="Planv3-partner-QRcode-copy">复制链接</button></div></div></section><section ng-if="!isself"><h2>他们将跟你一起出游</h2><div ng-if="loading">正在加载中...</div><div ng-if="!loading" class="users"><div class="item " ng-repeat="user in users"><div ng-if="user.static == 1"><a href="{{user.homepage}}" target="_blank"><img src="{{user.icon}}" alt=""></a><a href="{{user.homepage}}" target="_blank" title="{{user.name}}">{{user.name}}</a><span ng-if="user.isAuthor == 1" class="text">行程主人</span><span ng-if="user.isAuthor != 1 && (user.authority == 1 || !user.authority)" class="text">允许浏览</span><span ng-if="user.isAuthor != 1 && user.authority == 2"  class="text">允许编辑</span></div><div ng-if="user.static == 0" class="email"><a href="javascript:;" target="_blank" title="{{user.mail}}">{{user.mail}}</a><span>待注册</span></div></div></div><div class="exit" ng-click="exitColleague($event)">      退出同行    </div></section></div>'
			}
		}
	]).controller("ToolbarColleagueController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a(a) {
				n.addColleague({
					data: {
						planid: n.getPlanId(),
						fellowname: a
					},
					onSuccess: function(n) {
						qyerUtil.doTrackCode("Planv3-partner-add");
						var a = n.data.user.static;
						t.$apply(function() {
							t.confirmAddLoading = 0, _.find(t.commends, function(e) {
								if (e.uid == n.data.user.uid) return e.fellowid = n.data.user.fellowid, e.isAlong = 1, !0
							}), t.users.push(n.data.user)
						}), i.showTip(a ? "添加同行成功！" : "已发送邮件邀请，对方通过该邮箱注册后将成为你的同行者", "ok", a ? 2e3 : 5e3), e("#add-colleague-input").val("")
					},
					onError: function(e) {
						t.$apply(function() {
							t.confirmAddLoading = 0
						}), i.showTip(e.data.msg, "error")
					}
				})
			}

			function o(e) {
				requirejs(["web_old_slidconfirm"], function(a) {
					a.confirm({
						text: "确认要删除同行者？",
						target: e.target,
						onOK: function() {
							n.removeColleague({
								data: {
									planid: n.getPlanId(),
									uid: e.uid,
									fellowid: e.fellowid,
									auth_type: 2,
									static: e.static,
									mail: ""
								},
								onSuccess: function(n) {
									i.showTip("删除同行成功！", "ok"), t.$apply(function() {
										_.find(t.commends, function(t) {
											if (t.uid == e.uid) return t.isAlong = 0, !0
										}), _.find(t.users, function(n, i) {
											if (n.uid == e.uid) return t.users.splice(i, 1), !0
										})
									})
								},
								onError: function(e) {
									i.showTip(e.data.msg, "error")
								}
							})
						}
					})
				})
			}

			function r(e, t) {
				var n = ['<div class="search-user-list">'];
				/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(e.val()) ? n.push('<div class="list-email">' + e.val() + "</div>") : n.push('<div class="search-title">' + t.data.msg + "</div>"), n.push('<ul class="qui-inputAutocomplete-ul">'), n.push("</ul>"), n.push("</div>"), e.qyerAutocomplete("pushHTML", n.join(""))
			}
			var s;
			t.sort = "account", t.service = i, t.friendsUrl = "http://plan.qyer.com/trip/" + n.getCodePlanId() + "/?fromjournalview=1&friends=" + n.getFriendsCode(), t.commends = [], t.isself = n.isSelf(), t.users = [], t.loading = !0, n.getPrivacySetting({
				data: {
					planid: n.getPlanId()
				},
				onSuccess: function(n) {
					t.$apply(function() {
						t.loading = !1, t.users = n.data.userlist, t.commends = n.data.commendlist || [], _.each(t.commends, function(e) {
							_.find(t.users, function(t) {
								if (e.uid == t.uid) return e.isAlong = 1, !0
							})
						}), e("#m2m-qrcode")[0] && (s = new QRCode("m2m-qrcode", {
							text: t.friendsUrl,
							width: 180,
							height: 180,
							colorDark: "#000000",
							colorLight: "#ffffff",
							correctLevel: QRCode.CorrectLevel.L
						}))
					})
				},
				onError: function(e) {
					i.showTip(e.data.msg, "error")
				}
			}), t.authorityOptions = {
				menu: [{
					label: "允许浏览",
					icon: "browser",
					action: function(e) {
						n.setPrivilege({
							data: {
								planid: n.getPlanId(),
								uid: e.uid,
								partnerid: e.fellowid,
								auth_type: 1
							},
							onSuccess: function() {
								i.showTip("保存设置成功！", "ok"), t.$apply(function() {
									t.users[e.index].authority = 1
								})
							},
							onError: function(e) {
								i.showTip(e.data.msg, "error")
							}
						})
					}
				}, {
					label: "允许编辑",
					icon: "edit",
					action: function(e) {
						n.setPrivilege({
							data: {
								planid: n.getPlanId(),
								uid: e.uid,
								partnerid: e.fellowid,
								auth_type: 2
							},
							onSuccess: function() {
								i.showTip("保存设置成功！", "ok"), t.$apply(function() {
									t.users[e.index].authority = 2
								})
							},
							onError: function(e) {
								i.showTip(e.data.msg, "error")
							}
						})
					}
				}, {
					label: "删除同行",
					icon: "trash-bin",
					action: function(t) {
						o({
							target: e(this).closest(".item"),
							fellowid: t.fellowid,
							uid: t.uid,
							static: 1
						})
					}
				}]
			}, require(["web_old_inputautocomplete"], function() {
				var i = e("#add-colleague-input");
				i.qyerAutocomplete({
					isAllowEmptySeach: !1,
					isFocusedSeach: !1,
					autoSelect: !0,
					parent: i.parent().find(".autoCompleteBox"),
					onSearch: function() {
						var a = e.trim(this.value);
						n.searchUser({
							data: {
								plan_id: n.getPlanId(),
								keyword: a
							},
							onSuccess: function(e) {
								var n = ['<div class="search-user-list">'];
								n.push('<ul class="qui-inputAutocomplete-ul">'), e.data.forEach(function(e, t) {
									var i = '<li> <img src="' + e.avatar + '" > <span>' + e.username + "</span></li>";
									n.push(i)
								}), t.results = e.data, n.push("</ul>"), n.push("</div>"), i.qyerAutocomplete("pushHTML", n.join(""))
							},
							onError: function(e) {
								r(i, e)
							}
						})
					}
				})
			}), t.stopAdd = function(t) {
				e("#add-colleague-input").val(""), t && t.preventDefault()
			}, t.changeAlong = function(t) {
				var n = this.item,
					i = {
						target: e(t.target).parent(),
						uid: n.uid,
						fellowid: n.fellowid,
						static: 1
					};
				n.isAlong ? (qyerUtil.doTrackCode("Planv3-partner-recommend-cancle"), o(i)) : (qyerUtil.doTrackCode("Planv3-partner-recommend-add"), a(n.name))
			}, t.confirmAddLoading = 0, t.confirmAdd = function(n) {
				if (!t.confirmAddLoading) {
					var i = e("#add-colleague-input");
					qyerUtil.doTrackCode("Planv3-partner-account-confirm"), t.confirmAddLoading = 1, a(i.val()), n && n.preventDefault()
				}
			}, t.$on("$destroy", function() {
				e("#add-colleague-input").qyerAutocomplete("destroy")
			}), t.selectTxt = function(t) {
				e(t.target).prev().focus().select();
				try {
					document.execCommand("copy"), i.showTip("复制成功", "ok")
				} catch (e) {
					i.showTip("请按 ctrl+c 或 ctrl+v 复制", "error")
				}
			}, t.delColleague = function(t) {
				var n = e(t.target);
				o({
					target: n,
					uid: n.data("uid"),
					fellowid: n.data("fellowid"),
					static: n.data("static")
				})
			}, t.exitColleague = function(t) {
				var a = {
						planid: n.getPlanId(),
						uid: QYER.uid
					},
					o = e(t.target);
				requirejs(["web_old_slidconfirm"], function(e) {
					e.confirm({
						text: "确认要退出同行",
						target: o,
						onOK: function() {
							n.exitColleague({
								data: a,
								onSuccess: function(e) {
									i.showTip("退出同行成功！", "ok"), setTimeout(function() {
										window.location.assign("/trip/" + n.getCodePlanId())
									}, 3e3)
								},
								onError: function(e) {
									i.showTip(e.data.msg, "error")
								}
							})
						}
					})
				})
			}
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.expend", []).filter("wanyuan", function() {
		return function(e) {
			return e >= 1e8 ? Math.floor(e / 1e6) / 100 + "亿" : e >= 1e4 ? Math.floor(e / 100) / 100 + "万" : Math.floor(100 * e) / 100
		}
	}).directive("plannerToolbarExpend", [
		function() {
			return {
				restrict: "C",
				template: '<div class="header"><ul><li ng-class="{true:\'active\'}[sort==\'byDay\']" ng-click="sort = \'byDay\'">按天数显示</li><li ng-class="{true:\'active\'}[sort==\'byType\']" ng-click="sort = \'byType\'">按类型显示</li></ul><div class="cost"><span>全部费用：{{currency}} {{totalCost / getExchangeRate(currency) | wanyuan}}</span><select name="currency" id="expend-currency-select" ng-model="currency" ng-init="currency = currencyList[0].unit_name"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}">{{currency.name}}</option></select></div></div><div class="content"><div class="add-item"><ul><li><span>日期：</span><select id="expend-date-select" ng-model="newItem.daynum" ng-init="newItem.daynum = $index + 1"><option value="{{$index + 1}}" ng-repeat="day in allDays">{{getDate($index)}}</option></select></li><li><span>名称：</span><input type="text" placeholder="请输入名称" ng-model="newItem.title" ng-init="newItem.title = \'\'"></li><li><span>单价：</span><input type="number" ng-keyup="spendkeyup($event)" ng-model="newItem.spend" style="width:55px;border-right:0;margin-right:0"><select id="expend-currency-select-2" ng-model="newItem.currency" ng-init="newItem.currency = currencyList[0].unit_name"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}">{{currency.name}}</option></select></li><li><span>数量：</span><select id="expend-count-select" ng-model="newItem.counts" ng-init="newItem.counts = 1"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></li></ul><button ng-click="add($event)" style="float:right;">+新增</button></div><div class="group" ng-repeat="day in listByDay" ng-if="sort == \'byDay\'"><div class="title"><div>第{{day.daynum}}天 CNY {{day.cost | wanyuan}}</div><div>单价</div><div>数量</div><div>总计</div></div><div class="item type-{{item.type}}" ng-repeat="item in day.items"><div><span class="block expend-iconfont">{{(item.type != 1) ? ({\'city\': \'&#58910;\', \'hotel\': \'&#58915;\', \'other\': \'&#58926;\'}[item.icon]) : ({\'plane\': \'&#58883;\', \'train\': \'&#58886;\', \'bus\': \'&#58881;\', \'car\': \'&#58882;\', \'steamer\': \'&#58880;\', \'other\': \'&#58884;\'}[item.icon])}}</span><span>{{item.title}}</span></div><div style="right:320px"><span ng-click="editCost($event, item)">{{item.currency}} {{item.spend | wanyuan}}</span><input type="text" ng-model="item.spend"><select id="edit-currency-by-date-{{item.id}}" ng-model="item.currency"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}" ng-selected="currency.unit_name === item.currency">{{currency.name}}</option></select></div><div style="right:160px"><span ng-click="editCount($event, item)">{{item.counts}}</span><select id="edit-count-by-date-{{item.id}}" ng-model="item.counts"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div><div style="right:0" ng-class="{true:\'multi-line\'}[item.currency !== \'CNY\']"><span>{{item.currency}} {{item.spend * item.counts | wanyuan}}</span><span ng-if="item.currency !== \'CNY\'">(折合CNY {{item.spend * getExchangeRate(item.currency) * item.counts | wanyuan}})</span></div><div class="remove" ng-if="item.type == 4" ng-click="remove($event, item)"></div></div></div><div class="group" ng-repeat="group in listByType" ng-if="sort == \'byType\'"><div class="title"><div>{{[\'\', \'交通\', \'景点\', \'住宿\', \'其他\', \'体验\', \'美食\', \'购物\'][group.type]}} CNY {{group.cost | wanyuan}}</div><div>单价</div><div>数量</div><div>总计</div></div><div class="item type-{{item.type}}" ng-repeat="item in group.items"><div><span class="block">D{{item.daynum}}</span><span>{{item.title}}</span></div><div style="right:320px"><span ng-click="editCost($event, item)">{{item.currency}} {{item.spend | wanyuan}}</span><input type="text" ng-model="item.spend"><select id="edit-currency-by-type-{{item.id}}" ng-model="item.currency"><option ng-repeat="currency in currencyList" value="{{currency.unit_name}}" ng-selected="currency.unit_name === item.currency">{{currency.name}}</option></select></div><div style="right:160px"><span ng-click="editCount($event, item)">{{item.counts}}</span><select id="edit-count-by-type-{{item.id}}" ng-model="item.counts"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div><div style="right:0" ng-class="{true:\'multi-line\'}[item.currency !== \'CNY\']"><span>{{item.currency}} {{item.spend * item.counts | wanyuan}}</span><span ng-if="item.currency !== \'CNY\'">(折合CNY {{item.spend * getExchangeRate(item.currency) * item.counts | wanyuan}})</span></div><div class="remove" ng-if="item.type == 4" ng-click="remove($event, item)"></div></div></div></div>'
			}
		}
	]).controller("ToolbarExpendController", ["$scope", "$api", "$filter", "plannerService",
		function(t, n, i, a) {
			function o() {
				var e, n = _.groupBy(c, function(e) {
						return e.daynum
					}),
					i = _.groupBy(c, function(e) {
						return e.type
					});
				t.listByDay = [], t.listByType = [];
				for (e in n) 0, t.listByDay.push({
					daynum: e,
					cost: n[e].map(function(e) {
						return parseFloat(e.spend_rmb * e.counts)
					}).reduce(function(e, t) {
						return e + t
					}),
					items: n[e]
				});
				for (e in i) 0, t.listByType.push({
					type: i[e][0].type,
					cost: i[e].map(function(e) {
						return parseFloat(e.spend_rmb * e.counts)
					}).reduce(function(e, t) {
						return e + t
					}),
					items: _.sortBy(i[e], "daynum")
				})
			}

			function r() {
				t.listByDay.forEach(function(e) {
					e.cost = e.items.map(function(e) {
						return parseFloat(e.spend_rmb * e.counts)
					}).reduce(function(e, t) {
						return e + t
					})
				}), t.listByType.forEach(function(e) {
					e.cost = e.items.map(function(e) {
						return parseFloat(e.spend_rmb * e.counts)
					}).reduce(function(e, t) {
						return e + t
					})
				})
			}

			function s(e) {
				n.saveBudget({
					data: {
						planid: n.getPlanId(),
						data: {
							doedit: [e]
						}
					},
					onSuccess: function(n) {
						t.$apply(function() {
							t.totalCost = n.data, r()
						}), e.oneday_id == a.selectedDay.object.id && a.setSelectedDay(), a.showTip("保存成功！", "ok")
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				})
			}

			function l() {
				n.getBudget({
					data: {
						planid: n.getPlanId()
					},
					onSuccess: function(e) {
						c = e.data.budgetlist, _.each(c, function(e) {
							e.title = a.decodeHTML(e.title)
						}), t.totalCost = c.map(function(e) {
							return parseFloat(e.spend_rmb * e.counts)
						}).reduce(function(e, t) {
							return e + t
						}), o(), t.$apply()
					},
					onError: function(e) {
						a.showTip(e.data.msg, "error")
					}
				})
			}
			var c = [],
				d = i("date"),
				u = !1;
			t.getExchangeRate = n.getExchangeRate, t.currencyList = n.getCurrencyList(), t.sort = "byDay", t.totalCost = 0, t.allDays = a.allDays, t.newItem = {
				daynum: 1,
				type: 4,
				icon: "other"
			}, t.spendkeyup = function(n) {
				var i = e(n.target);
				if (i.val()) {
					var a = i.val().replace(/([0-9]+\.[0-9]{2})[0-9]*/, "$1");
					t.newItem.spend = parseFloat(a)
				}
			}, requirejs(["web_qui_quiselect", "web_old_textarea"], function(e) {
				new e({
					target: "#expend-currency-select"
				}), new e({
					target: "#expend-currency-select-2"
				}), new e({
					target: "#expend-date-select"
				}), new e({
					target: "#expend-count-select"
				})
			}), t.listByDay = [], t.listByType = [], l(), t.getDate = function(e) {
				var t, i, o = n.getStartDate(),
					r = "第" + (e + 1) + "天",
					s = a.allDays[e];
				return o && (t = new Date(o.getTime() + 864e5 * e), r += d(t, "(M.d)")), i = s.city_list && s.city_list.length ? s.city_list.map(function(e) {
					return e.name
				}).join(",") : "暂无安排", r + " " + i
			}, t.add = function(i) {
				if (!u) {
					u = !0;
					var r = e.extend({}, t.newItem);
					if (!r.title) return u = !1, void a.showTip("请输入名称！");
					if (!r.spend) return u = !1, void a.showTip("请输入单价！");
					if (!/^\d+(?:\.\d{1,2})?$/.test(r.spend)) return u = !1, void a.showTip("请输入正确的价格！");
					r.oneday_id = a.allDays[r.daynum - 1].id, "CNY" !== r.currency ? r.spend_rmb = n.getExchangeRate(r.currency) * r.spend : r.spend_rmb = r.spend, r.totalspend_rmb = r.spend_rmb * r.counts, c.push(r), o(), n.saveBudget({
						data: {
							planid: n.getPlanId(),
							data: {
								doadd: [r]
							}
						},
						onSuccess: function(e) {
							u = !1, qyerUtil.doTrackCode("Planv3-cost-add"), t.$apply(function() {
								t.totalCost = e.data, t.newItem.title = "", t.newItem.spend = ""
							}), l(), a.showTip("保存成功！", "ok")
						},
						onError: function(e) {
							u = !1, a.showTip(e.data.msg, "error"), t.$apply(function() {
								c.pop(), o()
							})
						}
					})
				}
			}, t.remove = function(e, i) {
				a.showConfirm("确认要删除此条预算？", e.target.parentNode, function() {
					var e, r = -1;
					c.forEach(function(e, t) {
						e === i && (r = t)
					}), r > -1 && (t.$apply(function() {
						e = c.splice(r, 1)[0], o()
					}), n.saveBudget({
						data: {
							planid: n.getPlanId(),
							data: {
								dodel: [e.id]
							}
						},
						onSuccess: function(e) {
							t.$apply(function() {
								t.totalCost = e.data
							}), i.oneday_id == a.selectedDay.object.id && a.setSelectedDay(), a.showTip("保存成功！", "ok")
						},
						onError: function(n) {
							t.$apply(function() {
								c.splice(r, 0, e), o()
							}), a.showTip(n.data.msg, "error")
						}
					}))
				})
			}, t.editCount = function(t, n) {
				var i = e(t.target).hide(),
					a = i.next(),
					o = !1;
				requirejs(["web_qui_quiselect"], function(t) {
					var r = new t({
						target: "#" + a.attr("id"),
						onChange: function() {
							o = !0
						}
					});
					e(document.body).on("click.editCount", function(t) {
						e(t.target).closest(".qui-select").is(r._$ui) || (o && (n.totalspend_rmb = n.spend_rmb * n.counts, s(n)), r.destroy(), a.hide(), i.show(), e(document.body).off("click.editCount"))
					})
				}), t.preventDefault()
			}, t.editCost = function(t, i) {
				var o = e(t.target).hide(),
					r = o.next().show(),
					l = r.next(),
					c = !1;
				r.one("change", function() {
					c = !0
				}), requirejs(["web_qui_quiselect"], function(t) {
					var d = new t({
						target: "#" + l.attr("id"),
						onChange: function() {
							c = !0
						}
					});
					e(document.body).on("click.editCost", function(t) {
						if (!e(t.target).closest(".qui-select").is(d._$ui) && t.target !== r.get(0)) {
							if (!/^\d+(?:\.\d{1,2})?$/.test(i.spend)) return void a.showTip("请输入正确的价格！");
							c && (i.spend_rmb = i.spend * n.getExchangeRate(i.currency), i.totalspend_rmb = i.spend_rmb * i.counts, s(i)), d.destroy(), r.hide(), l.hide(), o.show(), e(document.body).off("click.editCost")
						}
					})
				})
			}
		}
	])
}(jQuery),
function() {
	"use strict";
	angular.module("planner-toolbar", ["planner-toolbar.nav", "planner-toolbar.panel"]).directive("plannerToolbar", [
		function() {
			return {
				restrict: "A",
				template: '<nav class="planner-toolbar-nav" ng-controller="ToolbarNavController"></nav><div class="planner-toolbar-panel" ng-controller="ToolbarPanelController"></div>'
			}
		}
	])
}(),
function(e) {
	"use strict";
	angular.module("planner-toolbar.journal", []).directive("plannerToolbarJournal", [
		function() {
			return {
				restrict: "C",
				template: '<iframe src="{{src}}"></iframe><div id="journal-intro"><div><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/journal_intro.png" alt=""/><p>用最简单的方式纪录出行的每个瞬间</p><div class="primary button">行程游记</div><div class="close">&#xe653;</div></div></div>'
			}
		}
	]).controller("ToolbarJournalController", ["$scope", "$api",
		function(t, n) {
			t.src = "/journal/" + window.__plan_init_data__.codeplan_id, window.__update_start_date__ = function(e) {
				n.setStartDate(e)
			}, localStorage.getItem("journal/" + QYER.uid) || (localStorage.setItem("journal/" + QYER.uid, !0), e("#wrapper").addClass("blur"), e("#journal-intro").appendTo(document.body).on("click", ".close, .button", function() {
				e("#journal-intro").remove(), e("#wrapper").removeClass("blur")
			}).show())
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.nav", []).directive("plannerToolbarNav", [
		function() {
			return {
				restrict: "C",
				template: '<ul class="fixed-menu"><li id="toolbar-setting-button" ng-show="service.navType !== \'journal\'" ng-click="changeType(\'setting\')" ng-class="{true:\'active\'}[service.navType == \'setting\']" data-bn-ipg="Planv3-toolbar-setting" data-help-index="9|14" data-help-direction="left|left" data-help-content="点击这里修改行程名称或封面|点击这里，然后勾选隐私设置"><em class="icon setting-icon"><span class="iconfont">&#xe6bc;</span></em><em class="text">设置</em><div ng-if="isShowUpdateTip" class="update-tip">隐私设置移到这里啦</div></li><li id="toolbar-editor" ng-show="service.navType === \'journal\'" ng-click="changeType(\'edit\')" ng-class="{true:\'active\'}[service.navType == \'edit\']"><em class="icon edit-icon" data-bn-ipg="Planv3-toolbar-editor"><span class="iconfont">&#xe6b9;</span></em><em class="text">编辑</em></li><li ng-show="service.navType !== \'journal\'"      ng-repeat="widget in service.currentWidgets"      ng-click="changeType({3:\'calendar\', 4:\'expend\', 5:\'colleague\', 8:\'question\', 9:\'journal\'}[widget.id])"      ng-class="{true:\'active\'}[service.navType == {3:\'calendar\', 4:\'expend\', 5:\'colleague\', 8:\'question\', 9:\'journal\'}[widget.id]]"      data-help-index="{{{4: 15, 5: 13}[widget.id]}}"      data-help-direction="{{{4: \'left\', 5: \'left\'}[widget.id]}}"      data-help-content="{{{4: \'在这里哦\', 5: \'在这里哦。添加了同行者后，可以把对方设置为允许编辑\'}[widget.id]}}"><em class="icon" ng-class="{3:\'calendar-icon\', 4:\'expend-icon\', 5:\'colleague-icon\', 8:\'question-icon\', 9:\'journal-icon\'}[widget.id]"><span class="iconfont" ng-if="widget.id == 3">&#xe6bb;</span><span class="iconfont" ng-if="widget.id == 4">&#xe6ba;</span><span class="iconfont" ng-if="widget.id == 5">&#xe6bd;</span><span class="iconfont" ng-if="widget.id == 8">&#xe69c;</span><span class="iconfont" ng-if="widget.id == 9">&#59070;</span></em><em class="text">{{ {3:\'日历\', 4:\'花费\', 5:\'同行\', 8:\'问答\', 9:\'游记\'}[widget.id] }}</em></li><li id="expand-toolbar" ng-show="service.navType !== \'journal\'" style="display:none"><em class="icon expand-icon"><span class="iconfont">&#xe634;</span></em><em class="text">展开</em></li><li id="collapse-toolbar" ng-show="service.navType !== \'journal\'" style="display:none"><em class="icon collapse-icon"><span class="iconfont">&#xe635;</span></em><em class="text">收起</em></li></ul><ul class="float-menu"></ul>'
			}
		}
	]).controller("ToolbarNavController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a() {
				n.getCartStatus({
					data: {
						plan_id: n.getPlanId()
					},
					onSuccess: function(e) {
						(e.data.paid > 0 || e.data.unpaid > 0) && (t.showCart = !0, t.cartNumber = e.data.unpaid, i.cartNumber = t.cartNumber, t.$apply())
					}
				})
			}

			function o() {
				e("#toolbar-setting-button, #toolbar-editor, #toolbar-preview, #toolbar-journal, #toolbar-cart").prependTo(r.find("> ul.fixed-menu")), e("#expand-toolbar,#collapse-toolbar").appendTo(r.find("> ul.fixed-menu"));
				var t, n, i = r.find("> ul > li").size() - 2,
					a = e(window).height() + 30;
				89 * i > a ? (t = Math.floor(a / 89) - 1, n = r.find("> ul > li").filter(function(e, t) {
					return "expand-toolbar" !== t.id && "collapse-toolbar" !== t.id
				}).filter(function(e, n) {
					return e >= t
				}).appendTo(r.find("> ul.float-menu")), r.find("> ul.float-menu").css("top", -(89 * n.size() + 1) + "px"), r.find("> ul > li").not(n).insertBefore(e("#expand-toolbar")), l ? (e("#collapse-toolbar").show(), e("#expand-toolbar").hide(), r.find("> ul.float-menu").show()) : (e("#collapse-toolbar").hide(), e("#expand-toolbar").show(), r.find("> ul.float-menu").hide())) : (r.find("> ul.float-menu").hide().find("> li").appendTo(r.find("> ul.fixed-menu")), e("#expand-toolbar, #collapse-toolbar").hide())
			}
			var r = e("#wrapper > aside > nav"),
				s = 2 == window.__plan_init_data__.user_group || 3 == window.__plan_init_data__.user_group ? 1 : 0,
				l = !1;
			t.role = s, t.isLogin = window.QYER.uid > 0, t.showCart = !1, t.cartNumber = 0, t.service = i, t.url = "/trip/" + n.getCodePlanId() + "/?fromjournalview=1", t.changeType = function(e) {
				if (!i.toolbarLock) {
					if (e === i.navType && "edit" !== e && (e = "edit"), !t.isLogin && "edit" !== e) return void window.qyerUtil.doLogin();
					if ("journal" === e && !n.isSelf()) return void i.showTip("只有行程作者可以编写游记", "warning");
					"setting" === e && (t.isShowUpdateTip = !1), "question" == e ? qyerUtil.doTrackCode("planv3-toolbar-ask") : "calendar" == e ? qyerUtil.doTrackCode("planv3-toolbar-calendar") : "expend" == e ? qyerUtil.doTrackCode("planv3-toolbar-cost") : "colleague" == e ? qyerUtil.doTrackCode("planv3-toolbar-partner") : "edit" == e ? qyerUtil.doTrackCode("Planv3-toolbar-editor") : "journal" == e && qyerUtil.doTrackCode("Planv3-toolbar-journal"), i.changeNavType(e)
				}
			}, n.getWidget({
				data: {
					plan_id: n.getPlanId()
				},
				onSuccess: function(e) {
					t.$apply(function() {
						i.widgets = e.data.bind_nwidgets, i.currentWidgets = e.data.bind_nwidgets.filter(function(e) {
							return e.id > 2 && 6 != e.id
						}), i.availableWidgets = e.data.unbind_nwidgets.filter(function(e) {
							return e.id > 2 && 6 != e.id
						})
					}), o()
				}
			}), s ? t.showCart = !0 : a(), t.$on("update-cart-icon", a), e(window).resize(_.throttle(o, 100)), setTimeout(o, 0), r.on("mouseenter", "#expand-toolbar,.float-menu", function() {
				r.find("> ul.float-menu").show(), e("#collapse-toolbar").show(), e("#expand-toolbar").hide(), l = !0
			}).on("mouseleave", ".float-menu,#collapse-toolbar", function() {
				r.find("> ul.float-menu").hide(), e("#collapse-toolbar").hide(), e("#expand-toolbar").show(), l = !1
			}), t.$on("update-toolbar", o), window.location.hash.indexOf("journal") > -1 && (window.location.assign("#"), setTimeout(function() {
				e("#toolbar-journal").click()
			}, 100))
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.panel", ["planner-toolbar.setting", "planner-toolbar.colleague", "planner-toolbar.calendar", "planner-toolbar.expend", "planner-toolbar.question", "planner-toolbar.cart", "planner-toolbar.journal"]).directive("plannerToolbarPanel", [
		function() {
			return {
				restrict: "C",
				template: '<div class="planner-toolbar-setting" ng-controller="ToolbarSettingController" ng-if="service.navType == \'setting\'"></div><div class="planner-toolbar-colleague" ng-controller="ToolbarColleagueController" ng-if="service.navType == \'colleague\'"></div><div class="planner-toolbar-calendar" ng-controller="ToolbarCalendarController" ng-if="service.navType == \'calendar\'"></div><div class="planner-toolbar-expend" ng-controller="ToolbarExpendController" ng-if="service.navType == \'expend\'"></div><div class="planner-toolbar-question" ng-controller="ToolbarQuestionController" ng-if="service.navType == \'question\'"></div><div class="planner-toolbar-cart" ng-controller="ToolbarCartController" ng-if="service.navType == \'cart\'"></div><div class="planner-toolbar-journal" ng-controller="ToolbarJournalController" ng-if="service.navType == \'journal\'"></div>'
			}
		}
	]).controller("ToolbarPanelController", ["$scope", "plannerService",
		function(t, n) {
			var i = e("#wrapper > aside"),
				a = i.children(".planner-toolbar-panel"),
				o = e("<div>", {
					class: "mask"
				});
			t.service = n, t.$on("nav-type-changed", function() {
				if (n.navType && "edit" !== n.navType) {
					switch (n.navType) {
						case "expend":
							i.css("width", "890px"), a.css("width", "826px");
							break;
						case "journal":
							i.css("width", "100%"), a.css("width", "calc(100% - 64px)");
							break;
						case "cart":
							e(document).width() < 1022 ? (i.css("width", "1024px"), a.css("width", "961px"), a.addClass("planner-small")) : (i.css("width", "1085px"), a.css("width", "1022px"));
							break;
						case "calendar":
							i.css("width", "774px"), a.css("width", "710px");
							break;
						default:
							i.css("width", ""), a.css("width", "")
					}
					i.addClass("open"), o.appendTo(document.body).on("click", function() {
						e("#toolbar-editor").click()
					})
				} else i.css("width", "").removeClass("open"), a.css("width", ""), o.off("click").remove()
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.question", []).directive("plannerToolbarQuestion", [
		function() {
			return {
				restrict: "C",
				template: '<div class="question-top"><span class="iconfont">&#xe69c;</span><em>行程求助</em><br> 向五千万穷游er提问，95%的问题都会在一个小时内获得回答</div><div class="question-box"><p class="question-title">标题</p><div class="textarea-wrapper" data-width="363" data-height="58"><textarea placeholder="请输入完整清晰的问题" maxlength="50" class="question-title-textarea"></textarea><div class="redtxt"><span class="iconfont">&#58921;</span>请填写提问标题</div><div class="tips"><span class="current"></span>/<span class="max"></span>字    </div></div><p style="margin:10px 0 20px 0;">可以这样问：<br>从马德里到巴塞罗那是坐火车还是飞机好？<br>我的行程这样安排是否合理？<br></p><p class="question-title">内容详情</p><div class="textarea-cont" data-width="363" data-height="130"><textarea placeholder="在这里添加详细内容" maxlength="1000" class="question-conts-textarea"></textarea><div class="redtxt"><span class="iconfont">&#58921;</span>请填写提问内容</div><div class="tips"><span class="current"></span>/<span class="max"></span>字    </div></div><p class="question-title">标签</p><div class="target"><div class="addtarget" id ="addtarget"><div class="addtxt"><span class="iconfont">&#58943;</span>添加标签</div><input type="text" name="target" class="targetinput"><div class="targetlist"><ul><li></li></ul></div></div>\x3c!-- <span class="targetbox"><span class="tagtxt">台湾 </span><span class="iconfont">&#58963;</span></span> --\x3e</div><div class="bbslist"><div class="bbstxt"><span class="bbsval"></span><span class="bbstip">选择同时发布的论坛页面</span><span class="iconfont">&#58928;</span></div><div class="bbslayer">\x3c!-- <dl><dd>穷游欧洲</dd></dl>      --\x3e</div><div class="bbsmark"></div><div class="loading">loading</div></div><p class="">行程会自动附在问题末尾</p></div><div class="question-btn"><button data-bn-ipg="planv3-toolbar-ask-question">提交问题</button></div><div class="questioned"><h3 class="qtitle"><span class="iconfont">&#58985;</span>已提出问题</h3><ul class="question-bot ren-bot">\x3c!-- <li><span class="fr"><span class="iconfont">&#58984;</span>1条回复</span>我的行程靠谱吗？请大家帮我看看~</li><li><span class="fr"><span class="iconfont">&#58984;</span>1条回复</span>我的行程靠谱吗？请大家帮我看看~</li> --\x3e</ul></div><h3 class="qtitle"><span class="iconfont">&#58983;</span>常见问题</h3><ul class="question-bot"><li><a href="https://bbs.qyer.com/post.php?action=jump&pid=13246284" target="_blank">1. 如何修改出发日期？</a></li><li><a href="https://bbs.qyer.com/post.php?action=jump&pid=13246325" target="_blank">2. 如何保存行程？</a></li><li><a href="https://bbs.qyer.com/post.php?action=jump&pid=13246348" target="_blank">3. 如何添加景点？</a></li><li><a href="https://bbs.qyer.com/post.php?action=jump&pid=13246365" target="_blank">4. 如何添加酒店？</a></li><li><a href="https://bbs.qyer.com/post.php?action=jump&pid=13246369" target="_blank">5. 如何查看每日地图？</a></li></ul><div class="mark"></div><div class="successlayer"><div class="iconfont">&#58979;</div><span>问题提交成功 </span>  问题得到新的回答，将通过站内通知提醒你哦！  <div class="successbtns"><a href="＃" target="_blank">查看问题</a><a href="javascript:void(0)" class="gbtns">朕知道了</a></div></div><div class="errorlayer"><div class="iconfont">&#58982;</div><span>问题提交失败</span><em>请检查网络连接后重试</em></div>'
			}
		}
	]).controller("ToolbarQuestionController", ["$scope", "$api", "plannerService",
		function(t, n, i) {
			function a(t) {
				var n = '<span class="targetbox"><span class="tagtxt">' + t + '</span><span class="iconfont">&#58963;</span></span>';
				e(".planner-toolbar-question .target").append(n), e(".target .targetbox").length < 5 ? e(".addtarget").show() : e(".addtarget").hide(), i.QuestLoading = !0, i.question.target = e(".target").html()
			}
			setTimeout(function() {
				"在这里添加详细内容" == e(".question-conts-textarea").val() && (e(".question-conts-textarea").val(""), e(".textarea-cont .current").text("0")), "请输入完整清晰的问题" == e(".question-title-textarea").val() && (e(".question-title-textarea").val(""), e(".textarea-wrapper .current").text("0"))
			}, 100), e(".bbstxt").click(function() {
				e(".bbslist .loading").show(), e(".bbstxt").hide(), e(".bbslayer").html(""), e.ajax({
					url: "/qcross/bbs/thread.php?action=getForums",
					type: "get",
					dataType: "json",
					success: function(t) {
						var n;
						for (var i in t.data) {
							if (n = "", "后院" != i && "线上线下" != i && "穷游兴趣小组" != i)
								for (var a = 0; a < t.data[i].length; a++) n += "<dd data-id=" + t.data[i][a].id + ">" + t.data[i][a].name + "</dd>";
							var n = "<dl>" + n + "</dl>";
							e(".bbslayer").append(n)
						}
						e("body").append(e(".bbsmark")), e("body").append(e(".bbslayer")), e(".bbslist .loading").hide(), e(".bbstxt").show(), e(".bbslayer").show(), e(".bbsmark").show()
					},
					error: function(e) {}
				})
			}), e(".bbslayer").delegate("dd", "click", function() {
				var t = e(this).text();
				e(".bbslayer").hide(), e(".bbsmark").hide(), e(".bbstip").hide(), e(".bbsval").text(t), e(".bbsval").attr("data-id", e(this).attr("data-id")), i.QuestLoading = !0, i.question.bbsval = e(".bbslist").html()
			}), e(".bbsmark").click(function() {
				e(".bbslayer").hide(), e(".bbsmark").hide()
			}), e(".question-conts-textarea").blur(function() {
				e(".question-conts-textarea").val() ? (i.QuestLoading = !0, i.question.content = e(this).val(), e(this).next(".redtxt").hide(), e(this).css({
					"border-color": "#5a6767"
				})) : (e(this).next(".redtxt").show(), e(this).css({
					"border-color": "#f1b158"
				}))
			}), e(".question-conts-textarea").keyup(function() {
				e(this).val() ? (e(this).next(".redtxt").hide(), e(this).css({
					"border-color": "#5a6767"
				})) : (e(this).next(".redtxt").show(), e(this).css({
					"border-color": "#f1b158"
				})), setTimeout(function() {
					"1000" == parseInt(e(".textarea-cont .current").text()) ? e(".textarea-cont .current").css({
						color: "#ff0000"
					}) : e(".textarea-cont .current").css({
						color: "#c0c5c7"
					})
				}, 200)
			}), e(".question-title-textarea").keyup(function() {
				e(this).val() ? (e(this).next(".redtxt").hide(), e(this).css({
					"border-color": "#5a6767"
				})) : (e(this).next(".redtxt").show(), e(this).css({
					"border-color": "#f1b158"
				})), setTimeout(function() {
					50 == parseInt(e(".textarea-wrapper .current").text()) ? e(".textarea-wrapper .current").css({
						color: "#ff0000"
					}) : e(".textarea-wrapper .current").css({
						color: "#c0c5c7"
					})
				}, 200)
			}), e(".question-title-textarea").blur(function() {
				var t = e(this).val();
				t ? (i.QuestLoading = !0, i.question.title = e(this).val(), e(this).next(".redtxt").hide(), e(this).css({
					"border-color": "#5a6767"
				}), e.ajax({
					url: "/ajax.php?action=maketag&ispopup=1&returnjson=1",
					data: {
						title: t
					},
					type: "post",
					dataType: "json",
					success: function(t) {
						if (0 == t.error_code && t.data)
							for (var n = !0, i = 0; i < t.data.length; i++)
								if (e(".target .targetbox").length) {
									for (var o = 0; o < e(".target .targetbox").length; o++) t.data[i] == e(".target .targetbox").eq(o).children(".tagtxt").text() && (n = !1);
									n && a(t.data[i])
								} else a(t.data[i])
					},
					error: function(e) {}
				})) : (e(this).next(".redtxt").show(), e(this).css({
					"border-color": "#f1b158"
				}))
			}), e(".planner-toolbar-question .target").delegate(".addtxt", "click", function() {
				e(".target .targetinput").show().focus(), e(window).off("click.question"), e(window).on("click.question", function(t) {
					e(t.target).closest("#addtarget").size() > 0 || (e(".targetlist").hide(), e(".target .targetinput").val("").hide(), e(window).off("click.question"))
				}), e(".target .targetinput").keyup(function() {
					e(".targetlist li").remove(), e(".targetlist").show();
					var t = e(this).val();
					e.ajax({
						url: "/ajax.php?action=TopicMenu",
						data: {
							keyword: t
						},
						type: "post",
						dataType: "json",
						success: function(t) {
							if (e(".targetlist li").remove(), 0 == t.error_code)
								if (t.data.item.length)
									for (var n = 0; n < t.data.item.length; n++) {
										var i = "<li>" + t.data.item[n] + "</li>";
										e(".targetlist ul").append(i)
									} else e(".targetlist ul").append("<li class='dono'>暂无该标签</li>")
						},
						error: function(e) {}
					})
				})
			}), e(".planner-toolbar-question .target").delegate(".targetlist li:not(.dono)", "click", function() {
				var t = e(this).text();
				if (e(".target .targetbox").length) {
					for (var n = !0, i = 0; i < e(".target .targetbox").length; i++) t == e(".target .targetbox").eq(i).children(".tagtxt").text() && (n = !1);
					n && a(t)
				} else a(t);
				e(".targetlist").hide(), e(".target .targetinput").val("").hide()
			}), e(".planner-toolbar-question .target").delegate(".iconfont", "click", function() {
				e(this).parent(".targetbox").remove(), e(".addtarget").show()
			}), e(".successbtns .gbtns").click(function() {
				e(".successlayer").hide(), e(".planner-toolbar-question .mark").hide(), e("aside nav li").eq(0).click()
			}), e(".question-btn button").click(function() {
				for (var t = e(".question-title-textarea").val(), a = e(".question-conts-textarea").val(), o = new Array, r = 0; r < e(".target .targetbox").length; r++) o.push(e(".target .targetbox").eq(r).children(".tagtxt").text());
				var s = n.getPlanId(),
					l = e(".bbsval").attr("data-id");
				t && a ? (e(".question-btn button").text("提交中..."), e(".question-btn").addClass("loading"), e.ajax({
					url: "/api/v3/ask/askadd",
					data: {
						title: t,
						content: a,
						tag: o,
						planid: s,
						fid: l,
						from: 40
					},
					type: "post",
					dataType: "json",
					success: function(t) {
						i.QuestLoading = !1, 0 == t.error_code ? (e(".planner-toolbar-question .mark").show(), e(".successbtns a").eq(0).attr("href", t.data.asklink), e(".successlayer").show()) : (e(".errorlayer em").text(t.data.msg), e(".errorlayer").fadeIn(), setTimeout(function() {
							e(".errorlayer").fadeOut()
						}, 2e3))
					},
					error: function(t) {
						e(".errorlayer em").text("请检查网络连接后重试"), e(".errorlayer").fadeIn(), setTimeout(function() {
							e(".errorlayer").fadeOut()
						}, 2e3)
					},
					complete: function() {
						e(".question-btn button").text("提交问题"), e(".question-btn").removeClass("loading")
					}
				})) : t || (e(".question-title-textarea").next(".redtxt").show(), e(".question-title-textarea").css({
					"border-color": "#f1b158"
				})), a || (e(".question-conts-textarea").next(".redtxt").show(), e(".question-conts-textarea").css({
					"border-color": "#f1b158"
				}))
			}), e.ajax({
				url: "/api/v3/ask/getasklist",
				data: {
					planid: n.getPlanId()
				},
				type: "post",
				dataType: "json",
				success: function(t) {
					if (0 == t.error_code) {
						for (var n = 0; n < t.data.length; n++)
							if (n < 5) {
								var i = "<li><span class='fr'><span class= 'iconfont'>&#58984;</span>" + t.data[n].renum + "条回复</span><a href=" + t.data[n].asklink + " target='_blank'>" + t.data[n].title + "</li>";
								e(".ren-bot").append(i)
							}
						e(".questioned").show()
					} else e(".questioned").hide()
				},
				error: function(e) {}
			}), i.QuestLoading && (i.question.title && e(".question-title-textarea").val(i.question.title), i.question.content && e(".question-conts-textarea").val(i.question.content), i.question.target && e(".target").html(i.question.target), i.question.bbsval && e(".bbslist").html(i.question.bbsval)), requirejs(["web_old_textarea"], function() {
				e(".question-box .textarea-wrapper").qyerTextArea({
					max: 50
				}), e(".question-box .textarea-cont").qyerTextArea({
					max: 1e3
				})
			})
		}
	])
}(jQuery),
function(e) {
	"use strict";
	angular.module("planner-toolbar.setting", []).directive("plannerToolbarSetting", [
		function() {
			return {
				restrict: "C",
				template: '<div class="planner-toolbar-panel-box"><dl><dt>行程标题</dt><dd><span class="title" ng-click="startEditTitle($event)" ng-if="!isEditTitle" data-bn-ipg="Planv3-setting-title">{{title}}</span><input id="planner-title-input" type="text" ng-if="isEditTitle" value="{{title}}" ng-keydown="keyHandler($event)"><a href="#" ng-if="isEditTitle" ng-click="saveEditTitle($event)">确定</a><a href="#" ng-if="isEditTitle" ng-click="stopEditTitle($event)">取消</a></dd><dt>出发日期</dt><dd><input id="js_setting_startDate" readonly="readonly" value="{{startDate}}"  ng-model="startDate" placeholder="请输选择出发日期"></dd><dt>行程封面图</dt><dd style="height: 100px"><div class="cover"><img src="{{cover}}" alt="" onerror="this.src=\'//common3.qyerstatic.com/plan/desktop/preview/img/default_1100x576.png\'"><form id="upload-cover-form"            enctype="multipart/form-data"            method="post"            action="/ajax.php?action=singleupload"><input type="hidden" name="type" value="plan"><input type="hidden" name="plan_id" value="{{plan_id}}"><div class="cover-mask"><a href="#" class="iconfont">&#xe699;<input id="upload-cover-field" type="file" name="Filedata"></a></div></form><div class="progress-mask">55%</div></div></dd></dl><dl><dt style="margin: 0">隐私设置</dt><div class="privacy"><p><input type="checkbox" checkbox ng-model="isPrivate"/><span style="font-size: 12px;margin-left: 5px;">行程仅自己和同行者可见</span></p></div></dl><dl ng-if="service.currentWidgets.length > 0"><h2>我的应用</h2><ul class="applist clearfix" ui-sortable="sortableOptions" ng-model="service.currentWidgets"><li ng-repeat="widget in service.currentWidgets" ng-show="widget.id > 2" ng-class="{true:\'custom\'}[widget.id > 2]"><div class="box"><a href="#" class="close" ng-if="widget.id > 2" ng-click="removeWidget($event, $index)">删除</a><em class="icon" ng-class="{1:\'edit-icon\', 2:\'preview-icon\', 3:\'calendar-icon\', 4:\'expend-icon\', 5:\'colleague-icon\', 8:\'question-icon\', 9:\'journal-icon\'}[widget.id]"><span class="iconfont" ng-if="widget.id == 3">&#xe6bb;</span><span class="iconfont" ng-if="widget.id == 4">&#xe6ba;</span><span class="iconfont" ng-if="widget.id == 5">&#xe6bd;</span><span class="iconfont" ng-if="widget.id == 8">&#xe69c;</span><span class="iconfont" ng-if="widget.id == 9">&#59070;</span></em><span>{{widget.name}}</span></div></li></ul></dl><dl ng-if="service.availableWidgets.length > 0"><h2>其他应用</h2><ul class="applist clearfix"><li ng-repeat="widget in service.availableWidgets" title="{{widget.description}}"><div class="box"><a href="#" class="add" ng-if="widget.id > 2" ng-click="addWidget($event, $index)">+</a><em class="icon" ng-class="{1:\'edit-icon\', 2:\'preview-icon\', 3:\'calendar-icon\', 4:\'expend-icon\', 5:\'colleague-icon\', 8:\'question-icon\', 9:\'journal-icon\'}[widget.id]"><span class="iconfont" ng-if="widget.id == 3">&#xe6bb;</span><span class="iconfont" ng-if="widget.id == 4">&#xe6ba;</span><span class="iconfont" ng-if="widget.id == 5">&#xe6bd;</span><span class="iconfont" ng-if="widget.id == 8">&#xe69c;</span><span class="iconfont" ng-if="widget.id == 9">&#59070;</span></em><span>{{widget.name}}</span></div></li></ul></dl><dl class="downgradeToV2" ng-if="isDowngradeToV2">\x3c!-- ng-if="isDowngradeToV2" --\x3e<h2 class="clearfix"><span>使用旧版行程助手</span><button class="btn" data-bn-ipg="Planv3-setting-oldversion" ng-click="showDowngradeToV2From=!showDowngradeToV2From">还原旧版</button></h2><div class="from clearfix" ng-show="showDowngradeToV2From" ><div class="box borderbox"><h4 class="title">你忍心抛弃我去拥抱前任吗？</h4>\x3c!--        降级反馈意见,先留着吧, 万一以后要加上呢.           <p class="title-text">请告诉我们你对新版本的感想 :</p><textarea class="content-text" placeholder="请输入您的感想" ng-model="downgradeToV2FromText"></textarea>--\x3e<div class="btn-container"><input ng-click="showDowngradeToV2From=false" type="button" class="ui_btn_small_cancel" value="留下来" /><a href="https://www.diaochapai.com/survey/3e1c1b63-3df6-46e8-bf77-bb1b9b0c4f7e" target="_blank" ng-click="downgradeToV2FromSubmit()"  class="ui_btn_small">狠心离去</a></div></div></div></dl>\x3c!-- <dl ng-if="qrcode" class="country-qrcode"><h2>{{qrcode.title}}</h2><img src="{{qrcode.src}}" /></dl> --\x3e\x3c!-- <dl class="e_code clearfix"><h2><img src="//common3.qyerstatic.com/plan/desktop/edit3/img/e_code.png"><span>扫码添加行程助手微信服务号<br>关注获取人工服务</span></h2></dl> --\x3e</div>'
			}
		}
	]).controller("ToolbarSettingController", ["$scope", "$filter", "$api", "plannerService",
		function(t, n, i, a) {
			function o() {
				var e = a.getAllCities().map(function(e) {
					return e.name
				});
				return ["我用#行程助手#创建了一个旅行计划【", t.title, "】：", "途经", e.join("、"), "，全程", a.allDays.length, "天。攒够RMB，搞定行程，终于可以出行啦，小伙伴速速来围观！链接："].join("")
			}
			t.isSSL = "https:" === window.location.protocol, t.service = a, t.plan_id = i.getPlanId(), t.cover = i.getPlanCover().replace("/w1080", "/300x200"), t.title = i.getPlanTitle(), t.startDate = i.getStartDate(), t.startDate && (t.startDate = t.startDate.qToString()), t.isEditTitle = !1, require(["web_old_share"]), t.startEditTitle = function(e) {
					t.isEditTitle = !0, e && e.preventDefault()
				}, t.keyHandler = function(e) {
					13 === e.keyCode && t.saveEditTitle(), 27 === e.keyCode && t.stopEditTitle()
				}, t.saveEditTitle = function(n) {
					var o = e("#planner-title-input").val();
					if (!e.trim(o) || qyerUtil.getWordLen(o) > 36) return void a.showTip("标题不能为空或超过18个汉字！", "error");
					i.savePlanSetting({
						data: {
							planid: i.getPlanId(),
							planner_name: o
						},
						onSuccess: function() {
							t.$apply(function() {
								t.title = o
							}), i.setPlanTitle(t.title), a.showTip("保存成功！", "ok")
						},
						onError: function(e) {
							a.showTip(e.data.msg, "error")
						}
					}), t.stopEditTitle(n)
				}, t.stopEditTitle = function(e) {
					t.isEditTitle = !1, e && e.preventDefault()
				}, t.saveStartDate = function(e) {
					i.savePlanSetting({
						data: {
							planid: i.getPlanId(),
							starttime: t.startDate
						},
						onSuccess: function() {
							a.updateStartDate(new Date(t.startDate))
						},
						onError: function(e) {
							a.showTip(e.data.msg, "error"), t.$apply(function() {
								t.startDate = i.getStartDate()
							})
						}
					})
				}, t.share = function(e, t) {
					require(["web_old_share"], function(e) {
						e.trigger(t, {
							title: o(),
							summary: " ",
							pic: "/planapi_action_shareimg?id=" + i.getPlanId(),
							url: "http://plan.qyer.com/trip/" + i.getCodePlanId() + "/"
						})
					}), e.preventDefault()
				}, t.removeWidget = function(n, o) {
					(o + 1) % 5 == 0 ? e(n.target).closest("li").prev().find(".box").get(0) : n.target.parentNode, i.removeWidget({
						data: {
							plan_id: i.getPlanId(),
							widgets_id: a.currentWidgets[o].id
						},
						onSuccess: function() {
							t.$apply(function() {
								var e = a.currentWidgets.splice(o, 1);
								a.availableWidgets.push(e[0])
							}), a.broadcast("update-toolbar")
						},
						onError: function(e) {
							a.showTip(e.data.msg, "error")
						}
					}), n.preventDefault()
				}, t.addWidget = function(e, n) {
					i.addWidget({
						data: {
							plan_id: i.getPlanId(),
							widgets_id: a.availableWidgets[n].id
						},
						onSuccess: function() {
							t.$apply(function() {
								var e = a.availableWidgets.splice(n, 1);
								a.currentWidgets.push(e[0])
							}), a.broadcast("update-toolbar")
						},
						onError: function(e) {
							a.showTip(e.data.msg, "error")
						}
					}), e.preventDefault()
				}, t.sortableOptions = {
					stop: function() {
						i.sortWidget({
							data: {
								plan_id: i.getPlanId(),
								widgets: [1, 2].concat(a.currentWidgets.map(function(e) {
									return e.id
								})).join(",")
							},
							onSuccess: function() {
								a.broadcast("update-toolbar")
							},
							onError: function(e) {
								a.showTip(e.data.msg, "error")
							}
						})
					},
					items: ".custom"
				},
				function() {
					e("#js_setting_startDate").datepicker({
						dayNamesMin: ["日", "一", "二", "三", "四", "五", "六"],
						monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
						dateFormat: "yy-mm-dd",
						changeYear: !0,
						changeMonthType: !0,
						onSelect: function(e) {
							t.startDate = e, t.saveStartDate(), qyerUtil.doTrackCode("Planv3-setting-starttime")
						},
						onClose: function() {
							e("#js_setting_startDate").removeClass("select")
						},
						beforeShow: function() {
							e("#js_setting_startDate").addClass("select")
						}
					})
				}(), t.isDowngradeToV2 = 0 !== i.V2ToV3State && 1 != window.__plan_init_data__.business_group, t.showDowngradeToV2From = !1, t.downgradeToV2FromText = "", t.downgradeToV2FromSubmit = function() {
					i.downgradeToV2({
						data: {
							plan_id: i.getPlanId(),
							status: 4,
							content: t.downgradeToV2FromText
						},
						onSuccess: function(e) {
							t.showDowngradeToV2From = !1, a.showTip("降级成功,3秒后跳转到旧版页面", "ok");
							var n = e.data.url;
							setTimeout(function() {
								window.location.href = n
							}, 3e3)
						},
						onError: function(e) {
							a.showTip(e.data.msg, "error")
						}
					})
				}, t.qrcode = i.qrcode;
			i.getPrivacySetting({
				data: {
					planid: i.getPlanId()
				},
				onSuccess: function(e) {
					qyerUtil.doTrackCode("Planv3-setting-privacy"), t.$apply(function() {
						t.isPrivate = 1 != e.data.isOpen
					}), t.$watch("isPrivate", function() {
						i.setPrivacySetting({
							data: {
								planid: i.getPlanId(),
								option: {
									isOPen: t.isPrivate ? 0 : 1
								}
							},
							onSuccess: function() {
								a.showTip("保存设置成功！", "ok"), qyerUtil.doTrackCode("Planv3-setting-privacy")
							},
							onError: function(e) {
								a.showTip(e.data.msg, "error")
							}
						})
					})
				},
				onError: function(e) {
					a.showTip(e.data.msg, "error")
				}
			}), e("#upload-cover-field").on("change", function(n) {
				var a = e(".progress-mask");
				n.preventDefault(), e("#upload-cover-form").ajaxSubmit({
					dataType: "json",
					beforeSend: function() {
						a.text("0%").fadeIn()
					},
					uploadProgress: function(e, t, n, i) {
						a.text(i + "%")
					},
					success: function(e) {
						if (qyerUtil.doTrackCode("Planv3-setting-image"), a.text("100%").fadeOut(), "object" != typeof e) return void alert("数据传输失败");
						if (0 === e.error_code) {
							var n = e.data.url.replace("/w1080", "/300x200");
							i.setPlanCover(n), t.cover = n, t.$apply()
						} else alert(e.data.msg)
					}
				})
			}), t.share_config = {
				title: encodeURIComponent(o()),
				summary: "",
				pic: encodeURIComponent("http://plan.qyer.com/planapi_action_shareimg?id=" + i.getPlanId()),
				url: encodeURIComponent("http://plan.qyer.com/trip/" + i.getCodePlanId() + "/")
			}
		}
	])
}(jQuery);